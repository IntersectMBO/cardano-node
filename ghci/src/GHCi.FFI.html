<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LINE 1 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-1"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- libffi bindings</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- (c) The University of Glasgow 2008</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">{- Note [FFI for the JS-Backend]
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

   The JS-backend does not use GHC's native rts, as such you might think that it
   doesn't require ghci. However, that is not true, because we need ghci in
   order to interoperate with iserv even if we do not use any of the FFI stuff
   in this file. So obviously we do not require libffi, but we still need to be
   able to build ghci in order for the JS-Backend to supply its own iserv
   interop solution. Thus we bite the bullet and wrap all the unneeded bits in a
   CPP conditional compilation blocks that detect the JS-backend. A necessary
   evil to be sure; notice that the only symbols remaining the JS_HOST_ARCH case
   are those that are explicitly exported by this module and set to error if
   they are every used.
-}</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# LINE 25 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- See Note [FFI_GO_CLOSURES workaround] in ghc_ffi.h</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- We can't include ghc_ffi.h here as we must build with stage0</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-pragma">{-# LINE 32 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-pragma">{-# LINE 35 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-pragma">{-# LANGUAGE CPP, DeriveGeneric, DeriveAnyClass #-}</span><span>
</span><span id="line-37"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHCi.FFI</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHCi.FFI.html#FFIType"><span class="hs-identifier">FFIType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHCi.FFI.html#FFIConv"><span class="hs-identifier">FFIConv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_cif"><span class="hs-identifier">C_ffi_cif</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHCi.FFI.html#prepForeignCall"><span class="hs-identifier">prepForeignCall</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHCi.FFI.html#freeForeignCallInfo"><span class="hs-identifier">freeForeignCallInfo</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Prelude.html#/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-comment">-- See note [Why do we import Prelude here?]</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-pragma">{-# LINE 47 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Exception</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Foreign.C.html#/Foreign.C.html"><span class="hs-identifier">Foreign.C</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-pragma">{-# LINE 50 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Binary</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Generics.html#/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Foreign.html#/Foreign.html"><span class="hs-identifier">Foreign</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">data</span><span> </span><span id="FFIType"><span class="annot"><a href="GHCi.FFI.html#FFIType"><span class="hs-identifier hs-var">FFIType</span></a></span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FFIVoid"><span class="annot"><a href="GHCi.FFI.html#FFIVoid"><span class="hs-identifier hs-var">FFIVoid</span></a></span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFIPointer"><span class="annot"><a href="GHCi.FFI.html#FFIPointer"><span class="hs-identifier hs-var">FFIPointer</span></a></span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFIFloat"><span class="annot"><a href="GHCi.FFI.html#FFIFloat"><span class="hs-identifier hs-var">FFIFloat</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFIDouble"><span class="annot"><a href="GHCi.FFI.html#FFIDouble"><span class="hs-identifier hs-var">FFIDouble</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFISInt8"><span class="annot"><a href="GHCi.FFI.html#FFISInt8"><span class="hs-identifier hs-var">FFISInt8</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFISInt16"><span class="annot"><a href="GHCi.FFI.html#FFISInt16"><span class="hs-identifier hs-var">FFISInt16</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFISInt32"><span class="annot"><a href="GHCi.FFI.html#FFISInt32"><span class="hs-identifier hs-var">FFISInt32</span></a></span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFISInt64"><span class="annot"><a href="GHCi.FFI.html#FFISInt64"><span class="hs-identifier hs-var">FFISInt64</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFIUInt8"><span class="annot"><a href="GHCi.FFI.html#FFIUInt8"><span class="hs-identifier hs-var">FFIUInt8</span></a></span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFIUInt16"><span class="annot"><a href="GHCi.FFI.html#FFIUInt16"><span class="hs-identifier hs-var">FFIUInt16</span></a></span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFIUInt32"><span class="annot"><a href="GHCi.FFI.html#FFIUInt32"><span class="hs-identifier hs-var">FFIUInt32</span></a></span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFIUInt64"><span class="annot"><a href="GHCi.FFI.html#FFIUInt64"><span class="hs-identifier hs-var">FFIUInt64</span></a></span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679088493"><span id="local-6989586621679088495"><span id="local-6989586621679088498"><span class="annot"><span class="annottext">Int -&gt; FFIType -&gt; ShowS
[FFIType] -&gt; ShowS
FFIType -&gt; String
(Int -&gt; FFIType -&gt; ShowS)
-&gt; (FFIType -&gt; String) -&gt; ([FFIType] -&gt; ShowS) -&gt; Show FFIType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; FFIType -&gt; ShowS
showsPrec :: Int -&gt; FFIType -&gt; ShowS
$cshow :: FFIType -&gt; String
show :: FFIType -&gt; String
$cshowList :: [FFIType] -&gt; ShowS
showList :: [FFIType] -&gt; ShowS
</span><a href="../../base-4.18.3.0/src/GHC.Show.html#Show/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679088502"><span id="local-6989586621679088504"><span class="annot"><span class="annottext">(forall x. FFIType -&gt; Rep FFIType x)
-&gt; (forall x. Rep FFIType x -&gt; FFIType) -&gt; Generic FFIType
forall x. Rep FFIType x -&gt; FFIType
forall x. FFIType -&gt; Rep FFIType x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. FFIType -&gt; Rep FFIType x
from :: forall x. FFIType -&gt; Rep FFIType x
$cto :: forall x. Rep FFIType x -&gt; FFIType
to :: forall x. Rep FFIType x -&gt; FFIType
</span><a href="../../base-4.18.3.0/src/GHC.Generics.html#Generic/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679088508"><span id="local-6989586621679088515"><span id="local-6989586621679088521"><span class="annot"><span class="annottext">Get FFIType
[FFIType] -&gt; Put
FFIType -&gt; Put
(FFIType -&gt; Put)
-&gt; Get FFIType -&gt; ([FFIType] -&gt; Put) -&gt; Binary FFIType
forall t. (t -&gt; Put) -&gt; Get t -&gt; ([t] -&gt; Put) -&gt; Binary t
$cput :: FFIType -&gt; Put
put :: FFIType -&gt; Put
$cget :: Get FFIType
get :: Get FFIType
$cputList :: [FFIType] -&gt; Put
putList :: [FFIType] -&gt; Put
</span><a href="../../binary-0.8.9.1/src/Data.Binary.Class.html#Binary/Data.Binary.Class.html#Binary"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Binary</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">data</span><span> </span><span id="FFIConv"><span class="annot"><a href="GHCi.FFI.html#FFIConv"><span class="hs-identifier hs-var">FFIConv</span></a></span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FFICCall"><span class="annot"><a href="GHCi.FFI.html#FFICCall"><span class="hs-identifier hs-var">FFICCall</span></a></span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FFIStdCall"><span class="annot"><a href="GHCi.FFI.html#FFIStdCall"><span class="hs-identifier hs-var">FFIStdCall</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679088631"><span id="local-6989586621679088633"><span id="local-6989586621679088636"><span class="annot"><span class="annottext">Int -&gt; FFIConv -&gt; ShowS
[FFIConv] -&gt; ShowS
FFIConv -&gt; String
(Int -&gt; FFIConv -&gt; ShowS)
-&gt; (FFIConv -&gt; String) -&gt; ([FFIConv] -&gt; ShowS) -&gt; Show FFIConv
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; FFIConv -&gt; ShowS
showsPrec :: Int -&gt; FFIConv -&gt; ShowS
$cshow :: FFIConv -&gt; String
show :: FFIConv -&gt; String
$cshowList :: [FFIConv] -&gt; ShowS
showList :: [FFIConv] -&gt; ShowS
</span><a href="../../base-4.18.3.0/src/GHC.Show.html#Show/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679088639"><span id="local-6989586621679088641"><span class="annot"><span class="annottext">(forall x. FFIConv -&gt; Rep FFIConv x)
-&gt; (forall x. Rep FFIConv x -&gt; FFIConv) -&gt; Generic FFIConv
forall x. Rep FFIConv x -&gt; FFIConv
forall x. FFIConv -&gt; Rep FFIConv x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. FFIConv -&gt; Rep FFIConv x
from :: forall x. FFIConv -&gt; Rep FFIConv x
$cto :: forall x. Rep FFIConv x -&gt; FFIConv
to :: forall x. Rep FFIConv x -&gt; FFIConv
</span><a href="../../base-4.18.3.0/src/GHC.Generics.html#Generic/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679088644"><span id="local-6989586621679088651"><span id="local-6989586621679088657"><span class="annot"><span class="annottext">Get FFIConv
[FFIConv] -&gt; Put
FFIConv -&gt; Put
(FFIConv -&gt; Put)
-&gt; Get FFIConv -&gt; ([FFIConv] -&gt; Put) -&gt; Binary FFIConv
forall t. (t -&gt; Put) -&gt; Get t -&gt; ([t] -&gt; Put) -&gt; Binary t
$cput :: FFIConv -&gt; Put
put :: FFIConv -&gt; Put
$cget :: Get FFIConv
get :: Get FFIConv
$cputList :: [FFIConv] -&gt; Put
putList :: [FFIConv] -&gt; Put
</span><a href="../../binary-0.8.9.1/src/Data.Binary.Class.html#Binary/Data.Binary.Class.html#Binary"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Binary</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="GHCi.FFI.html#prepForeignCall"><span class="hs-identifier hs-type">prepForeignCall</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHCi.FFI.html#FFIConv"><span class="hs-identifier hs-type">FFIConv</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHCi.FFI.html#FFIType"><span class="hs-identifier hs-type">FFIType</span></a></span><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- arg types</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHCi.FFI.html#FFIType"><span class="hs-identifier hs-type">FFIType</span></a></span><span>            </span><span class="hs-comment">-- result type</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#IO/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_cif"><span class="hs-identifier hs-type">C_ffi_cif</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- token for making calls (must be freed by caller)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span id="prepForeignCall"><span class="hs-pragma">{-# LINE 82 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span></span><span>
</span><span id="line-82"></span><span class="hs-identifier">prepForeignCall</span><span> </span><span class="hs-identifier">cconv</span><span> </span><span class="hs-identifier">arg_types</span><span> </span><span class="hs-identifier">result_type</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">n_args</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">arg_types</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-identifier">arg_arr</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mallocArray</span><span> </span><span class="hs-identifier">n_args</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-identifier">pokeArray</span><span> </span><span class="hs-identifier">arg_arr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">ffiType</span><span> </span><span class="hs-identifier">arg_types</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-identifier">cif</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mallocBytes</span><span> </span><span class="hs-special">(</span><span class="hs-number">32</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-pragma">{-# LINE 87 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">abi</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">convToABI</span><span> </span><span class="hs-identifier">cconv</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">ffi_prep_cif</span><span> </span><span class="hs-identifier">cif</span><span> </span><span class="hs-identifier">abi</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">n_args</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ffiType</span><span> </span><span class="hs-identifier">result_type</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">arg_arr</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-identifier">fFI_OK</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-identifier">throwIO</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">ErrorCall</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">concat</span><span>
</span><span id="line-91"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;prepForeignCallFailed: &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strError</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-string">&quot;(cconv: &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">cconv</span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-string">&quot; arg tys: &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">arg_types</span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-string">&quot; res ty: &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">result_type</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;)&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">castPtr</span><span> </span><span class="hs-identifier">cif</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-pragma">{-# LINE 101 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="GHCi.FFI.html#freeForeignCallInfo"><span class="hs-identifier hs-type">freeForeignCallInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_cif"><span class="hs-identifier hs-type">C_ffi_cif</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#IO/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="freeForeignCallInfo"><span class="hs-pragma">{-# LINE 105 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span></span><span>
</span><span id="line-105"></span><span class="hs-identifier">freeForeignCallInfo</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-identifier">free</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">hsc_ptr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">hsc_ptr</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">plusPtr</span><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-pragma">{-# LINE 107 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-identifier">free</span><span> </span><span class="hs-identifier">p</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-pragma">{-# LINE 112 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">data</span><span> </span><span id="C_ffi_cif"><span class="annot"><a href="GHCi.FFI.html#C_ffi_cif"><span class="hs-identifier hs-var">C_ffi_cif</span></a></span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="C_ffi_type"></span><span class="hs-pragma">{-# LINE 116 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-116"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">C_ffi_type</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="GHCi.FFI.html#strError"><span class="hs-identifier hs-type">strError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_status"><span class="hs-identifier hs-type">C_ffi_status</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-119"></span><span id="strError"><span class="annot"><span class="annottext">strError :: C_ffi_abi -&gt; String
</span><a href="GHCi.FFI.html#strError"><span class="hs-identifier hs-var hs-var">strError</span></a></span></span><span> </span><span id="local-6989586621679088700"><span class="annot"><span class="annottext">C_ffi_abi
</span><a href="#local-6989586621679088700"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">C_ffi_abi
</span><a href="#local-6989586621679088700"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">C_ffi_abi -&gt; C_ffi_abi -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">C_ffi_abi
</span><a href="GHCi.FFI.html#fFI_BAD_ABI"><span class="hs-identifier hs-var">fFI_BAD_ABI</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid ABI (FFI_BAD_ABI)&quot;</span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">C_ffi_abi
</span><a href="#local-6989586621679088700"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">C_ffi_abi -&gt; C_ffi_abi -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">C_ffi_abi
</span><a href="GHCi.FFI.html#fFI_BAD_TYPEDEF"><span class="hs-identifier hs-var">fFI_BAD_TYPEDEF</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid type description (FFI_BAD_TYPEDEF)&quot;</span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">C_ffi_abi -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../base-4.18.3.0/src/GHC.Show.html#show/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">C_ffi_abi
</span><a href="#local-6989586621679088700"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="GHCi.FFI.html#convToABI"><span class="hs-identifier hs-type">convToABI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHCi.FFI.html#FFIConv"><span class="hs-identifier hs-type">FFIConv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_abi"><span class="hs-identifier hs-type">C_ffi_abi</span></a></span><span>
</span><span id="line-128"></span><span id="convToABI"><span class="annot"><span class="annottext">convToABI :: FFIConv -&gt; C_ffi_abi
</span><a href="GHCi.FFI.html#convToABI"><span class="hs-identifier hs-var hs-var">convToABI</span></a></span></span><span> </span><span class="annot"><span class="annottext">FFIConv
</span><a href="GHCi.FFI.html#FFICCall"><span class="hs-identifier hs-var">FFICCall</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">C_ffi_abi
</span><a href="GHCi.FFI.html#fFI_DEFAULT_ABI"><span class="hs-identifier hs-var">fFI_DEFAULT_ABI</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-pragma">{-# LINE 132 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- unknown conventions are mapped to the default, (#3336)</span><span>
</span><span id="line-133"></span><span class="annot"><a href="GHCi.FFI.html#convToABI"><span class="hs-identifier hs-var">convToABI</span></a></span><span> </span><span class="annot"><span class="annottext">FFIConv
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">C_ffi_abi
</span><a href="GHCi.FFI.html#fFI_DEFAULT_ABI"><span class="hs-identifier hs-var">fFI_DEFAULT_ABI</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-type">ffiType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHCi.FFI.html#FFIType"><span class="hs-identifier hs-type">FFIType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-136"></span><span id="ffiType"><span class="annot"><span class="annottext">ffiType :: FFIType -&gt; Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var hs-var">ffiType</span></a></span></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFIVoid"><span class="hs-identifier hs-var">FFIVoid</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_void"><span class="hs-identifier hs-var">ffi_type_void</span></a></span><span>
</span><span id="line-137"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFIPointer"><span class="hs-identifier hs-var">FFIPointer</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_pointer"><span class="hs-identifier hs-var">ffi_type_pointer</span></a></span><span>
</span><span id="line-138"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFIFloat"><span class="hs-identifier hs-var">FFIFloat</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_float"><span class="hs-identifier hs-var">ffi_type_float</span></a></span><span>
</span><span id="line-139"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFIDouble"><span class="hs-identifier hs-var">FFIDouble</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_double"><span class="hs-identifier hs-var">ffi_type_double</span></a></span><span>
</span><span id="line-140"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFISInt8"><span class="hs-identifier hs-var">FFISInt8</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_sint8"><span class="hs-identifier hs-var">ffi_type_sint8</span></a></span><span>
</span><span id="line-141"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFISInt16"><span class="hs-identifier hs-var">FFISInt16</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_sint16"><span class="hs-identifier hs-var">ffi_type_sint16</span></a></span><span>
</span><span id="line-142"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFISInt32"><span class="hs-identifier hs-var">FFISInt32</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_sint32"><span class="hs-identifier hs-var">ffi_type_sint32</span></a></span><span>
</span><span id="line-143"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFISInt64"><span class="hs-identifier hs-var">FFISInt64</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_sint64"><span class="hs-identifier hs-var">ffi_type_sint64</span></a></span><span>
</span><span id="line-144"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFIUInt8"><span class="hs-identifier hs-var">FFIUInt8</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_uint8"><span class="hs-identifier hs-var">ffi_type_uint8</span></a></span><span>
</span><span id="line-145"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFIUInt16"><span class="hs-identifier hs-var">FFIUInt16</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_uint16"><span class="hs-identifier hs-var">ffi_type_uint16</span></a></span><span>
</span><span id="line-146"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFIUInt32"><span class="hs-identifier hs-var">FFIUInt32</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_uint32"><span class="hs-identifier hs-var">ffi_type_uint32</span></a></span><span>
</span><span id="line-147"></span><span class="annot"><a href="GHCi.FFI.html#ffiType"><span class="hs-identifier hs-var">ffiType</span></a></span><span> </span><span class="annot"><span class="annottext">FFIType
</span><a href="GHCi.FFI.html#FFIUInt64"><span class="hs-identifier hs-var">FFIUInt64</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr C_ffi_type
</span><a href="GHCi.FFI.html#ffi_type_uint64"><span class="hs-identifier hs-var">ffi_type_uint64</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">type</span><span> </span><span id="C_ffi_status"><span class="annot"><a href="GHCi.FFI.html#C_ffi_status"><span class="hs-identifier hs-var">C_ffi_status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span id="C_ffi_abi"></span><span class="hs-pragma">{-# LINE 150 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-150"></span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">C_ffi_abi</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Word32</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="hs-pragma">{-# LINE 151 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_void&quot;</span></span><span>   </span><span id="ffi_type_void"><span class="annot"><a href="GHCi.FFI.html#ffi_type_void"><span class="hs-identifier hs-var">ffi_type_void</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-153"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_uint8&quot;</span></span><span>  </span><span id="ffi_type_uint8"><span class="annot"><a href="GHCi.FFI.html#ffi_type_uint8"><span class="hs-identifier hs-var">ffi_type_uint8</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-154"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_sint8&quot;</span></span><span>  </span><span id="ffi_type_sint8"><span class="annot"><a href="GHCi.FFI.html#ffi_type_sint8"><span class="hs-identifier hs-var">ffi_type_sint8</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-155"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_uint16&quot;</span></span><span> </span><span id="ffi_type_uint16"><span class="annot"><a href="GHCi.FFI.html#ffi_type_uint16"><span class="hs-identifier hs-var">ffi_type_uint16</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-156"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_sint16&quot;</span></span><span> </span><span id="ffi_type_sint16"><span class="annot"><a href="GHCi.FFI.html#ffi_type_sint16"><span class="hs-identifier hs-var">ffi_type_sint16</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-157"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_uint32&quot;</span></span><span> </span><span id="ffi_type_uint32"><span class="annot"><a href="GHCi.FFI.html#ffi_type_uint32"><span class="hs-identifier hs-var">ffi_type_uint32</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-158"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_sint32&quot;</span></span><span> </span><span id="ffi_type_sint32"><span class="annot"><a href="GHCi.FFI.html#ffi_type_sint32"><span class="hs-identifier hs-var">ffi_type_sint32</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-159"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_uint64&quot;</span></span><span> </span><span id="ffi_type_uint64"><span class="annot"><a href="GHCi.FFI.html#ffi_type_uint64"><span class="hs-identifier hs-var">ffi_type_uint64</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-160"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_sint64&quot;</span></span><span> </span><span id="ffi_type_sint64"><span class="annot"><a href="GHCi.FFI.html#ffi_type_sint64"><span class="hs-identifier hs-var">ffi_type_sint64</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-161"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_float&quot;</span></span><span>  </span><span id="ffi_type_float"><span class="annot"><a href="GHCi.FFI.html#ffi_type_float"><span class="hs-identifier hs-var">ffi_type_float</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-162"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_double&quot;</span></span><span> </span><span id="ffi_type_double"><span class="annot"><a href="GHCi.FFI.html#ffi_type_double"><span class="hs-identifier hs-var">ffi_type_double</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-163"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;ffi_type_pointer&quot;</span></span><span id="ffi_type_pointer"><span class="annot"><a href="GHCi.FFI.html#ffi_type_pointer"><span class="hs-identifier hs-var">ffi_type_pointer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="GHCi.FFI.html#fFI_OK"><span class="hs-identifier hs-type">fFI_OK</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHCi.FFI.html#fFI_BAD_ABI"><span class="hs-identifier hs-type">fFI_BAD_ABI</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHCi.FFI.html#fFI_BAD_TYPEDEF"><span class="hs-identifier hs-type">fFI_BAD_TYPEDEF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_status"><span class="hs-identifier hs-type">C_ffi_status</span></a></span><span>
</span><span id="line-166"></span><span id="fFI_OK"><span class="annot"><span class="annottext">fFI_OK :: C_ffi_abi
</span><a href="GHCi.FFI.html#fFI_OK"><span class="hs-identifier hs-var hs-var">fFI_OK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">C_ffi_abi
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span id="fFI_BAD_ABI"><span class="hs-pragma">{-# LINE 167 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span></span><span>
</span><span id="line-167"></span><span class="hs-identifier">fFI_BAD_ABI</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span id="fFI_BAD_TYPEDEF"><span class="hs-pragma">{-# LINE 168 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span></span><span>
</span><span id="line-168"></span><span class="hs-identifier">fFI_BAD_TYPEDEF</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span class="hs-pragma">{-# LINE 169 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="GHCi.FFI.html#fFI_DEFAULT_ABI"><span class="hs-identifier hs-type">fFI_DEFAULT_ABI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_abi"><span class="hs-identifier hs-type">C_ffi_abi</span></a></span><span>
</span><span id="line-171"></span><span id="fFI_DEFAULT_ABI"><span class="annot"><span class="annottext">fFI_DEFAULT_ABI :: C_ffi_abi
</span><a href="GHCi.FFI.html#fFI_DEFAULT_ABI"><span class="hs-identifier hs-var hs-var">fFI_DEFAULT_ABI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">C_ffi_abi
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span class="hs-pragma">{-# LINE 172 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-pragma">{-# LINE 176 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- ffi_status ffi_prep_cif(ffi_cif *cif,</span><span>
</span><span id="line-178"></span><span class="hs-comment">--                         ffi_abi abi,</span><span>
</span><span id="line-179"></span><span class="hs-comment">--                         unsigned int nargs,</span><span>
</span><span id="line-180"></span><span class="hs-comment">--                         ffi_type *rtype,</span><span>
</span><span id="line-181"></span><span class="hs-comment">--                         ffi_type **atypes);</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ffi_prep_cif&quot;</span></span><span>
</span><span id="line-184"></span><span>  </span><span id="ffi_prep_cif"><span class="annot"><a href="GHCi.FFI.html#ffi_prep_cif"><span class="hs-identifier hs-var">ffi_prep_cif</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_cif"><span class="hs-identifier hs-type">C_ffi_cif</span></a></span><span>         </span><span class="hs-comment">-- cif</span><span>
</span><span id="line-185"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_abi"><span class="hs-identifier hs-type">C_ffi_abi</span></a></span><span>             </span><span class="hs-comment">-- abi</span><span>
</span><span id="line-186"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Foreign.C.Types.html#CUInt/Foreign.C.Types.html#CUInt"><span class="hs-identifier hs-type">CUInt</span></a></span><span>                 </span><span class="hs-comment">-- nargs</span><span>
</span><span id="line-187"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span>        </span><span class="hs-comment">-- result type</span><span>
</span><span id="line-188"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_type"><span class="hs-identifier hs-type">C_ffi_type</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- arg types</span><span>
</span><span id="line-189"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#IO/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="GHCi.FFI.html#C_ffi_status"><span class="hs-identifier hs-type">C_ffi_status</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- Currently unused:</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- void ffi_call(ffi_cif *cif,</span><span>
</span><span id="line-194"></span><span class="hs-comment">--               void (*fn)(),</span><span>
</span><span id="line-195"></span><span class="hs-comment">--               void *rvalue,</span><span>
</span><span id="line-196"></span><span class="hs-comment">--               void **avalue);</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- foreign import ccall &quot;ffi_call&quot;</span><span>
</span><span id="line-199"></span><span class="hs-comment">--   ffi_call :: Ptr C_ffi_cif             -- cif</span><span>
</span><span id="line-200"></span><span class="hs-comment">--            -&gt; FunPtr (IO ())            -- function to call</span><span>
</span><span id="line-201"></span><span class="hs-comment">--            -&gt; Ptr ()                    -- put result here</span><span>
</span><span id="line-202"></span><span class="hs-comment">--            -&gt; Ptr (Ptr ())              -- arg values</span><span>
</span><span id="line-203"></span><span class="hs-comment">--            -&gt; IO ()</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-pragma">{-# LINE 205 &quot;libraries/ghci/GHCi/FFI.hsc&quot; #-}</span><span>
</span><span id="line-205"></span></pre></body></html>