#!/usr/bin/env bash

#####################################################################
#
# Trap the SIGTERM signal
#
trapSIGTERM () {

  PID="$!"
  trap "sigtermHandler $PID" SIGTERM

  # Wait for the child process to terminate
  wait $PID
}

#####################################################################
#
# Signal the cardano-node with SIGINT for graceful shutdown
#
# The wait may return before the gracefull shutdown is done
# Wait a little longer before we will kill everything

sigtermHandler () {
  echo "Signalling for shutdown ..."
  kill -SIGINT $1
  wait $1
  sleep 2
}

#####################################################################
#
# Returns true if the given parameter is a valud json string
#
isJsonValue () {
  return=false
  echo "$1" | jq -c "." &> /dev/null
  if [[ $? == 0 ]]; then return=true; fi
}
