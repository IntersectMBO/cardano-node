<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">{-| The names exported by this module are closely modeled on those in @Prelude@ and @Data.List@,
    but also on
    &lt;http://hackage.haskell.org/package/pipes-4.1.9/docs/Pipes-Prelude.html Pipes.Prelude&gt;,
    &lt;http://hackage.haskell.org/package/pipes-group-1.0.3/docs/Pipes-Group.html Pipes.Group&gt;
    and &lt;http://hackage.haskell.org/package/pipes-parse-3.0.6/docs/Pipes-Parse.html Pipes.Parse&gt;.
    The module may be said to give independent expression to the conception of
    Producer \/ Source \/ Generator manipulation
    articulated in the latter two modules. Because we dispense with piping and
    conduiting, the distinction between all of these modules collapses. Some things are
    lost but much is gained: on the one hand, everything comes much closer to ordinary
    beginning Haskell programming and, on the other, acquires the plasticity of programming
    directly with a general free monad type. The leading type, @Stream (Of a) m r@ is chosen to permit an api
    that is as close as possible to that of @Data.List@ and the @Prelude@.

    Import qualified thus:

&gt; import Streaming
&gt; import qualified Streaming.Prelude as S

    For the examples below, one sometimes needs

&gt; import Streaming.Prelude (each, yield, next, mapped, stdoutLn, stdinLn)
&gt; import Data.Function ((&amp;))

   Other libraries that come up in passing are

&gt; import qualified Control.Foldl as L -- cabal install foldl
&gt; import qualified Pipes as P
&gt; import qualified Pipes.Prelude as P
&gt; import qualified System.IO as IO

     Here are some correspondences between the types employed here and elsewhere:

&gt;               streaming             |            pipes               |       conduit       |  io-streams
&gt; -------------------------------------------------------------------------------------------------------------------
&gt; Stream (Of a) m ()                  | Producer a m ()                | Source m a          | InputStream a
&gt;                                     | ListT m a                      | ConduitM () o m ()  | Generator r ()
&gt; -------------------------------------------------------------------------------------------------------------------
&gt; Stream (Of a) m r                   | Producer a m r                 | ConduitM () o m r   | Generator a r
&gt; -------------------------------------------------------------------------------------------------------------------
&gt; Stream (Of a) m (Stream (Of a) m r) | Producer a m (Producer a m r)  |
&gt; --------------------------------------------------------------------------------------------------------------------
&gt; Stream (Stream (Of a) m) r          | FreeT (Producer a m) m r       |
&gt; --------------------------------------------------------------------------------------------------------------------
&gt; --------------------------------------------------------------------------------------------------------------------
&gt; ByteString m ()                     | Producer ByteString m ()       | Source m ByteString  | InputStream ByteString
&gt; --------------------------------------------------------------------------------------------------------------------
&gt;
-}</span></span><span>
</span><span id="line-50"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns        #-}</span><span>
</span><span id="line-51"></span><span class="hs-pragma">{-# LANGUAGE CPP                 #-}</span><span>
</span><span id="line-52"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-53"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-54"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Streaming.Prelude</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Introducing streams of elements</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-comment">-- $producers</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#yield"><span class="hs-identifier">yield</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#each"><span class="hs-identifier">each</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#stdinLn"><span class="hs-identifier">stdinLn</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#readLn"><span class="hs-identifier">readLn</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#fromHandle"><span class="hs-identifier">fromHandle</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#readFile"><span class="hs-identifier">readFile</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#iterate"><span class="hs-identifier">iterate</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#iterateM"><span class="hs-identifier">iterateM</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#repeat"><span class="hs-identifier">repeat</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#repeatM"><span class="hs-identifier">repeatM</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#replicate"><span class="hs-identifier">replicate</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#untilLeft"><span class="hs-identifier">untilLeft</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#untilRight"><span class="hs-identifier">untilRight</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#cycle"><span class="hs-identifier">cycle</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#replicateM"><span class="hs-identifier">replicateM</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#enumFrom"><span class="hs-identifier">enumFrom</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#enumFromThen"><span class="hs-identifier">enumFromThen</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#unfoldr"><span class="hs-identifier">unfoldr</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Consuming streams of elements</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="hs-comment">-- $consumers</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#stdoutLn"><span class="hs-identifier">stdoutLn</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#stdoutLn%27"><span class="hs-identifier">stdoutLn'</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapM_"><span class="hs-identifier">mapM_</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#print"><span class="hs-identifier">print</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#toHandle"><span class="hs-identifier">toHandle</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#writeFile"><span class="hs-identifier">writeFile</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#effects"><span class="hs-identifier">effects</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#erase"><span class="hs-identifier">erase</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#drained"><span class="hs-identifier">drained</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Stream transformers</span></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="hs-comment">-- $pipes</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#map"><span class="hs-identifier">map</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapM"><span class="hs-identifier">mapM</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Internal.html#maps"><span class="hs-identifier">maps</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Internal.html#mapsPost"><span class="hs-identifier">mapsPost</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapped"><span class="hs-identifier">mapped</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mappedPost"><span class="hs-identifier">mappedPost</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#for"><span class="hs-identifier">for</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#with"><span class="hs-identifier">with</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#subst"><span class="hs-identifier">subst</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#copy"><span class="hs-identifier">copy</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#duplicate"><span class="hs-identifier">duplicate</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#store"><span class="hs-identifier">store</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#chain"><span class="hs-identifier">chain</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sequence"><span class="hs-identifier">sequence</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#nubOrd"><span class="hs-identifier">nubOrd</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#nubOrdOn"><span class="hs-identifier">nubOrdOn</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#nubInt"><span class="hs-identifier">nubInt</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#nubIntOn"><span class="hs-identifier">nubIntOn</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#filter"><span class="hs-identifier">filter</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#filterM"><span class="hs-identifier">filterM</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapMaybeM"><span class="hs-identifier">mapMaybeM</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#delay"><span class="hs-identifier">delay</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#intersperse"><span class="hs-identifier">intersperse</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#take"><span class="hs-identifier">take</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#takeWhile"><span class="hs-identifier">takeWhile</span></a></span><span>
</span><span id="line-123"></span><span class="hs-comment">--    , takeWhile'</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#takeWhileM"><span class="hs-identifier">takeWhileM</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#drop"><span class="hs-identifier">drop</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#dropWhile"><span class="hs-identifier">dropWhile</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#concat"><span class="hs-identifier">concat</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">-- , elemIndices</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- , findIndices</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#scan"><span class="hs-identifier">scan</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#scanM"><span class="hs-identifier">scanM</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#scanned"><span class="hs-identifier">scanned</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#read"><span class="hs-identifier">read</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#show"><span class="hs-identifier">show</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#cons"><span class="hs-identifier">cons</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindow"><span class="hs-identifier">slidingWindow</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMin"><span class="hs-identifier">slidingWindowMin</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMinBy"><span class="hs-identifier">slidingWindowMinBy</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMinOn"><span class="hs-identifier">slidingWindowMinOn</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMax"><span class="hs-identifier">slidingWindowMax</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMaxBy"><span class="hs-identifier">slidingWindowMaxBy</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMaxOn"><span class="hs-identifier">slidingWindowMaxOn</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#wrapEffect"><span class="hs-identifier">wrapEffect</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Splitting and inspecting streams of elements</span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#next"><span class="hs-identifier">next</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#uncons"><span class="hs-identifier">uncons</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#splitAt"><span class="hs-identifier">splitAt</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#split"><span class="hs-identifier">split</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#breaks"><span class="hs-identifier">breaks</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#break"><span class="hs-identifier">break</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#breakWhen"><span class="hs-identifier">breakWhen</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#span"><span class="hs-identifier">span</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#group"><span class="hs-identifier">group</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#groupBy"><span class="hs-identifier">groupBy</span></a></span><span>
</span><span id="line-156"></span><span> </span><span class="hs-comment">--   , groupedBy</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Sum and Compose manipulation</span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#distinguish"><span class="hs-identifier">distinguish</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Internal.html#switch"><span class="hs-identifier">switch</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Internal.html#separate"><span class="hs-identifier">separate</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Internal.html#unseparate"><span class="hs-identifier">unseparate</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#eitherToSum"><span class="hs-identifier">eitherToSum</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sumToEither"><span class="hs-identifier">sumToEither</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sumToCompose"><span class="hs-identifier">sumToCompose</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#composeToSum"><span class="hs-identifier">composeToSum</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Folds</span></span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="hs-comment">-- $folds</span></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#fold"><span class="hs-identifier">fold</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier">fold_</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldM"><span class="hs-identifier">foldM</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldM_"><span class="hs-identifier">foldM_</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldMap"><span class="hs-identifier">foldMap</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldMap_"><span class="hs-identifier">foldMap_</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#all"><span class="hs-identifier">all</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#all_"><span class="hs-identifier">all_</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#any"><span class="hs-identifier">any</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#any_"><span class="hs-identifier">any_</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sum"><span class="hs-identifier">sum</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sum_"><span class="hs-identifier">sum_</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#product"><span class="hs-identifier">product</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#product_"><span class="hs-identifier">product_</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#head"><span class="hs-identifier">head</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#head_"><span class="hs-identifier">head_</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#last"><span class="hs-identifier">last</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#last_"><span class="hs-identifier">last_</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#elem"><span class="hs-identifier">elem</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#elem_"><span class="hs-identifier">elem_</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#notElem"><span class="hs-identifier">notElem</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#notElem_"><span class="hs-identifier">notElem_</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#length"><span class="hs-identifier">length</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#length_"><span class="hs-identifier">length_</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#toList"><span class="hs-identifier">toList</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#toList_"><span class="hs-identifier">toList_</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mconcat"><span class="hs-identifier">mconcat</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mconcat_"><span class="hs-identifier">mconcat_</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#minimum"><span class="hs-identifier">minimum</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#minimum_"><span class="hs-identifier">minimum_</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#maximum"><span class="hs-identifier">maximum</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#maximum_"><span class="hs-identifier">maximum_</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldrM"><span class="hs-identifier">foldrM</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldrT"><span class="hs-identifier">foldrT</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- , all</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- , any</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- , and</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- , or</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- , elem</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-comment">-- , find</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-comment">-- , findIndex</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-comment">-- , head</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-comment">-- , index</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-comment">-- , last</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- , length</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-comment">-- , maximum</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-comment">-- , minimum</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-comment">-- , null</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Zips and unzips</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#zip"><span class="hs-identifier">zip</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#zipWith"><span class="hs-identifier">zipWith</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#zip3"><span class="hs-identifier">zip3</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#zipWith3"><span class="hs-identifier">zipWith3</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#unzip"><span class="hs-identifier">unzip</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#partitionEithers"><span class="hs-identifier">partitionEithers</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#partition"><span class="hs-identifier">partition</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Merging streams</span></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="hs-comment">-- $merging</span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#merge"><span class="hs-identifier">merge</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mergeOn"><span class="hs-identifier">mergeOn</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mergeBy"><span class="hs-identifier">mergeBy</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Maybes</span></span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><span class="hs-comment">-- $maybes</span></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#catMaybes"><span class="hs-identifier">catMaybes</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Pair manipulation</span></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#lazily"><span class="hs-identifier">lazily</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#strictly"><span class="hs-identifier">strictly</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#fst%27"><span class="hs-identifier">fst'</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#snd%27"><span class="hs-identifier">snd'</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapOf"><span class="hs-identifier">mapOf</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#_first"><span class="hs-identifier">_first</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#_second"><span class="hs-identifier">_second</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Interoperation</span></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#reread"><span class="hs-identifier">reread</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic Type</span></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier">Stream</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Streaming.Internal.html"><span class="hs-identifier">Streaming.Internal</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Applicative"><span class="hs-identifier">Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Concurrent.html"><span class="hs-identifier">Control.Concurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.IO.html#threadDelay"><span class="hs-identifier">threadDelay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#throwIO"><span class="hs-identifier">throwIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#try"><span class="hs-identifier">try</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#filterM"><span class="hs-identifier">filterM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Traversable.html#mapM"><span class="hs-identifier">mapM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#mapM_"><span class="hs-identifier">mapM_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#foldM"><span class="hs-identifier">foldM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#foldM_"><span class="hs-identifier">foldM_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#replicateM"><span class="hs-identifier">replicateM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Traversable.html#sequence"><span class="hs-identifier">sequence</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.Trans.html"><span class="hs-identifier">Control.Monad.Trans</span></a></span><span>
</span><span id="line-268"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html"><span class="hs-identifier">Data.Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier">Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%24"><span class="hs-operator">(&lt;$)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Compose.html"><span class="hs-identifier">Data.Functor.Compose</span></a></span><span>
</span><span id="line-270"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Identity.html"><span class="hs-identifier">Data.Functor.Identity</span></a></span><span>
</span><span id="line-271"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Functor.Of.html"><span class="hs-identifier">Data.Functor.Of</span></a></span><span>
</span><span id="line-272"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html"><span class="hs-identifier">Data.Functor.Sum</span></a></span><span>
</span><span id="line-273"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Monoid.html"><span class="hs-identifier">Data.Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monoid"><span class="hs-identifier">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mappend"><span class="hs-identifier">mappend</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier">mempty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Ord.html"><span class="hs-identifier">Data.Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Ordering"><span class="hs-identifier">Ordering</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Ord.html#comparing"><span class="hs-identifier">comparing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html"><span class="hs-identifier">Foreign.C.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#Errno"><span class="hs-identifier">Errno</span></a></span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#Errno"><span class="hs-identifier">Errno</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#ePIPE"><span class="hs-identifier">ePIPE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Read.html"><span class="hs-identifier">Text.Read</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Read.html#readMaybe"><span class="hs-identifier">readMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Foldable</span></span><span>
</span><span id="line-278"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntSet.html"><span class="hs-identifier">Data.IntSet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntSet</span></span><span>
</span><span id="line-279"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.html"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-280"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-281"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Word.html#Word64"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html"><span class="hs-identifier">GHC.IO.Exception</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-283"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-284"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier">map</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Traversable.html#mapM"><span class="hs-identifier">mapM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#mapM_"><span class="hs-identifier">mapM_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier">filter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#drop"><span class="hs-identifier">drop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#dropWhile"><span class="hs-identifier">dropWhile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#take"><span class="hs-identifier">take</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mconcat"><span class="hs-identifier">mconcat</span></a></span><span>
</span><span id="line-287"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#sum"><span class="hs-identifier">sum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#product"><span class="hs-identifier">product</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#iterate"><span class="hs-identifier">iterate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#repeat"><span class="hs-identifier">repeat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#cycle"><span class="hs-identifier">cycle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#replicate"><span class="hs-identifier">replicate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#splitAt"><span class="hs-identifier">splitAt</span></a></span><span>
</span><span id="line-288"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#takeWhile"><span class="hs-identifier">takeWhile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#enumFrom"><span class="hs-identifier">enumFrom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#enumFromTo"><span class="hs-identifier">enumFromTo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#enumFromThen"><span class="hs-identifier">enumFromThen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier">length</span></a></span><span>
</span><span id="line-289"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html#print"><span class="hs-identifier">print</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zipWith"><span class="hs-identifier">zipWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier">zip</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zipWith3"><span class="hs-identifier">zipWith3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip3"><span class="hs-identifier">zip3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#unzip"><span class="hs-identifier">unzip</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Prim.html#seq"><span class="hs-identifier">seq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier">show</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Read.html#read"><span class="hs-identifier">read</span></a></span><span>
</span><span id="line-290"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html#readLn"><span class="hs-identifier">readLn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Traversable.html#sequence"><span class="hs-identifier">sequence</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#concat"><span class="hs-identifier">concat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#span"><span class="hs-identifier">span</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#break"><span class="hs-identifier">break</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html#readFile"><span class="hs-identifier">readFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html#writeFile"><span class="hs-identifier">writeFile</span></a></span><span>
</span><span id="line-291"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#minimum"><span class="hs-identifier">minimum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#maximum"><span class="hs-identifier">maximum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#elem"><span class="hs-identifier">elem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#notElem"><span class="hs-identifier">notElem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#all"><span class="hs-identifier">all</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#any"><span class="hs-identifier">any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#head"><span class="hs-identifier">head</span></a></span><span>
</span><span id="line-292"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#last"><span class="hs-identifier">last</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#foldMap"><span class="hs-identifier">foldMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- &gt;&gt;&gt; import Control.Applicative</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Control.Foldl as L</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Bifunctor (first)</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Function ((&amp;))</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.IORef</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Vector (Vector)</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Streaming.Prelude as S</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified System.IO</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- &gt;&gt;&gt; import Text.Read (readEither)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- instance (Eq a) =&gt; Eq1 (Of a) where eq1 = (==)</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- instance (Ord a) =&gt; Ord1 (Of a) where compare1 = compare</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- instance (Read a) =&gt; Read1 (Of a) where readsPrec1 = readsPrec</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- instance (Show a) =&gt; Show1 (Of a) where showsPrec1 = showsPrec</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><span class="hs-comment">{-| Note that 'lazily', 'strictly', 'fst'', and 'mapOf' are all so-called /natural transformations/ on the primitive @Of a@ functor.
    If we write

&gt;  type f ~~&gt; g = forall x . f x -&gt; g x

   then we can restate some types as follows:

&gt;  mapOf            :: (a -&gt; b) -&gt; Of a ~~&gt; Of b   -- Bifunctor first
&gt;  lazily           ::             Of a ~~&gt; (,) a
&gt;  Identity . fst'  ::             Of a ~~&gt; Identity a

   Manipulation of a @Stream f m r@ by mapping often turns on recognizing natural transformations of @f@.
   Thus @maps@ is far more general the the @map@ of the @Streaming.Prelude@, which can be
   defined thus:

&gt;  S.map :: (a -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
&gt;  S.map f = maps (mapOf f)

  i.e.

&gt;  S.map f = maps (\(a :&gt; x) -&gt; (f a :&gt; x))

  This rests on recognizing that @mapOf@ is a natural transformation; note though
  that it results in such a transformation as well:

&gt;  S.map :: (a -&gt; b) -&gt; Stream (Of a) m ~~&gt; Stream (Of b) m

  Thus we can @maps@ it in turn.


 -}</span></span><span>
</span><span id="line-344"></span><span id="local-6989586621679078413"><span id="local-6989586621679078414"><span class="annot"><a href="Streaming.Prelude.html#lazily"><span class="hs-identifier hs-type">lazily</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078413"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078414"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078413"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679078414"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-345"></span><span id="lazily"><span class="annot"><span class="annottext">lazily :: forall a b. Of a b -&gt; (a, b)
</span><a href="Streaming.Prelude.html#lazily"><span class="hs-identifier hs-var hs-var">lazily</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679079670"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079670"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span id="local-6989586621679079672"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079672"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079670"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079672"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#lazily"><span class="hs-pragma hs-type">lazily</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><span class="hs-comment">{-| Convert a standard Haskell pair into a left-strict pair  -}</span></span><span>
</span><span id="line-349"></span><span id="local-6989586621679078418"><span id="local-6989586621679078419"><span class="annot"><a href="Streaming.Prelude.html#strictly"><span class="hs-identifier hs-type">strictly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679078419"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078418"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078419"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-350"></span><span id="strictly"><span class="annot"><span class="annottext">strictly :: forall a b. (a, b) -&gt; Of a b
</span><a href="Streaming.Prelude.html#strictly"><span class="hs-identifier hs-var hs-var">strictly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679079673"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079673"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679079674"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079674"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079673"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Of a b
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079674"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-351"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#strictly"><span class="hs-pragma hs-type">strictly</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><span class="hs-comment">{-| @fst'@ and @snd'@ extract the first and second element of a pair

&gt;&gt;&gt; S.fst' (1:&gt;&quot;hi&quot;)
1
&gt;&gt;&gt; S.snd' (1:&gt;&quot;hi&quot;)
&quot;hi&quot;


     They are contained in the @_first@ and @_second@ lenses,
     if any lens library is in scope

&gt;&gt;&gt; import Lens.Micro
&gt;&gt;&gt; (1:&gt;&quot;hi&quot;) ^. S._first
1
&gt;&gt;&gt; (1:&gt;&quot;hi&quot;) ^. S._second
&quot;hi&quot;

 -}</span></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span id="local-6989586621679078424"><span id="local-6989586621679078425"><span class="annot"><a href="Streaming.Prelude.html#fst%27"><span class="hs-identifier hs-type">fst'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078424"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078425"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078424"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-373"></span><span id="fst%27"><span class="annot"><span class="annottext">fst' :: forall a b. Of a b -&gt; a
</span><a href="Streaming.Prelude.html#fst%27"><span class="hs-identifier hs-var hs-var">fst'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079675"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079675"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079675"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-374"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#fst%27"><span class="hs-pragma hs-type">fst'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-375"></span><span id="local-6989586621679078428"><span id="local-6989586621679078429"><span class="annot"><a href="Streaming.Prelude.html#snd%27"><span class="hs-identifier hs-type">snd'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078428"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078429"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078429"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-376"></span><span id="snd%27"><span class="annot"><span class="annottext">snd' :: forall a b. Of a b -&gt; b
</span><a href="Streaming.Prelude.html#snd%27"><span class="hs-identifier hs-var hs-var">snd'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079676"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079676"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079676"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-377"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#snd%27"><span class="hs-pragma hs-type">snd'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><span class="hs-comment">{-| Map a function over the first element of an @Of@ pair

&gt;&gt;&gt; S.mapOf even (1:&gt;&quot;hi&quot;)
False :&gt; &quot;hi&quot;

     @mapOf@ is just @first@ from the @Bifunctor@ instance

&gt;&gt;&gt; first even (1:&gt;&quot;hi&quot;)
False :&gt; &quot;hi&quot;

     and is contained in the @_first@ lens

&gt;&gt;&gt; import Lens.Micro
&gt;&gt;&gt; over S._first even (1:&gt;&quot;hi&quot;)
False :&gt; &quot;hi&quot;

 -}</span></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span id="local-6989586621679078432"><span id="local-6989586621679078433"><span id="local-6989586621679078434"><span class="annot"><a href="Streaming.Prelude.html#mapOf"><span class="hs-identifier hs-type">mapOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078432"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078433"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078432"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078434"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078433"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078434"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-398"></span><span id="mapOf"><span class="annot"><span class="annottext">mapOf :: forall a b r. (a -&gt; b) -&gt; Of a r -&gt; Of b r
</span><a href="Streaming.Prelude.html#mapOf"><span class="hs-identifier hs-var hs-var">mapOf</span></a></span></span><span> </span><span id="local-6989586621679079677"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679079677"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079678"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079678"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079679"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079679"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679079677"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079678"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; r -&gt; Of b r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079679"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-399"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapOf"><span class="hs-pragma hs-type">mapOf</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="annot"><span class="hs-comment">{-| A lens into the first element of a left-strict pair -}</span></span><span>
</span><span id="line-402"></span><span id="local-6989586621679078438"><span id="local-6989586621679078439"><span id="local-6989586621679078440"><span id="local-6989586621679078441"><span class="annot"><a href="Streaming.Prelude.html#_first"><span class="hs-identifier hs-type">_first</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078438"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078439"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078438"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078440"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078439"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078441"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078438"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078440"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078441"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-403"></span><span id="_first"><span class="annot"><span class="annottext">_first :: forall (f :: * -&gt; *) a a' b.
Functor f =&gt;
(a -&gt; f a') -&gt; Of a b -&gt; f (Of a' b)
</span><a href="Streaming.Prelude.html#_first"><span class="hs-identifier hs-var hs-var">_first</span></a></span></span><span> </span><span id="local-6989586621679079682"><span class="annot"><span class="annottext">a -&gt; f a'
</span><a href="#local-6989586621679079682"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079683"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079683"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079684"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079684"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a' -&gt; Of a' b) -&gt; f a' -&gt; f (Of a' b)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679079685"><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679079685"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679079685"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a' -&gt; b -&gt; Of a' b
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079684"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; f a'
</span><a href="#local-6989586621679079682"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079683"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#_first"><span class="hs-pragma hs-type">_first</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="annot"><span class="hs-comment">{-| A lens into the second element of a left-strict pair -}</span></span><span>
</span><span id="line-407"></span><span id="local-6989586621679078449"><span id="local-6989586621679078450"><span id="local-6989586621679078451"><span id="local-6989586621679078452"><span class="annot"><a href="Streaming.Prelude.html#_second"><span class="hs-identifier hs-type">_second</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078449"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078450"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078449"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078451"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078452"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078450"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078449"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078452"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078451"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-408"></span><span id="_second"><span class="annot"><span class="annottext">_second :: forall (f :: * -&gt; *) b b' a.
Functor f =&gt;
(b -&gt; f b') -&gt; Of a b -&gt; f (Of a b')
</span><a href="Streaming.Prelude.html#_second"><span class="hs-identifier hs-var hs-var">_second</span></a></span></span><span> </span><span id="local-6989586621679079688"><span class="annot"><span class="annottext">b -&gt; f b'
</span><a href="#local-6989586621679079688"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079689"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079689"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079690"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079690"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b' -&gt; Of a b') -&gt; f b' -&gt; f (Of a b')
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679079691"><span class="annot"><span class="annottext">b'
</span><a href="#local-6989586621679079691"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079689"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b' -&gt; Of a b'
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b'
</span><a href="#local-6989586621679079691"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; f b'
</span><a href="#local-6989586621679079688"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679079690"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#_second"><span class="hs-pragma hs-type">_second</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span id="local-6989586621679078457"><span id="local-6989586621679078458"><span id="local-6989586621679078459"><span class="annot"><a href="Streaming.Prelude.html#all"><span class="hs-identifier hs-type">all</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078457"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078458"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078458"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078457"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078459"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078457"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078459"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-412"></span><span id="all"><span class="annot"><span class="annottext">all :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool) -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="Streaming.Prelude.html#all"><span class="hs-identifier hs-var hs-var">all</span></a></span></span><span> </span><span id="local-6989586621679079698"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079698"><span class="hs-identifier hs-var">thus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679079699"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621679079699"><span class="annot"><span class="annottext">loop :: Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679079699"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079700"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079700"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679079701"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079701"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079701"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079703"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079703"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of Bool r -&gt; m (Of Bool r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079700"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079703"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079705"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079705"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079705"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Of Bool r)) -&gt; m (Of Bool r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679079699"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079700"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079707"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079707"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079708"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079708"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079698"><span class="hs-identifier hs-var">thus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079707"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679079699"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079708"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>        </span><span id="local-6989586621679079709"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079709"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var">effects</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079708"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><span class="annottext">Of Bool r -&gt; m (Of Bool r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079709"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#all"><span class="hs-pragma hs-type">all</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span id="local-6989586621679078471"><span id="local-6989586621679078472"><span id="local-6989586621679078473"><span class="annot"><a href="Streaming.Prelude.html#all_"><span class="hs-identifier hs-type">all_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078471"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078472"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078471"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078473"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078471"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span><span>
</span><span id="line-424"></span><span id="all_"><span class="annot"><span class="annottext">all_ :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool) -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="Streaming.Prelude.html#all_"><span class="hs-identifier hs-var hs-var">all_</span></a></span></span><span> </span><span id="local-6989586621679079714"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079714"><span class="hs-identifier hs-var">thus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679079715"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621679079715"><span class="annot"><span class="annottext">loop :: Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679079715"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079716"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079716"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679079717"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079717"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079717"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079716"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079718"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079718"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079718"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; (Stream (Of a) m r -&gt; m Bool) -&gt; m Bool
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679079715"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079716"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079719"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079720"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079720"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079714"><span class="hs-identifier hs-var">thus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079719"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679079715"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079720"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-431"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#all_"><span class="hs-pragma hs-type">all_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span id="local-6989586621679079721"><span id="local-6989586621679079722"><span id="local-6989586621679079723"><span class="annot"><a href="Streaming.Prelude.html#any"><span class="hs-identifier hs-type">any</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079721"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079722"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079722"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079721"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079723"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079721"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079723"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-435"></span><span id="any"><span class="annot"><span class="annottext">any :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool) -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="Streaming.Prelude.html#any"><span class="hs-identifier hs-var hs-var">any</span></a></span></span><span> </span><span id="local-6989586621679079730"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079730"><span class="hs-identifier hs-var">thus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679079731"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-436"></span><span>  </span><span id="local-6989586621679079731"><span class="annot"><span class="annottext">loop :: Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679079731"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079732"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079732"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679079733"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079733"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079733"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079734"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079734"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of Bool r -&gt; m (Of Bool r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079732"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079734"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079735"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079735"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079735"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Of Bool r)) -&gt; m (Of Bool r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679079731"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079732"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079736"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079736"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079737"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079737"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079730"><span class="hs-identifier hs-var">thus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079736"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>        </span><span id="local-6989586621679079738"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079738"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var">effects</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079737"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><span class="annottext">Of Bool r -&gt; m (Of Bool r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079738"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679079731"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079737"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-444"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#any"><span class="hs-pragma hs-type">any</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span id="local-6989586621679079739"><span id="local-6989586621679079740"><span id="local-6989586621679079741"><span class="annot"><a href="Streaming.Prelude.html#any_"><span class="hs-identifier hs-type">any_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079739"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079740"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079740"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079739"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079741"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079739"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span><span>
</span><span id="line-447"></span><span id="any_"><span class="annot"><span class="annottext">any_ :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool) -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="Streaming.Prelude.html#any_"><span class="hs-identifier hs-var hs-var">any_</span></a></span></span><span> </span><span id="local-6989586621679079746"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079746"><span class="hs-identifier hs-var">thus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679079747"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621679079747"><span class="annot"><span class="annottext">loop :: Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679079747"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079748"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079748"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679079749"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079749"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079749"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079748"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079750"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079750"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079750"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; (Stream (Of a) m r -&gt; m Bool) -&gt; m Bool
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679079747"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679079748"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079751"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079751"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079752"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079752"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079746"><span class="hs-identifier hs-var">thus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079751"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-453"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679079747"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079752"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-454"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#any_"><span class="hs-pragma hs-type">any_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="annot"><span class="hs-comment">{-| Break a sequence upon meeting element falls under a predicate,
    keeping it and the rest of the stream as the return value.

&gt;&gt;&gt; rest &lt;- S.print $ S.break even $ each [1,1,2,3]
1
1
&gt;&gt;&gt; S.print rest
2
3

-}</span></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span id="local-6989586621679078483"><span id="local-6989586621679078484"><span id="local-6989586621679078485"><span class="annot"><a href="Streaming.Prelude.html#break"><span class="hs-identifier hs-type">break</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078483"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078484"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078484"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078483"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078485"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078484"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078483"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078484"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078483"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078485"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-470"></span><span id="break"><span class="annot"><span class="annottext">break :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="Streaming.Prelude.html#break"><span class="hs-identifier hs-var hs-var">break</span></a></span></span><span> </span><span id="local-6989586621679079759"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079759"><span class="hs-identifier hs-var">thePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079760"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621679079760"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079760"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079761"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079761"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079761"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079762"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079762"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079762"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079763"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079763"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m (Stream (Of a) m r))
 -&gt; Stream (Of a) m (Stream (Of a) m r))
-&gt; m (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r))
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m (Stream (Of a) m r))
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079760"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079763"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079764"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079764"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079765"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079765"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079759"><span class="hs-identifier hs-var">thePred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079764"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-475"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079764"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079765"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079764"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Of a (Stream (Of a) m (Stream (Of a) m r))
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079760"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079765"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#break"><span class="hs-pragma hs-type">break</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="annot"><span class="hs-comment">{-| Yield elements, using a fold to maintain state, until the accumulated
   value satifies the supplied predicate. The fold will then be short-circuited
   and the element that breaks it will be put after the break.
   This function is easiest to use with 'Control.Foldl.purely'

&gt;&gt;&gt; rest &lt;- each [1..10] &amp; L.purely S.breakWhen L.sum (&gt;10) &amp; S.print
1
2
3
4
&gt;&gt;&gt; S.print rest
5
6
7
8
9
10

-}</span></span><span>
</span><span id="line-498"></span><span id="local-6989586621679078496"><span id="local-6989586621679078497"><span id="local-6989586621679078498"><span id="local-6989586621679078499"><span id="local-6989586621679078500"><span class="annot"><a href="Streaming.Prelude.html#breakWhen"><span class="hs-identifier hs-type">breakWhen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078496"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078497"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078498"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078497"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078497"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078497"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078499"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078499"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078498"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078496"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078500"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078498"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078496"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078498"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078496"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078500"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-499"></span><span id="breakWhen"><span class="annot"><span class="annottext">breakWhen :: forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x)
-&gt; x
-&gt; (x -&gt; b)
-&gt; (b -&gt; Bool)
-&gt; Stream (Of a) m r
-&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="Streaming.Prelude.html#breakWhen"><span class="hs-identifier hs-var hs-var">breakWhen</span></a></span></span><span> </span><span id="local-6989586621679079785"><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679079785"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679079786"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079786"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679079787"><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679079787"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span id="local-6989586621679079788"><span class="annot"><span class="annottext">b -&gt; Bool
</span><a href="#local-6989586621679079788"><span class="hs-identifier hs-var">thePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079789"><span class="hs-identifier hs-var">loop0</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079786"><span class="hs-identifier hs-var">begin</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>    </span><span id="local-6989586621679079789"><span class="annot"><span class="annottext">loop0 :: x -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079789"><span class="hs-identifier hs-var hs-var">loop0</span></a></span></span><span> </span><span id="local-6989586621679079790"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079790"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679079791"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079791"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079791"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079792"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079792"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079792"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079793"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079793"><span class="hs-identifier hs-var">mn</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m (Stream (Of a) m r))
 -&gt; Stream (Of a) m (Stream (Of a) m r))
-&gt; m (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r))
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m (Stream (Of a) m r))
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079789"><span class="hs-identifier hs-var">loop0</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079790"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079793"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-504"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079794"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079794"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079795"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079795"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079796"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079794"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679079785"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079790"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079794"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079795"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621679079796"><span class="annot"><span class="annottext">loop :: a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079796"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079797"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079797"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679079798"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079798"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679079799"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079799"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-506"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">b -&gt; Bool
</span><a href="#local-6989586621679079788"><span class="hs-identifier hs-var">thePred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679079787"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079798"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079797"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m () -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
forall a b.
Stream (Of a) m a -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079799"><span class="hs-identifier hs-var">stream</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079799"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-509"></span><span>          </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079800"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079800"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079797"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall a b.
Stream (Of a) m a -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079800"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>          </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079801"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079801"><span class="hs-identifier hs-var">mn</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m (Stream (Of a) m r))
 -&gt; Stream (Of a) m (Stream (Of a) m r))
-&gt; m (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r))
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m (Stream (Of a) m r))
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079796"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079797"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079798"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079801"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-511"></span><span>          </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079802"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079802"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079803"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079803"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span>            </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079797"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-513"></span><span>            </span><span class="annot"><span class="annottext">a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679079796"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079802"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679079785"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679079798"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079802"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079803"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-514"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#breakWhen"><span class="hs-pragma hs-type">breakWhen</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="annot"><span class="hs-comment">{-| Break during periods where the predicate is not satisfied, grouping the periods when it is.

&gt;&gt;&gt; S.print $ mapped S.toList $ S.breaks not $ S.each [False,True,True,False,True,True,False]
[True,True]
[True,True]
&gt;&gt;&gt; S.print $ mapped S.toList $ S.breaks id $ S.each [False,True,True,False,True,True,False]
[False]
[False]
[False]

-}</span></span><span>
</span><span id="line-527"></span><span id="local-6989586621679078513"><span id="local-6989586621679078514"><span id="local-6989586621679078515"><span class="annot"><a href="Streaming.Prelude.html#breaks"><span class="hs-identifier hs-type">breaks</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078513"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-529"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078513"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078515"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078513"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078513"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078515"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-530"></span><span id="breaks"><span class="annot"><span class="annottext">breaks :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool) -&gt; Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="Streaming.Prelude.html#breaks"><span class="hs-identifier hs-var hs-var">breaks</span></a></span></span><span> </span><span id="local-6989586621679079814"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079814"><span class="hs-identifier hs-var">thus</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679079815"><span class="hs-identifier hs-var">loop</span></a></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-531"></span><span>  </span><span id="local-6989586621679079815"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679079815"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079816"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079816"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Stream (Of a) m) m r) -&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Stream (Of a) m) m r) -&gt; Stream (Stream (Of a) m) m r)
-&gt; m (Stream (Stream (Of a) m) m r) -&gt; Stream (Stream (Of a) m) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>    </span><span id="local-6989586621679079817"><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679079817"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079816"><span class="hs-identifier hs-var">stream</span></a></span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><span class="annottext">Stream (Stream (Of a) m) m r -&gt; m (Stream (Stream (Of a) m) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Stream (Of a) m) m r -&gt; m (Stream (Stream (Of a) m) m r))
-&gt; Stream (Stream (Of a) m) m r -&gt; m (Stream (Stream (Of a) m) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679079817"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-534"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span>   </span><span id="local-6989586621679079818"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079818"><span class="hs-identifier hs-var">r</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079818"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-535"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079819"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079819"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079820"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079820"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-536"></span><span>       </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079814"><span class="hs-identifier hs-var">thus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079819"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Stream (Of a) m) m r)
-&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m (Stream (Stream (Of a) m) m r)
 -&gt; Stream (Stream (Of a) m) m r)
-&gt; Stream (Of a) m (Stream (Stream (Of a) m) m r)
-&gt; Stream (Stream (Of a) m) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Stream (Of a) m) m r)
forall a b. (a -&gt; b) -&gt; Stream (Of a) m a -&gt; Stream (Of a) m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679079815"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079819"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall a b.
Stream (Of a) m a -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="Streaming.Prelude.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079814"><span class="hs-identifier hs-var">thus</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079820"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679079815"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079820"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-539"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#breaks"><span class="hs-pragma hs-type">breaks</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="annot"><span class="hs-comment">{-| Apply an action to all values, re-yielding each.
    The return value (@y@) of the function is ignored.

&gt;&gt;&gt; S.product $ S.chain Prelude.print $ S.each [1..5]
1
2
3
4
5
120 :&gt; ()

See also 'mapM' for a variant of this which uses the return value of the function to transorm the values in the stream.
-}</span></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span id="local-6989586621679078524"><span id="local-6989586621679078525"><span id="local-6989586621679078526"><span id="local-6989586621679078527"><span class="annot"><a href="Streaming.Prelude.html#chain"><span class="hs-identifier hs-type">chain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078525"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078526"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078525"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078527"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078525"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078527"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-556"></span><span id="chain"><span class="annot"><span class="annottext">chain :: forall (m :: * -&gt; *) a y r.
Monad m =&gt;
(a -&gt; m y) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#chain"><span class="hs-identifier hs-var hs-var">chain</span></a></span></span><span> </span><span id="local-6989586621679079830"><span class="annot"><span class="annottext">a -&gt; m y
</span><a href="#local-6989586621679079830"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079831"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621679079831"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079831"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079832"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079832"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079832"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079833"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079833"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079833"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079834"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079834"><span class="hs-identifier hs-var">mn</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079831"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079834"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079835"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079835"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079836"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079836"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m r) -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-561"></span><span>      </span><span class="annot"><span class="annottext">y
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; m y
</span><a href="#local-6989586621679079830"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079835"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-562"></span><span>      </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079835"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079831"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079836"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#chain"><span class="hs-pragma hs-type">chain</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="annot"><span class="hs-comment">{-| Make a stream of foldable containers into a stream of their separate elements.
    This is just

&gt; concat str = for str each

&gt;&gt;&gt; S.print $ S.concat (each [&quot;xy&quot;,&quot;z&quot;])
'x'
'y'
'z'

    Note that it also has the effect of 'Data.Maybe.catMaybes', 'Data.Either.rights'
    @map snd@ and such-like operations.

&gt;&gt;&gt; S.print $ S.concat $ S.each [Just 1, Nothing, Just 2]
1
2
&gt;&gt;&gt; S.print $  S.concat $ S.each [Right 1, Left &quot;Error!&quot;, Right 2]
1
2
&gt;&gt;&gt; S.print $ S.concat $ S.each [('A',1), ('B',2)]
1
2

-}</span></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span id="local-6989586621679078532"><span id="local-6989586621679078533"><span id="local-6989586621679078534"><span id="local-6989586621679078535"><span class="annot"><a href="Streaming.Prelude.html#concat"><span class="hs-identifier hs-type">concat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078532"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable.Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078533"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078533"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078534"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078532"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078535"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078534"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078532"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078535"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-591"></span><span id="concat"><span class="annot"><span class="annottext">concat :: forall (m :: * -&gt; *) (f :: * -&gt; *) a r.
(Monad m, Foldable f) =&gt;
Stream (Of (f a)) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#concat"><span class="hs-identifier hs-var hs-var">concat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of (f a)) m r -&gt; Stream (Of a) m r
forall {m :: * -&gt; *} {t :: * -&gt; *} {a} {r}.
(Functor m, Foldable t) =&gt;
Stream (Of (t a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079843"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621679079843"><span class="annot"><span class="annottext">loop :: Stream (Of (t a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079843"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079848"><span class="annot"><span class="annottext">Stream (Of (t a)) m r
</span><a href="#local-6989586621679079848"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of (t a)) m r
</span><a href="#local-6989586621679079848"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-594"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079849"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079849"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079849"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-595"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079850"><span class="annot"><span class="annottext">m (Stream (Of (t a)) m r)
</span><a href="#local-6989586621679079850"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of (t a)) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of (t a)) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (t a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079843"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of (t a)) m r)
</span><a href="#local-6989586621679079850"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079851"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679079851"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079852"><span class="annot"><span class="annottext">Stream (Of (t a)) m r
</span><a href="#local-6989586621679079852"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-597"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079853"><span class="annot"><span class="annottext">inner :: [a] -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079853"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of (t a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079843"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (t a)) m r
</span><a href="#local-6989586621679079852"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-598"></span><span>              </span><span class="annot"><a href="#local-6989586621679079853"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079854"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079854"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679079855"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679079855"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079854"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079853"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679079855"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079853"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; [a]
forall a. t a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">Foldable.toList</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679079851"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#concat"><span class="hs-pragma hs-type">concat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-601"></span><span class="hs-comment">-- The above hand-written loop is ~20% faster than the 'for' implementation</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- concat str = for str each</span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="annot"><span class="hs-comment">{-| The natural @cons@ for a @Stream (Of a)@.

&gt; cons a stream = yield a &gt;&gt; stream

   Useful for interoperation:

&gt; Data.Text.foldr S.cons (return ()) :: Text -&gt; Stream (Of Char) m ()
&gt; Lazy.foldrChunks S.cons (return ()) :: Lazy.ByteString -&gt; Stream (Of Strict.ByteString) m ()

    and so on.
-}</span></span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span id="local-6989586621679078546"><span id="local-6989586621679078547"><span id="local-6989586621679078548"><span class="annot"><a href="Streaming.Prelude.html#cons"><span class="hs-identifier hs-type">cons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078546"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078547"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078547"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078546"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078548"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078547"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078546"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078548"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-617"></span><span id="cons"><span class="annot"><span class="annottext">cons :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
a -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#cons"><span class="hs-identifier hs-var hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679079858"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079858"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679079859"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079859"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079858"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079859"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#cons"><span class="hs-pragma hs-type">cons</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="annot"><span class="hs-comment">{- | Cycle repeatedly through the layers of a stream, /ad inf./ This
     function is functor-general

&gt; cycle = forever

&gt;&gt;&gt; rest &lt;- S.print $ S.splitAt 3 $ S.cycle (yield True &gt;&gt; yield False)
True
False
True
&gt;&gt;&gt; S.print $ S.take 3 rest
False
True
False

-}</span></span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span id="local-6989586621679078552"><span id="local-6989586621679078553"><span id="local-6989586621679078554"><span id="local-6989586621679078555"><span class="annot"><a href="Streaming.Prelude.html#cycle"><span class="hs-identifier hs-type">cycle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078552"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078553"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078553"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078552"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078554"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078553"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078552"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078555"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span><span>
</span><span id="line-637"></span><span id="cycle"><span class="annot"><span class="annottext">cycle :: forall (m :: * -&gt; *) (f :: * -&gt; *) r s.
(Monad m, Functor f) =&gt;
Stream f m r -&gt; Stream f m s
</span><a href="Streaming.Prelude.html#cycle"><span class="hs-identifier hs-var hs-var">cycle</span></a></span></span><span> </span><span id="local-6989586621679079863"><span class="annot"><span class="annottext">Stream f m r
</span><a href="#local-6989586621679079863"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream f m s
</span><a href="#local-6989586621679079864"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679079864"><span class="annot"><span class="annottext">loop :: Stream f m s
</span><a href="#local-6989586621679079864"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream f m r
</span><a href="#local-6989586621679079863"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m r -&gt; Stream f m s -&gt; Stream f m s
forall a b. Stream f m a -&gt; Stream f m b -&gt; Stream f m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m s
</span><a href="#local-6989586621679079864"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-638"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#cycle"><span class="hs-pragma hs-type">cycle</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="annot"><span class="hs-comment">{-| Interpolate a delay of n seconds between yields.
-}</span></span><span>
</span><span id="line-643"></span><span id="local-6989586621679078560"><span id="local-6989586621679078562"><span id="local-6989586621679078563"><span class="annot"><a href="Streaming.Prelude.html#delay"><span class="hs-identifier hs-type">delay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078560"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078562"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078560"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078563"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078562"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078560"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078563"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-644"></span><span id="delay"><span class="annot"><span class="annottext">delay :: forall (m :: * -&gt; *) a r.
MonadIO m =&gt;
Double -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#delay"><span class="hs-identifier hs-var hs-var">delay</span></a></span></span><span> </span><span id="local-6989586621679079886"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679079886"><span class="hs-identifier hs-var">seconds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079887"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-645"></span><span>  </span><span id="local-6989586621679079888"><span class="annot"><span class="annottext">pico :: Int
</span><a href="#local-6989586621679079888"><span class="hs-identifier hs-var hs-var">pico</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#truncate"><span class="hs-identifier hs-var">truncate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679079886"><span class="hs-identifier hs-var">seconds</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>  </span><span id="local-6989586621679079887"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079887"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079891"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-647"></span><span>    </span><span id="local-6989586621679079892"><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679079892"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either r (a, Stream (Of a) m r))
-&gt; Stream (Of a) m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of a) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either r (a, Stream (Of a) m r))
 -&gt; Stream (Of a) m (Either r (a, Stream (Of a) m r)))
-&gt; m (Either r (a, Stream (Of a) m r))
-&gt; Stream (Of a) m (Either r (a, Stream (Of a) m r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679079892"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-649"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679079894"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079894"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079894"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-650"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079895"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079895"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679079896"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079896"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-651"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079895"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-652"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; Stream (Of a) m ()
forall a. IO a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Stream (Of a) m ()) -&gt; IO () -&gt; Stream (Of a) m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.IO.html#threadDelay"><span class="hs-identifier hs-var">threadDelay</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079888"><span class="hs-identifier hs-var">pico</span></a></span><span>
</span><span id="line-653"></span><span>        </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079887"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079896"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-654"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#delay"><span class="hs-pragma hs-type">delay</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="annot"><span class="hs-comment">{-| Where a transformer returns a stream, run the effects of the stream, keeping
   the return value. This is usually used at the type

&gt; drained :: Monad m =&gt; Stream (Of a) m (Stream (Of b) m r) -&gt; Stream (Of a) m r
&gt; drained = join . fmap (lift . effects)

   Here, for example, we split a stream in two places and throw out the middle segment:

&gt;&gt;&gt; rest &lt;- S.print $ S.drained $ S.splitAt 2 $ S.splitAt 5 $ each [1..7]
1
2
&gt;&gt;&gt; S.print rest
6
7

   In particular, we can define versions  of @take@ and @takeWhile@ which
   retrieve the return value of the rest of the stream - and which can
   thus be used with 'maps':

&gt; take' n = S.drained . S.splitAt n
&gt; takeWhile' thus = S.drained . S.span thus

-}</span></span><span>
</span><span id="line-681"></span><span id="local-6989586621679078579"><span id="local-6989586621679078580"><span id="local-6989586621679078581"><span id="local-6989586621679078582"><span class="annot"><a href="Streaming.Prelude.html#drained"><span class="hs-identifier hs-type">drained</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078579"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078580"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078579"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#MonadTrans"><span class="hs-identifier hs-type">MonadTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078580"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078580"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078579"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078581"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078579"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078582"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078580"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078579"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078582"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-682"></span><span id="drained"><span class="annot"><span class="annottext">drained :: forall (m :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) a r.
(Monad m, Monad (t m), MonadTrans t) =&gt;
t m (Stream (Of a) m r) -&gt; t m r
</span><a href="Streaming.Prelude.html#drained"><span class="hs-identifier hs-var hs-var">drained</span></a></span></span><span> </span><span id="local-6989586621679079905"><span class="annot"><span class="annottext">t m (Stream (Of a) m r)
</span><a href="#local-6989586621679079905"><span class="hs-identifier hs-var">tms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t m (Stream (Of a) m r)
</span><a href="#local-6989586621679079905"><span class="hs-identifier hs-var">tms</span></a></span><span> </span><span class="annot"><span class="annottext">t m (Stream (Of a) m r) -&gt; (Stream (Of a) m r -&gt; t m r) -&gt; t m r
forall a b. t m a -&gt; (a -&gt; t m b) -&gt; t m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m r -&gt; t m r
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(m r -&gt; t m r)
-&gt; (Stream (Of a) m r -&gt; m r) -&gt; Stream (Of a) m r -&gt; t m r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var">effects</span></a></span><span>
</span><span id="line-683"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#drained"><span class="hs-pragma hs-type">drained</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-686"></span><span class="hs-comment">-- drop</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-688"></span><span class="annot"><span class="hs-comment">{-|  Ignore the first n elements of a stream, but carry out the actions

&gt;&gt;&gt; S.toList $ S.drop 2 $ S.replicateM 5 getLine
a&lt;Enter&gt;
b&lt;Enter&gt;
c&lt;Enter&gt;
d&lt;Enter&gt;
e&lt;Enter&gt;
[&quot;c&quot;,&quot;d&quot;,&quot;e&quot;] :&gt; ()

     Because it retains the final return value, @drop n@  is a suitable argument
     for @maps@:

&gt;&gt;&gt; S.toList $ concats $ maps (S.drop 4) $ chunksOf 5 $ each [1..20]
[5,10,15,20] :&gt; ()
  -}</span></span><span>
</span><span id="line-704"></span><span>
</span><span id="line-705"></span><span id="local-6989586621679078590"><span id="local-6989586621679078591"><span id="local-6989586621679078592"><span class="annot"><a href="Streaming.Prelude.html#drop"><span class="hs-identifier hs-type">drop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078590"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078591"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078590"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078592"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078591"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078590"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078592"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-706"></span><span id="drop"><span class="annot"><span class="annottext">drop :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Int -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#drop"><span class="hs-identifier hs-var hs-var">drop</span></a></span></span><span> </span><span id="local-6989586621679079918"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079918"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679079919"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079919"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079918"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079919"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-707"></span><span class="annot"><a href="Streaming.Prelude.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span id="local-6989586621679079921"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079921"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679079922"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079922"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
forall {t} {m :: * -&gt; *} {a} {r}.
(Eq t, Num t, Functor m) =&gt;
t -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079923"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079921"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079922"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-708"></span><span>  </span><span id="local-6989586621679079923"><span class="annot"><span class="annottext">loop :: t -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079923"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679079932"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079932"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079932"><span class="hs-identifier hs-var">stream</span></a></span><span>
</span><span id="line-709"></span><span>  </span><span class="annot"><a href="#local-6989586621679079923"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679079933"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679079933"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679079934"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079934"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079934"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-710"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079935"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079935"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079935"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-711"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079936"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079936"><span class="hs-identifier hs-var">ma</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079923"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679079933"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079936"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079937"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079937"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079923"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679079933"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079937"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-713"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#drop"><span class="hs-pragma hs-type">drop</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- dropWhile</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="annot"><span class="hs-comment">{- | Ignore elements of a stream until a test succeeds, retaining the rest.

&gt;&gt;&gt; S.print $ S.dropWhile ((&lt; 5) . length) S.stdinLn
one&lt;Enter&gt;
two&lt;Enter&gt;
three&lt;Enter&gt;
&quot;three&quot;
four&lt;Enter&gt;
&quot;four&quot;
^CInterrupted.


-}</span></span><span>
</span><span id="line-732"></span><span id="local-6989586621679078601"><span id="local-6989586621679078602"><span id="local-6989586621679078603"><span class="annot"><a href="Streaming.Prelude.html#dropWhile"><span class="hs-identifier hs-type">dropWhile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078601"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078602"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078602"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078601"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078603"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078602"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078601"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078603"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-733"></span><span id="dropWhile"><span class="annot"><span class="annottext">dropWhile :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#dropWhile"><span class="hs-identifier hs-var hs-var">dropWhile</span></a></span></span><span> </span><span id="local-6989586621679079942"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079942"><span class="hs-identifier hs-var">thePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079943"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-734"></span><span>  </span><span id="local-6989586621679079943"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079943"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079944"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079944"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079944"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-735"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079945"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079945"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679079945"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-736"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079946"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079946"><span class="hs-identifier hs-var">ma</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079943"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679079946"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079947"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079947"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079948"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079948"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679079942"><span class="hs-identifier hs-var">thePred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079947"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-738"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679079943"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079948"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-739"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079947"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679079948"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#dropWhile"><span class="hs-pragma hs-type">dropWhile</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- each</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="annot"><span class="hs-comment">{- | Stream the elements of a pure, foldable container.

&gt;&gt;&gt; S.print $ each [1..3]
1
2
3


-}</span></span><span>
</span><span id="line-755"></span><span id="local-6989586621679078607"><span id="local-6989586621679078608"><span id="local-6989586621679078609"><span class="annot"><a href="Streaming.Prelude.html#each"><span class="hs-identifier hs-type">each</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078607"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable.Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078608"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078608"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078609"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078609"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078607"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-756"></span><span id="each"><span class="annot"><span class="annottext">each :: forall (m :: * -&gt; *) (f :: * -&gt; *) a.
(Monad m, Foldable f) =&gt;
f a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#each"><span class="hs-identifier hs-var hs-var">each</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Stream (Of a) m () -&gt; Stream (Of a) m ())
-&gt; Stream (Of a) m () -&gt; f a -&gt; Stream (Of a) m ()
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; f a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">Foldable.foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679079953"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079953"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679079954"><span class="annot"><span class="annottext">Stream (Of a) m ()
</span><a href="#local-6989586621679079954"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079953"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m () -&gt; Of a (Stream (Of a) m ())
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
</span><a href="#local-6989586621679079954"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#each"><span class="hs-pragma hs-type">each</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-758"></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- effects</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="annot"><span class="hs-comment">{- | Reduce a stream, performing its actions but ignoring its elements.

&gt;&gt;&gt; rest &lt;- S.effects $ S.splitAt 2 $ each [1..5]
&gt;&gt;&gt; S.print rest
3
4
5

    'effects' should be understood together with 'copy' and is subject to the rules

&gt; S.effects . S.copy       = id
&gt; hoist S.effects . S.copy = id

    The similar @effects@ and @copy@ operations in @Data.ByteString.Streaming@ obey the same rules.

-}</span></span><span>
</span><span id="line-780"></span><span id="local-6989586621679078468"><span id="local-6989586621679078469"><span id="local-6989586621679078470"><span class="annot"><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-type">effects</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078468"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078469"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078468"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078470"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078468"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078470"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-781"></span><span id="effects"><span class="annot"><span class="annottext">effects :: forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var hs-var">effects</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679079957"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-782"></span><span>  </span><span id="local-6989586621679079957"><span class="annot"><span class="annottext">loop :: Stream (Of a) m a -&gt; m a
</span><a href="#local-6989586621679079957"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079965"><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679079965"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679079965"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-783"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679079966"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079966"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079966"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-784"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679079967"><span class="annot"><span class="annottext">m (Stream (Of a) m a)
</span><a href="#local-6989586621679079967"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m a)
</span><a href="#local-6989586621679079967"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m a) -&gt; (Stream (Of a) m a -&gt; m a) -&gt; m a
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a -&gt; m a
</span><a href="#local-6989586621679079957"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-785"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679079968"><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679079968"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a -&gt; m a
</span><a href="#local-6989586621679079957"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679079968"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-786"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#effects"><span class="hs-pragma hs-type">effects</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="annot"><span class="hs-comment">{-| Before evaluating the monadic action returning the next step in the 'Stream', @wrapEffect@
    extracts the value in a monadic computation @m a@ and passes it to a computation @a -&gt; m y@.

-}</span></span><span>
</span><span id="line-792"></span><span id="local-6989586621679078621"><span id="local-6989586621679078622"><span id="local-6989586621679078623"><span id="local-6989586621679078624"><span id="local-6989586621679078625"><span class="annot"><a href="Streaming.Prelude.html#wrapEffect"><span class="hs-identifier hs-type">wrapEffect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078621"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078622"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078623"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078623"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078624"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078622"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078625"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078622"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078625"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-793"></span><span id="wrapEffect"><span class="annot"><span class="annottext">wrapEffect :: forall (m :: * -&gt; *) (f :: * -&gt; *) a y r.
(Monad m, Functor f) =&gt;
m a -&gt; (a -&gt; m y) -&gt; Stream f m r -&gt; Stream f m r
</span><a href="Streaming.Prelude.html#wrapEffect"><span class="hs-identifier hs-var hs-var">wrapEffect</span></a></span></span><span> </span><span id="local-6989586621679079986"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679079986"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679079987"><span class="annot"><span class="annottext">a -&gt; m y
</span><a href="#local-6989586621679079987"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream f m r -&gt; Stream f m r
</span><a href="#local-6989586621679079988"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-794"></span><span>  </span><span id="local-6989586621679079988"><span class="annot"><span class="annottext">loop :: Stream f m r -&gt; Stream f m r
</span><a href="#local-6989586621679079988"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679079989"><span class="annot"><span class="annottext">Stream f m r
</span><a href="#local-6989586621679079989"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-795"></span><span>    </span><span id="local-6989586621679079990"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079990"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a -&gt; Stream f m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream f m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679079986"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-796"></span><span>    </span><span id="local-6989586621679079991"><span class="annot"><span class="annottext">Either r (f (Stream f m r))
</span><a href="#local-6989586621679079991"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either r (f (Stream f m r)))
-&gt; Stream f m (Either r (f (Stream f m r)))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream f m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either r (f (Stream f m r)))
 -&gt; Stream f m (Either r (f (Stream f m r))))
-&gt; m (Either r (f (Stream f m r)))
-&gt; Stream f m (Either r (f (Stream f m r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m r -&gt; m (Either r (f (Stream f m r)))
forall (m :: * -&gt; *) (f :: * -&gt; *) r.
Monad m =&gt;
Stream f m r -&gt; m (Either r (f (Stream f m r)))
</span><a href="Streaming.Internal.html#inspect"><span class="hs-identifier hs-var">inspect</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m r
</span><a href="#local-6989586621679079989"><span class="hs-identifier hs-var">stream</span></a></span><span>
</span><span id="line-797"></span><span>    </span><span class="annot"><span class="annottext">y
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m y -&gt; Stream f m y
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream f m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(m y -&gt; Stream f m y) -&gt; m y -&gt; Stream f m y
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m y
</span><a href="#local-6989586621679079987"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079990"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-798"></span><span>    </span><span class="annot"><span class="annottext">(r -&gt; Stream f m r)
-&gt; (f (Stream f m r) -&gt; Stream f m r)
-&gt; Either r (f (Stream f m r))
-&gt; Stream f m r
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#either"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream f m r
forall a. a -&gt; Stream f m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">f (Stream f m r) -&gt; Stream f m r
</span><a href="#local-6989586621679079994"><span class="hs-identifier hs-var">loop'</span></a></span><span> </span><span class="annot"><span class="annottext">Either r (f (Stream f m r))
</span><a href="#local-6989586621679079991"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-799"></span><span>  </span><span id="local-6989586621679079994"><span class="annot"><span class="annottext">loop' :: f (Stream f m r) -&gt; Stream f m r
</span><a href="#local-6989586621679079994"><span class="hs-identifier hs-var hs-var">loop'</span></a></span></span><span> </span><span id="local-6989586621679079995"><span class="annot"><span class="annottext">f (Stream f m r)
</span><a href="#local-6989586621679079995"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Stream f m r) -&gt; Stream f m r
forall (m :: * -&gt; *) (f :: * -&gt; *) r.
(Monad m, Functor f) =&gt;
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream f m r -&gt; Stream f m r)
-&gt; f (Stream f m r) -&gt; f (Stream f m r)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m r -&gt; Stream f m r
</span><a href="#local-6989586621679079988"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">f (Stream f m r)
</span><a href="#local-6989586621679079995"><span class="hs-identifier hs-var">stream</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span class="annot"><span class="hs-comment">{-| Exhaust a stream remembering only whether @a@ was an element.

-}</span></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span id="local-6989586621679078643"><span id="local-6989586621679078644"><span id="local-6989586621679078645"><span class="annot"><a href="Streaming.Prelude.html#elem"><span class="hs-identifier hs-type">elem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078643"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078644"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078643"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078645"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078643"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078645"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-806"></span><span id="elem"><span class="annot"><span class="annottext">elem :: forall (m :: * -&gt; *) a r.
(Monad m, Eq a) =&gt;
a -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="Streaming.Prelude.html#elem"><span class="hs-identifier hs-var hs-var">elem</span></a></span></span><span> </span><span id="local-6989586621679080008"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080008"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679080009"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-807"></span><span>  </span><span id="local-6989586621679080009"><span class="annot"><span class="annottext">loop :: Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679080009"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span id="local-6989586621679080010"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080010"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; Of Bool r) -&gt; m r -&gt; m (Of Bool r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var">effects</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080010"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>  </span><span class="annot"><a href="#local-6989586621679080009"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span id="local-6989586621679080011"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080011"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080011"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-809"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080012"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080012"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of Bool r -&gt; m (Of Bool r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080012"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080013"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080013"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080013"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Of Bool r)) -&gt; m (Of Bool r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679080009"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-811"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080014"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080014"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080015"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080015"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-812"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080014"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080008"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-813"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(r -&gt; Of Bool r) -&gt; m r -&gt; m (Of Bool r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var">effects</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080015"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-814"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679080009"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080015"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-815"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#elem"><span class="hs-pragma hs-type">elem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span id="local-6989586621679078650"><span id="local-6989586621679078651"><span id="local-6989586621679078652"><span class="annot"><a href="Streaming.Prelude.html#elem_"><span class="hs-identifier hs-type">elem_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078650"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078651"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078651"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078650"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078652"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078650"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span><span>
</span><span id="line-818"></span><span id="elem_"><span class="annot"><span class="annottext">elem_ :: forall (m :: * -&gt; *) a r.
(Monad m, Eq a) =&gt;
a -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="Streaming.Prelude.html#elem_"><span class="hs-identifier hs-var hs-var">elem_</span></a></span></span><span> </span><span id="local-6989586621679080023"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080023"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679080024"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-819"></span><span>  </span><span id="local-6989586621679080024"><span class="annot"><span class="annottext">loop :: Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679080024"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-820"></span><span>  </span><span class="annot"><a href="#local-6989586621679080024"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span id="local-6989586621679080025"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080025"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080025"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-821"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-822"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080026"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080026"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080026"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; (Stream (Of a) m r -&gt; m Bool) -&gt; m Bool
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679080024"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-823"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080027"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080027"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080028"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080028"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-824"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080027"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080023"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-825"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-826"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679080024"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080028"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-827"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#elem_"><span class="hs-pragma hs-type">elem_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span class="hs-comment">-- -----</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- enumFrom</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- ------</span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span class="annot"><span class="hs-comment">{-| An infinite stream of enumerable values, starting from a given value.
    It is the same as @S.iterate succ@.
    Because their return type is polymorphic, @enumFrom@, @enumFromThen@
    and @iterate@ are useful with functions like @zip@ and @zipWith@, which
    require the zipped streams to have the same return type. 

    For example, with
    @each [1..]@ the following bit of connect-and-resume would not compile:

&gt;&gt;&gt; rest &lt;- S.print $ S.zip (S.enumFrom 1) $ S.splitAt 3 $ S.each ['a'..'z']
(1,'a')
(2,'b')
(3,'c')
&gt;&gt;&gt;  S.print $ S.take 3 rest
'd'
'e'
'f'

-}</span></span><span>
</span><span id="line-852"></span><span id="local-6989586621679078656"><span id="local-6989586621679078657"><span id="local-6989586621679078658"><span class="annot"><a href="Streaming.Prelude.html#enumFrom"><span class="hs-identifier hs-type">enumFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078656"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#Enum"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078657"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078657"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078657"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078658"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-853"></span><span id="enumFrom"><span class="annot"><span class="annottext">enumFrom :: forall (m :: * -&gt; *) n r.
(Monad m, Enum n) =&gt;
n -&gt; Stream (Of n) m r
</span><a href="Streaming.Prelude.html#enumFrom"><span class="hs-identifier hs-var hs-var">enumFrom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Stream (Of n) m r
forall (m :: * -&gt; *) n r.
(Monad m, Enum n) =&gt;
n -&gt; Stream (Of n) m r
</span><a href="#local-6989586621679080033"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-854"></span><span>  </span><span id="local-6989586621679080033"><span class="annot"><span class="annottext">loop :: t -&gt; Stream (Of t) m r
</span><a href="#local-6989586621679080033"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080042"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080042"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of t) m r) -&gt; Stream (Of t) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of t) m r -&gt; m (Stream (Of t) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of t (Stream (Of t) m r) -&gt; Stream (Of t) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080042"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; Stream (Of t) m r -&gt; Of t (Stream (Of t) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; Stream (Of t) m r
</span><a href="#local-6989586621679080033"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t
forall a. Enum a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#succ"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080042"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-855"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#enumFrom"><span class="hs-pragma hs-type">enumFrom</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="annot"><span class="hs-comment">{-| An infinite sequence of enumerable values at a fixed distance, determined
   by the first and second values. See the discussion of 'Streaming.enumFrom'

&gt;&gt;&gt; S.print $ S.take 3 $ S.enumFromThen 100 200
100
200
300

-}</span></span><span>
</span><span id="line-867"></span><span id="local-6989586621679078666"><span id="local-6989586621679078667"><span id="local-6989586621679078668"><span class="annot"><a href="Streaming.Prelude.html#enumFromThen"><span class="hs-identifier hs-type">enumFromThen</span></a></span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078666"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#Enum"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078667"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078667"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078667"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078667"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078666"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078668"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-868"></span><span id="enumFromThen"><span class="annot"><span class="annottext">enumFromThen :: forall (m :: * -&gt; *) a r.
(Monad m, Enum a) =&gt;
a -&gt; a -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#enumFromThen"><span class="hs-identifier hs-var hs-var">enumFromThen</span></a></span></span><span> </span><span id="local-6989586621679080052"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080052"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span id="local-6989586621679080053"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080053"><span class="hs-identifier hs-var">second</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a) -&gt; Stream (Of Int) m r -&gt; Stream (Of a) m r
forall (m :: * -&gt; *) a b r.
Monad m =&gt;
(a -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#map"><span class="hs-identifier hs-var">Streaming.Prelude.map</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a. Enum a =&gt; Int -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#toEnum"><span class="hs-identifier hs-var">toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Stream (Of Int) m r
</span><a href="#local-6989586621679080055"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080056"><span class="hs-identifier hs-var">_first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-870"></span><span>    </span><span id="local-6989586621679080056"><span class="annot"><span class="annottext">_first :: Int
</span><a href="#local-6989586621679080056"><span class="hs-identifier hs-var hs-var">_first</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080052"><span class="hs-identifier hs-var">first</span></a></span><span>
</span><span id="line-871"></span><span>    </span><span id="local-6989586621679080058"><span class="annot"><span class="annottext">_second :: Int
</span><a href="#local-6989586621679080058"><span class="hs-identifier hs-var hs-var">_second</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080053"><span class="hs-identifier hs-var">second</span></a></span><span>
</span><span id="line-872"></span><span>    </span><span id="local-6989586621679080059"><span class="annot"><span class="annottext">diff :: Int
</span><a href="#local-6989586621679080059"><span class="hs-identifier hs-var hs-var">diff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080058"><span class="hs-identifier hs-var">_second</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080056"><span class="hs-identifier hs-var">_first</span></a></span><span>
</span><span id="line-873"></span><span>    </span><span id="local-6989586621679080055"><span class="annot"><span class="annottext">loop :: Int -&gt; Stream (Of Int) m r
</span><a href="#local-6989586621679080055"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080060"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080060"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Of Int (Stream (Of Int) m r) -&gt; Stream (Of Int) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080060"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream (Of Int) m r -&gt; Of Int (Stream (Of Int) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream (Of Int) m r
</span><a href="#local-6989586621679080055"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080060"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080059"><span class="hs-identifier hs-var">diff</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#enumFromThen"><span class="hs-pragma hs-type">enumFromThen</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- erase</span><span>
</span><span id="line-878"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-879"></span><span class="annot"><span class="hs-comment">{- | Remove the elements from a stream of values, retaining the structure of layers.
-}</span></span><span>
</span><span id="line-881"></span><span id="local-6989586621679078676"><span id="local-6989586621679078677"><span id="local-6989586621679078678"><span class="annot"><a href="Streaming.Prelude.html#erase"><span class="hs-identifier hs-type">erase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078676"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078677"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078676"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078678"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078676"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078678"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-882"></span><span id="erase"><span class="annot"><span class="annottext">erase :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; Stream Identity m r
</span><a href="Streaming.Prelude.html#erase"><span class="hs-identifier hs-var hs-var">erase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream Identity m r
forall {m :: * -&gt; *} {a} {r}.
Functor m =&gt;
Stream (Of a) m r -&gt; Stream Identity m r
</span><a href="#local-6989586621679080066"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-883"></span><span>  </span><span id="local-6989586621679080066"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream Identity m r
</span><a href="#local-6989586621679080066"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080069"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080069"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080069"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-884"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080070"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080070"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream Identity m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080070"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-885"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080071"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080071"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream Identity m r) -&gt; Stream Identity m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream Identity m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream Identity m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream Identity m r
</span><a href="#local-6989586621679080066"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080071"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span id="local-6989586621679080072"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080072"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Identity (Stream Identity m r) -&gt; Stream Identity m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream Identity m r -&gt; Identity (Stream Identity m r)
forall a. a -&gt; Identity a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream Identity m r
</span><a href="#local-6989586621679080066"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080072"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#erase"><span class="hs-pragma hs-type">erase</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- filter</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-892"></span><span>
</span><span id="line-893"></span><span class="annot"><span class="hs-comment">-- | Skip elements of a stream that fail a predicate</span></span><span>
</span><span id="line-894"></span><span id="local-6989586621679080074"><span id="local-6989586621679080075"><span id="local-6989586621679080076"><span class="annot"><a href="Streaming.Prelude.html#filter"><span class="hs-identifier hs-type">filter</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080074"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080075"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080075"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080076"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080075"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080076"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-895"></span><span id="filter"><span class="annot"><span class="annottext">filter :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#filter"><span class="hs-identifier hs-var hs-var">filter</span></a></span></span><span> </span><span id="local-6989586621679080081"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679080081"><span class="hs-identifier hs-var">thePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-896"></span><span>  </span><span id="local-6989586621679080082"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080083"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080083"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080083"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-897"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080084"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080084"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080084"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-898"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080085"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080085"><span class="hs-identifier hs-var">m</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080085"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080086"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080086"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080087"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080087"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679080081"><span class="hs-identifier hs-var">thePred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080086"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-900"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080086"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080087"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080087"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-902"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#filter"><span class="hs-pragma hs-type">filter</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>  </span><span class="hs-comment">-- ~ 10% faster than INLINABLE in simple bench</span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- filterM</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-908"></span><span>
</span><span id="line-909"></span><span class="annot"><span class="hs-comment">-- | Skip elements of a stream that fail a monadic test</span></span><span>
</span><span id="line-910"></span><span id="local-6989586621679078690"><span id="local-6989586621679078691"><span id="local-6989586621679078692"><span class="annot"><a href="Streaming.Prelude.html#filterM"><span class="hs-identifier hs-type">filterM</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078690"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078691"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078690"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078691"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078690"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078692"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078691"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078690"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078692"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-911"></span><span id="filterM"><span class="annot"><span class="annottext">filterM :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; m Bool) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#filterM"><span class="hs-identifier hs-var hs-var">filterM</span></a></span></span><span> </span><span id="local-6989586621679080095"><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679080095"><span class="hs-identifier hs-var">thePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080096"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-912"></span><span>  </span><span id="local-6989586621679080096"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080096"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080097"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080097"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080097"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-913"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080098"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080098"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080098"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-914"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080099"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080099"><span class="hs-identifier hs-var">m</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m r) -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080096"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080099"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-915"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080100"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080100"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080101"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080101"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m r) -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-916"></span><span>      </span><span id="local-6989586621679080102"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679080102"><span class="hs-identifier hs-var">bool</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679080095"><span class="hs-identifier hs-var">thePred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080100"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-917"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679080102"><span class="hs-identifier hs-var">bool</span></a></span><span>
</span><span id="line-918"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; m (Stream (Of a) m r))
-&gt; Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080100"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080096"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080101"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; m (Stream (Of a) m r))
-&gt; Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080096"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080101"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-920"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#filterM"><span class="hs-pragma hs-type">filterM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>  </span><span class="hs-comment">-- ~ 10% faster than INLINABLE in simple bench</span><span>
</span><span id="line-921"></span><span>
</span><span id="line-922"></span><span class="hs-comment">-- -- ---------------</span><span>
</span><span id="line-923"></span><span class="hs-comment">-- -- first</span><span>
</span><span id="line-924"></span><span class="hs-comment">-- -- ---------------</span><span>
</span><span id="line-925"></span><span class="hs-comment">-- {- | Take either the first item in a stream or the return value, if it is empty.</span><span>
</span><span id="line-926"></span><span class="hs-comment">--      The typical mark of an infinite stream is a polymorphic return value; in</span><span>
</span><span id="line-927"></span><span class="hs-comment">--      that case, 'first' is a sort of @safeHead@</span><span>
</span><span id="line-928"></span><span class="hs-comment">--</span><span>
</span><span id="line-929"></span><span class="hs-comment">--      To iterate an action returning a 'Maybe', until it succeeds.</span><span>
</span><span id="line-930"></span><span class="hs-comment">--</span><span>
</span><span id="line-931"></span><span class="hs-comment">-- -}</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- first :: Monad m =&gt; Stream (Of r) m r -&gt; m r</span><span>
</span><span id="line-933"></span><span class="hs-comment">-- first = loop where</span><span>
</span><span id="line-934"></span><span class="hs-comment">--   loop str = case str of</span><span>
</span><span id="line-935"></span><span class="hs-comment">--     Return r -&gt; return r</span><span>
</span><span id="line-936"></span><span class="hs-comment">--     Effect m -&gt; m &gt;&gt;= loop</span><span>
</span><span id="line-937"></span><span class="hs-comment">--     Step (r :&gt; rest) -&gt; return r</span><span>
</span><span id="line-938"></span><span class="hs-comment">-- {-# INLINABLE first #-}</span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- fold</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-943"></span><span>
</span><span id="line-944"></span><span class="annot"><span class="hs-comment">{- $folds
    Use these to fold the elements of a 'Stream'.

&gt;&gt;&gt; S.fold_ (+) 0 id $ S.each [1..10]
55

    The general folds 'fold', 'fold_', 'foldM' and 'foldM_' are arranged
    for use with @Control.Foldl@ 'Control.Foldl.purely' and 'Control.Foldl.impurely'

&gt;&gt;&gt; L.purely fold_ L.sum $ each [1..10]
55
&gt;&gt;&gt; L.purely fold_ (liftA3 (,,) L.sum L.product L.list) $ each [1..10]
(55,3628800,[1,2,3,4,5,6,7,8,9,10])

    All functions marked with an underscore
    (e.g. @fold_@, @sum_@) omit the stream's return value in a left-strict pair.
    They are good for exiting streaming completely,
    but when you are, e.g. @mapped@-ing over a @Stream (Stream (Of a) m) m r@,
    which is to be compared with @[[a]]@. Specializing, we have e.g.

&gt;  mapped sum :: (Monad m, Num n) =&gt; Stream (Stream (Of Int)) IO () -&gt; Stream (Of n) IO ()
&gt;  mapped (fold mappend mempty id) :: Stream (Stream (Of Int)) IO () -&gt; Stream (Of Int) IO ()

&gt;&gt;&gt; S.print $ mapped S.sum $ chunksOf 3 $ S.each [1..10]
6
15
24
10

&gt;&gt;&gt; let three_folds = L.purely S.fold (liftA3 (,,) L.sum L.product L.list)
&gt;&gt;&gt; S.print $ mapped three_folds $ chunksOf 3 (each [1..10])
(6,6,[1,2,3])
(15,120,[4,5,6])
(24,504,[7,8,9])
(10,10,[10])
-}</span></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span class="annot"><span class="hs-comment">{-| Strict fold of a 'Stream' of elements, preserving only the result of the fold, not
    the return value of the stream.  The third parameter will often be 'id' where a fold
    is written by hand:

&gt;&gt;&gt; S.fold_ (+) 0 id $ each [1..10]
55

    It can be used to replace a standard Haskell type with one more suited to
    writing a strict accumulation function. It is also crucial to the
    Applicative instance for @Control.Foldl.Fold@

&gt; Control.Foldl.purely fold :: Monad m =&gt; Fold a b -&gt; Stream (Of a) m () -&gt; m b
-}</span></span><span>
</span><span id="line-994"></span><span id="local-6989586621679078696"><span id="local-6989586621679078697"><span id="local-6989586621679078698"><span id="local-6989586621679078699"><span id="local-6989586621679078700"><span class="annot"><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-type">fold_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078696"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078697"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078697"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078697"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078697"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078699"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078698"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078696"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078700"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078696"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078699"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-995"></span><span id="fold_"><span class="annot"><span class="annottext">fold_ :: forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var hs-var">fold_</span></a></span></span><span> </span><span id="local-6989586621679080109"><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080109"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679080110"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080110"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679080111"><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080111"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Of b r -&gt; b) -&gt; m (Of b r) -&gt; m b
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679080112"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080112"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080112"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Of b r) -&gt; m b)
-&gt; (Stream (Of a) m r -&gt; m (Of b r)) -&gt; Stream (Of a) m r -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080109"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080110"><span class="hs-identifier hs-var">begin</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080111"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-996"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#fold_"><span class="hs-pragma hs-type">fold_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span class="annot"><span class="hs-comment">{-| Strict fold of a 'Stream' of elements that preserves the return value.
    The third parameter will often be 'id' where a fold is written by hand:

&gt;&gt;&gt; S.fold (+) 0 id $ each [1..10]
55 :&gt; ()

&gt;&gt;&gt; S.fold (*) 1 id $ S.fold (+) 0 id $ S.copy $ each [1..10]
3628800 :&gt; (55 :&gt; ())

    It can be used to replace a standard Haskell type with one more suited to
    writing a strict accumulation function. It is also crucial to the
    Applicative instance for @Control.Foldl.Fold@  We can apply such a fold
    @purely@

&gt; Control.Foldl.purely S.fold :: Monad m =&gt; Fold a b -&gt; Stream (Of a) m r -&gt; m (Of b r)

    Thus, specializing a bit:

&gt; L.purely S.fold L.sum :: Stream (Of Int) Int r -&gt; m (Of Int r)
&gt; mapped (L.purely S.fold L.sum) :: Stream (Stream (Of Int)) IO r -&gt; Stream (Of Int) IO r

    Here we use the Applicative instance for @Control.Foldl.Fold@ to
    stream three-item segments of a stream together with their sums and products.

&gt;&gt;&gt; S.print $ mapped (L.purely S.fold (liftA3 (,,) L.list L.product L.sum)) $ chunksOf 3 $ each [1..10]
([1,2,3],6,6)
([4,5,6],120,15)
([7,8,9],504,24)
([10],10,10)

-}</span></span><span>
</span><span id="line-1029"></span><span>
</span><span id="line-1030"></span><span id="local-6989586621679078706"><span id="local-6989586621679078707"><span id="local-6989586621679078708"><span id="local-6989586621679078709"><span id="local-6989586621679078710"><span class="annot"><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-type">fold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078706"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078707"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078708"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078707"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078707"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078707"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078709"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078708"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078706"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078710"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078706"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078709"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078710"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1031"></span><span id="fold"><span class="annot"><span class="annottext">fold :: forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var hs-var">fold</span></a></span></span><span> </span><span id="local-6989586621679080116"><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080116"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679080117"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080117"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679080118"><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080118"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span id="local-6989586621679080119"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080119"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; x -&gt; m (Of b r)
</span><a href="#local-6989586621679080120"><span class="hs-identifier hs-var">fold_loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080119"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080117"><span class="hs-identifier hs-var">begin</span></a></span><span>
</span><span id="line-1032"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1033"></span><span>    </span><span id="local-6989586621679080120"><span class="annot"><span class="annottext">fold_loop :: Stream (Of a) m r -&gt; x -&gt; m (Of b r)
</span><a href="#local-6989586621679080120"><span class="hs-identifier hs-var hs-var">fold_loop</span></a></span></span><span> </span><span id="local-6989586621679080121"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080121"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080122"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080122"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080121"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1034"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080123"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080123"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of b r -&gt; m (Of b r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080118"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080122"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; r -&gt; Of b r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080123"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1035"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080124"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080124"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080124"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Of b r)) -&gt; m (Of b r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080125"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080125"><span class="hs-identifier hs-var">str'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; x -&gt; m (Of b r)
</span><a href="#local-6989586621679080120"><span class="hs-identifier hs-var">fold_loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080125"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080122"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1036"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080126"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080126"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080127"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080127"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; x -&gt; m (Of b r)
</span><a href="#local-6989586621679080120"><span class="hs-identifier hs-var">fold_loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080127"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">(x -&gt; m (Of b r)) -&gt; x -&gt; m (Of b r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080116"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080122"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080126"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1037"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#fold"><span class="hs-pragma hs-type">fold</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span>
</span><span id="line-1040"></span><span class="annot"><span class="hs-comment">{-| Strict, monadic fold of the elements of a @Stream (Of a)@

&gt; Control.Foldl.impurely foldM :: Monad m =&gt; FoldM a b -&gt; Stream (Of a) m () -&gt; m b
-}</span></span><span>
</span><span id="line-1044"></span><span id="local-6989586621679078716"><span id="local-6989586621679078717"><span id="local-6989586621679078718"><span id="local-6989586621679078719"><span id="local-6989586621679078720"><span class="annot"><a href="Streaming.Prelude.html#foldM_"><span class="hs-identifier hs-type">foldM_</span></a></span><span>
</span><span id="line-1045"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078716"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-1046"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078717"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078718"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078716"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078717"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078716"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078717"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078717"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078716"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078719"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078718"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078716"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078720"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078716"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078719"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-1047"></span><span id="foldM_"><span class="annot"><span class="annottext">foldM_ :: forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; m x) -&gt; m x -&gt; (x -&gt; m b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#foldM_"><span class="hs-identifier hs-var hs-var">foldM_</span></a></span></span><span> </span><span id="local-6989586621679080134"><span class="annot"><span class="annottext">x -&gt; a -&gt; m x
</span><a href="#local-6989586621679080134"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679080135"><span class="annot"><span class="annottext">m x
</span><a href="#local-6989586621679080135"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679080136"><span class="annot"><span class="annottext">x -&gt; m b
</span><a href="#local-6989586621679080136"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Of b r -&gt; b) -&gt; m (Of b r) -&gt; m b
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679080137"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080137"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080137"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Of b r) -&gt; m b)
-&gt; (Stream (Of a) m r -&gt; m (Of b r)) -&gt; Stream (Of a) m r -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(x -&gt; a -&gt; m x)
-&gt; m x -&gt; (x -&gt; m b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; m x)
-&gt; m x -&gt; (x -&gt; m b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#foldM"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; a -&gt; m x
</span><a href="#local-6989586621679080134"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">m x
</span><a href="#local-6989586621679080135"><span class="hs-identifier hs-var">begin</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; m b
</span><a href="#local-6989586621679080136"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-1048"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldM_"><span class="hs-pragma hs-type">foldM_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span class="annot"><span class="hs-comment">{-| Strict, monadic fold of the elements of a @Stream (Of a)@

&gt; Control.Foldl.impurely foldM' :: Monad m =&gt; FoldM a b -&gt; Stream (Of a) m r -&gt; m (b, r)

   Thus to accumulate the elements of a stream as a vector, together with a random
   element we might write:

&gt;&gt;&gt; L.impurely S.foldM (liftA2 (,) L.vectorM L.random) $ each [1..10::Int] :: IO (Of (Vector Int, Maybe Int) ())
([1,2,3,4,5,6,7,8,9,10],Just 9) :&gt; ()

-}</span></span><span>
</span><span id="line-1061"></span><span id="local-6989586621679078726"><span id="local-6989586621679078727"><span id="local-6989586621679078728"><span id="local-6989586621679078729"><span id="local-6989586621679078730"><span class="annot"><a href="Streaming.Prelude.html#foldM"><span class="hs-identifier hs-type">foldM</span></a></span><span>
</span><span id="line-1062"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078726"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-1063"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078727"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078727"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078727"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078727"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078729"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078728"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078730"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="#local-6989586621679078726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078729"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078730"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span id="foldM"><span class="annot"><span class="annottext">foldM :: forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; m x)
-&gt; m x -&gt; (x -&gt; m b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#foldM"><span class="hs-identifier hs-var hs-var">foldM</span></a></span></span><span> </span><span id="local-6989586621679080144"><span class="annot"><span class="annottext">x -&gt; a -&gt; m x
</span><a href="#local-6989586621679080144"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679080145"><span class="annot"><span class="annottext">m x
</span><a href="#local-6989586621679080145"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679080146"><span class="annot"><span class="annottext">x -&gt; m b
</span><a href="#local-6989586621679080146"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span id="local-6989586621679080147"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080147"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1066"></span><span>    </span><span id="local-6989586621679080148"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080148"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m x
</span><a href="#local-6989586621679080145"><span class="hs-identifier hs-var">begin</span></a></span><span>
</span><span id="line-1067"></span><span>    </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; x -&gt; m (Of b r)
</span><a href="#local-6989586621679080149"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080147"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080148"><span class="hs-identifier hs-var">x0</span></a></span><span>
</span><span id="line-1068"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1069"></span><span>    </span><span id="local-6989586621679080149"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; x -&gt; m (Of b r)
</span><a href="#local-6989586621679080149"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080150"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080150"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080151"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080151"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080150"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1070"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080152"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080152"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; m b
</span><a href="#local-6989586621679080146"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080151"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m b -&gt; (b -&gt; m (Of b r)) -&gt; m (Of b r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080153"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080153"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of b r -&gt; m (Of b r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080153"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; r -&gt; Of b r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080152"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1071"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080154"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080154"><span class="hs-identifier hs-var">m</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080154"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Of b r)) -&gt; m (Of b r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080155"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080155"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; x -&gt; m (Of b r)
</span><a href="#local-6989586621679080149"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080155"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080151"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1072"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080156"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080157"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080157"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1073"></span><span>        </span><span id="local-6989586621679080158"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080158"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">x -&gt; a -&gt; m x
</span><a href="#local-6989586621679080144"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080151"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080156"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1074"></span><span>        </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; x -&gt; m (Of b r)
</span><a href="#local-6989586621679080149"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080157"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080158"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-1075"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldM"><span class="hs-pragma hs-type">foldM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1076"></span><span>
</span><span id="line-1077"></span><span class="hs-comment">-- the following requires GHC.Magic.oneShot:</span><span>
</span><span id="line-1078"></span><span class="hs-comment">-- foldM step begin done str = do</span><span>
</span><span id="line-1079"></span><span class="hs-comment">--       x &lt;- begin</span><span>
</span><span id="line-1080"></span><span class="hs-comment">--       (x' :&gt; r) &lt;- streamFold</span><span>
</span><span id="line-1081"></span><span class="hs-comment">--         (\r x -&gt; return (x :&gt; r))</span><span>
</span><span id="line-1082"></span><span class="hs-comment">--         (\mx2mx -&gt; oneShot (\x -&gt; x `seq` mx2mx &gt;&gt;= ($ x) ))</span><span>
</span><span id="line-1083"></span><span class="hs-comment">--         (\(a :&gt; x2mx') -&gt; oneShot (\x -&gt; x `seq` (step x a &gt;&gt;= x2mx')) )</span><span>
</span><span id="line-1084"></span><span class="hs-comment">--         ( str)</span><span>
</span><span id="line-1085"></span><span class="hs-comment">--         x</span><span>
</span><span id="line-1086"></span><span class="hs-comment">--       b &lt;- done x'</span><span>
</span><span id="line-1087"></span><span class="hs-comment">--       return (b :&gt; r)</span><span>
</span><span id="line-1088"></span><span class="hs-comment">--   where seq = Prelude.seq</span><span>
</span><span id="line-1089"></span><span class="hs-comment">-- {-# INLINE foldM #-}</span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span class="annot"><span class="hs-comment">{-| A natural right fold for consuming a stream of elements.
    See also the more general 'iterTM' in the 'Streaming' module
    and the still more general 'destroy'

&gt; foldrT (\a p -&gt; Streaming.yield a &gt;&gt; p) = id
&gt; foldrT (\a p -&gt; Pipes.yield a     &gt;&gt; p) :: Monad m =&gt; Stream (Of a) m r -&gt; Producer a m r
&gt; foldrT (\a p -&gt; Conduit.yield a   &gt;&gt; p) :: Monad m =&gt; Stream (Of a) m r -&gt; Conduit a m r

-}</span></span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span id="local-6989586621679078736"><span id="local-6989586621679078737"><span id="local-6989586621679078738"><span id="local-6989586621679078739"><span class="annot"><a href="Streaming.Prelude.html#foldrT"><span class="hs-identifier hs-type">foldrT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#MonadTrans"><span class="hs-identifier hs-type">MonadTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078737"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078737"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078738"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078737"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078736"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078739"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078737"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078736"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078739"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078738"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078736"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078739"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078737"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078736"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078739"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-1103"></span><span id="foldrT"><span class="annot"><span class="annottext">foldrT :: forall (m :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) a r.
(Monad m, MonadTrans t, Monad (t m)) =&gt;
(a -&gt; t m r -&gt; t m r) -&gt; Stream (Of a) m r -&gt; t m r
</span><a href="Streaming.Prelude.html#foldrT"><span class="hs-identifier hs-var hs-var">foldrT</span></a></span></span><span> </span><span id="local-6989586621679080168"><span class="annot"><span class="annottext">a -&gt; t m r -&gt; t m r
</span><a href="#local-6989586621679080168"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; t m r
</span><a href="#local-6989586621679080169"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1104"></span><span>  </span><span id="local-6989586621679080169"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; t m r
</span><a href="#local-6989586621679080169"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080170"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080170"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080170"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1105"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080171"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080171"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; t m r
forall a. a -&gt; t m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080171"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1106"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080172"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080172"><span class="hs-identifier hs-var">m</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; t m (Stream (Of a) m r)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080172"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t m (Stream (Of a) m r) -&gt; (Stream (Of a) m r -&gt; t m r) -&gt; t m r
forall a b. t m a -&gt; (a -&gt; t m b) -&gt; t m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; t m r
</span><a href="#local-6989586621679080169"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-1107"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080173"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080173"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080174"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080174"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; t m r -&gt; t m r
</span><a href="#local-6989586621679080168"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080173"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; t m r
</span><a href="#local-6989586621679080169"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080174"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldrT"><span class="hs-pragma hs-type">foldrT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span class="annot"><span class="hs-comment">{-| A natural right fold for consuming a stream of elements.
    See also the more general 'iterT' in the 'Streaming' module and the
    still more general 'destroy'
-}</span></span><span>
</span><span id="line-1114"></span><span id="local-6989586621679078744"><span id="local-6989586621679078745"><span id="local-6989586621679078746"><span class="annot"><a href="Streaming.Prelude.html#foldrM"><span class="hs-identifier hs-type">foldrM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078744"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-1115"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078746"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078746"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078746"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078746"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1116"></span><span id="foldrM"><span class="annot"><span class="annottext">foldrM :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; m r -&gt; m r) -&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#foldrM"><span class="hs-identifier hs-var hs-var">foldrM</span></a></span></span><span> </span><span id="local-6989586621679080179"><span class="annot"><span class="annottext">a -&gt; m r -&gt; m r
</span><a href="#local-6989586621679080179"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1117"></span><span>  </span><span id="local-6989586621679080180"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080181"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080181"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080181"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1118"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080182"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080182"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; m r
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080182"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1119"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080183"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080183"><span class="hs-identifier hs-var">m</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080183"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; (Stream (Of a) m r -&gt; m r) -&gt; m r
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-1120"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080184"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080184"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080185"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080185"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m r -&gt; m r
</span><a href="#local-6989586621679080179"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080184"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080185"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1121"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldrM"><span class="hs-pragma hs-type">foldrM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1122"></span><span>
</span><span id="line-1123"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1124"></span><span class="hs-comment">-- for</span><span>
</span><span id="line-1125"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1126"></span><span>
</span><span id="line-1127"></span><span class="hs-comment">-- | @for@ replaces each element of a stream with an associated stream. Note that the</span><span>
</span><span id="line-1128"></span><span class="hs-comment">-- associated stream may layer any functor.</span><span>
</span><span id="line-1129"></span><span id="local-6989586621679078750"><span id="local-6989586621679078751"><span id="local-6989586621679078752"><span id="local-6989586621679078753"><span id="local-6989586621679078754"><span class="annot"><a href="Streaming.Prelude.html#for"><span class="hs-identifier hs-type">for</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078750"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078751"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078752"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078750"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078753"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078752"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078751"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078750"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078754"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078751"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078750"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078753"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-1130"></span><span id="for"><span class="annot"><span class="annottext">for :: forall (m :: * -&gt; *) (f :: * -&gt; *) a r x.
(Monad m, Functor f) =&gt;
Stream (Of a) m r -&gt; (a -&gt; Stream f m x) -&gt; Stream f m r
</span><a href="Streaming.Prelude.html#for"><span class="hs-identifier hs-var hs-var">for</span></a></span></span><span> </span><span id="local-6989586621679080192"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">str0</span></a></span></span><span> </span><span id="local-6989586621679080193"><span class="annot"><span class="annottext">a -&gt; Stream f m x
</span><a href="#local-6989586621679080193"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080194"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">str0</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1131"></span><span>  </span><span id="local-6989586621679080194"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080194"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080195"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080195"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080195"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1132"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080196"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080196"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream f m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080196"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1133"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080197"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080197"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream f m r) -&gt; Stream f m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream f m r) -&gt; Stream f m r)
-&gt; m (Stream f m r) -&gt; Stream f m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream f m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream f m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080194"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080197"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1134"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080198"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080198"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080199"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080199"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream f m x
</span><a href="#local-6989586621679080193"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080198"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m x -&gt; Stream f m r -&gt; Stream f m r
forall a b. Stream f m a -&gt; Stream f m b -&gt; Stream f m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080194"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080199"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1135"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#for"><span class="hs-pragma hs-type">for</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1136"></span><span>
</span><span id="line-1137"></span><span class="hs-comment">-- -| Group layers of any functor by comparisons on a preliminary annotation</span><span>
</span><span id="line-1138"></span><span>
</span><span id="line-1139"></span><span class="hs-comment">-- groupedBy</span><span>
</span><span id="line-1140"></span><span class="hs-comment">--   :: (Monad m, Functor f) =&gt;</span><span>
</span><span id="line-1141"></span><span class="hs-comment">--      (a -&gt; a -&gt; Bool)</span><span>
</span><span id="line-1142"></span><span class="hs-comment">--      -&gt; Stream (Compose (Of a) f) m r</span><span>
</span><span id="line-1143"></span><span class="hs-comment">--      -&gt; Stream (Stream (Compose (Of a) f) m) m r</span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- groupedBy equals = loop  where</span><span>
</span><span id="line-1145"></span><span class="hs-comment">--   loop stream = Effect $ do</span><span>
</span><span id="line-1146"></span><span class="hs-comment">--         e &lt;- inspect stream</span><span>
</span><span id="line-1147"></span><span class="hs-comment">--         return $ case e of</span><span>
</span><span id="line-1148"></span><span class="hs-comment">--             Left   r      -&gt; Return r</span><span>
</span><span id="line-1149"></span><span class="hs-comment">--             Right s@(Compose (a :&gt; p')) -&gt; Step $</span><span>
</span><span id="line-1150"></span><span class="hs-comment">--                 fmap loop (Step $ Compose (a :&gt; fmap (span' (equals a)) p'))</span><span>
</span><span id="line-1151"></span><span class="hs-comment">--   span' :: (Monad m, Functor f) =&gt; (a -&gt; Bool) -&gt; Stream (Compose (Of a) f) m r</span><span>
</span><span id="line-1152"></span><span class="hs-comment">--         -&gt; Stream (Compose (Of a) f) m (Stream (Compose (Of a) f) m r)</span><span>
</span><span id="line-1153"></span><span class="hs-comment">--   span' thePred = loop where</span><span>
</span><span id="line-1154"></span><span class="hs-comment">--     loop str = case str of</span><span>
</span><span id="line-1155"></span><span class="hs-comment">--       Return r         -&gt; Return (Return r)</span><span>
</span><span id="line-1156"></span><span class="hs-comment">--       Effect m          -&gt; Effect $ fmap loop m</span><span>
</span><span id="line-1157"></span><span class="hs-comment">--       Step s@(Compose (a :&gt; rest)) -&gt; case thePred a  of</span><span>
</span><span id="line-1158"></span><span class="hs-comment">--         True  -&gt; Step (Compose (a :&gt; fmap loop rest))</span><span>
</span><span id="line-1159"></span><span class="hs-comment">--         False -&gt; Return (Step s)</span><span>
</span><span id="line-1160"></span><span class="hs-comment">-- {-# INLINABLE groupedBy #-}</span><span>
</span><span id="line-1161"></span><span>
</span><span id="line-1162"></span><span class="annot"><span class="hs-comment">{-| Group elements of a stream in accordance with the supplied comparison.


&gt;&gt;&gt; S.print $ mapped S.toList $ S.groupBy (&gt;=) $ each [1,2,3,1,2,3,4,3,2,4,5,6,7,6,5]
[1]
[2]
[3,1,2,3]
[4,3,2,4]
[5]
[6]
[7,6,5]

-}</span></span><span>
</span><span id="line-1175"></span><span id="local-6989586621679078762"><span id="local-6989586621679078763"><span id="local-6989586621679078764"><span class="annot"><a href="Streaming.Prelude.html#groupBy"><span class="hs-identifier hs-type">groupBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078762"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-1176"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078763"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078763"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078762"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078764"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1178"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078762"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078762"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078764"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1179"></span><span id="groupBy"><span class="annot"><span class="annottext">groupBy :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="Streaming.Prelude.html#groupBy"><span class="hs-identifier hs-var hs-var">groupBy</span></a></span></span><span> </span><span id="local-6989586621679080209"><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679080209"><span class="hs-identifier hs-var">equals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679080210"><span class="hs-identifier hs-var">loop</span></a></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1180"></span><span>  </span><span id="local-6989586621679080210"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679080210"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080211"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080211"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Stream (Of a) m) m r) -&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Stream (Of a) m) m r) -&gt; Stream (Stream (Of a) m) m r)
-&gt; m (Stream (Stream (Of a) m) m r) -&gt; Stream (Stream (Of a) m) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1181"></span><span>        </span><span id="local-6989586621679080212"><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679080212"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080211"><span class="hs-identifier hs-var">stream</span></a></span><span>
</span><span id="line-1182"></span><span>        </span><span class="annot"><span class="annottext">Stream (Stream (Of a) m) m r -&gt; m (Stream (Stream (Of a) m) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Stream (Of a) m) m r -&gt; m (Stream (Stream (Of a) m) m r))
-&gt; Stream (Stream (Of a) m) m r -&gt; m (Stream (Stream (Of a) m) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679080212"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1183"></span><span>            </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span>   </span><span id="local-6989586621679080213"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080213"><span class="hs-identifier hs-var">r</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080213"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1184"></span><span>            </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080214"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080214"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679080215"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080215"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Stream (Of a) m) m r)
-&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m (Stream (Stream (Of a) m) m r)
 -&gt; Stream (Stream (Of a) m) m r)
-&gt; Stream (Of a) m (Stream (Stream (Of a) m) m r)
-&gt; Stream (Stream (Of a) m) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1185"></span><span>                </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Stream (Of a) m) m r)
forall a b. (a -&gt; b) -&gt; Stream (Of a) m a -&gt; Stream (Of a) m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679080210"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080214"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall a b.
Stream (Of a) m a -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="Streaming.Prelude.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679080209"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080214"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080215"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#groupBy"><span class="hs-pragma hs-type">groupBy</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1187"></span><span>
</span><span id="line-1188"></span><span>
</span><span id="line-1189"></span><span class="annot"><span class="hs-comment">{-| Group successive equal items together

&gt;&gt;&gt; S.toList $ mapped S.toList $ S.group $ each &quot;baaaaad&quot;
[&quot;b&quot;,&quot;aaaaa&quot;,&quot;d&quot;] :&gt; ()

&gt;&gt;&gt; S.toList $ concats $ maps (S.drained . S.splitAt 1) $ S.group $ each &quot;baaaaaaad&quot;
&quot;bad&quot; :&gt; ()

-}</span></span><span>
</span><span id="line-1198"></span><span id="local-6989586621679078768"><span id="local-6989586621679078769"><span id="local-6989586621679078770"><span class="annot"><a href="Streaming.Prelude.html#group"><span class="hs-identifier hs-type">group</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078768"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078769"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078769"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078768"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078770"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078769"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078768"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078768"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078770"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1199"></span><span id="group"><span class="annot"><span class="annottext">group :: forall (m :: * -&gt; *) a r.
(Monad m, Eq a) =&gt;
Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="Streaming.Prelude.html#group"><span class="hs-identifier hs-var hs-var">group</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="Streaming.Prelude.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">(==)</span></a></span><span>
</span><span id="line-1200"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#group"><span class="hs-pragma hs-type">group</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1201"></span><span>
</span><span id="line-1202"></span><span>
</span><span id="line-1203"></span><span id="local-6989586621679078774"><span id="local-6989586621679078775"><span id="local-6989586621679078776"><span class="annot"><a href="Streaming.Prelude.html#head"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078775"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078776"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078775"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078776"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1204"></span><span id="head"><span class="annot"><span class="annottext">head :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Of (Maybe a) r)
</span><a href="Streaming.Prelude.html#head"><span class="hs-identifier hs-var hs-var">head</span></a></span></span><span> </span><span id="local-6989586621679080227"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080227"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080227"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1205"></span><span>  </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080228"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080228"><span class="hs-identifier hs-var">r</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of (Maybe a) r -&gt; m (Of (Maybe a) r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; r -&gt; Of (Maybe a) r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080228"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1206"></span><span>  </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080229"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080229"><span class="hs-identifier hs-var">m</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080229"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Of (Maybe a) r)) -&gt; m (Of (Maybe a) r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Of (Maybe a) r)
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Of (Maybe a) r)
</span><a href="Streaming.Prelude.html#head"><span class="hs-identifier hs-var">head</span></a></span><span>
</span><span id="line-1207"></span><span>  </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080230"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080230"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080231"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080231"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var">effects</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080231"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">m r -&gt; (r -&gt; m (Of (Maybe a) r)) -&gt; m (Of (Maybe a) r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080232"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080232"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of (Maybe a) r -&gt; m (Of (Maybe a) r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080230"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; r -&gt; Of (Maybe a) r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080232"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1208"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#head"><span class="hs-pragma hs-type">head</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1209"></span><span>
</span><span id="line-1210"></span><span id="local-6989586621679078781"><span id="local-6989586621679078782"><span id="local-6989586621679078783"><span class="annot"><a href="Streaming.Prelude.html#head_"><span class="hs-identifier hs-type">head_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078783"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1211"></span><span id="head_"><span class="annot"><span class="annottext">head_ :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="Streaming.Prelude.html#head_"><span class="hs-identifier hs-var hs-var">head_</span></a></span></span><span> </span><span id="local-6989586621679080238"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080238"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080238"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1212"></span><span>  </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1213"></span><span>  </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080239"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080239"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080239"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Maybe a)) -&gt; m (Maybe a)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Maybe a)
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="Streaming.Prelude.html#head_"><span class="hs-identifier hs-var">head_</span></a></span><span>
</span><span id="line-1214"></span><span>  </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080240"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080240"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080240"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#head_"><span class="hs-pragma hs-type">head_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span>
</span><span id="line-1218"></span><span class="annot"><span class="hs-comment">{-| Intersperse given value between each element of the stream.

&gt;&gt;&gt; S.print $ S.intersperse 0 $ each [1,2,3]
1
0
2
0
3

-}</span></span><span>
</span><span id="line-1228"></span><span id="local-6989586621679080241"><span id="local-6989586621679080242"><span id="local-6989586621679080243"><span class="annot"><a href="Streaming.Prelude.html#intersperse"><span class="hs-identifier hs-type">intersperse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080241"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080241"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080243"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080241"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080243"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1229"></span><span id="intersperse"><span class="annot"><span class="annottext">intersperse :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
a -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#intersperse"><span class="hs-identifier hs-var hs-var">intersperse</span></a></span></span><span> </span><span id="local-6989586621679080250"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080250"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679080251"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080251"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080251"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1230"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080252"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080252"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080252"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1231"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080253"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080253"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
forall (m :: * -&gt; *) a r.
Monad m =&gt;
a -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#intersperse"><span class="hs-identifier hs-var">intersperse</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080250"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080253"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1232"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080254"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080254"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080255"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080255"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080256"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080254"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080255"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1233"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1234"></span><span>  </span><span id="local-6989586621679080256"><span class="annot"><span class="annottext">loop :: a -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080256"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080257"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080257"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679080258"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080258"><span class="hs-identifier hs-var">theStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080258"><span class="hs-identifier hs-var">theStr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1235"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080259"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080259"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080257"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080259"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1236"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080260"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080260"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080256"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080257"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080260"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080261"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080261"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080262"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080262"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080257"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080250"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080256"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080261"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080262"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1238"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#intersperse"><span class="hs-pragma hs-type">intersperse</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span>
</span><span id="line-1241"></span><span>
</span><span id="line-1242"></span><span>
</span><span id="line-1243"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1244"></span><span class="hs-comment">-- iterate</span><span>
</span><span id="line-1245"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1246"></span><span>
</span><span id="line-1247"></span><span class="annot"><span class="hs-comment">{-| Iterate a pure function from a seed value, streaming the results forever



-}</span></span><span>
</span><span id="line-1252"></span><span id="local-6989586621679078790"><span id="local-6989586621679078791"><span id="local-6989586621679078792"><span class="annot"><a href="Streaming.Prelude.html#iterate"><span class="hs-identifier hs-type">iterate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078790"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078791"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078791"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078791"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078791"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078790"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078792"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1253"></span><span id="iterate"><span class="annot"><span class="annottext">iterate :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; a) -&gt; a -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#iterate"><span class="hs-identifier hs-var hs-var">iterate</span></a></span></span><span> </span><span id="local-6989586621679080265"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679080265"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080266"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1254"></span><span>  </span><span id="local-6989586621679080266"><span class="annot"><span class="annottext">loop :: a -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080266"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080267"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080267"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080267"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080266"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679080265"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080267"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#iterate"><span class="hs-pragma hs-type">iterate</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1256"></span><span>
</span><span id="line-1257"></span><span class="annot"><span class="hs-comment">-- | Iterate a monadic function from a seed value, streaming the results forever</span></span><span>
</span><span id="line-1258"></span><span id="local-6989586621679078796"><span id="local-6989586621679078797"><span id="local-6989586621679078798"><span class="annot"><a href="Streaming.Prelude.html#iterateM"><span class="hs-identifier hs-type">iterateM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078796"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078797"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078796"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078796"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078797"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078796"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078798"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1259"></span><span id="iterateM"><span class="annot"><span class="annottext">iterateM :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; m a) -&gt; m a -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#iterateM"><span class="hs-identifier hs-var hs-var">iterateM</span></a></span></span><span> </span><span id="local-6989586621679080271"><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679080271"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080272"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1260"></span><span>  </span><span id="local-6989586621679080272"><span class="annot"><span class="annottext">loop :: m a -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080272"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080273"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679080273"><span class="hs-identifier hs-var">ma</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m r) -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1261"></span><span>    </span><span id="local-6989586621679080274"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080274"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679080273"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-1262"></span><span>    </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080274"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m a -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080272"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679080271"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080274"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1263"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#iterateM"><span class="hs-pragma hs-type">iterateM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1264"></span><span>
</span><span id="line-1265"></span><span>
</span><span id="line-1266"></span><span>
</span><span id="line-1267"></span><span id="local-6989586621679080275"><span id="local-6989586621679080276"><span id="local-6989586621679080277"><span class="annot"><a href="Streaming.Prelude.html#last"><span class="hs-identifier hs-type">last</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080275"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080276"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080275"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080277"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080275"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080276"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080277"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1268"></span><span id="last"><span class="annot"><span class="annottext">last :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Of (Maybe a) r)
</span><a href="Streaming.Prelude.html#last"><span class="hs-identifier hs-var hs-var">last</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe_ a -&gt; Stream (Of a) m r -&gt; m (Of (Maybe a) r)
forall {m :: * -&gt; *} {a} {b}.
Monad m =&gt;
Maybe_ a -&gt; Stream (Of a) m b -&gt; m (Of (Maybe a) b)
</span><a href="#local-6989586621679080280"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe_ a
forall a. Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1269"></span><span>  </span><span id="local-6989586621679080280"><span class="annot"><span class="annottext">loop :: Maybe_ a -&gt; Stream (Of a) m b -&gt; m (Of (Maybe a) b)
</span><a href="#local-6989586621679080280"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080290"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080290"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span id="local-6989586621679080291"><span class="annot"><span class="annottext">Stream (Of a) m b
</span><a href="#local-6989586621679080291"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m b
</span><a href="#local-6989586621679080291"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1270"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080292"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080292"><span class="hs-identifier hs-var">r</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080290"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1271"></span><span>      </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of (Maybe a) b -&gt; m (Of (Maybe a) b)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; b -&gt; Of (Maybe a) b
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080292"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1272"></span><span>      </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080294"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080294"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of (Maybe a) b -&gt; m (Of (Maybe a) b)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080294"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; b -&gt; Of (Maybe a) b
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080292"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1273"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080295"><span class="annot"><span class="annottext">m (Stream (Of a) m b)
</span><a href="#local-6989586621679080295"><span class="hs-identifier hs-var">m</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m b)
</span><a href="#local-6989586621679080295"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m b)
-&gt; (Stream (Of a) m b -&gt; m (Of (Maybe a) b)) -&gt; m (Of (Maybe a) b)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe_ a -&gt; Stream (Of a) m b -&gt; m (Of (Maybe a) b)
</span><a href="#local-6989586621679080280"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080290"><span class="hs-identifier hs-var">mb</span></a></span><span>
</span><span id="line-1274"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080296"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080296"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080297"><span class="annot"><span class="annottext">Stream (Of a) m b
</span><a href="#local-6989586621679080297"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe_ a -&gt; Stream (Of a) m b -&gt; m (Of (Maybe a) b)
</span><a href="#local-6989586621679080280"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080296"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m b
</span><a href="#local-6989586621679080297"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1275"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#last"><span class="hs-pragma hs-type">last</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1276"></span><span>
</span><span id="line-1277"></span><span>
</span><span id="line-1278"></span><span>
</span><span id="line-1279"></span><span id="local-6989586621679080298"><span id="local-6989586621679080299"><span id="local-6989586621679080300"><span class="annot"><a href="Streaming.Prelude.html#last_"><span class="hs-identifier hs-type">last_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080298"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080299"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080298"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080300"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080298"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080299"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1280"></span><span id="last_"><span class="annot"><span class="annottext">last_ :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="Streaming.Prelude.html#last_"><span class="hs-identifier hs-var hs-var">last_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe_ a -&gt; Stream (Of a) m r -&gt; m (Maybe a)
forall {m :: * -&gt; *} {a} {r}.
Monad m =&gt;
Maybe_ a -&gt; Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="#local-6989586621679080303"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe_ a
forall a. Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1281"></span><span>  </span><span id="local-6989586621679080303"><span class="annot"><span class="annottext">loop :: Maybe_ a -&gt; Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="#local-6989586621679080303"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080312"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080312"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span id="local-6989586621679080313"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080313"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080313"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1282"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080312"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1283"></span><span>      </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1284"></span><span>      </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080314"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080314"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080314"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1285"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080315"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080315"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080315"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Maybe a)) -&gt; m (Maybe a)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe_ a -&gt; Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="#local-6989586621679080303"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080312"><span class="hs-identifier hs-var">mb</span></a></span><span>
</span><span id="line-1286"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080316"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080316"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080317"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080317"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe_ a -&gt; Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="#local-6989586621679080303"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080316"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080317"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1287"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#last_"><span class="hs-pragma hs-type">last_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1288"></span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1291"></span><span class="hs-comment">-- length</span><span>
</span><span id="line-1292"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1293"></span><span>
</span><span id="line-1294"></span><span class="annot"><span class="hs-comment">{-| Run a stream, remembering only its length:

&gt;&gt;&gt; runIdentity $ S.length_ (S.each [1..10] :: Stream (Of Int) Identity ())
10

-}</span></span><span>
</span><span id="line-1300"></span><span id="local-6989586621679078816"><span id="local-6989586621679078817"><span id="local-6989586621679078818"><span class="annot"><a href="Streaming.Prelude.html#length_"><span class="hs-identifier hs-type">length_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078816"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078817"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078816"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078818"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078816"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span></span></span></span><span>
</span><span id="line-1301"></span><span id="length_"><span class="annot"><span class="annottext">length_ :: forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m Int
</span><a href="Streaming.Prelude.html#length_"><span class="hs-identifier hs-var hs-var">length_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; Int)
-&gt; Int -&gt; (Int -&gt; Int) -&gt; Stream (Of a) m r -&gt; m Int
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var">fold_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080323"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080323"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080323"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1302"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#length_"><span class="hs-pragma hs-type">length_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1303"></span><span>
</span><span id="line-1304"></span><span class="annot"><span class="hs-comment">{-| Run a stream, keeping its length and its return value.

&gt;&gt;&gt; S.print $ mapped S.length $ chunksOf 3 $ S.each [1..10]
3
3
3
1

-}</span></span><span>
</span><span id="line-1313"></span><span>
</span><span id="line-1314"></span><span id="local-6989586621679078823"><span id="local-6989586621679078824"><span id="local-6989586621679078825"><span class="annot"><a href="Streaming.Prelude.html#length"><span class="hs-identifier hs-type">length</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078823"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078824"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078823"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078825"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078823"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078825"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1315"></span><span id="length"><span class="annot"><span class="annottext">length :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Of Int r)
</span><a href="Streaming.Prelude.html#length"><span class="hs-identifier hs-var hs-var">length</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; Int)
-&gt; Int -&gt; (Int -&gt; Int) -&gt; Stream (Of a) m r -&gt; m (Of Int r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080329"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080329"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080329"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1316"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#length"><span class="hs-pragma hs-type">length</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1317"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1318"></span><span class="hs-comment">-- map</span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span class="annot"><span class="hs-comment">{-| Standard map on the elements of a stream.

&gt;&gt;&gt; S.stdoutLn $ S.map reverse $ each (words &quot;alpha beta&quot;)
ahpla
ateb
-}</span></span><span>
</span><span id="line-1327"></span><span>
</span><span id="line-1328"></span><span id="local-6989586621679078672"><span id="local-6989586621679078673"><span id="local-6989586621679078674"><span id="local-6989586621679078675"><span class="annot"><a href="Streaming.Prelude.html#map"><span class="hs-identifier hs-type">map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078672"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078673"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078674"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078673"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078672"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078674"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078672"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078675"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-1329"></span><span id="map"><span class="annot"><span class="annottext">map :: forall (m :: * -&gt; *) a b r.
Monad m =&gt;
(a -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#map"><span class="hs-identifier hs-var hs-var">map</span></a></span></span><span> </span><span id="local-6989586621679080333"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679080333"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. Of a x -&gt; Of b x)
-&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
forall (m :: * -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *) r.
(Monad m, Functor f) =&gt;
(forall x. f x -&gt; g x) -&gt; Stream f m r -&gt; Stream g m r
</span><a href="Streaming.Internal.html#maps"><span class="hs-identifier hs-var">maps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679080334"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080334"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080335"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080335"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679080333"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080334"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; x -&gt; Of b x
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080335"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1330"></span><span class="hs-comment">-- loop where  --</span><span>
</span><span id="line-1331"></span><span>  </span><span class="hs-comment">-- loop stream = case stream of</span><span>
</span><span id="line-1332"></span><span>  </span><span class="hs-comment">--   Return r -&gt; Return r</span><span>
</span><span id="line-1333"></span><span>  </span><span class="hs-comment">--   Effect m -&gt; Effect (fmap loop m)</span><span>
</span><span id="line-1334"></span><span>  </span><span class="hs-comment">--   Step (a :&gt; as) -&gt; Step (f a :&gt; loop as)</span><span>
</span><span id="line-1335"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#map"><span class="hs-pragma hs-type">map</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1336"></span><span class="hs-comment">-- {-# NOINLINE [1] map #-}</span><span>
</span><span id="line-1337"></span><span class="hs-comment">-- {-# RULES</span><span>
</span><span id="line-1338"></span><span class="hs-comment">-- &quot;map/map&quot;  [~1] forall f g bs . map f (map g bs) =</span><span>
</span><span id="line-1339"></span><span class="hs-comment">--   map (f . g) bs</span><span>
</span><span id="line-1340"></span><span class="hs-comment">-- #-}</span><span>
</span><span id="line-1341"></span><span>
</span><span id="line-1342"></span><span class="annot"><span class="hs-comment">{-| Replace each element of a stream with the result of a monadic action

&gt;&gt;&gt; S.print $ S.mapM readIORef $ S.chain (\ior -&gt; modifyIORef ior (*100)) $ S.mapM newIORef $ each [1..6]
100
200
300
400
500
600

See also 'chain' for a variant of this which ignores the return value of the function and just uses the side effects.
-}</span></span><span>
</span><span id="line-1354"></span><span id="local-6989586621679078839"><span id="local-6989586621679078840"><span id="local-6989586621679078841"><span id="local-6989586621679078842"><span class="annot"><a href="Streaming.Prelude.html#mapM"><span class="hs-identifier hs-type">mapM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078839"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078840"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078839"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078841"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078840"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078839"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078842"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078841"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078839"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078842"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-1355"></span><span id="mapM"><span class="annot"><span class="annottext">mapM :: forall (m :: * -&gt; *) a b r.
Monad m =&gt;
(a -&gt; m b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#mapM"><span class="hs-identifier hs-var hs-var">mapM</span></a></span></span><span> </span><span id="local-6989586621679080342"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679080342"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080343"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1356"></span><span>  </span><span id="local-6989586621679080343"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080343"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080344"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080344"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080344"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1357"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080345"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080345"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080345"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1358"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080346"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080346"><span class="hs-identifier hs-var">m</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of b) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of b) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080343"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080346"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1359"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080347"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080347"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080348"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080348"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of b) m r) -&gt; Stream (Of b) m r)
-&gt; m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1360"></span><span>      </span><span id="local-6989586621679080349"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080349"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679080342"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080347"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1361"></span><span>      </span><span class="annot"><span class="annottext">Stream (Of b) m r -&gt; m (Stream (Of b) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of b (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080349"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Stream (Of b) m r -&gt; Of b (Stream (Of b) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080343"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080348"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1362"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapM"><span class="hs-pragma hs-type">mapM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1363"></span><span>
</span><span id="line-1364"></span><span>
</span><span id="line-1365"></span><span>
</span><span id="line-1366"></span><span class="annot"><span class="hs-comment">{-| Reduce a stream to its return value with a monadic action.

&gt;&gt;&gt; S.mapM_ Prelude.print $ each [1..3]
1
2
3


&gt;&gt;&gt; rest &lt;- S.mapM_ Prelude.print $ S.splitAt 3 $ each [1..10]
1
2
3
&gt;&gt;&gt; S.sum rest
49 :&gt; ()

-}</span></span><span>
</span><span id="line-1382"></span><span id="local-6989586621679078847"><span id="local-6989586621679078848"><span id="local-6989586621679078849"><span id="local-6989586621679078850"><span class="annot"><a href="Streaming.Prelude.html#mapM_"><span class="hs-identifier hs-type">mapM_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078847"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078848"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078847"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078849"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078847"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078850"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078847"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078850"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-1383"></span><span id="mapM_"><span class="annot"><span class="annottext">mapM_ :: forall (m :: * -&gt; *) a x r.
Monad m =&gt;
(a -&gt; m x) -&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#mapM_"><span class="hs-identifier hs-var hs-var">mapM_</span></a></span></span><span> </span><span id="local-6989586621679080355"><span class="annot"><span class="annottext">a -&gt; m x
</span><a href="#local-6989586621679080355"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679080356"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1384"></span><span>  </span><span id="local-6989586621679080356"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679080356"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080357"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080357"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080357"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1385"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080358"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080358"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; m r
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080358"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1386"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080359"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080359"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080359"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; (Stream (Of a) m r -&gt; m r) -&gt; m r
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679080356"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-1387"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080360"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080360"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080361"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080361"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m x
</span><a href="#local-6989586621679080355"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080360"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m x -&gt; m r -&gt; m r
forall a b. m a -&gt; m b -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679080356"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080361"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1388"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapM_"><span class="hs-pragma hs-type">mapM_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1389"></span><span>
</span><span id="line-1390"></span><span>
</span><span id="line-1391"></span><span>
</span><span id="line-1392"></span><span class="annot"><span class="hs-comment">{- | Map layers of one functor to another with a transformation involving the base monad.
 
     This function is completely functor-general. It is often useful with the more concrete type

@
mapped :: (forall x. Stream (Of a) IO x -&gt; IO (Of b x)) -&gt; Stream (Stream (Of a) IO) IO r -&gt; Stream (Of b) IO r
@

     to process groups which have been demarcated in an effectful, @IO@-based
     stream by grouping functions like 'Streaming.Prelude.group',
     'Streaming.Prelude.split' or 'Streaming.Prelude.breaks'. Summary functions
     like 'Streaming.Prelude.fold', 'Streaming.Prelude.foldM',
     'Streaming.Prelude.mconcat' or 'Streaming.Prelude.toList' are often used
     to define the transformation argument. For example:

&gt;&gt;&gt; S.toList_ $ S.mapped S.toList $ S.split 'c' (S.each &quot;abcde&quot;)
[&quot;ab&quot;,&quot;de&quot;]

     'Streaming.Prelude.maps' and 'Streaming.Prelude.mapped' obey these rules:

&gt; maps id              = id
&gt; mapped return        = id
&gt; maps f . maps g      = maps (f . g)
&gt; mapped f . mapped g  = mapped (f &lt;=&lt; g)
&gt; maps f . mapped g    = mapped (fmap f . g)
&gt; mapped f . maps g    = mapped (f &lt;=&lt; fmap g)

     'Streaming.Prelude.maps' is more fundamental than
     'Streaming.Prelude.mapped', which is best understood as a convenience for
     effecting this frequent composition:

&gt; mapped phi = decompose . maps (Compose . phi)


-}</span></span><span>
</span><span id="line-1427"></span><span>
</span><span id="line-1428"></span><span id="local-6989586621679078855"><span id="local-6989586621679078856"><span id="local-6989586621679078858"><span id="local-6989586621679078859"><span class="annot"><a href="Streaming.Prelude.html#mapped"><span class="hs-identifier hs-type">mapped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078855"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078856"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679078857"><span class="annot"><a href="#local-6989586621679078857"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679078856"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078857"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078858"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078857"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078856"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078859"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078858"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078859"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-1429"></span><span id="mapped"><span class="annot"><span class="annottext">mapped :: forall (m :: * -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *) r.
(Monad m, Functor f) =&gt;
(forall x. f x -&gt; m (g x)) -&gt; Stream f m r -&gt; Stream g m r
</span><a href="Streaming.Prelude.html#mapped"><span class="hs-identifier hs-var hs-var">mapped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. f x -&gt; m (g x)) -&gt; Stream f m r -&gt; Stream g m r
forall (m :: * -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *) r.
(Monad m, Functor f) =&gt;
(forall x. f x -&gt; m (g x)) -&gt; Stream f m r -&gt; Stream g m r
</span><a href="Streaming.Internal.html#mapsM"><span class="hs-identifier hs-var">mapsM</span></a></span><span>
</span><span id="line-1430"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapped"><span class="hs-pragma hs-type">mapped</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1431"></span><span>
</span><span id="line-1432"></span><span class="annot"><span class="hs-comment">{-| A version of 'mapped' that imposes a 'Functor' constraint on the target functor rather
    than the source functor. This version should be preferred if 'fmap' on the target
    functor is cheaper.

-}</span></span><span>
</span><span id="line-1437"></span><span id="local-6989586621679078865"><span id="local-6989586621679078866"><span id="local-6989586621679078867"><span id="local-6989586621679078869"><span class="annot"><a href="Streaming.Prelude.html#mappedPost"><span class="hs-identifier hs-type">mappedPost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078865"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078866"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679078868"><span class="annot"><a href="#local-6989586621679078868"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679078867"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078868"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078865"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078866"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078868"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078867"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078865"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078869"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078866"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078865"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078869"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-1438"></span><span id="mappedPost"><span class="annot"><span class="annottext">mappedPost :: forall (m :: * -&gt; *) (g :: * -&gt; *) (f :: * -&gt; *) r.
(Monad m, Functor g) =&gt;
(forall x. f x -&gt; m (g x)) -&gt; Stream f m r -&gt; Stream g m r
</span><a href="Streaming.Prelude.html#mappedPost"><span class="hs-identifier hs-var hs-var">mappedPost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. f x -&gt; m (g x)) -&gt; Stream f m r -&gt; Stream g m r
forall (m :: * -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *) r.
(Monad m, Functor g) =&gt;
(forall x. f x -&gt; m (g x)) -&gt; Stream f m r -&gt; Stream g m r
</span><a href="Streaming.Internal.html#mapsMPost"><span class="hs-identifier hs-var">mapsMPost</span></a></span><span>
</span><span id="line-1439"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mappedPost"><span class="hs-pragma hs-type">mappedPost</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1440"></span><span>
</span><span id="line-1441"></span><span class="annot"><span class="hs-comment">{-| Map each element of the stream to a monoid, and take the monoidal sum of the results.

&gt;&gt;&gt; S.foldMap Sum $ S.take 2 (S.stdinLn)
1&lt;Enter&gt;
2&lt;Enter&gt;
3&lt;Enter&gt;
Sum {getSum = 6} :&gt; ()

 -}</span></span><span>
</span><span id="line-1450"></span><span id="local-6989586621679078879"><span id="local-6989586621679078880"><span id="local-6989586621679078881"><span id="local-6989586621679078882"><span class="annot"><a href="Streaming.Prelude.html#foldMap"><span class="hs-identifier hs-type">foldMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078879"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078880"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078880"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078879"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078882"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078879"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078880"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078882"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1451"></span><span id="foldMap"><span class="annot"><span class="annottext">foldMap :: forall (m :: * -&gt; *) w a r.
(Monad m, Monoid w) =&gt;
(a -&gt; w) -&gt; Stream (Of a) m r -&gt; m (Of w r)
</span><a href="Streaming.Prelude.html#foldMap"><span class="hs-identifier hs-var hs-var">foldMap</span></a></span></span><span> </span><span id="local-6989586621679080377"><span class="annot"><span class="annottext">a -&gt; w
</span><a href="#local-6989586621679080377"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; a -&gt; w) -&gt; w -&gt; (w -&gt; w) -&gt; Stream (Of a) m r -&gt; m (Of w r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080378"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679080378"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679080379"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080379"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679080378"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; w
</span><a href="#local-6989586621679080377"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080379"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">w
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1452"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldMap"><span class="hs-pragma hs-type">foldMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1453"></span><span>
</span><span id="line-1454"></span><span id="local-6989586621679078888"><span id="local-6989586621679078889"><span id="local-6989586621679078890"><span id="local-6989586621679078891"><span class="annot"><a href="Streaming.Prelude.html#foldMap_"><span class="hs-identifier hs-type">foldMap_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078888"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078889"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078890"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078889"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078890"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078888"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078891"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078888"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078889"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span><span>
</span><span id="line-1455"></span><span id="foldMap_"><span class="annot"><span class="annottext">foldMap_ :: forall (m :: * -&gt; *) w a r.
(Monad m, Monoid w) =&gt;
(a -&gt; w) -&gt; Stream (Of a) m r -&gt; m w
</span><a href="Streaming.Prelude.html#foldMap_"><span class="hs-identifier hs-var hs-var">foldMap_</span></a></span></span><span> </span><span id="local-6989586621679080385"><span class="annot"><span class="annottext">a -&gt; w
</span><a href="#local-6989586621679080385"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; a -&gt; w) -&gt; w -&gt; (w -&gt; w) -&gt; Stream (Of a) m r -&gt; m w
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var">fold_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080386"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679080386"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679080387"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080387"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679080386"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; w
</span><a href="#local-6989586621679080385"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">w
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1456"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#foldMap_"><span class="hs-pragma hs-type">foldMap_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1457"></span><span>
</span><span id="line-1458"></span><span class="annot"><span class="hs-comment">{-| Fold streamed items into their monoidal sum

&gt;&gt;&gt; S.mconcat $ S.take 2 $ S.map (Data.Monoid.Last . Just) S.stdinLn
first&lt;Enter&gt;
last&lt;Enter&gt;
Last {getLast = Just &quot;last&quot;} :&gt; ()

 -}</span></span><span>
</span><span id="line-1466"></span><span id="local-6989586621679078896"><span id="local-6989586621679078897"><span id="local-6989586621679078898"><span class="annot"><a href="Streaming.Prelude.html#mconcat"><span class="hs-identifier hs-type">mconcat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078896"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078897"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078897"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078896"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078898"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078896"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078897"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078898"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1467"></span><span id="mconcat"><span class="annot"><span class="annottext">mconcat :: forall (m :: * -&gt; *) w r.
(Monad m, Monoid w) =&gt;
Stream (Of w) m r -&gt; m (Of w r)
</span><a href="Streaming.Prelude.html#mconcat"><span class="hs-identifier hs-var hs-var">mconcat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; w) -&gt; w -&gt; (w -&gt; w) -&gt; Stream (Of w) m r -&gt; m (Of w r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">w
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1468"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mconcat"><span class="hs-pragma hs-type">mconcat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1469"></span><span>
</span><span id="line-1470"></span><span class="hs-keyword">data</span><span> </span><span id="Maybe_"><span class="annot"><a href="Streaming.Prelude.html#Maybe_"><span class="hs-identifier hs-var">Maybe_</span></a></span></span><span> </span><span id="local-6989586621679078809"><span class="annot"><a href="#local-6989586621679078809"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Just_"><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679078809"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Nothing_"><span class="annot"><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span></span><span>
</span><span id="line-1471"></span><span id="local-6989586621679078902"><span id="local-6989586621679078903"><span id="local-6989586621679078904"><span class="annot"><a href="Streaming.Prelude.html#mconcat_"><span class="hs-identifier hs-type">mconcat_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078902"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078903"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078903"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078902"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078904"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078902"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078903"><span class="hs-identifier hs-type">w</span></a></span></span></span></span><span>
</span><span id="line-1472"></span><span id="mconcat_"><span class="annot"><span class="annottext">mconcat_ :: forall (m :: * -&gt; *) w r.
(Monad m, Monoid w) =&gt;
Stream (Of w) m r -&gt; m w
</span><a href="Streaming.Prelude.html#mconcat_"><span class="hs-identifier hs-var hs-var">mconcat_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; w) -&gt; w -&gt; (w -&gt; w) -&gt; Stream (Of w) m r -&gt; m w
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var">fold_</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">w
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1473"></span><span>
</span><span id="line-1474"></span><span id="local-6989586621679078908"><span id="local-6989586621679078909"><span id="local-6989586621679078910"><span class="annot"><a href="Streaming.Prelude.html#minimum"><span class="hs-identifier hs-type">minimum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078908"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078909"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078909"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078908"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078910"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078908"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078909"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078910"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1475"></span><span id="minimum"><span class="annot"><span class="annottext">minimum :: forall (m :: * -&gt; *) a r.
(Monad m, Ord a) =&gt;
Stream (Of a) m r -&gt; m (Of (Maybe a) r)
</span><a href="Streaming.Prelude.html#minimum"><span class="hs-identifier hs-var hs-var">minimum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe_ a -&gt; a -&gt; Maybe_ a)
-&gt; Maybe_ a
-&gt; (Maybe_ a -&gt; Maybe a)
-&gt; Stream (Of a) m r
-&gt; m (Of (Maybe a) r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080402"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080402"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679080403"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080403"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080402"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080403"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080404"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080404"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080403"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080404"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1476"></span><span>               </span><span class="annot"><span class="annottext">Maybe_ a
forall a. Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span>
</span><span id="line-1477"></span><span>               </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080406"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080406"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080406"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080407"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080407"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080407"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1478"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#minimum"><span class="hs-pragma hs-type">minimum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1479"></span><span>
</span><span id="line-1480"></span><span id="local-6989586621679078914"><span id="local-6989586621679078915"><span id="local-6989586621679078916"><span class="annot"><a href="Streaming.Prelude.html#minimum_"><span class="hs-identifier hs-type">minimum_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078914"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078915"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078915"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078914"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078916"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078914"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078915"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1481"></span><span id="minimum_"><span class="annot"><span class="annottext">minimum_ :: forall (m :: * -&gt; *) a r.
(Monad m, Ord a) =&gt;
Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="Streaming.Prelude.html#minimum_"><span class="hs-identifier hs-var hs-var">minimum_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe_ a -&gt; a -&gt; Maybe_ a)
-&gt; Maybe_ a
-&gt; (Maybe_ a -&gt; Maybe a)
-&gt; Stream (Of a) m r
-&gt; m (Maybe a)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var">fold_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080412"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080412"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679080413"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080413"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080412"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080413"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080414"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080414"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080413"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080414"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1482"></span><span>                 </span><span class="annot"><span class="annottext">Maybe_ a
forall a. Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span>
</span><span id="line-1483"></span><span>                 </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080415"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080415"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080415"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080416"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080416"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080416"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1484"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#minimum_"><span class="hs-pragma hs-type">minimum_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1485"></span><span>
</span><span id="line-1486"></span><span id="local-6989586621679080417"><span id="local-6989586621679080418"><span id="local-6989586621679080419"><span class="annot"><a href="Streaming.Prelude.html#maximum"><span class="hs-identifier hs-type">maximum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080417"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080417"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080419"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080417"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080419"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1487"></span><span id="maximum"><span class="annot"><span class="annottext">maximum :: forall (m :: * -&gt; *) a r.
(Monad m, Ord a) =&gt;
Stream (Of a) m r -&gt; m (Of (Maybe a) r)
</span><a href="Streaming.Prelude.html#maximum"><span class="hs-identifier hs-var hs-var">maximum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe_ a -&gt; a -&gt; Maybe_ a)
-&gt; Maybe_ a
-&gt; (Maybe_ a -&gt; Maybe a)
-&gt; Stream (Of a) m r
-&gt; m (Of (Maybe a) r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080424"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080424"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679080425"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080425"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080424"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080425"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080426"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080426"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#max"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080425"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080426"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1488"></span><span>               </span><span class="annot"><span class="annottext">Maybe_ a
forall a. Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span>
</span><span id="line-1489"></span><span>               </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080428"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080428"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080428"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080429"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080429"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080429"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1490"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#maximum"><span class="hs-pragma hs-type">maximum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1491"></span><span>
</span><span id="line-1492"></span><span id="local-6989586621679080430"><span id="local-6989586621679080431"><span id="local-6989586621679080432"><span class="annot"><a href="Streaming.Prelude.html#maximum_"><span class="hs-identifier hs-type">maximum_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080430"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080431"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080431"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080430"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080432"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080430"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080431"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1493"></span><span id="maximum_"><span class="annot"><span class="annottext">maximum_ :: forall (m :: * -&gt; *) a r.
(Monad m, Ord a) =&gt;
Stream (Of a) m r -&gt; m (Maybe a)
</span><a href="Streaming.Prelude.html#maximum_"><span class="hs-identifier hs-var hs-var">maximum_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe_ a -&gt; a -&gt; Maybe_ a)
-&gt; Maybe_ a
-&gt; (Maybe_ a -&gt; Maybe a)
-&gt; Stream (Of a) m r
-&gt; m (Maybe a)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var">fold_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080437"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080437"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679080438"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080438"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080437"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080438"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080439"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080439"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe_ a
forall a. a -&gt; Maybe_ a
</span><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-var">Just_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#max"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080438"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080439"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1494"></span><span>                 </span><span class="annot"><span class="annottext">Maybe_ a
forall a. Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span>
</span><span id="line-1495"></span><span>                 </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080440"><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080440"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="#local-6989586621679080440"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe_ a
</span><a href="Streaming.Prelude.html#Nothing_"><span class="hs-identifier hs-var">Nothing_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#Just_"><span class="hs-identifier hs-type">Just_</span></a></span><span> </span><span id="local-6989586621679080441"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080441"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080441"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1496"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#maximum_"><span class="hs-pragma hs-type">maximum_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1497"></span><span>
</span><span id="line-1498"></span><span class="annot"><span class="hs-comment">{-| The standard way of inspecting the first item in a stream of elements, if the
     stream is still \'running\'. The @Right@ case contains a
     Haskell pair, where the more general @inspect@ would return a left-strict pair.
     There is no reason to prefer @inspect@ since, if the @Right@ case is exposed,
     the first element in the pair will have been evaluated to whnf.

&gt; next    :: Monad m =&gt; Stream (Of a) m r -&gt; m (Either r    (a, Stream (Of a) m r))
&gt; inspect :: Monad m =&gt; Stream (Of a) m r -&gt; m (Either r (Of a (Stream (Of a) m r)))

     Interoperate with @pipes@ producers thus:

&gt; Pipes.unfoldr Stream.next :: Stream (Of a) m r -&gt; Producer a m r
&gt; Stream.unfoldr Pipes.next :: Producer a m r -&gt; Stream (Of a) m r

     Similarly:

&gt; IOStreams.unfoldM (fmap (either (const Nothing) Just) . next) :: Stream (Of a) IO b -&gt; IO (InputStream a)
&gt; Conduit.unfoldM   (fmap (either (const Nothing) Just) . next) :: Stream (Of a) m r -&gt; Source a m r

     But see 'uncons', which is better fitted to these @unfoldM@s
-}</span></span><span>
</span><span id="line-1519"></span><span id="local-6989586621679078521"><span id="local-6989586621679078522"><span id="local-6989586621679078523"><span class="annot"><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-type">next</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078521"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078522"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078521"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078523"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078521"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078523"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078522"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078522"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078521"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078523"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1520"></span><span id="next"><span class="annot"><span class="annottext">next :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="#local-6989586621679080444"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1521"></span><span>  </span><span id="local-6989586621679080444"><span class="annot"><span class="annottext">loop :: Stream (Of a) m a -&gt; m (Either a (a, Stream (Of a) m a))
</span><a href="#local-6989586621679080444"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080453"><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679080453"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679080453"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1522"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080454"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080454"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (a, Stream (Of a) m a)
-&gt; m (Either a (a, Stream (Of a) m a))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a (a, Stream (Of a) m a)
forall a b. a -&gt; Either a b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080454"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1523"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080455"><span class="annot"><span class="annottext">m (Stream (Of a) m a)
</span><a href="#local-6989586621679080455"><span class="hs-identifier hs-var">m</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m a)
</span><a href="#local-6989586621679080455"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m a)
-&gt; (Stream (Of a) m a -&gt; m (Either a (a, Stream (Of a) m a)))
-&gt; m (Either a (a, Stream (Of a) m a))
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a -&gt; m (Either a (a, Stream (Of a) m a))
</span><a href="#local-6989586621679080444"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-1524"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080456"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080456"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080457"><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679080457"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (a, Stream (Of a) m a)
-&gt; m (Either a (a, Stream (Of a) m a))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, Stream (Of a) m a) -&gt; Either a (a, Stream (Of a) m a)
forall a b. b -&gt; Either a b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080456"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679080457"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1525"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#next"><span class="hs-pragma hs-type">next</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1526"></span><span>
</span><span id="line-1527"></span><span>
</span><span id="line-1528"></span><span class="annot"><span class="hs-comment">{-| Exhaust a stream deciding whether @a@ was an element.

-}</span></span><span>
</span><span id="line-1531"></span><span>
</span><span id="line-1532"></span><span id="local-6989586621679080458"><span id="local-6989586621679080459"><span id="local-6989586621679080460"><span class="annot"><a href="Streaming.Prelude.html#notElem"><span class="hs-identifier hs-type">notElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080458"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080458"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080460"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080458"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080460"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1533"></span><span id="notElem"><span class="annot"><span class="annottext">notElem :: forall (m :: * -&gt; *) a r.
(Monad m, Eq a) =&gt;
a -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="Streaming.Prelude.html#notElem"><span class="hs-identifier hs-var hs-var">notElem</span></a></span></span><span> </span><span id="local-6989586621679080472"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080472"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679080473"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1534"></span><span>  </span><span id="local-6989586621679080473"><span class="annot"><span class="annottext">loop :: Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679080473"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span id="local-6989586621679080474"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080474"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; Of Bool r) -&gt; m r -&gt; m (Of Bool r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var">effects</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080474"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1535"></span><span>  </span><span class="annot"><a href="#local-6989586621679080473"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span id="local-6989586621679080475"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080475"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080475"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1536"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080476"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080476"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of Bool r -&gt; m (Of Bool r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080476"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1537"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080477"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080477"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080477"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Of Bool r)) -&gt; m (Of Bool r)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679080473"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1538"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080478"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080478"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080479"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080479"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1539"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080478"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080472"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-1540"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(r -&gt; Of Bool r) -&gt; m r -&gt; m (Of Bool r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; r -&gt; Of Bool r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#effects"><span class="hs-identifier hs-var">effects</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080479"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1541"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m (Of Bool r)
</span><a href="#local-6989586621679080473"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080479"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1542"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#notElem"><span class="hs-pragma hs-type">notElem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1543"></span><span>
</span><span id="line-1544"></span><span id="local-6989586621679080480"><span id="local-6989586621679080481"><span id="local-6989586621679080482"><span class="annot"><a href="Streaming.Prelude.html#notElem_"><span class="hs-identifier hs-type">notElem_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080480"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080481"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080480"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080482"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080480"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span><span>
</span><span id="line-1545"></span><span id="notElem_"><span class="annot"><span class="annottext">notElem_ :: forall (m :: * -&gt; *) a r.
(Monad m, Eq a) =&gt;
a -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="Streaming.Prelude.html#notElem_"><span class="hs-identifier hs-var hs-var">notElem_</span></a></span></span><span> </span><span id="local-6989586621679080490"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080490"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679080491"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1546"></span><span>  </span><span id="local-6989586621679080491"><span class="annot"><span class="annottext">loop :: Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679080491"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1547"></span><span>  </span><span class="annot"><a href="#local-6989586621679080491"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span id="local-6989586621679080492"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080492"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080492"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1548"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1549"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080493"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080493"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080493"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; (Stream (Of a) m r -&gt; m Bool) -&gt; m Bool
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679080491"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1550"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080494"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080494"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080495"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080495"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1551"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080494"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080490"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-1552"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1553"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m r -&gt; m Bool
</span><a href="#local-6989586621679080491"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080495"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1554"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#notElem_"><span class="hs-pragma hs-type">notElem_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1555"></span><span>
</span><span id="line-1556"></span><span>
</span><span id="line-1557"></span><span class="annot"><span class="hs-comment">{-| Remove repeated elements from a Stream. 'nubOrd' of course accumulates a 'Data.Set.Set' of
    elements that have already been seen and should thus be used with care.

&gt;&gt;&gt; S.toList_ $ S.nubOrd $ S.take 5 S.readLn :: IO [Int]
1&lt;Enter&gt;
2&lt;Enter&gt;
3&lt;Enter&gt;
1&lt;Enter&gt;
2&lt;Enter&gt;
[1,2,3]

-}</span></span><span>
</span><span id="line-1569"></span><span>
</span><span id="line-1570"></span><span id="local-6989586621679078940"><span id="local-6989586621679078941"><span id="local-6989586621679078942"><span class="annot"><a href="Streaming.Prelude.html#nubOrd"><span class="hs-identifier hs-type">nubOrd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078940"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078940"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078942"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078940"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078942"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1571"></span><span id="nubOrd"><span class="annot"><span class="annottext">nubOrd :: forall (m :: * -&gt; *) a r.
(Monad m, Ord a) =&gt;
Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#nubOrd"><span class="hs-identifier hs-var hs-var">nubOrd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
forall (m :: * -&gt; *) b a r.
(Monad m, Ord b) =&gt;
(a -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#nubOrdOn"><span class="hs-identifier hs-var">nubOrdOn</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1572"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#nubOrd"><span class="hs-pragma hs-type">nubOrd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1573"></span><span>
</span><span id="line-1574"></span><span class="annot"><span class="hs-comment">{-|  Use 'nubOrdOn' to have a custom ordering function for your elements. -}</span></span><span>
</span><span id="line-1575"></span><span id="local-6989586621679078946"><span id="local-6989586621679078947"><span id="local-6989586621679078948"><span id="local-6989586621679078949"><span class="annot"><a href="Streaming.Prelude.html#nubOrdOn"><span class="hs-identifier hs-type">nubOrdOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078946"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078947"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078947"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078948"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078946"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078949"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078948"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078946"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078949"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-1576"></span><span id="nubOrdOn"><span class="annot"><span class="annottext">nubOrdOn :: forall (m :: * -&gt; *) b a r.
(Monad m, Ord b) =&gt;
(a -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#nubOrdOn"><span class="hs-identifier hs-var hs-var">nubOrdOn</span></a></span></span><span> </span><span id="local-6989586621679080507"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679080507"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679080508"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080508"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set b -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080509"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080508"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1577"></span><span>  </span><span id="local-6989586621679080509"><span class="annot"><span class="annottext">loop :: Set b -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080509"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080510"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679080511"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080511"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080511"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1578"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080512"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080512"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080512"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1579"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080513"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080513"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set b -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080509"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080513"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1580"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080515"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080515"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080516"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080516"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080517"><span class="annot"><span class="annottext">fa :: b
</span><a href="#local-6989586621679080517"><span class="hs-identifier hs-var hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679080507"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1581"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">b -&gt; Set b -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080517"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-1582"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Set b -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080509"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080516"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1583"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set b -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080509"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Set b -&gt; Set b
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080517"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080516"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1584"></span><span>
</span><span id="line-1585"></span><span class="annot"><span class="hs-comment">{-| More efficient versions of above when working with 'Int's that use 'Data.IntSet.IntSet'. -}</span></span><span>
</span><span id="line-1586"></span><span>
</span><span id="line-1587"></span><span id="local-6989586621679078961"><span id="local-6989586621679078962"><span class="annot"><a href="Streaming.Prelude.html#nubInt"><span class="hs-identifier hs-type">nubInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078961"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078961"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078962"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078961"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078962"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-1588"></span><span id="nubInt"><span class="annot"><span class="annottext">nubInt :: forall (m :: * -&gt; *) r.
Monad m =&gt;
Stream (Of Int) m r -&gt; Stream (Of Int) m r
</span><a href="Streaming.Prelude.html#nubInt"><span class="hs-identifier hs-var hs-var">nubInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Stream (Of Int) m r -&gt; Stream (Of Int) m r
forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Int) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#nubIntOn"><span class="hs-identifier hs-var">nubIntOn</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1589"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#nubInt"><span class="hs-pragma hs-type">nubInt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1590"></span><span>
</span><span id="line-1591"></span><span id="local-6989586621679078965"><span id="local-6989586621679078966"><span id="local-6989586621679078967"><span class="annot"><a href="Streaming.Prelude.html#nubIntOn"><span class="hs-identifier hs-type">nubIntOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078966"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078966"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078967"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078966"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078967"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1592"></span><span id="nubIntOn"><span class="annot"><span class="annottext">nubIntOn :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Int) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#nubIntOn"><span class="hs-identifier hs-var hs-var">nubIntOn</span></a></span></span><span> </span><span id="local-6989586621679080526"><span class="annot"><span class="annottext">a -&gt; Int
</span><a href="#local-6989586621679080526"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679080527"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080527"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080528"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080527"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1593"></span><span>  </span><span id="local-6989586621679080528"><span class="annot"><span class="annottext">loop :: IntSet -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080528"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080529"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679080529"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679080530"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080530"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080530"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1594"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080531"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080531"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080531"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1595"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080532"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080532"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m r)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntSet -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080528"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679080529"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080532"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1596"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080533"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080533"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080534"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080534"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080535"><span class="annot"><span class="annottext">fa :: Int
</span><a href="#local-6989586621679080535"><span class="hs-identifier hs-var hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
</span><a href="#local-6989586621679080526"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080533"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1597"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntSet -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntSet.Internal.html#member"><span class="hs-identifier hs-var">IntSet.member</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080535"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679080529"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-1598"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080528"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679080529"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080534"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1599"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080533"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080528"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntSet -&gt; IntSet
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntSet.Internal.html#insert"><span class="hs-identifier hs-var">IntSet.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080535"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679080529"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080534"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1600"></span><span>
</span><span id="line-1601"></span><span>
</span><span id="line-1602"></span><span class="annot"><span class="hs-comment">{-|
&gt; filter p = hoist effects (partition p)

 -}</span></span><span>
</span><span id="line-1606"></span><span id="local-6989586621679078972"><span id="local-6989586621679078973"><span id="local-6989586621679078974"><span class="annot"><a href="Streaming.Prelude.html#partition"><span class="hs-identifier hs-type">partition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078972"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078973"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078973"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078972"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078974"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078973"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078973"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078972"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078974"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1607"></span><span id="partition"><span class="annot"><span class="annottext">partition :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="Streaming.Prelude.html#partition"><span class="hs-identifier hs-var hs-var">partition</span></a></span></span><span> </span><span id="local-6989586621679080546"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679080546"><span class="hs-identifier hs-var">thus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080547"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1608"></span><span>   </span><span id="local-6989586621679080547"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080547"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080548"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080548"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080548"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1609"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080549"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080549"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080549"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1610"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080550"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080550"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall a b. (a -&gt; b) -&gt; Stream (Of a) m a -&gt; Stream (Of a) m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080547"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of a) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080550"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1611"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080551"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080551"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080552"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080552"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679080546"><span class="hs-identifier hs-var">thus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080551"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1612"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080551"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Stream (Of a) (Stream (Of a) m) r
-&gt; Of a (Stream (Of a) (Stream (Of a) m) r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080547"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080552"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1613"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
 -&gt; Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1614"></span><span>               </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080551"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1615"></span><span>               </span><span class="annot"><span class="annottext">Stream (Of a) (Stream (Of a) m) r
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080547"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080552"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1616"></span><span>
</span><span id="line-1617"></span><span>
</span><span id="line-1618"></span><span class="annot"><span class="hs-comment">{-| Separate left and right values in distinct streams. ('separate' is
    a more powerful, functor-general, equivalent using 'Sum' in place of 'Either').
    So, for example, to permit unlimited user
    input of @Int@s on condition of only two errors, we might write:

&gt;&gt;&gt; S.toList $ S.print $ S.take 2 $ partitionEithers $ S.map readEither $ S.stdinLn  :: IO (Of [Int] ())
1&lt;Enter&gt;
2&lt;Enter&gt;
qqqqqqqqqq&lt;Enter&gt;
&quot;Prelude.read: no parse&quot;
3&lt;Enter&gt;
rrrrrrrrrr&lt;Enter&gt;
&quot;Prelude.read: no parse&quot;
[1,2,3] :&gt; ()

&gt; partitionEithers = separate . maps S.eitherToSum
&gt; lefts  = hoist S.effects . partitionEithers
&gt; rights = S.effects . partitionEithers
&gt; rights = S.concat
-}</span></span><span>
</span><span id="line-1638"></span><span id="local-6989586621679078978"><span id="local-6989586621679078979"><span id="local-6989586621679078980"><span id="local-6989586621679078981"><span class="annot"><a href="Streaming.Prelude.html#partitionEithers"><span class="hs-identifier hs-type">partitionEithers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078978"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078979"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078980"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078978"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078981"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078979"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078980"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078978"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078981"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-1639"></span><span id="partitionEithers"><span class="annot"><span class="annottext">partitionEithers :: forall (m :: * -&gt; *) a b r.
Monad m =&gt;
Stream (Of (Either a b)) m r -&gt; Stream (Of a) (Stream (Of b) m) r
</span><a href="Streaming.Prelude.html#partitionEithers"><span class="hs-identifier hs-var hs-var">partitionEithers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Stream (Of (Either a b)) m r -&gt; Stream (Of a) (Stream (Of b) m) r
forall (m :: * -&gt; *) a b r.
Monad m =&gt;
Stream (Of (Either a b)) m r -&gt; Stream (Of a) (Stream (Of b) m) r
</span><a href="#local-6989586621679080555"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1640"></span><span>   </span><span id="local-6989586621679080555"><span class="annot"><span class="annottext">loop :: Stream (Of (Either a a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080555"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080569"><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r
</span><a href="#local-6989586621679080569"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r
</span><a href="#local-6989586621679080569"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1641"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080570"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080570"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080570"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1642"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080571"><span class="annot"><span class="annottext">m (Stream (Of (Either a a)) m r)
</span><a href="#local-6989586621679080571"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of (Either a a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) m (Stream (Of (Either a a)) m r)
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall a b. (a -&gt; b) -&gt; Stream (Of a) m a -&gt; Stream (Of a) m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080555"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (Stream (Of (Either a a)) m r)
-&gt; Stream (Of a) m (Stream (Of (Either a a)) m r)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of a) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of (Either a a)) m r)
</span><a href="#local-6989586621679080571"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1643"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679080572"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080572"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080573"><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r
</span><a href="#local-6989586621679080573"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080572"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Stream (Of a) (Stream (Of a) m) r
-&gt; Of a (Stream (Of a) (Stream (Of a) m) r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080555"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r
</span><a href="#local-6989586621679080573"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1644"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679080574"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080574"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080575"><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r
</span><a href="#local-6989586621679080575"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
 -&gt; Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1645"></span><span>       </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080574"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1646"></span><span>       </span><span class="annot"><span class="annottext">Stream (Of a) (Stream (Of a) m) r
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679080555"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Either a a)) m r
</span><a href="#local-6989586621679080575"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1647"></span><span>
</span><span id="line-1648"></span><span>
</span><span id="line-1649"></span><span class="annot"><span class="hs-comment">-- | Fold a 'Stream' of numbers into their product</span></span><span>
</span><span id="line-1650"></span><span id="local-6989586621679078990"><span id="local-6989586621679078991"><span class="annot"><a href="Streaming.Prelude.html#product_"><span class="hs-identifier hs-type">product_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078990"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078991"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078991"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078990"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078990"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078991"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1651"></span><span id="product_"><span class="annot"><span class="annottext">product_ :: forall (m :: * -&gt; *) a.
(Monad m, Num a) =&gt;
Stream (Of a) m () -&gt; m a
</span><a href="Streaming.Prelude.html#product_"><span class="hs-identifier hs-var hs-var">product_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; (a -&gt; a) -&gt; Stream (Of a) m () -&gt; m a
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var">fold_</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">(*)</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1652"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#product_"><span class="hs-pragma hs-type">product_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1653"></span><span>
</span><span id="line-1654"></span><span class="annot"><span class="hs-comment">{-| Fold a 'Stream' of numbers into their product with the return value

&gt;  mapped product :: Stream (Stream (Of Int)) m r -&gt; Stream (Of Int) m r
-}</span></span><span>
</span><span id="line-1658"></span><span id="local-6989586621679078994"><span id="local-6989586621679078995"><span id="local-6989586621679078996"><span class="annot"><a href="Streaming.Prelude.html#product"><span class="hs-identifier hs-type">product</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078994"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078995"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078995"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078996"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078996"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1659"></span><span id="product"><span class="annot"><span class="annottext">product :: forall (m :: * -&gt; *) a r.
(Monad m, Num a) =&gt;
Stream (Of a) m r -&gt; m (Of a r)
</span><a href="Streaming.Prelude.html#product"><span class="hs-identifier hs-var hs-var">product</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; (a -&gt; a) -&gt; Stream (Of a) m r -&gt; m (Of a r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">(*)</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1660"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#product"><span class="hs-pragma hs-type">product</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1661"></span><span>
</span><span id="line-1662"></span><span>
</span><span id="line-1663"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1664"></span><span class="hs-comment">-- read</span><span>
</span><span id="line-1665"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1666"></span><span>
</span><span id="line-1667"></span><span class="annot"><span class="hs-comment">{- | Make a stream of strings into a stream of parsed values, skipping bad cases

&gt;&gt;&gt; S.sum_ $ S.read $ S.takeWhile (/= &quot;total&quot;) S.stdinLn :: IO Int
1000&lt;Enter&gt;
2000&lt;Enter&gt;
total&lt;Enter&gt;
3000


-}</span></span><span>
</span><span id="line-1677"></span><span id="local-6989586621679079000"><span id="local-6989586621679079001"><span id="local-6989586621679079002"><span class="annot"><a href="Streaming.Prelude.html#read"><span class="hs-identifier hs-type">read</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079000"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079001"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079000"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079002"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079001"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079000"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079002"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1678"></span><span id="read"><span class="annot"><span class="annottext">read :: forall (m :: * -&gt; *) a r.
(Monad m, Read a) =&gt;
Stream (Of String) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#read"><span class="hs-identifier hs-var hs-var">read</span></a></span></span><span> </span><span id="local-6989586621679080593"><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679080593"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r
-&gt; (String -&gt; Stream (Of a) m ()) -&gt; Stream (Of a) m r
forall (m :: * -&gt; *) (f :: * -&gt; *) a r x.
(Monad m, Functor f) =&gt;
Stream (Of a) m r -&gt; (a -&gt; Stream f m x) -&gt; Stream f m r
</span><a href="Streaming.Prelude.html#for"><span class="hs-identifier hs-var">for</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679080593"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Stream (Of a) m ()) -&gt; Stream (Of a) m r)
-&gt; (String -&gt; Stream (Of a) m ()) -&gt; Stream (Of a) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080594"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679080594"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Read.html#readMaybe"><span class="hs-identifier hs-var">readMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679080594"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1679"></span><span>  </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1680"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679080595"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080595"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080595"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1681"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#read"><span class="hs-pragma hs-type">read</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1682"></span><span>
</span><span id="line-1683"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1684"></span><span class="hs-comment">-- repeat</span><span>
</span><span id="line-1685"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1686"></span><span class="annot"><span class="hs-comment">{-| Repeat an element /ad inf./ .

&gt;&gt;&gt; S.print $ S.take 3 $ S.repeat 1
1
1
1
-}</span></span><span>
</span><span id="line-1693"></span><span>
</span><span id="line-1694"></span><span id="local-6989586621679079007"><span id="local-6989586621679079008"><span id="local-6989586621679079009"><span class="annot"><a href="Streaming.Prelude.html#repeat"><span class="hs-identifier hs-type">repeat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079007"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079008"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079007"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079009"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1695"></span><span id="repeat"><span class="annot"><span class="annottext">repeat :: forall (m :: * -&gt; *) a r. Monad m =&gt; a -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#repeat"><span class="hs-identifier hs-var hs-var">repeat</span></a></span></span><span> </span><span id="local-6989586621679080598"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080598"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080599"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679080599"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r
</span><a href="#local-6989586621679080599"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080598"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080599"><span class="hs-identifier hs-var">loop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1696"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#repeat"><span class="hs-pragma hs-type">repeat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1697"></span><span>
</span><span id="line-1698"></span><span>
</span><span id="line-1699"></span><span class="annot"><span class="hs-comment">{-| Repeat a monadic action /ad inf./, streaming its results.

&gt;&gt;&gt; S.toList $ S.take 2 $ repeatM getLine
one&lt;Enter&gt;
two&lt;Enter&gt;
[&quot;one&quot;,&quot;two&quot;]

-}</span></span><span>
</span><span id="line-1707"></span><span>
</span><span id="line-1708"></span><span id="local-6989586621679079013"><span id="local-6989586621679079014"><span id="local-6989586621679079015"><span class="annot"><a href="Streaming.Prelude.html#repeatM"><span class="hs-identifier hs-type">repeatM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079014"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079014"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079015"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1709"></span><span id="repeatM"><span class="annot"><span class="annottext">repeatM :: forall (m :: * -&gt; *) a r. Monad m =&gt; m a -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#repeatM"><span class="hs-identifier hs-var hs-var">repeatM</span></a></span></span><span> </span><span id="local-6989586621679080607"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679080607"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080608"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1710"></span><span>  </span><span id="local-6989586621679080608"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r
</span><a href="#local-6989586621679080608"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1711"></span><span>    </span><span id="local-6989586621679080609"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080609"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of a) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679080607"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-1712"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080609"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1713"></span><span>    </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080608"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-1714"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#repeatM"><span class="hs-pragma hs-type">repeatM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1715"></span><span>
</span><span id="line-1716"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1717"></span><span class="hs-comment">-- replicate</span><span>
</span><span id="line-1718"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1719"></span><span>
</span><span id="line-1720"></span><span class="annot"><span class="hs-comment">-- | Repeat an element several times.</span></span><span>
</span><span id="line-1721"></span><span id="local-6989586621679079019"><span id="local-6989586621679079020"><span class="annot"><a href="Streaming.Prelude.html#replicate"><span class="hs-identifier hs-type">replicate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079019"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079020"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079020"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079019"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1722"></span><span id="replicate"><span class="annot"><span class="annottext">replicate :: forall (m :: * -&gt; *) a. Monad m =&gt; Int -&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#replicate"><span class="hs-identifier hs-var hs-var">replicate</span></a></span></span><span> </span><span id="local-6989586621679080620"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080620"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080620"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1723"></span><span class="annot"><a href="Streaming.Prelude.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span id="local-6989586621679080621"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080621"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679080622"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080622"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080623"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080621"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1724"></span><span>  </span><span id="local-6989586621679080623"><span class="annot"><span class="annottext">loop :: Int -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080623"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1725"></span><span>  </span><span class="annot"><a href="#local-6989586621679080623"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679080624"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080624"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m () -&gt; m (Stream (Of a) m ())
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080622"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m () -&gt; Of a (Stream (Of a) m ())
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080623"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080624"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#replicate"><span class="hs-pragma hs-type">replicate</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1727"></span><span>
</span><span id="line-1728"></span><span class="annot"><span class="hs-comment">{-| Repeat an action several times, streaming its results.

&gt;&gt;&gt; S.print $ S.replicateM 2 getCurrentTime
2015-08-18 00:57:36.124508 UTC
2015-08-18 00:57:36.124785 UTC

-}</span></span><span>
</span><span id="line-1735"></span><span id="local-6989586621679079023"><span id="local-6989586621679079024"><span class="annot"><a href="Streaming.Prelude.html#replicateM"><span class="hs-identifier hs-type">replicateM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079023"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079023"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079024"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079024"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079023"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1736"></span><span id="replicateM"><span class="annot"><span class="annottext">replicateM :: forall (m :: * -&gt; *) a. Monad m =&gt; Int -&gt; m a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#replicateM"><span class="hs-identifier hs-var hs-var">replicateM</span></a></span></span><span> </span><span id="local-6989586621679080636"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080636"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">m a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080636"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1737"></span><span class="annot"><a href="Streaming.Prelude.html#replicateM"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span id="local-6989586621679080637"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080637"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679080638"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679080638"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080639"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080637"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1738"></span><span>  </span><span id="local-6989586621679080639"><span class="annot"><span class="annottext">loop :: Int -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080639"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1739"></span><span>  </span><span class="annot"><a href="#local-6989586621679080639"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679080640"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080640"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m ()) -&gt; Stream (Of a) m ())
-&gt; m (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1740"></span><span>    </span><span id="local-6989586621679080641"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080641"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679080638"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-1741"></span><span>    </span><span class="annot"><span class="annottext">Stream (Of a) m () -&gt; m (Stream (Of a) m ())
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080641"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m () -&gt; Of a (Stream (Of a) m ())
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080639"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080640"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1742"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#replicateM"><span class="hs-pragma hs-type">replicateM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1743"></span><span>
</span><span id="line-1744"></span><span class="annot"><span class="hs-comment">{-| Read an @IORef (Maybe a)@ or a similar device until it reads @Nothing@.
    @reread@ provides convenient exit from the @io-streams@ library

&gt; reread readIORef    :: IORef (Maybe a) -&gt; Stream (Of a) IO ()
&gt; reread Streams.read :: System.IO.Streams.InputStream a -&gt; Stream (Of a) IO ()
-}</span></span><span>
</span><span id="line-1750"></span><span id="local-6989586621679079027"><span id="local-6989586621679079028"><span id="local-6989586621679079029"><span class="annot"><a href="Streaming.Prelude.html#reread"><span class="hs-identifier hs-type">reread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079028"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079029"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079028"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079029"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1751"></span><span id="reread"><span class="annot"><span class="annottext">reread :: forall (m :: * -&gt; *) s a.
Monad m =&gt;
(s -&gt; m (Maybe a)) -&gt; s -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#reread"><span class="hs-identifier hs-var hs-var">reread</span></a></span></span><span> </span><span id="local-6989586621679080646"><span class="annot"><span class="annottext">s -&gt; m (Maybe a)
</span><a href="#local-6989586621679080646"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679080647"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080647"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
</span><a href="#local-6989586621679080648"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1752"></span><span>  </span><span id="local-6989586621679080648"><span class="annot"><span class="annottext">loop :: Stream (Of a) m ()
</span><a href="#local-6989586621679080648"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m ()) -&gt; Stream (Of a) m ())
-&gt; m (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1753"></span><span>    </span><span id="local-6989586621679080649"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679080649"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">s -&gt; m (Maybe a)
</span><a href="#local-6989586621679080646"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080647"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1754"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679080649"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1755"></span><span>      </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m () -&gt; m (Stream (Of a) m ())
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1756"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679080650"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080650"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m () -&gt; m (Stream (Of a) m ())
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080650"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m () -&gt; Of a (Stream (Of a) m ())
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
</span><a href="#local-6989586621679080648"><span class="hs-identifier hs-var">loop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1757"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#reread"><span class="hs-pragma hs-type">reread</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1758"></span><span>
</span><span id="line-1759"></span><span class="annot"><span class="hs-comment">{-| Strict left scan, streaming, e.g. successive partial results. The seed
    is yielded first, before any action of finding the next element is performed.


&gt;&gt;&gt; S.print $ S.scan (++) &quot;&quot; id $ each (words &quot;a b c d&quot;)
&quot;&quot;
&quot;a&quot;
&quot;ab&quot;
&quot;abc&quot;
&quot;abcd&quot;

    'scan' is fitted for use with @Control.Foldl@, thus:

&gt;&gt;&gt; S.print $ L.purely S.scan L.list $ each [3..5]
[]
[3]
[3,4]
[3,4,5]

-}</span></span><span>
</span><span id="line-1779"></span><span id="local-6989586621679079033"><span id="local-6989586621679079034"><span id="local-6989586621679079035"><span id="local-6989586621679079036"><span id="local-6989586621679079037"><span class="annot"><a href="Streaming.Prelude.html#scan"><span class="hs-identifier hs-type">scan</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079034"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079035"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079034"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079034"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079034"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079036"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079035"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079037"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079036"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079037"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-1780"></span><span id="scan"><span class="annot"><span class="annottext">scan :: forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x)
-&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#scan"><span class="hs-identifier hs-var hs-var">scan</span></a></span></span><span> </span><span id="local-6989586621679080655"><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080655"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679080656"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080656"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679080657"><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080657"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span id="local-6989586621679080658"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080658"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Of b (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080657"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080656"><span class="hs-identifier hs-var">begin</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Stream (Of b) m r -&gt; Of b (Stream (Of b) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080659"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080656"><span class="hs-identifier hs-var">begin</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080658"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1781"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1782"></span><span>  </span><span id="local-6989586621679080659"><span class="annot"><span class="annottext">loop :: x -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080659"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080660"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080660"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679080661"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080661"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1783"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080661"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1784"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080662"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080662"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080662"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1785"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080663"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080663"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of b) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of b) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080659"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080660"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080663"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1786"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080664"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080664"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080665"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080665"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1787"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080666"><span class="annot"><span class="annottext">acc' :: x
</span><a href="#local-6989586621679080666"><span class="hs-identifier hs-var hs-var">acc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080655"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080660"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080664"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1788"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Of b (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080657"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080666"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Stream (Of b) m r -&gt; Of b (Stream (Of b) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080659"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080666"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080665"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1789"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#scan"><span class="hs-pragma hs-type">scan</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1790"></span><span>
</span><span id="line-1791"></span><span class="annot"><span class="hs-comment">{-| Strict left scan, accepting a monadic function. It can be used with
    'FoldM's from @Control.Foldl@ using 'impurely'. Here we yield
    a succession of vectors each recording

&gt;&gt;&gt; let v = L.impurely scanM L.vectorM $ each [1..4::Int] :: Stream (Of (Vector Int)) IO ()
&gt;&gt;&gt; S.print v
[]
[1]
[1,2]
[1,2,3]
[1,2,3,4]

-}</span></span><span>
</span><span id="line-1804"></span><span id="local-6989586621679079043"><span id="local-6989586621679079044"><span id="local-6989586621679079045"><span id="local-6989586621679079046"><span id="local-6989586621679079047"><span class="annot"><a href="Streaming.Prelude.html#scanM"><span class="hs-identifier hs-type">scanM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079043"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079044"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079045"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079043"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079044"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079043"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079044"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079044"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079043"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079046"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079043"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079047"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079046"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079043"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079047"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-1805"></span><span id="scanM"><span class="annot"><span class="annottext">scanM :: forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; m x)
-&gt; m x -&gt; (x -&gt; m b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#scanM"><span class="hs-identifier hs-var hs-var">scanM</span></a></span></span><span> </span><span id="local-6989586621679080676"><span class="annot"><span class="annottext">x -&gt; a -&gt; m x
</span><a href="#local-6989586621679080676"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679080677"><span class="annot"><span class="annottext">m x
</span><a href="#local-6989586621679080677"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679080678"><span class="annot"><span class="annottext">x -&gt; m b
</span><a href="#local-6989586621679080678"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span id="local-6989586621679080679"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080679"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of b) m r) -&gt; Stream (Of b) m r)
-&gt; m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1806"></span><span>    </span><span id="local-6989586621679080680"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080680"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m x
</span><a href="#local-6989586621679080677"><span class="hs-identifier hs-var">begin</span></a></span><span>
</span><span id="line-1807"></span><span>    </span><span id="local-6989586621679080681"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080681"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">x -&gt; m b
</span><a href="#local-6989586621679080678"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080680"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1808"></span><span>    </span><span class="annot"><span class="annottext">Stream (Of b) m r -&gt; m (Stream (Of b) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of b (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080681"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Stream (Of b) m r -&gt; Of b (Stream (Of b) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080682"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080680"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080679"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1809"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1810"></span><span>    </span><span id="local-6989586621679080682"><span class="annot"><span class="annottext">loop :: x -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080682"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080683"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080683"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679080684"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080684"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080684"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- note we have already yielded from x</span><span>
</span><span id="line-1811"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080685"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080685"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080685"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1812"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080686"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080686"><span class="hs-identifier hs-var">m</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-1813"></span><span>        </span><span id="local-6989586621679080687"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080687"><span class="hs-identifier hs-var">stream'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080686"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1814"></span><span>        </span><span class="annot"><span class="annottext">Stream (Of b) m r -&gt; m (Stream (Of b) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080682"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080683"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080687"><span class="hs-identifier hs-var">stream'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1815"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-1816"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080688"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080688"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080689"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080689"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-1817"></span><span>        </span><span id="local-6989586621679080690"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080690"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">x -&gt; a -&gt; m x
</span><a href="#local-6989586621679080676"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080683"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080688"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1818"></span><span>        </span><span id="local-6989586621679080691"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080691"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">x -&gt; m b
</span><a href="#local-6989586621679080678"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080690"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-1819"></span><span>        </span><span class="annot"><span class="annottext">Stream (Of b) m r -&gt; m (Stream (Of b) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of b (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080691"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Stream (Of b) m r -&gt; Of b (Stream (Of b) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679080682"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080690"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080689"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1820"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-1821"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#scanM"><span class="hs-pragma hs-type">scanM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1822"></span><span>
</span><span id="line-1823"></span><span class="annot"><span class="hs-comment">{-| Label each element in a stream with a value accumulated according to a fold.

&gt;&gt;&gt; S.print $ S.scanned (*) 1 id $ S.each [100,200,300]
(100,100)
(200,20000)
(300,6000000)

&gt;&gt;&gt; S.print $ L.purely S.scanned L.product $ S.each [100,200,300]
(100,100)
(200,20000)
(300,6000000)

-}</span></span><span>
</span><span id="line-1836"></span><span>
</span><span id="line-1837"></span><span id="local-6989586621679079053"><span id="local-6989586621679079054"><span id="local-6989586621679079055"><span id="local-6989586621679079056"><span id="local-6989586621679079057"><span class="annot"><a href="Streaming.Prelude.html#scanned"><span class="hs-identifier hs-type">scanned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079054"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079054"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079054"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079054"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079056"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079057"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679079056"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079057"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-1838"></span><span id="scanned"><span class="annot"><span class="annottext">scanned :: forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x)
-&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of (a, b)) m r
</span><a href="Streaming.Prelude.html#scanned"><span class="hs-identifier hs-var hs-var">scanned</span></a></span></span><span> </span><span id="local-6989586621679080702"><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080702"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679080703"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080703"><span class="hs-identifier hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621679080704"><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080704"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe' a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of (a, b)) m r
</span><a href="#local-6989586621679080705"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe' a
forall a. Maybe' a
</span><a href="Streaming.Prelude.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080703"><span class="hs-identifier hs-var">begin</span></a></span><span>
</span><span id="line-1839"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1840"></span><span>    </span><span id="local-6989586621679080705"><span class="annot"><span class="annottext">loop :: Maybe' a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of (a, b)) m r
</span><a href="#local-6989586621679080705"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080707"><span class="annot"><span class="annottext">Maybe' a
</span><a href="#local-6989586621679080707"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080708"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080708"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679080709"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080709"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1841"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080709"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1842"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080710"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080710"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of (a, b)) m r
forall a. a -&gt; Stream (Of (a, b)) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080710"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1843"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080711"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080711"><span class="hs-identifier hs-var">mn</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of (a, b)) m r) -&gt; Stream (Of (a, b)) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of (a, b)) m r) -&gt; Stream (Of (a, b)) m r)
-&gt; m (Stream (Of (a, b)) m r) -&gt; Stream (Of (a, b)) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of (a, b)) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of (a, b)) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe' a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of (a, b)) m r
</span><a href="#local-6989586621679080705"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe' a
</span><a href="#local-6989586621679080707"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080708"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080711"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-1844"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080712"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080712"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080713"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080713"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1845"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe' a
</span><a href="#local-6989586621679080707"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1846"></span><span>            </span><span class="annot"><span class="annottext">Maybe' a
</span><a href="Streaming.Prelude.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1847"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080714"><span class="annot"><span class="annottext">acc :: x
</span><a href="#local-6989586621679080714"><span class="hs-identifier hs-var hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080702"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080708"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080712"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1848"></span><span>              </span><span class="annot"><span class="annottext">(a, b) -&gt; Stream (Of (a, b)) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080712"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080704"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080714"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1849"></span><span>              </span><span class="annot"><span class="annottext">Maybe' a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of (a, b)) m r
</span><a href="#local-6989586621679080705"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe' a
forall a. a -&gt; Maybe' a
</span><a href="Streaming.Prelude.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080712"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080714"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080713"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1850"></span><span>            </span><span class="annot"><a href="Streaming.Prelude.html#Just%27"><span class="hs-identifier hs-type">Just'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1851"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679080716"><span class="annot"><span class="annottext">acc :: b
</span><a href="#local-6989586621679080716"><span class="hs-identifier hs-var hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; b
</span><a href="#local-6989586621679080704"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080702"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080708"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080712"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1852"></span><span>              </span><span class="annot"><span class="annottext">(a, b) -&gt; Stream (Of (a, b)) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080712"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080716"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1853"></span><span>              </span><span class="annot"><span class="annottext">Maybe' a -&gt; x -&gt; Stream (Of a) m r -&gt; Stream (Of (a, b)) m r
</span><a href="#local-6989586621679080705"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe' a
forall a. a -&gt; Maybe' a
</span><a href="Streaming.Prelude.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080712"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; a -&gt; x
</span><a href="#local-6989586621679080702"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679080708"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080712"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080713"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1854"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#scanned"><span class="hs-pragma hs-type">scanned</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1855"></span><span>
</span><span id="line-1856"></span><span class="hs-keyword">data</span><span> </span><span id="Maybe%27"><span class="annot"><a href="Streaming.Prelude.html#Maybe%27"><span class="hs-identifier hs-var">Maybe'</span></a></span></span><span> </span><span id="local-6989586621679079064"><span class="annot"><a href="#local-6989586621679079064"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Just%27"><span class="annot"><a href="Streaming.Prelude.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679079064"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Nothing%27"><span class="annot"><a href="Streaming.Prelude.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a></span></span><span>
</span><span id="line-1857"></span><span>
</span><span id="line-1858"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1859"></span><span class="hs-comment">-- sequence</span><span>
</span><span id="line-1860"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1861"></span><span>
</span><span id="line-1862"></span><span class="annot"><span class="hs-comment">{-| Like the 'Data.List.sequence' but streaming. The result type is a
    stream of a\'s, /but is not accumulated/; the effects of the elements
    of the original stream are interleaved in the resulting stream. Compare:

&gt; sequence :: Monad m =&gt;       [m a]           -&gt; m [a]
&gt; sequence :: Monad m =&gt; Stream (Of (m a)) m r -&gt; Stream (Of a) m r

   This obeys the rule

-}</span></span><span>
</span><span id="line-1872"></span><span id="local-6989586621679079065"><span id="local-6989586621679079066"><span id="local-6989586621679079067"><span class="annot"><a href="Streaming.Prelude.html#sequence"><span class="hs-identifier hs-type">sequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079066"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079067"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079066"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079067"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1873"></span><span id="sequence"><span class="annot"><span class="annottext">sequence :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of (m a)) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#sequence"><span class="hs-identifier hs-var hs-var">sequence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of (m a)) m r -&gt; Stream (Of a) m r
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of (m a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080719"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1874"></span><span>  </span><span id="local-6989586621679080719"><span class="annot"><span class="annottext">loop :: Stream (Of (m a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080719"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080728"><span class="annot"><span class="annottext">Stream (Of (m a)) m r
</span><a href="#local-6989586621679080728"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of (m a)) m r
</span><a href="#local-6989586621679080728"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1875"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080729"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080729"><span class="hs-identifier hs-var">r</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080729"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1876"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080730"><span class="annot"><span class="annottext">m (Stream (Of (m a)) m r)
</span><a href="#local-6989586621679080730"><span class="hs-identifier hs-var">m</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m r) -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of (m a)) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of (m a)) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (m a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080719"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of (m a)) m r)
</span><a href="#local-6989586621679080730"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1877"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080731"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679080731"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080732"><span class="annot"><span class="annottext">Stream (Of (m a)) m r
</span><a href="#local-6989586621679080732"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m r) -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1878"></span><span>      </span><span id="local-6989586621679080733"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080733"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679080731"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-1879"></span><span>      </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080733"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (m a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080719"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (m a)) m r
</span><a href="#local-6989586621679080732"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1880"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sequence"><span class="hs-pragma hs-type">sequence</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1881"></span><span>
</span><span id="line-1882"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1883"></span><span class="hs-comment">-- show</span><span>
</span><span id="line-1884"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1885"></span><span>
</span><span id="line-1886"></span><span id="local-6989586621679079074"><span id="local-6989586621679079075"><span id="local-6989586621679079076"><span class="annot"><a href="Streaming.Prelude.html#show"><span class="hs-identifier hs-type">show</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079074"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079075"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079075"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079076"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079076"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1887"></span><span id="show"><span class="annot"><span class="annottext">show :: forall (m :: * -&gt; *) a r.
(Monad m, Show a) =&gt;
Stream (Of a) m r -&gt; Stream (Of String) m r
</span><a href="Streaming.Prelude.html#show"><span class="hs-identifier hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; String) -&gt; Stream (Of a) m r -&gt; Stream (Of String) m r
forall (m :: * -&gt; *) a b r.
Monad m =&gt;
(a -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">Prelude.show</span></a></span><span>
</span><span id="line-1888"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#show"><span class="hs-pragma hs-type">show</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1889"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1890"></span><span class="hs-comment">-- sum</span><span>
</span><span id="line-1891"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1892"></span><span>
</span><span id="line-1893"></span><span class="annot"><span class="hs-comment">-- | Fold a 'Stream' of numbers into their sum</span></span><span>
</span><span id="line-1894"></span><span id="local-6989586621679080738"><span id="local-6989586621679080739"><span class="annot"><a href="Streaming.Prelude.html#sum_"><span class="hs-identifier hs-type">sum_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080738"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080739"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080739"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080739"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1895"></span><span id="sum_"><span class="annot"><span class="annottext">sum_ :: forall (m :: * -&gt; *) a.
(Monad m, Num a) =&gt;
Stream (Of a) m () -&gt; m a
</span><a href="Streaming.Prelude.html#sum_"><span class="hs-identifier hs-var hs-var">sum_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; (a -&gt; a) -&gt; Stream (Of a) m () -&gt; m a
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var">fold_</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1896"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sum_"><span class="hs-pragma hs-type">sum_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1897"></span><span>
</span><span id="line-1898"></span><span class="annot"><span class="hs-comment">{-| Fold a 'Stream' of numbers into their sum with the return value

&gt;  mapped S.sum :: Stream (Stream (Of Int)) m r -&gt; Stream (Of Int) m r


&gt;&gt;&gt; S.sum $ each [1..10]
55 :&gt; ()

&gt;&gt;&gt; (n :&gt; rest)  &lt;- S.sum $ S.splitAt 3 $ each [1..10]
&gt;&gt;&gt; System.IO.print n
6
&gt;&gt;&gt; (m :&gt; rest') &lt;- S.sum $ S.splitAt 3 rest
&gt;&gt;&gt; System.IO.print m
15
&gt;&gt;&gt; S.print rest'
7
8
9
10

-}</span></span><span>
</span><span id="line-1919"></span><span id="local-6989586621679080745"><span id="local-6989586621679080746"><span id="local-6989586621679080747"><span class="annot"><a href="Streaming.Prelude.html#sum"><span class="hs-identifier hs-type">sum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080745"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080746"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080746"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080745"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080747"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080745"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080746"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080747"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1920"></span><span id="sum"><span class="annot"><span class="annottext">sum :: forall (m :: * -&gt; *) a r.
(Monad m, Num a) =&gt;
Stream (Of a) m r -&gt; m (Of a r)
</span><a href="Streaming.Prelude.html#sum"><span class="hs-identifier hs-var hs-var">sum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; (a -&gt; a) -&gt; Stream (Of a) m r -&gt; m (Of a r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1921"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sum"><span class="hs-pragma hs-type">sum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1922"></span><span>
</span><span id="line-1923"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1924"></span><span class="hs-comment">-- span</span><span>
</span><span id="line-1925"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1926"></span><span>
</span><span id="line-1927"></span><span class="annot"><span class="hs-comment">-- | Stream elements until one fails the condition, return the rest.</span></span><span>
</span><span id="line-1928"></span><span id="local-6989586621679080753"><span id="local-6989586621679080754"><span id="local-6989586621679080755"><span class="annot"><a href="Streaming.Prelude.html#span"><span class="hs-identifier hs-type">span</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080753"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080754"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080754"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080753"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080755"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1929"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080754"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080753"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080754"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080753"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080755"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1930"></span><span id="span"><span class="annot"><span class="annottext">span :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="Streaming.Prelude.html#span"><span class="hs-identifier hs-var hs-var">span</span></a></span></span><span> </span><span id="local-6989586621679080760"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679080760"><span class="hs-identifier hs-var">thePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679080761"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1931"></span><span>  </span><span id="local-6989586621679080761"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679080761"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080762"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080762"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080762"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1932"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080763"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080763"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080763"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1933"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080764"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080764"><span class="hs-identifier hs-var">m</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m (Stream (Of a) m r))
 -&gt; Stream (Of a) m (Stream (Of a) m r))
-&gt; m (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r))
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m (Stream (Of a) m r))
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679080761"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080764"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1934"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080765"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080765"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080766"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080766"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679080760"><span class="hs-identifier hs-var">thePred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080765"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1935"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m (Stream (Of a) m r))
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080765"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Of a (Stream (Of a) m (Stream (Of a) m r))
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="#local-6989586621679080761"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080766"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1936"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080765"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080766"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1937"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#span"><span class="hs-pragma hs-type">span</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1938"></span><span>
</span><span id="line-1939"></span><span>
</span><span id="line-1940"></span><span class="annot"><span class="hs-comment">{-| Split a stream of elements wherever a given element arises.
    The action is like that of 'Prelude.words'.

&gt;&gt;&gt; S.stdoutLn $ mapped S.toList $ S.split ' ' $ each &quot;hello world  &quot;
hello
world

-}</span></span><span>
</span><span id="line-1948"></span><span>
</span><span id="line-1949"></span><span id="local-6989586621679079089"><span id="local-6989586621679079090"><span id="local-6989586621679079091"><span class="annot"><a href="Streaming.Prelude.html#split"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079089"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079090"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1950"></span><span>      </span><span class="annot"><a href="#local-6989586621679079089"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079089"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079091"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079089"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079090"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079091"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-1951"></span><span id="split"><span class="annot"><span class="annottext">split :: forall a (m :: * -&gt; *) r.
(Eq a, Monad m) =&gt;
a -&gt; Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="Streaming.Prelude.html#split"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679080780"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080780"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679080781"><span class="hs-identifier hs-var">loop</span></a></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1952"></span><span>  </span><span id="local-6989586621679080781"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679080781"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080782"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080782"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080782"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1953"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080783"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080783"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080783"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1954"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080784"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080784"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Stream (Of a) m) m r) -&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Stream (Of a) m) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679080781"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080784"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1955"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080785"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080785"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080786"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080786"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1956"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080785"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080780"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1957"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Stream (Of a) m) m r)
-&gt; Stream (Stream (Of a) m) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Stream (Of a) m) m r)
forall a b. (a -&gt; b) -&gt; Stream (Of a) m a -&gt; Stream (Of a) m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679080781"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080785"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
forall a b.
Stream (Of a) m a -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)
</span><a href="Streaming.Prelude.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080780"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080786"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1958"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Stream (Of a) m) m r
</span><a href="#local-6989586621679080781"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080786"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1959"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#split"><span class="hs-pragma hs-type">split</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1960"></span><span>
</span><span id="line-1961"></span><span class="annot"><span class="hs-comment">{-| Split a succession of layers after some number, returning a streaming or
    effectful pair. This function is the same as the 'splitsAt' exported by the
    @Streaming@ module, but since this module is imported qualified, it can
    usurp a Prelude name. It specializes to:

&gt;  splitAt :: (Monad m) =&gt; Int -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (Stream (Of a) m r)

-}</span></span><span>
</span><span id="line-1969"></span><span id="local-6989586621679079095"><span id="local-6989586621679079096"><span id="local-6989586621679079097"><span class="annot"><a href="Streaming.Prelude.html#splitAt"><span class="hs-identifier hs-type">splitAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079095"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079096"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079095"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079097"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079095"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079095"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079097"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1970"></span><span id="splitAt"><span class="annot"><span class="annottext">splitAt :: forall (m :: * -&gt; *) (f :: * -&gt; *) r.
(Monad m, Functor f) =&gt;
Int -&gt; Stream f m r -&gt; Stream f m (Stream f m r)
</span><a href="Streaming.Prelude.html#splitAt"><span class="hs-identifier hs-var hs-var">splitAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream f m r -&gt; Stream f m (Stream f m r)
forall (m :: * -&gt; *) (f :: * -&gt; *) r.
(Monad m, Functor f) =&gt;
Int -&gt; Stream f m r -&gt; Stream f m (Stream f m r)
</span><a href="Streaming.Internal.html#splitsAt"><span class="hs-identifier hs-var">splitsAt</span></a></span><span>
</span><span id="line-1971"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#splitAt"><span class="hs-pragma hs-type">splitAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1972"></span><span>
</span><span id="line-1973"></span><span class="hs-comment">-- -------</span><span>
</span><span id="line-1974"></span><span class="hs-comment">-- subst</span><span>
</span><span id="line-1975"></span><span class="hs-comment">-- -------</span><span>
</span><span id="line-1976"></span><span class="annot"><span class="hs-comment">{-| Replace each element in a stream of individual values with a functorial
    layer of any sort. @subst = flip with@ and is more convenient in
    a sequence of compositions that transform a stream.

&gt; with = flip subst
&gt; for str f = concats $ subst f str
&gt; subst f = maps (\(a:&gt;r) -&gt; r &lt;$ f a)
&gt; S.concat = concats . subst each
-}</span></span><span>
</span><span id="line-1985"></span><span id="local-6989586621679079101"><span id="local-6989586621679079102"><span id="local-6989586621679079103"><span id="local-6989586621679079104"><span id="local-6989586621679079105"><span class="annot"><a href="Streaming.Prelude.html#subst"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079101"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079102"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079103"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079102"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079104"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079103"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079101"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079105"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079102"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079101"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079105"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-1986"></span><span id="subst"><span class="annot"><span class="annottext">subst :: forall (m :: * -&gt; *) (f :: * -&gt; *) a x r.
(Monad m, Functor f) =&gt;
(a -&gt; f x) -&gt; Stream (Of a) m r -&gt; Stream f m r
</span><a href="Streaming.Prelude.html#subst"><span class="hs-identifier hs-var hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621679080799"><span class="annot"><span class="annottext">a -&gt; f x
</span><a href="#local-6989586621679080799"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679080800"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080800"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080801"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080800"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1987"></span><span>  </span><span id="local-6989586621679080801"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080801"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080802"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080802"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080802"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1988"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080803"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080803"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream f m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080803"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1989"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080804"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080804"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream f m r) -&gt; Stream f m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream f m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream f m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080801"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080804"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1990"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080805"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080805"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080806"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080806"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (Stream f m r) -&gt; Stream f m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080801"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080806"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m r -&gt; f x -&gt; f (Stream f m r)
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%24"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; f x
</span><a href="#local-6989586621679080799"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080805"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1991"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#subst"><span class="hs-pragma hs-type">subst</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1992"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1993"></span><span class="hs-comment">-- take</span><span>
</span><span id="line-1994"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-1995"></span><span>
</span><span id="line-1996"></span><span class="annot"><span class="hs-comment">{-| End a stream after n elements; the original return value is thus lost.
    'splitAt' preserves this information. Note that, like @splitAt@, this
    function is functor-general, so that, for example, you can @take@ not
    just a number of items from a stream of elements, but a number
    of substreams and the like.

&gt;&gt;&gt; S.toList $ S.take 3 $ each &quot;with&quot;
&quot;wit&quot; :&gt; ()

&gt;&gt;&gt; S.readFile &quot;stream.hs&quot; (S.stdoutLn . S.take 3)
import Streaming
import qualified Streaming.Prelude as S
import Streaming.Prelude (each, next, yield)


-}</span></span><span>
</span><span id="line-2012"></span><span>
</span><span id="line-2013"></span><span id="local-6989586621679079113"><span id="local-6989586621679079114"><span id="local-6989586621679079115"><span class="annot"><a href="Streaming.Prelude.html#take"><span class="hs-identifier hs-type">take</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079113"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079114"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079114"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079113"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079115"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079114"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079113"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-2014"></span><span id="take"><span class="annot"><span class="annottext">take :: forall (m :: * -&gt; *) (f :: * -&gt; *) r.
(Monad m, Functor f) =&gt;
Int -&gt; Stream f m r -&gt; Stream f m ()
</span><a href="Streaming.Prelude.html#take"><span class="hs-identifier hs-var hs-var">take</span></a></span></span><span> </span><span id="local-6989586621679080816"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080816"><span class="hs-identifier hs-var">n0</span></a></span></span><span> </span><span class="annot"><span class="annottext">Stream f m r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080816"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream f m ()
forall a. a -&gt; Stream f m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2015"></span><span class="annot"><a href="Streaming.Prelude.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span id="local-6989586621679080817"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080817"><span class="hs-identifier hs-var">n0</span></a></span></span><span> </span><span id="local-6989586621679080818"><span class="annot"><span class="annottext">Stream f m r
</span><a href="#local-6989586621679080818"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream f m r -&gt; Stream f m ()
forall {t} {m :: * -&gt; *} {f :: * -&gt; *} {r}.
(Eq t, Num t, Monad m, Functor f) =&gt;
t -&gt; Stream f m r -&gt; Stream f m ()
</span><a href="#local-6989586621679080819"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080817"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m r
</span><a href="#local-6989586621679080818"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2016"></span><span>  </span><span id="local-6989586621679080819"><span class="annot"><span class="annottext">loop :: t -&gt; Stream f m r -&gt; Stream f m ()
</span><a href="#local-6989586621679080819"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Stream f m r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream f m ()
forall a. a -&gt; Stream f m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2017"></span><span>  </span><span class="annot"><a href="#local-6989586621679080819"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679080837"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080837"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679080838"><span class="annot"><span class="annottext">Stream f m r
</span><a href="#local-6989586621679080838"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2018"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream f m r
</span><a href="#local-6989586621679080838"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2019"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span id="local-6989586621679080839"><span class="annot"><span class="annottext">f (Stream f m r)
</span><a href="#local-6989586621679080839"><span class="hs-identifier hs-var">fas</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (Stream f m ()) -&gt; Stream f m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream f m r -&gt; Stream f m ())
-&gt; f (Stream f m r) -&gt; f (Stream f m ())
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Stream f m r -&gt; Stream f m ()
</span><a href="#local-6989586621679080819"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080837"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (Stream f m r)
</span><a href="#local-6989586621679080839"><span class="hs-identifier hs-var">fas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2020"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080840"><span class="annot"><span class="annottext">m (Stream f m r)
</span><a href="#local-6989586621679080840"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream f m ()) -&gt; Stream f m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream f m r -&gt; Stream f m ())
-&gt; m (Stream f m r) -&gt; m (Stream f m ())
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Stream f m r -&gt; Stream f m ()
</span><a href="#local-6989586621679080819"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080837"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream f m r)
</span><a href="#local-6989586621679080840"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2021"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream f m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2022"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#take"><span class="hs-pragma hs-type">take</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2023"></span><span>
</span><span id="line-2024"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-2025"></span><span class="hs-comment">-- takeWhile</span><span>
</span><span id="line-2026"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-2027"></span><span>
</span><span id="line-2028"></span><span class="annot"><span class="hs-comment">{-| End stream when an element fails a condition; the original return value is lost.
    By contrast 'span' preserves this information, and is generally more desirable.

&gt; S.takeWhile thus = void . S.span thus

    To preserve the information - but thus also force the rest of the stream to be
    developed - write

&gt; S.drained . S.span thus

    as @dropWhile thus@ is

&gt; S.effects . S.span thus

-}</span></span><span>
</span><span id="line-2043"></span><span id="local-6989586621679079123"><span id="local-6989586621679079124"><span id="local-6989586621679079125"><span class="annot"><a href="Streaming.Prelude.html#takeWhile"><span class="hs-identifier hs-type">takeWhile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079123"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079124"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079124"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079123"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079125"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079124"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079123"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-2044"></span><span id="takeWhile"><span class="annot"><span class="annottext">takeWhile :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; Bool) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#takeWhile"><span class="hs-identifier hs-var hs-var">takeWhile</span></a></span></span><span> </span><span id="local-6989586621679080847"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679080847"><span class="hs-identifier hs-var">thePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080848"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2045"></span><span>  </span><span id="local-6989586621679080848"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080848"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080849"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080849"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080849"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2046"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080850"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080850"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080851"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080851"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m () -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679080847"><span class="hs-identifier hs-var">thePred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080850"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080850"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m () -&gt; Of a (Stream (Of a) m ())
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080848"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080851"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2047"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080853"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080853"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m ())
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m ())
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080848"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080853"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2048"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2049"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#takeWhile"><span class="hs-pragma hs-type">takeWhile</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2050"></span><span>
</span><span id="line-2051"></span><span class="annot"><span class="hs-comment">{-| Like 'takeWhile', but takes a monadic predicate. -}</span></span><span>
</span><span id="line-2052"></span><span id="local-6989586621679079130"><span id="local-6989586621679079131"><span id="local-6989586621679079132"><span class="annot"><a href="Streaming.Prelude.html#takeWhileM"><span class="hs-identifier hs-type">takeWhileM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079131"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079131"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079132"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079131"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-2053"></span><span id="takeWhileM"><span class="annot"><span class="annottext">takeWhileM :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
(a -&gt; m Bool) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#takeWhileM"><span class="hs-identifier hs-var hs-var">takeWhileM</span></a></span></span><span> </span><span id="local-6989586621679080863"><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679080863"><span class="hs-identifier hs-var">thePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080864"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2054"></span><span>  </span><span id="local-6989586621679080864"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080864"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080865"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080865"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080865"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2055"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080866"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080866"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080867"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080867"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2056"></span><span>      </span><span id="local-6989586621679080868"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679080868"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; Stream (Of a) m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of a) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679080863"><span class="hs-identifier hs-var">thePred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080866"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2057"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m () -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679080868"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080866"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m () -&gt; Of a (Stream (Of a) m ())
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080864"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080867"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2058"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080869"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080869"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m ())
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m ())
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m ()
</span><a href="#local-6989586621679080864"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080869"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2059"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2060"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#takeWhileM"><span class="hs-pragma hs-type">takeWhileM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2061"></span><span>
</span><span id="line-2062"></span><span>
</span><span id="line-2063"></span><span class="annot"><span class="hs-comment">{-| Convert an effectful @Stream (Of a)@ into a list of @as@

    Note: Needless to say, this function does not stream properly.
    It is basically the same as Prelude 'mapM' which, like 'replicateM',
    'sequence' and similar operations on traversable containers
    is a leading cause of space leaks.

-}</span></span><span>
</span><span id="line-2071"></span><span id="local-6989586621679079136"><span id="local-6989586621679079137"><span id="local-6989586621679079138"><span class="annot"><a href="Streaming.Prelude.html#toList_"><span class="hs-identifier hs-type">toList_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079136"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079137"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079136"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079138"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079136"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079137"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-2072"></span><span id="toList_"><span class="annot"><span class="annottext">toList_ :: forall (m :: * -&gt; *) a r. Monad m =&gt; Stream (Of a) m r -&gt; m [a]
</span><a href="Streaming.Prelude.html#toList_"><span class="hs-identifier hs-var hs-var">toList_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([a] -&gt; [a]) -&gt; a -&gt; [a] -&gt; [a])
-&gt; ([a] -&gt; [a])
-&gt; (([a] -&gt; [a]) -&gt; [a])
-&gt; Stream (Of a) m r
-&gt; m [a]
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m b
</span><a href="Streaming.Prelude.html#fold_"><span class="hs-identifier hs-var">fold_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080872"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679080872"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span id="local-6989586621679080873"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080873"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679080874"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679080874"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679080872"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080873"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679080874"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080875"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679080875"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679080875"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2073"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#toList_"><span class="hs-pragma hs-type">toList_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2074"></span><span>
</span><span id="line-2075"></span><span>
</span><span id="line-2076"></span><span class="annot"><span class="hs-comment">{-| Convert an effectful 'Stream' into a list alongside the return value

&gt;  mapped toList :: Stream (Stream (Of a) m) m r -&gt; Stream (Of [a]) m r

    Like 'toList_', 'toList' breaks streaming; unlike 'toList_' it /preserves the return value/
    and thus is frequently useful with e.g. 'mapped'

&gt;&gt;&gt; S.print $ mapped S.toList $ chunksOf 3 $ each [1..9]
[1,2,3]
[4,5,6]
[7,8,9]

&gt;&gt;&gt; S.print $ mapped S.toList $ chunksOf 2 $ S.replicateM 4 getLine
s&lt;Enter&gt;
t&lt;Enter&gt;
[&quot;s&quot;,&quot;t&quot;]
u&lt;Enter&gt;
v&lt;Enter&gt;
[&quot;u&quot;,&quot;v&quot;]
-}</span></span><span>
</span><span id="line-2096"></span><span id="local-6989586621679079142"><span id="local-6989586621679079143"><span id="local-6989586621679079144"><span class="annot"><a href="Streaming.Prelude.html#toList"><span class="hs-identifier hs-type">toList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079144"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679079144"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-2097"></span><span id="toList"><span class="annot"><span class="annottext">toList :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Of [a] r)
</span><a href="Streaming.Prelude.html#toList"><span class="hs-identifier hs-var hs-var">toList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([a] -&gt; [a]) -&gt; a -&gt; [a] -&gt; [a])
-&gt; ([a] -&gt; [a])
-&gt; (([a] -&gt; [a]) -&gt; [a])
-&gt; Stream (Of a) m r
-&gt; m (Of [a] r)
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; m (Of b r)
</span><a href="Streaming.Prelude.html#fold"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080878"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679080878"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span id="local-6989586621679080879"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080879"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679080880"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679080880"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679080878"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080879"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679080880"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080881"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679080881"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679080881"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2098"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#toList"><span class="hs-pragma hs-type">toList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2099"></span><span>
</span><span id="line-2100"></span><span>
</span><span id="line-2101"></span><span class="annot"><span class="hs-comment">{-| Inspect the first item in a stream of elements, without a return value.
    @uncons@ provides convenient exit into another streaming type:

&gt; IOStreams.unfoldM uncons :: Stream (Of a) IO b -&gt; IO (InputStream a)
&gt; Conduit.unfoldM uncons   :: Stream (Of a) m r -&gt; Conduit.Source m a

-}</span></span><span>
</span><span id="line-2108"></span><span id="local-6989586621679079148"><span id="local-6989586621679079149"><span id="local-6989586621679079150"><span class="annot"><a href="Streaming.Prelude.html#uncons"><span class="hs-identifier hs-type">uncons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079148"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079148"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079150"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079148"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079148"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079150"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-2109"></span><span id="uncons"><span class="annot"><span class="annottext">uncons :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Maybe (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#uncons"><span class="hs-identifier hs-var hs-var">uncons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Maybe (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Maybe (a, Stream (Of a) m r))
</span><a href="#local-6989586621679080884"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2110"></span><span>  </span><span id="local-6989586621679080884"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; m (Maybe (a, Stream (Of a) m r))
</span><a href="#local-6989586621679080884"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080893"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080893"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080893"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2111"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a, Stream (Of a) m r) -&gt; m (Maybe (a, Stream (Of a) m r))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (a, Stream (Of a) m r)
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2112"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080894"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080894"><span class="hs-identifier hs-var">m</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080894"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
-&gt; (Stream (Of a) m r -&gt; m (Maybe (a, Stream (Of a) m r)))
-&gt; m (Maybe (a, Stream (Of a) m r))
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Maybe (a, Stream (Of a) m r))
</span><a href="#local-6989586621679080884"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-2113"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080895"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080895"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080896"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080896"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a, Stream (Of a) m r) -&gt; m (Maybe (a, Stream (Of a) m r))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, Stream (Of a) m r) -&gt; Maybe (a, Stream (Of a) m r)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080895"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080896"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2114"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#uncons"><span class="hs-pragma hs-type">uncons</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2115"></span><span>
</span><span id="line-2116"></span><span>
</span><span id="line-2117"></span><span class="annot"><span class="hs-comment">{-| Build a @Stream@ by unfolding steps starting from a seed. In particular note
    that @S.unfoldr S.next = id@.

    The seed can of course be anything, but this is one natural way
    to consume a @pipes@ 'Pipes.Producer'. Consider:

&gt;&gt;&gt; S.stdoutLn $ S.take 2 $ S.unfoldr Pipes.next Pipes.stdinLn
hello&lt;Enter&gt;
hello
goodbye&lt;Enter&gt;
goodbye

&gt;&gt;&gt; S.stdoutLn $ S.unfoldr Pipes.next (Pipes.stdinLn &gt;-&gt; Pipes.take 2)
hello&lt;Enter&gt;
hello
goodbye&lt;Enter&gt;
goodbye

&gt;&gt;&gt; S.effects $ S.unfoldr Pipes.next (Pipes.stdinLn &gt;-&gt; Pipes.take 2 &gt;-&gt; Pipes.stdoutLn)
hello&lt;Enter&gt;
hello
goodbye&lt;Enter&gt;
goodbye

    @Pipes.unfoldr S.next@ similarly unfolds a @Pipes.Producer@ from a stream.

-}</span></span><span>
</span><span id="line-2144"></span><span id="local-6989586621679079157"><span id="local-6989586621679079158"><span id="local-6989586621679079159"><span id="local-6989586621679079160"><span class="annot"><a href="Streaming.Prelude.html#unfoldr"><span class="hs-identifier hs-type">unfoldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079157"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-2145"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079158"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079159"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079160"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679079158"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079158"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079160"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079159"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-2146"></span><span id="unfoldr"><span class="annot"><span class="annottext">unfoldr :: forall (m :: * -&gt; *) s r a.
Monad m =&gt;
(s -&gt; m (Either r (a, s))) -&gt; s -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#unfoldr"><span class="hs-identifier hs-var hs-var">unfoldr</span></a></span></span><span> </span><span id="local-6989586621679080901"><span class="annot"><span class="annottext">s -&gt; m (Either r (a, s))
</span><a href="#local-6989586621679080901"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080902"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2147"></span><span>  </span><span id="local-6989586621679080902"><span class="annot"><span class="annottext">loop :: s -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080902"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080903"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080903"><span class="hs-identifier hs-var">s0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-2148"></span><span>    </span><span id="local-6989586621679080904"><span class="annot"><span class="annottext">Either r (a, s)
</span><a href="#local-6989586621679080904"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">s -&gt; m (Either r (a, s))
</span><a href="#local-6989586621679080901"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080903"><span class="hs-identifier hs-var">s0</span></a></span><span>
</span><span id="line-2149"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (a, s)
</span><a href="#local-6989586621679080904"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2150"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679080905"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080905"><span class="hs-identifier hs-var">r</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080905"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2151"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080906"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080906"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679080907"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080907"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080906"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679080902"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080907"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2152"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#unfoldr"><span class="hs-pragma hs-type">unfoldr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2153"></span><span>
</span><span id="line-2154"></span><span class="hs-comment">-- ---------------------------------------</span><span>
</span><span id="line-2155"></span><span class="hs-comment">-- untilLeft</span><span>
</span><span id="line-2156"></span><span class="hs-comment">-- ---------------------------------------</span><span>
</span><span id="line-2157"></span><span id="local-6989586621679079165"><span id="local-6989586621679079166"><span id="local-6989586621679079167"><span class="annot"><a href="Streaming.Prelude.html#untilLeft"><span class="hs-identifier hs-type">untilLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079165"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079165"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079166"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079167"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079167"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079165"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079166"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-2158"></span><span id="untilLeft"><span class="annot"><span class="annottext">untilLeft :: forall (m :: * -&gt; *) r a.
Monad m =&gt;
m (Either r a) -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#untilLeft"><span class="hs-identifier hs-var hs-var">untilLeft</span></a></span></span><span> </span><span id="local-6989586621679080912"><span class="annot"><span class="annottext">m (Either r a)
</span><a href="#local-6989586621679080912"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080913"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2159"></span><span>  </span><span id="local-6989586621679080913"><span class="annot"><span class="annottext">loop :: m (Stream (Of a) m r)
</span><a href="#local-6989586621679080913"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2160"></span><span>    </span><span id="local-6989586621679080914"><span class="annot"><span class="annottext">Either r a
</span><a href="#local-6989586621679080914"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either r a)
</span><a href="#local-6989586621679080912"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-2161"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r a
</span><a href="#local-6989586621679080914"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2162"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679080915"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080915"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080915"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080913"><span class="hs-identifier hs-var">loop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2163"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679080916"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080916"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080916"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2164"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#untilLeft"><span class="hs-pragma hs-type">untilLeft</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2165"></span><span>
</span><span id="line-2166"></span><span class="hs-comment">-- ---------------------------------------</span><span>
</span><span id="line-2167"></span><span class="hs-comment">-- untilRight</span><span>
</span><span id="line-2168"></span><span class="hs-comment">-- ---------------------------------------</span><span>
</span><span id="line-2169"></span><span id="local-6989586621679079171"><span id="local-6989586621679079172"><span id="local-6989586621679079173"><span class="annot"><a href="Streaming.Prelude.html#untilRight"><span class="hs-identifier hs-type">untilRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079171"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079171"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079172"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079173"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079172"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079171"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079173"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-2170"></span><span id="untilRight"><span class="annot"><span class="annottext">untilRight :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
m (Either a r) -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#untilRight"><span class="hs-identifier hs-var hs-var">untilRight</span></a></span></span><span> </span><span id="local-6989586621679080921"><span class="annot"><span class="annottext">m (Either a r)
</span><a href="#local-6989586621679080921"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080922"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2171"></span><span>  </span><span id="local-6989586621679080922"><span class="annot"><span class="annottext">loop :: m (Stream (Of a) m r)
</span><a href="#local-6989586621679080922"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2172"></span><span>    </span><span id="local-6989586621679080923"><span class="annot"><span class="annottext">Either a r
</span><a href="#local-6989586621679080923"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either a r)
</span><a href="#local-6989586621679080921"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-2173"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a r
</span><a href="#local-6989586621679080923"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2174"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679080924"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080924"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080924"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2175"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679080925"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080925"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Stream (Of a) m r)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080925"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080922"><span class="hs-identifier hs-var">loop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2176"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#untilRight"><span class="hs-pragma hs-type">untilRight</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2177"></span><span>
</span><span id="line-2178"></span><span class="hs-comment">-- ---------------------------------------</span><span>
</span><span id="line-2179"></span><span class="hs-comment">-- with</span><span>
</span><span id="line-2180"></span><span class="hs-comment">-- ---------------------------------------</span><span>
</span><span id="line-2181"></span><span>
</span><span id="line-2182"></span><span class="annot"><span class="hs-comment">{-| Replace each element in a stream of individual Haskell values (a @Stream (Of a) m r@) with an associated 'functorial' step.

&gt; for str f  = concats (with str f)
&gt; with str f = for str (yields . f)
&gt; with str f = maps (\(a:&gt;r) -&gt; r &lt;$ f a) str
&gt; with = flip subst
&gt; subst = flip with

&gt;&gt;&gt; with (each [1..3]) (yield . Prelude.show) &amp; intercalates (yield &quot;--&quot;) &amp; S.stdoutLn
1
--
2
--
3
 -}</span></span><span>
</span><span id="line-2197"></span><span id="local-6989586621679079177"><span id="local-6989586621679079178"><span id="local-6989586621679079179"><span id="local-6989586621679079180"><span id="local-6989586621679079181"><span class="annot"><a href="Streaming.Prelude.html#with"><span class="hs-identifier hs-type">with</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079177"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079178"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079179"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079177"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079180"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079179"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079178"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079181"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079178"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079177"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079180"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-2198"></span><span id="with"><span class="annot"><span class="annottext">with :: forall (m :: * -&gt; *) (f :: * -&gt; *) a r x.
(Monad m, Functor f) =&gt;
Stream (Of a) m r -&gt; (a -&gt; f x) -&gt; Stream f m r
</span><a href="Streaming.Prelude.html#with"><span class="hs-identifier hs-var hs-var">with</span></a></span></span><span> </span><span id="local-6989586621679080932"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080932"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679080933"><span class="annot"><span class="annottext">a -&gt; f x
</span><a href="#local-6989586621679080933"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080934"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080932"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2199"></span><span>  </span><span id="local-6989586621679080934"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080934"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080935"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080935"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080935"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2200"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080936"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080936"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream f m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080936"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2201"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080937"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080937"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream f m r) -&gt; Stream f m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream f m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream f m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080934"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080937"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2202"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080938"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080938"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080939"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080939"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (Stream f m r) -&gt; Stream f m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream f m r
</span><a href="#local-6989586621679080934"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080939"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Stream f m r -&gt; f x -&gt; f (Stream f m r)
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%24"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; f x
</span><a href="#local-6989586621679080933"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080938"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2203"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#with"><span class="hs-pragma hs-type">with</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2204"></span><span>
</span><span id="line-2205"></span><span class="hs-comment">-- ---------------------------------------</span><span>
</span><span id="line-2206"></span><span class="hs-comment">-- yield</span><span>
</span><span id="line-2207"></span><span class="hs-comment">-- ---------------------------------------</span><span>
</span><span id="line-2208"></span><span>
</span><span id="line-2209"></span><span class="annot"><span class="hs-comment">{-| A singleton stream

&gt;&gt;&gt; stdoutLn $ yield &quot;hello&quot;
hello

&gt;&gt;&gt; S.sum $ do {yield 1; yield 2; yield 3}
6 :&gt; ()

&gt;&gt;&gt; let number = lift (putStrLn &quot;Enter a number:&quot;) &gt;&gt; lift readLn &gt;&gt;= yield :: Stream (Of Int) IO ()
&gt;&gt;&gt; S.toList $ do {number; number; number}
Enter a number:
1&lt;Enter&gt;
Enter a number:
2&lt;Enter&gt;
Enter a number:
3&lt;Enter&gt;
[1,2,3] :&gt; ()

-}</span></span><span>
</span><span id="line-2228"></span><span>
</span><span id="line-2229"></span><span id="local-6989586621679078509"><span id="local-6989586621679078510"><span class="annot"><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-type">yield</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078509"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078510"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078510"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679078509"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-2230"></span><span id="yield"><span class="annot"><span class="annottext">yield :: forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var hs-var">yield</span></a></span></span><span> </span><span id="local-6989586621679080941"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080941"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m ()) -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080941"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m () -&gt; Of a (Stream (Of a) m ())
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2231"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#yield"><span class="hs-pragma hs-type">yield</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2232"></span><span>
</span><span id="line-2233"></span><span class="annot"><span class="hs-comment">-- | Zip two 'Stream's</span></span><span>
</span><span id="line-2234"></span><span id="local-6989586621679079189"><span id="local-6989586621679079190"><span id="local-6989586621679079191"><span id="local-6989586621679079192"><span class="annot"><a href="Streaming.Prelude.html#zip"><span class="hs-identifier hs-type">zip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079189"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-2235"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079189"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079191"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2236"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079192"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079189"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079191"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2237"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679079192"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079189"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079191"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-2238"></span><span id="zip"><span class="annot"><span class="annottext">zip :: forall (m :: * -&gt; *) a r b.
Monad m =&gt;
Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of (a, b)) m r
</span><a href="Streaming.Prelude.html#zip"><span class="hs-identifier hs-var hs-var">zip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; (a, b))
-&gt; Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of (a, b)) m r
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
(a -&gt; b -&gt; c)
-&gt; Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of c) m r
</span><a href="Streaming.Prelude.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-2239"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#zip"><span class="hs-pragma hs-type">zip</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2240"></span><span>
</span><span id="line-2241"></span><span class="annot"><span class="hs-comment">-- | Zip two 'Stream's using the provided combining function</span></span><span>
</span><span id="line-2242"></span><span id="local-6989586621679079197"><span id="local-6989586621679079198"><span id="local-6989586621679079199"><span id="local-6989586621679079200"><span id="local-6989586621679079201"><span class="annot"><a href="Streaming.Prelude.html#zipWith"><span class="hs-identifier hs-type">zipWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079197"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-2243"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079198"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079199"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079200"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2244"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079198"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079197"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079201"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2245"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079199"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079197"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079201"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2246"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079200"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079197"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079201"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-2247"></span><span id="zipWith"><span class="annot"><span class="annottext">zipWith :: forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
(a -&gt; b -&gt; c)
-&gt; Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of c) m r
</span><a href="Streaming.Prelude.html#zipWith"><span class="hs-identifier hs-var hs-var">zipWith</span></a></span></span><span> </span><span id="local-6989586621679080949"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679080949"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of c) m r
</span><a href="#local-6989586621679080950"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-2248"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2249"></span><span>    </span><span id="local-6989586621679080950"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of c) m r
</span><a href="#local-6989586621679080950"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080951"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080951"><span class="hs-identifier hs-var">str0</span></a></span></span><span> </span><span id="local-6989586621679080952"><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080952"><span class="hs-identifier hs-var">str1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080951"><span class="hs-identifier hs-var">str0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2250"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080953"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080953"><span class="hs-identifier hs-var">r</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of c) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080953"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2251"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080954"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080954"><span class="hs-identifier hs-var">m</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of c) m r) -&gt; Stream (Of c) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of c) m r) -&gt; Stream (Of c) m r)
-&gt; m (Stream (Of c) m r) -&gt; Stream (Of c) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of c) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of c) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080955"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080955"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of c) m r
</span><a href="#local-6989586621679080950"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080955"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080952"><span class="hs-identifier hs-var">str1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679080954"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-2252"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080956"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080956"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080957"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080957"><span class="hs-identifier hs-var">rest0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080952"><span class="hs-identifier hs-var">str1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2253"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679080958"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080958"><span class="hs-identifier hs-var">r</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of c) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080958"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2254"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679080959"><span class="annot"><span class="annottext">m (Stream (Of b) m r)
</span><a href="#local-6989586621679080959"><span class="hs-identifier hs-var">m</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of c) m r) -&gt; Stream (Of c) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of c) m r) -&gt; Stream (Of c) m r)
-&gt; m (Stream (Of c) m r) -&gt; Stream (Of c) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of b) m r -&gt; Stream (Of c) m r)
-&gt; m (Stream (Of b) m r) -&gt; m (Stream (Of c) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of c) m r
</span><a href="#local-6989586621679080950"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080951"><span class="hs-identifier hs-var">str0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r)
</span><a href="#local-6989586621679080959"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-2255"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080960"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080960"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679080961"><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080961"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of c (Stream (Of c) m r) -&gt; Stream (Of c) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679080949"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080956"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080960"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; Stream (Of c) m r -&gt; Of c (Stream (Of c) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r -&gt; Stream (Of c) m r
</span><a href="#local-6989586621679080950"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080957"><span class="hs-identifier hs-var">rest0</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080961"><span class="hs-identifier hs-var">rest1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2256"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#zipWith"><span class="hs-pragma hs-type">zipWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2257"></span><span>
</span><span id="line-2258"></span><span>
</span><span id="line-2259"></span><span class="annot"><span class="hs-comment">-- | Zip three 'Stream's with a combining function</span></span><span>
</span><span id="line-2260"></span><span id="local-6989586621679079208"><span id="local-6989586621679079209"><span id="local-6989586621679079210"><span id="local-6989586621679079211"><span id="local-6989586621679079212"><span id="local-6989586621679079213"><span class="annot"><a href="Streaming.Prelude.html#zipWith3"><span class="hs-identifier hs-type">zipWith3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079208"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2261"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079209"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079210"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079211"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079212"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2262"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079209"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079208"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079213"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2263"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079210"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079208"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079213"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2264"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079211"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079208"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079213"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2265"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079212"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079208"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079213"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-2266"></span><span id="zipWith3"><span class="annot"><span class="annottext">zipWith3 :: forall (m :: * -&gt; *) a b c d r.
Monad m =&gt;
(a -&gt; b -&gt; c -&gt; d)
-&gt; Stream (Of a) m r
-&gt; Stream (Of b) m r
-&gt; Stream (Of c) m r
-&gt; Stream (Of d) m r
</span><a href="Streaming.Prelude.html#zipWith3"><span class="hs-identifier hs-var hs-var">zipWith3</span></a></span></span><span> </span><span id="local-6989586621679080981"><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d
</span><a href="#local-6989586621679080981"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
-&gt; Stream (Of b) m r -&gt; Stream (Of c) m r -&gt; Stream (Of d) m r
</span><a href="#local-6989586621679080982"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2267"></span><span>  </span><span id="local-6989586621679080982"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r
-&gt; Stream (Of b) m r -&gt; Stream (Of c) m r -&gt; Stream (Of d) m r
</span><a href="#local-6989586621679080982"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679080983"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080983"><span class="hs-identifier hs-var">str0</span></a></span></span><span> </span><span id="local-6989586621679080984"><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080984"><span class="hs-identifier hs-var">str1</span></a></span></span><span> </span><span id="local-6989586621679080985"><span class="annot"><span class="annottext">Stream (Of c) m r
</span><a href="#local-6989586621679080985"><span class="hs-identifier hs-var">str2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2268"></span><span>    </span><span id="local-6989586621679080986"><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679080986"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either r (a, Stream (Of a) m r))
-&gt; Stream (Of d) m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of d) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080983"><span class="hs-identifier hs-var">str0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2269"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679080986"><span class="hs-identifier hs-var">e0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2270"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679080987"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080987"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of d) m r
forall a. a -&gt; Stream (Of d) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080987"><span class="hs-identifier hs-var">r0</span></a></span><span>
</span><span id="line-2271"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080988"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080988"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679080989"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080989"><span class="hs-identifier hs-var">rest0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2272"></span><span>        </span><span id="local-6989586621679080990"><span class="annot"><span class="annottext">Either r (b, Stream (Of b) m r)
</span><a href="#local-6989586621679080990"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either r (b, Stream (Of b) m r))
-&gt; Stream (Of d) m (Either r (b, Stream (Of b) m r))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of d) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of b) m r -&gt; m (Either r (b, Stream (Of b) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080984"><span class="hs-identifier hs-var">str1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2273"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (b, Stream (Of b) m r)
</span><a href="#local-6989586621679080990"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2274"></span><span>          </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679080991"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080991"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of d) m r
forall a. a -&gt; Stream (Of d) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080991"><span class="hs-identifier hs-var">r1</span></a></span><span>
</span><span id="line-2275"></span><span>          </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080992"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080992"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679080993"><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080993"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2276"></span><span>            </span><span id="local-6989586621679080994"><span class="annot"><span class="annottext">Either r (c, Stream (Of c) m r)
</span><a href="#local-6989586621679080994"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either r (c, Stream (Of c) m r))
-&gt; Stream (Of d) m (Either r (c, Stream (Of c) m r))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of d) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of c) m r -&gt; m (Either r (c, Stream (Of c) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of c) m r
</span><a href="#local-6989586621679080985"><span class="hs-identifier hs-var">str2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2277"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (c, Stream (Of c) m r)
</span><a href="#local-6989586621679080994"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2278"></span><span>              </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679080995"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080995"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of d) m r
forall a. a -&gt; Stream (Of d) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080995"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-2279"></span><span>              </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080996"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679080996"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679080997"><span class="annot"><span class="annottext">Stream (Of c) m r
</span><a href="#local-6989586621679080997"><span class="hs-identifier hs-var">rest2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2280"></span><span>                </span><span class="annot"><span class="annottext">d -&gt; Stream (Of d) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d
</span><a href="#local-6989586621679080981"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080988"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679080992"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679080996"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2281"></span><span>                </span><span class="annot"><span class="annottext">Stream (Of a) m r
-&gt; Stream (Of b) m r -&gt; Stream (Of c) m r -&gt; Stream (Of d) m r
</span><a href="#local-6989586621679080982"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679080989"><span class="hs-identifier hs-var">rest0</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of b) m r
</span><a href="#local-6989586621679080993"><span class="hs-identifier hs-var">rest1</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of c) m r
</span><a href="#local-6989586621679080997"><span class="hs-identifier hs-var">rest2</span></a></span><span>
</span><span id="line-2282"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#zipWith3"><span class="hs-pragma hs-type">zipWith3</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2283"></span><span>
</span><span id="line-2284"></span><span>
</span><span id="line-2285"></span><span class="annot"><span class="hs-comment">-- | Zip three 'Stream's together</span></span><span>
</span><span id="line-2286"></span><span id="local-6989586621679079220"><span id="local-6989586621679079221"><span id="local-6989586621679079222"><span id="local-6989586621679079223"><span id="local-6989586621679079224"><span class="annot"><a href="Streaming.Prelude.html#zip3"><span class="hs-identifier hs-type">zip3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079220"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-2287"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079220"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079222"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2288"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079223"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079220"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079222"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2289"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079224"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079220"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079222"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2290"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679079223"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679079224"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079220"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079222"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-2291"></span><span id="zip3"><span class="annot"><span class="annottext">zip3 :: forall (m :: * -&gt; *) a r b c.
Monad m =&gt;
Stream (Of a) m r
-&gt; Stream (Of b) m r
-&gt; Stream (Of c) m r
-&gt; Stream (Of (a, b, c)) m r
</span><a href="Streaming.Prelude.html#zip3"><span class="hs-identifier hs-var hs-var">zip3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c -&gt; (a, b, c))
-&gt; Stream (Of a) m r
-&gt; Stream (Of b) m r
-&gt; Stream (Of c) m r
-&gt; Stream (Of (a, b, c)) m r
forall (m :: * -&gt; *) a b c d r.
Monad m =&gt;
(a -&gt; b -&gt; c -&gt; d)
-&gt; Stream (Of a) m r
-&gt; Stream (Of b) m r
-&gt; Stream (Of c) m r
-&gt; Stream (Of d) m r
</span><a href="Streaming.Prelude.html#zipWith3"><span class="hs-identifier hs-var">zipWith3</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-2292"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#zip3"><span class="hs-pragma hs-type">zip3</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2293"></span><span>
</span><span id="line-2294"></span><span class="hs-comment">-- --------------</span><span>
</span><span id="line-2295"></span><span class="hs-comment">-- IO fripperies</span><span>
</span><span id="line-2296"></span><span class="hs-comment">-- --------------</span><span>
</span><span id="line-2297"></span><span>
</span><span id="line-2298"></span><span class="annot"><span class="hs-comment">{-| View standard input as a @Stream (Of String) m r@. By contrast, 'stdoutLn' renders a @Stream (Of String) m r@ to standard output. The names
    follow @Pipes.Prelude@

&gt;&gt;&gt; stdoutLn stdinLn
hello&lt;Enter&gt;
hello
world&lt;Enter&gt;
world
^CInterrupted.


&gt;&gt;&gt; stdoutLn $ S.map reverse stdinLn
hello&lt;Enter&gt;
olleh
world&lt;Enter&gt;
dlrow
^CInterrupted.

-}</span></span><span>
</span><span id="line-2317"></span><span id="local-6989586621679079231"><span class="annot"><a href="Streaming.Prelude.html#stdinLn"><span class="hs-identifier hs-type">stdinLn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079231"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079231"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-2318"></span><span id="stdinLn"><span class="annot"><span class="annottext">stdinLn :: forall (m :: * -&gt; *). MonadIO m =&gt; Stream (Of String) m ()
</span><a href="Streaming.Prelude.html#stdinLn"><span class="hs-identifier hs-var hs-var">stdinLn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Stream (Of String) m ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
Handle -&gt; Stream (Of String) m ()
</span><a href="Streaming.Prelude.html#fromHandle"><span class="hs-identifier hs-var">fromHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.StdHandles.html#stdin"><span class="hs-identifier hs-var">IO.stdin</span></a></span><span>
</span><span id="line-2319"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#stdinLn"><span class="hs-pragma hs-type">stdinLn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2320"></span><span>
</span><span id="line-2321"></span><span class="annot"><span class="hs-comment">{-| Read values from 'IO.stdin', ignoring failed parses.

&gt;&gt;&gt; :set -XTypeApplications
&gt;&gt;&gt; S.sum $ S.take 2 (S.readLn @IO @Int)
10&lt;Enter&gt;
12&lt;Enter&gt;
22 :&gt; ()

&gt;&gt;&gt; S.toList $ S.take 2 (S.readLn @IO @Int)
10&lt;Enter&gt;
1@#$%^&amp;*\&lt;Enter&gt;
12&lt;Enter&gt;
[10,12] :&gt; ()

-}</span></span><span>
</span><span id="line-2336"></span><span>
</span><span id="line-2337"></span><span id="local-6989586621679079235"><span id="local-6989586621679079236"><span class="annot"><a href="Streaming.Prelude.html#readLn"><span class="hs-identifier hs-type">readLn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079235"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079235"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-2338"></span><span id="readLn"><span class="annot"><span class="annottext">readLn :: forall (m :: * -&gt; *) a. (MonadIO m, Read a) =&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#readLn"><span class="hs-identifier hs-var hs-var">readLn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
</span><a href="#local-6989586621679081008"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2339"></span><span>  </span><span id="local-6989586621679081008"><span class="annot"><span class="annottext">loop :: Stream (Of a) m ()
</span><a href="#local-6989586621679081008"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2340"></span><span>    </span><span id="local-6989586621679081027"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679081027"><span class="hs-identifier hs-var">eof</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Stream (Of a) m Bool
forall a. IO a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.html#isEOF"><span class="hs-identifier hs-var">IO.isEOF</span></a></span><span>
</span><span id="line-2341"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of a) m () -&gt; Stream (Of a) m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679081027"><span class="hs-identifier hs-var">eof</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m () -&gt; Stream (Of a) m ())
-&gt; Stream (Of a) m () -&gt; Stream (Of a) m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2342"></span><span>      </span><span id="local-6989586621679081030"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081030"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; Stream (Of a) m String
forall a. IO a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html#getLine"><span class="hs-identifier hs-var">getLine</span></a></span><span>
</span><span id="line-2343"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Read.html#readMaybe"><span class="hs-identifier hs-var">readMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081030"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2344"></span><span>        </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
forall (m :: * -&gt; *) a. (MonadIO m, Read a) =&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#readLn"><span class="hs-identifier hs-var">readLn</span></a></span><span>
</span><span id="line-2345"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679081032"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081032"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081032"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m () -&gt; Stream (Of a) m () -&gt; Stream (Of a) m ()
forall a b.
Stream (Of a) m a -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m ()
</span><a href="#local-6989586621679081008"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-2346"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#readLn"><span class="hs-pragma hs-type">readLn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2347"></span><span>
</span><span id="line-2348"></span><span>
</span><span id="line-2349"></span><span class="annot"><span class="hs-comment">{-| Read 'String's from a 'IO.Handle' using 'IO.hGetLine'

    Terminates on end of input

&gt;&gt;&gt; IO.withFile &quot;/usr/share/dict/words&quot; IO.ReadMode $ S.stdoutLn . S.take 3 . S.drop 50000 . S.fromHandle
deflagrator
deflate
deflation

-}</span></span><span>
</span><span id="line-2359"></span><span id="local-6989586621679079234"><span class="annot"><a href="Streaming.Prelude.html#fromHandle"><span class="hs-identifier hs-type">fromHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079234"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">IO.Handle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079234"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-2360"></span><span id="fromHandle"><span class="annot"><span class="annottext">fromHandle :: forall (m :: * -&gt; *).
MonadIO m =&gt;
Handle -&gt; Stream (Of String) m ()
</span><a href="Streaming.Prelude.html#fromHandle"><span class="hs-identifier hs-var hs-var">fromHandle</span></a></span></span><span> </span><span id="local-6989586621679081044"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679081044"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m ()
</span><a href="#local-6989586621679081045"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-2361"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2362"></span><span>    </span><span id="local-6989586621679081045"><span class="annot"><span class="annottext">go :: Stream (Of String) m ()
</span><a href="#local-6989586621679081045"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2363"></span><span>        </span><span id="local-6989586621679081046"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679081046"><span class="hs-identifier hs-var">eof</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Stream (Of String) m Bool
forall a. IO a -&gt; Stream (Of String) m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Stream (Of String) m Bool)
-&gt; IO Bool -&gt; Stream (Of String) m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.html#hIsEOF"><span class="hs-identifier hs-var">IO.hIsEOF</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679081044"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-2364"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Stream (Of String) m () -&gt; Stream (Of String) m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679081046"><span class="hs-identifier hs-var">eof</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of String) m () -&gt; Stream (Of String) m ())
-&gt; Stream (Of String) m () -&gt; Stream (Of String) m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2365"></span><span>            </span><span id="local-6989586621679081048"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081048"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; Stream (Of String) m String
forall a. IO a -&gt; Stream (Of String) m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO String -&gt; Stream (Of String) m String)
-&gt; IO String -&gt; Stream (Of String) m String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Text.html#hGetLine"><span class="hs-identifier hs-var">IO.hGetLine</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679081044"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-2366"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; Stream (Of String) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081048"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-2367"></span><span>            </span><span class="annot"><span class="annottext">Stream (Of String) m ()
</span><a href="#local-6989586621679081045"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-2368"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#fromHandle"><span class="hs-pragma hs-type">fromHandle</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2369"></span><span>
</span><span id="line-2370"></span><span class="annot"><span class="hs-comment">{-| Write a succession of strings to a handle as separate lines.

&gt;&gt;&gt; S.toHandle IO.stdout $ each (words &quot;one two three&quot;)
one
two
three
-}</span></span><span>
</span><span id="line-2377"></span><span id="local-6989586621679079240"><span id="local-6989586621679079241"><span class="annot"><a href="Streaming.Prelude.html#toHandle"><span class="hs-identifier hs-type">toHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079240"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">IO.Handle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079240"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079241"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079240"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079241"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-2378"></span><span id="toHandle"><span class="annot"><span class="annottext">toHandle :: forall (m :: * -&gt; *) r.
MonadIO m =&gt;
Handle -&gt; Stream (Of String) m r -&gt; m r
</span><a href="Streaming.Prelude.html#toHandle"><span class="hs-identifier hs-var hs-var">toHandle</span></a></span></span><span> </span><span id="local-6989586621679081055"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679081055"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r -&gt; m r
</span><a href="#local-6989586621679081056"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2379"></span><span>  </span><span id="local-6989586621679081056"><span class="annot"><span class="annottext">loop :: Stream (Of String) m r -&gt; m r
</span><a href="#local-6989586621679081056"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081057"><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679081057"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679081057"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2380"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081058"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081058"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; m r
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081058"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2381"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081059"><span class="annot"><span class="annottext">m (Stream (Of String) m r)
</span><a href="#local-6989586621679081059"><span class="hs-identifier hs-var">m</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of String) m r)
</span><a href="#local-6989586621679081059"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of String) m r)
-&gt; (Stream (Of String) m r -&gt; m r) -&gt; m r
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r -&gt; m r
</span><a href="#local-6989586621679081056"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-2382"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081060"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081060"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081061"><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679081061"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2383"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Text.html#hPutStrLn"><span class="hs-identifier hs-var">IO.hPutStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679081055"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081060"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2384"></span><span>      </span><span class="annot"><span class="annottext">Stream (Of String) m r -&gt; m r
</span><a href="#local-6989586621679081056"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679081061"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2385"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#toHandle"><span class="hs-pragma hs-type">toHandle</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2386"></span><span>
</span><span id="line-2387"></span><span class="annot"><span class="hs-comment">{-| Print the elements of a stream as they arise.

&gt;&gt;&gt; S.print $ S.take 2 S.stdinLn
hello&lt;Enter&gt;
&quot;hello&quot;
world&lt;Enter&gt;
&quot;world&quot;

-}</span></span><span>
</span><span id="line-2396"></span><span id="local-6989586621679079244"><span id="local-6989586621679079245"><span id="local-6989586621679079246"><span class="annot"><a href="Streaming.Prelude.html#print"><span class="hs-identifier hs-type">print</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079244"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079244"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079246"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079244"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079246"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-2397"></span><span id="print"><span class="annot"><span class="annottext">print :: forall (m :: * -&gt; *) a r.
(MonadIO m, Show a) =&gt;
Stream (Of a) m r -&gt; m r
</span><a href="Streaming.Prelude.html#print"><span class="hs-identifier hs-var hs-var">print</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m r
forall (m :: * -&gt; *) a r.
(MonadIO m, Show a) =&gt;
Stream (Of a) m r -&gt; m r
</span><a href="#local-6989586621679081067"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2398"></span><span>  </span><span id="local-6989586621679081067"><span class="annot"><span class="annottext">loop :: Stream (Of a) m a -&gt; m a
</span><a href="#local-6989586621679081067"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081083"><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679081083"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679081083"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2399"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081084"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081084"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081084"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2400"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081085"><span class="annot"><span class="annottext">m (Stream (Of a) m a)
</span><a href="#local-6989586621679081085"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m a)
</span><a href="#local-6989586621679081085"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m a) -&gt; (Stream (Of a) m a -&gt; m a) -&gt; m a
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a -&gt; m a
</span><a href="#local-6989586621679081067"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-2401"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081086"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081086"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081087"><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679081087"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2402"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html#print"><span class="hs-identifier hs-var">Prelude.print</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081086"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2403"></span><span>      </span><span class="annot"><span class="annottext">Stream (Of a) m a -&gt; m a
</span><a href="#local-6989586621679081067"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m a
</span><a href="#local-6989586621679081087"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2404"></span><span>
</span><span id="line-2405"></span><span>
</span><span id="line-2406"></span><span class="annot"><span class="hs-comment">{-| Write 'String's to 'IO.stdout' using 'putStrLn'; terminates on a broken output pipe
    (The name and implementation are modelled on the @Pipes.Prelude@ @stdoutLn@).

&gt;&gt;&gt; S.stdoutLn $ S.take 3 $ S.each $ words &quot;one two three four five&quot;
one
two
three
-}</span></span><span>
</span><span id="line-2414"></span><span id="local-6989586621679079254"><span class="annot"><a href="Streaming.Prelude.html#stdoutLn"><span class="hs-identifier hs-type">stdoutLn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079254"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079254"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079254"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-2415"></span><span id="stdoutLn"><span class="annot"><span class="annottext">stdoutLn :: forall (m :: * -&gt; *). MonadIO m =&gt; Stream (Of String) m () -&gt; m ()
</span><a href="Streaming.Prelude.html#stdoutLn"><span class="hs-identifier hs-var hs-var">stdoutLn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m () -&gt; m ()
forall {m :: * -&gt; *} {r}.
MonadIO m =&gt;
Stream (Of String) m r -&gt; m ()
</span><a href="#local-6989586621679081092"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-2416"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2417"></span><span>    </span><span id="local-6989586621679081092"><span class="annot"><span class="annottext">loop :: Stream (Of String) m r -&gt; m ()
</span><a href="#local-6989586621679081092"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081113"><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679081113"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679081113"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2418"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2419"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081114"><span class="annot"><span class="annottext">m (Stream (Of String) m r)
</span><a href="#local-6989586621679081114"><span class="hs-identifier hs-var">m</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of String) m r)
</span><a href="#local-6989586621679081114"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of String) m r)
-&gt; (Stream (Of String) m r -&gt; m ()) -&gt; m ()
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r -&gt; m ()
</span><a href="#local-6989586621679081092"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-2420"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081115"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081115"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081116"><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679081116"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2421"></span><span>        </span><span id="local-6989586621679081117"><span class="annot"><span class="annottext">Either IOException ()
</span><a href="#local-6989586621679081117"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either IOException ()) -&gt; m (Either IOException ())
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either IOException ()) -&gt; m (Either IOException ()))
-&gt; IO (Either IOException ()) -&gt; m (Either IOException ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Either IOException ())
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#try"><span class="hs-identifier hs-var">try</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081115"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2422"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOException ()
</span><a href="#local-6989586621679081117"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2423"></span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#IOError"><span class="hs-identifier hs-type">G.IOError</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ioe_type :: IOException -&gt; IOErrorType
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#ioe_type"><span class="hs-identifier hs-var">G.ioe_type</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#ResourceVanished"><span class="hs-identifier hs-var">G.ResourceVanished</span></a></span><span>
</span><span id="line-2424"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ioe_errno :: IOException -&gt; Maybe CInt
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#ioe_errno"><span class="hs-identifier hs-var">G.ioe_errno</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679081122"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679081122"><span class="hs-identifier hs-var">ioe</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2425"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; Errno
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#Errno"><span class="hs-identifier hs-var">Errno</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679081122"><span class="hs-identifier hs-var">ioe</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#ePIPE"><span class="hs-identifier hs-var">ePIPE</span></a></span><span>
</span><span id="line-2426"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2427"></span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679081123"><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679081123"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#throwIO"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679081123"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2428"></span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r -&gt; m ()
</span><a href="#local-6989586621679081092"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of String) m r
</span><a href="#local-6989586621679081116"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2429"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#stdoutLn"><span class="hs-pragma hs-type">stdoutLn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2430"></span><span>
</span><span id="line-2431"></span><span class="annot"><span class="hs-comment">{-| Read the lines of a file, using a function of the type: \'@'Stream' ('Of' 'String') 'IO' () -&gt; 'IO' a@\'
    to turn the stream into a value of type \''IO' a\'.

&gt;&gt;&gt; S.writeFile &quot;lines.txt&quot; $ S.take 2 S.stdinLn
hello&lt;Enter&gt;
world&lt;Enter&gt;
&gt;&gt;&gt; S.readFile &quot;lines.txt&quot; S.print
&quot;hello&quot;
&quot;world&quot;

-}</span></span><span>
</span><span id="line-2442"></span><span id="local-6989586621679079267"><span class="annot"><a href="Streaming.Prelude.html#readFile"><span class="hs-identifier hs-type">readFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079267"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079267"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2443"></span><span id="readFile"><span class="annot"><span class="annottext">readFile :: forall a. String -&gt; (Stream (Of String) IO () -&gt; IO a) -&gt; IO a
</span><a href="Streaming.Prelude.html#readFile"><span class="hs-identifier hs-var hs-var">readFile</span></a></span></span><span> </span><span id="local-6989586621679081127"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081127"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679081128"><span class="annot"><span class="annottext">Stream (Of String) IO () -&gt; IO a
</span><a href="#local-6989586621679081128"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; (Handle -&gt; IO a) -&gt; IO a
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.StdHandles.html#withFile"><span class="hs-identifier hs-var">IO.withFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081127"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.IOMode.html#ReadMode"><span class="hs-identifier hs-var">IO.ReadMode</span></a></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO a) -&gt; IO a) -&gt; (Handle -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679081131"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679081131"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of String) IO () -&gt; IO a
</span><a href="#local-6989586621679081128"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Stream (Of String) IO ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
Handle -&gt; Stream (Of String) m ()
</span><a href="Streaming.Prelude.html#fromHandle"><span class="hs-identifier hs-var">fromHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679081131"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2444"></span><span>
</span><span id="line-2445"></span><span class="annot"><span class="hs-comment">{-| Write a series of 'String's as lines to a file.

&gt;&gt;&gt; S.writeFile &quot;lines.txt&quot; $ S.take 2 S.stdinLn
hello&lt;Enter&gt;
world&lt;Enter&gt;

&gt;&gt;&gt; S.readFile &quot;lines.txt&quot; S.stdoutLn
hello
world

-}</span></span><span>
</span><span id="line-2456"></span><span id="local-6989586621679079271"><span class="annot"><a href="Streaming.Prelude.html#writeFile"><span class="hs-identifier hs-type">writeFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079271"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079271"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-2457"></span><span id="writeFile"><span class="annot"><span class="annottext">writeFile :: forall r. String -&gt; Stream (Of String) IO r -&gt; IO r
</span><a href="Streaming.Prelude.html#writeFile"><span class="hs-identifier hs-var hs-var">writeFile</span></a></span></span><span> </span><span id="local-6989586621679081133"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081133"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.StdHandles.html#withFile"><span class="hs-identifier hs-var">IO.withFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679081133"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.IOMode.html#WriteMode"><span class="hs-identifier hs-var">IO.WriteMode</span></a></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO r) -&gt; IO r)
-&gt; (Stream (Of String) IO r -&gt; Handle -&gt; IO r)
-&gt; Stream (Of String) IO r
-&gt; IO r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Handle -&gt; Stream (Of String) IO r -&gt; IO r)
-&gt; Stream (Of String) IO r -&gt; Handle -&gt; IO r
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Stream (Of String) IO r -&gt; IO r
forall (m :: * -&gt; *) r.
MonadIO m =&gt;
Handle -&gt; Stream (Of String) m r -&gt; m r
</span><a href="Streaming.Prelude.html#toHandle"><span class="hs-identifier hs-var">toHandle</span></a></span><span>
</span><span id="line-2458"></span><span>
</span><span id="line-2459"></span><span class="annot"><span class="hs-comment">{-| Write 'String's to 'IO.stdout' using 'putStrLn'

    Unlike @stdoutLn@, @stdoutLn'@ does not handle a broken output pipe. Thus it can have a polymorphic return
    value, rather than @()@, and this kind of \&quot;connect and resume\&quot; is possible:

&gt;&gt;&gt; rest &lt;- S.stdoutLn' $ S.show $ S.splitAt 3 (each [1..5])
1
2
3
&gt;&gt;&gt; S.toList rest
[4,5] :&gt; ()

-}</span></span><span>
</span><span id="line-2472"></span><span>
</span><span id="line-2473"></span><span id="local-6989586621679079276"><span id="local-6989586621679079277"><span class="annot"><a href="Streaming.Prelude.html#stdoutLn%27"><span class="hs-identifier hs-type">stdoutLn'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079276"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079276"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079277"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079276"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079277"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-2474"></span><span id="stdoutLn%27"><span class="annot"><span class="annottext">stdoutLn' :: forall (m :: * -&gt; *) r. MonadIO m =&gt; Stream (Of String) m r -&gt; m r
</span><a href="Streaming.Prelude.html#stdoutLn%27"><span class="hs-identifier hs-var hs-var">stdoutLn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Stream (Of String) m r -&gt; m r
forall (m :: * -&gt; *) r.
MonadIO m =&gt;
Handle -&gt; Stream (Of String) m r -&gt; m r
</span><a href="Streaming.Prelude.html#toHandle"><span class="hs-identifier hs-var">toHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.StdHandles.html#stdout"><span class="hs-identifier hs-var">IO.stdout</span></a></span><span>
</span><span id="line-2475"></span><span>
</span><span id="line-2476"></span><span id="local-6989586621679079280"><span id="local-6989586621679079281"><span class="annot"><a href="Streaming.Prelude.html#distinguish"><span class="hs-identifier hs-type">distinguish</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079280"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079280"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079281"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079280"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079280"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079281"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-2477"></span><span id="distinguish"><span class="annot"><span class="annottext">distinguish :: forall a r. (a -&gt; Bool) -&gt; Of a r -&gt; Sum (Of a) (Of a) r
</span><a href="Streaming.Prelude.html#distinguish"><span class="hs-identifier hs-var hs-var">distinguish</span></a></span></span><span> </span><span id="local-6989586621679081138"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679081138"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081139"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081139"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081140"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081140"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679081138"><span class="hs-identifier hs-var">predicate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081139"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Of a r -&gt; Sum (Of a) (Of a) r
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k). g a -&gt; Sum f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InR"><span class="hs-identifier hs-var">InR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081139"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r -&gt; Of a r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081140"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Of a r -&gt; Sum (Of a) (Of a) r
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k). f a -&gt; Sum f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InL"><span class="hs-identifier hs-var">InL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081139"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r -&gt; Of a r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081140"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2478"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#distinguish"><span class="hs-pragma hs-type">distinguish</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2479"></span><span>
</span><span id="line-2480"></span><span id="local-6989586621679079289"><span id="local-6989586621679079290"><span id="local-6989586621679079291"><span class="annot"><a href="Streaming.Prelude.html#sumToEither"><span class="hs-identifier hs-type">sumToEither</span></a></span><span> </span><span class="hs-glyph">::</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079289"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079290"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079291"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079289"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079290"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079291"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-2481"></span><span id="sumToEither"><span class="annot"><span class="annottext">sumToEither :: forall a b r. Sum (Of a) (Of b) r -&gt; Of (Either a b) r
</span><a href="Streaming.Prelude.html#sumToEither"><span class="hs-identifier hs-var hs-var">sumToEither</span></a></span></span><span> </span><span id="local-6989586621679081143"><span class="annot"><span class="annottext">Sum (Of a) (Of b) r
</span><a href="#local-6989586621679081143"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Sum (Of a) (Of b) r
</span><a href="#local-6989586621679081143"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2482"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InL"><span class="hs-identifier hs-type">InL</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081144"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081144"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081145"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081145"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081144"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; r -&gt; Of (Either a b) r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081145"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2483"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InR"><span class="hs-identifier hs-type">InR</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081146"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081146"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081147"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081147"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081146"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; r -&gt; Of (Either a b) r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081147"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2484"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sumToEither"><span class="hs-pragma hs-type">sumToEither</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2485"></span><span>
</span><span id="line-2486"></span><span id="local-6989586621679079295"><span id="local-6989586621679079296"><span id="local-6989586621679079297"><span class="annot"><a href="Streaming.Prelude.html#eitherToSum"><span class="hs-identifier hs-type">eitherToSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079295"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079296"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079297"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079295"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079296"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079297"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-2487"></span><span id="eitherToSum"><span class="annot"><span class="annottext">eitherToSum :: forall a b r. Of (Either a b) r -&gt; Sum (Of a) (Of b) r
</span><a href="Streaming.Prelude.html#eitherToSum"><span class="hs-identifier hs-var hs-var">eitherToSum</span></a></span></span><span> </span><span id="local-6989586621679081148"><span class="annot"><span class="annottext">Of (Either a b) r
</span><a href="#local-6989586621679081148"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Of (Either a b) r
</span><a href="#local-6989586621679081148"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2488"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679081149"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081149"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081150"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081150"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a r -&gt; Sum (Of a) (Of b) r
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k). f a -&gt; Sum f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InL"><span class="hs-identifier hs-var">InL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081149"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r -&gt; Of a r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081150"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2489"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679081151"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081151"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081152"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081152"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of b r -&gt; Sum (Of a) (Of b) r
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k). g a -&gt; Sum f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InR"><span class="hs-identifier hs-var">InR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081151"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; r -&gt; Of b r
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081152"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2490"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#eitherToSum"><span class="hs-pragma hs-type">eitherToSum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2491"></span><span>
</span><span id="line-2492"></span><span id="local-6989586621679079301"><span id="local-6989586621679079302"><span class="annot"><a href="Streaming.Prelude.html#composeToSum"><span class="hs-identifier hs-type">composeToSum</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Compose.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079301"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079302"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079301"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079301"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079302"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-2493"></span><span id="composeToSum"><span class="annot"><span class="annottext">composeToSum :: forall (f :: * -&gt; *) r. Compose (Of Bool) f r -&gt; Sum f f r
</span><a href="Streaming.Prelude.html#composeToSum"><span class="hs-identifier hs-var hs-var">composeToSum</span></a></span></span><span> </span><span id="local-6989586621679081153"><span class="annot"><span class="annottext">Compose (Of Bool) f r
</span><a href="#local-6989586621679081153"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Compose (Of Bool) f r
</span><a href="#local-6989586621679081153"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2494"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Compose.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081155"><span class="annot"><span class="annottext">f r
</span><a href="#local-6989586621679081155"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f r -&gt; Sum f f r
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k). g a -&gt; Sum f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InR"><span class="hs-identifier hs-var">InR</span></a></span><span> </span><span class="annot"><span class="annottext">f r
</span><a href="#local-6989586621679081155"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-2495"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Compose.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081156"><span class="annot"><span class="annottext">f r
</span><a href="#local-6989586621679081156"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f r -&gt; Sum f f r
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k). f a -&gt; Sum f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InL"><span class="hs-identifier hs-var">InL</span></a></span><span> </span><span class="annot"><span class="annottext">f r
</span><a href="#local-6989586621679081156"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-2496"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#composeToSum"><span class="hs-pragma hs-type">composeToSum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2497"></span><span>
</span><span id="line-2498"></span><span id="local-6989586621679079306"><span id="local-6989586621679079307"><span class="annot"><a href="Streaming.Prelude.html#sumToCompose"><span class="hs-identifier hs-type">sumToCompose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079306"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079306"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079307"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Compose.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079306"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079307"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-2499"></span><span id="sumToCompose"><span class="annot"><span class="annottext">sumToCompose :: forall (f :: * -&gt; *) r. Sum f f r -&gt; Compose (Of Bool) f r
</span><a href="Streaming.Prelude.html#sumToCompose"><span class="hs-identifier hs-var hs-var">sumToCompose</span></a></span></span><span> </span><span id="local-6989586621679081157"><span class="annot"><span class="annottext">Sum f f r
</span><a href="#local-6989586621679081157"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Sum f f r
</span><a href="#local-6989586621679081157"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2500"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InR"><span class="hs-identifier hs-type">InR</span></a></span><span> </span><span id="local-6989586621679081158"><span class="annot"><span class="annottext">f r
</span><a href="#local-6989586621679081158"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of Bool (f r) -&gt; Compose (Of Bool) f r
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Compose.html#Compose"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f r -&gt; Of Bool (f r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f r
</span><a href="#local-6989586621679081158"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2501"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Sum.html#InL"><span class="hs-identifier hs-type">InL</span></a></span><span> </span><span id="local-6989586621679081159"><span class="annot"><span class="annottext">f r
</span><a href="#local-6989586621679081159"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of Bool (f r) -&gt; Compose (Of Bool) f r
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Compose.html#Compose"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f r -&gt; Of Bool (f r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f r
</span><a href="#local-6989586621679081159"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2502"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#sumToCompose"><span class="hs-pragma hs-type">sumToCompose</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2503"></span><span>
</span><span id="line-2504"></span><span class="annot"><span class="hs-comment">{-| Store the result of any suitable fold over a stream, keeping the stream for
    further manipulation. @store f = f . copy@ :

&gt;&gt;&gt; S.print $ S.store S.product $ each [1..4]
1
2
3
4
24 :&gt; ()

&gt;&gt;&gt; S.print $ S.store S.sum $ S.store S.product $ each [1..4]
1
2
3
4
10 :&gt; (24 :&gt; ())

   Here the sum (10) and the product (24) have been \'stored\' for use when
   finally we have traversed the stream with 'print' . Needless to say,
   a second 'pass' is excluded conceptually, so the
   folds that you apply successively with @store@ are performed
   simultaneously, and in constant memory -- as they would be if,
   say, you linked them together with @Control.Fold@:

&gt;&gt;&gt; L.impurely S.foldM (liftA3 (\a b c -&gt; (b, c)) (L.sink Prelude.print) (L.generalize L.sum) (L.generalize L.product)) $ each [1..4]
1
2
3
4
(10,24) :&gt; ()

   Fusing folds after the fashion of @Control.Foldl@ will generally be a bit faster
   than the corresponding succession of uses of 'store', but by
   constant factor that will be completely dwarfed when any IO is at issue.

   But 'store' \/ 'copy' is /much/ more powerful, as you can see by reflecting on
   uses like this:

&gt;&gt;&gt; S.sum $ S.store (S.sum . mapped S.product . chunksOf 2) $ S.store (S.product . mapped S.sum . chunksOf 2) $ each [1..6]
21 :&gt; (44 :&gt; (231 :&gt; ()))

   It will be clear that this cannot be reproduced with any combination of lenses,
   @Control.Fold@ folds, or the like.  (See also the discussion of 'copy'.)

   It would conceivably be clearer to import a series of specializations of 'store'.
   It is intended to be used at types like these:

&gt; storeM ::  (forall s m . Monad m =&gt; Stream (Of a) m s -&gt; m (Of b s))
&gt;         -&gt; (Monad n =&gt; Stream (Of a) n r -&gt; Stream (Of a) n (Of b r))
&gt; storeM = store
&gt;
&gt; storeMIO :: (forall s m . MonadIO m =&gt; Stream (Of a) m s -&gt; m (Of b s))
&gt;          -&gt; (MonadIO n =&gt; Stream (Of a) n r -&gt; Stream (Of a) n (Of b r)
&gt; storeMIO = store

    It is clear from these types that we are just using the general instances:

&gt; instance (Functor f, Monad m)   =&gt; Monad (Stream f m)
&gt; instance (Functor f, MonadIO m) =&gt; MonadIO (Stream f m)

    We thus can't be touching the elements of the stream, or the final return value.
    It is the same with other constraints that @Stream (Of a)@ inherits from the underlying monad,
    like 'MonadResource'.  Thus I can independently filter and write to one file, but
    nub and write to another, or interact with a database and a logfile and the like:

&gt;&gt;&gt; (S.writeFile &quot;hello2.txt&quot; . S.nubOrd) $ store (S.writeFile &quot;hello.txt&quot; . S.filter (/= &quot;world&quot;)) $ each [&quot;hello&quot;, &quot;world&quot;, &quot;goodbye&quot;, &quot;world&quot;]
&gt;&gt;&gt; :! cat hello.txt
hello
goodbye
&gt;&gt;&gt; :! cat hello2.txt
hello
world
goodbye


-}</span></span><span>
</span><span id="line-2580"></span><span id="local-6989586621679079315"><span id="local-6989586621679079316"><span id="local-6989586621679079317"><span id="local-6989586621679079318"><span class="annot"><a href="Streaming.Prelude.html#store"><span class="hs-identifier hs-type">store</span></a></span><span>
</span><span id="line-2581"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079315"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2582"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079316"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079316"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079315"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079317"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079318"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079316"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079315"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079317"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079318"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-2583"></span><span id="store"><span class="annot"><span class="annottext">store :: forall (m :: * -&gt; *) a r t.
Monad m =&gt;
(Stream (Of a) (Stream (Of a) m) r -&gt; t) -&gt; Stream (Of a) m r -&gt; t
</span><a href="Streaming.Prelude.html#store"><span class="hs-identifier hs-var hs-var">store</span></a></span></span><span> </span><span id="local-6989586621679081162"><span class="annot"><span class="annottext">Stream (Of a) (Stream (Of a) m) r -&gt; t
</span><a href="#local-6989586621679081162"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679081163"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081163"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) (Stream (Of a) m) r -&gt; t
</span><a href="#local-6989586621679081162"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="Streaming.Prelude.html#copy"><span class="hs-identifier hs-var">copy</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081163"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2584"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#store"><span class="hs-pragma hs-type">store</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2585"></span><span>
</span><span id="line-2586"></span><span class="annot"><span class="hs-comment">{-| Duplicate the content of stream, so that it can be acted on twice in different ways,
    but without breaking streaming. Thus, with @each [1,2]@ I might do:

&gt;&gt;&gt; S.print $ each [&quot;one&quot;,&quot;two&quot;]
&quot;one&quot;
&quot;two&quot;
&gt;&gt;&gt; S.stdoutLn $ each [&quot;one&quot;,&quot;two&quot;]
one
two

    With copy, I can do these simultaneously:

&gt;&gt;&gt; S.print $ S.stdoutLn $ S.copy $ each [&quot;one&quot;,&quot;two&quot;]
&quot;one&quot;
one
&quot;two&quot;
two

    'copy' should be understood together with 'effects' and is subject to the rules

&gt; S.effects . S.copy       = id
&gt; hoist S.effects . S.copy = id

    The similar operations in 'Data.ByteString.Streaming' obey the same rules.

    Where the actions you are contemplating are each simple folds over
    the elements, or a selection of elements, then the coupling of the
    folds is often more straightforwardly effected with `Control.Foldl`,
    e.g.

&gt;&gt;&gt; L.purely S.fold (liftA2 (,) L.sum L.product) $ each [1..10]
(55,3628800) :&gt; ()

    rather than

&gt;&gt;&gt; S.sum $ S.product . S.copy $ each [1..10]
55 :&gt; (3628800 :&gt; ())

    A @Control.Foldl@ fold can be altered to act on a selection of elements by
    using 'Control.Foldl.handles' on an appropriate lens. Some such
    manipulations are simpler and more 'Data.List'-like, using 'copy':

&gt;&gt;&gt; L.purely S.fold (liftA2 (,) (L.handles (L.filtered odd) L.sum) (L.handles (L.filtered even) L.product)) $ each [1..10]
(25,3840) :&gt; ()

     becomes

&gt;&gt;&gt; S.sum $ S.filter odd $ S.product $ S.filter even $ S.copy $ each [1..10]
25 :&gt; (3840 :&gt; ())

    or using 'store'

&gt;&gt;&gt; S.sum $ S.filter odd $ S.store (S.product . S.filter even) $ each [1..10]
25 :&gt; (3840 :&gt; ())

    But anything that fold of a @Stream (Of a) m r@ into e.g. an @m (Of b r)@
    that has a constraint on @m@ that is carried over into @Stream f m@ -
    e.g. @Monad@, @MonadIO@, @MonadResource@, etc. can be used on the stream.
    Thus, I can fold over different groupings of the original stream:

&gt;&gt;&gt;  (S.toList . mapped S.toList . chunksOf 5) $  (S.toList . mapped S.toList . chunksOf 3) $ S.copy $ each [1..10]
[[1,2,3,4,5],[6,7,8,9,10]] :&gt; ([[1,2,3],[4,5,6],[7,8,9],[10]] :&gt; ())

    The procedure can be iterated as one pleases, as one can see from this (otherwise unadvisable!) example:

&gt;&gt;&gt;  (S.toList . mapped S.toList . chunksOf 4) $ (S.toList . mapped S.toList . chunksOf 3) $ S.copy $ (S.toList . mapped S.toList . chunksOf 2) $ S.copy $ each [1..12]
[[1,2,3,4],[5,6,7,8],[9,10,11,12]] :&gt; ([[1,2,3],[4,5,6],[7,8,9],[10,11,12]] :&gt; ([[1,2],[3,4],[5,6],[7,8],[9,10],[11,12]] :&gt; ()))


@copy@ can be considered a special case of 'expand':

@
  copy = 'expand' $ \\p (a :&gt; as) -&gt; a :&gt; p (a :&gt; as)
@

If 'Of' were an instance of 'Control.Comonad.Comonad', then one could write

@
  copy = 'expand' extend
@
-}</span></span><span>
</span><span id="line-2667"></span><span id="local-6989586621679079323"><span id="local-6989586621679079324"><span id="local-6989586621679079325"><span class="annot"><a href="Streaming.Prelude.html#copy"><span class="hs-identifier hs-type">copy</span></a></span><span>
</span><span id="line-2668"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079323"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2669"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079323"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079325"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079323"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079325"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-2670"></span><span id="copy"><span class="annot"><span class="annottext">copy :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="Streaming.Prelude.html#copy"><span class="hs-identifier hs-var hs-var">copy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
 -&gt; Stream (Of a) (Stream (Of a) m) r)
-&gt; (Stream (Of a) m r
    -&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r))
-&gt; Stream (Of a) m r
-&gt; Stream (Of a) (Stream (Of a) m) r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) (Stream (Of a) m) r
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) (Stream (Of a) m) r
 -&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r))
-&gt; (Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) m r
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679081169"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2671"></span><span>  </span><span id="local-6989586621679081169"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679081169"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081180"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081180"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081180"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2672"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081181"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081181"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081181"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2673"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081182"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679081182"><span class="hs-identifier hs-var">m</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) m (Stream (Of a) m r)
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall a b. (a -&gt; b) -&gt; Stream (Of a) m a -&gt; Stream (Of a) m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679081169"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m (Stream (Of a) m r)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of a) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679081182"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2674"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081183"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081183"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081184"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081184"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r))
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081183"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Of a (Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r))
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) (Stream (Of a) m) r
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081183"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Stream (Of a) (Stream (Of a) m) r
-&gt; Of a (Stream (Of a) (Stream (Of a) m) r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679081169"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081184"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2675"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#copy"><span class="hs-pragma hs-type">copy</span></a></span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2676"></span><span>
</span><span id="line-2677"></span><span class="annot"><span class="hs-comment">{-| An alias for @copy@.
-}</span></span><span>
</span><span id="line-2679"></span><span id="local-6989586621679081185"><span id="local-6989586621679081186"><span id="local-6989586621679081187"><span class="annot"><a href="Streaming.Prelude.html#duplicate"><span class="hs-identifier hs-type">duplicate</span></a></span><span>
</span><span id="line-2680"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081185"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2681"></span><span>     </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081186"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081185"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081187"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081186"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081186"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081185"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081187"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-2682"></span><span id="duplicate"><span class="annot"><span class="annottext">duplicate :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="Streaming.Prelude.html#duplicate"><span class="hs-identifier hs-var hs-var">duplicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="Streaming.Prelude.html#copy"><span class="hs-identifier hs-var">copy</span></a></span><span>
</span><span id="line-2683"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#duplicate"><span class="hs-pragma hs-type">duplicate</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2684"></span><span>
</span><span id="line-2685"></span><span class="annot"><span class="hs-comment">{-| The type

&gt; Data.List.unzip     :: [(a,b)] -&gt; ([a],[b])

   might lead us to expect

&gt; Streaming.unzip :: Stream (Of (a,b)) m r -&gt; Stream (Of a) m (Stream (Of b) m r)

   which would not stream, since it would have to accumulate the second stream (of @b@s).
   Of course, @Data.List@ 'Data.List.unzip' doesn't stream either.

   This @unzip@ does
   stream, though of course you can spoil this by using e.g. 'toList':

&gt;&gt;&gt; let xs = Prelude.map (\x -&gt; (x, Prelude.show x)) [1..5 :: Int]

&gt;&gt;&gt; S.toList $ S.toList $ S.unzip (S.each xs)
[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;] :&gt; ([1,2,3,4,5] :&gt; ())

&gt;&gt;&gt; Prelude.unzip xs
([1,2,3,4,5],[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;])

    Note the difference of order in the results. It may be of some use to think why.
    The first application of 'toList' was applied to a stream of integers:

&gt;&gt;&gt; :t S.unzip $ S.each xs
S.unzip $ S.each xs :: Monad m =&gt; Stream (Of Int) (Stream (Of String) m) ()

    Like any fold, 'toList' takes no notice of the monad of effects.

&gt; toList :: Monad m =&gt; Stream (Of a) m r -&gt; m (Of [a] r)

    In the case at hand (since I am in @ghci@) @m = Stream (Of String) IO@.
    So when I apply 'toList', I exhaust that stream of integers, folding
    it into a list:

&gt;&gt;&gt; :t S.toList $ S.unzip $ S.each xs
S.toList $ S.unzip $ S.each xs
  :: Monad m =&gt; Stream (Of String) m (Of [Int] ())

    When I apply 'toList' to /this/, I reduce everything to an ordinary action in @IO@,
    and return a list of strings:

&gt;&gt;&gt; S.toList $ S.toList $ S.unzip (S.each xs)
[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;] :&gt; ([1,2,3,4,5] :&gt; ())

'unzip' can be considered a special case of either 'unzips' or 'expand':

@
  unzip = 'unzips' . 'maps' (\\((a,b) :&gt; x) -&gt; Compose (a :&gt; b :&gt; x))
  unzip = 'expand' $ \\p ((a,b) :&gt; abs) -&gt; b :&gt; p (a :&gt; abs)
@
-}</span></span><span>
</span><span id="line-2738"></span><span id="local-6989586621679079335"><span id="local-6989586621679079336"><span id="local-6989586621679079337"><span id="local-6989586621679079338"><span class="annot"><a href="Streaming.Prelude.html#unzip"><span class="hs-identifier hs-type">unzip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079335"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079336"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679079337"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079335"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079338"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079336"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079337"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079335"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079338"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-2739"></span><span id="unzip"><span class="annot"><span class="annottext">unzip :: forall (m :: * -&gt; *) a b r.
Monad m =&gt;
Stream (Of (a, b)) m r -&gt; Stream (Of a) (Stream (Of b) m) r
</span><a href="Streaming.Prelude.html#unzip"><span class="hs-identifier hs-var hs-var">unzip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of (a, b)) m r -&gt; Stream (Of a) (Stream (Of b) m) r
forall (m :: * -&gt; *) a b r.
Monad m =&gt;
Stream (Of (a, b)) m r -&gt; Stream (Of a) (Stream (Of b) m) r
</span><a href="#local-6989586621679081193"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2740"></span><span> </span><span id="local-6989586621679081193"><span class="annot"><span class="annottext">loop :: Stream (Of (a, a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679081193"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081204"><span class="annot"><span class="annottext">Stream (Of (a, a)) m r
</span><a href="#local-6989586621679081204"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of (a, a)) m r
</span><a href="#local-6989586621679081204"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2741"></span><span>   </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081205"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081205"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081205"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2742"></span><span>   </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081206"><span class="annot"><span class="annottext">m (Stream (Of (a, a)) m r)
</span><a href="#local-6989586621679081206"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of (a, a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) m (Stream (Of (a, a)) m r)
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall a b. (a -&gt; b) -&gt; Stream (Of a) m a -&gt; Stream (Of a) m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (a, a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679081193"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (Stream (Of (a, a)) m r)
-&gt; Stream (Of a) m (Stream (Of (a, a)) m r)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of a) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of (a, a)) m r)
</span><a href="#local-6989586621679081206"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2743"></span><span>   </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679081207"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081207"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081208"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081208"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081209"><span class="annot"><span class="annottext">Stream (Of (a, a)) m r
</span><a href="#local-6989586621679081209"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081207"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Stream (Of a) (Stream (Of a) m) r
-&gt; Of a (Stream (Of a) (Stream (Of a) m) r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Stream (Of a) (Stream (Of a) m) r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of a (Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r))
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081208"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
-&gt; Of a (Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r))
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) (Stream (Of a) m) r
-&gt; Stream (Of a) m (Stream (Of a) (Stream (Of a) m) r)
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of (a, a)) m r -&gt; Stream (Of a) (Stream (Of a) m) r
</span><a href="#local-6989586621679081193"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (a, a)) m r
</span><a href="#local-6989586621679081209"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2744"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#unzip"><span class="hs-pragma hs-type">unzip</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2745"></span><span>
</span><span id="line-2746"></span><span>
</span><span id="line-2747"></span><span>
</span><span id="line-2748"></span><span class="annot"><span class="hs-comment">{- $merging
   These functions combine two sorted streams of orderable elements
   into one sorted stream. The elements of the merged stream are
   guaranteed to be in a sorted order if the two input streams are
   also sorted.

   The merge operation is /left-biased/: when merging two elements
   that compare as equal, the left element is chosen first.
-}</span></span><span>
</span><span id="line-2757"></span><span>
</span><span id="line-2758"></span><span class="annot"><span class="hs-comment">{- | Merge two streams of elements ordered with their 'Ord' instance.

   The return values of both streams are returned.

&gt;&gt;&gt; S.print $ merge (each [1,3,5]) (each [2,4])
1
2
3
4
5
((), ())

-}</span></span><span>
</span><span id="line-2771"></span><span id="local-6989586621679079347"><span id="local-6989586621679079348"><span id="local-6989586621679079349"><span id="local-6989586621679079350"><span class="annot"><a href="Streaming.Prelude.html#merge"><span class="hs-identifier hs-type">merge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079347"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079348"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2772"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079348"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079347"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079349"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2773"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079348"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079347"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079350"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-2774"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079348"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079347"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079349"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679079350"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-2775"></span><span id="merge"><span class="annot"><span class="annottext">merge :: forall (m :: * -&gt; *) a r s.
(Monad m, Ord a) =&gt;
Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="Streaming.Prelude.html#merge"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
forall (m :: * -&gt; *) a r s.
Monad m =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="Streaming.Prelude.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span>
</span><span id="line-2776"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#merge"><span class="hs-pragma hs-type">merge</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2777"></span><span>
</span><span id="line-2778"></span><span class="annot"><span class="hs-comment">{- | Merge two streams, ordering them by applying the given function to
   each element before comparing.

   The return values of both streams are returned.
-}</span></span><span>
</span><span id="line-2783"></span><span id="local-6989586621679079359"><span id="local-6989586621679079360"><span id="local-6989586621679079361"><span id="local-6989586621679079362"><span id="local-6989586621679079363"><span class="annot"><a href="Streaming.Prelude.html#mergeOn"><span class="hs-identifier hs-type">mergeOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079359"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079360"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2784"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079361"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079360"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2785"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079361"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079359"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079362"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2786"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079361"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079359"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079363"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-2787"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079361"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079359"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079362"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679079363"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-2788"></span><span id="mergeOn"><span class="annot"><span class="annottext">mergeOn :: forall (m :: * -&gt; *) b a r s.
(Monad m, Ord b) =&gt;
(a -&gt; b)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="Streaming.Prelude.html#mergeOn"><span class="hs-identifier hs-var hs-var">mergeOn</span></a></span></span><span> </span><span id="local-6989586621679081219"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679081219"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
forall (m :: * -&gt; *) a r s.
Monad m =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="Streaming.Prelude.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; a -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Ord.html#comparing"><span class="hs-identifier hs-var">comparing</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679081219"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2789"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mergeOn"><span class="hs-pragma hs-type">mergeOn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2790"></span><span>
</span><span id="line-2791"></span><span class="annot"><span class="hs-comment">{- | Merge two streams, ordering the elements using the given comparison function.

   The return values of both streams are returned.
-}</span></span><span>
</span><span id="line-2795"></span><span id="local-6989586621679079355"><span id="local-6989586621679079356"><span id="local-6989586621679079357"><span id="local-6989586621679079358"><span class="annot"><a href="Streaming.Prelude.html#mergeBy"><span class="hs-identifier hs-type">mergeBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079355"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-2796"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079356"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079356"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2797"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079356"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079357"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2798"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079356"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079358"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-2799"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079356"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079357"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679079358"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-2800"></span><span id="mergeBy"><span class="annot"><span class="annottext">mergeBy :: forall (m :: * -&gt; *) a r s.
Monad m =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="Streaming.Prelude.html#mergeBy"><span class="hs-identifier hs-var hs-var">mergeBy</span></a></span></span><span> </span><span id="local-6989586621679081228"><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
</span><a href="#local-6989586621679081228"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-2801"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2802"></span><span>    </span><span id="local-6989586621679081229"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081230"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081230"><span class="hs-identifier hs-var">str0</span></a></span></span><span> </span><span id="local-6989586621679081231"><span class="annot"><span class="annottext">Stream (Of a) m s
</span><a href="#local-6989586621679081231"><span class="hs-identifier hs-var">str1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081230"><span class="hs-identifier hs-var">str0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2803"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081232"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081232"><span class="hs-identifier hs-var">r0</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679081233"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679081233"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081232"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679081233"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(s -&gt; (r, s)) -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m s
</span><a href="#local-6989586621679081231"><span class="hs-identifier hs-var">str1</span></a></span><span>
</span><span id="line-2804"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081235"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679081235"><span class="hs-identifier hs-var">m</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s))
-&gt; m (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of a) m (r, s))
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of a) m (r, s))
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679081236"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081236"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081236"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m s
</span><a href="#local-6989586621679081231"><span class="hs-identifier hs-var">str1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679081235"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-2805"></span><span>      </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081237"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081237"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081238"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081238"><span class="hs-identifier hs-var">rest0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m s
</span><a href="#local-6989586621679081231"><span class="hs-identifier hs-var">str1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2806"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081239"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679081239"><span class="hs-identifier hs-var">r1</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679081240"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081240"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081240"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679081239"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(r -&gt; (r, s)) -&gt; Stream (Of a) m r -&gt; Stream (Of a) m (r, s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081230"><span class="hs-identifier hs-var">str0</span></a></span><span>
</span><span id="line-2807"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081241"><span class="annot"><span class="annottext">m (Stream (Of a) m s)
</span><a href="#local-6989586621679081241"><span class="hs-identifier hs-var">m</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s))
-&gt; m (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m s -&gt; Stream (Of a) m (r, s))
-&gt; m (Stream (Of a) m s) -&gt; m (Stream (Of a) m (r, s))
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081230"><span class="hs-identifier hs-var">str0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m s)
</span><a href="#local-6989586621679081241"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-2808"></span><span>        </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081242"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081242"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081243"><span class="annot"><span class="annottext">Stream (Of a) m s
</span><a href="#local-6989586621679081243"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
</span><a href="#local-6989586621679081228"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081237"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081242"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2809"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081237"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m (r, s) -&gt; Of a (Stream (Of a) m (r, s))
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081238"><span class="hs-identifier hs-var">rest0</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m s
</span><a href="#local-6989586621679081231"><span class="hs-identifier hs-var">str1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2810"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081237"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m (r, s) -&gt; Of a (Stream (Of a) m (r, s))
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081238"><span class="hs-identifier hs-var">rest0</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m s
</span><a href="#local-6989586621679081231"><span class="hs-identifier hs-var">str1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- left-biased</span><span>
</span><span id="line-2811"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m (r, s)) -&gt; Stream (Of a) m (r, s)
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081242"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m (r, s) -&gt; Of a (Stream (Of a) m (r, s))
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s)
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081230"><span class="hs-identifier hs-var">str0</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m s
</span><a href="#local-6989586621679081243"><span class="hs-identifier hs-var">rest1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2812"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mergeBy"><span class="hs-pragma hs-type">mergeBy</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2813"></span><span>
</span><span id="line-2814"></span><span class="annot"><span class="hs-comment">{- $maybes
    These functions discard the 'Nothing's that they encounter. They are analogous
    to the functions from @Data.Maybe@ that share their names.
-}</span></span><span>
</span><span id="line-2818"></span><span>
</span><span id="line-2819"></span><span class="annot"><span class="hs-comment">{-| The 'catMaybes' function takes a 'Stream' of 'Maybe's and returns
    a 'Stream' of all of the 'Just' values. 'concat' has the same behavior,
    but is more general; it works for any foldable container type.
-}</span></span><span>
</span><span id="line-2823"></span><span id="local-6989586621679079378"><span id="local-6989586621679079379"><span id="local-6989586621679079380"><span class="annot"><a href="Streaming.Prelude.html#catMaybes"><span class="hs-identifier hs-type">catMaybes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079378"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079378"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079380"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079378"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079380"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-2824"></span><span id="catMaybes"><span class="annot"><span class="annottext">catMaybes :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#catMaybes"><span class="hs-identifier hs-var hs-var">catMaybes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r
forall {m :: * -&gt; *} {a} {r}.
Functor m =&gt;
Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679081248"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2825"></span><span>  </span><span id="local-6989586621679081248"><span class="annot"><span class="annottext">loop :: Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679081248"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081251"><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r
</span><a href="#local-6989586621679081251"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r
</span><a href="#local-6989586621679081251"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2826"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081252"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081252"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081252"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2827"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081253"><span class="annot"><span class="annottext">m (Stream (Of (Maybe a)) m r)
</span><a href="#local-6989586621679081253"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r)
-&gt; m (Stream (Of (Maybe a)) m r) -&gt; m (Stream (Of a) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679081248"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of (Maybe a)) m r)
</span><a href="#local-6989586621679081253"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2828"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081254"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679081254"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081255"><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r
</span><a href="#local-6989586621679081255"><span class="hs-identifier hs-var">snext</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679081254"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2829"></span><span>      </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679081248"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r
</span><a href="#local-6989586621679081255"><span class="hs-identifier hs-var">snext</span></a></span><span>
</span><span id="line-2830"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679081256"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081256"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of a (Stream (Of a) m r) -&gt; Stream (Of a) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081256"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m r -&gt; Of a (Stream (Of a) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679081248"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m r
</span><a href="#local-6989586621679081255"><span class="hs-identifier hs-var">snext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2831"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#catMaybes"><span class="hs-pragma hs-type">catMaybes</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2832"></span><span>
</span><span id="line-2833"></span><span class="annot"><span class="hs-comment">{-| The 'mapMaybe' function is a version of 'map' which can throw out elements. In particular,
    the functional argument returns something of type @'Maybe' b@. If this is 'Nothing', no element
    is added on to the result 'Stream'. If it is @'Just' b@, then @b@ is included in the result 'Stream'.

-}</span></span><span>
</span><span id="line-2838"></span><span id="local-6989586621679079387"><span id="local-6989586621679079388"><span id="local-6989586621679079389"><span id="local-6989586621679079390"><span class="annot"><a href="Streaming.Prelude.html#mapMaybe"><span class="hs-identifier hs-type">mapMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079387"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079388"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079389"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079388"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079387"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079390"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079389"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079387"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079390"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-2839"></span><span id="mapMaybe"><span class="annot"><span class="annottext">mapMaybe :: forall (m :: * -&gt; *) a b r.
Monad m =&gt;
(a -&gt; Maybe b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#mapMaybe"><span class="hs-identifier hs-var hs-var">mapMaybe</span></a></span></span><span> </span><span id="local-6989586621679081261"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679081261"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081262"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2840"></span><span>  </span><span id="local-6989586621679081262"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081262"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081263"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081263"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081263"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2841"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081264"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081264"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081264"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2842"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081265"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679081265"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of b) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of b) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081262"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679081265"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2843"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081266"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081266"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081267"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081267"><span class="hs-identifier hs-var">snext</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679081261"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081266"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2844"></span><span>      </span><span class="annot"><span class="annottext">Maybe b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081262"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081267"><span class="hs-identifier hs-var">snext</span></a></span><span>
</span><span id="line-2845"></span><span>      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679081268"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081268"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of b (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081268"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Stream (Of b) m r -&gt; Of b (Stream (Of b) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081262"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081267"><span class="hs-identifier hs-var">snext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2846"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapMaybe"><span class="hs-pragma hs-type">mapMaybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2847"></span><span>
</span><span id="line-2848"></span><span class="annot"><span class="hs-comment">{-| 'slidingWindow' accumulates the first @n@ elements of a stream,
     update thereafter to form a sliding window of length @n@.
     It follows the behavior of the slidingWindow function in
     &lt;https://hackage.haskell.org/package/conduit-combinators-1.0.4/docs/Data-Conduit-Combinators.html#v:slidingWindow conduit-combinators&gt;.

&gt;&gt;&gt; S.print $ S.slidingWindow 4 $ S.each &quot;123456&quot;
fromList &quot;1234&quot;
fromList &quot;2345&quot;
fromList &quot;3456&quot;

-}</span></span><span>
</span><span id="line-2859"></span><span>
</span><span id="line-2860"></span><span id="local-6989586621679079395"><span id="local-6989586621679079396"><span id="local-6989586621679079397"><span class="annot"><a href="Streaming.Prelude.html#slidingWindow"><span class="hs-identifier hs-type">slidingWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079395"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-2861"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-2862"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079396"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079397"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-2863"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq.Seq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079396"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079397"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-2864"></span><span id="slidingWindow"><span class="annot"><span class="annottext">slidingWindow :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
Int -&gt; Stream (Of a) m b -&gt; Stream (Of (Seq a)) m b
</span><a href="Streaming.Prelude.html#slidingWindow"><span class="hs-identifier hs-var hs-var">slidingWindow</span></a></span></span><span> </span><span id="local-6989586621679081277"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081277"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq a -&gt; Stream (Of a) m b -&gt; Stream (Of (Seq a)) m b
forall {t} {m :: * -&gt; *} {a} {r}.
(Eq t, Num t, Monad m) =&gt;
t -&gt; Seq a -&gt; Stream (Of a) m r -&gt; Stream (Of (Seq a)) m r
</span><a href="#local-6989586621679081278"><span class="hs-identifier hs-var">setup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#max"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081277"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq a
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2865"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2866"></span><span>    </span><span id="local-6989586621679081293"><span class="annot"><span class="annottext">window :: Seq a -&gt; Stream (Of a) m b -&gt; Stream (Of (Seq a)) m b
</span><a href="#local-6989586621679081293"><span class="hs-identifier hs-var hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679081294"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081294"><span class="hs-identifier hs-var">sequ</span></a></span></span><span> </span><span id="local-6989586621679081295"><span class="annot"><span class="annottext">Stream (Of a) m b
</span><a href="#local-6989586621679081295"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2867"></span><span>      </span><span id="local-6989586621679081296"><span class="annot"><span class="annottext">Either b (a, Stream (Of a) m b)
</span><a href="#local-6989586621679081296"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either b (a, Stream (Of a) m b))
-&gt; Stream (Of (Seq a)) m (Either b (a, Stream (Of a) m b))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of (Seq a)) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m b -&gt; m (Either b (a, Stream (Of a) m b))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m b
</span><a href="#local-6989586621679081295"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2868"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b (a, Stream (Of a) m b)
</span><a href="#local-6989586621679081296"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2869"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679081297"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081297"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Stream (Of (Seq a)) m b
forall a. a -&gt; Stream (Of (Seq a)) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081297"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2870"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081298"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081298"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081299"><span class="annot"><span class="annottext">Stream (Of a) m b
</span><a href="#local-6989586621679081299"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2871"></span><span>          </span><span class="annot"><span class="annottext">Seq a -&gt; Stream (Of (Seq a)) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081294"><span class="hs-identifier hs-var">sequ</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a -&gt; a -&gt; Seq a
forall a. Seq a -&gt; a -&gt; Seq a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">Seq.|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081298"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2872"></span><span>          </span><span class="annot"><span class="annottext">Seq a -&gt; Stream (Of a) m b -&gt; Stream (Of (Seq a)) m b
</span><a href="#local-6989586621679081293"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Seq a -&gt; Seq a
forall a. Int -&gt; Seq a -&gt; Seq a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#drop"><span class="hs-identifier hs-var">Seq.drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Seq a -&gt; Seq a) -&gt; Seq a -&gt; Seq a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081294"><span class="hs-identifier hs-var">sequ</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a -&gt; a -&gt; Seq a
forall a. Seq a -&gt; a -&gt; Seq a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">Seq.|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081298"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m b
</span><a href="#local-6989586621679081299"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2873"></span><span>    </span><span id="local-6989586621679081278"><span class="annot"><span class="annottext">setup :: t -&gt; Seq a -&gt; Stream (Of a) m r -&gt; Stream (Of (Seq a)) m r
</span><a href="#local-6989586621679081278"><span class="hs-identifier hs-var hs-var">setup</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679081325"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081325"><span class="hs-identifier hs-var">sequ</span></a></span></span><span> </span><span id="local-6989586621679081326"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081326"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2874"></span><span>       </span><span class="annot"><span class="annottext">Seq a -&gt; Stream (Of (Seq a)) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081325"><span class="hs-identifier hs-var">sequ</span></a></span><span>
</span><span id="line-2875"></span><span>       </span><span class="annot"><span class="annottext">Seq a -&gt; Stream (Of a) m r -&gt; Stream (Of (Seq a)) m r
forall {m :: * -&gt; *} {a} {b}.
Monad m =&gt;
Seq a -&gt; Stream (Of a) m b -&gt; Stream (Of (Seq a)) m b
</span><a href="#local-6989586621679081293"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Seq a -&gt; Seq a
forall a. Int -&gt; Seq a -&gt; Seq a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#drop"><span class="hs-identifier hs-var">Seq.drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081325"><span class="hs-identifier hs-var">sequ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081326"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-2876"></span><span>    </span><span class="annot"><a href="#local-6989586621679081278"><span class="hs-identifier hs-var">setup</span></a></span><span> </span><span id="local-6989586621679081327"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679081327"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679081328"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081328"><span class="hs-identifier hs-var">sequ</span></a></span></span><span> </span><span id="local-6989586621679081329"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081329"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2877"></span><span>      </span><span id="local-6989586621679081330"><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679081330"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either r (a, Stream (Of a) m r))
-&gt; Stream (Of (Seq a)) m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of (Seq a)) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either r (a, Stream (Of a) m r))
 -&gt; Stream (Of (Seq a)) m (Either r (a, Stream (Of a) m r)))
-&gt; m (Either r (a, Stream (Of a) m r))
-&gt; Stream (Of (Seq a)) m (Either r (a, Stream (Of a) m r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081329"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-2878"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679081330"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2879"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679081331"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081331"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">Seq a -&gt; Stream (Of (Seq a)) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081328"><span class="hs-identifier hs-var">sequ</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Seq a)) m ()
-&gt; Stream (Of (Seq a)) m r -&gt; Stream (Of (Seq a)) m r
forall a b.
Stream (Of (Seq a)) m a
-&gt; Stream (Of (Seq a)) m b -&gt; Stream (Of (Seq a)) m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of (Seq a)) m r
forall a. a -&gt; Stream (Of (Seq a)) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081331"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2880"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081332"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081332"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081333"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081333"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; Seq a -&gt; Stream (Of a) m r -&gt; Stream (Of (Seq a)) m r
</span><a href="#local-6989586621679081278"><span class="hs-identifier hs-var">setup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679081327"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679081328"><span class="hs-identifier hs-var">sequ</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a -&gt; a -&gt; Seq a
forall a. Seq a -&gt; a -&gt; Seq a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">Seq.|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081332"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081333"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2881"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindow"><span class="hs-pragma hs-type">slidingWindow</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2882"></span><span>
</span><span id="line-2883"></span><span class="hs-comment">-- | 'slidingWindowMin' finds the minimum in every sliding window of @n@</span><span>
</span><span id="line-2884"></span><span class="hs-comment">-- elements of a stream. If within a window there are multiple elements that are</span><span>
</span><span id="line-2885"></span><span class="hs-comment">-- the least, it prefers the first occurrence (if you prefer to have the last</span><span>
</span><span id="line-2886"></span><span class="hs-comment">-- occurrence, use the max version and flip your comparator). It satisfies:</span><span>
</span><span id="line-2887"></span><span class="hs-comment">--</span><span>
</span><span id="line-2888"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2889"></span><span class="hs-comment">-- 'slidingWindowMin' n s = 'map' 'Foldable.minimum' ('slidingWindow' n s)</span><span>
</span><span id="line-2890"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2891"></span><span class="hs-comment">--</span><span>
</span><span id="line-2892"></span><span class="hs-comment">-- Except that it is far more efficient, especially when the window size is</span><span>
</span><span id="line-2893"></span><span class="hs-comment">-- large: it calls 'compare' /O(m)/ times overall where /m/ is the total number</span><span>
</span><span id="line-2894"></span><span class="hs-comment">-- of elements in the stream.</span><span>
</span><span id="line-2895"></span><span id="local-6989586621679079412"><span id="local-6989586621679079413"><span id="local-6989586621679079414"><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMin"><span class="hs-identifier hs-type">slidingWindowMin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079412"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079413"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079413"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079412"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079414"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079413"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079412"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079414"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-2896"></span><span id="slidingWindowMin"><span class="annot"><span class="annottext">slidingWindowMin :: forall (m :: * -&gt; *) a b.
(Monad m, Ord a) =&gt;
Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowMin"><span class="hs-identifier hs-var hs-var">slidingWindowMin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering)
-&gt; Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowMinBy"><span class="hs-identifier hs-var">slidingWindowMinBy</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span>
</span><span id="line-2897"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMin"><span class="hs-pragma hs-type">slidingWindowMin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2898"></span><span>
</span><span id="line-2899"></span><span class="hs-comment">-- | 'slidingWindowMax' finds the maximum in every sliding window of @n@</span><span>
</span><span id="line-2900"></span><span class="hs-comment">-- elements of a stream. If within a window there are multiple elements that are</span><span>
</span><span id="line-2901"></span><span class="hs-comment">-- the largest, it prefers the last occurrence (if you prefer to have the first</span><span>
</span><span id="line-2902"></span><span class="hs-comment">-- occurrence, use the min version and flip your comparator). It satisfies:</span><span>
</span><span id="line-2903"></span><span class="hs-comment">--</span><span>
</span><span id="line-2904"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2905"></span><span class="hs-comment">-- 'slidingWindowMax' n s = 'map' 'Foldable.maximum' ('slidingWindow' n s)</span><span>
</span><span id="line-2906"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2907"></span><span class="hs-comment">--</span><span>
</span><span id="line-2908"></span><span class="hs-comment">-- Except that it is far more efficient, especially when the window size is</span><span>
</span><span id="line-2909"></span><span class="hs-comment">-- large: it calls 'compare' /O(m)/ times overall where /m/ is the total number</span><span>
</span><span id="line-2910"></span><span class="hs-comment">-- of elements in the stream.</span><span>
</span><span id="line-2911"></span><span id="local-6989586621679081338"><span id="local-6989586621679081339"><span id="local-6989586621679081340"><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMax"><span class="hs-identifier hs-type">slidingWindowMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081338"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081339"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081339"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081338"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081340"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081339"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081338"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081340"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-2912"></span><span id="slidingWindowMax"><span class="annot"><span class="annottext">slidingWindowMax :: forall (m :: * -&gt; *) a b.
(Monad m, Ord a) =&gt;
Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowMax"><span class="hs-identifier hs-var hs-var">slidingWindowMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering)
-&gt; Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowMaxBy"><span class="hs-identifier hs-var">slidingWindowMaxBy</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span>
</span><span id="line-2913"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMax"><span class="hs-pragma hs-type">slidingWindowMax</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2914"></span><span>
</span><span id="line-2915"></span><span class="hs-comment">-- | 'slidingWindowMinBy' finds the minimum in every sliding window of @n@</span><span>
</span><span id="line-2916"></span><span class="hs-comment">-- elements of a stream according to the given comparison function (which should</span><span>
</span><span id="line-2917"></span><span class="hs-comment">-- define a total ordering). See notes above about elements that are equal. It</span><span>
</span><span id="line-2918"></span><span class="hs-comment">-- satisfies:</span><span>
</span><span id="line-2919"></span><span class="hs-comment">--</span><span>
</span><span id="line-2920"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2921"></span><span class="hs-comment">-- 'slidingWindowMinBy' f n s = 'map' ('Foldable.minimumBy' f) ('slidingWindow' n s)</span><span>
</span><span id="line-2922"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2923"></span><span class="hs-comment">--</span><span>
</span><span id="line-2924"></span><span class="hs-comment">-- Except that it is far more efficient, especially when the window size is</span><span>
</span><span id="line-2925"></span><span class="hs-comment">-- large: it calls the comparison function /O(m)/ times overall where /m/ is the</span><span>
</span><span id="line-2926"></span><span class="hs-comment">-- total number of elements in the stream.</span><span>
</span><span id="line-2927"></span><span id="local-6989586621679079418"><span id="local-6989586621679079419"><span id="local-6989586621679079420"><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMinBy"><span class="hs-identifier hs-type">slidingWindowMinBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079418"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079419"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079419"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079419"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079418"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079420"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079419"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079418"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079420"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-2928"></span><span id="slidingWindowMinBy"><span class="annot"><span class="annottext">slidingWindowMinBy :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowMinBy"><span class="hs-identifier hs-var hs-var">slidingWindowMinBy</span></a></span></span><span> </span><span id="local-6989586621679081350"><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
</span><a href="#local-6989586621679081350"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a p b.
Monad m =&gt;
(a -&gt; p)
-&gt; (p -&gt; p -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowOrd"><span class="hs-identifier hs-var">slidingWindowOrd</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679081352"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081352"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679081353"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081353"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
</span><a href="#local-6989586621679081350"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081352"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081353"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2929"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMinBy"><span class="hs-pragma hs-type">slidingWindowMinBy</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2930"></span><span>
</span><span id="line-2931"></span><span class="hs-comment">-- | 'slidingWindowMaxBy' finds the maximum in every sliding window of @n@</span><span>
</span><span id="line-2932"></span><span class="hs-comment">-- elements of a stream according to the given comparison function (which should</span><span>
</span><span id="line-2933"></span><span class="hs-comment">-- define a total ordering). See notes above about elements that are equal. It</span><span>
</span><span id="line-2934"></span><span class="hs-comment">-- satisfies:</span><span>
</span><span id="line-2935"></span><span class="hs-comment">--</span><span>
</span><span id="line-2936"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2937"></span><span class="hs-comment">-- 'slidingWindowMaxBy' f n s = 'map' ('Foldable.maximumBy' f) ('slidingWindow' n s)</span><span>
</span><span id="line-2938"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2939"></span><span class="hs-comment">--</span><span>
</span><span id="line-2940"></span><span class="hs-comment">-- Except that it is far more efficient, especially when the window size is</span><span>
</span><span id="line-2941"></span><span class="hs-comment">-- large: it calls the comparison function /O(m)/ times overall where /m/ is the</span><span>
</span><span id="line-2942"></span><span class="hs-comment">-- total number of elements in the stream.</span><span>
</span><span id="line-2943"></span><span id="local-6989586621679081355"><span id="local-6989586621679081356"><span id="local-6989586621679081357"><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMaxBy"><span class="hs-identifier hs-type">slidingWindowMaxBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679081356"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081356"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081356"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081357"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081356"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081357"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-2944"></span><span id="slidingWindowMaxBy"><span class="annot"><span class="annottext">slidingWindowMaxBy :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowMaxBy"><span class="hs-identifier hs-var hs-var">slidingWindowMaxBy</span></a></span></span><span> </span><span id="local-6989586621679081361"><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
</span><a href="#local-6989586621679081361"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a p b.
Monad m =&gt;
(a -&gt; p)
-&gt; (p -&gt; p -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowOrd"><span class="hs-identifier hs-var">slidingWindowOrd</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679081362"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081362"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679081363"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081363"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
</span><a href="#local-6989586621679081361"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081362"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081363"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2945"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMaxBy"><span class="hs-pragma hs-type">slidingWindowMaxBy</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2946"></span><span>
</span><span id="line-2947"></span><span class="hs-comment">-- | 'slidingWindowMinOn' finds the minimum in every sliding window of @n@</span><span>
</span><span id="line-2948"></span><span class="hs-comment">-- elements of a stream according to the given projection function. See notes</span><span>
</span><span id="line-2949"></span><span class="hs-comment">-- above about elements that are equal. It satisfies:</span><span>
</span><span id="line-2950"></span><span class="hs-comment">--</span><span>
</span><span id="line-2951"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2952"></span><span class="hs-comment">-- 'slidingWindowMinOn' f n s = 'map' ('Foldable.minimumOn' ('comparing' f)) ('slidingWindow' n s)</span><span>
</span><span id="line-2953"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2954"></span><span class="hs-comment">--</span><span>
</span><span id="line-2955"></span><span class="hs-comment">-- Except that it is far more efficient, especially when the window size is</span><span>
</span><span id="line-2956"></span><span class="hs-comment">-- large: it calls 'compare' on the projected value /O(m)/ times overall where</span><span>
</span><span id="line-2957"></span><span class="hs-comment">-- /m/ is the total number of elements in the stream, and it calls the</span><span>
</span><span id="line-2958"></span><span class="hs-comment">-- projection function exactly /m/ times.</span><span>
</span><span id="line-2959"></span><span id="local-6989586621679079434"><span id="local-6989586621679079435"><span id="local-6989586621679079436"><span id="local-6989586621679079437"><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMinOn"><span class="hs-identifier hs-type">slidingWindowMinOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079434"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079435"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079436"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079435"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079436"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079434"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079437"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079436"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079434"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079437"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-2960"></span><span id="slidingWindowMinOn"><span class="annot"><span class="annottext">slidingWindowMinOn :: forall (m :: * -&gt; *) p a b.
(Monad m, Ord p) =&gt;
(a -&gt; p) -&gt; Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowMinOn"><span class="hs-identifier hs-var hs-var">slidingWindowMinOn</span></a></span></span><span> </span><span id="local-6989586621679081369"><span class="annot"><span class="annottext">a -&gt; p
</span><a href="#local-6989586621679081369"><span class="hs-identifier hs-var">proj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; p)
-&gt; (p -&gt; p -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a p b.
Monad m =&gt;
(a -&gt; p)
-&gt; (p -&gt; p -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowOrd"><span class="hs-identifier hs-var">slidingWindowOrd</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; p
</span><a href="#local-6989586621679081369"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679081370"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081370"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679081371"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081371"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081370"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081371"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2961"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMinOn"><span class="hs-pragma hs-type">slidingWindowMinOn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2962"></span><span>
</span><span id="line-2963"></span><span class="hs-comment">-- | 'slidingWindowMaxOn' finds the maximum in every sliding window of @n@</span><span>
</span><span id="line-2964"></span><span class="hs-comment">-- elements of a stream according to the given projection function. See notes</span><span>
</span><span id="line-2965"></span><span class="hs-comment">-- above about elements that are equal. It satisfies:</span><span>
</span><span id="line-2966"></span><span class="hs-comment">--</span><span>
</span><span id="line-2967"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2968"></span><span class="hs-comment">-- 'slidingWindowMaxOn' f n s = 'map' ('Foldable.maximumOn' ('comparing' f)) ('slidingWindow' n s)</span><span>
</span><span id="line-2969"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2970"></span><span class="hs-comment">--</span><span>
</span><span id="line-2971"></span><span class="hs-comment">-- Except that it is far more efficient, especially when the window size is</span><span>
</span><span id="line-2972"></span><span class="hs-comment">-- large: it calls 'compare' on the projected value /O(m)/ times overall where</span><span>
</span><span id="line-2973"></span><span class="hs-comment">-- /m/ is the total number of elements in the stream, and it calls the</span><span>
</span><span id="line-2974"></span><span class="hs-comment">-- projection function exactly /m/ times.</span><span>
</span><span id="line-2975"></span><span id="local-6989586621679081372"><span id="local-6989586621679081373"><span id="local-6989586621679081374"><span id="local-6989586621679081375"><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMaxOn"><span class="hs-identifier hs-type">slidingWindowMaxOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081372"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081373"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679081374"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081373"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081374"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081372"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081375"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081374"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081372"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081375"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-2976"></span><span id="slidingWindowMaxOn"><span class="annot"><span class="annottext">slidingWindowMaxOn :: forall (m :: * -&gt; *) p a b.
(Monad m, Ord p) =&gt;
(a -&gt; p) -&gt; Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowMaxOn"><span class="hs-identifier hs-var hs-var">slidingWindowMaxOn</span></a></span></span><span> </span><span id="local-6989586621679081381"><span class="annot"><span class="annottext">a -&gt; p
</span><a href="#local-6989586621679081381"><span class="hs-identifier hs-var">proj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; p)
-&gt; (p -&gt; p -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a p b.
Monad m =&gt;
(a -&gt; p)
-&gt; (p -&gt; p -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowOrd"><span class="hs-identifier hs-var">slidingWindowOrd</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; p
</span><a href="#local-6989586621679081381"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679081382"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081382"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679081383"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081383"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081382"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081383"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2977"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowMaxOn"><span class="hs-pragma hs-type">slidingWindowMaxOn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2978"></span><span>
</span><span id="line-2979"></span><span class="hs-comment">-- IMPLEMENTATION NOTE [the slidingWindow{Min,Max} functions]</span><span>
</span><span id="line-2980"></span><span class="hs-comment">--</span><span>
</span><span id="line-2981"></span><span class="hs-comment">-- When one wishes to compute the minimum (or maximum; without loss of</span><span>
</span><span id="line-2982"></span><span class="hs-comment">-- generality we will only discuss the minimum case) of a sliding window of a</span><span>
</span><span id="line-2983"></span><span class="hs-comment">-- stream, the naive method is to collect all such sliding windows, and then run</span><span>
</span><span id="line-2984"></span><span class="hs-comment">-- 'Foldable.minimum' over each window. The issue is that this algorithm is very</span><span>
</span><span id="line-2985"></span><span class="hs-comment">-- inefficient: if the stream has $n$ elements, and the sliding window has $k$</span><span>
</span><span id="line-2986"></span><span class="hs-comment">-- elements, then there are $n-k+1$ windows, and computing the minimum in each</span><span>
</span><span id="line-2987"></span><span class="hs-comment">-- window requires $k-1$ comparisons. So a total of $(k-1)*(n-k+1)$ comparisons</span><span>
</span><span id="line-2988"></span><span class="hs-comment">-- are needed, or simply $O(nk)$ when $k$ is much smaller than $n$.</span><span>
</span><span id="line-2989"></span><span class="hs-comment">--</span><span>
</span><span id="line-2990"></span><span class="hs-comment">-- We can motivate an improvement as follows. Suppose the window size is 3 and</span><span>
</span><span id="line-2991"></span><span class="hs-comment">-- the current sliding window has numbers 4, 6, 8; if the next element happens</span><span>
</span><span id="line-2992"></span><span class="hs-comment">-- to be 5, there would then be no need to keep the numbers 6 and 8 in the</span><span>
</span><span id="line-2993"></span><span class="hs-comment">-- window. Because in the next window we have 6, 8, 5 so 5 will be yielded. In</span><span>
</span><span id="line-2994"></span><span class="hs-comment">-- the window after the next we have 8, 5, x so either 5 or x will be yielded.</span><span>
</span><span id="line-2995"></span><span class="hs-comment">-- So 6 and 8 will never be yielded.</span><span>
</span><span id="line-2996"></span><span class="hs-comment">--</span><span>
</span><span id="line-2997"></span><span class="hs-comment">-- This leads to the idea that we can keep a window that is a subsequence of the</span><span>
</span><span id="line-2998"></span><span class="hs-comment">-- actual window. But immediately the next problem is, if we don't keep a window</span><span>
</span><span id="line-2999"></span><span class="hs-comment">-- of the original window size, there would be no way for us to tell which</span><span>
</span><span id="line-3000"></span><span class="hs-comment">-- elements are out of the window. So the idea is to also keep an index of the</span><span>
</span><span id="line-3001"></span><span class="hs-comment">-- item along with the item itself. We then have several important invariants:</span><span>
</span><span id="line-3002"></span><span class="hs-comment">--</span><span>
</span><span id="line-3003"></span><span class="hs-comment">-- (a) The window is sorted according to the index.</span><span>
</span><span id="line-3004"></span><span class="hs-comment">-- (b) The window is sorted according to the item itself.</span><span>
</span><span id="line-3005"></span><span class="hs-comment">-- (c) The size of the window never has more elements than $k$.</span><span>
</span><span id="line-3006"></span><span class="hs-comment">--</span><span>
</span><span id="line-3007"></span><span class="hs-comment">-- The window is initially empty. The three-step algorithm to update the window</span><span>
</span><span id="line-3008"></span><span class="hs-comment">-- maintains these invariants.</span><span>
</span><span id="line-3009"></span><span class="hs-comment">--</span><span>
</span><span id="line-3010"></span><span class="hs-comment">-- The overall asymptotic complexity is great. Comparisons only happen in the</span><span>
</span><span id="line-3011"></span><span class="hs-comment">-- first part of the update. Each comparison either results in an element being</span><span>
</span><span id="line-3012"></span><span class="hs-comment">-- removed from the window (so there can be at most $O(n)$ such comparisons); or</span><span>
</span><span id="line-3013"></span><span class="hs-comment">-- that comparison does not result in an element being removed, but such</span><span>
</span><span id="line-3014"></span><span class="hs-comment">-- comparisons happen at most once for each element being inserted, which is</span><span>
</span><span id="line-3015"></span><span class="hs-comment">-- also $O(n)$. This means an overall $O(n)$ number of comparisons needed.</span><span>
</span><span id="line-3016"></span><span class="hs-comment">--</span><span>
</span><span id="line-3017"></span><span class="hs-comment">-- I did not invent this algorithm; it's pretty well-known. I'm not sure the</span><span>
</span><span id="line-3018"></span><span class="hs-comment">-- algorithm has a name.</span><span>
</span><span id="line-3019"></span><span id="local-6989586621679079427"><span id="local-6989586621679079428"><span id="local-6989586621679079429"><span id="local-6989586621679079430"><span class="annot"><a href="Streaming.Prelude.html#slidingWindowOrd"><span class="hs-identifier hs-type">slidingWindowOrd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079428"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079429"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079429"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079429"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079428"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079430"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079428"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079430"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-3020"></span><span id="slidingWindowOrd"><span class="annot"><span class="annottext">slidingWindowOrd :: forall (m :: * -&gt; *) a p b.
Monad m =&gt;
(a -&gt; p)
-&gt; (p -&gt; p -&gt; Bool)
-&gt; Int
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
</span><a href="Streaming.Prelude.html#slidingWindowOrd"><span class="hs-identifier hs-var hs-var">slidingWindowOrd</span></a></span></span><span> </span><span id="local-6989586621679081400"><span class="annot"><span class="annottext">a -&gt; p
</span><a href="#local-6989586621679081400"><span class="hs-identifier hs-var">proj</span></a></span></span><span> </span><span id="local-6989586621679081401"><span class="annot"><span class="annottext">p -&gt; p -&gt; Bool
</span><a href="#local-6989586621679081401"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679081402"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081402"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3021"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Int -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#dropButRetainAtLeastOne"><span class="hs-identifier hs-var">dropButRetainAtLeastOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081404"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Stream (Of a) m b -&gt; Stream (Of a) m b)
-&gt; (Stream (Of a) m b -&gt; Stream (Of a) m b)
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of (Maybe a)) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of (Maybe a)) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">(Stream (Of (Maybe a)) m b -&gt; Stream (Of a) m b)
-&gt; (Stream (Of a) m b -&gt; Stream (Of (Maybe a)) m b)
-&gt; Stream (Of a) m b
-&gt; Stream (Of a) m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(SlidingWindowOrdState a p -&gt; a -&gt; SlidingWindowOrdState a p)
-&gt; SlidingWindowOrdState a p
-&gt; (SlidingWindowOrdState a p -&gt; Maybe a)
-&gt; Stream (Of a) m b
-&gt; Stream (Of (Maybe a)) m b
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x)
-&gt; x -&gt; (x -&gt; b) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#scan"><span class="hs-identifier hs-var">scan</span></a></span><span> </span><span class="annot"><span class="annottext">SlidingWindowOrdState a p -&gt; a -&gt; SlidingWindowOrdState a p
</span><a href="#local-6989586621679081405"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">SlidingWindowOrdState a p
forall {a} {p}. SlidingWindowOrdState a p
</span><a href="#local-6989586621679081406"><span class="hs-identifier hs-var">initial</span></a></span><span> </span><span class="annot"><span class="annottext">SlidingWindowOrdState a p -&gt; Maybe a
forall {a} {p}. SlidingWindowOrdState a p -&gt; Maybe a
</span><a href="#local-6989586621679081407"><span class="hs-identifier hs-var">extract</span></a></span><span>
</span><span id="line-3022"></span><span>  </span><span class="hs-comment">-- The use of dropButRetainAtLeastOne is to gracefully handle edge cases where</span><span>
</span><span id="line-3023"></span><span>  </span><span class="hs-comment">-- the window size is bigger than the length of the entire sequence.</span><span>
</span><span id="line-3024"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3025"></span><span>    </span><span id="local-6989586621679081404"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679081404"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#max"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081402"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-comment">-- window size</span><span>
</span><span id="line-3026"></span><span>    </span><span id="local-6989586621679081406"><span class="annot"><span class="annottext">initial :: SlidingWindowOrdState a p
</span><a href="#local-6989586621679081406"><span class="hs-identifier hs-var hs-var">initial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; Seq (SlidingWindowOrdElement a p) -&gt; SlidingWindowOrdState a p
forall a p.
Word64
-&gt; Seq (SlidingWindowOrdElement a p) -&gt; SlidingWindowOrdState a p
</span><a href="Streaming.Prelude.html#SlidingWindowOrdState"><span class="hs-identifier hs-var">SlidingWindowOrdState</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-3027"></span><span>    </span><span class="hs-comment">-- All three invariants are satisfied initially. The window is trivially</span><span>
</span><span id="line-3028"></span><span>    </span><span class="hs-comment">-- sorted because it is empty. Its size, zero, is also less than the window</span><span>
</span><span id="line-3029"></span><span>    </span><span class="hs-comment">-- size.</span><span>
</span><span id="line-3030"></span><span>    </span><span id="local-6989586621679081405"><span class="annot"><span class="annottext">update :: SlidingWindowOrdState a p -&gt; a -&gt; SlidingWindowOrdState a p
</span><a href="#local-6989586621679081405"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdState"><span class="hs-identifier hs-type">SlidingWindowOrdState</span></a></span><span> </span><span id="local-6989586621679081411"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679081411"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679081412"><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081412"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679081413"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081413"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3031"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081414"><span class="annot"><span class="annottext">projected :: p
</span><a href="#local-6989586621679081414"><span class="hs-identifier hs-var hs-var">projected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; p
</span><a href="#local-6989586621679081400"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081413"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-3032"></span><span>          </span><span id="local-6989586621679081415"><span class="annot"><span class="annottext">w1 :: Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081415"><span class="hs-identifier hs-var hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SlidingWindowOrdElement a p -&gt; Bool)
-&gt; Seq (SlidingWindowOrdElement a p)
-&gt; Seq (SlidingWindowOrdElement a p)
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#dropWhileR"><span class="hs-identifier hs-var">Seq.dropWhileR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdElement"><span class="hs-identifier hs-type">SlidingWindowOrdElement</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679081418"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081418"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; Bool
</span><a href="#local-6989586621679081401"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081418"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081414"><span class="hs-identifier hs-var">projected</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081412"><span class="hs-identifier hs-var">w0</span></a></span><span>
</span><span id="line-3033"></span><span>      </span><span class="hs-comment">-- Step 1: pop all elements at the back greater than the current one,</span><span>
</span><span id="line-3034"></span><span>      </span><span class="hs-comment">-- because they will never be yielded: the current element will always be</span><span>
</span><span id="line-3035"></span><span>      </span><span class="hs-comment">-- yielded until those popped elements go out of the window. This is</span><span>
</span><span id="line-3036"></span><span>      </span><span class="hs-comment">-- extracting a subsequence of the window, so invariants (a) and (b)</span><span>
</span><span id="line-3037"></span><span>      </span><span class="hs-comment">-- remain satisfied. Since this operation deletes elements, invariant (c)</span><span>
</span><span id="line-3038"></span><span>      </span><span class="hs-comment">-- is maintained.</span><span>
</span><span id="line-3039"></span><span>          </span><span id="local-6989586621679081419"><span class="annot"><span class="annottext">w2 :: Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081419"><span class="hs-identifier hs-var hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081415"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
-&gt; SlidingWindowOrdElement a p -&gt; Seq (SlidingWindowOrdElement a p)
forall a. Seq a -&gt; a -&gt; Seq a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">Seq.|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; a -&gt; p -&gt; SlidingWindowOrdElement a p
forall a p. Word64 -&gt; a -&gt; p -&gt; SlidingWindowOrdElement a p
</span><a href="Streaming.Prelude.html#SlidingWindowOrdElement"><span class="hs-identifier hs-var">SlidingWindowOrdElement</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679081411"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081413"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679081414"><span class="hs-identifier hs-var">projected</span></a></span><span>
</span><span id="line-3040"></span><span>      </span><span class="hs-comment">-- Step 2: add the current element to the back. Since the current index is</span><span>
</span><span id="line-3041"></span><span>      </span><span class="hs-comment">-- greater than all previous indices, invariant (a) is satisfied.</span><span>
</span><span id="line-3042"></span><span>      </span><span class="hs-comment">-- Invariant (b) is also satisfied because in step 1 we popped elements</span><span>
</span><span id="line-3043"></span><span>      </span><span class="hs-comment">-- greater than the current, so either the window is empty or the back of</span><span>
</span><span id="line-3044"></span><span>      </span><span class="hs-comment">-- the window is smaller than the current one. Invariant (c) may be</span><span>
</span><span id="line-3045"></span><span>      </span><span class="hs-comment">-- violated, but this is fixed below.</span><span>
</span><span id="line-3046"></span><span>          </span><span id="local-6989586621679081420"><span class="annot"><span class="annottext">w3 :: Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081420"><span class="hs-identifier hs-var hs-var">w3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SlidingWindowOrdElement a p -&gt; Bool)
-&gt; Seq (SlidingWindowOrdElement a p)
-&gt; Seq (SlidingWindowOrdElement a p)
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#dropWhileL"><span class="hs-identifier hs-var">Seq.dropWhileL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdElement"><span class="hs-identifier hs-type">SlidingWindowOrdElement</span></a></span><span> </span><span id="local-6989586621679081422"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679081422"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679081422"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081404"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679081411"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081419"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-3047"></span><span>      </span><span class="hs-comment">-- Step 3: remove elements that are out of the window. Again this is</span><span>
</span><span id="line-3048"></span><span>      </span><span class="hs-comment">-- extracting a subsequence so invariants (a) and (b) are maintained.</span><span>
</span><span id="line-3049"></span><span>      </span><span class="hs-comment">-- Invariant (c) is maintained because the least index still possibly in</span><span>
</span><span id="line-3050"></span><span>      </span><span class="hs-comment">-- the window is i+1-k, in which case we have k elements.</span><span>
</span><span id="line-3051"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; Seq (SlidingWindowOrdElement a p) -&gt; SlidingWindowOrdState a p
forall a p.
Word64
-&gt; Seq (SlidingWindowOrdElement a p) -&gt; SlidingWindowOrdState a p
</span><a href="Streaming.Prelude.html#SlidingWindowOrdState"><span class="hs-identifier hs-var">SlidingWindowOrdState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679081411"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081420"><span class="hs-identifier hs-var">w3</span></a></span><span>
</span><span id="line-3052"></span><span>    </span><span class="hs-comment">-- Extract the front.</span><span>
</span><span id="line-3053"></span><span>    </span><span id="local-6989586621679081407"><span class="annot"><span class="annottext">extract :: SlidingWindowOrdState a p -&gt; Maybe a
</span><a href="#local-6989586621679081407"><span class="hs-identifier hs-var hs-var">extract</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdState"><span class="hs-identifier hs-type">SlidingWindowOrdState</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679081423"><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081423"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3054"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
-&gt; ViewL (SlidingWindowOrdElement a p)
forall a. Seq a -&gt; ViewL a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#viewl"><span class="hs-identifier hs-var">Seq.viewl</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
</span><a href="#local-6989586621679081423"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3055"></span><span>          </span><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdElement"><span class="hs-identifier hs-type">SlidingWindowOrdElement</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679081425"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081425"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-type">Seq.:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (SlidingWindowOrdElement a p)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081425"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-3056"></span><span>          </span><span class="annot"><span class="annottext">ViewL (SlidingWindowOrdElement a p)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-3057"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#slidingWindowOrd"><span class="hs-pragma hs-type">slidingWindowOrd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3058"></span><span>
</span><span id="line-3059"></span><span class="hs-comment">-- | A 'SlidingWindowOrdState' keeps track of the current sliding window state</span><span>
</span><span id="line-3060"></span><span class="hs-comment">-- in 'slidingWindowOrd'. It keeps track of the current index of the item from</span><span>
</span><span id="line-3061"></span><span class="hs-comment">-- the stream as well as a 'Seq.Seq' of the current window. See comments above</span><span>
</span><span id="line-3062"></span><span class="hs-comment">-- for properties satisfied by the window.</span><span>
</span><span id="line-3063"></span><span class="hs-keyword">data</span><span> </span><span id="SlidingWindowOrdState"><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdState"><span class="hs-identifier hs-var">SlidingWindowOrdState</span></a></span></span><span> </span><span id="local-6989586621679079456"><span class="annot"><a href="#local-6989586621679079456"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679079457"><span class="annot"><a href="#local-6989586621679079457"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3064"></span><span>  </span><span id="SlidingWindowOrdState"><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdState"><span class="hs-identifier hs-var">SlidingWindowOrdState</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-3065"></span><span>                        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq.Seq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdElement"><span class="hs-identifier hs-type">SlidingWindowOrdElement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079456"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079457"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3066"></span><span>
</span><span id="line-3067"></span><span class="hs-comment">-- | A 'SlidingWindowOrdElement' is an element with a 'Word64'-based index as</span><span>
</span><span id="line-3068"></span><span class="hs-comment">-- well as the projection used for comparison. It is used in the sliding window</span><span>
</span><span id="line-3069"></span><span class="hs-comment">-- functions to associate an item with their index and the projected element in</span><span>
</span><span id="line-3070"></span><span class="hs-comment">-- the stream.</span><span>
</span><span id="line-3071"></span><span class="hs-keyword">data</span><span> </span><span id="SlidingWindowOrdElement"><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdElement"><span class="hs-identifier hs-var">SlidingWindowOrdElement</span></a></span></span><span> </span><span id="local-6989586621679079459"><span class="annot"><a href="#local-6989586621679079459"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679079460"><span class="annot"><a href="#local-6989586621679079460"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SlidingWindowOrdElement"><span class="annot"><a href="Streaming.Prelude.html#SlidingWindowOrdElement"><span class="hs-identifier hs-var">SlidingWindowOrdElement</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079460"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-3072"></span><span>
</span><span id="line-3073"></span><span class="hs-comment">-- | Similar to 'drop', except that if the input stream doesn't have enough</span><span>
</span><span id="line-3074"></span><span class="hs-comment">-- elements, the last one will be yielded. However, if there's none to begin</span><span>
</span><span id="line-3075"></span><span class="hs-comment">-- with, this function will also produce none.</span><span>
</span><span id="line-3076"></span><span id="local-6989586621679081427"><span id="local-6989586621679081428"><span id="local-6989586621679081429"><span class="annot"><a href="Streaming.Prelude.html#dropButRetainAtLeastOne"><span class="hs-identifier hs-type">dropButRetainAtLeastOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081428"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081429"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081428"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679081427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081429"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-3077"></span><span id="dropButRetainAtLeastOne"><span class="annot"><span class="annottext">dropButRetainAtLeastOne :: forall (m :: * -&gt; *) a r.
Monad m =&gt;
Int -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="Streaming.Prelude.html#dropButRetainAtLeastOne"><span class="hs-identifier hs-var hs-var">dropButRetainAtLeastOne</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of a) m r
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-3078"></span><span class="annot"><a href="Streaming.Prelude.html#dropButRetainAtLeastOne"><span class="hs-identifier hs-var">dropButRetainAtLeastOne</span></a></span><span> </span><span id="local-6989586621679081436"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081436"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Int -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
forall {t} {m :: * -&gt; *} {a} {r}.
(Eq t, Num t, Monad m) =&gt;
Maybe a -&gt; t -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679081437"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081436"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3079"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3080"></span><span>    </span><span id="local-6989586621679081437"><span class="annot"><span class="annottext">loop :: Maybe a -&gt; t -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679081437"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679081462"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081462"><span class="hs-identifier hs-var">final</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679081463"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081463"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081462"><span class="hs-identifier hs-var">final</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m () -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
forall a b.
Stream (Of a) m a -&gt; Stream (Of a) m b -&gt; Stream (Of a) m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081463"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-3081"></span><span>    </span><span class="annot"><a href="#local-6989586621679081437"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679081464"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679081464"><span class="hs-identifier hs-var">final</span></a></span></span><span> </span><span id="local-6989586621679081465"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679081465"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679081466"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081466"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3082"></span><span>      </span><span id="local-6989586621679081467"><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679081467"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either r (a, Stream (Of a) m r))
-&gt; Stream (Of a) m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; Stream (Of a) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
forall (m :: * -&gt; *) a r.
Monad m =&gt;
Stream (Of a) m r -&gt; m (Either r (a, Stream (Of a) m r))
</span><a href="Streaming.Prelude.html#next"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081466"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3083"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either r (a, Stream (Of a) m r)
</span><a href="#local-6989586621679081467"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3084"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679081468"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081468"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3085"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679081464"><span class="hs-identifier hs-var">final</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3086"></span><span>            </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Stream (Of a) m ()
forall a. a -&gt; Stream (Of a) m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3087"></span><span>            </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679081469"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081469"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stream (Of a) m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; Stream (Of a) m ()
</span><a href="Streaming.Prelude.html#yield"><span class="hs-identifier hs-var">yield</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081469"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3088"></span><span>          </span><span class="annot"><span class="annottext">r -&gt; Stream (Of a) m r
forall a. a -&gt; Stream (Of a) m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081468"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-3089"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081470"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081470"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679081471"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081471"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; t -&gt; Stream (Of a) m r -&gt; Stream (Of a) m r
</span><a href="#local-6989586621679081437"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081470"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679081465"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081471"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-3090"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#dropButRetainAtLeastOne"><span class="hs-pragma hs-type">dropButRetainAtLeastOne</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3091"></span><span>
</span><span id="line-3092"></span><span>
</span><span id="line-3093"></span><span class="hs-comment">-- | Map monadically over a stream, producing a new stream</span><span>
</span><span id="line-3094"></span><span class="hs-comment">--   only containing the 'Just' values.</span><span>
</span><span id="line-3095"></span><span id="local-6989586621679079472"><span id="local-6989586621679079473"><span id="local-6989586621679079474"><span id="local-6989586621679079475"><span class="annot"><a href="Streaming.Prelude.html#mapMaybeM"><span class="hs-identifier hs-type">mapMaybeM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079472"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079473"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079472"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079474"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079472"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079475"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Streaming.Internal.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Functor.Of.html#Of"><span class="hs-identifier hs-type">Of</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079474"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679079472"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079475"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-3096"></span><span id="mapMaybeM"><span class="annot"><span class="annottext">mapMaybeM :: forall (m :: * -&gt; *) a b r.
Monad m =&gt;
(a -&gt; m (Maybe b)) -&gt; Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="Streaming.Prelude.html#mapMaybeM"><span class="hs-identifier hs-var hs-var">mapMaybeM</span></a></span></span><span> </span><span id="local-6989586621679081477"><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><a href="#local-6989586621679081477"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081478"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3097"></span><span>  </span><span id="local-6989586621679081478"><span class="annot"><span class="annottext">loop :: Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081478"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679081479"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081479"><span class="hs-identifier hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081479"><span class="hs-identifier hs-var">stream</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3098"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679081480"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081480"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r. r -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Return"><span class="hs-identifier hs-var">Return</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679081480"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-3099"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span id="local-6989586621679081481"><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679081481"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stream (Of a) m r -&gt; Stream (Of b) m r)
-&gt; m (Stream (Of a) m r) -&gt; m (Stream (Of b) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081478"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">m (Stream (Of a) m r)
</span><a href="#local-6989586621679081481"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3100"></span><span>    </span><span class="annot"><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081482"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081482"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679081483"><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081483"><span class="hs-identifier hs-var">snext</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
m (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Effect"><span class="hs-identifier hs-var">Effect</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Stream (Of b) m r) -&gt; Stream (Of b) m r)
-&gt; m (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-3101"></span><span>      </span><span class="annot"><span class="annottext">((Maybe b -&gt; Stream (Of b) m r)
 -&gt; m (Maybe b) -&gt; m (Stream (Of b) m r))
-&gt; m (Maybe b)
-&gt; (Maybe b -&gt; Stream (Of b) m r)
-&gt; m (Stream (Of b) m r)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe b -&gt; Stream (Of b) m r)
-&gt; m (Maybe b) -&gt; m (Stream (Of b) m r)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; m (Maybe b)
</span><a href="#local-6989586621679081477"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081482"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe b -&gt; Stream (Of b) m r) -&gt; m (Stream (Of b) m r))
-&gt; (Maybe b -&gt; Stream (Of b) m r) -&gt; m (Stream (Of b) m r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679081484"><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679081484"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679081484"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3102"></span><span>        </span><span class="annot"><span class="annottext">Maybe b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081478"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081483"><span class="hs-identifier hs-var">snext</span></a></span><span>
</span><span id="line-3103"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679081485"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081485"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Of b (Stream (Of b) m r) -&gt; Stream (Of b) m r
forall (f :: * -&gt; *) (m :: * -&gt; *) r.
f (Stream f m r) -&gt; Stream f m r
</span><a href="Streaming.Internal.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081485"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Stream (Of b) m r -&gt; Of b (Stream (Of b) m r)
forall a b. a -&gt; b -&gt; Of a b
</span><a href="Data.Functor.Of.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r -&gt; Stream (Of b) m r
</span><a href="#local-6989586621679081478"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Stream (Of a) m r
</span><a href="#local-6989586621679081483"><span class="hs-identifier hs-var">snext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3104"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Streaming.Prelude.html#mapMaybeM"><span class="hs-pragma hs-type">mapMaybeM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3105"></span></pre></body></html>