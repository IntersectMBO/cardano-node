<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head id="head" data-base-url=".."><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Cardano.Benchmarking.Wallet</title><link href="../linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="../quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="../haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">tx-generator-2.15: A transaction workload generator for Cardano clusters</span><ul class="links" id="page-menu"><li><a href="src/Cardano.Benchmarking.Wallet.html">Source</a></li><li><a href="../index.html">Contents</a></li><li><a href="../doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cardano.Benchmarking.Wallet</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Beyond the basic wallet functions, there are some functions
manipulating the <code><a href="Cardano-TxGenerator-FundQueue.html#t:FundQueue" title="Cardano.TxGenerator.FundQueue">FundQueue</a></code> held in a <code><a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a></code> by side
effect, like <code><a href="Cardano-Benchmarking-Wallet.html#v:createAndStore" title="Cardano.Benchmarking.Wallet">createAndStore</a></code> and <code><a href="Cardano-Benchmarking-Wallet.html#v:mangle" title="Cardano.Benchmarking.Wallet">mangle</a></code>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:WalletRef">WalletRef</a> = <a href="../base/Control-Concurrent-MVar.html#t:MVar" title="Control.Concurrent.MVar">MVar</a> <a href="Cardano-TxGenerator-FundQueue.html#t:FundQueue" title="Cardano.TxGenerator.FundQueue">FundQueue</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TxStream">TxStream</a> m era = <a href="../streaming/Streaming-Internal.html#t:Stream" title="Streaming.Internal">Stream</a> (<a href="../streaming/Data-Functor-Of.html#t:Of" title="Data.Functor.Of">Of</a> (<a href="../base/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Cardano-TxGenerator-Types.html#t:TxGenError" title="Cardano.TxGenerator.Types">TxGenError</a> (<a href="../cardano-api/Cardano-Api-Tx-Internal-Sign.html#t:Tx" title="Cardano.Api.Tx.Internal.Sign">Tx</a> era))) m ()</li><li class="src short"><a href="#v:createAndStore">createAndStore</a> :: <a href="Cardano-TxGenerator-UTxO.html#t:ToUTxO" title="Cardano.TxGenerator.UTxO">ToUTxO</a> era -&gt; (<a href="Cardano-TxGenerator-Fund.html#t:Fund" title="Cardano.TxGenerator.Fund">Fund</a> -&gt; m ()) -&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a> m era</li><li class="src short"><a href="#v:initWallet">initWallet</a> :: <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a></li><li class="src short"><a href="#v:askWalletRef">askWalletRef</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; (<a href="Cardano-TxGenerator-FundQueue.html#t:FundQueue" title="Cardano.TxGenerator.FundQueue">FundQueue</a> -&gt; a) -&gt; <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> a</li><li class="src short"><a href="#v:walletRefInsertFund">walletRefInsertFund</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="Cardano-TxGenerator-Fund.html#t:Fund" title="Cardano.TxGenerator.Fund">Fund</a> -&gt; <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:mkWalletFundStoreList">mkWalletFundStoreList</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="Cardano-TxGenerator-Types.html#t:FundToStoreList" title="Cardano.TxGenerator.Types">FundToStoreList</a> <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a></li><li class="src short"><a href="#v:mkWalletFundStore">mkWalletFundStore</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="Cardano-TxGenerator-Types.html#t:FundToStore" title="Cardano.TxGenerator.Types">FundToStore</a> <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a></li><li class="src short"><a href="#v:walletSource">walletSource</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="../base/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Cardano-TxGenerator-Types.html#t:FundSource" title="Cardano.TxGenerator.Types">FundSource</a> <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a></li><li class="src short"><a href="#v:walletPreview">walletPreview</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="../base/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="Cardano-TxGenerator-Fund.html#t:Fund" title="Cardano.TxGenerator.Fund">Fund</a>]</li><li class="src short"><a href="#v:mangleWithChange">mangleWithChange</a> :: <a href="../base/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a> m era -&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a> m era -&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStoreList" title="Cardano.TxGenerator.Tx">CreateAndStoreList</a> m era <a href="Cardano-TxGenerator-Types.html#t:PayWithChange" title="Cardano.TxGenerator.Types">PayWithChange</a></li><li class="src short"><a href="#v:mangle">mangle</a> :: <a href="../base/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; [<a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a> m era] -&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStoreList" title="Cardano.TxGenerator.Tx">CreateAndStoreList</a> m era [<a href="../cardano-api/Cardano-Api-Ledger-Internal-Reexport.html#t:Coin" title="Cardano.Api.Ledger.Internal.Reexport">Coin</a>]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:WalletRef" class="def">WalletRef</a> = <a href="../base/Control-Concurrent-MVar.html#t:MVar" title="Control.Concurrent.MVar">MVar</a> <a href="Cardano-TxGenerator-FundQueue.html#t:FundQueue" title="Cardano.TxGenerator.FundQueue">FundQueue</a> <a href="src/Cardano.Benchmarking.Wallet.html#WalletRef" class="link">Source</a> <a href="#t:WalletRef" class="selflink">#</a></p><div class="doc"><p>All the actual functionality of Wallet / WalletRef has been removed
 and WalletRef has been stripped down to MVar FundQueue.
 The implementation of Wallet has become trivial.
 Todo: Remove trivial wrapper functions.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TxStream" class="def">TxStream</a> m era = <a href="../streaming/Streaming-Internal.html#t:Stream" title="Streaming.Internal">Stream</a> (<a href="../streaming/Data-Functor-Of.html#t:Of" title="Data.Functor.Of">Of</a> (<a href="../base/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Cardano-TxGenerator-Types.html#t:TxGenError" title="Cardano.TxGenerator.Types">TxGenError</a> (<a href="../cardano-api/Cardano-Api-Tx-Internal-Sign.html#t:Tx" title="Cardano.Api.Tx.Internal.Sign">Tx</a> era))) m () <a href="src/Cardano.Benchmarking.Wallet.html#TxStream" class="link">Source</a> <a href="#t:TxStream" class="selflink">#</a></p><div class="doc"><p>'ToUTxOList era' is more powerful than '[ ToUTxO era ]' but
 '[ ToUTxO era ]` is easier to construct.
 There is also a thought that a <code><a href="Control-Monad-Error.html#v:MonadError" title="Control.Monad.Error">MonadError</a></code>
 might fit here, but that's a deprecated interface relative to
 <code><a href="../transformers/Control-Monad-Trans-Except.html#v:ExceptT" title="Control.Monad.Trans.Except">ExceptT</a></code>:
 <code>
 type TxStream m era = Stream (Of (Tx era)) m (Maybe TxGenError)
 </code></p></div></div><div class="top"><p class="src"><a id="v:createAndStore" class="def">createAndStore</a> :: <a href="Cardano-TxGenerator-UTxO.html#t:ToUTxO" title="Cardano.TxGenerator.UTxO">ToUTxO</a> era -&gt; (<a href="Cardano-TxGenerator-Fund.html#t:Fund" title="Cardano.TxGenerator.Fund">Fund</a> -&gt; m ()) -&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a> m era <a href="src/Cardano.Benchmarking.Wallet.html#createAndStore" class="link">Source</a> <a href="#v:createAndStore" class="selflink">#</a></p><div class="doc"><p><code><a href="Cardano-Benchmarking-Wallet.html#v:createAndStore" title="Cardano.Benchmarking.Wallet">createAndStore</a></code> hides its 3rd argument in the <code><a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a></code>
 type alias. The sole uses are in <a href="Cardano-Benchmarking-Script-Core.html">Cardano.Benchmarking.Script.Core</a>,
 in <code><a href="Cardano-Benchmarking-Script-Core.html#v:interpretPayMode" title="Cardano.Benchmarking.Script.Core">interpretPayMode</a></code>. The 2nd
 <code>store</code> argument is always passed as <code><a href="Cardano-Benchmarking-Wallet.html#v:mkWalletFundStore" title="Cardano.Benchmarking.Wallet">mkWalletFundStore</a></code> applied
 to a <code><a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:initWallet" class="def">initWallet</a> :: <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> <a href="src/Cardano.Benchmarking.Wallet.html#initWallet" class="link">Source</a> <a href="#v:initWallet" class="selflink">#</a></p><div class="doc"><p>This creates a new <code><a href="../base/Control-Concurrent-MVar.html#t:MVar" title="Control.Concurrent.MVar">MVar</a></code> with an <code><a href="Cardano-TxGenerator-FundQueue.html#v:emptyFundQueue" title="Cardano.TxGenerator.FundQueue">emptyFundQueue</a></code> vs. truly
 initializing a preexisting <code><a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:askWalletRef" class="def">askWalletRef</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; (<a href="Cardano-TxGenerator-FundQueue.html#t:FundQueue" title="Cardano.TxGenerator.FundQueue">FundQueue</a> -&gt; a) -&gt; <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> a <a href="src/Cardano.Benchmarking.Wallet.html#askWalletRef" class="link">Source</a> <a href="#v:askWalletRef" class="selflink">#</a></p><div class="doc"><p>This reads an <code><a href="../base/Control-Concurrent-MVar.html#t:MVar" title="Control.Concurrent.MVar">MVar</a></code> and applies a function to the copied content.</p></div></div><div class="top"><p class="src"><a id="v:walletRefInsertFund" class="def">walletRefInsertFund</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="Cardano-TxGenerator-Fund.html#t:Fund" title="Cardano.TxGenerator.Fund">Fund</a> -&gt; <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Cardano.Benchmarking.Wallet.html#walletRefInsertFund" class="link">Source</a> <a href="#v:walletRefInsertFund" class="selflink">#</a></p><div class="doc"><p>This does an insertion into the <code><a href="../base/Control-Concurrent-MVar.html#t:MVar" title="Control.Concurrent.MVar">MVar</a></code> contents.</p></div></div><div class="top"><p class="src"><a id="v:mkWalletFundStoreList" class="def">mkWalletFundStoreList</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="Cardano-TxGenerator-Types.html#t:FundToStoreList" title="Cardano.TxGenerator.Types">FundToStoreList</a> <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> <a href="src/Cardano.Benchmarking.Wallet.html#mkWalletFundStoreList" class="link">Source</a> <a href="#v:mkWalletFundStoreList" class="selflink">#</a></p><div class="doc"><p><code><a href="Cardano-Benchmarking-Wallet.html#v:mkWalletFundStoreList" title="Cardano.Benchmarking.Wallet">mkWalletFundStoreList</a></code> hides its second argument in
 <code><a href="Cardano-TxGenerator-Types.html#t:FundToStoreList" title="Cardano.TxGenerator.Types">FundToStoreList</a></code>. This is not used anywhere.</p></div></div><div class="top"><p class="src"><a id="v:mkWalletFundStore" class="def">mkWalletFundStore</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="Cardano-TxGenerator-Types.html#t:FundToStore" title="Cardano.TxGenerator.Types">FundToStore</a> <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> <a href="src/Cardano.Benchmarking.Wallet.html#mkWalletFundStore" class="link">Source</a> <a href="#v:mkWalletFundStore" class="selflink">#</a></p><div class="doc"><p><code><a href="Cardano-Benchmarking-Wallet.html#v:mkWalletFundStore" title="Cardano.Benchmarking.Wallet">mkWalletFundStore</a></code> hides its second argument in <code><a href="Cardano-TxGenerator-Types.html#t:FundToStore" title="Cardano.TxGenerator.Types">FundToStore</a></code>.
 This is only ever called in tandem with <code><a href="Cardano-Benchmarking-Wallet.html#v:createAndStore" title="Cardano.Benchmarking.Wallet">createAndStore</a></code> in
 <code><a href="Cardano-Benchmarking-Script-Core.html#v:interpretPayMode" title="Cardano.Benchmarking.Script.Core">interpretPayMode</a></code>. It's only
 ever partially applied to make a function that modifies the
 <code><a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a></code> <code><a href="../base/Control-Concurrent-MVar.html#t:MVar" title="Control.Concurrent.MVar">MVar</a></code> by side effect.</p></div></div><div class="top"><p class="src"><a id="v:walletSource" class="def">walletSource</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="../base/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Cardano-TxGenerator-Types.html#t:FundSource" title="Cardano.TxGenerator.Types">FundSource</a> <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> <a href="src/Cardano.Benchmarking.Wallet.html#walletSource" class="link">Source</a> <a href="#v:walletSource" class="selflink">#</a></p><div class="doc"><p><code><a href="Cardano-Benchmarking-Wallet.html#v:walletSource" title="Cardano.Benchmarking.Wallet">walletSource</a></code> is only ever used in
 <code><a href="Cardano-Benchmarking-Script-Core.html#v:evalGenerator" title="Cardano.Benchmarking.Script.Core">evalGenerator</a></code> to pass
 to <code><a href="Cardano-TxGenerator-Tx.html#v:sourceToStoreTransaction" title="Cardano.TxGenerator.Tx">sourceToStoreTransaction</a></code> and
 its associated functions.</p></div></div><div class="top"><p class="src"><a id="v:walletPreview" class="def">walletPreview</a> :: <a href="Cardano-Benchmarking-Wallet.html#t:WalletRef" title="Cardano.Benchmarking.Wallet">WalletRef</a> -&gt; <a href="../base/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="Cardano-TxGenerator-Fund.html#t:Fund" title="Cardano.TxGenerator.Fund">Fund</a>] <a href="src/Cardano.Benchmarking.Wallet.html#walletPreview" class="link">Source</a> <a href="#v:walletPreview" class="selflink">#</a></p><div class="doc"><p>Just a preview of the wallet's funds; wallet remains unmodified.</p></div></div><div class="top"><p class="src"><a id="v:mangleWithChange" class="def">mangleWithChange</a> :: <a href="../base/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a> m era -&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a> m era -&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStoreList" title="Cardano.TxGenerator.Tx">CreateAndStoreList</a> m era <a href="Cardano-TxGenerator-Types.html#t:PayWithChange" title="Cardano.TxGenerator.Types">PayWithChange</a> <a href="src/Cardano.Benchmarking.Wallet.html#mangleWithChange" class="link">Source</a> <a href="#v:mangleWithChange" class="selflink">#</a></p><div class="doc"><p>The second argument to <code><a href="Cardano-Benchmarking-Wallet.html#v:mangleWithChange" title="Cardano.Benchmarking.Wallet">mangleWithChange</a></code> is hidden in the
 <code><a href="Cardano-TxGenerator-Tx.html#t:CreateAndStoreList" title="Cardano.TxGenerator.Tx">CreateAndStoreList</a></code> type. When there is change to be made,
 it makes separate transactions to pay the change and sends
 them off to <code><a href="Cardano-Benchmarking-Wallet.html#v:mangle" title="Cardano.Benchmarking.Wallet">mangle</a></code> to get zips of applications. This is
 only ever used once, in
 <code><a href="Cardano-Benchmarking-Script-Core.html#v:evalGenerator" title="Cardano.Benchmarking.Script.Core">evalGenerator</a></code> for the
 <code><a href="Cardano-Benchmarking-Script-Types.html#v:Split" title="Cardano.Benchmarking.Script.Types">Split</a></code> case.</p></div></div><div class="doc"><p>zipWith3 (x y z -&gt; second ($ z) (x y))<code>
 but relatively obfuscated.
 This appears to mostly be list processing and function application.
 and is only ever used by <code><a href="Cardano-Bencharking-Script-Core.html#v:evalGenerator" title="Cardano.Bencharking.Script.Core">evalGenerator</a></code>
 to handle several of the cases of
 <code><a href="Cardano-Benchmarking-Script-Types.html#v:Generator" title="Cardano.Benchmarking.Script.Types">Generator</a></code>, though it's also
 indirectly invoked via <code><a href="Cardano-Benchmarking-Wallet.html#v:mangleWithChange" title="Cardano.Benchmarking.Wallet">mangleWithChange</a></code> once.
 The only caller not passing a constant list built with <code><a href="../base/GHC-List.html#v:repeat" title="GHC.List">repeat</a></code>
 as the first </code>fkts@ argument is <code><a href="Cardano-Benchmarking-Wallet.html#v:mangleWithChange" title="Cardano.Benchmarking.Wallet">mangleWithChange</a></code> above. This
 is likely worth refactoring for the sake of maintainability.</p></div><div class="top"><p class="src"><a id="v:mangle" class="def">mangle</a> :: <a href="../base/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; [<a href="Cardano-TxGenerator-Tx.html#t:CreateAndStore" title="Cardano.TxGenerator.Tx">CreateAndStore</a> m era] -&gt; <a href="Cardano-TxGenerator-Tx.html#t:CreateAndStoreList" title="Cardano.TxGenerator.Tx">CreateAndStoreList</a> m era [<a href="../cardano-api/Cardano-Api-Ledger-Internal-Reexport.html#t:Coin" title="Cardano.Api.Ledger.Internal.Reexport">Coin</a>] <a href="src/Cardano.Benchmarking.Wallet.html#mangle" class="link">Source</a> <a href="#v:mangle" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>