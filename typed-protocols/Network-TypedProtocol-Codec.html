<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Network.TypedProtocol.Codec</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">typed-protocols-0.3.0.0: A framework for strongly typed protocols</span><ul class="links" id="page-menu"><li><a href="src/Network.TypedProtocol.Codec.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Network.TypedProtocol.Codec</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Defining and using Codecs</a><ul><li><a href="#g:2">Codec type</a></li><li><a href="#g:3">Incremental decoding</a></li><li><a href="#g:4">Related types</a><ul><li><a href="#g:5">SomeMessage</a></li><li><a href="#g:6">StateToken</a></li><li><a href="#g:7">ActiveState</a></li><li><a href="#g:8">PeerRole</a></li></ul></li></ul></li><li><a href="#g:9">CodecFailure</a></li><li><a href="#g:10">Testing codec properties</a></li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Codec">Codec</a> ps failure m bytes = <a href="#v:Codec">Codec</a> {<ul class="subs"><li><a href="#v:encode">encode</a> :: <span class="keyword">forall</span> (st :: ps) (st' :: ps). <a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st =&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; bytes</li><li><a href="#v:decode">decode</a> :: <span class="keyword">forall</span> (st :: ps). <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st -&gt; m (<a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m (<a href="Network-TypedProtocol-Codec.html#t:SomeMessage" title="Network.TypedProtocol.Codec">SomeMessage</a> st))</li></ul>}</li><li class="src short"><a href="#v:hoistCodec">hoistCodec</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> n =&gt; (<span class="keyword">forall</span> x. m x -&gt; n x) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure n bytes</li><li class="src short"><a href="#v:isoCodec">isoCodec</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; (bytes -&gt; bytes') -&gt; (bytes' -&gt; bytes) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes'</li><li class="src short"><a href="#v:mapFailureCodec">mapFailureCodec</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; (failure -&gt; failure') -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure' m bytes</li><li class="src short"><span class="keyword">data</span> <a href="#t:DecodeStep">DecodeStep</a> bytes failure m a<ul class="subs"><li>= <a href="#v:DecodePartial">DecodePartial</a> (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> bytes -&gt; m (<a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a))</li><li>| <a href="#v:DecodeDone">DecodeDone</a> a (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> bytes)</li><li>| <a href="#v:DecodeFail">DecodeFail</a> failure</li></ul></li><li class="src short"><a href="#v:runDecoder">runDecoder</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; [bytes] -&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a -&gt; m (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> failure a)</li><li class="src short"><a href="#v:runDecoderPure">runDecoderPure</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (<span class="keyword">forall</span> b. m b -&gt; b) -&gt; m (<a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a) -&gt; [bytes] -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> failure a</li><li class="src short"><a href="#v:hoistDecodeStep">hoistDecodeStep</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> n =&gt; (<span class="keyword">forall</span> x. m x -&gt; n x) -&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a -&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure n a</li><li class="src short"><a href="#v:isoDecodeStep">isoDecodeStep</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; (bytes -&gt; bytes') -&gt; (bytes' -&gt; bytes) -&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a -&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes' failure m a</li><li class="src short"><a href="#v:mapFailureDecodeStep">mapFailureDecodeStep</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; (failure -&gt; failure') -&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a -&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure' m a</li><li class="src short"><span class="keyword">data</span> <a href="#t:SomeMessage">SomeMessage</a> (st :: ps) <span class="keyword">where</span><ul class="subs"><li><a href="#v:SomeMessage">SomeMessage</a> :: (<a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st, <a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st', <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st) =&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Codec.html#t:SomeMessage" title="Network.TypedProtocol.Codec">SomeMessage</a> st</li></ul></li><li class="src short"><span class="keyword">type family</span> <a href="#t:StateToken">StateToken</a> :: ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Kind.html#t:Type" title="Data.Kind">Type</a></li><li class="src short"><span class="keyword">class</span> <a href="#t:StateTokenI">StateTokenI</a> st <span class="keyword">where</span><ul class="subs"><li><a href="#v:stateToken">stateToken</a> :: <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st</li></ul></li><li class="src short"><span class="keyword">class</span> <a href="#t:IsActiveState">IsActiveState</a> st (agency :: <a href="Network-TypedProtocol-Core.html#t:Agency" title="Network.TypedProtocol.Core">Agency</a>) <span class="keyword">where</span><ul class="subs"><li><a href="#v:activeAgency">activeAgency</a> :: <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st agency</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:ActiveState">ActiveState</a> st = <a href="Network-TypedProtocol-Codec.html#t:IsActiveState" title="Network.TypedProtocol.Codec">IsActiveState</a> st (<a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st)</li><li class="src short"><span class="keyword">type</span> <a href="#t:ActiveAgency">ActiveAgency</a> st = <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st (<a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st)</li><li class="src short"><span class="keyword">data</span> <a href="#t:ActiveAgency-39-">ActiveAgency'</a> st agency <span class="keyword">where</span><ul class="subs"><li><a href="#v:ClientHasAgency">ClientHasAgency</a> :: <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#v:ClientAgency" title="Network.TypedProtocol.Core">ClientAgency</a> =&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st <a href="Network-TypedProtocol-Core.html#v:ClientAgency" title="Network.TypedProtocol.Core">ClientAgency</a></li><li><a href="#v:ServerHasAgency">ServerHasAgency</a> :: <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#v:ServerAgency" title="Network.TypedProtocol.Core">ServerAgency</a> =&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st <a href="Network-TypedProtocol-Core.html#v:ServerAgency" title="Network.TypedProtocol.Core">ServerAgency</a></li></ul></li><li class="src short"><a href="#v:notActiveState">notActiveState</a> :: <span class="keyword">forall</span> ps (st :: ps). <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#v:NobodyAgency" title="Network.TypedProtocol.Core">NobodyAgency</a> =&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st -&gt; <span class="keyword">forall</span> a. a</li><li class="src short"><span class="keyword">data</span> <a href="#t:PeerRole">PeerRole</a><ul class="subs"><li>= <a href="#v:AsClient">AsClient</a></li><li>| <a href="#v:AsServer">AsServer</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:CodecFailure">CodecFailure</a><ul class="subs"><li>= <a href="#v:CodecFailureOutOfInput">CodecFailureOutOfInput</a></li><li>| <a href="#v:CodecFailure">CodecFailure</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:AnyMessage">AnyMessage</a> ps <span class="keyword">where</span><ul class="subs"><li><a href="#v:AnyMessage">AnyMessage</a> :: <span class="keyword">forall</span> ps (st :: ps) (st' :: ps). (<a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st, <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st) =&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps (st :: ps) (st' :: ps) -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps</li><li><span class="keyword">pattern</span> <a href="#v:AnyMessageAndAgency">AnyMessageAndAgency</a> :: <span class="keyword">forall</span> ps. () =&gt; <span class="keyword">forall</span> (st :: ps) (st' :: ps). (<a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st, <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st) =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st -&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps</li></ul></li><li class="src short"><a href="#v:prop_codecM">prop_codecM</a> :: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps)) =&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:prop_codec">prop_codec</a> :: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps)) =&gt; (<span class="keyword">forall</span> a. m a -&gt; a) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:prop_codec_splitsM">prop_codec_splitsM</a> :: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps)) =&gt; (bytes -&gt; [[bytes]]) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:prop_codec_splits">prop_codec_splits</a> :: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps)) =&gt; (bytes -&gt; [[bytes]]) -&gt; (<span class="keyword">forall</span> a. m a -&gt; a) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:prop_codec_binary_compatM">prop_codec_binary_compatM</a> :: <span class="keyword">forall</span> psA psB failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> psA)) =&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> psA failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> psB failure m bytes -&gt; (<span class="keyword">forall</span> (stA :: psA). <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> stA =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> stA -&gt; <a href="Network-TypedProtocol-Codec.html#t:SomeState" title="Network.TypedProtocol.Codec">SomeState</a> psB) -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> psA -&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:prop_codec_binary_compat">prop_codec_binary_compat</a> :: <span class="keyword">forall</span> psA psB failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> psA)) =&gt; (<span class="keyword">forall</span> a. m a -&gt; a) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> psA failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> psB failure m bytes -&gt; (<span class="keyword">forall</span> (stA :: psA). <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> stA -&gt; <a href="Network-TypedProtocol-Codec.html#t:SomeState" title="Network.TypedProtocol.Codec">SomeState</a> psB) -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> psA -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:prop_codecs_compatM">prop_codecs_compatM</a> :: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps), <span class="keyword">forall</span> a. <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> (m a)) =&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:prop_codecs_compat">prop_codecs_compat</a> :: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps), <span class="keyword">forall</span> a. <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> (m a)) =&gt; (<span class="keyword">forall</span> a. m a -&gt; a) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:SomeState">SomeState</a> (ps :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <span class="keyword">where</span><ul class="subs"><li><a href="#v:SomeState">SomeState</a> :: <span class="keyword">forall</span> ps (st :: ps). <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st -&gt; <a href="Network-TypedProtocol-Codec.html#t:SomeState" title="Network.TypedProtocol.Codec">SomeState</a> ps</li></ul></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Defining and using Codecs</h1></a><a href="#g:2" id="g:2"><h2>Codec type</h2></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Codec" class="def">Codec</a> ps failure m bytes <a href="src/Network.TypedProtocol.Codec.html#Codec" class="link">Source</a> <a href="#t:Codec" class="selflink">#</a></p><div class="doc"><p>A codec for a <code><a href="Network-TypedProtocol-Core.html#t:Protocol" title="Network.TypedProtocol.Core">Protocol</a></code> handles the encoding and decoding of typed
 protocol messages. This is typically used when sending protocol messages
 over untyped channels. The codec chooses the exact encoding, for example
 encoding in some text-based syntax, or some choice of binary format.</p><p>The codec is parametrised by:</p><ul><li>The protocol</li><li>the type of decoding failures</li><li>the monad in which the decoder runs</li><li>the type of the encoded data (typically strings or bytes)</li></ul><p>A codec consists of a message encoder and a decoder.</p><p>The encoder is supplied both with the message to encode and the current
 protocol state (matching the message). The protocol state can be either
 a client or server state, but for either peer role it is a protocol state
 in which the peer has agency, since those are the only states where a
 peer needs to encode a message to be able to send it.</p><p>For example a simple text encoder for the ping/pong protocol could be:</p><pre>encode :: SingI st
       =&gt; Message PingPong st st'
       -&gt; String
encode MsgPing = &quot;ping\n&quot;
encode MsgDone = &quot;done\n&quot;
encode MsgPong = &quot;pong\n&quot;</pre><p>The decoder is also given the current protocol state and it is expected to
 be able to decode <em>any</em> message that is valid in that state, but <em>only</em>
 messages that are valid in that state. Messages that are unexpected for the
 current state should be treated like any other decoding format error.</p><p>While the current protocol state is known, the state that the message will
 have the peer transition to is not known. For this reason the decoded
 message is wrapped in the <code><a href="Network-TypedProtocol-Codec.html#t:SomeMessage" title="Network.TypedProtocol.Codec">SomeMessage</a></code> constructor which hides the &quot;to&quot;
 state.</p><p>The decoder uses an incremental decoding interface <code><a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a></code> so that
 input can be supplied (e.g. from a Channel) bit by bit. This style of
 decoder allows but does not require a format with message framing where the
 decoder input matches exactly with the message boundaries.</p><pre>decode :: forall st m. SingI st
       =&gt; StateToken st
       -&gt; m (DecodeStep String String m (SomeMessage st))
decode stok =
  decodeTerminatedFrame '\n' $ \str trailing -&gt;
    case (stok, str) of
      (SingBusy, &quot;pong&quot;) -&gt;
           DecodeDone (SomeMessage MsgPong) trailing
      (SingIdle, &quot;ping&quot;) -&gt;
           DecodeDone (SomeMessage MsgPing) trailing
      (SingIdle, &quot;done&quot;) -&gt;
           DecodeDone (SomeMessage MsgDone) trailing
      _ -&gt; DecodeFail (&quot;unexpected message: &quot; ++ str)</pre><p>See &quot;typed-protocols-examples&quot; for the full example.</p><p>Note that the pattern matching on the combination of the message string and
 the protocol state. This neatly fulfils the requirement that we only return
 messages that are of the correct type for the given protocol state.</p><p>This toy example format uses newlines <code>n</code> as a framing format. See
 <code><a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a></code> for suggestions on how to use it for more realistic formats.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Codec" class="def">Codec</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:encode" class="def">encode</a> :: <span class="keyword">forall</span> (st :: ps) (st' :: ps). <a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st =&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; bytes</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:decode" class="def">decode</a> :: <span class="keyword">forall</span> (st :: ps). <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st -&gt; m (<a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m (<a href="Network-TypedProtocol-Codec.html#t:SomeMessage" title="Network.TypedProtocol.Codec">SomeMessage</a> st))</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:hoistCodec" class="def">hoistCodec</a> <a href="src/Network.TypedProtocol.Codec.html#hoistCodec" class="link">Source</a> <a href="#v:hoistCodec" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<span class="keyword">forall</span> x. m x -&gt; n x)</td><td class="doc"><p>a natural transformation</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure n bytes</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Change functor in which the codec is running.</p></div></div><div class="top"><p class="src"><a id="v:isoCodec" class="def">isoCodec</a> <a href="src/Network.TypedProtocol.Codec.html#isoCodec" class="link">Source</a> <a href="#v:isoCodec" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (bytes -&gt; bytes')</td><td class="doc"><p>map from <code>bytes</code> to <code>bytes'</code></p></td></tr><tr><td class="src">-&gt; (bytes' -&gt; bytes)</td><td class="doc"><p>its inverse</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes</td><td class="doc"><p>codec</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes'</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Change bytes of a codec.</p></div></div><div class="top"><p class="src"><a id="v:mapFailureCodec" class="def">mapFailureCodec</a> <a href="src/Network.TypedProtocol.Codec.html#mapFailureCodec" class="link">Source</a> <a href="#v:mapFailureCodec" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (failure -&gt; failure')</td><td class="doc"><p>a function to apply to failure</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure' m bytes</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Modify failure type.</p></div></div><a href="#g:3" id="g:3"><h2>Incremental decoding</h2></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DecodeStep" class="def">DecodeStep</a> bytes failure m a <a href="src/Network.TypedProtocol.Codec.html#DecodeStep" class="link">Source</a> <a href="#t:DecodeStep" class="selflink">#</a></p><div class="doc"><p>An incremental decoder with return a value of type <code>a</code>.</p><p>This interface is not designed to be used directly for implementing
 decoders, only for running them. In real applications it is expected to use
 libraries for text or binary decoding and to implement appropriate wrappers
 to match up with this incremental decoder interface.</p><p>This style of interface already closely matches that provided by libraries
 such as <code>attoparsec</code> for text formats, and <code>binary</code>, <code>cereal</code> and <code>cborg</code>
 for binary formats.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DecodePartial" class="def">DecodePartial</a> (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> bytes -&gt; m (<a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a))</td><td class="doc"><p>The decoder has consumed the available input and needs more
 to continue. Provide <code><code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a></code></code> if more input is available and
 <code><code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#v:Nothing" title="Data.Maybe">Nothing</a></code></code> otherwise, and you will get a new <code><code><a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a></code></code>.</p></td></tr><tr><td class="src"><a id="v:DecodeDone" class="def">DecodeDone</a> a (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> bytes)</td><td class="doc"><p>The decoder has successfully finished. This provides the decoded
 result value plus any unused input.</p></td></tr><tr><td class="src"><a id="v:DecodeFail" class="def">DecodeFail</a> failure</td><td class="doc"><p>The decoder ran into an error. The decoder either used
 <code><code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad-Fail.html#v:fail" title="Control.Monad.Fail">fail</a></code></code> or was not provided enough input.</p></td></tr></table></div></div><div class="top"><p class="src"><a id="v:runDecoder" class="def">runDecoder</a> <a href="src/Network.TypedProtocol.Codec.html#runDecoder" class="link">Source</a> <a href="#v:runDecoder" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; [bytes]</td><td class="doc"><p>bytes to be fed into the incremental <code><a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a></code></p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a</td><td class="doc"><p>decoder</p></td></tr><tr><td class="src">-&gt; m (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> failure a)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Run a codec incremental decoder <code><a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a></code> against a list of input.</p><p>It ignores any unused trailing data. This is useful for demos, quick
 experiments and tests.</p><p>See also <code><a href="Network-TypedProtocol-Driver.html#v:runDecoderWithChannel" title="Network.TypedProtocol.Driver">runDecoderWithChannel</a></code></p></div></div><div class="top"><p class="src"><a id="v:runDecoderPure" class="def">runDecoderPure</a> <a href="src/Network.TypedProtocol.Codec.html#runDecoderPure" class="link">Source</a> <a href="#v:runDecoderPure" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<span class="keyword">forall</span> b. m b -&gt; b)</td><td class="doc"><p>run monad <code>m</code> in a pure way, e.g. <code>runIdentity</code></p></td></tr><tr><td class="src">-&gt; m (<a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [bytes]</td><td class="doc"><p>input bytes</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> failure a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A variant of <code><a href="Network-TypedProtocol-Codec.html#v:runDecoder" title="Network.TypedProtocol.Codec">runDecoder</a></code> that is suitable for &quot;pure&quot; monads that have
 a run function. This includes <code>ST</code>, using <code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad-ST.html#v:runST" title="Control.Monad.ST">runST</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:hoistDecodeStep" class="def">hoistDecodeStep</a> <a href="src/Network.TypedProtocol.Codec.html#hoistDecodeStep" class="link">Source</a> <a href="#v:hoistDecodeStep" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<span class="keyword">forall</span> x. m x -&gt; n x)</td><td class="doc"><p>a natural transformation</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure n a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Change functor in which the codec is running.</p></div></div><div class="top"><p class="src"><a id="v:isoDecodeStep" class="def">isoDecodeStep</a> <a href="src/Network.TypedProtocol.Codec.html#isoDecodeStep" class="link">Source</a> <a href="#v:isoDecodeStep" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (bytes -&gt; bytes')</td><td class="doc"><p>map from <code>bytes</code> to <code>bytes'</code></p></td></tr><tr><td class="src">-&gt; (bytes' -&gt; bytes)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes' failure m a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Change bytes of <code><a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:mapFailureDecodeStep" class="def">mapFailureDecodeStep</a> <a href="src/Network.TypedProtocol.Codec.html#mapFailureDecodeStep" class="link">Source</a> <a href="#v:mapFailureDecodeStep" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (failure -&gt; failure')</td><td class="doc"><p>a function to apply to failure</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure m a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:DecodeStep" title="Network.TypedProtocol.Codec">DecodeStep</a> bytes failure' m a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Modify failure type.</p></div></div><a href="#g:4" id="g:4"><h2>Related types</h2></a><a href="#g:5" id="g:5"><h3>SomeMessage</h3></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SomeMessage" class="def">SomeMessage</a> (st :: ps) <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Driver.html#SomeMessage" class="link">Source</a> <a href="#t:SomeMessage" class="selflink">#</a></p><div class="doc"><p>When decoding a <code><a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a></code> we only know the expected &quot;from&quot; state. We
 cannot know the &quot;to&quot; state as this depends on the message we decode. To
 resolve this we use the <code><a href="Network-TypedProtocol-Codec.html#t:SomeMessage" title="Network.TypedProtocol.Codec">SomeMessage</a></code> wrapper which uses an existential
 type to hide the &quot;to&quot; state.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SomeMessage" class="def">SomeMessage</a> :: (<a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st, <a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st', <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st) =&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Codec.html#t:SomeMessage" title="Network.TypedProtocol.Codec">SomeMessage</a> st</td><td class="doc empty">&nbsp;</td></tr></table></div></div><a href="#g:6" id="g:6"><h3>StateToken</h3></a><div class="top"><p class="src"><span class="keyword">type family</span> <a id="t:StateToken" class="def">StateToken</a> :: ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="src/Network.TypedProtocol.Core.html#StateToken" class="link">Source</a> <a href="#t:StateToken" class="selflink">#</a></p><div class="doc"><p>A type family for protocol state token, e.g. term level representation of
 type level state (also known as singleton).</p><p>This type family is similar to <code>Sing</code> type class in the &quot;singletons&quot;
 package, but specific for protocol states.</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:StateTokenI" class="def">StateTokenI</a> st <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Core.html#StateTokenI" class="link">Source</a> <a href="#t:StateTokenI" class="selflink">#</a></p><div class="doc"><p>A type class which hides a state token / singleton inside a class
 dictionary.</p><p>This is similar to the <code>SingI</code> instance, but specific to protocol state
 singletons.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:stateToken" class="def">stateToken</a> :: <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st <a href="src/Network.TypedProtocol.Core.html#stateToken" class="link">Source</a> <a href="#v:stateToken" class="selflink">#</a></p></div></div><a href="#g:7" id="g:7"><h3>ActiveState</h3></a><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:IsActiveState" class="def">IsActiveState</a> st (agency :: <a href="Network-TypedProtocol-Core.html#t:Agency" title="Network.TypedProtocol.Core">Agency</a>) <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Core.html#IsActiveState" class="link">Source</a> <a href="#t:IsActiveState" class="selflink">#</a></p><div class="doc"><p>A type class which restricts states to ones that have <code><a href="Network-TypedProtocol-Core.html#v:ClientAgency" title="Network.TypedProtocol.Core">ClientAgency</a></code> or
 <code><a href="Network-TypedProtocol-Core.html#v:ServerAgency" title="Network.TypedProtocol.Core">ServerAgency</a></code>, excluding <code><a href="Network-TypedProtocol-Core.html#v:NobodyAgency" title="Network.TypedProtocol.Core">NobodyAgency</a></code>.</p><p>One can use <code>notActive</code> to eliminate cases for which both <code><code><a href="Network-TypedProtocol-Codec.html#t:IsActiveState" title="Network.TypedProtocol.Codec">IsActiveState</a></code>
 st</code> is in scope and for which we have an evidence that the state is not
 active (i.e. a singleton).  This is useful when writing a <code>Codec</code>.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:activeAgency" class="def">activeAgency</a> :: <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st agency <a href="src/Network.TypedProtocol.Core.html#activeAgency" class="link">Source</a> <a href="#v:activeAgency" class="selflink">#</a></p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:IsActiveState">Instances</h4><details id="i:IsActiveState" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:IsActiveState:IsActiveState:1"></span> '<a href="Network-TypedProtocol-Core.html#v:ClientAgency" title="Network.TypedProtocol.Core">ClientAgency</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:IsActiveState" title="Network.TypedProtocol.Codec">IsActiveState</a> (st :: ps) '<a href="Network-TypedProtocol-Core.html#v:ClientAgency" title="Network.TypedProtocol.Core">ClientAgency</a></span> <a href="src/Network.TypedProtocol.Core.html#line-461" class="link">Source</a> <a href="#t:IsActiveState" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:IsActiveState:IsActiveState:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Core.html">Network.TypedProtocol.Core</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:activeAgency">activeAgency</a> :: <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st '<a href="Network-TypedProtocol-Core.html#v:ClientAgency" title="Network.TypedProtocol.Core">ClientAgency</a> <a href="src/Network.TypedProtocol.Core.html#activeAgency" class="link">Source</a> <a href="#v:activeAgency" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:IsActiveState:IsActiveState:2"></span> '<a href="Network-TypedProtocol-Core.html#v:ServerAgency" title="Network.TypedProtocol.Core">ServerAgency</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:IsActiveState" title="Network.TypedProtocol.Codec">IsActiveState</a> (st :: ps) '<a href="Network-TypedProtocol-Core.html#v:ServerAgency" title="Network.TypedProtocol.Core">ServerAgency</a></span> <a href="src/Network.TypedProtocol.Core.html#line-464" class="link">Source</a> <a href="#t:IsActiveState" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:IsActiveState:IsActiveState:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Core.html">Network.TypedProtocol.Core</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:activeAgency">activeAgency</a> :: <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st '<a href="Network-TypedProtocol-Core.html#v:ServerAgency" title="Network.TypedProtocol.Core">ServerAgency</a> <a href="src/Network.TypedProtocol.Core.html#activeAgency" class="link">Source</a> <a href="#v:activeAgency" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ActiveState" class="def">ActiveState</a> st = <a href="Network-TypedProtocol-Codec.html#t:IsActiveState" title="Network.TypedProtocol.Codec">IsActiveState</a> st (<a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st) <a href="src/Network.TypedProtocol.Core.html#ActiveState" class="link">Source</a> <a href="#t:ActiveState" class="selflink">#</a></p><div class="doc"><p>A constraint which provides an evidence that the protocol isn't in
 a terminal state.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ActiveAgency" class="def">ActiveAgency</a> st = <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st (<a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st) <a href="src/Network.TypedProtocol.Core.html#ActiveAgency" class="link">Source</a> <a href="#t:ActiveAgency" class="selflink">#</a></p><div class="doc"><p>Evidence that the protocol isn't in a terminal state.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ActiveAgency-39-" class="def">ActiveAgency'</a> st agency <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Core.html#ActiveAgency%27" class="link">Source</a> <a href="#t:ActiveAgency-39-" class="selflink">#</a></p><div class="doc"><p>Evidence that one side of the protocol has the agency, and thus that the
 protocol hasn't yet terminated.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ClientHasAgency" class="def">ClientHasAgency</a> :: <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#v:ClientAgency" title="Network.TypedProtocol.Core">ClientAgency</a> =&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st <a href="Network-TypedProtocol-Core.html#v:ClientAgency" title="Network.TypedProtocol.Core">ClientAgency</a></td><td class="doc"><p>Evidence that the client has the agency.</p></td></tr><tr><td class="src"><a id="v:ServerHasAgency" class="def">ServerHasAgency</a> :: <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#v:ServerAgency" title="Network.TypedProtocol.Core">ServerAgency</a> =&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st <a href="Network-TypedProtocol-Core.html#v:ServerAgency" title="Network.TypedProtocol.Core">ServerAgency</a></td><td class="doc"><p>Evidence that the server has the agency.</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ActiveAgency-39-">Instances</h4><details id="i:ActiveAgency-39-" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ActiveAgency-39-:Show:1"></span> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st agency)</span> <a href="src/Network.TypedProtocol.Core.html#line-443" class="link">Source</a> <a href="#t:ActiveAgency-39-" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ActiveAgency-39-:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Core.html">Network.TypedProtocol.Core</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st agency -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st agency -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Network-TypedProtocol-Codec.html#t:ActiveAgency-39-" title="Network.TypedProtocol.Codec">ActiveAgency'</a> st agency] -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:notActiveState" class="def">notActiveState</a> :: <span class="keyword">forall</span> ps (st :: ps). <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#v:NobodyAgency" title="Network.TypedProtocol.Core">NobodyAgency</a> =&gt; <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st -&gt; <span class="keyword">forall</span> a. a <a href="src/Network.TypedProtocol.Core.html#notActiveState" class="link">Source</a> <a href="#v:notActiveState" class="selflink">#</a></p><div class="doc"><p>This is useful function to eliminate cases where the `ActiveState st` is
 provided but we are given a state in which neither side has agency
 (<code><a href="Network-TypedProtocol-Core.html#v:NobodyAgency" title="Network.TypedProtocol.Core">NobodyAgency</a></code>).  For example when writing a codec, we only need to encode
 / decode messages which are in active states, but to make such functions
 total, <code><a href="Network-TypedProtocol-Codec.html#v:notActiveState" title="Network.TypedProtocol.Codec">notActiveState</a></code> needs to be used to eliminate the states in which
 nobody has agency.</p><p>A good analogy for this function is <code><code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Void.html#v:absurd" title="Data.Void">absurd</a></code> :: <code>Void</code> -&gt; a</code>.</p></div></div><a href="#g:8" id="g:8"><h3>PeerRole</h3></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:PeerRole" class="def">PeerRole</a> <a href="src/Network.TypedProtocol.Core.html#PeerRole" class="link">Source</a> <a href="#t:PeerRole" class="selflink">#</a></p><div class="doc"><p>Types for client and server peer roles. As protocol can be viewed from
 either client or server side.</p><p>Note that technically &quot;client&quot; and &quot;server&quot; are arbitrary labels. The
 framework is completely symmetric between the two peers.</p><p>This definition is only used as promoted types and kinds, never as values.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:AsClient" class="def">AsClient</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:AsServer" class="def">AsServer</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:PeerRole">Instances</h4><details id="i:PeerRole" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PeerRole:SingI:1"></span> SingI '<a href="Network-TypedProtocol-Codec.html#v:AsClient" title="Network.TypedProtocol.Codec">AsClient</a></span> <a href="src/Network.TypedProtocol.Core.html#line-234" class="link">Source</a> <a href="#t:PeerRole" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PeerRole:SingI:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Core.html">Network.TypedProtocol.Core</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:sing">sing</a> :: Sing '<a href="Network-TypedProtocol-Codec.html#v:AsClient" title="Network.TypedProtocol.Codec">AsClient</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PeerRole:SingI:2"></span> SingI '<a href="Network-TypedProtocol-Codec.html#v:AsServer" title="Network.TypedProtocol.Codec">AsServer</a></span> <a href="src/Network.TypedProtocol.Core.html#line-236" class="link">Source</a> <a href="#t:PeerRole" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PeerRole:SingI:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Core.html">Network.TypedProtocol.Core</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:sing">sing</a> :: Sing '<a href="Network-TypedProtocol-Codec.html#v:AsServer" title="Network.TypedProtocol.Codec">AsServer</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PeerRole:Sing:3"></span> <span class="keyword">type</span> Sing</span> <a href="src/Network.TypedProtocol.Core.html#line-233" class="link">Source</a> <a href="#t:PeerRole" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PeerRole:Sing:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Core.html">Network.TypedProtocol.Core</a></p> <div class="src"><span class="keyword">type</span> Sing = <a href="Network-TypedProtocol-Core.html#t:SingPeerRole" title="Network.TypedProtocol.Core">SingPeerRole</a></div></details></td></tr></table></details></div></div><a href="#g:9" id="g:9"><h1>CodecFailure</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:CodecFailure" class="def">CodecFailure</a> <a href="src/Network.TypedProtocol.Codec.html#CodecFailure" class="link">Source</a> <a href="#t:CodecFailure" class="selflink">#</a></p><div class="doc"><p>Each <code><a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a></code> can use whatever <code>failure</code> type is appropriate. This simple
 exception type is provided for use by simple codecs (e.g. &quot;identity&quot;) when
 nothing more than a <code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></code> is needed. It is an instance of <code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Exception-Base.html#t:Exception" title="Control.Exception.Base">Exception</a></code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CodecFailureOutOfInput" class="def">CodecFailureOutOfInput</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:CodecFailure" class="def">CodecFailure</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:CodecFailure">Instances</h4><details id="i:CodecFailure" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CodecFailure:Exception:1"></span> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Exception-Base.html#t:Exception" title="Control.Exception.Base">Exception</a> <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a></span> <a href="src/Network.TypedProtocol.Codec.html#line-272" class="link">Source</a> <a href="#t:CodecFailure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CodecFailure:Exception:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Codec.html">Network.TypedProtocol.Codec</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toException">toException</a> :: <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:toException" class="selflink">#</a></p><p class="src"><a href="#v:fromException">fromException</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:fromException" class="selflink">#</a></p><p class="src"><a href="#v:displayException">displayException</a> :: <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:displayException" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CodecFailure:Show:2"></span> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a></span> <a href="src/Network.TypedProtocol.Codec.html#line-269" class="link">Source</a> <a href="#t:CodecFailure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CodecFailure:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Codec.html">Network.TypedProtocol.Codec</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a>] -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CodecFailure:Eq:3"></span> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a></span> <a href="src/Network.TypedProtocol.Codec.html#line-269" class="link">Source</a> <a href="#t:CodecFailure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CodecFailure:Eq:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Codec.html">Network.TypedProtocol.Codec</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> -&gt; <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> -&gt; <a href="Network-TypedProtocol-Codec.html#t:CodecFailure" title="Network.TypedProtocol.Codec">CodecFailure</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:10" id="g:10"><h1>Testing codec properties</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:AnyMessage" class="def">AnyMessage</a> ps <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Codec.html#AnyMessage" class="link">Source</a> <a href="#t:AnyMessage" class="selflink">#</a></p><div class="doc"><p>Any message for a protocol, with a <code><a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a></code> constraint which gives access to
 protocol state.</p><p>Used where we don't know statically what the state type is, but need the
 agency and message to match each other.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:AnyMessage" class="def">AnyMessage</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: <span class="keyword">forall</span> ps (st :: ps) (st' :: ps). (<a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st, <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">=&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps (st :: ps) (st' :: ps)</dfn><div class="doc"><p><code><a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a></code> between some states</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs bundled-patterns"><p class="caption">Bundled Patterns</p><table><tr><td class="src"><span class="keyword">pattern</span> <a id="v:AnyMessageAndAgency" class="def">AnyMessageAndAgency</a> :: <span class="keyword">forall</span> ps. () =&gt; <span class="keyword">forall</span> (st :: ps) (st' :: ps). (<a href="Network-TypedProtocol-Codec.html#t:StateTokenI" title="Network.TypedProtocol.Codec">StateTokenI</a> st, <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st) =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st -&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps</td><td class="doc"><p>A convenient pattern synonym which unwrap <code><a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a></code> giving both the
 singleton for the state and the message.</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:AnyMessage">Instances</h4><details id="i:AnyMessage" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:AnyMessage:Show:1"></span> (<span class="keyword">forall</span> (st :: ps) (st' :: ps). <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st')) =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps)</span> <a href="src/Network.TypedProtocol.Codec.html#line-332" class="link">Source</a> <a href="#t:AnyMessage" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:AnyMessage:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Codec.html">Network.TypedProtocol.Codec</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps] -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:prop_codecM" class="def">prop_codecM</a> <a href="src/Network.TypedProtocol.Codec.html#prop_codecM" class="link">Source</a> <a href="#v:prop_codecM" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes</td><td class="doc"><p>codec</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps</td><td class="doc"><p>some message</p></td></tr><tr><td class="src">-&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc"><p>returns <code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#v:True" title="Data.Bool">True</a></code> iff round trip returns the exact same message</p></td></tr></table></div><div class="doc"><p>The <code><a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a></code> round-trip property: decode after encode gives the same
 message. Every codec must satisfy this property.</p></div></div><div class="top"><p class="src"><a id="v:prop_codec" class="def">prop_codec</a> :: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps)) =&gt; (<span class="keyword">forall</span> a. m a -&gt; a) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Network.TypedProtocol.Codec.html#prop_codec" class="link">Source</a> <a href="#v:prop_codec" class="selflink">#</a></p><div class="doc"><p>The <code><a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a></code> round-trip property in a pure monad.</p></div></div><div class="top"><p class="src"><a id="v:prop_codec_splitsM" class="def">prop_codec_splitsM</a> <a href="src/Network.TypedProtocol.Codec.html#prop_codec_splitsM" class="link">Source</a> <a href="#v:prop_codec_splitsM" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (bytes -&gt; [[bytes]])</td><td class="doc"><p>alternative re-chunkings of serialised form</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A variant on the codec round-trip property: given the encoding of a
 message, check that decode always gives the same result irrespective
 of how the chunks of input are fed to the incremental decoder.</p><p>This property guards against boundary errors in incremental decoders.
 It is not necessary to check this for every message type, just for each
 generic codec construction. For example given some binary serialisation
 library one would write a generic adaptor to the codec interface. This
 adaptor has to deal with the incremental decoding and this is what needs
 to be checked.</p></div></div><div class="top"><p class="src"><a id="v:prop_codec_splits" class="def">prop_codec_splits</a> <a href="src/Network.TypedProtocol.Codec.html#prop_codec_splits" class="link">Source</a> <a href="#v:prop_codec_splits" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (bytes -&gt; [[bytes]])</td><td class="doc"><p>alternative re-chunkings of serialised form</p></td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> a. m a -&gt; a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Like <code><code><a href="Network-TypedProtocol-Codec.html#v:prop_codec_splitsM" title="Network.TypedProtocol.Codec">prop_codec_splitsM</a></code></code> but run in a pure monad <code>m</code>, e.g. <code>Identity</code>.</p></div></div><div class="top"><p class="src"><a id="v:prop_codec_binary_compatM" class="def">prop_codec_binary_compatM</a> <a href="src/Network.TypedProtocol.Codec.html#prop_codec_binary_compatM" class="link">Source</a> <a href="#v:prop_codec_binary_compatM" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> psA psB failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> psA))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> psA failure m bytes</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> psB failure m bytes</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> (stA :: psA). <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> stA =&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> stA -&gt; <a href="Network-TypedProtocol-Codec.html#t:SomeState" title="Network.TypedProtocol.Codec">SomeState</a> psB)</td><td class="doc"><p>the states of A map directly to states of B.</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> psA</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Binary compatibility of two protocols</p><p>We check the following property:</p><ol><li value="1">Using codec A, we encode a message of protocol <code>psA</code> to <code>bytes</code>.</li><li value="2">When we decode those <code>bytes</code> using codec B, we get a message of protocol
 <code>ps</code>B.</li><li value="3">When we encode that message again using codec B, we get <code>bytes</code>.</li><li value="4">When we decode those <code>bytes</code> using codec A, we get the original message
 again.</li></ol></div></div><div class="top"><p class="src"><a id="v:prop_codec_binary_compat" class="def">prop_codec_binary_compat</a> <a href="src/Network.TypedProtocol.Codec.html#prop_codec_binary_compat" class="link">Source</a> <a href="#v:prop_codec_binary_compat" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> psA psB failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> psA))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<span class="keyword">forall</span> a. m a -&gt; a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> psA failure m bytes</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> psB failure m bytes</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> (stA :: psA). <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> stA -&gt; <a href="Network-TypedProtocol-Codec.html#t:SomeState" title="Network.TypedProtocol.Codec">SomeState</a> psB)</td><td class="doc"><p>the states of A map directly to states of B.</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> psA</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Like <code><code><a href="Network-TypedProtocol-Codec.html#v:prop_codec_splitsM" title="Network.TypedProtocol.Codec">prop_codec_splitsM</a></code></code> but run in a pure monad <code>m</code>, e.g. <code>Identity</code>.</p></div></div><div class="top"><p class="src"><a id="v:prop_codecs_compatM" class="def">prop_codecs_compatM</a> <a href="src/Network.TypedProtocol.Codec.html#prop_codecs_compatM" class="link">Source</a> <a href="#v:prop_codecs_compatM" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps), <span class="keyword">forall</span> a. <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> (m a))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes</td><td class="doc"><p>first codec</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes</td><td class="doc"><p>second codec</p></td></tr><tr><td class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps</td><td class="doc"><p>some message</p></td></tr><tr><td class="src">-&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Compatibility between two codecs of the same protocol.  Encode a message
 with one codec and decode it with the other one, then compare if the result
 is the same as initial message.</p></div></div><div class="top"><p class="src"><a id="v:prop_codecs_compat" class="def">prop_codecs_compat</a> :: <span class="keyword">forall</span> ps failure m bytes. (<a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps), <span class="keyword">forall</span> a. <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> (m a)) =&gt; (<span class="keyword">forall</span> a. m a -&gt; a) -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:Codec" title="Network.TypedProtocol.Codec">Codec</a> ps failure m bytes -&gt; <a href="Network-TypedProtocol-Codec.html#t:AnyMessage" title="Network.TypedProtocol.Codec">AnyMessage</a> ps -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Network.TypedProtocol.Codec.html#prop_codecs_compat" class="link">Source</a> <a href="#v:prop_codecs_compat" class="selflink">#</a></p><div class="doc"><p>Like <code><code><a href="Network-TypedProtocol-Codec.html#v:prop_codecs_compatM" title="Network.TypedProtocol.Codec">prop_codecs_compatM</a></code></code> but run in a pure monad <code>m</code>, e.g. <code>Identity</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SomeState" class="def">SomeState</a> (ps :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Codec.html#SomeState" class="link">Source</a> <a href="#t:SomeState" class="selflink">#</a></p><div class="doc"><p>Auxiliary definition for <code><a href="Network-TypedProtocol-Codec.html#v:prop_codec_binary_compatM" title="Network.TypedProtocol.Codec">prop_codec_binary_compatM</a></code>.</p><p>Used for the existential <code>st :: ps</code> parameter when expressing that for each
 value of <code>PeerHasAgency</code> for protocol A, there is a corresponding
 <code>PeerHasAgency</code> for protocol B of some <code>st :: ps</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SomeState" class="def">SomeState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: <span class="keyword">forall</span> ps (st :: ps). <a href="Network-TypedProtocol-Codec.html#t:ActiveState" title="Network.TypedProtocol.Codec">ActiveState</a> st</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">=&gt; <a href="Network-TypedProtocol-Codec.html#t:StateToken" title="Network.TypedProtocol.Codec">StateToken</a> st</dfn><div class="doc"><p>state token for some active state <code>st</code></p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Codec.html#t:SomeState" title="Network.TypedProtocol.Codec">SomeState</a> ps</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>