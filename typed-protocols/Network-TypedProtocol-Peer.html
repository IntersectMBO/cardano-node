<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Network.TypedProtocol.Peer</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">typed-protocols-0.3.0.0: A framework for strongly typed protocols</span><ul class="links" id="page-menu"><li><a href="src/Network.TypedProtocol.Peer.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Network.TypedProtocol.Peer</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Protocol EDSL.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Peer">Peer</a> ps pr pl st m a <span class="keyword">where</span><ul class="subs"><li><a href="#v:Effect">Effect</a> :: <span class="keyword">forall</span> ps pr pl st m a. m (<a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a</li><li><a href="#v:Yield">Yield</a> :: <span class="keyword">forall</span> ps pr pl (st :: ps) (st' :: ps) m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st', <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st, <a href="Network-TypedProtocol-Peer.html#t:Outstanding" title="Network.TypedProtocol.Peer">Outstanding</a> pl <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a>) =&gt; <a href="Network-TypedProtocol-Core.html#t:WeHaveAgencyProof" title="Network.TypedProtocol.Core">WeHaveAgencyProof</a> pr st -&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st' m a -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a</li><li><a href="#v:Await">Await</a> :: <span class="keyword">forall</span> ps pr pl (st :: ps) m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st, <a href="Network-TypedProtocol-Peer.html#t:Outstanding" title="Network.TypedProtocol.Peer">Outstanding</a> pl <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a>) =&gt; <a href="Network-TypedProtocol-Core.html#t:TheyHaveAgencyProof" title="Network.TypedProtocol.Core">TheyHaveAgencyProof</a> pr st -&gt; (<span class="keyword">forall</span> (st' :: ps). <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st' m a) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a</li><li><a href="#v:Done">Done</a> :: <span class="keyword">forall</span> ps pr pl (st :: ps) m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#v:NobodyAgency" title="Network.TypedProtocol.Core">NobodyAgency</a>, <a href="Network-TypedProtocol-Peer.html#t:Outstanding" title="Network.TypedProtocol.Peer">Outstanding</a> pl <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a>) =&gt; <a href="Network-TypedProtocol-Core.html#t:NobodyHasAgencyProof" title="Network.TypedProtocol.Core">NobodyHasAgencyProof</a> pr st -&gt; a -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a</li><li><a href="#v:YieldPipelined">YieldPipelined</a> :: <span class="keyword">forall</span> ps pr (st :: ps) (st' :: ps) c n st'' m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st', <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st) =&gt; <a href="Network-TypedProtocol-Core.html#t:WeHaveAgencyProof" title="Network.TypedProtocol.Core">WeHaveAgencyProof</a> pr st -&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st' st'' m c -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> (<a href="Network-TypedProtocol-Peer.html#v:S" title="Network.TypedProtocol.Peer">S</a> n) c) st'' m a -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> n c) st m a</li><li><a href="#v:Collect">Collect</a> :: <span class="keyword">forall</span> ps pr c n st m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st) =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> (<a href="Network-TypedProtocol-Peer.html#v:S" title="Network.TypedProtocol.Peer">S</a> n) c) st m a) -&gt; (c -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> n c) st m a) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> (<a href="Network-TypedProtocol-Peer.html#v:S" title="Network.TypedProtocol.Peer">S</a> n) c) st m a</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:PeerPipelined">PeerPipelined</a> ps pr (st :: ps) m a <span class="keyword">where</span><ul class="subs"><li><a href="#v:PeerPipelined">PeerPipelined</a> :: {..} -&gt; <a href="Network-TypedProtocol-Peer.html#t:PeerPipelined" title="Network.TypedProtocol.Peer">PeerPipelined</a> ps pr st m a</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Receiver">Receiver</a> ps pr st stdone m c <span class="keyword">where</span><ul class="subs"><li><a href="#v:ReceiverEffect">ReceiverEffect</a> :: m (<a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m c) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m c</li><li><a href="#v:ReceiverDone">ReceiverDone</a> :: c -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr stdone stdone m c</li><li><a href="#v:ReceiverAwait">ReceiverAwait</a> :: (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st) =&gt; <a href="Network-TypedProtocol-Core.html#t:TheyHaveAgencyProof" title="Network.TypedProtocol.Core">TheyHaveAgencyProof</a> pr st -&gt; (<span class="keyword">forall</span> st'. <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st' stdone m c) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m c</li></ul></li><li class="src short"><span class="keyword">type family</span> <a href="#t:Outstanding">Outstanding</a> pl <span class="keyword">where ...</span></li><li class="src short"><span class="keyword">data</span> <a href="#t:N">N</a><ul class="subs"><li>= <a href="#v:Z">Z</a></li><li>| <a href="#v:S">S</a> <a href="Network-TypedProtocol-Peer.html#t:N" title="Network.TypedProtocol.Peer">N</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Nat">Nat</a> (n :: <a href="Network-TypedProtocol-Peer.html#t:N" title="Network.TypedProtocol.Peer">N</a>) <span class="keyword">where</span><ul class="subs"><li><span class="keyword">pattern</span> <a href="#v:Zero">Zero</a> :: () =&gt; <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> n =&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n</li><li><span class="keyword">pattern</span> <a href="#v:Succ">Succ</a> :: () =&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Peer.html#v:S" title="Network.TypedProtocol.Peer">S</a> n =&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n -&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> m</li></ul></li><li class="src short"><a href="#v:natToInt">natToInt</a> :: <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:unsafeIntToNat">unsafeIntToNat</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Peer" class="def">Peer</a> ps pr pl st m a <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Peer.html#Peer" class="link">Source</a> <a href="#t:Peer" class="selflink">#</a></p><div class="doc"><p>A description of a peer that engages in a protocol.</p><p><strong>Note</strong>: You should use pattern synonyms exposed in
 <a href="Network-TypedProtocol-Peer-Client.html">Network.TypedProtocol.Peer.Client</a> and <a href="Network-TypedProtocol-Peer-Server.html">Network.TypedProtocol.Peer.Server</a>,
 however here we provide in-depth documentation.</p><p>The protocol describes what messages peers <em>may</em> send or <em>must</em> accept.
 A particular peer implementation decides what to actually do within the
 constraints of the protocol.</p><p>Peers engage in a protocol in either the client or server role. Of course
 the client role can only interact with the serve role for the same protocol
 and vice versa.</p><p><code><a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a></code> has several type arguments:</p><ul><li>the protocol itself;</li><li>the client/server role;</li><li>whether the peer is using pipelining or not, if pipelined it holds the
   depth of pipelining and a type used to collect data from pipelined
   transitions;</li><li>the current protocol state;</li><li>the monad in which the peer operates (e.g. <code><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a></code>);</li><li>the type of the final result once the peer terminates.</li></ul><p>For example:</p><pre>pingPongClientExample :: Peer PingPong AsClient (Pipelined Z Int) StIdle IO ()
pingPongServerExample :: Peer PingPong AsServer NonPipeliend      StIdle IO Int</pre><p>The actions that a non-pipelining peer can take are:</p><ul><li>to perform local monadic effects</li><li>to terminate with a result (but only in a terminal protocol state)</li><li>to send a message (but only in a protocol state in which we have agency)</li><li>to wait to receive a message (but only in a protocol state in which the
   other peer has agency)</li></ul><p>In addition a pipelining peer can:</p><ul><li>pipeline a message, which requires upfront declaration at which state we
   continue at and passing a receiver which will run in parallel.  When
   receiver terminates it pushes the result into the pipelining queue.</li><li>collect a response from the pipelining queue.</li></ul><p>The <code><a href="Network-TypedProtocol-Peer.html#v:Yield" title="Network.TypedProtocol.Peer">Yield</a></code>, <code><a href="Network-TypedProtocol-Peer.html#v:Await" title="Network.TypedProtocol.Peer">Await</a></code>, <code><a href="Network-TypedProtocol-Peer.html#v:Done" title="Network.TypedProtocol.Peer">Done</a></code>, <code><a href="Network-TypedProtocol-Peer.html#v:YieldPipelined" title="Network.TypedProtocol.Peer">YieldPipelined</a></code>, <code><a href="Network-TypedProtocol-Peer.html#v:Collect" title="Network.TypedProtocol.Peer">Collect</a></code>,
 constructors require to provide an evidence that the
 peer has agency in the current state. The types guarantee that it is not
 possible to supply incorrect evidence,  however the
 pattern synonyms exposed in <a href="Network-TypedProtocol-Peer-Client.html">Network.TypedProtocol.Peer.Client</a> and
 <a href="Network-TypedProtocol-Peer-Client.html">Network.TypedProtocol.Peer.Client</a> supply this evidence for you, and hence
 are easier to use and let you avoid some kinds of type errors.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Effect" class="def">Effect</a></td><td class="doc"><p>Perform a local monadic effect and then continue.</p><p>Example:</p><pre>Effect $ do
  ...          -- actions in the monad
  return $ ... -- another Peer value</pre></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: <span class="keyword">forall</span> ps pr pl st m a. m (<a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a)</dfn><div class="doc"><p>monadic continuation</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:Yield" class="def">Yield</a></td><td class="doc"><p>Send a message to the other peer and then continue. This takes the
 message and the continuation. It also requires evidence that we have
 agency for this protocol state and thus are allowed to send messages.</p><p>Example:</p><pre>Yield ReflClientAgency MsgPing $ ...</pre></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: <span class="keyword">forall</span> ps pr pl (st :: ps) (st' :: ps) m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st', <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st, <a href="Network-TypedProtocol-Peer.html#t:Outstanding" title="Network.TypedProtocol.Peer">Outstanding</a> pl <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">=&gt; <a href="Network-TypedProtocol-Core.html#t:WeHaveAgencyProof" title="Network.TypedProtocol.Core">WeHaveAgencyProof</a> pr st</dfn><div class="doc"><p>agency proof</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st'</dfn><div class="doc"><p>protocol message</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st' m a</dfn><div class="doc"><p>continuation</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:Await" class="def">Await</a></td><td class="doc"><p>Waits to receive a message from the other peer and then continues.
 This takes the continuation that is supplied with the received message. It
 also requires evidence that the other peer has agency for this protocol
 state and thus we are expected to wait to receive messages.</p><p>Note that the continuation that gets supplied with the message must be
 prepared to deal with <em>any</em> message that is allowed in <em>this</em> protocol
 state. This is why the continuation <em>must</em> be polymorphic in the target
 state of the message (the third type argument of <code><a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a></code>).</p><p>Example:</p><pre>Await ReflClientAgency $ \msg -&gt;
case msg of
  MsgDone -&gt; ...
  MsgPing -&gt; ...</pre></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: <span class="keyword">forall</span> ps pr pl (st :: ps) m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st, <a href="Network-TypedProtocol-Peer.html#t:Outstanding" title="Network.TypedProtocol.Peer">Outstanding</a> pl <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">=&gt; <a href="Network-TypedProtocol-Core.html#t:TheyHaveAgencyProof" title="Network.TypedProtocol.Core">TheyHaveAgencyProof</a> pr st</dfn><div class="doc"><p>agency proof</p></div></li><li><dfn class="src">-&gt; (<span class="keyword">forall</span> (st' :: ps). <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st' m a)</dfn><div class="doc"><p>continuation</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:Done" class="def">Done</a></td><td class="doc"><p>Terminate with a result. A state token must be provided from the
 <code><a href="Network-TypedProtocol-Core.html#v:NobodyHasAgency" title="Network.TypedProtocol.Core">NobodyHasAgency</a></code> states, to show that this is a state in which we can
 terminate.</p><p>Example:</p><pre>Yield ReflClientAgency
       MsgDone
      (Done ReflNobodyAgency TokDone result)</pre></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: <span class="keyword">forall</span> ps pr pl (st :: ps) m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:StateAgency" title="Network.TypedProtocol.Core">StateAgency</a> st <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Core.html#v:NobodyAgency" title="Network.TypedProtocol.Core">NobodyAgency</a>, <a href="Network-TypedProtocol-Peer.html#t:Outstanding" title="Network.TypedProtocol.Peer">Outstanding</a> pl <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">=&gt; <a href="Network-TypedProtocol-Core.html#t:NobodyHasAgencyProof" title="Network.TypedProtocol.Core">NobodyHasAgencyProof</a> pr st</dfn><div class="doc"><p>(no) agency proof</p></div></li><li><dfn class="src">-&gt; a</dfn><div class="doc"><p>returned value</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:YieldPipelined" class="def">YieldPipelined</a></td><td class="doc"><p>Pipelined send.  We statically decide from which state we continue (the
 <code>st''</code> state here), the gap (between <code>st'</code> and <code>st''</code>) must be fulfilled
 by <code><a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a></code> which runs will run in parallel.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: <span class="keyword">forall</span> ps pr (st :: ps) (st' :: ps) c n st'' m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st', <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">=&gt; <a href="Network-TypedProtocol-Core.html#t:WeHaveAgencyProof" title="Network.TypedProtocol.Core">WeHaveAgencyProof</a> pr st</dfn><div class="doc"><p>agency proof</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st'</dfn><div class="doc"><p>protocol message</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st' st'' m c</dfn><div class="doc"><p>receiver</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> (<a href="Network-TypedProtocol-Peer.html#v:S" title="Network.TypedProtocol.Peer">S</a> n) c) st'' m a</dfn><div class="doc"><p>continuation from state <code>st''</code></p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> n c) st m a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:Collect" class="def">Collect</a></td><td class="doc"><p>Collect results returned by a <code><a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a></code>.  Results are collected in the
 first-in-first-out way.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: <span class="keyword">forall</span> ps pr c n st m a. (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">=&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> (<a href="Network-TypedProtocol-Peer.html#v:S" title="Network.TypedProtocol.Peer">S</a> n) c) st m a)</dfn><div class="doc"><p>continuation, executed if no message has arrived so far</p></div></li><li><dfn class="src">-&gt; (c -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> n c) st m a)</dfn><div class="doc"><p>continuation</p></div></li><li><dfn class="src">-&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> (<a href="Network-TypedProtocol-Peer.html#v:S" title="Network.TypedProtocol.Peer">S</a> n) c) st m a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Peer">Instances</h4><details id="i:Peer" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Peer:Functor:1"></span> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> (<a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m)</span> <a href="src/Network.TypedProtocol.Peer.html#line-219" class="link">Source</a> <a href="#t:Peer" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Peer:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Peer.html">Network.TypedProtocol.Peer</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m b <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m b -&gt; <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr pl st m a <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:PeerPipelined" class="def">PeerPipelined</a> ps pr (st :: ps) m a <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Peer.html#PeerPipelined" class="link">Source</a> <a href="#t:PeerPipelined" class="selflink">#</a></p><div class="doc"><p>A description of a peer that engages in a protocol in a pipelined fashion.</p><p>This type is useful for wrapping pipelined peers to hide information which
 is only relevant in peer lift.  It is expected by
 <code><a href="Network-TypedProtocol-Driver.html#v:runPeerPipelinedWithDriver" title="Network.TypedProtocol.Driver">runPeerPipelinedWithDriver</a></code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:PeerPipelined" class="def">PeerPipelined</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: { <a id="v:runPeerPipelined" class="def">runPeerPipelined</a> :: <a href="Network-TypedProtocol-Peer.html#t:Peer" title="Network.TypedProtocol.Peer">Peer</a> ps pr (<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a> c) st m a</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;} -&gt; <a href="Network-TypedProtocol-Peer.html#t:PeerPipelined" title="Network.TypedProtocol.Peer">PeerPipelined</a> ps pr st m a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:PeerPipelined">Instances</h4><details id="i:PeerPipelined" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PeerPipelined:Functor:1"></span> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> (<a href="Network-TypedProtocol-Peer.html#t:PeerPipelined" title="Network.TypedProtocol.Peer">PeerPipelined</a> ps pr st m)</span> <a href="src/Network.TypedProtocol.Peer.html#line-275" class="link">Source</a> <a href="#t:PeerPipelined" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PeerPipelined:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Peer.html">Network.TypedProtocol.Peer</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Network-TypedProtocol-Peer.html#t:PeerPipelined" title="Network.TypedProtocol.Peer">PeerPipelined</a> ps pr st m a -&gt; <a href="Network-TypedProtocol-Peer.html#t:PeerPipelined" title="Network.TypedProtocol.Peer">PeerPipelined</a> ps pr st m b <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Network-TypedProtocol-Peer.html#t:PeerPipelined" title="Network.TypedProtocol.Peer">PeerPipelined</a> ps pr st m b -&gt; <a href="Network-TypedProtocol-Peer.html#t:PeerPipelined" title="Network.TypedProtocol.Peer">PeerPipelined</a> ps pr st m a <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Receiver" class="def">Receiver</a> ps pr st stdone m c <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Peer.html#Receiver" class="link">Source</a> <a href="#t:Receiver" class="selflink">#</a></p><div class="doc"><p>Receiver.  It is limited to only awaiting for messages and running monadic
 computations.  This means that one can only pipeline messages if they can be
 connected by state transitions which all have remote agency.</p><p>The receiver runs in parallel, see <code>runPipelinedPeerWithDriver</code>.  This makes
 pipelining quite effective, since the receiver callbacks are called in
 a separate thread which can effectively use CPU cache and can avoids
 unnecessary context switches.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ReceiverEffect" class="def">ReceiverEffect</a> :: m (<a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m c) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m c</td><td class="doc"><p>Execute a monadic computation.</p></td></tr><tr><td class="src"><a id="v:ReceiverDone" class="def">ReceiverDone</a> :: c -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr stdone stdone m c</td><td class="doc"><p>Return value.</p></td></tr><tr><td class="src"><a id="v:ReceiverAwait" class="def">ReceiverAwait</a> :: (<a href="Network-TypedProtocol-Core.html#t:StateTokenI" title="Network.TypedProtocol.Core">StateTokenI</a> st, <a href="Network-TypedProtocol-Core.html#t:ActiveState" title="Network.TypedProtocol.Core">ActiveState</a> st) =&gt; <a href="Network-TypedProtocol-Core.html#t:TheyHaveAgencyProof" title="Network.TypedProtocol.Core">TheyHaveAgencyProof</a> pr st -&gt; (<span class="keyword">forall</span> st'. <a href="Network-TypedProtocol-Core.html#t:Message" title="Network.TypedProtocol.Core">Message</a> ps st st' -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st' stdone m c) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m c</td><td class="doc"><p>Await for for a remote transition.</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Receiver">Instances</h4><details id="i:Receiver" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Receiver:Functor:1"></span> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> (<a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m)</span> <a href="src/Network.TypedProtocol.Peer.html#line-263" class="link">Source</a> <a href="#t:Receiver" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Receiver:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Peer.html">Network.TypedProtocol.Peer</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m a -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m b <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m b -&gt; <a href="Network-TypedProtocol-Peer.html#t:Receiver" title="Network.TypedProtocol.Peer">Receiver</a> ps pr st stdone m a <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type family</span> <a id="t:Outstanding" class="def">Outstanding</a> pl <span class="keyword">where ...</span> <a href="src/Network.TypedProtocol.Core.html#Outstanding" class="link">Source</a> <a href="#t:Outstanding" class="selflink">#</a></p><div class="doc"><p>Type level count of the number of outstanding pipelined yields for which
 we have not yet collected a receiver result. Used to
 ensure that <code>Collect</code> is only used when there are outstanding results to
 collect (e.g. after <code>YieldPipeliend</code> was used);
 and to ensure that the non-pipelined primitives <code>Yield</code>, <code>Await</code> and <code>Done</code>
 are only used when there are none unsatisfied pipelined requests.</p></div><div class="subs equations"><p class="caption">Equations</p><table><tr><td class="src"><a href="Network-TypedProtocol-Peer.html#t:Outstanding" title="Network.TypedProtocol.Peer">Outstanding</a> '<a href="Network-TypedProtocol-Core.html#v:NonPipelined" title="Network.TypedProtocol.Core">NonPipelined</a> = <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Network-TypedProtocol-Peer.html#t:Outstanding" title="Network.TypedProtocol.Peer">Outstanding</a> ('<a href="Network-TypedProtocol-Core.html#v:Pipelined" title="Network.TypedProtocol.Core">Pipelined</a> n _) = n</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:N" class="def">N</a> <a href="src/Network.TypedProtocol.Core.html#N" class="link">Source</a> <a href="#t:N" class="selflink">#</a></p><div class="doc"><p>A type level inductive natural number.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Z" class="def">Z</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:S" class="def">S</a> <a href="Network-TypedProtocol-Peer.html#t:N" title="Network.TypedProtocol.Peer">N</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Nat" class="def">Nat</a> (n :: <a href="Network-TypedProtocol-Peer.html#t:N" title="Network.TypedProtocol.Peer">N</a>) <span class="keyword">where</span> <a href="src/Network.TypedProtocol.Core.html#Nat" class="link">Source</a> <a href="#t:Nat" class="selflink">#</a></p><div class="doc"><p>A value level inductive natural number, indexed by the corresponding type
 level natural number <code><a href="Network-TypedProtocol-Peer.html#t:N" title="Network.TypedProtocol.Peer">N</a></code>.</p><p>This is often needed when writing pipelined peers to be able to count the
 number of outstanding pipelined yields, and show to the type checker that
 <code><a href="Network-TypedProtocol-Peer.html#v:Collect" title="Network.TypedProtocol.Peer">Collect</a></code> and <code><a href="Network-TypedProtocol-Peer.html#v:Done" title="Network.TypedProtocol.Peer">Done</a></code>
 are being used correctly.</p></div><div class="subs bundled-patterns"><p class="caption">Bundled Patterns</p><table><tr><td class="src"><span class="keyword">pattern</span> <a id="v:Zero" class="def">Zero</a> :: () =&gt; <a href="Network-TypedProtocol-Peer.html#v:Z" title="Network.TypedProtocol.Peer">Z</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> n =&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><span class="keyword">pattern</span> <a id="v:Succ" class="def">Succ</a> :: () =&gt; m <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Type-Equality.html#t:-126-" title="Data.Type.Equality">~</a> <a href="Network-TypedProtocol-Peer.html#v:S" title="Network.TypedProtocol.Peer">S</a> n =&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n -&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> m</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Nat">Instances</h4><details id="i:Nat" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Nat:Show:1"></span> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n)</span> <a href="src/Network.TypedProtocol.Core.html#line-536" class="link">Source</a> <a href="#t:Nat" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Nat:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-TypedProtocol-Core.html">Network.TypedProtocol.Core</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n] -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:natToInt" class="def">natToInt</a> :: <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Network.TypedProtocol.Core.html#natToInt" class="link">Source</a> <a href="#v:natToInt" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:unsafeIntToNat" class="def">unsafeIntToNat</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-TypedProtocol-Peer.html#t:Nat" title="Network.TypedProtocol.Peer">Nat</a> n <a href="src/Network.TypedProtocol.Core.html#unsafeIntToNat" class="link">Source</a> <a href="#v:unsafeIntToNat" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>