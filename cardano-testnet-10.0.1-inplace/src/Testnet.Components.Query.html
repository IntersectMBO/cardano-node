<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Testnet.Components.Query</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier">EpochStateView</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getEpochStateView"><span class="hs-identifier">getEpochStateView</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier">getEpochState</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getSlotNumber"><span class="hs-identifier">getSlotNumber</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getBlockNumber"><span class="hs-identifier">getBlockNumber</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#watchEpochStateUpdate"><span class="hs-identifier">watchEpochStateUpdate</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getMinDRepDeposit"><span class="hs-identifier">getMinDRepDeposit</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getMinGovActionDeposit"><span class="hs-identifier">getMinGovActionDeposit</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getGovState"><span class="hs-identifier">getGovState</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getCurrentEpochNo"><span class="hs-identifier">getCurrentEpochNo</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getTreasuryValue"><span class="hs-identifier">getTreasuryValue</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#TestnetWaitPeriod"><span class="hs-identifier">TestnetWaitPeriod</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#waitForEpochs"><span class="hs-identifier">waitForEpochs</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#waitUntilEpoch"><span class="hs-identifier">waitUntilEpoch</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#waitForBlocks"><span class="hs-identifier">waitForBlocks</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#retryUntilJustM"><span class="hs-identifier">retryUntilJustM</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#findAllUtxos"><span class="hs-identifier">findAllUtxos</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#findUtxosWithAddress"><span class="hs-identifier">findUtxosWithAddress</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#findLargestUtxoWithAddress"><span class="hs-identifier">findLargestUtxoWithAddress</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#findLargestUtxoForPaymentKey"><span class="hs-identifier">findLargestUtxoForPaymentKey</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#checkDRepsNumber"><span class="hs-identifier">checkDRepsNumber</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#checkDRepState"><span class="hs-identifier">checkDRepState</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#assertNewEpochState"><span class="hs-identifier">assertNewEpochState</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getProtocolParams"><span class="hs-identifier">getProtocolParams</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getGovActionLifetime"><span class="hs-identifier">getGovActionLifetime</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getKeyDeposit"><span class="hs-identifier">getKeyDeposit</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getDelegationState"><span class="hs-identifier">getDelegationState</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#getTxIx"><span class="hs-identifier">getTxIx</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.html"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Api</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/ouroboros-consensus-0.27.0.0-004c8b8862bcdf99608d21368eda63ae7ec76430a4bb20826e436605913605d0/share/doc/html/src/Ouroboros.Consensus.Ledger.SupportsMempool.html#txId"><span class="hs-identifier">txId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Ledger.html"><span class="hs-identifier">Cardano.Api.Ledger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier">Credential</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.DRep.html#DRepState"><span class="hs-identifier">DRepState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier">EpochInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Keys.Internal.html#KeyRole"><span class="hs-identifier">KeyRole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Keys.Internal.html#DRepRole"><span class="hs-identifier">DRepRole</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Ledger.html"><span class="hs-identifier">Cardano.Api.Ledger</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.UTxO.html"><span class="hs-identifier">Cardano.Api.UTxO</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Utxo</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-api-1.11.0.0-b4da918b58727d9b9914be4f7be7314b34185ebbcb453c4fe6c4f5c2881c79bb/share/doc/html/src/Cardano.Ledger.Api.html"><span class="hs-identifier">Cardano.Ledger.Api</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#ConwayGovState"><span class="hs-identifier">ConwayGovState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-api-1.11.0.0-b4da918b58727d9b9914be4f7be7314b34185ebbcb453c4fe6c4f5c2881c79bb/share/doc/html/src/Cardano.Ledger.Api.html"><span class="hs-identifier">Cardano.Ledger.Api</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html"><span class="hs-identifier">Cardano.Ledger.Conway.Governance</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.PParams.html"><span class="hs-identifier">Cardano.Ledger.Conway.PParams</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.html"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.UMap.html"><span class="hs-identifier">Cardano.Ledger.UMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/w7kvzs7da04kqvsjqip24vdckwyqdjy2-safe-exceptions-lib-safe-exceptions-0.1.7.4-haddock-doc/share/doc/safe-exceptions/html/src/Control.Exception.Safe.html"><span class="hs-identifier">Control.Exception.Safe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/exceptions-0.10.7/src/Control.Monad.Catch.html#MonadCatch"><span class="hs-identifier">MonadCatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/33ljpp1xjs9plf850ylrvspzkd808zh4-resourcet-lib-resourcet-1.3.0-haddock-doc/share/doc/resourcet/html/src/Control.Monad.Trans.Resource.html"><span class="hs-identifier">Control.Monad.Trans.Resource</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier">put</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.IORef.html"><span class="hs-identifier">Data.IORef</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#sortOn"><span class="hs-identifier">sortOn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Ord.html"><span class="hs-identifier">Data.Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Ord.html#Down"><span class="hs-identifier">Down</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Type.Equality.html"><span class="hs-identifier">Data.Type.Equality</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Word.html#Word64"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Exts.html"><span class="hs-identifier">GHC.Exts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IsList.html#IsList"><span class="hs-identifier">IsList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html"><span class="hs-identifier">Lens.Micro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier">Lens'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#to"><span class="hs-identifier">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator">(^.)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Testnet.Property.Assert.html"><span class="hs-identifier">Testnet.Property.Assert</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Testnet.Types.html"><span class="hs-identifier">Testnet.Types</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.html"><span class="hs-identifier">Hedgehog.Extras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier">MonadAssertion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.html"><span class="hs-identifier">Hedgehog.Extras</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- | Block and wait for the desired epoch.</span></span><span>
</span><span id="line-87"></span><span id="local-6989586621679565521"><span class="annot"><a href="Testnet.Components.Query.html#waitUntilEpoch"><span class="hs-identifier hs-type">waitUntilEpoch</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565521"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565521"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#NodeConfigFile"><span class="hs-identifier hs-type">NodeConfigFile</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.IO.Internal.Base.html#In"><span class="hs-identifier hs-type">In</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.IO.Internal.Base.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Desired epoch</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565521"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The epoch number reached</span></span><span>
</span><span id="line-95"></span><span id="waitUntilEpoch"><span class="annot"><span class="annottext">waitUntilEpoch :: forall (m :: * -&gt; *).
(HasCallStack, MonadIO m, MonadTest m) =&gt;
NodeConfigFile 'In -&gt; SocketPath -&gt; EpochNo -&gt; m EpochNo
</span><a href="Testnet.Components.Query.html#waitUntilEpoch"><span class="hs-identifier hs-var hs-var">waitUntilEpoch</span></a></span></span><span> </span><span id="local-6989586621679565963"><span class="annot"><span class="annottext">NodeConfigFile 'In
</span><a href="#local-6989586621679565963"><span class="hs-identifier hs-var">nodeConfigFile</span></a></span></span><span> </span><span id="local-6989586621679565964"><span class="annot"><span class="annottext">SocketPath
</span><a href="#local-6989586621679565964"><span class="hs-identifier hs-var">socketPath</span></a></span></span><span> </span><span id="local-6989586621679565965"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679565965"><span class="hs-identifier hs-var">desiredEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m EpochNo) -&gt; m EpochNo
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m EpochNo) -&gt; m EpochNo)
-&gt; (HasCallStack =&gt; m EpochNo) -&gt; m EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679566022"><span class="annot"><span class="annottext">Either FoldBlocksError (ConditionResult, ())
</span><a href="#local-6989586621679566022"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either FoldBlocksError (ConditionResult, ()))
-&gt; m (Either FoldBlocksError (ConditionResult, ()))
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">H.evalIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either FoldBlocksError (ConditionResult, ()))
 -&gt; m (Either FoldBlocksError (ConditionResult, ())))
-&gt; (ExceptT FoldBlocksError IO (ConditionResult, ())
    -&gt; IO (Either FoldBlocksError (ConditionResult, ())))
-&gt; ExceptT FoldBlocksError IO (ConditionResult, ())
-&gt; m (Either FoldBlocksError (ConditionResult, ()))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT FoldBlocksError IO (ConditionResult, ())
-&gt; IO (Either FoldBlocksError (ConditionResult, ()))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT FoldBlocksError IO (ConditionResult, ())
 -&gt; m (Either FoldBlocksError (ConditionResult, ())))
-&gt; ExceptT FoldBlocksError IO (ConditionResult, ())
-&gt; m (Either FoldBlocksError (ConditionResult, ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">NodeConfigFile 'In
-&gt; SocketPath
-&gt; ValidationMode
-&gt; EpochNo
-&gt; ()
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT () IO ConditionResult)
-&gt; ExceptT FoldBlocksError IO (ConditionResult, ())
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) s.
MonadIOTransError FoldBlocksError t m =&gt;
NodeConfigFile 'In
-&gt; SocketPath
-&gt; ValidationMode
-&gt; EpochNo
-&gt; s
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT s IO ConditionResult)
-&gt; t m (ConditionResult, s)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#foldEpochState"><span class="hs-identifier hs-var">foldEpochState</span></a></span><span>
</span><span id="line-98"></span><span>      </span><span class="annot"><span class="annottext">NodeConfigFile 'In
</span><a href="#local-6989586621679565963"><span class="hs-identifier hs-var">nodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">SocketPath
</span><a href="#local-6989586621679565964"><span class="hs-identifier hs-var">socketPath</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationMode
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#QuickValidation"><span class="hs-identifier hs-var">QuickValidation</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679565965"><span class="hs-identifier hs-var">desiredEpoch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">AnyNewEpochState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConditionResult -&gt; StateT () IO ConditionResult
forall a. a -&gt; StateT () IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ConditionResult
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#ConditionNotMet"><span class="hs-identifier hs-var">ConditionNotMet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either FoldBlocksError (ConditionResult, ())
</span><a href="#local-6989586621679566022"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#FoldBlocksApplyBlockError"><span class="hs-identifier hs-type">FoldBlocksApplyBlockError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#TerminationEpochReached"><span class="hs-identifier hs-type">TerminationEpochReached</span></a></span><span> </span><span id="local-6989586621679566031"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679566031"><span class="hs-identifier hs-var">epochNo</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">EpochNo -&gt; m EpochNo
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679566031"><span class="hs-identifier hs-var">epochNo</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679566032"><span class="annot"><span class="annottext">FoldBlocksError
</span><a href="#local-6989586621679566032"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;waitUntilEpoch: could not reach termination epoch, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; String
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Pretty.html#docToString"><span class="hs-identifier hs-var">docToString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FoldBlocksError -&gt; Doc AnsiStyle
forall e ann. Error e =&gt; e -&gt; Doc ann
forall ann. FoldBlocksError -&gt; Doc ann
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Error.html#prettyError"><span class="hs-identifier hs-var">prettyError</span></a></span><span> </span><span class="annot"><span class="annottext">FoldBlocksError
</span><a href="#local-6989586621679566032"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>      </span><span class="annot"><span class="annottext">m EpochNo
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">H.failure</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679566037"><span class="annot"><span class="annottext">(ConditionResult, ())
</span><a href="#local-6989586621679566037"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;waitUntilEpoch: could not reach termination epoch - no error returned &quot;</span></span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;- invalid foldEpochState behaviour, result: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(ConditionResult, ()) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(ConditionResult, ())
</span><a href="#local-6989586621679566037"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="annottext">m EpochNo
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">H.failure</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Wait for the number of epochs</span></span><span>
</span><span id="line-111"></span><span id="local-6989586621679565588"><span class="annot"><a href="Testnet.Components.Query.html#waitForEpochs"><span class="hs-identifier hs-type">waitForEpochs</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565588"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565588"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565588"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Number of epochs to wait</span></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565588"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The epoch number reached</span></span><span>
</span><span id="line-119"></span><span id="waitForEpochs"><span class="annot"><span class="annottext">waitForEpochs :: forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadAssertion m, MonadIO m) =&gt;
EpochStateView -&gt; EpochInterval -&gt; m EpochNo
</span><a href="Testnet.Components.Query.html#waitForEpochs"><span class="hs-identifier hs-var hs-var">waitForEpochs</span></a></span></span><span> </span><span id="local-6989586621679566050"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566050"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566051"><span class="annot"><span class="annottext">EpochInterval
</span><a href="#local-6989586621679566051"><span class="hs-identifier hs-var">interval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m EpochNo) -&gt; m EpochNo
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m EpochNo) -&gt; m EpochNo)
-&gt; (HasCallStack =&gt; m EpochNo) -&gt; m EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="annottext">m (Maybe Any) -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Maybe Any) -&gt; m ()) -&gt; m (Maybe Any) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; EpochInterval
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe Any))
-&gt; m (Maybe Any)
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView
-&gt; EpochInterval
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe a))
-&gt; m (Maybe a)
</span><a href="Testnet.Components.Query.html#watchEpochStateUpdate"><span class="hs-identifier hs-var">watchEpochStateUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566050"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">EpochInterval
</span><a href="#local-6989586621679566051"><span class="hs-identifier hs-var">interval</span></a></span><span> </span><span class="annot"><span class="annottext">(((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe Any))
 -&gt; m (Maybe Any))
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe Any))
-&gt; m (Maybe Any)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">(AnyNewEpochState, SlotNo, BlockNo)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Any -&gt; m (Maybe Any)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Any
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">EpochStateView -&gt; m EpochNo
forall (m :: * -&gt; *).
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; m EpochNo
</span><a href="Testnet.Components.Query.html#getCurrentEpochNo"><span class="hs-identifier hs-var">getCurrentEpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566050"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">-- | Wait for the requested number of blocks</span></span><span>
</span><span id="line-124"></span><span id="local-6989586621679565599"><span class="annot"><a href="Testnet.Components.Query.html#waitForBlocks"><span class="hs-identifier hs-type">waitForBlocks</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565599"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565599"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565599"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/exceptions-0.10.7/src/Control.Monad.Catch.html#MonadCatch"><span class="hs-identifier hs-type">MonadCatch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565599"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Number of blocks to wait</span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565599"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The block number reached</span></span><span>
</span><span id="line-133"></span><span id="waitForBlocks"><span class="annot"><span class="annottext">waitForBlocks :: forall (m :: * -&gt; *).
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m,
 MonadCatch m) =&gt;
EpochStateView -&gt; Word64 -&gt; m BlockNo
</span><a href="Testnet.Components.Query.html#waitForBlocks"><span class="hs-identifier hs-var hs-var">waitForBlocks</span></a></span></span><span> </span><span id="local-6989586621679566077"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566077"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566078"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566078"><span class="hs-identifier hs-var">numberOfBlocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m BlockNo) -&gt; m BlockNo
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m BlockNo) -&gt; m BlockNo)
-&gt; (HasCallStack =&gt; m BlockNo) -&gt; m BlockNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a></span><span> </span><span id="local-6989586621679566128"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566128"><span class="hs-identifier hs-var">startingBlockNumber</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m BlockNo
forall (m :: * -&gt; *).
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView -&gt; m BlockNo
</span><a href="Testnet.Components.Query.html#getBlockNumber"><span class="hs-identifier hs-var">getBlockNumber</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566077"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Current block number: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566128"><span class="hs-identifier hs-var">startingBlockNumber</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. &quot;</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Waiting for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566078"><span class="hs-identifier hs-var">numberOfBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; blocks&quot;</span></span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">m BlockNo -&gt; m BlockNo
forall (m :: * -&gt; *) a.
(MonadTest m, MonadCatch m, HasCallStack, Show a) =&gt;
m a -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#noteShowM"><span class="hs-identifier hs-var">H.noteShowM</span></a></span><span> </span><span class="annot"><span class="annottext">(m BlockNo -&gt; m BlockNo)
-&gt; (m (Maybe Word64) -&gt; m BlockNo) -&gt; m (Maybe Word64) -&gt; m BlockNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe BlockNo) -&gt; m BlockNo
forall (m :: * -&gt; *) a.
(MonadTest m, HasCallStack) =&gt;
m (Maybe a) -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#nothingFailM"><span class="hs-identifier hs-var">H.nothingFailM</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Maybe BlockNo) -&gt; m BlockNo)
-&gt; (m (Maybe Word64) -&gt; m (Maybe BlockNo))
-&gt; m (Maybe Word64)
-&gt; m BlockNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word64 -&gt; Maybe BlockNo)
-&gt; m (Maybe Word64) -&gt; m (Maybe BlockNo)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64 -&gt; BlockNo) -&gt; Maybe Word64 -&gt; Maybe BlockNo
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; BlockNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-var">BlockNo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Maybe Word64) -&gt; m BlockNo) -&gt; m (Maybe Word64) -&gt; m BlockNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">EpochStateView
-&gt; EpochInterval
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe Word64))
-&gt; m (Maybe Word64)
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView
-&gt; EpochInterval
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe a))
-&gt; m (Maybe a)
</span><a href="Testnet.Components.Query.html#watchEpochStateUpdate"><span class="hs-identifier hs-var">watchEpochStateUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566077"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; EpochInterval
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-var">EpochInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
forall a. Bounded a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#maxBound"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe Word64))
 -&gt; m (Maybe Word64))
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe Word64))
-&gt; m (Maybe Word64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyNewEpochState
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a></span><span> </span><span id="local-6989586621679566133"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566133"><span class="hs-identifier hs-var">blockNumber</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><span class="annottext">Maybe Word64 -&gt; m (Maybe Word64)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word64 -&gt; m (Maybe Word64))
-&gt; Maybe Word64 -&gt; m (Maybe Word64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566133"><span class="hs-identifier hs-var">blockNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566128"><span class="hs-identifier hs-var">startingBlockNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566078"><span class="hs-identifier hs-var">numberOfBlocks</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566133"><span class="hs-identifier hs-var">blockNumber</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">data</span><span> </span><span id="TestnetWaitPeriod"><span class="annot"><a href="Testnet.Components.Query.html#TestnetWaitPeriod"><span class="hs-identifier hs-var">TestnetWaitPeriod</span></a></span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="WaitForEpochs"><span class="annot"><a href="Testnet.Components.Query.html#WaitForEpochs"><span class="hs-identifier hs-var">WaitForEpochs</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WaitForBlocks"><span class="annot"><a href="Testnet.Components.Query.html#WaitForBlocks"><span class="hs-identifier hs-var">WaitForBlocks</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WaitForSlots"><span class="annot"><a href="Testnet.Components.Query.html#WaitForSlots"><span class="hs-identifier hs-var">WaitForSlots</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679566139"><span id="local-6989586621679566146"><span class="annot"><span class="annottext">TestnetWaitPeriod -&gt; TestnetWaitPeriod -&gt; Bool
(TestnetWaitPeriod -&gt; TestnetWaitPeriod -&gt; Bool)
-&gt; (TestnetWaitPeriod -&gt; TestnetWaitPeriod -&gt; Bool)
-&gt; Eq TestnetWaitPeriod
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: TestnetWaitPeriod -&gt; TestnetWaitPeriod -&gt; Bool
== :: TestnetWaitPeriod -&gt; TestnetWaitPeriod -&gt; Bool
$c/= :: TestnetWaitPeriod -&gt; TestnetWaitPeriod -&gt; Bool
/= :: TestnetWaitPeriod -&gt; TestnetWaitPeriod -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679566151"><span id="local-6989586621679566156"><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#TestnetWaitPeriod"><span class="hs-identifier hs-type">TestnetWaitPeriod</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679566170"><span class="annot"><span class="annottext">show :: TestnetWaitPeriod -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForEpochs"><span class="hs-identifier hs-type">WaitForEpochs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span><span> </span><span id="local-6989586621679566171"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679566171"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;WaitForEpochs &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679566171"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForBlocks"><span class="hs-identifier hs-type">WaitForBlocks</span></a></span><span> </span><span id="local-6989586621679566172"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566172"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;WaitForBlocks &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566172"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForSlots"><span class="hs-identifier hs-type">WaitForSlots</span></a></span><span> </span><span id="local-6989586621679566173"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566173"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;WaitForSlots &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566173"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">-- | Retries the action until it returns 'Just' or the timeout is reached</span></span><span>
</span><span id="line-157"></span><span id="local-6989586621679565614"><span id="local-6989586621679565615"><span class="annot"><a href="Testnet.Components.Query.html#retryUntilJustM"><span class="hs-identifier hs-type">retryUntilJustM</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565614"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565614"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565614"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#TestnetWaitPeriod"><span class="hs-identifier hs-type">TestnetWaitPeriod</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ timeout for an operation</span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565614"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565615"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565614"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565615"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-166"></span><span id="retryUntilJustM"><span class="annot"><span class="annottext">retryUntilJustM :: forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView -&gt; TestnetWaitPeriod -&gt; m (Maybe a) -&gt; m a
</span><a href="Testnet.Components.Query.html#retryUntilJustM"><span class="hs-identifier hs-var hs-var">retryUntilJustM</span></a></span></span><span> </span><span id="local-6989586621679566190"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566190"><span class="hs-identifier hs-var">esv</span></a></span></span><span> </span><span id="local-6989586621679566191"><span class="annot"><span class="annottext">TestnetWaitPeriod
</span><a href="#local-6989586621679566191"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span id="local-6989586621679566192"><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679566192"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m a) -&gt; m a
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m a) -&gt; m a) -&gt; (HasCallStack =&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679566195"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566195"><span class="hs-identifier hs-var">startingValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Word64
</span><a href="#local-6989586621679566196"><span class="hs-identifier hs-var">getCurrentValue</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="annottext">Word64 -&gt; m a
</span><a href="#local-6989586621679566197"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566195"><span class="hs-identifier hs-var">startingValue</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679566197"><span class="annot"><span class="annottext">go :: Word64 -&gt; m a
</span><a href="#local-6989586621679566197"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679566198"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566198"><span class="hs-identifier hs-var">startingValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m a) -&gt; m a
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m a) -&gt; m a) -&gt; (HasCallStack =&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>      </span><span id="local-6989586621679566223"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566223"><span class="hs-identifier hs-var">cv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Word64
</span><a href="#local-6989586621679566196"><span class="hs-identifier hs-var">getCurrentValue</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566225"><span class="hs-identifier hs-var">timeoutW64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566198"><span class="hs-identifier hs-var">startingValue</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566223"><span class="hs-identifier hs-var">cv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Action did not result in 'Just' - waited for: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TestnetWaitPeriod -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TestnetWaitPeriod
</span><a href="#local-6989586621679566191"><span class="hs-identifier hs-var">timeout</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">H.failure</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679566192"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe a) -&gt; (Maybe a -&gt; m a) -&gt; m a
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679566227"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566227"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566227"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; m ()
forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadIO m) =&gt;
Int -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Concurrent.html#threadDelay"><span class="hs-identifier hs-var">H.threadDelay</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">300_000</span></span><span>
</span><span id="line-179"></span><span>          </span><span class="annot"><span class="annottext">Word64 -&gt; m a
</span><a href="#local-6989586621679566197"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566198"><span class="hs-identifier hs-var">startingValue</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679566196"><span class="annot"><span class="annottext">getCurrentValue :: m Word64
</span><a href="#local-6989586621679566196"><span class="hs-identifier hs-var hs-var">getCurrentValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m Word64) -&gt; m Word64
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m Word64) -&gt; m Word64)
-&gt; (HasCallStack =&gt; m Word64) -&gt; m Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestnetWaitPeriod
</span><a href="#local-6989586621679566191"><span class="hs-identifier hs-var">timeout</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForEpochs"><span class="hs-identifier hs-type">WaitForEpochs</span></a></span><span> </span><span class="annot"><span class="annottext">EpochInterval
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; Word64
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#unEpochNo"><span class="hs-identifier hs-var">unEpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochNo -&gt; Word64) -&gt; m EpochNo -&gt; m Word64
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m EpochNo
forall (m :: * -&gt; *).
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; m EpochNo
</span><a href="Testnet.Components.Query.html#getCurrentEpochNo"><span class="hs-identifier hs-var">getCurrentEpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566190"><span class="hs-identifier hs-var">esv</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForSlots"><span class="hs-identifier hs-type">WaitForSlots</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#unSlotNo"><span class="hs-identifier hs-var">unSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; Word64) -&gt; m SlotNo -&gt; m Word64
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m SlotNo
forall (m :: * -&gt; *).
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView -&gt; m SlotNo
</span><a href="Testnet.Components.Query.html#getSlotNumber"><span class="hs-identifier hs-var">getSlotNumber</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566190"><span class="hs-identifier hs-var">esv</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForBlocks"><span class="hs-identifier hs-type">WaitForBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockNo -&gt; Word64
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#unBlockNo"><span class="hs-identifier hs-var">unBlockNo</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockNo -&gt; Word64) -&gt; m BlockNo -&gt; m Word64
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m BlockNo
forall (m :: * -&gt; *).
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView -&gt; m BlockNo
</span><a href="Testnet.Components.Query.html#getBlockNumber"><span class="hs-identifier hs-var">getBlockNumber</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566190"><span class="hs-identifier hs-var">esv</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679566225"><span class="annot"><span class="annottext">timeoutW64 :: Word64
</span><a href="#local-6989586621679566225"><span class="hs-identifier hs-var hs-var">timeoutW64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestnetWaitPeriod
</span><a href="#local-6989586621679566191"><span class="hs-identifier hs-var">timeout</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForEpochs"><span class="hs-identifier hs-type">WaitForEpochs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span><span> </span><span id="local-6989586621679566261"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679566261"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679566261"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForSlots"><span class="hs-identifier hs-type">WaitForSlots</span></a></span><span> </span><span id="local-6989586621679566262"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566262"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566262"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><a href="Testnet.Components.Query.html#WaitForBlocks"><span class="hs-identifier hs-type">WaitForBlocks</span></a></span><span> </span><span id="local-6989586621679566263"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566263"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566263"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><span class="hs-comment">-- | A read-only mutable pointer to an epoch state, updated automatically</span></span><span>
</span><span id="line-194"></span><span class="hs-keyword">data</span><span> </span><span id="EpochStateView"><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-var">EpochStateView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EpochStateView"><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-var">EpochStateView</span></a></span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="nodeConfigPath"><span class="annot"><span class="annottext">EpochStateView -&gt; NodeConfigFile 'In
</span><a href="Testnet.Components.Query.html#nodeConfigPath"><span class="hs-identifier hs-var hs-var">nodeConfigPath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#NodeConfigFile"><span class="hs-identifier hs-type">NodeConfigFile</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.IO.Internal.Base.html#In"><span class="hs-identifier hs-type">In</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ node configuration file path</span></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="socketPath"><span class="annot"><span class="annottext">EpochStateView -&gt; SocketPath
</span><a href="Testnet.Components.Query.html#socketPath"><span class="hs-identifier hs-var hs-var">socketPath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.IO.Internal.Base.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ node socket path, to which foldEpochState is connected to</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="epochStateView"><span class="annot"><span class="annottext">EpochStateView -&gt; IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
</span><a href="Testnet.Components.Query.html#epochStateView"><span class="hs-identifier hs-var hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">-- ^ Automatically updated current NewEpochState. Use 'getEpochState', 'getBlockNumber', 'getSlotNumber'</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">-- to access the values.</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Get epoch state from the view. If the state isn't available, retry waiting up to 15 seconds. Fails when</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- the state is not available after 15 seconds.</span><span>
</span><span id="line-206"></span><span id="local-6989586621679565629"><span class="annot"><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier hs-type">getEpochState</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565629"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565629"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565629"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565629"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span></span><span>
</span><span id="line-213"></span><span id="getEpochState"><span class="annot"><span class="annottext">getEpochState :: forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadAssertion m, MonadIO m) =&gt;
EpochStateView -&gt; m AnyNewEpochState
</span><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier hs-var hs-var">getEpochState</span></a></span></span><span> </span><span id="local-6989586621679566276"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566276"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m AnyNewEpochState) -&gt; m AnyNewEpochState
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m AnyNewEpochState) -&gt; m AnyNewEpochState)
-&gt; (HasCallStack =&gt; m AnyNewEpochState) -&gt; m AnyNewEpochState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m AnyNewEpochState)
-&gt; m AnyNewEpochState
forall (m :: * -&gt; *) a.
(HasCallStack, MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m a) -&gt; m a
</span><a href="Testnet.Components.Query.html#getEpochStateDetails"><span class="hs-identifier hs-var">getEpochStateDetails</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566276"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">(((AnyNewEpochState, SlotNo, BlockNo) -&gt; m AnyNewEpochState)
 -&gt; m AnyNewEpochState)
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m AnyNewEpochState)
-&gt; m AnyNewEpochState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679566285"><span class="annot"><span class="annottext">AnyNewEpochState
</span><a href="#local-6989586621679566285"><span class="hs-identifier hs-var">nes</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AnyNewEpochState -&gt; m AnyNewEpochState
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">AnyNewEpochState
</span><a href="#local-6989586621679566285"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span id="local-6989586621679565601"><span class="annot"><a href="Testnet.Components.Query.html#getBlockNumber"><span class="hs-identifier hs-type">getBlockNumber</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565601"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565601"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565601"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565601"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The number of last produced block</span></span><span>
</span><span id="line-223"></span><span id="getBlockNumber"><span class="annot"><span class="annottext">getBlockNumber :: forall (m :: * -&gt; *).
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView -&gt; m BlockNo
</span><a href="Testnet.Components.Query.html#getBlockNumber"><span class="hs-identifier hs-var hs-var">getBlockNumber</span></a></span></span><span> </span><span id="local-6989586621679566294"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566294"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m BlockNo) -&gt; m BlockNo
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m BlockNo) -&gt; m BlockNo)
-&gt; (HasCallStack =&gt; m BlockNo) -&gt; m BlockNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m BlockNo) -&gt; m BlockNo
forall (m :: * -&gt; *) a.
(HasCallStack, MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m a) -&gt; m a
</span><a href="Testnet.Components.Query.html#getEpochStateDetails"><span class="hs-identifier hs-var">getEpochStateDetails</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566294"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">(((AnyNewEpochState, SlotNo, BlockNo) -&gt; m BlockNo) -&gt; m BlockNo)
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m BlockNo) -&gt; m BlockNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyNewEpochState
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566302"><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621679566302"><span class="hs-identifier hs-var">blockNumber</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockNo -&gt; m BlockNo
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621679566302"><span class="hs-identifier hs-var">blockNumber</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span id="local-6989586621679565625"><span class="annot"><a href="Testnet.Components.Query.html#getSlotNumber"><span class="hs-identifier hs-type">getSlotNumber</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565625"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565625"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565625"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565625"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The current slot number</span></span><span>
</span><span id="line-233"></span><span id="getSlotNumber"><span class="annot"><span class="annottext">getSlotNumber :: forall (m :: * -&gt; *).
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView -&gt; m SlotNo
</span><a href="Testnet.Components.Query.html#getSlotNumber"><span class="hs-identifier hs-var hs-var">getSlotNumber</span></a></span></span><span> </span><span id="local-6989586621679566311"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566311"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m SlotNo) -&gt; m SlotNo
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m SlotNo) -&gt; m SlotNo)
-&gt; (HasCallStack =&gt; m SlotNo) -&gt; m SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m SlotNo) -&gt; m SlotNo
forall (m :: * -&gt; *) a.
(HasCallStack, MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m a) -&gt; m a
</span><a href="Testnet.Components.Query.html#getEpochStateDetails"><span class="hs-identifier hs-var">getEpochStateDetails</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566311"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">(((AnyNewEpochState, SlotNo, BlockNo) -&gt; m SlotNo) -&gt; m SlotNo)
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m SlotNo) -&gt; m SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyNewEpochState
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566319"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679566319"><span class="hs-identifier hs-var">slotNumber</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; m SlotNo
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679566319"><span class="hs-identifier hs-var">slotNumber</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><span class="hs-comment">-- | Utility function for accessing epoch state in `IORef`</span></span><span>
</span><span id="line-237"></span><span id="local-6989586621679565631"><span id="local-6989586621679565632"><span class="annot"><a href="Testnet.Components.Query.html#getEpochStateDetails"><span class="hs-identifier hs-type">getEpochStateDetails</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565631"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565631"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565631"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565632"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565632"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-245"></span><span id="getEpochStateDetails"><span class="annot"><span class="annottext">getEpochStateDetails :: forall (m :: * -&gt; *) a.
(HasCallStack, MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m a) -&gt; m a
</span><a href="Testnet.Components.Query.html#getEpochStateDetails"><span class="hs-identifier hs-var hs-var">getEpochStateDetails</span></a></span></span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span class="hs-special">{</span><span id="local-6989586621679566328"><span class="annot"><span class="annottext">IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
epochStateView :: EpochStateView -&gt; IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
epochStateView :: IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
</span><a href="Testnet.Components.Query.html#epochStateView"><span class="hs-identifier hs-var hs-var">epochStateView</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679566329"><span class="annot"><span class="annottext">(AnyNewEpochState, SlotNo, BlockNo) -&gt; m a
</span><a href="#local-6989586621679566329"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m a) -&gt; m a
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m a) -&gt; m a) -&gt; (HasCallStack =&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; String -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
(MonadAssertion m, MonadTest m, MonadIO m, HasCallStack) =&gt;
NominalDiffTime -&gt; NominalDiffTime -&gt; String -&gt; m a -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#byDurationM"><span class="hs-identifier hs-var">H.byDurationM</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EpochStateView has not been initialized within 15 seconds&quot;</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><span class="annottext">IO (Maybe (AnyNewEpochState, SlotNo, BlockNo))
-&gt; m (Maybe (AnyNewEpochState, SlotNo, BlockNo))
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">H.evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
-&gt; IO (Maybe (AnyNewEpochState, SlotNo, BlockNo))
forall a. IORef a -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IORef.html#readIORef"><span class="hs-identifier hs-var">readIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
</span><a href="#local-6989586621679566328"><span class="hs-identifier hs-var">epochStateView</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (Maybe (AnyNewEpochState, SlotNo, BlockNo))
-&gt; (Maybe (AnyNewEpochState, SlotNo, BlockNo) -&gt; m a) -&gt; m a
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m a
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m a)
-&gt; Maybe (AnyNewEpochState, SlotNo, BlockNo)
-&gt; m a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">H.failure</span></a></span><span> </span><span class="annot"><span class="annottext">(AnyNewEpochState, SlotNo, BlockNo) -&gt; m a
</span><a href="#local-6989586621679566329"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Create a background thread listening for new epoch states. New epoch states are available to access</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- through 'EpochStateView', using query functions.</span><span>
</span><span id="line-252"></span><span id="local-6989586621679565644"><span class="annot"><a href="Testnet.Components.Query.html#getEpochStateView"><span class="hs-identifier hs-type">getEpochStateView</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/33ljpp1xjs9plf850ylrvspzkd808zh4-resourcet-lib-resourcet-1.3.0-haddock-doc/share/doc/resourcet/html/src/Control.Monad.Trans.Resource.Internal.html#MonadResource"><span class="hs-identifier hs-type">MonadResource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565644"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565644"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/exceptions-0.10.7/src/Control.Monad.Catch.html#MonadCatch"><span class="hs-identifier hs-type">MonadCatch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565644"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#NodeConfigFile"><span class="hs-identifier hs-type">NodeConfigFile</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.IO.Internal.Base.html#In"><span class="hs-identifier hs-type">In</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ node Yaml configuration file path</span></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.IO.Internal.Base.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ node socket path</span></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565644"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span></span><span>
</span><span id="line-260"></span><span id="getEpochStateView"><span class="annot"><span class="annottext">getEpochStateView :: forall (m :: * -&gt; *).
(HasCallStack, MonadResource m, MonadTest m, MonadCatch m) =&gt;
NodeConfigFile 'In -&gt; SocketPath -&gt; m EpochStateView
</span><a href="Testnet.Components.Query.html#getEpochStateView"><span class="hs-identifier hs-var hs-var">getEpochStateView</span></a></span></span><span> </span><span id="local-6989586621679566361"><span class="annot"><span class="annottext">NodeConfigFile 'In
</span><a href="#local-6989586621679566361"><span class="hs-identifier hs-var">nodeConfigFile</span></a></span></span><span> </span><span id="local-6989586621679566362"><span class="annot"><span class="annottext">SocketPath
</span><a href="#local-6989586621679566362"><span class="hs-identifier hs-var">socketPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m EpochStateView) -&gt; m EpochStateView
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m EpochStateView) -&gt; m EpochStateView)
-&gt; (HasCallStack =&gt; m EpochStateView) -&gt; m EpochStateView
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679566391"><span class="annot"><span class="annottext">IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
</span><a href="#local-6989586621679566391"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo)))
-&gt; m (IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo)))
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">H.evalIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo)))
 -&gt; m (IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))))
-&gt; IO (IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo)))
-&gt; m (IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AnyNewEpochState, SlotNo, BlockNo)
-&gt; IO (IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo)))
forall a. a -&gt; IO (IORef a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IORef.html#newIORef"><span class="hs-identifier hs-var">newIORef</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AnyNewEpochState, SlotNo, BlockNo)
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">IO (Either FoldBlocksError (ConditionResult, Maybe Any)) -&gt; m ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTest m, MonadResource m, MonadCatch m) =&gt;
IO a -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Concurrent.html#asyncRegister_"><span class="hs-identifier hs-var">H.asyncRegister_</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either FoldBlocksError (ConditionResult, Maybe Any)) -&gt; m ())
-&gt; ((AnyNewEpochState
     -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe Any) IO ConditionResult)
    -&gt; IO (Either FoldBlocksError (ConditionResult, Maybe Any)))
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe Any) IO ConditionResult)
-&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT FoldBlocksError IO (ConditionResult, Maybe Any)
-&gt; IO (Either FoldBlocksError (ConditionResult, Maybe Any))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT FoldBlocksError IO (ConditionResult, Maybe Any)
 -&gt; IO (Either FoldBlocksError (ConditionResult, Maybe Any)))
-&gt; ((AnyNewEpochState
     -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe Any) IO ConditionResult)
    -&gt; ExceptT FoldBlocksError IO (ConditionResult, Maybe Any))
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe Any) IO ConditionResult)
-&gt; IO (Either FoldBlocksError (ConditionResult, Maybe Any))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NodeConfigFile 'In
-&gt; SocketPath
-&gt; ValidationMode
-&gt; EpochNo
-&gt; Maybe Any
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe Any) IO ConditionResult)
-&gt; ExceptT FoldBlocksError IO (ConditionResult, Maybe Any)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) s.
MonadIOTransError FoldBlocksError t m =&gt;
NodeConfigFile 'In
-&gt; SocketPath
-&gt; ValidationMode
-&gt; EpochNo
-&gt; s
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT s IO ConditionResult)
-&gt; t m (ConditionResult, s)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#foldEpochState"><span class="hs-identifier hs-var">foldEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">NodeConfigFile 'In
</span><a href="#local-6989586621679566361"><span class="hs-identifier hs-var">nodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">SocketPath
</span><a href="#local-6989586621679566362"><span class="hs-identifier hs-var">socketPath</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationMode
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#QuickValidation"><span class="hs-identifier hs-var">QuickValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-var">EpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
forall a. Bounded a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#maxBound"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Any
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">((AnyNewEpochState
  -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe Any) IO ConditionResult)
 -&gt; m ())
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe Any) IO ConditionResult)
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679566395"><span class="annot"><span class="annottext">AnyNewEpochState
</span><a href="#local-6989586621679566395"><span class="hs-identifier hs-var">epochState</span></a></span></span><span> </span><span id="local-6989586621679566396"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679566396"><span class="hs-identifier hs-var">slotNumber</span></a></span></span><span> </span><span id="local-6989586621679566397"><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621679566397"><span class="hs-identifier hs-var">blockNumber</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; StateT (Maybe Any) IO ()
forall a. IO a -&gt; StateT (Maybe Any) IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (Maybe Any) IO ())
-&gt; (Maybe (AnyNewEpochState, SlotNo, BlockNo) -&gt; IO ())
-&gt; Maybe (AnyNewEpochState, SlotNo, BlockNo)
-&gt; StateT (Maybe Any) IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
-&gt; Maybe (AnyNewEpochState, SlotNo, BlockNo) -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IORef.html#writeIORef"><span class="hs-identifier hs-var">writeIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
</span><a href="#local-6989586621679566391"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (AnyNewEpochState, SlotNo, BlockNo)
 -&gt; StateT (Maybe Any) IO ())
-&gt; Maybe (AnyNewEpochState, SlotNo, BlockNo)
-&gt; StateT (Maybe Any) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(AnyNewEpochState, SlotNo, BlockNo)
-&gt; Maybe (AnyNewEpochState, SlotNo, BlockNo)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyNewEpochState
</span><a href="#local-6989586621679566395"><span class="hs-identifier hs-var">epochState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679566396"><span class="hs-identifier hs-var">slotNumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621679566397"><span class="hs-identifier hs-var">blockNumber</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">ConditionResult -&gt; StateT (Maybe Any) IO ConditionResult
forall a. a -&gt; StateT (Maybe Any) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ConditionResult
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#ConditionNotMet"><span class="hs-identifier hs-var">ConditionNotMet</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">EpochStateView -&gt; m EpochStateView
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochStateView -&gt; m EpochStateView)
-&gt; EpochStateView -&gt; m EpochStateView
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NodeConfigFile 'In
-&gt; SocketPath
-&gt; IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
-&gt; EpochStateView
</span><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-var">EpochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">NodeConfigFile 'In
</span><a href="#local-6989586621679566361"><span class="hs-identifier hs-var">nodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">SocketPath
</span><a href="#local-6989586621679566362"><span class="hs-identifier hs-var">socketPath</span></a></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (AnyNewEpochState, SlotNo, BlockNo))
</span><a href="#local-6989586621679566391"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- | Watch the epoch state view until the guard function returns 'Just' or the timeout epoch is reached.</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- Executes the guard function every 300ms. Waits for at most @maxWait@ epochs.</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- The function will return the result of the guard function if it is met within the number of epochs,</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- otherwise it will return @Nothing@.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="Testnet.Components.Query.html#watchEpochStateUpdate"><span class="hs-identifier hs-type">watchEpochStateUpdate</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679565596"><span class="annot"><a href="#local-6989586621679565596"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679565597"><span class="annot"><a href="#local-6989586621679565597"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565596"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565596"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565596"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The info to access the epoch state</span></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The maximum number of epochs to wait</span></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565596"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565597"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ The guard function (@Just@ if the condition is met, @Nothing@ otherwise)</span></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565596"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565597"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span id="watchEpochStateUpdate"><span class="annot"><span class="annottext">watchEpochStateUpdate :: forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView
-&gt; EpochInterval
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe a))
-&gt; m (Maybe a)
</span><a href="Testnet.Components.Query.html#watchEpochStateUpdate"><span class="hs-identifier hs-var hs-var">watchEpochStateUpdate</span></a></span></span><span> </span><span id="local-6989586621679566415"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566415"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span><span> </span><span id="local-6989586621679566416"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679566416"><span class="hs-identifier hs-var">maxWait</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679566417"><span class="annot"><span class="annottext">(AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe a)
</span><a href="#local-6989586621679566417"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m (Maybe a)) -&gt; m (Maybe a)
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m (Maybe a)) -&gt; m (Maybe a))
-&gt; (HasCallStack =&gt; m (Maybe a)) -&gt; m (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566429"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566429"><span class="hs-identifier hs-var">newEpochState</span></a></span></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m AnyNewEpochState
forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadAssertion m, MonadIO m) =&gt;
EpochStateView -&gt; m AnyNewEpochState
</span><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier hs-var">getEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566415"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span id="local-6989586621679566430"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566430"><span class="hs-identifier hs-var">currentEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era) -&gt; EpochNo
forall era. NewEpochState era -&gt; EpochNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEL"><span class="hs-identifier hs-var">L.nesEL</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566429"><span class="hs-identifier hs-var">newEpochState</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="annottext">Word64 -&gt; m (Maybe a)
</span><a href="#local-6989586621679566432"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; m (Maybe a)) -&gt; Word64 -&gt; m (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566430"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679566416"><span class="hs-identifier hs-var">maxWait</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><a href="#local-6989586621679566432"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565596"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565597"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>      </span><span id="local-6989586621679566432"><span class="annot"><span class="annottext">go :: Word64 -&gt; m (Maybe a)
</span><a href="#local-6989586621679566432"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679566433"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566433"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621679566434"><span class="annot"><span class="annottext">newEpochStateDetails :: (AnyNewEpochState, SlotNo, BlockNo)
</span><a href="#local-6989586621679566434"><span class="hs-identifier hs-var">newEpochStateDetails</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566444"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566444"><span class="hs-identifier hs-var">newEpochState'</span></a></span></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo)
    -&gt; m (AnyNewEpochState, SlotNo, BlockNo))
-&gt; m (AnyNewEpochState, SlotNo, BlockNo)
forall (m :: * -&gt; *) a.
(HasCallStack, MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m a) -&gt; m a
</span><a href="Testnet.Components.Query.html#getEpochStateDetails"><span class="hs-identifier hs-var">getEpochStateDetails</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566415"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">(AnyNewEpochState, SlotNo, BlockNo)
-&gt; m (AnyNewEpochState, SlotNo, BlockNo)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span id="local-6989586621679566445"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566445"><span class="hs-identifier hs-var">currentEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era) -&gt; EpochNo
forall era. NewEpochState era -&gt; EpochNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEL"><span class="hs-identifier hs-var">L.nesEL</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566444"><span class="hs-identifier hs-var">newEpochState'</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><span class="annottext">(AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe a)
</span><a href="#local-6989586621679566417"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(AnyNewEpochState, SlotNo, BlockNo)
</span><a href="#local-6989586621679566434"><span class="hs-identifier hs-var">newEpochStateDetails</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe a) -&gt; (Maybe a -&gt; m (Maybe a)) -&gt; m (Maybe a)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-288"></span><span>          </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679566446"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566446"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566446"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>          </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-290"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566445"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566433"><span class="hs-identifier hs-var">timeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-291"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-292"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; m ()
forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadIO m) =&gt;
Int -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Concurrent.html#threadDelay"><span class="hs-identifier hs-var">H.threadDelay</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">300_000</span></span><span>
</span><span id="line-293"></span><span>              </span><span class="annot"><span class="annottext">Word64 -&gt; m (Maybe a)
</span><a href="#local-6989586621679566432"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679566433"><span class="hs-identifier hs-var">timeout</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><span class="hs-comment">-- | Retrieve all UTxOs map from the epoch state view.</span></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Testnet.Components.Query.html#findAllUtxos"><span class="hs-identifier hs-type">findAllUtxos</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679565671"><span class="annot"><a href="#local-6989586621679565671"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679565670"><span class="annot"><a href="#local-6989586621679565670"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565670"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565670"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565670"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyBasedEra"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565671"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565670"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565671"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span id="findAllUtxos"><span class="annot"><span class="annottext">findAllUtxos :: forall era (m :: * -&gt; *).
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; ShelleyBasedEra era -&gt; m (UTxO era)
</span><a href="Testnet.Components.Query.html#findAllUtxos"><span class="hs-identifier hs-var hs-var">findAllUtxos</span></a></span></span><span> </span><span id="local-6989586621679566456"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566456"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566457"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566457"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m (UTxO era)) -&gt; m (UTxO era)
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m (UTxO era)) -&gt; m (UTxO era))
-&gt; (HasCallStack =&gt; m (UTxO era)) -&gt; m (UTxO era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span id="local-6989586621679566482"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566482"><span class="hs-identifier hs-var">sbe'</span></a></span></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566483"><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><a href="#local-6989586621679566483"><span class="hs-identifier hs-var">tbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m AnyNewEpochState
forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadAssertion m, MonadIO m) =&gt;
EpochStateView -&gt; m AnyNewEpochState
</span><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier hs-var">getEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566456"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">era :~: era
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Type.Equality.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (era :~: era) -&gt; m (era :~: era)
forall (m :: * -&gt; *) e a.
(MonadTest m, Show e, HasCallStack) =&gt;
Either e a -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#leftFail"><span class="hs-identifier hs-var">H.leftFail</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String (era :~: era) -&gt; m (era :~: era))
-&gt; Either String (era :~: era) -&gt; m (era :~: era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; ShelleyBasedEra era -&gt; Either String (era :~: era)
forall (eon :: * -&gt; *) expectedEra receivedEra (m :: * -&gt; *).
(HasCallStack, TestEquality eon, Show (eon expectedEra),
 Show (eon receivedEra), MonadError String m) =&gt;
eon expectedEra
-&gt; eon receivedEra -&gt; m (expectedEra :~: receivedEra)
</span><a href="Testnet.Property.Assert.html#assertErasEqual"><span class="hs-identifier hs-var">assertErasEqual</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566457"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566482"><span class="hs-identifier hs-var">sbe'</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">UTxO era -&gt; m (UTxO era)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(UTxO era -&gt; m (UTxO era))
-&gt; (Map TxIn (TxOut CtxUTxO era) -&gt; UTxO era)
-&gt; Map TxIn (TxOut CtxUTxO era)
-&gt; m (UTxO era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO era) -&gt; UTxO era
forall era. Map TxIn (TxOut CtxUTxO era) -&gt; UTxO era
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO era) -&gt; m (UTxO era))
-&gt; Map TxIn (TxOut CtxUTxO era) -&gt; m (UTxO era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LedgerTables
     (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
-&gt; Map TxIn (TxOut CtxUTxO era)
forall era.
ShelleyBasedEra era
-&gt; LedgerTables
     (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
-&gt; Map TxIn (TxOut CtxUTxO era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#getLedgerTablesUTxOValues"><span class="hs-identifier hs-var">getLedgerTablesUTxOValues</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
ShelleyBasedEra era
</span><a href="#local-6989586621679566482"><span class="hs-identifier hs-var">sbe'</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><a href="#local-6989586621679566483"><span class="hs-identifier hs-var">tbs</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><span class="hs-comment">-- | Retrieve utxos from the epoch state view for an address.</span></span><span>
</span><span id="line-310"></span><span id="local-6989586621679565694"><span id="local-6989586621679565695"><span class="annot"><a href="Testnet.Components.Query.html#findUtxosWithAddress"><span class="hs-identifier hs-type">findUtxosWithAddress</span></a></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565694"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565694"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565694"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyBasedEra"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565695"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Address</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565694"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565695"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-319"></span><span id="findUtxosWithAddress"><span class="annot"><span class="annottext">findUtxosWithAddress :: forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; ShelleyBasedEra era -&gt; Text -&gt; m (UTxO era)
</span><a href="Testnet.Components.Query.html#findUtxosWithAddress"><span class="hs-identifier hs-var hs-var">findUtxosWithAddress</span></a></span></span><span> </span><span id="local-6989586621679566499"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566499"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566500"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566500"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span id="local-6989586621679566501"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679566501"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m (UTxO era)) -&gt; m (UTxO era)
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m (UTxO era)) -&gt; m (UTxO era))
-&gt; (HasCallStack =&gt; m (UTxO era)) -&gt; m (UTxO era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679566544"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679566544"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; ShelleyBasedEra era -&gt; m (UTxO era)
forall era (m :: * -&gt; *).
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; ShelleyBasedEra era -&gt; m (UTxO era)
</span><a href="Testnet.Components.Query.html#findAllUtxos"><span class="hs-identifier hs-var">findAllUtxos</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566499"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566500"><span class="hs-identifier hs-var">sbe</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Finding UTxOs for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679566501"><span class="hs-identifier hs-var">address</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566546"><span class="annot"><span class="annottext">cEra :: CardanoEra era
</span><a href="#local-6989586621679566546"><span class="hs-identifier hs-var hs-var">cEra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era -&gt; CardanoEra era
forall era. ShelleyBasedEra era -&gt; CardanoEra era
forall (eon :: * -&gt; *) era.
ToCardanoEra eon =&gt;
eon era -&gt; CardanoEra era
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Core.html#toCardanoEra"><span class="hs-identifier hs-var">toCardanoEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566500"><span class="hs-identifier hs-var">sbe</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-comment">-- ledger address</span><span>
</span><span id="line-324"></span><span>  </span><span id="local-6989586621679566548"><span class="annot"><span class="annottext">AddressInEra era
</span><a href="#local-6989586621679566548"><span class="hs-identifier hs-var">address'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (AddressInEra era) -&gt; m (AddressInEra era)
forall (m :: * -&gt; *) e a.
(MonadTest m, Show e, HasCallStack) =&gt;
Either e a -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#leftFail"><span class="hs-identifier hs-var">H.leftFail</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String (AddressInEra era) -&gt; m (AddressInEra era))
-&gt; Either String (AddressInEra era) -&gt; m (AddressInEra era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">CardanoEra era -&gt; AddressAny -&gt; Either String (AddressInEra era)
forall era.
CardanoEra era -&gt; AddressAny -&gt; Either String (AddressInEra era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Address.html#anyAddressInEra"><span class="hs-identifier hs-var">anyAddressInEra</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679566546"><span class="hs-identifier hs-var">cEra</span></a></span><span> </span><span class="annot"><span class="annottext">(AddressAny -&gt; Either String (AddressInEra era))
-&gt; Either String AddressAny -&gt; Either String (AddressInEra era)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Maybe AddressAny -&gt; Either String AddressAny
forall {a} {b}. a -&gt; Maybe b -&gt; Either a b
</span><a href="#local-6989586621679566551"><span class="hs-identifier hs-var">maybeToEither</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not deserialize address: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679566501"><span class="hs-identifier hs-var">address</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsType AddressAny -&gt; Text -&gt; Maybe AddressAny
forall addr.
SerialiseAddress addr =&gt;
AsType addr -&gt; Text -&gt; Maybe addr
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Address.html#deserialiseAddress"><span class="hs-identifier hs-var">deserialiseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">AsType AddressAny
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Address.html#AsAddressAny"><span class="hs-identifier hs-var">AsAddressAny</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679566501"><span class="hs-identifier hs-var">address</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566554"><span class="annot"><span class="annottext">utxos' :: UTxO era
</span><a href="#local-6989586621679566554"><span class="hs-identifier hs-var hs-var">utxos'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxOut CtxUTxO era -&gt; Bool) -&gt; UTxO era -&gt; UTxO era
forall era. (TxOut CtxUTxO era -&gt; Bool) -&gt; UTxO era -&gt; UTxO era
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.UTxO.html#filter"><span class="hs-identifier hs-var">Utxo.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.Output.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span id="local-6989586621679566557"><span class="annot"><span class="annottext">AddressInEra era
</span><a href="#local-6989586621679566557"><span class="hs-identifier hs-var">txAddr</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxOutValue era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressInEra era
</span><a href="#local-6989586621679566557"><span class="hs-identifier hs-var">txAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra era -&gt; AddressInEra era -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra era
</span><a href="#local-6989586621679566548"><span class="hs-identifier hs-var">address'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679566544"><span class="hs-identifier hs-var">utxos</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO era) -&gt; String)
-&gt; [(TxIn, TxOut CtxUTxO era)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO era) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxIn, TxOut CtxUTxO era)] -&gt; [String])
-&gt; [(TxIn, TxOut CtxUTxO era)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; [Item (UTxO era)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IsList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679566554"><span class="hs-identifier hs-var">utxos'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><span class="annottext">UTxO era -&gt; m (UTxO era)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679566554"><span class="hs-identifier hs-var">utxos'</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679566551"><span class="annot"><span class="annottext">maybeToEither :: a -&gt; Maybe b -&gt; Either a b
</span><a href="#local-6989586621679566551"><span class="hs-identifier hs-var hs-var">maybeToEither</span></a></span></span><span> </span><span id="local-6989586621679566559"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566559"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; (b -&gt; Either a b) -&gt; Maybe b -&gt; Either a b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566559"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><span class="hs-comment">-- | Retrieve a one largest utxo</span></span><span>
</span><span id="line-336"></span><span id="local-6989586621679565729"><span id="local-6989586621679565730"><span class="annot"><a href="Testnet.Components.Query.html#findLargestUtxoWithAddress"><span class="hs-identifier hs-type">findLargestUtxoWithAddress</span></a></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565729"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565729"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565729"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyBasedEra"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565730"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Address</span></span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565729"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.Output.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.Output.html#CtxUTxO"><span class="hs-identifier hs-type">CtxUTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565730"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-345"></span><span id="findLargestUtxoWithAddress"><span class="annot"><span class="annottext">findLargestUtxoWithAddress :: forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ShelleyBasedEra era
-&gt; Text
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
</span><a href="Testnet.Components.Query.html#findLargestUtxoWithAddress"><span class="hs-identifier hs-var hs-var">findLargestUtxoWithAddress</span></a></span></span><span> </span><span id="local-6989586621679566569"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566569"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566570"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566570"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span id="local-6989586621679566571"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679566571"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m (Maybe (TxIn, TxOut CtxUTxO era)))
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m (Maybe (TxIn, TxOut CtxUTxO era)))
 -&gt; m (Maybe (TxIn, TxOut CtxUTxO era)))
-&gt; (HasCallStack =&gt; m (Maybe (TxIn, TxOut CtxUTxO era)))
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621679566586"><span class="annot"><span class="annottext">[(TxIn, TxOut CtxUTxO era)]
</span><a href="#local-6989586621679566586"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; [(TxIn, TxOut CtxUTxO era)]
UTxO era -&gt; [Item (UTxO era)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IsList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">(UTxO era -&gt; [(TxIn, TxOut CtxUTxO era)])
-&gt; m (UTxO era) -&gt; m [(TxIn, TxOut CtxUTxO era)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; ShelleyBasedEra era -&gt; Text -&gt; m (UTxO era)
forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; ShelleyBasedEra era -&gt; Text -&gt; m (UTxO era)
</span><a href="Testnet.Components.Query.html#findUtxosWithAddress"><span class="hs-identifier hs-var">findUtxosWithAddress</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566569"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566570"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679566571"><span class="hs-identifier hs-var">address</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span class="annot"><span class="annottext">Maybe (TxIn, TxOut CtxUTxO era)
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">(Maybe (TxIn, TxOut CtxUTxO era)
 -&gt; m (Maybe (TxIn, TxOut CtxUTxO era)))
-&gt; ([(TxIn, TxOut CtxUTxO era)] -&gt; Maybe (TxIn, TxOut CtxUTxO era))
-&gt; [(TxIn, TxOut CtxUTxO era)]
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxIn, TxOut CtxUTxO era)] -&gt; Maybe (TxIn, TxOut CtxUTxO era)
forall a. [a] -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><span class="annottext">([(TxIn, TxOut CtxUTxO era)]
 -&gt; m (Maybe (TxIn, TxOut CtxUTxO era)))
-&gt; [(TxIn, TxOut CtxUTxO era)]
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO era) -&gt; Down Coin)
-&gt; [(TxIn, TxOut CtxUTxO era)] -&gt; [(TxIn, TxOut CtxUTxO era)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#sortOn"><span class="hs-identifier hs-var">sortOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.Output.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566588"><span class="annot"><span class="annottext">TxOutValue era
</span><a href="#local-6989586621679566588"><span class="hs-identifier hs-var">txOutValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Down Coin
forall a. a -&gt; Down a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Ord.html#Down"><span class="hs-identifier hs-var">Down</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Down Coin) -&gt; Coin -&gt; Down Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutValue era -&gt; Coin
forall era. TxOutValue era -&gt; Coin
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.Output.html#txOutValueToLovelace"><span class="hs-identifier hs-var">txOutValueToLovelace</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutValue era
</span><a href="#local-6989586621679566588"><span class="hs-identifier hs-var">txOutValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(TxIn, TxOut CtxUTxO era)]
</span><a href="#local-6989586621679566586"><span class="hs-identifier hs-var">utxos</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Retrieve a largest UTxO for a payment key info - a convenience wrapper for</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- 'findLargestUtxoWithAddress'.</span><span>
</span><span id="line-353"></span><span id="local-6989586621679565741"><span id="local-6989586621679565742"><span class="annot"><a href="Testnet.Components.Query.html#findLargestUtxoForPaymentKey"><span class="hs-identifier hs-type">findLargestUtxoForPaymentKey</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565741"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565741"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565741"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyBasedEra"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565742"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Testnet.Types.html#PaymentKeyInfo"><span class="hs-identifier hs-type">PaymentKeyInfo</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565741"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span></span></span><span>
</span><span id="line-362"></span><span id="findLargestUtxoForPaymentKey"><span class="annot"><span class="annottext">findLargestUtxoForPaymentKey :: forall (m :: * -&gt; *) era.
(MonadTest m, MonadAssertion m, MonadIO m, HasCallStack) =&gt;
EpochStateView -&gt; ShelleyBasedEra era -&gt; PaymentKeyInfo -&gt; m TxIn
</span><a href="Testnet.Components.Query.html#findLargestUtxoForPaymentKey"><span class="hs-identifier hs-var hs-var">findLargestUtxoForPaymentKey</span></a></span></span><span> </span><span id="local-6989586621679566600"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566600"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566601"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566601"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span id="local-6989586621679566602"><span class="annot"><span class="annottext">PaymentKeyInfo
</span><a href="#local-6989586621679566602"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m TxIn) -&gt; m TxIn
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m TxIn) -&gt; m TxIn)
-&gt; (HasCallStack =&gt; m TxIn) -&gt; m TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>    </span><span id="local-6989586621679566626"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679566626"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO era) -&gt; TxIn)
-&gt; m (TxIn, TxOut CtxUTxO era) -&gt; m TxIn
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut CtxUTxO era) -&gt; TxIn
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">(m (TxIn, TxOut CtxUTxO era) -&gt; m TxIn)
-&gt; (m (Maybe (TxIn, TxOut CtxUTxO era))
    -&gt; m (TxIn, TxOut CtxUTxO era))
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
-&gt; m TxIn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe (TxIn, TxOut CtxUTxO era)) -&gt; m (TxIn, TxOut CtxUTxO era)
forall (m :: * -&gt; *) a.
(MonadTest m, HasCallStack) =&gt;
m (Maybe a) -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#nothingFailM"><span class="hs-identifier hs-var">H.nothingFailM</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span class="annot"><span class="annottext">(m (Maybe (TxIn, TxOut CtxUTxO era)) -&gt; m TxIn)
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era)) -&gt; m TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ShelleyBasedEra era
-&gt; Text
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ShelleyBasedEra era
-&gt; Text
-&gt; m (Maybe (TxIn, TxOut CtxUTxO era))
</span><a href="Testnet.Components.Query.html#findLargestUtxoWithAddress"><span class="hs-identifier hs-var">findLargestUtxoWithAddress</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566600"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566601"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaymentKeyInfo -&gt; Text
</span><a href="Testnet.Types.html#paymentKeyInfoAddr"><span class="hs-identifier hs-var">paymentKeyInfoAddr</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentKeyInfo
</span><a href="#local-6989586621679566602"><span class="hs-identifier hs-var">address</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Largest UTxO for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaymentKeyInfo -&gt; Text
</span><a href="Testnet.Types.html#paymentKeyInfoAddr"><span class="hs-identifier hs-var">paymentKeyInfoAddr</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentKeyInfo
</span><a href="#local-6989586621679566602"><span class="hs-identifier hs-var">address</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679566626"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">TxIn -&gt; m TxIn
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679566626"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | @checkDRepsNumber config socket execConfig n@</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- wait for the number of DReps being @n@ for two epochs. If</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- this number is not attained before two epochs, the test is failed.</span><span>
</span><span id="line-374"></span><span id="local-6989586621679565748"><span class="annot"><a href="Testnet.Components.Query.html#checkDRepsNumber"><span class="hs-identifier hs-type">checkDRepsNumber</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyBasedEra"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Core.html#ConwayEra"><span class="hs-identifier hs-type">ConwayEra</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The era in which the test runs</span></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565748"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-383"></span><span id="checkDRepsNumber"><span class="annot"><span class="annottext">checkDRepsNumber :: forall (m :: * -&gt; *).
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; ShelleyBasedEra ConwayEra -&gt; Int -&gt; m ()
</span><a href="Testnet.Components.Query.html#checkDRepsNumber"><span class="hs-identifier hs-var hs-var">checkDRepsNumber</span></a></span></span><span> </span><span id="local-6989586621679566635"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566635"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566636"><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra
</span><a href="#local-6989586621679566636"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span id="local-6989586621679566637"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679566637"><span class="hs-identifier hs-var">expectedDRepsNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m ()) -&gt; m ()
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m ()) -&gt; m ()) -&gt; (HasCallStack =&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ShelleyBasedEra ConwayEra
-&gt; (Map (Credential 'DRepRole) DRepState -&gt; Maybe ())
-&gt; m ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ShelleyBasedEra ConwayEra
-&gt; (Map (Credential 'DRepRole) DRepState -&gt; Maybe a)
-&gt; m a
</span><a href="Testnet.Components.Query.html#checkDRepState"><span class="hs-identifier hs-var">checkDRepState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566635"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra
</span><a href="#local-6989586621679566636"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">((Map (Credential 'DRepRole) DRepState -&gt; Maybe ()) -&gt; m ())
-&gt; (Map (Credential 'DRepRole) DRepState -&gt; Maybe ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679566648"><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679566648"><span class="hs-identifier hs-var">dreps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState -&gt; Int
forall a. Map (Credential 'DRepRole) a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679566648"><span class="hs-identifier hs-var">dreps</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679566637"><span class="hs-identifier hs-var">expectedDRepsNumber</span></a></span><span>
</span><span id="line-386"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- | @checkDRepState sbe configurationFile socketPath execConfig f@</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- This functions helps check properties about the DRep state.</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- It waits up to two epochs for the result of applying @f@ to the DRepState</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- to become 'Just'. If @f@ keeps returning 'Nothing' the test fails.</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- If @f@ returns 'Just', the contents of the 'Just' are returned.</span><span>
</span><span id="line-394"></span><span id="local-6989586621679565755"><span id="local-6989586621679565756"><span class="annot"><a href="Testnet.Components.Query.html#checkDRepState"><span class="hs-identifier hs-type">checkDRepState</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565755"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565755"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565755"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyBasedEra"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Core.html#ConwayEra"><span class="hs-identifier hs-type">ConwayEra</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The era in which the test runs</span></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Keys.Internal.html#DRepRole"><span class="hs-identifier hs-type">DRepRole</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>          </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.DRep.html#DRepState"><span class="hs-identifier hs-type">DRepState</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565756"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ A function that checks whether the DRep state is correct or up to date</span><span>
</span><span id="line-404"></span><span>                  </span><span class="hs-comment">-- and potentially inspects it.</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565755"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565756"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-406"></span><span id="checkDRepState"><span class="annot"><span class="annottext">checkDRepState :: forall (m :: * -&gt; *) a.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ShelleyBasedEra ConwayEra
-&gt; (Map (Credential 'DRepRole) DRepState -&gt; Maybe a)
-&gt; m a
</span><a href="Testnet.Components.Query.html#checkDRepState"><span class="hs-identifier hs-var hs-var">checkDRepState</span></a></span></span><span> </span><span id="local-6989586621679566657"><span class="annot"><span class="annottext">epochStateView :: EpochStateView
</span><a href="#local-6989586621679566657"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span class="hs-special">{</span><span id="local-6989586621679566658"><span class="annot"><span class="annottext">NodeConfigFile 'In
nodeConfigPath :: EpochStateView -&gt; NodeConfigFile 'In
nodeConfigPath :: NodeConfigFile 'In
</span><a href="Testnet.Components.Query.html#nodeConfigPath"><span class="hs-identifier hs-var hs-var">nodeConfigPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566659"><span class="annot"><span class="annottext">SocketPath
socketPath :: EpochStateView -&gt; SocketPath
socketPath :: SocketPath
</span><a href="Testnet.Components.Query.html#socketPath"><span class="hs-identifier hs-var hs-var">socketPath</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679566660"><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra
</span><a href="#local-6989586621679566660"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span id="local-6989586621679566661"><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState -&gt; Maybe a
</span><a href="#local-6989586621679566661"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m a) -&gt; m a
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m a) -&gt; m a) -&gt; (HasCallStack =&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679566721"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679566721"><span class="hs-identifier hs-var">currentEpoch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m EpochNo
forall (m :: * -&gt; *).
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; m EpochNo
</span><a href="Testnet.Components.Query.html#getCurrentEpochNo"><span class="hs-identifier hs-var">getCurrentEpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566657"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566722"><span class="annot"><span class="annottext">terminationEpoch :: EpochNo
</span><a href="#local-6989586621679566722"><span class="hs-identifier hs-var hs-var">terminationEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo
forall a. Enum a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#succ"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochNo -&gt; EpochNo) -&gt; (EpochNo -&gt; EpochNo) -&gt; EpochNo -&gt; EpochNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo
forall a. Enum a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#succ"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochNo -&gt; EpochNo) -&gt; EpochNo -&gt; EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679566721"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679566724"><span class="annot"><span class="annottext">Either FoldBlocksError (ConditionResult, Maybe a)
</span><a href="#local-6989586621679566724"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either FoldBlocksError (ConditionResult, Maybe a))
-&gt; m (Either FoldBlocksError (ConditionResult, Maybe a))
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">H.evalIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either FoldBlocksError (ConditionResult, Maybe a))
 -&gt; m (Either FoldBlocksError (ConditionResult, Maybe a)))
-&gt; (ExceptT FoldBlocksError IO (ConditionResult, Maybe a)
    -&gt; IO (Either FoldBlocksError (ConditionResult, Maybe a)))
-&gt; ExceptT FoldBlocksError IO (ConditionResult, Maybe a)
-&gt; m (Either FoldBlocksError (ConditionResult, Maybe a))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT FoldBlocksError IO (ConditionResult, Maybe a)
-&gt; IO (Either FoldBlocksError (ConditionResult, Maybe a))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT FoldBlocksError IO (ConditionResult, Maybe a)
 -&gt; m (Either FoldBlocksError (ConditionResult, Maybe a)))
-&gt; ExceptT FoldBlocksError IO (ConditionResult, Maybe a)
-&gt; m (Either FoldBlocksError (ConditionResult, Maybe a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NodeConfigFile 'In
-&gt; SocketPath
-&gt; ValidationMode
-&gt; EpochNo
-&gt; Maybe a
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe a) IO ConditionResult)
-&gt; ExceptT FoldBlocksError IO (ConditionResult, Maybe a)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) s.
MonadIOTransError FoldBlocksError t m =&gt;
NodeConfigFile 'In
-&gt; SocketPath
-&gt; ValidationMode
-&gt; EpochNo
-&gt; s
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT s IO ConditionResult)
-&gt; t m (ConditionResult, s)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#foldEpochState"><span class="hs-identifier hs-var">foldEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">NodeConfigFile 'In
</span><a href="#local-6989586621679566658"><span class="hs-identifier hs-var">nodeConfigPath</span></a></span><span> </span><span class="annot"><span class="annottext">SocketPath
</span><a href="#local-6989586621679566659"><span class="hs-identifier hs-var">socketPath</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationMode
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#QuickValidation"><span class="hs-identifier hs-var">QuickValidation</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679566722"><span class="hs-identifier hs-var">terminationEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-410"></span><span>      </span><span class="annot"><span class="annottext">((AnyNewEpochState
  -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe a) IO ConditionResult)
 -&gt; ExceptT FoldBlocksError IO (ConditionResult, Maybe a))
-&gt; (AnyNewEpochState
    -&gt; SlotNo -&gt; BlockNo -&gt; StateT (Maybe a) IO ConditionResult)
-&gt; ExceptT FoldBlocksError IO (ConditionResult, Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span id="local-6989586621679566736"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566736"><span class="hs-identifier hs-var">actualEra</span></a></span></span><span> </span><span id="local-6989586621679566737"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566737"><span class="hs-identifier hs-var">newEpochState</span></a></span></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679566738"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679566738"><span class="hs-identifier hs-var">_slotNumber</span></a></span></span><span> </span><span id="local-6989586621679566739"><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621679566739"><span class="hs-identifier hs-var">_blockNumber</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">ConwayEra :~: era
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Type.Equality.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT (Maybe a) IO (ConwayEra :~: era))
-&gt; ((ConwayEra :~: era) -&gt; StateT (Maybe a) IO (ConwayEra :~: era))
-&gt; Either String (ConwayEra :~: era)
-&gt; StateT (Maybe a) IO (ConwayEra :~: era)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#either"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; StateT (Maybe a) IO (ConwayEra :~: era)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(ConwayEra :~: era) -&gt; StateT (Maybe a) IO (ConwayEra :~: era)
forall a. a -&gt; StateT (Maybe a) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String (ConwayEra :~: era)
 -&gt; StateT (Maybe a) IO (ConwayEra :~: era))
-&gt; Either String (ConwayEra :~: era)
-&gt; StateT (Maybe a) IO (ConwayEra :~: era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra
-&gt; ShelleyBasedEra era -&gt; Either String (ConwayEra :~: era)
forall (eon :: * -&gt; *) expectedEra receivedEra (m :: * -&gt; *).
(HasCallStack, TestEquality eon, Show (eon expectedEra),
 Show (eon receivedEra), MonadError String m) =&gt;
eon expectedEra
-&gt; eon receivedEra -&gt; m (expectedEra :~: receivedEra)
</span><a href="Testnet.Property.Assert.html#assertErasEqual"><span class="hs-identifier hs-var">assertErasEqual</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra
</span><a href="#local-6989586621679566660"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566736"><span class="hs-identifier hs-var">actualEra</span></a></span><span>
</span><span id="line-412"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566755"><span class="annot"><span class="annottext">dreps :: Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679566755"><span class="hs-identifier hs-var hs-var">dreps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra
-&gt; (ShelleyBasedEraConstraints ConwayEra =&gt;
    NewEpochState ConwayEra)
-&gt; NewEpochState ConwayEra
forall era a.
ShelleyBasedEra era -&gt; (ShelleyBasedEraConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#shelleyBasedEraConstraints"><span class="hs-identifier hs-var">shelleyBasedEraConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra
</span><a href="#local-6989586621679566660"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
NewEpochState ConwayEra
ShelleyBasedEraConstraints ConwayEra =&gt; NewEpochState ConwayEra
</span><a href="#local-6989586621679566737"><span class="hs-identifier hs-var">newEpochState</span></a></span><span>
</span><span id="line-413"></span><span>                      </span><span class="annot"><span class="annottext">NewEpochState ConwayEra
-&gt; Getting
     (Map (Credential 'DRepRole) DRepState)
     (NewEpochState ConwayEra)
     (Map (Credential 'DRepRole) DRepState)
-&gt; Map (Credential 'DRepRole) DRepState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState ConwayEra
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState) (EpochState ConwayEra))
-&gt; NewEpochState ConwayEra
-&gt; Const
     (Map (Credential 'DRepRole) DRepState) (NewEpochState ConwayEra)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">L.nesEsL</span></a></span><span>
</span><span id="line-414"></span><span>                       </span><span class="annot"><span class="annottext">((EpochState ConwayEra
  -&gt; Const
       (Map (Credential 'DRepRole) DRepState) (EpochState ConwayEra))
 -&gt; NewEpochState ConwayEra
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState) (NewEpochState ConwayEra))
-&gt; ((Map (Credential 'DRepRole) DRepState
     -&gt; Const
          (Map (Credential 'DRepRole) DRepState)
          (Map (Credential 'DRepRole) DRepState))
    -&gt; EpochState ConwayEra
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState) (EpochState ConwayEra))
-&gt; Getting
     (Map (Credential 'DRepRole) DRepState)
     (NewEpochState ConwayEra)
     (Map (Credential 'DRepRole) DRepState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LedgerState ConwayEra
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState) (LedgerState ConwayEra))
-&gt; EpochState ConwayEra
-&gt; Const
     (Map (Credential 'DRepRole) DRepState) (EpochState ConwayEra)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">L.esLStateL</span></a></span><span>
</span><span id="line-415"></span><span>                       </span><span class="annot"><span class="annottext">((LedgerState ConwayEra
  -&gt; Const
       (Map (Credential 'DRepRole) DRepState) (LedgerState ConwayEra))
 -&gt; EpochState ConwayEra
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState) (EpochState ConwayEra))
-&gt; ((Map (Credential 'DRepRole) DRepState
     -&gt; Const
          (Map (Credential 'DRepRole) DRepState)
          (Map (Credential 'DRepRole) DRepState))
    -&gt; LedgerState ConwayEra
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState) (LedgerState ConwayEra))
-&gt; (Map (Credential 'DRepRole) DRepState
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState)
         (Map (Credential 'DRepRole) DRepState))
-&gt; EpochState ConwayEra
-&gt; Const
     (Map (Credential 'DRepRole) DRepState) (EpochState ConwayEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CertState ConwayEra
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState) (CertState ConwayEra))
-&gt; LedgerState ConwayEra
-&gt; Const
     (Map (Credential 'DRepRole) DRepState) (LedgerState ConwayEra)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">L.lsCertStateL</span></a></span><span>
</span><span id="line-416"></span><span>                       </span><span class="annot"><span class="annottext">((CertState ConwayEra
  -&gt; Const
       (Map (Credential 'DRepRole) DRepState) (CertState ConwayEra))
 -&gt; LedgerState ConwayEra
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState) (LedgerState ConwayEra))
-&gt; ((Map (Credential 'DRepRole) DRepState
     -&gt; Const
          (Map (Credential 'DRepRole) DRepState)
          (Map (Credential 'DRepRole) DRepState))
    -&gt; CertState ConwayEra
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState) (CertState ConwayEra))
-&gt; (Map (Credential 'DRepRole) DRepState
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState)
         (Map (Credential 'DRepRole) DRepState))
-&gt; LedgerState ConwayEra
-&gt; Const
     (Map (Credential 'DRepRole) DRepState) (LedgerState ConwayEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(VState ConwayEra
 -&gt; Const (Map (Credential 'DRepRole) DRepState) (VState ConwayEra))
-&gt; CertState ConwayEra
-&gt; Const
     (Map (Credential 'DRepRole) DRepState) (CertState ConwayEra)
forall era. EraCertState era =&gt; Lens' (CertState era) (VState era)
Lens' (CertState ConwayEra) (VState ConwayEra)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.CertState.html#certVStateL"><span class="hs-identifier hs-var">L.certVStateL</span></a></span><span>
</span><span id="line-417"></span><span>                       </span><span class="annot"><span class="annottext">((VState ConwayEra
  -&gt; Const (Map (Credential 'DRepRole) DRepState) (VState ConwayEra))
 -&gt; CertState ConwayEra
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState) (CertState ConwayEra))
-&gt; ((Map (Credential 'DRepRole) DRepState
     -&gt; Const
          (Map (Credential 'DRepRole) DRepState)
          (Map (Credential 'DRepRole) DRepState))
    -&gt; VState ConwayEra
    -&gt; Const (Map (Credential 'DRepRole) DRepState) (VState ConwayEra))
-&gt; (Map (Credential 'DRepRole) DRepState
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState)
         (Map (Credential 'DRepRole) DRepState))
-&gt; CertState ConwayEra
-&gt; Const
     (Map (Credential 'DRepRole) DRepState) (CertState ConwayEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'DRepRole) DRepState
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState)
      (Map (Credential 'DRepRole) DRepState))
-&gt; VState ConwayEra
-&gt; Const (Map (Credential 'DRepRole) DRepState) (VState ConwayEra)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (Credential 'DRepRole) DRepState
 -&gt; f (Map (Credential 'DRepRole) DRepState))
-&gt; VState era -&gt; f (VState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.CertState.html#vsDRepsL"><span class="hs-identifier hs-var">L.vsDRepsL</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState -&gt; Maybe a
</span><a href="#local-6989586621679566661"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679566755"><span class="hs-identifier hs-var">dreps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-419"></span><span>          </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConditionResult -&gt; StateT (Maybe a) IO ConditionResult
forall a. a -&gt; StateT (Maybe a) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ConditionResult
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#ConditionNotMet"><span class="hs-identifier hs-var">ConditionNotMet</span></a></span><span>
</span><span id="line-420"></span><span>          </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679566763"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566763"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; StateT (Maybe a) IO ()
forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; StateT (Maybe a) IO ())
-&gt; Maybe a -&gt; StateT (Maybe a) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566763"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-421"></span><span>                       </span><span class="annot"><span class="annottext">ConditionResult -&gt; StateT (Maybe a) IO ConditionResult
forall a. a -&gt; StateT (Maybe a) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ConditionResult
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#ConditionMet"><span class="hs-identifier hs-var">ConditionMet</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either FoldBlocksError (ConditionResult, Maybe a)
</span><a href="#local-6989586621679566724"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#FoldBlocksApplyBlockError"><span class="hs-identifier hs-type">FoldBlocksApplyBlockError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#TerminationEpochReached"><span class="hs-identifier hs-type">TerminationEpochReached</span></a></span><span> </span><span id="local-6989586621679566765"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679566765"><span class="hs-identifier hs-var">epochNo</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a></span><span>
</span><span id="line-425"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;checkDRepState: condition not met before termination epoch: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679566765"><span class="hs-identifier hs-var">epochNo</span></a></span><span>
</span><span id="line-426"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is likely an error of this test.&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-427"></span><span>      </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">H.failure</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679566766"><span class="annot"><span class="annottext">FoldBlocksError
</span><a href="#local-6989586621679566766"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a></span><span>
</span><span id="line-430"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;checkDRepState: could not reach termination epoch: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; String
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Pretty.html#docToString"><span class="hs-identifier hs-var">docToString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FoldBlocksError -&gt; Doc AnsiStyle
forall e ann. Error e =&gt; e -&gt; Doc ann
forall ann. FoldBlocksError -&gt; Doc ann
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Error.html#prettyError"><span class="hs-identifier hs-var">prettyError</span></a></span><span> </span><span class="annot"><span class="annottext">FoldBlocksError
</span><a href="#local-6989586621679566766"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is probably an error unrelated to this test.&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">H.failure</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConditionResult
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-434"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a></span><span>
</span><span id="line-435"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;checkDRepState: foldEpochState returned Nothing: &quot;</span></span><span>
</span><span id="line-436"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is probably an error related to foldEpochState.&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-437"></span><span>      </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">H.failure</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConditionResult
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#ConditionNotMet"><span class="hs-identifier hs-var">ConditionNotMet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#note_"><span class="hs-identifier hs-var">H.note_</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a></span><span>
</span><span id="line-440"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;checkDRepState: foldEpochState returned Just and ConditionNotMet: &quot;</span></span><span>
</span><span id="line-441"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is probably an error related to foldEpochState.&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>      </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">H.failure</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConditionResult
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#ConditionMet"><span class="hs-identifier hs-var">ConditionMet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679566767"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566767"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-444"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566767"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="annot"><span class="hs-comment">-- | Obtain governance state from node (CLI query)</span></span><span>
</span><span id="line-447"></span><span id="local-6989586621679565795"><span id="local-6989586621679565796"><span class="annot"><a href="Testnet.Components.Query.html#getGovState"><span class="hs-identifier hs-type">getGovState</span></a></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565795"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565795"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565795"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#ConwayEraOnwards"><span class="hs-identifier hs-type">ConwayEraOnwards</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565796"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565795"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#ConwayGovState"><span class="hs-identifier hs-type">L.ConwayGovState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyLedgerEra"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565796"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The governance state</span></span><span>
</span><span id="line-455"></span><span id="getGovState"><span class="annot"><span class="annottext">getGovState :: forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
</span><a href="Testnet.Components.Query.html#getGovState"><span class="hs-identifier hs-var hs-var">getGovState</span></a></span></span><span> </span><span id="local-6989586621679566776"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566776"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566777"><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566777"><span class="hs-identifier hs-var">ceo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m (ConwayGovState (ShelleyLedgerEra era)))
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m (ConwayGovState (ShelleyLedgerEra era)))
 -&gt; m (ConwayGovState (ShelleyLedgerEra era)))
-&gt; (HasCallStack =&gt; m (ConwayGovState (ShelleyLedgerEra era)))
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span id="local-6989586621679566799"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566799"><span class="hs-identifier hs-var">sbe'</span></a></span></span><span> </span><span id="local-6989586621679566800"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566800"><span class="hs-identifier hs-var">newEpochState</span></a></span></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m AnyNewEpochState
forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadAssertion m, MonadIO m) =&gt;
EpochStateView -&gt; m AnyNewEpochState
</span><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier hs-var">getEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566776"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566801"><span class="annot"><span class="annottext">sbe :: ShelleyBasedEra era
</span><a href="#local-6989586621679566801"><span class="hs-identifier hs-var hs-var">sbe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era -&gt; ShelleyBasedEra era
forall era. ConwayEraOnwards era -&gt; ShelleyBasedEra era
forall a (f :: a -&gt; *) (g :: a -&gt; *) (era :: a).
Convert f g =&gt;
f era -&gt; g era
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.Convert.html#convert"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566777"><span class="hs-identifier hs-var">ceo</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">era :~: era
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Type.Equality.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (era :~: era) -&gt; m (era :~: era)
forall (m :: * -&gt; *) e a.
(MonadTest m, Show e, HasCallStack) =&gt;
Either e a -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#leftFail"><span class="hs-identifier hs-var">H.leftFail</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String (era :~: era) -&gt; m (era :~: era))
-&gt; Either String (era :~: era) -&gt; m (era :~: era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; ShelleyBasedEra era -&gt; Either String (era :~: era)
forall (eon :: * -&gt; *) expectedEra receivedEra (m :: * -&gt; *).
(HasCallStack, TestEquality eon, Show (eon expectedEra),
 Show (eon receivedEra), MonadError String m) =&gt;
eon expectedEra
-&gt; eon receivedEra -&gt; m (expectedEra :~: receivedEra)
</span><a href="Testnet.Property.Assert.html#assertErasEqual"><span class="hs-identifier hs-var">assertErasEqual</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566801"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566799"><span class="hs-identifier hs-var">sbe'</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(ConwayGovState (ShelleyLedgerEra era)
 -&gt; m (ConwayGovState (ShelleyLedgerEra era)))
-&gt; ConwayGovState (ShelleyLedgerEra era)
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
-&gt; (ConwayEraOnwardsConstraints era =&gt;
    ConwayGovState (ShelleyLedgerEra era))
-&gt; ConwayGovState (ShelleyLedgerEra era)
forall era a.
ConwayEraOnwards era -&gt; (ConwayEraOnwardsConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#conwayEraOnwardsConstraints"><span class="hs-identifier hs-var">conwayEraOnwardsConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566777"><span class="hs-identifier hs-var">ceo</span></a></span><span> </span><span class="annot"><span class="annottext">((ConwayEraOnwardsConstraints era =&gt;
  ConwayGovState (ShelleyLedgerEra era))
 -&gt; ConwayGovState (ShelleyLedgerEra era))
-&gt; (ConwayEraOnwardsConstraints era =&gt;
    ConwayGovState (ShelleyLedgerEra era))
-&gt; ConwayGovState (ShelleyLedgerEra era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566800"><span class="hs-identifier hs-var">newEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
-&gt; Getting
     (ConwayGovState (ShelleyLedgerEra era))
     (NewEpochState (ShelleyLedgerEra era))
     (ConwayGovState (ShelleyLedgerEra era))
-&gt; ConwayGovState (ShelleyLedgerEra era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(GovState (ShelleyLedgerEra era)
 -&gt; Const
      (ConwayGovState (ShelleyLedgerEra era))
      (GovState (ShelleyLedgerEra era)))
-&gt; NewEpochState (ShelleyLedgerEra era)
-&gt; Const
     (ConwayGovState (ShelleyLedgerEra era))
     (NewEpochState (ShelleyLedgerEra era))
Getting
  (ConwayGovState (ShelleyLedgerEra era))
  (NewEpochState (ShelleyLedgerEra era))
  (ConwayGovState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(GovState era -&gt; f (GovState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#newEpochStateGovStateL"><span class="hs-identifier hs-var">L.newEpochStateGovStateL</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="annot"><span class="hs-comment">-- | Obtain the current value of the treasury from the node</span></span><span>
</span><span id="line-462"></span><span id="local-6989586621679565844"><span class="annot"><a href="Testnet.Components.Query.html#getTreasuryValue"><span class="hs-identifier hs-type">getTreasuryValue</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565844"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565844"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565844"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565844"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">L.Coin</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The current value of the treasury</span></span><span>
</span><span id="line-469"></span><span id="getTreasuryValue"><span class="annot"><span class="annottext">getTreasuryValue :: forall (m :: * -&gt; *).
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; m Coin
</span><a href="Testnet.Components.Query.html#getTreasuryValue"><span class="hs-identifier hs-var hs-var">getTreasuryValue</span></a></span></span><span> </span><span id="local-6989586621679566819"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566819"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m Coin) -&gt; m Coin
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m Coin) -&gt; m Coin)
-&gt; (HasCallStack =&gt; m Coin) -&gt; m Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566830"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566830"><span class="hs-identifier hs-var">newEpochState</span></a></span></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m AnyNewEpochState
forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadAssertion m, MonadIO m) =&gt;
EpochStateView -&gt; m AnyNewEpochState
</span><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier hs-var">getEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566819"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">Coin -&gt; m Coin
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; m Coin) -&gt; Coin -&gt; m Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566830"><span class="hs-identifier hs-var">newEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
-&gt; Getting Coin (NewEpochState (ShelleyLedgerEra era)) Coin -&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState (ShelleyLedgerEra era)
 -&gt; Const Coin (EpochState (ShelleyLedgerEra era)))
-&gt; NewEpochState (ShelleyLedgerEra era)
-&gt; Const Coin (NewEpochState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEpochStateL"><span class="hs-identifier hs-var">L.nesEpochStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState (ShelleyLedgerEra era)
  -&gt; Const Coin (EpochState (ShelleyLedgerEra era)))
 -&gt; NewEpochState (ShelleyLedgerEra era)
 -&gt; Const Coin (NewEpochState (ShelleyLedgerEra era)))
-&gt; ((Coin -&gt; Const Coin Coin)
    -&gt; EpochState (ShelleyLedgerEra era)
    -&gt; Const Coin (EpochState (ShelleyLedgerEra era)))
-&gt; Getting Coin (NewEpochState (ShelleyLedgerEra era)) Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Const Coin Coin)
-&gt; EpochState (ShelleyLedgerEra era)
-&gt; Const Coin (EpochState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(Coin -&gt; f Coin) -&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#epochStateTreasuryL"><span class="hs-identifier hs-var">L.epochStateTreasuryL</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><span class="hs-comment">-- | Obtain minimum deposit amount for governance action from node</span></span><span>
</span><span id="line-474"></span><span id="local-6989586621679565849"><span id="local-6989586621679565850"><span class="annot"><a href="Testnet.Components.Query.html#getMinGovActionDeposit"><span class="hs-identifier hs-type">getMinGovActionDeposit</span></a></span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565849"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565849"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565849"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#ConwayEraOnwards"><span class="hs-identifier hs-type">ConwayEraOnwards</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565850"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565849"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The minimum deposit</span></span><span>
</span><span id="line-482"></span><span id="getMinGovActionDeposit"><span class="annot"><span class="annottext">getMinGovActionDeposit :: forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; ConwayEraOnwards era -&gt; m Integer
</span><a href="Testnet.Components.Query.html#getMinGovActionDeposit"><span class="hs-identifier hs-var hs-var">getMinGovActionDeposit</span></a></span></span><span> </span><span id="local-6989586621679566841"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566841"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566842"><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566842"><span class="hs-identifier hs-var">ceo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m Integer) -&gt; m Integer
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m Integer) -&gt; m Integer)
-&gt; (HasCallStack =&gt; m Integer) -&gt; m Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-483"></span><span>  </span><span id="local-6989586621679566851"><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566851"><span class="hs-identifier hs-var">govState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
</span><a href="Testnet.Components.Query.html#getGovState"><span class="hs-identifier hs-var">getGovState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566841"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566842"><span class="hs-identifier hs-var">ceo</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; m Integer
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; m Integer) -&gt; Integer -&gt; m Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
-&gt; (ConwayEraOnwardsConstraints era =&gt; Integer) -&gt; Integer
forall era a.
ConwayEraOnwards era -&gt; (ConwayEraOnwardsConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#conwayEraOnwardsConstraints"><span class="hs-identifier hs-var">conwayEraOnwardsConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566842"><span class="hs-identifier hs-var">ceo</span></a></span><span> </span><span class="annot"><span class="annottext">((ConwayEraOnwardsConstraints era =&gt; Integer) -&gt; Integer)
-&gt; (ConwayEraOnwardsConstraints era =&gt; Integer) -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566851"><span class="hs-identifier hs-var">govState</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
-&gt; Getting Integer (ConwayGovState (ShelleyLedgerEra era)) Integer
-&gt; Integer
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams (ShelleyLedgerEra era)
 -&gt; Const Integer (PParams (ShelleyLedgerEra era)))
-&gt; ConwayGovState (ShelleyLedgerEra era)
-&gt; Const Integer (ConwayGovState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(PParams era -&gt; f (PParams era))
-&gt; ConwayGovState era -&gt; f (ConwayGovState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#cgsCurPParamsL"><span class="hs-identifier hs-var">L.cgsCurPParamsL</span></a></span><span> </span><span class="annot"><span class="annottext">((PParams (ShelleyLedgerEra era)
  -&gt; Const Integer (PParams (ShelleyLedgerEra era)))
 -&gt; ConwayGovState (ShelleyLedgerEra era)
 -&gt; Const Integer (ConwayGovState (ShelleyLedgerEra era)))
-&gt; ((Integer -&gt; Const Integer Integer)
    -&gt; PParams (ShelleyLedgerEra era)
    -&gt; Const Integer (PParams (ShelleyLedgerEra era)))
-&gt; Getting Integer (ConwayGovState (ShelleyLedgerEra era)) Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Const Integer Coin)
-&gt; PParams (ShelleyLedgerEra era)
-&gt; Const Integer (PParams (ShelleyLedgerEra era))
forall era. ConwayEraPParams era =&gt; Lens' (PParams era) Coin
Lens' (PParams (ShelleyLedgerEra era)) Coin
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.PParams.html#ppGovActionDepositL"><span class="hs-identifier hs-var">L.ppGovActionDepositL</span></a></span><span>  </span><span class="annot"><span class="annottext">((Coin -&gt; Const Integer Coin)
 -&gt; PParams (ShelleyLedgerEra era)
 -&gt; Const Integer (PParams (ShelleyLedgerEra era)))
-&gt; ((Integer -&gt; Const Integer Integer)
    -&gt; Coin -&gt; Const Integer Coin)
-&gt; (Integer -&gt; Const Integer Integer)
-&gt; PParams (ShelleyLedgerEra era)
-&gt; Const Integer (PParams (ShelleyLedgerEra era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Integer) -&gt; SimpleGetter Coin Integer
forall s a. (s -&gt; a) -&gt; SimpleGetter s a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">L.unCoin</span></a></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="annot"><span class="hs-comment">-- | Obtain minimum deposit amount for DRep registration from node</span></span><span>
</span><span id="line-487"></span><span id="local-6989586621679566860"><span id="local-6989586621679566861"><span class="annot"><a href="Testnet.Components.Query.html#getMinDRepDeposit"><span class="hs-identifier hs-type">getMinDRepDeposit</span></a></span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566860"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566860"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566860"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#ConwayEraOnwards"><span class="hs-identifier hs-type">ConwayEraOnwards</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566861"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679566860"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The minimum deposit</span></span><span>
</span><span id="line-495"></span><span id="getMinDRepDeposit"><span class="annot"><span class="annottext">getMinDRepDeposit :: forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; ConwayEraOnwards era -&gt; m Integer
</span><a href="Testnet.Components.Query.html#getMinDRepDeposit"><span class="hs-identifier hs-var hs-var">getMinDRepDeposit</span></a></span></span><span> </span><span id="local-6989586621679566870"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566870"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566871"><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566871"><span class="hs-identifier hs-var">ceo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m Integer) -&gt; m Integer
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m Integer) -&gt; m Integer)
-&gt; (HasCallStack =&gt; m Integer) -&gt; m Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span>  </span><span id="local-6989586621679566880"><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566880"><span class="hs-identifier hs-var">govState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
</span><a href="Testnet.Components.Query.html#getGovState"><span class="hs-identifier hs-var">getGovState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566870"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566871"><span class="hs-identifier hs-var">ceo</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; m Integer
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; m Integer) -&gt; Integer -&gt; m Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
-&gt; (ConwayEraOnwardsConstraints era =&gt; Integer) -&gt; Integer
forall era a.
ConwayEraOnwards era -&gt; (ConwayEraOnwardsConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#conwayEraOnwardsConstraints"><span class="hs-identifier hs-var">conwayEraOnwardsConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566871"><span class="hs-identifier hs-var">ceo</span></a></span><span> </span><span class="annot"><span class="annottext">((ConwayEraOnwardsConstraints era =&gt; Integer) -&gt; Integer)
-&gt; (ConwayEraOnwardsConstraints era =&gt; Integer) -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566880"><span class="hs-identifier hs-var">govState</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
-&gt; Getting Integer (ConwayGovState (ShelleyLedgerEra era)) Integer
-&gt; Integer
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams (ShelleyLedgerEra era)
 -&gt; Const Integer (PParams (ShelleyLedgerEra era)))
-&gt; ConwayGovState (ShelleyLedgerEra era)
-&gt; Const Integer (ConwayGovState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(PParams era -&gt; f (PParams era))
-&gt; ConwayGovState era -&gt; f (ConwayGovState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#cgsCurPParamsL"><span class="hs-identifier hs-var">L.cgsCurPParamsL</span></a></span><span> </span><span class="annot"><span class="annottext">((PParams (ShelleyLedgerEra era)
  -&gt; Const Integer (PParams (ShelleyLedgerEra era)))
 -&gt; ConwayGovState (ShelleyLedgerEra era)
 -&gt; Const Integer (ConwayGovState (ShelleyLedgerEra era)))
-&gt; ((Integer -&gt; Const Integer Integer)
    -&gt; PParams (ShelleyLedgerEra era)
    -&gt; Const Integer (PParams (ShelleyLedgerEra era)))
-&gt; Getting Integer (ConwayGovState (ShelleyLedgerEra era)) Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Const Integer Coin)
-&gt; PParams (ShelleyLedgerEra era)
-&gt; Const Integer (PParams (ShelleyLedgerEra era))
forall era. ConwayEraPParams era =&gt; Lens' (PParams era) Coin
Lens' (PParams (ShelleyLedgerEra era)) Coin
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.PParams.html#ppDRepDepositL"><span class="hs-identifier hs-var">L.ppDRepDepositL</span></a></span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Const Integer Coin)
 -&gt; PParams (ShelleyLedgerEra era)
 -&gt; Const Integer (PParams (ShelleyLedgerEra era)))
-&gt; ((Integer -&gt; Const Integer Integer)
    -&gt; Coin -&gt; Const Integer Coin)
-&gt; (Integer -&gt; Const Integer Integer)
-&gt; PParams (ShelleyLedgerEra era)
-&gt; Const Integer (PParams (ShelleyLedgerEra era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Integer) -&gt; SimpleGetter Coin Integer
forall s a. (s -&gt; a) -&gt; SimpleGetter s a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">L.unCoin</span></a></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-comment">-- | Return current-ish epoch number.</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- Because we're using Ledger's 'NewEpochState', the returned epoch number won't be reflecting the current</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- epoch number during the transiontion between the epochs. In other cases it will be the true number of the</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- current epoch.</span><span>
</span><span id="line-503"></span><span id="local-6989586621679565598"><span class="annot"><a href="Testnet.Components.Query.html#getCurrentEpochNo"><span class="hs-identifier hs-type">getCurrentEpochNo</span></a></span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565598"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565598"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565598"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565598"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span></span><span>
</span><span id="line-510"></span><span id="getCurrentEpochNo"><span class="annot"><span class="annottext">getCurrentEpochNo :: forall (m :: * -&gt; *).
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView -&gt; m EpochNo
</span><a href="Testnet.Components.Query.html#getCurrentEpochNo"><span class="hs-identifier hs-var hs-var">getCurrentEpochNo</span></a></span></span><span> </span><span id="local-6989586621679566895"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566895"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m EpochNo) -&gt; m EpochNo
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m EpochNo) -&gt; m EpochNo)
-&gt; (HasCallStack =&gt; m EpochNo) -&gt; m EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-511"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566905"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566905"><span class="hs-identifier hs-var">newEpochState</span></a></span></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m AnyNewEpochState
forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadAssertion m, MonadIO m) =&gt;
EpochStateView -&gt; m AnyNewEpochState
</span><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier hs-var">getEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566895"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><span class="annottext">EpochNo -&gt; m EpochNo
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochNo -&gt; m EpochNo) -&gt; EpochNo -&gt; m EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566905"><span class="hs-identifier hs-var">newEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
-&gt; Getting EpochNo (NewEpochState (ShelleyLedgerEra era)) EpochNo
-&gt; EpochNo
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting EpochNo (NewEpochState (ShelleyLedgerEra era)) EpochNo
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochNo -&gt; f EpochNo)
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesELL"><span class="hs-identifier hs-var">L.nesELL</span></a></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-comment">-- | Assert that the value pointed by the @lens@ in the epoch state is the same as the @expected@ value</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- or it becomes the same within the @maxWait@ epochs. If the value is not reached within the time frame,</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- the test fails.</span><span>
</span><span id="line-517"></span><span class="annot"><a href="Testnet.Components.Query.html#assertNewEpochState"><span class="hs-identifier hs-type">assertNewEpochState</span></a></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679565868"><span class="annot"><a href="#local-6989586621679565868"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679565869"><span class="annot"><a href="#local-6989586621679565869"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679565867"><span class="annot"><a href="#local-6989586621679565867"><span class="hs-identifier hs-type">value</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565867"><span class="hs-identifier hs-type">value</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565867"><span class="hs-identifier hs-type">value</span></a></span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565868"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565868"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565868"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Current epoch state view. It can be obtained using the 'getEpochStateView' function.</span></span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyBasedEra"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565869"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The ShelleyBasedEra witness for current era.</span></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The maximum wait time in epochs.</span></span><span>
</span><span id="line-527"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">L.NewEpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyLedgerEra"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565869"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679565867"><span class="hs-identifier hs-type">value</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The lens to access the specific value in the epoch state.</span></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565867"><span class="hs-identifier hs-type">value</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The expected value to check in the epoch state.</span></span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span id="assertNewEpochState"><span class="annot"><span class="annottext">assertNewEpochState :: forall (m :: * -&gt; *) era value.
(HasCallStack, Show value, Eq value, MonadAssertion m, MonadTest m,
 MonadIO m) =&gt;
EpochStateView
-&gt; ShelleyBasedEra era
-&gt; EpochInterval
-&gt; Lens' (NewEpochState (ShelleyLedgerEra era)) value
-&gt; value
-&gt; m ()
</span><a href="Testnet.Components.Query.html#assertNewEpochState"><span class="hs-identifier hs-var hs-var">assertNewEpochState</span></a></span></span><span> </span><span id="local-6989586621679566917"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566917"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566918"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566918"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span id="local-6989586621679566919"><span class="annot"><span class="annottext">EpochInterval
</span><a href="#local-6989586621679566919"><span class="hs-identifier hs-var">maxWait</span></a></span></span><span> </span><span id="local-6989586621679566920"><span class="annot"><span class="annottext">Lens' (NewEpochState (ShelleyLedgerEra era)) value
</span><a href="#local-6989586621679566920"><span class="hs-identifier hs-var">lens</span></a></span></span><span> </span><span id="local-6989586621679566921"><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566921"><span class="hs-identifier hs-var">expected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m ()) -&gt; m ()
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m ()) -&gt; m ()) -&gt; (HasCallStack =&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>  </span><span id="local-6989586621679566947"><span class="annot"><span class="annottext">Maybe ()
</span><a href="#local-6989586621679566947"><span class="hs-identifier hs-var">mStateView</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; EpochInterval
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe ()))
-&gt; m (Maybe ())
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, MonadTest m, MonadAssertion m) =&gt;
EpochStateView
-&gt; EpochInterval
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe a))
-&gt; m (Maybe a)
</span><a href="Testnet.Components.Query.html#watchEpochStateUpdate"><span class="hs-identifier hs-var">watchEpochStateUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566917"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">EpochInterval
</span><a href="#local-6989586621679566919"><span class="hs-identifier hs-var">maxWait</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (Maybe ()) -&gt; (AnyNewEpochState, SlotNo, BlockNo) -&gt; m (Maybe ())
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe ())
HasCallStack =&gt; m (Maybe ())
</span><a href="#local-6989586621679566949"><span class="hs-identifier hs-var">checkEpochState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe () -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ()
</span><a href="#local-6989586621679566947"><span class="hs-identifier hs-var">mStateView</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-534"></span><span>    </span><span id="local-6989586621679566951"><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566951"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m value
HasCallStack =&gt; m value
</span><a href="#local-6989586621679566952"><span class="hs-identifier hs-var">getFromEpochStateForEra</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-comment">-- there's a tiny tiny chance that the value has changed since 'watchEpochStateUpdate'</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-comment">-- so check it again</span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566951"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">value -&gt; value -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566921"><span class="hs-identifier hs-var">expected</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; String -&gt; m ()
forall (m :: * -&gt; *) a. MonadTest m =&gt; CallStack -&gt; String -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Prim.html#failMessage"><span class="hs-identifier hs-var">H.failMessage</span></a></span><span> </span><span class="annot"><span class="annottext">CallStack
HasCallStack =&gt; CallStack
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#callStack"><span class="hs-identifier hs-var">callStack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a></span><span>
</span><span id="line-540"></span><span>           </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assertNewEpochState: expected value not reached within the time frame.&quot;</span></span><span>
</span><span id="line-541"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected value: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">value -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566921"><span class="hs-identifier hs-var">expected</span></a></span><span>
</span><span id="line-542"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Actual value: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">value -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566951"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-543"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>    </span><span class="annot"><a href="#local-6989586621679566949"><span class="hs-identifier hs-type">checkEpochState</span></a></span><span>
</span><span id="line-546"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-547"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>    </span><span id="local-6989586621679566949"><span class="annot"><span class="annottext">checkEpochState :: HasCallStack =&gt; m (Maybe ())
</span><a href="#local-6989586621679566949"><span class="hs-identifier hs-var hs-var">checkEpochState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m (Maybe ())) -&gt; m (Maybe ())
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m (Maybe ())) -&gt; m (Maybe ()))
-&gt; (HasCallStack =&gt; m (Maybe ())) -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-549"></span><span>      </span><span id="local-6989586621679566964"><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566964"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m value
HasCallStack =&gt; m value
</span><a href="#local-6989586621679566952"><span class="hs-identifier hs-var">getFromEpochStateForEra</span></a></span><span>
</span><span id="line-550"></span><span>      </span><span class="annot"><span class="annottext">Maybe () -&gt; m (Maybe ())
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe () -&gt; m (Maybe ())) -&gt; Maybe () -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566964"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">value -&gt; value -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">value
</span><a href="#local-6989586621679566921"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span>    </span><span class="annot"><a href="#local-6989586621679566952"><span class="hs-identifier hs-type">getFromEpochStateForEra</span></a></span><span>
</span><span id="line-553"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-554"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565867"><span class="hs-identifier hs-type">value</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621679566952"><span class="annot"><span class="annottext">getFromEpochStateForEra :: HasCallStack =&gt; m value
</span><a href="#local-6989586621679566952"><span class="hs-identifier hs-var hs-var">getFromEpochStateForEra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; m value) -&gt; m value
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html#withFrozenCallStack"><span class="hs-identifier hs-var">withFrozenCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; m value) -&gt; m value)
-&gt; (HasCallStack =&gt; m value) -&gt; m value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m value) -&gt; m value
forall (m :: * -&gt; *) a.
(HasCallStack, MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m a) -&gt; m a
</span><a href="Testnet.Components.Query.html#getEpochStateDetails"><span class="hs-identifier hs-var">getEpochStateDetails</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566917"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">(((AnyNewEpochState, SlotNo, BlockNo) -&gt; m value) -&gt; m value)
-&gt; ((AnyNewEpochState, SlotNo, BlockNo) -&gt; m value) -&gt; m value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-556"></span><span>      </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span id="local-6989586621679566986"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566986"><span class="hs-identifier hs-var">actualEra</span></a></span></span><span> </span><span id="local-6989586621679566987"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566987"><span class="hs-identifier hs-var">newEpochState</span></a></span></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-557"></span><span>        </span><span class="annot"><span class="annottext">era :~: era
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Type.Equality.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (era :~: era) -&gt; m (era :~: era)
forall (m :: * -&gt; *) e a.
(MonadTest m, Show e, HasCallStack) =&gt;
Either e a -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#leftFail"><span class="hs-identifier hs-var">H.leftFail</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String (era :~: era) -&gt; m (era :~: era))
-&gt; Either String (era :~: era) -&gt; m (era :~: era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; ShelleyBasedEra era -&gt; Either String (era :~: era)
forall (eon :: * -&gt; *) expectedEra receivedEra (m :: * -&gt; *).
(HasCallStack, TestEquality eon, Show (eon expectedEra),
 Show (eon receivedEra), MonadError String m) =&gt;
eon expectedEra
-&gt; eon receivedEra -&gt; m (expectedEra :~: receivedEra)
</span><a href="Testnet.Property.Assert.html#assertErasEqual"><span class="hs-identifier hs-var">assertErasEqual</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566918"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679566986"><span class="hs-identifier hs-var">actualEra</span></a></span><span>
</span><span id="line-558"></span><span>        </span><span class="annot"><span class="annottext">value -&gt; m value
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(value -&gt; m value) -&gt; value -&gt; m value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679566987"><span class="hs-identifier hs-var">newEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
-&gt; Getting value (NewEpochState (ShelleyLedgerEra era)) value
-&gt; value
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting value (NewEpochState (ShelleyLedgerEra era)) value
Lens' (NewEpochState (ShelleyLedgerEra era)) value
</span><a href="#local-6989586621679566920"><span class="hs-identifier hs-var">lens</span></a></span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="annot"><span class="hs-comment">-- | Return current protocol parameters from the governance state</span></span><span>
</span><span id="line-561"></span><span id="local-6989586621679565879"><span id="local-6989586621679565880"><span class="annot"><a href="Testnet.Components.Query.html#getProtocolParams"><span class="hs-identifier hs-type">getProtocolParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">H.MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565879"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565879"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565879"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-563"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#ConwayEraOnwards"><span class="hs-identifier hs-type">ConwayEraOnwards</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565880"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565879"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.ProtocolParameters.html#LedgerProtocolParameters"><span class="hs-identifier hs-type">LedgerProtocolParameters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565880"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-565"></span><span id="getProtocolParams"><span class="annot"><span class="annottext">getProtocolParams :: forall (m :: * -&gt; *) era.
(MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView
-&gt; ConwayEraOnwards era -&gt; m (LedgerProtocolParameters era)
</span><a href="Testnet.Components.Query.html#getProtocolParams"><span class="hs-identifier hs-var hs-var">getProtocolParams</span></a></span></span><span> </span><span id="local-6989586621679566996"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566996"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679566997"><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566997"><span class="hs-identifier hs-var">ceo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
-&gt; (ConwayEraOnwardsConstraints era =&gt;
    m (LedgerProtocolParameters era))
-&gt; m (LedgerProtocolParameters era)
forall era a.
ConwayEraOnwards era -&gt; (ConwayEraOnwardsConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#conwayEraOnwardsConstraints"><span class="hs-identifier hs-var">conwayEraOnwardsConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566997"><span class="hs-identifier hs-var">ceo</span></a></span><span> </span><span class="annot"><span class="annottext">((ConwayEraOnwardsConstraints era =&gt;
  m (LedgerProtocolParameters era))
 -&gt; m (LedgerProtocolParameters era))
-&gt; (ConwayEraOnwardsConstraints era =&gt;
    m (LedgerProtocolParameters era))
-&gt; m (LedgerProtocolParameters era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-566"></span><span>   </span><span id="local-6989586621679567007"><span id="local-6989586621679567008"><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679567008"><span class="hs-identifier hs-var">govState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#ConwayGovState"><span class="hs-identifier hs-type">ConwayGovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679567007"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
</span><a href="Testnet.Components.Query.html#getGovState"><span class="hs-identifier hs-var">getGovState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679566996"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679566997"><span class="hs-identifier hs-var">ceo</span></a></span><span>
</span><span id="line-567"></span><span>   </span><span class="annot"><span class="annottext">LedgerProtocolParameters era -&gt; m (LedgerProtocolParameters era)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(LedgerProtocolParameters era -&gt; m (LedgerProtocolParameters era))
-&gt; (PParams (ShelleyLedgerEra era) -&gt; LedgerProtocolParameters era)
-&gt; PParams (ShelleyLedgerEra era)
-&gt; m (LedgerProtocolParameters era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PParams (ShelleyLedgerEra era) -&gt; LedgerProtocolParameters era
forall era.
PParams (ShelleyLedgerEra era) -&gt; LedgerProtocolParameters era
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.ProtocolParameters.html#LedgerProtocolParameters"><span class="hs-identifier hs-var">LedgerProtocolParameters</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams (ShelleyLedgerEra era)
 -&gt; m (LedgerProtocolParameters era))
-&gt; PParams (ShelleyLedgerEra era)
-&gt; m (LedgerProtocolParameters era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679567008"><span class="hs-identifier hs-var">govState</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
-&gt; Getting
     (PParams (ShelleyLedgerEra era))
     (ConwayGovState (ShelleyLedgerEra era))
     (PParams (ShelleyLedgerEra era))
-&gt; PParams (ShelleyLedgerEra era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (PParams (ShelleyLedgerEra era))
  (ConwayGovState (ShelleyLedgerEra era))
  (PParams (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(PParams era -&gt; f (PParams era))
-&gt; ConwayGovState era -&gt; f (ConwayGovState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#cgsCurPParamsL"><span class="hs-identifier hs-var">L.cgsCurPParamsL</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span class="hs-comment">-- | Obtains the @govActionLifetime@ from the protocol parameters.</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- The @govActionLifetime@ or governance action maximum lifetime in epochs is</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- the number of epochs such that a governance action submitted during an epoch @e@</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- expires if it is still not ratified as of the end of epoch: @e + govActionLifetime + 1@.</span><span>
</span><span id="line-574"></span><span id="local-6989586621679565885"><span id="local-6989586621679565886"><span class="annot"><a href="Testnet.Components.Query.html#getGovActionLifetime"><span class="hs-identifier hs-type">getGovActionLifetime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">H.MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565885"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565885"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565885"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#ConwayEraOnwards"><span class="hs-identifier hs-type">ConwayEraOnwards</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565886"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565885"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span></span></span><span>
</span><span id="line-578"></span><span id="getGovActionLifetime"><span class="annot"><span class="annottext">getGovActionLifetime :: forall (m :: * -&gt; *) era.
(MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView -&gt; ConwayEraOnwards era -&gt; m EpochInterval
</span><a href="Testnet.Components.Query.html#getGovActionLifetime"><span class="hs-identifier hs-var hs-var">getGovActionLifetime</span></a></span></span><span> </span><span id="local-6989586621679567014"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679567014"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679567015"><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679567015"><span class="hs-identifier hs-var">ceo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
-&gt; (ConwayEraOnwardsConstraints era =&gt; m EpochInterval)
-&gt; m EpochInterval
forall era a.
ConwayEraOnwards era -&gt; (ConwayEraOnwardsConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#conwayEraOnwardsConstraints"><span class="hs-identifier hs-var">conwayEraOnwardsConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679567015"><span class="hs-identifier hs-var">ceo</span></a></span><span> </span><span class="annot"><span class="annottext">((ConwayEraOnwardsConstraints era =&gt; m EpochInterval)
 -&gt; m EpochInterval)
-&gt; (ConwayEraOnwardsConstraints era =&gt; m EpochInterval)
-&gt; m EpochInterval
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-579"></span><span>   </span><span id="local-6989586621679567028"><span id="local-6989586621679567029"><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679567029"><span class="hs-identifier hs-var">govState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#ConwayGovState"><span class="hs-identifier hs-type">ConwayGovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679567028"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
</span><a href="Testnet.Components.Query.html#getGovState"><span class="hs-identifier hs-var">getGovState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679567014"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679567015"><span class="hs-identifier hs-var">ceo</span></a></span><span>
</span><span id="line-580"></span><span>   </span><span class="annot"><span class="annottext">EpochInterval -&gt; m EpochInterval
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochInterval -&gt; m EpochInterval)
-&gt; EpochInterval -&gt; m EpochInterval
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679567029"><span class="hs-identifier hs-var">govState</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
-&gt; Getting
     EpochInterval (ConwayGovState (ShelleyLedgerEra era)) EpochInterval
-&gt; EpochInterval
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams (ShelleyLedgerEra era)
 -&gt; Const EpochInterval (PParams (ShelleyLedgerEra era)))
-&gt; ConwayGovState (ShelleyLedgerEra era)
-&gt; Const EpochInterval (ConwayGovState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(PParams era -&gt; f (PParams era))
-&gt; ConwayGovState era -&gt; f (ConwayGovState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#cgsCurPParamsL"><span class="hs-identifier hs-var">L.cgsCurPParamsL</span></a></span><span>
</span><span id="line-581"></span><span>                      </span><span class="annot"><span class="annottext">((PParams (ShelleyLedgerEra era)
  -&gt; Const EpochInterval (PParams (ShelleyLedgerEra era)))
 -&gt; ConwayGovState (ShelleyLedgerEra era)
 -&gt; Const EpochInterval (ConwayGovState (ShelleyLedgerEra era)))
-&gt; ((EpochInterval -&gt; Const EpochInterval EpochInterval)
    -&gt; PParams (ShelleyLedgerEra era)
    -&gt; Const EpochInterval (PParams (ShelleyLedgerEra era)))
-&gt; Getting
     EpochInterval (ConwayGovState (ShelleyLedgerEra era)) EpochInterval
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochInterval -&gt; Const EpochInterval EpochInterval)
-&gt; PParams (ShelleyLedgerEra era)
-&gt; Const EpochInterval (PParams (ShelleyLedgerEra era))
forall era.
ConwayEraPParams era =&gt;
Lens' (PParams era) EpochInterval
Lens' (PParams (ShelleyLedgerEra era)) EpochInterval
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.PParams.html#ppGovActionLifetimeL"><span class="hs-identifier hs-var">L.ppGovActionLifetimeL</span></a></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="annot"><span class="hs-comment">-- | Obtains the key registration deposit from the protocol parameters.</span></span><span>
</span><span id="line-584"></span><span id="local-6989586621679565890"><span id="local-6989586621679565891"><span class="annot"><a href="Testnet.Components.Query.html#getKeyDeposit"><span class="hs-identifier hs-type">getKeyDeposit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">H.MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565890"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565890"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565890"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#ConwayEraOnwards"><span class="hs-identifier hs-type">ConwayEraOnwards</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565891"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565890"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">L.Coin</span></a></span></span></span><span>
</span><span id="line-588"></span><span id="getKeyDeposit"><span class="annot"><span class="annottext">getKeyDeposit :: forall (m :: * -&gt; *) era.
(MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView -&gt; ConwayEraOnwards era -&gt; m Coin
</span><a href="Testnet.Components.Query.html#getKeyDeposit"><span class="hs-identifier hs-var hs-var">getKeyDeposit</span></a></span></span><span> </span><span id="local-6989586621679567035"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679567035"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span id="local-6989586621679567036"><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679567036"><span class="hs-identifier hs-var">ceo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
-&gt; (ConwayEraOnwardsConstraints era =&gt; m Coin) -&gt; m Coin
forall era a.
ConwayEraOnwards era -&gt; (ConwayEraOnwardsConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ConwayEraOnwards.html#conwayEraOnwardsConstraints"><span class="hs-identifier hs-var">conwayEraOnwardsConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679567036"><span class="hs-identifier hs-var">ceo</span></a></span><span> </span><span class="annot"><span class="annottext">((ConwayEraOnwardsConstraints era =&gt; m Coin) -&gt; m Coin)
-&gt; (ConwayEraOnwardsConstraints era =&gt; m Coin) -&gt; m Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-589"></span><span>   </span><span id="local-6989586621679567049"><span id="local-6989586621679567050"><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679567050"><span class="hs-identifier hs-var">govState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#ConwayGovState"><span class="hs-identifier hs-type">ConwayGovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679567049"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
forall (m :: * -&gt; *) era.
(HasCallStack, MonadAssertion m, MonadIO m, MonadTest m) =&gt;
EpochStateView
-&gt; ConwayEraOnwards era
-&gt; m (ConwayGovState (ShelleyLedgerEra era))
</span><a href="Testnet.Components.Query.html#getGovState"><span class="hs-identifier hs-var">getGovState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679567035"><span class="hs-identifier hs-var">epochStateView</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards era
</span><a href="#local-6989586621679567036"><span class="hs-identifier hs-var">ceo</span></a></span><span>
</span><span id="line-590"></span><span>   </span><span class="annot"><span class="annottext">Coin -&gt; m Coin
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; m Coin) -&gt; Coin -&gt; m Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679567050"><span class="hs-identifier hs-var">govState</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovState (ShelleyLedgerEra era)
-&gt; Getting Coin (ConwayGovState (ShelleyLedgerEra era)) Coin
-&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams (ShelleyLedgerEra era)
 -&gt; Const Coin (PParams (ShelleyLedgerEra era)))
-&gt; ConwayGovState (ShelleyLedgerEra era)
-&gt; Const Coin (ConwayGovState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(PParams era -&gt; f (PParams era))
-&gt; ConwayGovState era -&gt; f (ConwayGovState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-conway-1.19.0.0-488240d1c3dd1b69a84bdd0f801afd05abdcd1a6334688590d75152fc81494ed/share/doc/html/src/Cardano.Ledger.Conway.Governance.html#cgsCurPParamsL"><span class="hs-identifier hs-var">L.cgsCurPParamsL</span></a></span><span>
</span><span id="line-591"></span><span>                      </span><span class="annot"><span class="annottext">((PParams (ShelleyLedgerEra era)
  -&gt; Const Coin (PParams (ShelleyLedgerEra era)))
 -&gt; ConwayGovState (ShelleyLedgerEra era)
 -&gt; Const Coin (ConwayGovState (ShelleyLedgerEra era)))
-&gt; ((Coin -&gt; Const Coin Coin)
    -&gt; PParams (ShelleyLedgerEra era)
    -&gt; Const Coin (PParams (ShelleyLedgerEra era)))
-&gt; Getting Coin (ConwayGovState (ShelleyLedgerEra era)) Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Const Coin Coin)
-&gt; PParams (ShelleyLedgerEra era)
-&gt; Const Coin (PParams (ShelleyLedgerEra era))
forall era. EraPParams era =&gt; Lens' (PParams era) Coin
Lens' (PParams (ShelleyLedgerEra era)) Coin
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Core.PParams.html#ppKeyDepositL"><span class="hs-identifier hs-var">L.ppKeyDepositL</span></a></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="annot"><span class="hs-comment">-- | Returns delegation state from the epoch state.</span></span><span>
</span><span id="line-595"></span><span id="local-6989586621679565896"><span class="annot"><a href="Testnet.Components.Query.html#getDelegationState"><span class="hs-identifier hs-type">getDelegationState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.MonadAssertion.html#MonadAssertion"><span class="hs-identifier hs-type">H.MonadAssertion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565896"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565896"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565896"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Testnet.Components.Query.html#EpochStateView"><span class="hs-identifier hs-type">EpochStateView</span></a></span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565896"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.UMap.html#StakeCredentials"><span class="hs-identifier hs-type">L.StakeCredentials</span></a></span></span><span>
</span><span id="line-598"></span><span id="getDelegationState"><span class="annot"><span class="annottext">getDelegationState :: forall (m :: * -&gt; *).
(MonadAssertion m, MonadTest m, MonadIO m) =&gt;
EpochStateView -&gt; m StakeCredentials
</span><a href="Testnet.Components.Query.html#getDelegationState"><span class="hs-identifier hs-var hs-var">getDelegationState</span></a></span></span><span> </span><span id="local-6989586621679567063"><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679567063"><span class="hs-identifier hs-var">epochStateView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-599"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span id="local-6989586621679567065"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679567065"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span id="local-6989586621679567066"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679567066"><span class="hs-identifier hs-var">newEpochState</span></a></span></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochStateView -&gt; m AnyNewEpochState
forall (m :: * -&gt; *).
(HasCallStack, MonadTest m, MonadAssertion m, MonadIO m) =&gt;
EpochStateView -&gt; m AnyNewEpochState
</span><a href="Testnet.Components.Query.html#getEpochState"><span class="hs-identifier hs-var">getEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStateView
</span><a href="#local-6989586621679567063"><span class="hs-identifier hs-var">epochStateView</span></a></span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679567067"><span class="annot"><span class="annottext">pools :: UMap
</span><a href="#local-6989586621679567067"><span class="hs-identifier hs-var hs-var">pools</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; (ShelleyBasedEraConstraints era =&gt; UMap) -&gt; UMap
forall era a.
ShelleyBasedEra era -&gt; (ShelleyBasedEraConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#shelleyBasedEraConstraints"><span class="hs-identifier hs-var">shelleyBasedEraConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679567065"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">((ShelleyBasedEraConstraints era =&gt; UMap) -&gt; UMap)
-&gt; (ShelleyBasedEraConstraints era =&gt; UMap) -&gt; UMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679567066"><span class="hs-identifier hs-var">newEpochState</span></a></span><span>
</span><span id="line-601"></span><span>                </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
-&gt; Getting UMap (NewEpochState (ShelleyLedgerEra era)) UMap -&gt; UMap
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///nix/store/awwavy569rg7nypy4ddnajggi9dfw659-microlens-lib-microlens-0.4.13.1-haddock-doc/share/doc/microlens/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState (ShelleyLedgerEra era)
 -&gt; Const UMap (EpochState (ShelleyLedgerEra era)))
-&gt; NewEpochState (ShelleyLedgerEra era)
-&gt; Const UMap (NewEpochState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">L.nesEsL</span></a></span><span>
</span><span id="line-602"></span><span>                 </span><span class="annot"><span class="annottext">((EpochState (ShelleyLedgerEra era)
  -&gt; Const UMap (EpochState (ShelleyLedgerEra era)))
 -&gt; NewEpochState (ShelleyLedgerEra era)
 -&gt; Const UMap (NewEpochState (ShelleyLedgerEra era)))
-&gt; ((UMap -&gt; Const UMap UMap)
    -&gt; EpochState (ShelleyLedgerEra era)
    -&gt; Const UMap (EpochState (ShelleyLedgerEra era)))
-&gt; Getting UMap (NewEpochState (ShelleyLedgerEra era)) UMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LedgerState (ShelleyLedgerEra era)
 -&gt; Const UMap (LedgerState (ShelleyLedgerEra era)))
-&gt; EpochState (ShelleyLedgerEra era)
-&gt; Const UMap (EpochState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">L.esLStateL</span></a></span><span>
</span><span id="line-603"></span><span>                 </span><span class="annot"><span class="annottext">((LedgerState (ShelleyLedgerEra era)
  -&gt; Const UMap (LedgerState (ShelleyLedgerEra era)))
 -&gt; EpochState (ShelleyLedgerEra era)
 -&gt; Const UMap (EpochState (ShelleyLedgerEra era)))
-&gt; ((UMap -&gt; Const UMap UMap)
    -&gt; LedgerState (ShelleyLedgerEra era)
    -&gt; Const UMap (LedgerState (ShelleyLedgerEra era)))
-&gt; (UMap -&gt; Const UMap UMap)
-&gt; EpochState (ShelleyLedgerEra era)
-&gt; Const UMap (EpochState (ShelleyLedgerEra era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CertState (ShelleyLedgerEra era)
 -&gt; Const UMap (CertState (ShelleyLedgerEra era)))
-&gt; LedgerState (ShelleyLedgerEra era)
-&gt; Const UMap (LedgerState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-shelley-1.16.0.0-f18d93fdee15657e1d1c1cd899e6a3acbbf7897b30ff5820aadf63595dd6acd9/share/doc/html/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">L.lsCertStateL</span></a></span><span>
</span><span id="line-604"></span><span>                 </span><span class="annot"><span class="annottext">((CertState (ShelleyLedgerEra era)
  -&gt; Const UMap (CertState (ShelleyLedgerEra era)))
 -&gt; LedgerState (ShelleyLedgerEra era)
 -&gt; Const UMap (LedgerState (ShelleyLedgerEra era)))
-&gt; ((UMap -&gt; Const UMap UMap)
    -&gt; CertState (ShelleyLedgerEra era)
    -&gt; Const UMap (CertState (ShelleyLedgerEra era)))
-&gt; (UMap -&gt; Const UMap UMap)
-&gt; LedgerState (ShelleyLedgerEra era)
-&gt; Const UMap (LedgerState (ShelleyLedgerEra era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DState (ShelleyLedgerEra era)
 -&gt; Const UMap (DState (ShelleyLedgerEra era)))
-&gt; CertState (ShelleyLedgerEra era)
-&gt; Const UMap (CertState (ShelleyLedgerEra era))
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens'
  (CertState (ShelleyLedgerEra era)) (DState (ShelleyLedgerEra era))
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.CertState.html#certDStateL"><span class="hs-identifier hs-var">L.certDStateL</span></a></span><span>
</span><span id="line-605"></span><span>                 </span><span class="annot"><span class="annottext">((DState (ShelleyLedgerEra era)
  -&gt; Const UMap (DState (ShelleyLedgerEra era)))
 -&gt; CertState (ShelleyLedgerEra era)
 -&gt; Const UMap (CertState (ShelleyLedgerEra era)))
-&gt; ((UMap -&gt; Const UMap UMap)
    -&gt; DState (ShelleyLedgerEra era)
    -&gt; Const UMap (DState (ShelleyLedgerEra era)))
-&gt; (UMap -&gt; Const UMap UMap)
-&gt; CertState (ShelleyLedgerEra era)
-&gt; Const UMap (CertState (ShelleyLedgerEra era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(UMap -&gt; Const UMap UMap)
-&gt; DState (ShelleyLedgerEra era)
-&gt; Const UMap (DState (ShelleyLedgerEra era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(UMap -&gt; f UMap) -&gt; DState era -&gt; f (DState era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.CertState.html#dsUnifiedL"><span class="hs-identifier hs-var">L.dsUnifiedL</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><span class="annottext">StakeCredentials -&gt; m StakeCredentials
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(StakeCredentials -&gt; m StakeCredentials)
-&gt; StakeCredentials -&gt; m StakeCredentials
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UMap -&gt; StakeCredentials
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.UMap.html#toStakeCredentials"><span class="hs-identifier hs-var">L.toStakeCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">UMap
</span><a href="#local-6989586621679567067"><span class="hs-identifier hs-var">pools</span></a></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="annot"><span class="hs-comment">-- | Returns the transaction index of a transaction with a given amount and ID.</span></span><span>
</span><span id="line-610"></span><span class="annot"><a href="Testnet.Components.Query.html#getTxIx"><span class="hs-identifier hs-type">getTxIx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679565912"><span class="annot"><a href="#local-6989586621679565912"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679565913"><span class="annot"><a href="#local-6989586621679565913"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-611"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/ymj1ll7asnwcnwh7qbyka5k19fxl2h6k-hedgehog-lib-hedgehog-1.5-haddock-doc/share/doc/hedgehog/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565912"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-612"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#ShelleyBasedEra"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565913"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-613"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.TxIn.html#TxId"><span class="hs-identifier hs-type">TxId</span></a></span><span>
</span><span id="line-614"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-ledger-core-1.17.0.0-83e9f90039551f2a6895e10ab92d6bea07addf468677d5a8141d8c65f1c89209/share/doc/html/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">L.Coin</span></a></span><span>
</span><span id="line-615"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-slotting-0.2.0.1-3f1a1be6195f7ae2c0e8ab1d39d95c9a3b1f33b5d873e142b6db55ba4dba848b/share/doc/html/src/Cardano.Slotting.Block.html#BlockNo"><span class="hs-identifier hs-type">BlockNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565912"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.TxIn.html#TxIx"><span class="hs-identifier hs-type">TxIx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span id="getTxIx"><span class="annot"><span class="annottext">getTxIx :: forall (m :: * -&gt; *) era.
(HasCallStack, MonadTest m) =&gt;
ShelleyBasedEra era
-&gt; TxId
-&gt; Coin
-&gt; (AnyNewEpochState, SlotNo, BlockNo)
-&gt; m (Maybe TxIx)
</span><a href="Testnet.Components.Query.html#getTxIx"><span class="hs-identifier hs-var hs-var">getTxIx</span></a></span></span><span> </span><span id="local-6989586621679567088"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679567088"><span class="hs-identifier hs-var">sbe</span></a></span></span><span> </span><span id="local-6989586621679567089"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679567089"><span class="hs-identifier hs-var">txId</span></a></span></span><span> </span><span id="local-6989586621679567090"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679567090"><span class="hs-identifier hs-var">amount</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#AnyNewEpochState"><span class="hs-identifier hs-type">AnyNewEpochState</span></a></span><span> </span><span id="local-6989586621679567103"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679567103"><span class="hs-identifier hs-var">sbe'</span></a></span></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679567104"><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><a href="#local-6989586621679567104"><span class="hs-identifier hs-var">tbs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-618"></span><span>  </span><span class="annot"><span class="annottext">era :~: era
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Type.Equality.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (era :~: era) -&gt; m (era :~: era)
forall (m :: * -&gt; *) e a.
(MonadTest m, Show e, HasCallStack) =&gt;
Either e a -&gt; m a
</span><a href="file:///nix/store/rx41hnfkssp4vrdkw21jf4wk6x4cpsjr-hedgehog-extras-lib-hedgehog-extras-0.8.0.0-haddock-doc/share/doc/hedgehog-extras/html/src/Hedgehog.Extras.Test.Base.html#leftFail"><span class="hs-identifier hs-var">H.leftFail</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String (era :~: era) -&gt; m (era :~: era))
-&gt; Either String (era :~: era) -&gt; m (era :~: era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; ShelleyBasedEra era -&gt; Either String (era :~: era)
forall (eon :: * -&gt; *) expectedEra receivedEra (m :: * -&gt; *).
(HasCallStack, TestEquality eon, Show (eon expectedEra),
 Show (eon receivedEra), MonadError String m) =&gt;
eon expectedEra
-&gt; eon receivedEra -&gt; m (expectedEra :~: receivedEra)
</span><a href="Testnet.Property.Assert.html#assertErasEqual"><span class="hs-identifier hs-var">assertErasEqual</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679567088"><span class="hs-identifier hs-var">sbe</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679567103"><span class="hs-identifier hs-var">sbe'</span></a></span><span>
</span><span id="line-619"></span><span>  </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; (ShelleyBasedEraConstraints era =&gt; m (Maybe TxIx))
-&gt; m (Maybe TxIx)
forall era a.
ShelleyBasedEra era -&gt; (ShelleyBasedEraConstraints era =&gt; a) -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Era.Internal.Eon.ShelleyBasedEra.html#shelleyBasedEraConstraints"><span class="hs-identifier hs-var">shelleyBasedEraConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679567103"><span class="hs-identifier hs-var">sbe'</span></a></span><span> </span><span class="annot"><span class="annottext">((ShelleyBasedEraConstraints era =&gt; m (Maybe TxIx))
 -&gt; m (Maybe TxIx))
-&gt; (ShelleyBasedEraConstraints era =&gt; m (Maybe TxIx))
-&gt; m (Maybe TxIx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><span class="annottext">Maybe TxIx -&gt; m (Maybe TxIx)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe TxIx -&gt; m (Maybe TxIx)) -&gt; Maybe TxIx -&gt; m (Maybe TxIx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe TxIx -&gt; TxIn -&gt; TxOut CtxUTxO era -&gt; Maybe TxIx)
-&gt; Maybe TxIx -&gt; Map TxIn (TxOut CtxUTxO era) -&gt; Maybe TxIx
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#foldlWithKey"><span class="hs-identifier hs-var">Map.foldlWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679567113"><span class="annot"><span class="annottext">Maybe TxIx
</span><a href="#local-6989586621679567113"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span id="local-6989586621679567115"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679567115"><span class="hs-identifier hs-var">thisTxId</span></a></span></span><span> </span><span id="local-6989586621679567116"><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621679567116"><span class="hs-identifier hs-var">thisTxIx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.Output.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679567117"><span class="annot"><span class="annottext">TxOutValue era
</span><a href="#local-6989586621679567117"><span class="hs-identifier hs-var">txOutValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-621"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe TxIx
</span><a href="#local-6989586621679567113"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-622"></span><span>        </span><span class="annot"><span class="annottext">Maybe TxIx
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679567115"><span class="hs-identifier hs-var">thisTxId</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; TxId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679567089"><span class="hs-identifier hs-var">txId</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span>
</span><span id="line-623"></span><span>                  </span><span class="annot"><span class="annottext">TxOutValue era -&gt; Coin
forall era. TxOutValue era -&gt; Coin
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.Tx.Internal.Output.html#txOutValueToLovelace"><span class="hs-identifier hs-var">txOutValueToLovelace</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutValue era
</span><a href="#local-6989586621679567117"><span class="hs-identifier hs-var">txOutValue</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679567090"><span class="hs-identifier hs-var">amount</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxIx -&gt; Maybe TxIx
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621679567116"><span class="hs-identifier hs-var">thisTxIx</span></a></span><span>
</span><span id="line-624"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TxIx
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-625"></span><span>        </span><span id="local-6989586621679567119"><span class="annot"><span class="annottext">Maybe TxIx
</span><a href="#local-6989586621679567119"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TxIx
</span><a href="#local-6989586621679567119"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe TxIx
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO era) -&gt; Maybe TxIx)
-&gt; Map TxIn (TxOut CtxUTxO era) -&gt; Maybe TxIx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LedgerTables
     (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
-&gt; Map TxIn (TxOut CtxUTxO era)
forall era.
ShelleyBasedEra era
-&gt; LedgerTables
     (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
-&gt; Map TxIn (TxOut CtxUTxO era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.6/cardano-api-10.18.0.0-cf96680f7a5f126623afc107f46c4390ef848488275422e58a8da147b9415623/share/doc/html/src/Cardano.Api.LedgerState.html#getLedgerTablesUTxOValues"><span class="hs-identifier hs-var">getLedgerTablesUTxOValues</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679567103"><span class="hs-identifier hs-var">sbe'</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerTables (LedgerState (CardanoBlock StandardCrypto)) ValuesMK
</span><a href="#local-6989586621679567104"><span class="hs-identifier hs-var">tbs</span></a></span><span>
</span><span id="line-626"></span></pre></body></html>