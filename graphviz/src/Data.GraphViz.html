<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, FlexibleContexts, MultiParamTypeClasses, OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- |
   Module      : Data.GraphViz
   Description : Graphviz bindings for Haskell.
   Copyright   : (c) Matthew Sackman, Ivan Lazar Miljenovic
   License     : 3-Clause BSD-style
   Maintainer  : Ivan.Miljenovic@gmail.com

   This is the top-level module for the graphviz library.  It provides
   functions to convert 'Data.Graph.Inductive.Graph.Graph's into the
   /Dot/ language used by the /Graphviz/ suite of programs (as well as a
   limited ability to perform the reverse operation).

   If you wish to construct a Haskell representation of a Dot graph
   yourself rather than using the conversion functions here, please
   see the &quot;Data.GraphViz.Types&quot; module as a starting point for how to
   do so.

   Information about Graphviz and the Dot language can be found at:
   &lt;http://graphviz.org/&gt;
 -}</span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.GraphViz</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Conversion from graphs to /Dot/ format.</span></span><span>
</span><span id="line-26"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Specifying parameters.</span></span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><span class="hs-comment">-- $params</span></span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier">GraphvizParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#quickParams"><span class="hs-identifier">quickParams</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#defaultParams"><span class="hs-identifier">defaultParams</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#nonClusteredParams"><span class="hs-identifier">nonClusteredParams</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#blankParams"><span class="hs-identifier">blankParams</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#setDirectedness"><span class="hs-identifier">setDirectedness</span></a></span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><span class="hs-comment">-- *** Specifying clusters.</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.Clustering.html#NodeCluster"><span class="hs-identifier">NodeCluster</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#LNodeCluster"><span class="hs-identifier">LNodeCluster</span></a></span><span>
</span><span id="line-37"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Converting graphs.</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#graphToDot"><span class="hs-identifier">graphToDot</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#graphElemsToDot"><span class="hs-identifier">graphElemsToDot</span></a></span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Pseudo-inverse conversion.</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#dotToGraph"><span class="hs-identifier">dotToGraph</span></a></span><span>
</span><span id="line-42"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Graph augmentation.</span></span><span>
</span><span id="line-43"></span><span>      </span><span class="hs-comment">-- $augment</span><span>
</span><span id="line-44"></span><span>      </span><span class="hs-comment">-- ** Type aliases for @Node@ and @Edge@ labels.</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#AttributeNode"><span class="hs-identifier">AttributeNode</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#AttributeEdge"><span class="hs-identifier">AttributeEdge</span></a></span><span>
</span><span id="line-47"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Customisable augmentation.</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#graphToGraph"><span class="hs-identifier">graphToGraph</span></a></span><span>
</span><span id="line-49"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Quick augmentation.</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#dotizeGraph"><span class="hs-identifier">dotizeGraph</span></a></span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Manual augmentation.</span></span><span>
</span><span id="line-52"></span><span>      </span><span class="annot"><span class="hs-comment">-- $manualAugment</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#EdgeID"><span class="hs-identifier">EdgeID</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#addEdgeIDs"><span class="hs-identifier">addEdgeIDs</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#setEdgeIDAttribute"><span class="hs-identifier">setEdgeIDAttribute</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#dotAttributes"><span class="hs-identifier">dotAttributes</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#augmentGraph"><span class="hs-identifier">augmentGraph</span></a></span><span>
</span><span id="line-58"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Utility functions</span></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#preview"><span class="hs-identifier">preview</span></a></span><span>
</span><span id="line-60"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Re-exporting other modules.</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html"><span class="hs-identifier">Data.GraphViz.Types</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html"><span class="hs-identifier">Data.GraphViz.Types.Canonical</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.html"><span class="hs-identifier">Data.GraphViz.Attributes</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.GraphViz.Commands.html"><span class="hs-identifier">Data.GraphViz.Commands</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.Clustering.html"><span class="hs-identifier">Data.GraphViz.Algorithms.Clustering</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.html"><span class="hs-identifier">Data.GraphViz.Attributes</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html"><span class="hs-identifier">Data.GraphViz.Attributes.Complete</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#AttributeName"><span class="hs-identifier">AttributeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#CustomAttribute"><span class="hs-identifier">CustomAttribute</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>                                            </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#customAttribute"><span class="hs-identifier">customAttribute</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#customValue"><span class="hs-identifier">customValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>                                            </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#findSpecifiedCustom"><span class="hs-identifier">findSpecifiedCustom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Commands.html"><span class="hs-identifier">Data.GraphViz.Commands</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Commands.IO.html"><span class="hs-identifier">Data.GraphViz.Commands.IO</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Commands.IO.html#hGetDot"><span class="hs-identifier">hGetDot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Internal.Util.html"><span class="hs-identifier">Data.GraphViz.Internal.Util</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Internal.Util.html#uniq"><span class="hs-identifier">uniq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Internal.Util.html#uniqBy"><span class="hs-identifier">uniqBy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html"><span class="hs-identifier">Data.GraphViz.Types</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html"><span class="hs-identifier">Data.GraphViz.Types.Canonical</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier">DotGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier">DotStatements</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>                                            </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotSubGraph"><span class="hs-identifier">DotSubGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Generalised.html"><span class="hs-identifier">Data.GraphViz.Types.Generalised</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Generalised.html#FromGeneralisedDot"><span class="hs-identifier">FromGeneralisedDot</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html"><span class="hs-identifier">Control.Arrow</span></a></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#first"><span class="hs-identifier">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#%26%26%26"><span class="hs-operator">(&amp;&amp;&amp;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Concurrent.html"><span class="hs-identifier">Control.Concurrent</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#forkIO"><span class="hs-identifier">forkIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Graph.Inductive.Graph</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#fromJust"><span class="hs-identifier">fromJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Lazy.html"><span class="hs-identifier">Data.Text.Lazy</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.Lazy.html#Text"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Lazy.html"><span class="hs-identifier">Data.Text.Lazy</span></a></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.Unsafe.html"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier">unsafePerformIO</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if !(MIN_VERSION_base (4,8,0))
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Functor</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><span class="hs-comment">-- | Determine if the given graph is undirected.</span></span><span>
</span><span id="line-97"></span><span id="local-6989586621679229933"><span id="local-6989586621679229934"><span id="local-6989586621679229936"><span class="annot"><a href="Data.GraphViz.html#isUndirected"><span class="hs-identifier hs-type">isUndirected</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229933"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679229934"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229934"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229936"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229933"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span><span>
</span><span id="line-98"></span><span id="isUndirected"><span class="annot"><span class="annottext">isUndirected :: forall b (g :: * -&gt; * -&gt; *) a. (Ord b, Graph g) =&gt; g a b -&gt; Bool
</span><a href="Data.GraphViz.html#isUndirected"><span class="hs-identifier hs-var hs-var">isUndirected</span></a></span></span><span> </span><span id="local-6989586621679230311"><span class="annot"><span class="annottext">g a b
</span><a href="#local-6989586621679230311"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Node, Node, b) -&gt; Bool) -&gt; [(Node, Node, b)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">(Node, Node, b) -&gt; Bool
</span><a href="#local-6989586621679230313"><span class="hs-identifier hs-var">hasFlip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Node, Node, b)]
</span><a href="#local-6989586621679230314"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679230314"><span class="annot"><span class="annottext">es :: [(Node, Node, b)]
</span><a href="#local-6989586621679230314"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g a b -&gt; [(Node, Node, b)]
forall a b. g a b -&gt; [LEdge b]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><span class="hs-identifier hs-var">labEdges</span></span><span> </span><span class="annot"><span class="annottext">g a b
</span><a href="#local-6989586621679230311"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679230324"><span class="annot"><span class="annottext">eSet :: Set (Node, Node, b)
</span><a href="#local-6989586621679230324"><span class="hs-identifier hs-var hs-var">eSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Node, Node, b)] -&gt; Set (Node, Node, b)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Node, Node, b)]
</span><a href="#local-6989586621679230314"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679230313"><span class="annot"><span class="annottext">hasFlip :: (Node, Node, b) -&gt; Bool
</span><a href="#local-6989586621679230313"><span class="hs-identifier hs-var hs-var">hasFlip</span></a></span></span><span> </span><span id="local-6989586621679230331"><span class="annot"><span class="annottext">(Node, Node, b)
</span><a href="#local-6989586621679230331"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Node, Node, b) -&gt; Set (Node, Node, b) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Node, Node, b) -&gt; (Node, Node, b)
forall {b} {a} {c}. (b, a, c) -&gt; (a, b, c)
</span><a href="#local-6989586621679230333"><span class="hs-identifier hs-var">flippedEdge</span></a></span><span> </span><span class="annot"><span class="annottext">(Node, Node, b)
</span><a href="#local-6989586621679230331"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (Node, Node, b)
</span><a href="#local-6989586621679230324"><span class="hs-identifier hs-var">eSet</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679230333"><span class="annot"><span class="annottext">flippedEdge :: (b, a, c) -&gt; (a, b, c)
</span><a href="#local-6989586621679230333"><span class="hs-identifier hs-var hs-var">flippedEdge</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679230334"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230334"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230335"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230335"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230336"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679230336"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230335"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230334"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679230336"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><span class="hs-comment">{- $params

   A 'GraphvizParams' value contains all the information necessary to
   manipulate 'Graph's with this library.  As such, its components deal
   with:

   * Whether to treat graphs as being directed or not;

   * Which top-level 'GlobalAttributes' values should be applied;

   * How to define (and name) clusters;

   * How to format clusters, nodes and edges.

   Apart from not having to pass multiple values around, another
   advantage of using 'GraphvizParams' over the previous approach is that
   there is no distinction between clustering and non-clustering variants
   of the same functions.

   Example usages of 'GraphvizParams' follow:

   * Quickly visualise a graph using the default parameters.  Note the
     usage of @'nonClusteredParams'@ over @'defaultParams'@ to avoid
     type-checking problems with the cluster type.

     &gt; defaultVis :: (Graph gr) =&gt; gr nl el -&gt; DotGraph Node
     &gt; defaultVis = graphToDot nonClusteredParams

   * As with @defaultVis@, but determine whether or not the graph is
     directed or undirected.

     &gt; checkDirectednessVis :: (Graph gr, Ord el) =&gt; gr nl el -&gt; DotGraph Node
     &gt; checkDirectednessVis = setDirectedness graphToDot nonClusteredParams

   * Clustering nodes based upon whether they are even or odd.  We
     have the option of either constructing a @GraphvizParams@
     directly, or using @'blankParams'@.  Using the latter to avoid
     setting @'isDirected'@:

     &gt; evenOdd :: (Graph gr, Ord el) =&gt; gr Int el -&gt; DotGraph Node
     &gt; evenOdd = setDirectedness graphToDot params
     &gt;   where
     &gt;     params = blankParams { globalAttributes = []
     &gt;                          , clusterBy        = clustBy
     &gt;                          , clusterID        = Num . Int
     &gt;                          , fmtCluster       = clFmt
     &gt;                          , fmtNode          = const []
     &gt;                          , fmtEdge          = const []
     &gt;                          }
     &gt;     clustBy (n,l) = C (n `mod` 2) $ N (n,l)
     &gt;     clFmt m = [GraphAttrs [toLabel $ &quot;n == &quot; ++ show m ++ &quot; (mod 2)&quot;]]

   For more examples, see the source of 'dotizeGraph' and 'preview'.

 -}</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Defines the parameters used to convert a 'Graph' into a 'DotRepr'.</span><span>
</span><span id="line-164"></span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span class="hs-comment">--   A value of type @'GraphvizParams' n nl el cl l@ indicates that</span><span>
</span><span id="line-166"></span><span class="hs-comment">--   the 'Graph' has a node type of @n@, node labels of type @nl@,</span><span>
</span><span id="line-167"></span><span class="hs-comment">--   edge labels of type @el@, corresponding clusters of type @cl@ and</span><span>
</span><span id="line-168"></span><span class="hs-comment">--   after clustering the nodes have a label of type @l@ (which may or</span><span>
</span><span id="line-169"></span><span class="hs-comment">--   may not be the same as @nl@).</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">--   The tuples in the function types represent labelled nodes (for</span><span>
</span><span id="line-172"></span><span class="hs-comment">--   @(n,nl)@ and @(n,l)@) and labelled edges (@(n,n,el)@; the value</span><span>
</span><span id="line-173"></span><span class="hs-comment">--   @(f,t,ftl)@ is an edge from @f@ to @l@ with a label of @ftl@).</span><span>
</span><span id="line-174"></span><span class="hs-comment">--   These correspond to 'LNode' and 'LEdge' in FGL graphs.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">--   The clustering in 'clusterBy' can be to arbitrary depth.</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   Note that the term \&quot;cluster\&quot; is slightly conflated here: in</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   terms of @GraphvizParams@ values, a cluster is a grouping of</span><span>
</span><span id="line-180"></span><span class="hs-comment">--   nodes; the 'isDotCluster' function lets you specify whether it is</span><span>
</span><span id="line-181"></span><span class="hs-comment">--   a cluster in the Dot sense or just a sub-graph.</span><span>
</span><span id="line-182"></span><span class="hs-keyword">data</span><span> </span><span id="GraphvizParams"><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-var">GraphvizParams</span></a></span></span><span> </span><span id="local-6989586621679229957"><span class="annot"><a href="#local-6989586621679229957"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679229958"><span class="annot"><a href="#local-6989586621679229958"><span class="hs-identifier hs-type">nl</span></a></span></span><span> </span><span id="local-6989586621679229959"><span class="annot"><a href="#local-6989586621679229959"><span class="hs-identifier hs-type">el</span></a></span></span><span> </span><span id="local-6989586621679229960"><span class="annot"><a href="#local-6989586621679229960"><span class="hs-identifier hs-type">cl</span></a></span></span><span> </span><span id="local-6989586621679229961"><span class="annot"><a href="#local-6989586621679229961"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-183"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="Params"><span class="annot"><a href="Data.GraphViz.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | @True@ if the graph is directed; @False@</span><span>
</span><span id="line-184"></span><span>                </span><span class="hs-comment">--   otherwise.</span><span>
</span><span id="line-185"></span><span>                </span><span id="isDirected"><span class="annot"><span class="annottext">forall n nl el cl l. GraphvizParams n nl el cl l -&gt; Bool
</span><a href="Data.GraphViz.html#isDirected"><span class="hs-identifier hs-var hs-var">isDirected</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-186"></span><span>                </span><span class="hs-comment">-- | The top-level global 'Attributes' for the entire</span><span>
</span><span id="line-187"></span><span>                </span><span class="hs-comment">--   graph.</span><span>
</span><span id="line-188"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="globalAttributes"><span class="annot"><span class="annottext">forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.html#globalAttributes"><span class="hs-identifier hs-var hs-var">globalAttributes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>                </span><span class="hs-comment">-- | A function to specify which cluster a particular</span><span>
</span><span id="line-190"></span><span>                </span><span class="hs-comment">--   node is in.</span><span>
</span><span id="line-191"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="clusterBy"><span class="annot"><span class="annottext">forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; (n, nl) -&gt; NodeCluster cl (n, l)
</span><a href="Data.GraphViz.html#clusterBy"><span class="hs-identifier hs-var hs-var">clusterBy</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229957"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679229958"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.Clustering.html#NodeCluster"><span class="hs-identifier hs-type">NodeCluster</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229960"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229957"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679229961"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                </span><span class="hs-comment">-- | Is this \&quot;cluster\&quot; actually a cluster, or just a</span><span>
</span><span id="line-193"></span><span>                </span><span class="hs-comment">--   sub-graph?</span><span>
</span><span id="line-194"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="isDotCluster"><span class="annot"><span class="annottext">forall n nl el cl l. GraphvizParams n nl el cl l -&gt; cl -&gt; Bool
</span><a href="Data.GraphViz.html#isDotCluster"><span class="hs-identifier hs-var hs-var">isDotCluster</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229960"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>                </span><span class="annot"><span class="hs-comment">-- | The name/identifier for a cluster.</span></span><span>
</span><span id="line-196"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="clusterID"><span class="annot"><span class="annottext">forall n nl el cl l. GraphvizParams n nl el cl l -&gt; cl -&gt; GraphID
</span><a href="Data.GraphViz.html#clusterID"><span class="hs-identifier hs-var hs-var">clusterID</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229960"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                </span><span class="hs-comment">-- | Specify which global attributes are applied in</span><span>
</span><span id="line-198"></span><span>                </span><span class="hs-comment">--   the given cluster.</span><span>
</span><span id="line-199"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="fmtCluster"><span class="annot"><span class="annottext">forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; cl -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.html#fmtCluster"><span class="hs-identifier hs-var hs-var">fmtCluster</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229960"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                </span><span class="annot"><span class="hs-comment">-- | The specific @Attributes@ for a node.</span></span><span>
</span><span id="line-201"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="fmtNode"><span class="annot"><span class="annottext">forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; (n, l) -&gt; Attributes
</span><a href="Data.GraphViz.html#fmtNode"><span class="hs-identifier hs-var hs-var">fmtNode</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229957"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679229961"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>                </span><span class="annot"><span class="hs-comment">-- | The specific @Attributes@ for an edge.</span></span><span>
</span><span id="line-203"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="fmtEdge"><span class="annot"><span class="annottext">forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; (n, n, el) -&gt; Attributes
</span><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var hs-var">fmtEdge</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229957"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679229957"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679229959"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><span class="hs-comment">-- | An alias for 'NodeCluster' when dealing with FGL graphs.</span></span><span>
</span><span id="line-208"></span><span class="hs-keyword">type</span><span> </span><span id="LNodeCluster"><span class="annot"><a href="Data.GraphViz.html#LNodeCluster"><span class="hs-identifier hs-var">LNodeCluster</span></a></span></span><span> </span><span id="local-6989586621679230347"><span class="annot"><a href="#local-6989586621679230347"><span class="hs-identifier hs-type">cl</span></a></span></span><span> </span><span id="local-6989586621679230348"><span class="annot"><a href="#local-6989586621679230348"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.Clustering.html#NodeCluster"><span class="hs-identifier hs-type">NodeCluster</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230347"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679230348"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Especially useful for quick explorations in ghci, this is a &quot;do</span><span>
</span><span id="line-211"></span><span class="hs-comment">--   what I mean&quot; set of parameters that prints the specified labels</span><span>
</span><span id="line-212"></span><span class="hs-comment">--   of a non-clustered graph.</span><span>
</span><span id="line-213"></span><span id="local-6989586621679230007"><span id="local-6989586621679230009"><span id="local-6989586621679230010"><span class="annot"><a href="Data.GraphViz.html#quickParams"><span class="hs-identifier hs-type">quickParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Attributes.html#Labellable"><span class="hs-identifier hs-type">Labellable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230007"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.html#Labellable"><span class="hs-identifier hs-type">Labellable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230009"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230010"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230007"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230009"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679230007"><span class="hs-identifier hs-type">nl</span></a></span></span></span></span><span>
</span><span id="line-214"></span><span id="quickParams"><span class="annot"><span class="annottext">quickParams :: forall nl el n.
(Labellable nl, Labellable el) =&gt;
GraphvizParams n nl el () nl
</span><a href="Data.GraphViz.html#quickParams"><span class="hs-identifier hs-var hs-var">quickParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl Any () nl
forall n nl el. GraphvizParams n nl el () nl
</span><a href="Data.GraphViz.html#nonClusteredParams"><span class="hs-identifier hs-var">nonClusteredParams</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtNode"><span class="hs-identifier hs-var">fmtNode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679230353"><span class="hs-identifier hs-type">nodeFmt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var">fmtEdge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679230354"><span class="hs-identifier hs-type">edgeFmt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679230353"><span class="annot"><span class="annottext">nodeFmt :: (a, a) -&gt; Attributes
</span><a href="#local-6989586621679230353"><span class="hs-identifier hs-var hs-var">nodeFmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679230357"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230357"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a -&gt; Attribute
forall a. Labellable a =&gt; a -&gt; Attribute
</span><a href="Data.GraphViz.Attributes.html#toLabel"><span class="hs-identifier hs-var">toLabel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230357"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679230354"><span class="annot"><span class="annottext">edgeFmt :: (a, b, a) -&gt; Attributes
</span><a href="#local-6989586621679230354"><span class="hs-identifier hs-var hs-var">edgeFmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679230361"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230361"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a -&gt; Attribute
forall a. Labellable a =&gt; a -&gt; Attribute
</span><a href="Data.GraphViz.Attributes.html#toLabel"><span class="hs-identifier hs-var">toLabel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230361"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | A default 'GraphvizParams' value which assumes the graph is</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   directed, contains no clusters and has no 'Attribute's set.</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">--   If you wish to have the labels of the nodes to have a different</span><span>
</span><span id="line-223"></span><span class="hs-comment">--   type after applying 'clusterBy' from before clustering, then you</span><span>
</span><span id="line-224"></span><span class="hs-comment">--   will have to specify your own 'GraphvizParams' value from</span><span>
</span><span id="line-225"></span><span class="hs-comment">--   scratch (or use 'blankParams').</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">--   If you use a custom 'clusterBy' function (which if you actually</span><span>
</span><span id="line-228"></span><span class="hs-comment">--   want clusters you should) then you should also override the</span><span>
</span><span id="line-229"></span><span class="hs-comment">--   (nonsensical) default 'clusterID'.</span><span>
</span><span id="line-230"></span><span id="local-6989586621679230024"><span id="local-6989586621679230025"><span id="local-6989586621679230026"><span id="local-6989586621679230027"><span class="annot"><a href="Data.GraphViz.html#defaultParams"><span class="hs-identifier hs-type">defaultParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230024"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230025"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230026"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230027"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230025"><span class="hs-identifier hs-type">nl</span></a></span></span></span></span></span><span>
</span><span id="line-231"></span><span id="defaultParams"><span class="annot"><span class="annottext">defaultParams :: forall n nl el cl. GraphvizParams n nl el cl nl
</span><a href="Data.GraphViz.html#defaultParams"><span class="hs-identifier hs-var hs-var">defaultParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">isDirected :: Bool
</span><a href="Data.GraphViz.html#isDirected"><span class="hs-identifier hs-var">isDirected</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-232"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">globalAttributes :: [GlobalAttributes]
</span><a href="Data.GraphViz.html#globalAttributes"><span class="hs-identifier hs-var">globalAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-233"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clusterBy :: (n, nl) -&gt; NodeCluster cl (n, nl)
</span><a href="Data.GraphViz.html#clusterBy"><span class="hs-identifier hs-var">clusterBy</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n, nl) -&gt; NodeCluster cl (n, nl)
forall c a. a -&gt; NodeCluster c a
</span><a href="Data.GraphViz.Algorithms.Clustering.html#N"><span class="hs-identifier hs-var">N</span></a></span><span>
</span><span id="line-234"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isDotCluster :: cl -&gt; Bool
</span><a href="Data.GraphViz.html#isDotCluster"><span class="hs-identifier hs-var">isDotCluster</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; cl -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-235"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clusterID :: cl -&gt; GraphID
</span><a href="Data.GraphViz.html#clusterID"><span class="hs-identifier hs-var">clusterID</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphID -&gt; cl -&gt; GraphID
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; GraphID
</span><a href="Data.GraphViz.Types.Internal.Common.html#Num"><span class="hs-identifier hs-var">Num</span></a></span><span> </span><span class="annot"><span class="annottext">(Number -&gt; GraphID) -&gt; Number -&gt; GraphID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Node -&gt; Number
</span><a href="Data.GraphViz.Attributes.Values.html#Int"><span class="hs-identifier hs-var">Int</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fmtCluster :: cl -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.html#fmtCluster"><span class="hs-identifier hs-var">fmtCluster</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalAttributes] -&gt; cl -&gt; [GlobalAttributes]
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-237"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fmtNode :: (n, nl) -&gt; Attributes
</span><a href="Data.GraphViz.html#fmtNode"><span class="hs-identifier hs-var">fmtNode</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; (n, nl) -&gt; Attributes
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fmtEdge :: (n, n, el) -&gt; Attributes
</span><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var">fmtEdge</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; (n, n, el) -&gt; Attributes
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | A variant of 'defaultParams' that enforces that the clustering</span><span>
</span><span id="line-242"></span><span class="hs-comment">--   type is @'()'@ (i.e.: no clustering); this avoids problems when</span><span>
</span><span id="line-243"></span><span class="hs-comment">--   using 'defaultParams' internally within a function without any</span><span>
</span><span id="line-244"></span><span class="hs-comment">--   constraint on what the clustering type is.</span><span>
</span><span id="line-245"></span><span id="local-6989586621679230014"><span id="local-6989586621679230015"><span id="local-6989586621679230016"><span class="annot"><a href="Data.GraphViz.html#nonClusteredParams"><span class="hs-identifier hs-type">nonClusteredParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230014"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230015"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230016"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679230015"><span class="hs-identifier hs-type">nl</span></a></span></span></span></span><span>
</span><span id="line-246"></span><span id="nonClusteredParams"><span class="annot"><span class="annottext">nonClusteredParams :: forall n nl el. GraphvizParams n nl el () nl
</span><a href="Data.GraphViz.html#nonClusteredParams"><span class="hs-identifier hs-var hs-var">nonClusteredParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el () nl
forall n nl el cl. GraphvizParams n nl el cl nl
</span><a href="Data.GraphViz.html#defaultParams"><span class="hs-identifier hs-var">defaultParams</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | A 'GraphvizParams' value where every field is set to</span><span>
</span><span id="line-249"></span><span class="hs-comment">--   @'undefined'@.  This is useful when you have a function that will</span><span>
</span><span id="line-250"></span><span class="hs-comment">--   set some of the values for you (e.g. 'setDirectedness') but you</span><span>
</span><span id="line-251"></span><span class="hs-comment">--   don't want to bother thinking of default values to set in the</span><span>
</span><span id="line-252"></span><span class="hs-comment">--   meantime.  This is especially useful when you are</span><span>
</span><span id="line-253"></span><span class="hs-comment">--   programmatically setting the clustering function (and as such do</span><span>
</span><span id="line-254"></span><span class="hs-comment">--   not know what the types might be).</span><span>
</span><span id="line-255"></span><span id="local-6989586621679230044"><span id="local-6989586621679230045"><span id="local-6989586621679230046"><span id="local-6989586621679230047"><span id="local-6989586621679230048"><span class="annot"><a href="Data.GraphViz.html#blankParams"><span class="hs-identifier hs-type">blankParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230044"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230045"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230046"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230047"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230048"><span class="hs-identifier hs-type">l</span></a></span></span></span></span></span></span><span>
</span><span id="line-256"></span><span id="blankParams"><span class="annot"><span class="annottext">blankParams :: forall n nl el cl l. GraphvizParams n nl el cl l
</span><a href="Data.GraphViz.html#blankParams"><span class="hs-identifier hs-var hs-var">blankParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">isDirected :: Bool
</span><a href="Data.GraphViz.html#isDirected"><span class="hs-identifier hs-var">isDirected</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unspecified definition of isDirected&quot;</span></span><span>
</span><span id="line-257"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">globalAttributes :: [GlobalAttributes]
</span><a href="Data.GraphViz.html#globalAttributes"><span class="hs-identifier hs-var">globalAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [GlobalAttributes]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unspecified definition of globalAttributes&quot;</span></span><span>
</span><span id="line-258"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clusterBy :: (n, nl) -&gt; NodeCluster cl (n, l)
</span><a href="Data.GraphViz.html#clusterBy"><span class="hs-identifier hs-var">clusterBy</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (n, nl) -&gt; NodeCluster cl (n, l)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unspecified definition of clusterBy&quot;</span></span><span>
</span><span id="line-259"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isDotCluster :: cl -&gt; Bool
</span><a href="Data.GraphViz.html#isDotCluster"><span class="hs-identifier hs-var">isDotCluster</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; cl -&gt; Bool
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unspecified definition of isDotCluster&quot;</span></span><span>
</span><span id="line-260"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clusterID :: cl -&gt; GraphID
</span><a href="Data.GraphViz.html#clusterID"><span class="hs-identifier hs-var">clusterID</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; cl -&gt; GraphID
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unspecified definition of clusterID&quot;</span></span><span>
</span><span id="line-261"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fmtCluster :: cl -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.html#fmtCluster"><span class="hs-identifier hs-var">fmtCluster</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; cl -&gt; [GlobalAttributes]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unspecified definition of fmtCluster&quot;</span></span><span>
</span><span id="line-262"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fmtNode :: (n, l) -&gt; Attributes
</span><a href="Data.GraphViz.html#fmtNode"><span class="hs-identifier hs-var">fmtNode</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (n, l) -&gt; Attributes
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unspecified definition of fmtNode&quot;</span></span><span>
</span><span id="line-263"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fmtEdge :: (n, n, el) -&gt; Attributes
</span><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var">fmtEdge</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (n, n, el) -&gt; Attributes
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unspecified definition of fmtEdge&quot;</span></span><span>
</span><span id="line-264"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Determine if the provided 'Graph' is directed or not and set the</span><span>
</span><span id="line-267"></span><span class="hs-comment">--   value of 'isDirected' appropriately.</span><span>
</span><span id="line-268"></span><span id="local-6989586621679230057"><span id="local-6989586621679230058"><span id="local-6989586621679230059"><span id="local-6989586621679230060"><span id="local-6989586621679230061"><span id="local-6989586621679230062"><span class="annot"><a href="Data.GraphViz.html#setDirectedness"><span class="hs-identifier hs-type">setDirectedness</span></a></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230057"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230058"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>                               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="annot"><a href="#local-6989586621679230059"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230057"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230060"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230061"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230058"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230059"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230057"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="annot"><a href="#local-6989586621679230059"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230057"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230060"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230061"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230058"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230059"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230057"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230062"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-271"></span><span id="setDirectedness"><span class="annot"><span class="annottext">setDirectedness :: forall el (gr :: * -&gt; * -&gt; *) nl cl l a.
(Ord el, Graph gr) =&gt;
(GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; a)
-&gt; GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; a
</span><a href="Data.GraphViz.html#setDirectedness"><span class="hs-identifier hs-var hs-var">setDirectedness</span></a></span></span><span> </span><span id="local-6989586621679230387"><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; a
</span><a href="#local-6989586621679230387"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679230388"><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230388"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679230389"><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230389"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; a
</span><a href="#local-6989586621679230387"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230390"><span class="hs-identifier hs-var">params'</span></a></span><span> </span><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230389"><span class="hs-identifier hs-var">gr</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679230390"><span class="annot"><span class="annottext">params' :: GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230390"><span class="hs-identifier hs-var hs-var">params'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230388"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.html#isDirected"><span class="hs-identifier hs-var">isDirected</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-type">not</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.html#isUndirected"><span class="hs-identifier hs-type">isUndirected</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230389"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Convert a graph to /Dot/ format, using the specified parameters</span><span>
</span><span id="line-276"></span><span class="hs-comment">--   to cluster the graph, etc.</span><span>
</span><span id="line-277"></span><span id="local-6989586621679230069"><span id="local-6989586621679230070"><span id="local-6989586621679230071"><span id="local-6989586621679230072"><span id="local-6989586621679230073"><span class="annot"><a href="Data.GraphViz.html#graphToDot"><span class="hs-identifier hs-type">graphToDot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230069"><span class="hs-identifier hs-type">cl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230070"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="annot"><a href="#local-6989586621679230071"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230072"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230069"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230073"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-278"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230070"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230071"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230072"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span></span></span></span></span></span><span>
</span><span id="line-279"></span><span id="graphToDot"><span class="annot"><span class="annottext">graphToDot :: forall cl (gr :: * -&gt; * -&gt; *) nl el l.
(Ord cl, Graph gr) =&gt;
GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; DotGraph Node
</span><a href="Data.GraphViz.html#graphToDot"><span class="hs-identifier hs-var hs-var">graphToDot</span></a></span></span><span> </span><span id="local-6989586621679230401"><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230401"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679230402"><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230402"><span class="hs-identifier hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
-&gt; [(Node, nl)] -&gt; [(Node, Node, el)] -&gt; DotGraph Node
forall cl n nl el l.
(Ord cl, Ord n) =&gt;
GraphvizParams n nl el cl l
-&gt; [(n, nl)] -&gt; [(n, n, el)] -&gt; DotGraph n
</span><a href="Data.GraphViz.html#graphElemsToDot"><span class="hs-identifier hs-var">graphElemsToDot</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230401"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">gr nl el -&gt; [(Node, nl)]
forall a b. gr a b -&gt; [LNode a]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><span class="hs-identifier hs-var">labNodes</span></span><span> </span><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230402"><span class="hs-identifier hs-var">graph</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">gr nl el -&gt; [(Node, Node, el)]
forall a b. gr a b -&gt; [LEdge b]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><span class="hs-identifier hs-var">labEdges</span></span><span> </span><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230402"><span class="hs-identifier hs-var">graph</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | As with 'graphToDot', but this allows you to easily convert other</span><span>
</span><span id="line-282"></span><span class="hs-comment">--   graph-like formats to a Dot graph as long as you can get a list</span><span>
</span><span id="line-283"></span><span class="hs-comment">--   of nodes and edges from it.</span><span>
</span><span id="line-284"></span><span id="local-6989586621679230080"><span id="local-6989586621679230081"><span id="local-6989586621679230082"><span id="local-6989586621679230083"><span id="local-6989586621679230084"><span class="annot"><a href="Data.GraphViz.html#graphElemsToDot"><span class="hs-identifier hs-type">graphElemsToDot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230080"><span class="hs-identifier hs-type">cl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230081"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230081"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230082"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230083"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230080"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230084"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-285"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679230081"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679230082"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679230081"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679230081"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679230083"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230081"><span class="hs-identifier hs-type">n</span></a></span></span></span></span></span></span><span>
</span><span id="line-286"></span><span id="graphElemsToDot"><span class="annot"><span class="annottext">graphElemsToDot :: forall cl n nl el l.
(Ord cl, Ord n) =&gt;
GraphvizParams n nl el cl l
-&gt; [(n, nl)] -&gt; [(n, n, el)] -&gt; DotGraph n
</span><a href="Data.GraphViz.html#graphElemsToDot"><span class="hs-identifier hs-var hs-var">graphElemsToDot</span></a></span></span><span> </span><span id="local-6989586621679230408"><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679230409"><span class="annot"><span class="annottext">[(n, nl)]
</span><a href="#local-6989586621679230409"><span class="hs-identifier hs-var">lns</span></a></span></span><span> </span><span id="local-6989586621679230410"><span class="annot"><span class="annottext">[(n, n, el)]
</span><a href="#local-6989586621679230410"><span class="hs-identifier hs-var">les</span></a></span></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">strictGraph :: Bool
</span><a href="Data.GraphViz.Types.Canonical.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-288"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">directedGraph :: Bool
</span><a href="Data.GraphViz.Types.Canonical.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679230414"><span class="hs-identifier hs-var">dirGraph</span></a></span><span>
</span><span id="line-289"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphID :: Maybe GraphID
</span><a href="Data.GraphViz.Types.Canonical.html#graphID"><span class="hs-identifier hs-var">graphID</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-290"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphStatements :: DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#graphStatements"><span class="hs-identifier hs-var">graphStatements</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679230417"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-291"></span><span>             </span><span class="hs-special">}</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679230414"><span class="annot"><span class="annottext">dirGraph :: Bool
</span><a href="#local-6989586621679230414"><span class="hs-identifier hs-var hs-var">dirGraph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l -&gt; Bool
forall n nl el cl l. GraphvizParams n nl el cl l -&gt; Bool
</span><a href="Data.GraphViz.html#isDirected"><span class="hs-identifier hs-var">isDirected</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679230417"><span class="annot"><span class="annottext">stmts :: DotStatements n
</span><a href="#local-6989586621679230417"><span class="hs-identifier hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStmts"><span class="hs-identifier hs-type">DotStmts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">attrStmts :: [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Canonical.html#attrStmts"><span class="hs-identifier hs-var">attrStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l -&gt; [GlobalAttributes]
forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.html#globalAttributes"><span class="hs-identifier hs-var">globalAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-295"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">subGraphs :: [DotSubGraph n]
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphs"><span class="hs-identifier hs-var">subGraphs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotSubGraph n]
</span><a href="#local-6989586621679230421"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-296"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nodeStmts :: [DotNode n]
</span><a href="Data.GraphViz.Types.Canonical.html#nodeStmts"><span class="hs-identifier hs-var">nodeStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679230423"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-297"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgeStmts :: [DotEdge n]
</span><a href="Data.GraphViz.Types.Canonical.html#edgeStmts"><span class="hs-identifier hs-var">edgeStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679230425"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-298"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679230421"><span class="annot"><span class="annottext">[DotSubGraph n]
</span><a href="#local-6989586621679230421"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679230423"><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679230423"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((n, nl) -&gt; NodeCluster cl (n, l))
-&gt; (cl -&gt; Bool)
-&gt; (cl -&gt; GraphID)
-&gt; (cl -&gt; [GlobalAttributes])
-&gt; ((n, l) -&gt; Attributes)
-&gt; [(n, nl)]
-&gt; ([DotSubGraph n], [DotNode n])
forall c n a l.
Ord c =&gt;
((n, a) -&gt; NodeCluster c (n, l))
-&gt; (c -&gt; Bool)
-&gt; (c -&gt; GraphID)
-&gt; (c -&gt; [GlobalAttributes])
-&gt; ((n, l) -&gt; Attributes)
-&gt; [(n, a)]
-&gt; ([DotSubGraph n], [DotNode n])
</span><a href="Data.GraphViz.Algorithms.Clustering.html#clustersToNodes"><span class="hs-identifier hs-var">clustersToNodes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l -&gt; (n, nl) -&gt; NodeCluster cl (n, l)
forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; (n, nl) -&gt; NodeCluster cl (n, l)
</span><a href="Data.GraphViz.html#clusterBy"><span class="hs-identifier hs-var">clusterBy</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l -&gt; cl -&gt; Bool
forall n nl el cl l. GraphvizParams n nl el cl l -&gt; cl -&gt; Bool
</span><a href="Data.GraphViz.html#isDotCluster"><span class="hs-identifier hs-var">isDotCluster</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l -&gt; cl -&gt; GraphID
forall n nl el cl l. GraphvizParams n nl el cl l -&gt; cl -&gt; GraphID
</span><a href="Data.GraphViz.html#clusterID"><span class="hs-identifier hs-var">clusterID</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l -&gt; cl -&gt; [GlobalAttributes]
forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; cl -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.html#fmtCluster"><span class="hs-identifier hs-var">fmtCluster</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l -&gt; (n, l) -&gt; Attributes
forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; (n, l) -&gt; Attributes
</span><a href="Data.GraphViz.html#fmtNode"><span class="hs-identifier hs-var">fmtNode</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                               </span><span class="annot"><span class="annottext">[(n, nl)]
</span><a href="#local-6989586621679230409"><span class="hs-identifier hs-var">lns</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679230425"><span class="annot"><span class="annottext">es :: [DotEdge n]
</span><a href="#local-6989586621679230425"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((n, n, el) -&gt; Maybe (DotEdge n)) -&gt; [(n, n, el)] -&gt; [DotEdge n]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(n, n, el) -&gt; Maybe (DotEdge n)
</span><a href="#local-6989586621679230429"><span class="hs-identifier hs-var">mkDotEdge</span></a></span><span> </span><span class="annot"><span class="annottext">[(n, n, el)]
</span><a href="#local-6989586621679230410"><span class="hs-identifier hs-var">les</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679230429"><span class="annot"><span class="annottext">mkDotEdge :: (n, n, el) -&gt; Maybe (DotEdge n)
</span><a href="#local-6989586621679230429"><span class="hs-identifier hs-var hs-var">mkDotEdge</span></a></span></span><span> </span><span id="local-6989586621679230432"><span class="annot"><span class="annottext">e :: (n, n, el)
</span><a href="#local-6989586621679230432"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679230433"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679230433"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230434"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679230434"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">el
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679230414"><span class="hs-identifier hs-var">dirGraph</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679230433"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679230434"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-304"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; Maybe (DotEdge n)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span>
</span><span id="line-305"></span><span>                               </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fromNode :: n
</span><a href="Data.GraphViz.Types.Internal.Common.html#fromNode"><span class="hs-identifier hs-var">fromNode</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679230433"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-306"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">toNode :: n
</span><a href="Data.GraphViz.Types.Internal.Common.html#toNode"><span class="hs-identifier hs-var">toNode</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679230434"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-307"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgeAttributes :: Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#edgeAttributes"><span class="hs-identifier hs-var">edgeAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l -&gt; (n, n, el) -&gt; Attributes
forall n nl el cl l.
GraphvizParams n nl el cl l -&gt; (n, n, el) -&gt; Attributes
</span><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var">fmtEdge</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl el cl l
</span><a href="#local-6989586621679230408"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">(n, n, el)
</span><a href="#local-6989586621679230432"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-308"></span><span>                                       </span><span class="hs-special">}</span><span>
</span><span id="line-309"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (DotEdge n)
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | A pseudo-inverse to 'graphToDot'; \&quot;pseudo\&quot; in the sense that</span><span>
</span><span id="line-312"></span><span class="hs-comment">--   the original node and edge labels aren't able to be</span><span>
</span><span id="line-313"></span><span class="hs-comment">--   reconstructed.</span><span>
</span><span id="line-314"></span><span id="local-6989586621679230103"><span id="local-6989586621679230105"><span class="annot"><a href="Data.GraphViz.html#dotToGraph"><span class="hs-identifier hs-type">dotToGraph</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.html#DotRepr"><span class="hs-identifier hs-type">DotRepr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230103"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230105"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230103"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span>
</span><span id="line-315"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230105"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span></span></span><span>
</span><span id="line-316"></span><span id="dotToGraph"><span class="annot"><span class="annottext">dotToGraph :: forall (dg :: * -&gt; *) (gr :: * -&gt; * -&gt; *).
(DotRepr dg Node, Graph gr) =&gt;
dg Node -&gt; gr Attributes Attributes
</span><a href="Data.GraphViz.html#dotToGraph"><span class="hs-identifier hs-var hs-var">dotToGraph</span></a></span></span><span> </span><span id="local-6989586621679230444"><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230444"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LNode Attributes]
-&gt; [LEdge Attributes] -&gt; gr Attributes Attributes
forall a b. [LNode a] -&gt; [LEdge b] -&gt; gr a b
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
[LNode a] -&gt; [LEdge b] -&gt; gr a b
</span><span class="hs-identifier hs-var">mkGraph</span></span><span> </span><span class="annot"><span class="annottext">[LNode Attributes]
</span><a href="#local-6989586621679230446"><span class="hs-identifier hs-var">ns'</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge Attributes]
</span><a href="#local-6989586621679230447"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679230450"><span class="annot"><span class="annottext">d :: Bool
</span><a href="#local-6989586621679230450"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dg Node -&gt; Bool
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; Bool
</span><a href="Data.GraphViz.Types.html#graphIsDirected"><span class="hs-identifier hs-var">graphIsDirected</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230444"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-comment">-- Applying uniqBy just in case...</span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679230455"><span class="annot"><span class="annottext">ns :: [LNode Attributes]
</span><a href="#local-6989586621679230455"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LNode Attributes -&gt; Node)
-&gt; [LNode Attributes] -&gt; [LNode Attributes]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href="Data.GraphViz.Internal.Util.html#uniqBy"><span class="hs-identifier hs-var">uniqBy</span></a></span><span> </span><span class="annot"><span class="annottext">LNode Attributes -&gt; Node
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([LNode Attributes] -&gt; [LNode Attributes])
-&gt; ([DotNode Node] -&gt; [LNode Attributes])
-&gt; [DotNode Node]
-&gt; [LNode Attributes]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DotNode Node -&gt; LNode Attributes)
-&gt; [DotNode Node] -&gt; [LNode Attributes]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">DotNode Node -&gt; LNode Attributes
forall {a}. DotNode a -&gt; (a, Attributes)
</span><a href="#local-6989586621679230458"><span class="hs-identifier hs-var">toLN</span></a></span><span> </span><span class="annot"><span class="annottext">([DotNode Node] -&gt; [LNode Attributes])
-&gt; [DotNode Node] -&gt; [LNode Attributes]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node -&gt; [DotNode Node]
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; [DotNode n]
</span><a href="Data.GraphViz.Types.html#graphNodes"><span class="hs-identifier hs-var">graphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230444"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679230447"><span class="annot"><span class="annottext">es :: [LEdge Attributes]
</span><a href="#local-6989586621679230447"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotEdge Node -&gt; [LEdge Attributes])
-&gt; [DotEdge Node] -&gt; [LEdge Attributes]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge Node -&gt; [LEdge Attributes]
forall {b}. DotEdge b -&gt; [(b, b, Attributes)]
</span><a href="#local-6989586621679230464"><span class="hs-identifier hs-var">toLE</span></a></span><span> </span><span class="annot"><span class="annottext">([DotEdge Node] -&gt; [LEdge Attributes])
-&gt; [DotEdge Node] -&gt; [LEdge Attributes]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node -&gt; [DotEdge Node]
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.html#graphEdges"><span class="hs-identifier hs-var">graphEdges</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230444"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-comment">-- Need to check that for some reason there aren't node IDs in an</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-comment">-- edge but not on their own.</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679230467"><span class="annot"><span class="annottext">nSet :: Set Node
</span><a href="#local-6989586621679230467"><span class="hs-identifier hs-var hs-var">nSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Node] -&gt; Set Node
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Node] -&gt; Set Node) -&gt; [Node] -&gt; Set Node
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(LNode Attributes -&gt; Node) -&gt; [LNode Attributes] -&gt; [Node]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">LNode Attributes -&gt; Node
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[LNode Attributes]
</span><a href="#local-6989586621679230455"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679230471"><span class="annot"><span class="annottext">nEs :: [(Node, [a])]
</span><a href="#local-6989586621679230471"><span class="hs-identifier hs-var hs-var">nEs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Node -&gt; (Node, [a])) -&gt; [Node] -&gt; [(Node, [a])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Node -&gt; [a] -&gt; (Node, [a])) -&gt; [a] -&gt; Node -&gt; (Node, [a])
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>          </span><span class="annot"><span class="annottext">([Node] -&gt; [(Node, [a])])
-&gt; ([Node] -&gt; [Node]) -&gt; [Node] -&gt; [(Node, [a])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Node] -&gt; [Node]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="Data.GraphViz.Internal.Util.html#uniq"><span class="hs-identifier hs-var">uniq</span></a></span><span>
</span><span id="line-327"></span><span>          </span><span class="annot"><span class="annottext">([Node] -&gt; [Node]) -&gt; ([Node] -&gt; [Node]) -&gt; [Node] -&gt; [Node]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Node -&gt; Bool) -&gt; [Node] -&gt; [Node]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; Set Node -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#notMember"><span class="hs-operator hs-var">`Set.notMember`</span></a></span><span> </span><span class="annot"><span class="annottext">Set Node
</span><a href="#local-6989586621679230467"><span class="hs-identifier hs-var">nSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>          </span><span class="annot"><span class="annottext">([Node] -&gt; [(Node, [a])]) -&gt; [Node] -&gt; [(Node, [a])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(LEdge Attributes -&gt; [Node]) -&gt; [LEdge Attributes] -&gt; [Node]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679230474"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230474"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230475"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230475"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Attributes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230474"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230475"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LEdge Attributes]
</span><a href="#local-6989586621679230447"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679230446"><span class="annot"><span class="annottext">ns' :: [LNode Attributes]
</span><a href="#local-6989586621679230446"><span class="hs-identifier hs-var hs-var">ns'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LNode Attributes]
</span><a href="#local-6989586621679230455"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">[LNode Attributes] -&gt; [LNode Attributes] -&gt; [LNode Attributes]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[LNode Attributes]
forall {a}. [(Node, [a])]
</span><a href="#local-6989586621679230471"><span class="hs-identifier hs-var">nEs</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-comment">-- Conversion functions</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679230458"><span class="annot"><span class="annottext">toLN :: DotNode a -&gt; (a, Attributes)
</span><a href="#local-6989586621679230458"><span class="hs-identifier hs-var hs-var">toLN</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier hs-type">DotNode</span></a></span><span> </span><span id="local-6989586621679230477"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230477"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679230478"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679230478"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230477"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679230478"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679230464"><span class="annot"><span class="annottext">toLE :: DotEdge b -&gt; [(b, b, Attributes)]
</span><a href="#local-6989586621679230464"><span class="hs-identifier hs-var hs-var">toLE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span id="local-6989586621679230479"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230479"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679230480"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230480"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679230481"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679230481"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679230450"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(b, b, Attributes)] -&gt; [(b, b, Attributes)]
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230480"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230479"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679230481"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230479"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230480"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679230481"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><span class="hs-comment">{- $augment
   The following functions provide support for passing a 'Graph'
   through the appropriate 'GraphvizCommand' to augment the 'Graph' by
   adding positional information, etc.

   A 'CustomAttribute' is used to distinguish multiple edges between
   two nodes from each other.

   Note that the reason that most of these functions do not have
   'unsafePerformIO' applied to them is because if you set a global
   'Attribute' of:

   @
    'Start' ('StartStyle' 'RandomStyle')
   @

   then it will not necessarily be referentially transparent (ideally,
   no matter what the seed is, it will still eventually be drawn to the
   same optimum, but this can't be guaranteed).  As such, if you are sure
   that you're not using such an 'Attribute', then you should be able to
   use 'unsafePerformIO' directly in your own code.
-}</span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-comment">-- | Augment the current node label type with the 'Attributes' applied</span><span>
</span><span id="line-360"></span><span class="hs-comment">--   to that node.</span><span>
</span><span id="line-361"></span><span class="hs-keyword">type</span><span> </span><span id="AttributeNode"><span class="annot"><a href="Data.GraphViz.html#AttributeNode"><span class="hs-identifier hs-var">AttributeNode</span></a></span></span><span> </span><span id="local-6989586621679230483"><span class="annot"><a href="#local-6989586621679230483"><span class="hs-identifier hs-type">nl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679230483"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Augment the current edge label type with the 'Attributes' applied</span><span>
</span><span id="line-364"></span><span class="hs-comment">--   to that edge.</span><span>
</span><span id="line-365"></span><span class="hs-keyword">type</span><span> </span><span id="AttributeEdge"><span class="annot"><a href="Data.GraphViz.html#AttributeEdge"><span class="hs-identifier hs-var">AttributeEdge</span></a></span></span><span> </span><span id="local-6989586621679230484"><span class="annot"><a href="#local-6989586621679230484"><span class="hs-identifier hs-type">el</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679230484"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | Run the appropriate Graphviz command on the graph to get</span><span>
</span><span id="line-368"></span><span class="hs-comment">--   positional information and then combine that information back</span><span>
</span><span id="line-369"></span><span class="hs-comment">--   into the original graph.</span><span>
</span><span id="line-370"></span><span id="local-6989586621679230139"><span id="local-6989586621679230140"><span id="local-6989586621679230141"><span id="local-6989586621679230142"><span id="local-6989586621679230143"><span class="annot"><a href="Data.GraphViz.html#graphToGraph"><span class="hs-identifier hs-type">graphToGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230139"><span class="hs-identifier hs-type">cl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230140"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="annot"><a href="#local-6989586621679230141"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230142"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230139"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230143"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230140"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230141"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230142"><span class="hs-identifier hs-type">el</span></a></span><span>
</span><span id="line-371"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679230140"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#AttributeNode"><span class="hs-identifier hs-type">AttributeNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230141"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#AttributeEdge"><span class="hs-identifier hs-type">AttributeEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230142"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-372"></span><span id="graphToGraph"><span class="annot"><span class="annottext">graphToGraph :: forall cl (gr :: * -&gt; * -&gt; *) nl el l.
(Ord cl, Graph gr) =&gt;
GraphvizParams Node nl el cl l
-&gt; gr nl el -&gt; IO (gr (AttributeNode nl) (AttributeEdge el))
</span><a href="Data.GraphViz.html#graphToGraph"><span class="hs-identifier hs-var hs-var">graphToGraph</span></a></span></span><span> </span><span id="local-6989586621679230498"><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230498"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679230499"><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230499"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; gr nl (EdgeID el)
-&gt; DotGraph Node
-&gt; IO (gr (AttributeNode nl) (AttributeEdge el))
forall (gr :: * -&gt; * -&gt; *) (dg :: * -&gt; *) nl el.
(Graph gr, PPDotRepr dg Node, FromGeneralisedDot dg Node) =&gt;
Bool
-&gt; gr nl (EdgeID el)
-&gt; dg Node
-&gt; IO (gr (AttributeNode nl) (AttributeEdge el))
</span><a href="Data.GraphViz.html#dotAttributes"><span class="hs-identifier hs-var">dotAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l -&gt; Bool
forall n nl el cl l. GraphvizParams n nl el cl l -&gt; Bool
</span><a href="Data.GraphViz.html#isDirected"><span class="hs-identifier hs-var">isDirected</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230498"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">gr nl (EdgeID el)
</span><a href="#local-6989586621679230500"><span class="hs-identifier hs-var">gr'</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph Node
</span><a href="#local-6989586621679230501"><span class="hs-identifier hs-var">dot</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679230501"><span class="annot"><span class="annottext">dot :: DotGraph Node
</span><a href="#local-6989586621679230501"><span class="hs-identifier hs-var hs-var">dot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl (EdgeID el) cl l
-&gt; gr nl (EdgeID el) -&gt; DotGraph Node
forall cl (gr :: * -&gt; * -&gt; *) nl el l.
(Ord cl, Graph gr) =&gt;
GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; DotGraph Node
</span><a href="Data.GraphViz.html#graphToDot"><span class="hs-identifier hs-var">graphToDot</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl (EdgeID el) cl l
</span><a href="#local-6989586621679230505"><span class="hs-identifier hs-var">params'</span></a></span><span> </span><span class="annot"><span class="annottext">gr nl (EdgeID el)
</span><a href="#local-6989586621679230500"><span class="hs-identifier hs-var">gr'</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span id="local-6989586621679230505"><span class="annot"><span class="annottext">params' :: GraphvizParams Node nl (EdgeID el) cl l
</span><a href="#local-6989586621679230505"><span class="hs-identifier hs-var hs-var">params'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230498"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var">fmtEdge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.html#setEdgeIDAttribute"><span class="hs-identifier hs-type">setEdgeIDAttribute</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var">fmtEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230498"><span class="hs-identifier hs-type">params</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621679230500"><span class="annot"><span class="annottext">gr' :: gr nl (EdgeID el)
</span><a href="#local-6989586621679230500"><span class="hs-identifier hs-var hs-var">gr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">gr nl el -&gt; gr nl (EdgeID el)
forall (gr :: * -&gt; * -&gt; *) nl el.
Graph gr =&gt;
gr nl el -&gt; gr nl (EdgeID el)
</span><a href="Data.GraphViz.html#addEdgeIDs"><span class="hs-identifier hs-var">addEdgeIDs</span></a></span><span> </span><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230499"><span class="hs-identifier hs-var">gr</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | This is a \&quot;quick-and-dirty\&quot; graph augmentation function that</span><span>
</span><span id="line-381"></span><span class="hs-comment">--   sets no 'Attributes' and thus should be referentially transparent</span><span>
</span><span id="line-382"></span><span class="hs-comment">--   and is wrapped in 'unsafePerformIO'.</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">--   Note that the provided 'GraphvizParams' is only used for</span><span>
</span><span id="line-385"></span><span class="hs-comment">--   'isDirected', 'clusterBy' and 'clusterID'.</span><span>
</span><span id="line-386"></span><span id="local-6989586621679230166"><span id="local-6989586621679230167"><span id="local-6989586621679230168"><span id="local-6989586621679230169"><span id="local-6989586621679230170"><span class="annot"><a href="Data.GraphViz.html#dotizeGraph"><span class="hs-identifier hs-type">dotizeGraph</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230166"><span class="hs-identifier hs-type">cl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230167"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.html#GraphvizParams"><span class="hs-identifier hs-type">GraphvizParams</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="annot"><a href="#local-6989586621679230168"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230169"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230166"><span class="hs-identifier hs-type">cl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230170"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-387"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230167"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230168"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230169"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230167"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#AttributeNode"><span class="hs-identifier hs-type">AttributeNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230168"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#AttributeEdge"><span class="hs-identifier hs-type">AttributeEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230169"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-388"></span><span id="dotizeGraph"><span class="annot"><span class="annottext">dotizeGraph :: forall cl (gr :: * -&gt; * -&gt; *) nl el l.
(Ord cl, Graph gr) =&gt;
GraphvizParams Node nl el cl l
-&gt; gr nl el -&gt; gr (AttributeNode nl) (AttributeEdge el)
</span><a href="Data.GraphViz.html#dotizeGraph"><span class="hs-identifier hs-var hs-var">dotizeGraph</span></a></span></span><span> </span><span id="local-6989586621679230511"><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230511"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679230512"><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230512"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (gr (AttributeNode nl) (AttributeEdge el))
-&gt; gr (AttributeNode nl) (AttributeEdge el)
forall a. IO a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span>
</span><span id="line-389"></span><span>                        </span><span class="annot"><span class="annottext">(IO (gr (AttributeNode nl) (AttributeEdge el))
 -&gt; gr (AttributeNode nl) (AttributeEdge el))
-&gt; IO (gr (AttributeNode nl) (AttributeEdge el))
-&gt; gr (AttributeNode nl) (AttributeEdge el)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
-&gt; gr nl el -&gt; IO (gr (AttributeNode nl) (AttributeEdge el))
forall cl (gr :: * -&gt; * -&gt; *) nl el l.
(Ord cl, Graph gr) =&gt;
GraphvizParams Node nl el cl l
-&gt; gr nl el -&gt; IO (gr (AttributeNode nl) (AttributeEdge el))
</span><a href="Data.GraphViz.html#graphToGraph"><span class="hs-identifier hs-var">graphToGraph</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
forall {el}. GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230513"><span class="hs-identifier hs-var">params'</span></a></span><span> </span><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230512"><span class="hs-identifier hs-var">gr</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679230513"><span class="annot"><span class="annottext">params' :: GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230513"><span class="hs-identifier hs-var hs-var">params'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el cl l
</span><a href="#local-6989586621679230511"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtCluster"><span class="hs-identifier hs-var">fmtCluster</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-392"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtNode"><span class="hs-identifier hs-var">fmtNode</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-393"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var">fmtEdge</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="annot"><span class="hs-comment">{- $manualAugment

   This section allows you to manually augment graphs by providing
   fine-grained control over the augmentation process (the standard
   augmentation functions compose these together).  Possible reasons for
   manual augmentation are:

   * Gain access to the intermediary 'DotRepr' used.

   * Convert the default 'DotGraph' to a @GDotGraph@ (found in
     &quot;Data.GraphViz.Types.Generalised&quot;) so as to have greater control over
     the generated Dot code.

   * Use a specific 'GraphvizCommand' rather than the default.

   Note that whilst these functions provide you with more control, you
   must be careful how you use them: if you use the wrong 'DotRepr' for
   a 'Graph', then the behaviour of 'augmentGraph' (and all functions
   that use it) is undefined.  The main point is to make sure that the
   defined 'DotNode' and 'DotEdge' values aren't removed (or their ID
   values - or the 'Attributes' for the 'DotEdge's - altered) to
   ensure that it is possible to match up the nodes and edges in the
   'Graph' with those in the 'DotRepr'.

-}</span></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><span class="hs-comment">-- | Used to augment an edge label with a unique identifier.</span></span><span>
</span><span id="line-425"></span><span class="hs-keyword">data</span><span> </span><span id="EdgeID"><span class="annot"><a href="Data.GraphViz.html#EdgeID"><span class="hs-identifier hs-var">EdgeID</span></a></span></span><span> </span><span id="local-6989586621679230178"><span class="annot"><a href="#local-6989586621679230178"><span class="hs-identifier hs-type">el</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EID"><span class="annot"><a href="Data.GraphViz.html#EID"><span class="hs-identifier hs-var">EID</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="eID"><span class="annot"><span class="annottext">forall el. EdgeID el -&gt; AttributeName
</span><a href="Data.GraphViz.html#eID"><span class="hs-identifier hs-var hs-var">eID</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.Lazy.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-426"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="eLbl"><span class="annot"><span class="annottext">forall el. EdgeID el -&gt; el
</span><a href="Data.GraphViz.html#eLbl"><span class="hs-identifier hs-var hs-var">eLbl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679230178"><span class="hs-identifier hs-type">el</span></a></span><span>
</span><span id="line-427"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-428"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679230519"><span id="local-6989586621679230524"><span class="annot"><span class="annottext">EdgeID el -&gt; EdgeID el -&gt; Bool
(EdgeID el -&gt; EdgeID el -&gt; Bool)
-&gt; (EdgeID el -&gt; EdgeID el -&gt; Bool) -&gt; Eq (EdgeID el)
forall el. Eq el =&gt; EdgeID el -&gt; EdgeID el -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall el. Eq el =&gt; EdgeID el -&gt; EdgeID el -&gt; Bool
== :: EdgeID el -&gt; EdgeID el -&gt; Bool
$c/= :: forall el. Eq el =&gt; EdgeID el -&gt; EdgeID el -&gt; Bool
/= :: EdgeID el -&gt; EdgeID el -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679230533"><span id="local-6989586621679230538"><span id="local-6989586621679230542"><span id="local-6989586621679230546"><span id="local-6989586621679230549"><span id="local-6989586621679230552"><span id="local-6989586621679230555"><span class="annot"><span class="annottext">Eq (EdgeID el)
Eq (EdgeID el) =&gt;
(EdgeID el -&gt; EdgeID el -&gt; Ordering)
-&gt; (EdgeID el -&gt; EdgeID el -&gt; Bool)
-&gt; (EdgeID el -&gt; EdgeID el -&gt; Bool)
-&gt; (EdgeID el -&gt; EdgeID el -&gt; Bool)
-&gt; (EdgeID el -&gt; EdgeID el -&gt; Bool)
-&gt; (EdgeID el -&gt; EdgeID el -&gt; EdgeID el)
-&gt; (EdgeID el -&gt; EdgeID el -&gt; EdgeID el)
-&gt; Ord (EdgeID el)
EdgeID el -&gt; EdgeID el -&gt; Bool
EdgeID el -&gt; EdgeID el -&gt; Ordering
EdgeID el -&gt; EdgeID el -&gt; EdgeID el
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall el. Ord el =&gt; Eq (EdgeID el)
forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; Bool
forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; Ordering
forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; EdgeID el
$ccompare :: forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; Ordering
compare :: EdgeID el -&gt; EdgeID el -&gt; Ordering
$c&lt; :: forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; Bool
&lt; :: EdgeID el -&gt; EdgeID el -&gt; Bool
$c&lt;= :: forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; Bool
&lt;= :: EdgeID el -&gt; EdgeID el -&gt; Bool
$c&gt; :: forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; Bool
&gt; :: EdgeID el -&gt; EdgeID el -&gt; Bool
$c&gt;= :: forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; Bool
&gt;= :: EdgeID el -&gt; EdgeID el -&gt; Bool
$cmax :: forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; EdgeID el
max :: EdgeID el -&gt; EdgeID el -&gt; EdgeID el
$cmin :: forall el. Ord el =&gt; EdgeID el -&gt; EdgeID el -&gt; EdgeID el
min :: EdgeID el -&gt; EdgeID el -&gt; EdgeID el
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679230560"><span id="local-6989586621679230566"><span id="local-6989586621679230570"><span class="annot"><span class="annottext">Node -&gt; EdgeID el -&gt; ShowS
[EdgeID el] -&gt; ShowS
EdgeID el -&gt; [Char]
(Node -&gt; EdgeID el -&gt; ShowS)
-&gt; (EdgeID el -&gt; [Char])
-&gt; ([EdgeID el] -&gt; ShowS)
-&gt; Show (EdgeID el)
forall el. Show el =&gt; Node -&gt; EdgeID el -&gt; ShowS
forall el. Show el =&gt; [EdgeID el] -&gt; ShowS
forall el. Show el =&gt; EdgeID el -&gt; [Char]
forall a.
(Node -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall el. Show el =&gt; Node -&gt; EdgeID el -&gt; ShowS
showsPrec :: Node -&gt; EdgeID el -&gt; ShowS
$cshow :: forall el. Show el =&gt; EdgeID el -&gt; [Char]
show :: EdgeID el -&gt; [Char]
$cshowList :: forall el. Show el =&gt; [EdgeID el] -&gt; ShowS
showList :: [EdgeID el] -&gt; ShowS
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- Show is only provided for printing/debugging purposes when using a</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- normal Tree-based graph.  Since it doesn't support Read, neither</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- does EdgeID.</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">-- | Add unique edge identifiers to each label.  This is useful for</span><span>
</span><span id="line-434"></span><span class="hs-comment">--   when multiple edges between two nodes need to be distinguished.</span><span>
</span><span id="line-435"></span><span id="local-6989586621679230163"><span id="local-6989586621679230164"><span id="local-6989586621679230165"><span class="annot"><a href="Data.GraphViz.html#addEdgeIDs"><span class="hs-identifier hs-type">addEdgeIDs</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230163"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230163"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230164"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230165"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230163"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230164"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#EdgeID"><span class="hs-identifier hs-type">EdgeID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230165"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-436"></span><span id="addEdgeIDs"><span class="annot"><span class="annottext">addEdgeIDs :: forall (gr :: * -&gt; * -&gt; *) nl el.
Graph gr =&gt;
gr nl el -&gt; gr nl (EdgeID el)
</span><a href="Data.GraphViz.html#addEdgeIDs"><span class="hs-identifier hs-var hs-var">addEdgeIDs</span></a></span></span><span> </span><span id="local-6989586621679230575"><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230575"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LNode nl] -&gt; [LEdge (EdgeID el)] -&gt; gr nl (EdgeID el)
forall a b. [LNode a] -&gt; [LEdge b] -&gt; gr a b
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
[LNode a] -&gt; [LEdge b] -&gt; gr a b
</span><span class="hs-identifier hs-var">mkGraph</span></span><span> </span><span class="annot"><span class="annottext">[LNode nl]
</span><a href="#local-6989586621679230576"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge (EdgeID el)]
</span><a href="#local-6989586621679230577"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621679230576"><span class="annot"><span class="annottext">ns :: [LNode nl]
</span><a href="#local-6989586621679230576"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">gr nl el -&gt; [LNode nl]
forall a b. gr a b -&gt; [LNode a]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><span class="hs-identifier hs-var">labNodes</span></span><span> </span><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230575"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621679230580"><span class="annot"><span class="annottext">es :: [LEdge el]
</span><a href="#local-6989586621679230580"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">gr nl el -&gt; [LEdge el]
forall a b. gr a b -&gt; [LEdge b]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><span class="hs-identifier hs-var">labEdges</span></span><span> </span><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230575"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621679230577"><span class="annot"><span class="annottext">es' :: [LEdge (EdgeID el)]
</span><a href="#local-6989586621679230577"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LEdge el -&gt; Node -&gt; LEdge (EdgeID el))
-&gt; [LEdge el] -&gt; [Node] -&gt; [LEdge (EdgeID el)]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">LEdge el -&gt; Node -&gt; LEdge (EdgeID el)
forall {a} {a} {b} {el}.
Show a =&gt;
(a, b, el) -&gt; a -&gt; (a, b, EdgeID el)
</span><a href="#local-6989586621679230586"><span class="hs-identifier hs-var">addID</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge el]
</span><a href="#local-6989586621679230580"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Node
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621679230586"><span class="annot"><span class="annottext">addID :: (a, b, el) -&gt; a -&gt; (a, b, EdgeID el)
</span><a href="#local-6989586621679230586"><span class="hs-identifier hs-var hs-var">addID</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679230589"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230589"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230590"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230590"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230591"><span class="annot"><span class="annottext">el
</span><a href="#local-6989586621679230591"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679230592"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230592"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230589"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230590"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">AttributeName -&gt; el -&gt; EdgeID el
forall el. AttributeName -&gt; el -&gt; EdgeID el
</span><a href="Data.GraphViz.html#EID"><span class="hs-identifier hs-var">EID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AttributeName
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Lazy.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; AttributeName) -&gt; [Char] -&gt; AttributeName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230592"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">el
</span><a href="#local-6989586621679230591"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- | Add a custom attribute to the list of attributes containing the</span><span>
</span><span id="line-444"></span><span class="hs-comment">--   value of the unique edge identifier.</span><span>
</span><span id="line-445"></span><span id="local-6989586621679230162"><span class="annot"><a href="Data.GraphViz.html#setEdgeIDAttribute"><span class="hs-identifier hs-type">setEdgeIDAttribute</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LEdge</span></span><span> </span><span class="annot"><a href="#local-6989586621679230162"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LEdge</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#EdgeID"><span class="hs-identifier hs-type">EdgeID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230162"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-447"></span><span id="setEdgeIDAttribute"><span class="annot"><span class="annottext">setEdgeIDAttribute :: forall el.
(LEdge el -&gt; Attributes) -&gt; LEdge (EdgeID el) -&gt; Attributes
</span><a href="Data.GraphViz.html#setEdgeIDAttribute"><span class="hs-identifier hs-var hs-var">setEdgeIDAttribute</span></a></span></span><span> </span><span id="local-6989586621679230595"><span class="annot"><span class="annottext">LEdge el -&gt; Attributes
</span><a href="#local-6989586621679230595"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679230596"><span class="annot"><span class="annottext">e :: LEdge (EdgeID el)
</span><a href="#local-6989586621679230596"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679230597"><span class="annot"><span class="annottext">EdgeID el
</span><a href="#local-6989586621679230597"><span class="hs-identifier hs-var">eid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AttributeName -&gt; Attribute
</span><a href="Data.GraphViz.html#identifierAttribute"><span class="hs-identifier hs-var">identifierAttribute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EdgeID el -&gt; AttributeName
forall el. EdgeID el -&gt; AttributeName
</span><a href="Data.GraphViz.html#eID"><span class="hs-identifier hs-var">eID</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeID el
</span><a href="#local-6989586621679230597"><span class="hs-identifier hs-var">eid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>                                        </span><span class="annot"><span class="annottext">Attribute -&gt; Attributes -&gt; Attributes
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LEdge el -&gt; Attributes
</span><a href="#local-6989586621679230595"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(LEdge el -&gt; Attributes)
-&gt; (LEdge (EdgeID el) -&gt; LEdge el)
-&gt; LEdge (EdgeID el)
-&gt; Attributes
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LEdge (EdgeID el) -&gt; LEdge el
forall el. LEdge (EdgeID el) -&gt; LEdge el
</span><a href="Data.GraphViz.html#stripID"><span class="hs-identifier hs-var">stripID</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LEdge (EdgeID el)
</span><a href="#local-6989586621679230596"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="annot"><a href="Data.GraphViz.html#identifierAttrName"><span class="hs-identifier hs-type">identifierAttrName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#AttributeName"><span class="hs-identifier hs-type">AttributeName</span></a></span><span>
</span><span id="line-451"></span><span id="identifierAttrName"><span class="annot"><span class="annottext">identifierAttrName :: AttributeName
</span><a href="Data.GraphViz.html#identifierAttrName"><span class="hs-identifier hs-var hs-var">identifierAttrName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttributeName
</span><span class="hs-string">&quot;graphviz_distinguish_multiple_edges&quot;</span></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="annot"><a href="Data.GraphViz.html#identifierAttribute"><span class="hs-identifier hs-type">identifierAttribute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.Lazy.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#CustomAttribute"><span class="hs-identifier hs-type">CustomAttribute</span></a></span><span>
</span><span id="line-454"></span><span id="identifierAttribute"><span class="annot"><span class="annottext">identifierAttribute :: AttributeName -&gt; Attribute
</span><a href="Data.GraphViz.html#identifierAttribute"><span class="hs-identifier hs-var hs-var">identifierAttribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttributeName -&gt; AttributeName -&gt; Attribute
</span><a href="Data.GraphViz.Attributes.Complete.html#customAttribute"><span class="hs-identifier hs-var">customAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">AttributeName
</span><a href="Data.GraphViz.html#identifierAttrName"><span class="hs-identifier hs-var">identifierAttrName</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="annot"><span class="hs-comment">-- | Remove the unique identifier from the 'LEdge'.</span></span><span>
</span><span id="line-457"></span><span id="local-6989586621679230201"><span class="annot"><a href="Data.GraphViz.html#stripID"><span class="hs-identifier hs-type">stripID</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LEdge</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#EdgeID"><span class="hs-identifier hs-type">EdgeID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230201"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LEdge</span></span><span> </span><span class="annot"><a href="#local-6989586621679230201"><span class="hs-identifier hs-type">el</span></a></span></span><span>
</span><span id="line-458"></span><span id="stripID"><span class="annot"><span class="annottext">stripID :: forall el. LEdge (EdgeID el) -&gt; LEdge el
</span><a href="Data.GraphViz.html#stripID"><span class="hs-identifier hs-var hs-var">stripID</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679230601"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230601"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230602"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230602"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230603"><span class="annot"><span class="annottext">EdgeID el
</span><a href="#local-6989586621679230603"><span class="hs-identifier hs-var">eid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230601"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230602"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EdgeID el -&gt; el
forall el. EdgeID el -&gt; el
</span><a href="Data.GraphViz.html#eLbl"><span class="hs-identifier hs-var">eLbl</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeID el
</span><a href="#local-6989586621679230603"><span class="hs-identifier hs-var">eid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | Pass the 'DotRepr' through the relevant command and then augment</span><span>
</span><span id="line-461"></span><span class="hs-comment">--   the 'Graph' that it came from.</span><span>
</span><span id="line-462"></span><span id="local-6989586621679230158"><span id="local-6989586621679230159"><span id="local-6989586621679230160"><span id="local-6989586621679230161"><span class="annot"><a href="Data.GraphViz.html#dotAttributes"><span class="hs-identifier hs-type">dotAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230158"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#PPDotRepr"><span class="hs-identifier hs-type">PPDotRepr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230159"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Generalised.html#FromGeneralisedDot"><span class="hs-identifier hs-type">FromGeneralisedDot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230159"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230158"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230160"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#EdgeID"><span class="hs-identifier hs-type">EdgeID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230161"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230159"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679230158"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#AttributeNode"><span class="hs-identifier hs-type">AttributeNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230160"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#AttributeEdge"><span class="hs-identifier hs-type">AttributeEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230161"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-465"></span><span id="dotAttributes"><span class="annot"><span class="annottext">dotAttributes :: forall (gr :: * -&gt; * -&gt; *) (dg :: * -&gt; *) nl el.
(Graph gr, PPDotRepr dg Node, FromGeneralisedDot dg Node) =&gt;
Bool
-&gt; gr nl (EdgeID el)
-&gt; dg Node
-&gt; IO (gr (AttributeNode nl) (AttributeEdge el))
</span><a href="Data.GraphViz.html#dotAttributes"><span class="hs-identifier hs-var hs-var">dotAttributes</span></a></span></span><span> </span><span id="local-6989586621679230621"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679230621"><span class="hs-identifier hs-var">isDir</span></a></span></span><span> </span><span id="local-6989586621679230622"><span class="annot"><span class="annottext">gr nl (EdgeID el)
</span><a href="#local-6989586621679230622"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span id="local-6989586621679230623"><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230623"><span class="hs-identifier hs-var">dot</span></a></span></span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">gr nl (EdgeID el)
-&gt; dg Node -&gt; gr (AttributeNode nl) (AttributeEdge el)
forall (gr :: * -&gt; * -&gt; *) (dg :: * -&gt; *) nl el.
(Graph gr, DotRepr dg Node) =&gt;
gr nl (EdgeID el)
-&gt; dg Node -&gt; gr (AttributeNode nl) (AttributeEdge el)
</span><a href="Data.GraphViz.html#augmentGraph"><span class="hs-identifier hs-var">augmentGraph</span></a></span><span> </span><span class="annot"><span class="annottext">gr nl (EdgeID el)
</span><a href="#local-6989586621679230622"><span class="hs-identifier hs-var">gr</span></a></span><span> </span><span class="annot"><span class="annottext">(dg Node -&gt; gr (AttributeNode nl) (AttributeEdge el))
-&gt; (DotGraph Node -&gt; dg Node)
-&gt; DotGraph Node
-&gt; gr (AttributeNode nl) (AttributeEdge el)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph Node -&gt; dg Node
</span><a href="#local-6989586621679230624"><span class="hs-identifier hs-var">parseDG</span></a></span><span> </span><span class="annot"><span class="annottext">(DotGraph Node -&gt; gr (AttributeNode nl) (AttributeEdge el))
-&gt; IO (DotGraph Node)
-&gt; IO (gr (AttributeNode nl) (AttributeEdge el))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizCommand
-&gt; dg Node
-&gt; GraphvizOutput
-&gt; (Handle -&gt; IO (DotGraph Node))
-&gt; IO (DotGraph Node)
forall (dg :: * -&gt; *) n a.
PrintDotRepr dg n =&gt;
GraphvizCommand
-&gt; dg n -&gt; GraphvizOutput -&gt; (Handle -&gt; IO a) -&gt; IO a
</span><a href="Data.GraphViz.Commands.html#graphvizWithHandle"><span class="hs-identifier hs-var">graphvizWithHandle</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizCommand
</span><a href="#local-6989586621679230627"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230623"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizOutput
</span><a href="Data.GraphViz.Commands.html#DotOutput"><span class="hs-identifier hs-var">DotOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO (DotGraph Node)
forall (dg :: * -&gt; *) n. ParseDotRepr dg n =&gt; Handle -&gt; IO (dg n)
</span><a href="Data.GraphViz.Commands.IO.html#hGetDot"><span class="hs-identifier hs-var">hGetDot</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621679230624"><span class="annot"><span class="annottext">parseDG :: DotGraph Node -&gt; dg Node
</span><a href="#local-6989586621679230624"><span class="hs-identifier hs-var hs-var">parseDG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">dg Node -&gt; dg Node -&gt; dg Node
forall a. a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#asTypeOf"><span class="hs-operator hs-var">`asTypeOf`</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230623"><span class="hs-identifier hs-var">dot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(dg Node -&gt; dg Node)
-&gt; (DotGraph Node -&gt; dg Node) -&gt; DotGraph Node -&gt; dg Node
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph Node -&gt; dg Node
forall (dg :: * -&gt; *) n.
FromGeneralisedDot dg n =&gt;
DotGraph n -&gt; dg n
</span><a href="Data.GraphViz.Types.Generalised.html#fromGeneralised"><span class="hs-identifier hs-var">fromGeneralised</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span id="local-6989586621679230627"><span class="annot"><span class="annottext">command :: GraphvizCommand
</span><a href="#local-6989586621679230627"><span class="hs-identifier hs-var hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679230621"><span class="hs-identifier hs-var">isDir</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GraphvizCommand
</span><a href="Data.GraphViz.Commands.html#dirCommand"><span class="hs-identifier hs-var">dirCommand</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">GraphvizCommand
</span><a href="Data.GraphViz.Commands.html#undirCommand"><span class="hs-identifier hs-var">undirCommand</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="hs-comment">-- | Use the 'Attributes' in the provided 'DotGraph' to augment the</span><span>
</span><span id="line-472"></span><span class="hs-comment">--   node and edge labels in the provided 'Graph'.  The unique</span><span>
</span><span id="line-473"></span><span class="hs-comment">--   identifiers on the edges are also stripped off.</span><span>
</span><span id="line-474"></span><span class="hs-comment">--</span><span>
</span><span id="line-475"></span><span class="hs-comment">--   Please note that the behaviour for this function is undefined if</span><span>
</span><span id="line-476"></span><span class="hs-comment">--   the 'DotGraph' does not come from the original 'Graph' (either</span><span>
</span><span id="line-477"></span><span class="hs-comment">--   by using a conversion function or by passing the result of a</span><span>
</span><span id="line-478"></span><span class="hs-comment">--   conversion function through a 'GraphvizCommand' via the</span><span>
</span><span id="line-479"></span><span class="hs-comment">--   'DotOutput' or similar).</span><span>
</span><span id="line-480"></span><span id="local-6989586621679230215"><span id="local-6989586621679230216"><span id="local-6989586621679230217"><span id="local-6989586621679230218"><span class="annot"><a href="Data.GraphViz.html#augmentGraph"><span class="hs-identifier hs-type">augmentGraph</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230215"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#DotRepr"><span class="hs-identifier hs-type">DotRepr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230216"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230215"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230217"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#EdgeID"><span class="hs-identifier hs-type">EdgeID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230218"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230216"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230215"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#AttributeNode"><span class="hs-identifier hs-type">AttributeNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230217"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.html#AttributeEdge"><span class="hs-identifier hs-type">AttributeEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230218"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-482"></span><span id="augmentGraph"><span class="annot"><span class="annottext">augmentGraph :: forall (gr :: * -&gt; * -&gt; *) (dg :: * -&gt; *) nl el.
(Graph gr, DotRepr dg Node) =&gt;
gr nl (EdgeID el)
-&gt; dg Node -&gt; gr (AttributeNode nl) (AttributeEdge el)
</span><a href="Data.GraphViz.html#augmentGraph"><span class="hs-identifier hs-var hs-var">augmentGraph</span></a></span></span><span> </span><span id="local-6989586621679230639"><span class="annot"><span class="annottext">gr nl (EdgeID el)
</span><a href="#local-6989586621679230639"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679230640"><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230640"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LNode (AttributeNode nl)]
-&gt; [LEdge (AttributeEdge el)]
-&gt; gr (AttributeNode nl) (AttributeEdge el)
forall a b. [LNode a] -&gt; [LEdge b] -&gt; gr a b
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
[LNode a] -&gt; [LEdge b] -&gt; gr a b
</span><span class="hs-identifier hs-var">mkGraph</span></span><span> </span><span class="annot"><span class="annottext">[LNode (AttributeNode nl)]
</span><a href="#local-6989586621679230641"><span class="hs-identifier hs-var">lns</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge (AttributeEdge el)]
</span><a href="#local-6989586621679230642"><span class="hs-identifier hs-var">les</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>    </span><span id="local-6989586621679230641"><span class="annot"><span class="annottext">lns :: [LNode (AttributeNode nl)]
</span><a href="#local-6989586621679230641"><span class="hs-identifier hs-var hs-var">lns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Node, nl) -&gt; LNode (AttributeNode nl))
-&gt; [(Node, nl)] -&gt; [LNode (AttributeNode nl)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679230645"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230645"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679230646"><span class="annot"><span class="annottext">nl
</span><a href="#local-6989586621679230646"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230645"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Node Attributes
</span><a href="#local-6989586621679230647"><span class="hs-identifier hs-var">nodeMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map Node Attributes -&gt; Node -&gt; Attributes
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679230645"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nl
</span><a href="#local-6989586621679230646"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>          </span><span class="annot"><span class="annottext">([(Node, nl)] -&gt; [LNode (AttributeNode nl)])
-&gt; [(Node, nl)] -&gt; [LNode (AttributeNode nl)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">gr nl (EdgeID el) -&gt; [(Node, nl)]
forall a b. gr a b -&gt; [LNode a]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><span class="hs-identifier hs-var">labNodes</span></span><span> </span><span class="annot"><span class="annottext">gr nl (EdgeID el)
</span><a href="#local-6989586621679230639"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-486"></span><span>    </span><span id="local-6989586621679230642"><span class="annot"><span class="annottext">les :: [LEdge (AttributeEdge el)]
</span><a href="#local-6989586621679230642"><span class="hs-identifier hs-var hs-var">les</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Node, Node, EdgeID el) -&gt; LEdge (AttributeEdge el))
-&gt; [(Node, Node, EdgeID el)] -&gt; [LEdge (AttributeEdge el)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Node, Node, EdgeID el) -&gt; LEdge (AttributeEdge el)
forall {a} {b} {b}. (a, b, EdgeID b) -&gt; (a, b, (Attributes, b))
</span><a href="#local-6989586621679230650"><span class="hs-identifier hs-var">augmentEdge</span></a></span><span> </span><span class="annot"><span class="annottext">([(Node, Node, EdgeID el)] -&gt; [LEdge (AttributeEdge el)])
-&gt; [(Node, Node, EdgeID el)] -&gt; [LEdge (AttributeEdge el)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">gr nl (EdgeID el) -&gt; [(Node, Node, EdgeID el)]
forall a b. gr a b -&gt; [LEdge b]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><span class="hs-identifier hs-var">labEdges</span></span><span> </span><span class="annot"><span class="annottext">gr nl (EdgeID el)
</span><a href="#local-6989586621679230639"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span id="local-6989586621679230650"><span class="annot"><span class="annottext">augmentEdge :: (a, b, EdgeID b) -&gt; (a, b, (Attributes, b))
</span><a href="#local-6989586621679230650"><span class="hs-identifier hs-var hs-var">augmentEdge</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679230652"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230652"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679230653"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230653"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Data.GraphViz.html#EID"><span class="hs-identifier hs-type">EID</span></a></span><span> </span><span id="local-6989586621679230654"><span class="annot"><span class="annottext">AttributeName
</span><a href="#local-6989586621679230654"><span class="hs-identifier hs-var">eid</span></a></span></span><span> </span><span id="local-6989586621679230655"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230655"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679230652"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230653"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AttributeName Attributes
</span><a href="#local-6989586621679230656"><span class="hs-identifier hs-var">edgeMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map AttributeName Attributes -&gt; AttributeName -&gt; Attributes
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a></span><span> </span><span class="annot"><span class="annottext">AttributeName
</span><a href="#local-6989586621679230654"><span class="hs-identifier hs-var">eid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679230655"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>    </span><span id="local-6989586621679230659"><span class="annot"><span class="annottext">ns :: [DotNode Node]
</span><a href="#local-6989586621679230659"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dg Node -&gt; [DotNode Node]
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; [DotNode n]
</span><a href="Data.GraphViz.Types.html#graphNodes"><span class="hs-identifier hs-var">graphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230640"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621679230662"><span class="annot"><span class="annottext">es :: [DotEdge Node]
</span><a href="#local-6989586621679230662"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dg Node -&gt; [DotEdge Node]
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.html#graphEdges"><span class="hs-identifier hs-var">graphEdges</span></a></span><span> </span><span class="annot"><span class="annottext">dg Node
</span><a href="#local-6989586621679230640"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679230647"><span class="annot"><span class="annottext">nodeMap :: Map Node Attributes
</span><a href="#local-6989586621679230647"><span class="hs-identifier hs-var hs-var">nodeMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LNode Attributes] -&gt; Map Node Attributes
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([LNode Attributes] -&gt; Map Node Attributes)
-&gt; [LNode Attributes] -&gt; Map Node Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DotNode Node -&gt; LNode Attributes)
-&gt; [DotNode Node] -&gt; [LNode Attributes]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DotNode Node -&gt; Node
forall n. DotNode n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#nodeID"><span class="hs-identifier hs-var">nodeID</span></a></span><span> </span><span class="annot"><span class="annottext">(DotNode Node -&gt; Node)
-&gt; (DotNode Node -&gt; Attributes) -&gt; DotNode Node -&gt; LNode Attributes
forall b c c'. (b -&gt; c) -&gt; (b -&gt; c') -&gt; b -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#%26%26%26"><span class="hs-operator hs-var">&amp;&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">DotNode Node -&gt; Attributes
forall n. DotNode n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#nodeAttributes"><span class="hs-identifier hs-var">nodeAttributes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DotNode Node]
</span><a href="#local-6989586621679230659"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621679230656"><span class="annot"><span class="annottext">edgeMap :: Map AttributeName Attributes
</span><a href="#local-6989586621679230656"><span class="hs-identifier hs-var hs-var">edgeMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AttributeName, Attributes)] -&gt; Map AttributeName Attributes
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(AttributeName, Attributes)] -&gt; Map AttributeName Attributes)
-&gt; [(AttributeName, Attributes)] -&gt; Map AttributeName Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DotEdge Node -&gt; (AttributeName, Attributes))
-&gt; [DotEdge Node] -&gt; [(AttributeName, Attributes)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge Node -&gt; (AttributeName, Attributes)
forall {n}. DotEdge n -&gt; (AttributeName, Attributes)
</span><a href="#local-6989586621679230670"><span class="hs-identifier hs-var">edgeIDAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge Node]
</span><a href="#local-6989586621679230662"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-492"></span><span>    </span><span id="local-6989586621679230670"><span class="annot"><span class="annottext">edgeIDAttrs :: DotEdge n -&gt; (AttributeName, Attributes)
</span><a href="#local-6989586621679230670"><span class="hs-identifier hs-var hs-var">edgeIDAttrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attribute -&gt; AttributeName)
-&gt; (Attribute, Attributes) -&gt; (AttributeName, Attributes)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; AttributeName
</span><a href="Data.GraphViz.Attributes.Complete.html#customValue"><span class="hs-identifier hs-var">customValue</span></a></span><span> </span><span class="annot"><span class="annottext">((Attribute, Attributes) -&gt; (AttributeName, Attributes))
-&gt; (DotEdge n -&gt; (Attribute, Attributes))
-&gt; DotEdge n
-&gt; (AttributeName, Attributes)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Attribute, Attributes) -&gt; (Attribute, Attributes)
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span>
</span><span id="line-493"></span><span>                  </span><span class="annot"><span class="annottext">(Maybe (Attribute, Attributes) -&gt; (Attribute, Attributes))
-&gt; (DotEdge n -&gt; Maybe (Attribute, Attributes))
-&gt; DotEdge n
-&gt; (Attribute, Attributes)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AttributeName -&gt; Attributes -&gt; Maybe (Attribute, Attributes)
</span><a href="Data.GraphViz.Attributes.Complete.html#findSpecifiedCustom"><span class="hs-identifier hs-var">findSpecifiedCustom</span></a></span><span> </span><span class="annot"><span class="annottext">AttributeName
</span><a href="Data.GraphViz.html#identifierAttrName"><span class="hs-identifier hs-var">identifierAttrName</span></a></span><span>
</span><span id="line-494"></span><span>                  </span><span class="annot"><span class="annottext">(Attributes -&gt; Maybe (Attribute, Attributes))
-&gt; (DotEdge n -&gt; Attributes)
-&gt; DotEdge n
-&gt; Maybe (Attribute, Attributes)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; Attributes
forall n. DotEdge n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#edgeAttributes"><span class="hs-identifier hs-var">edgeAttributes</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- Utility Functions</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-comment">-- | Quickly visualise a graph using the 'Xlib' 'GraphvizCanvas'.  If</span><span>
</span><span id="line-500"></span><span class="hs-comment">--   your label types are not (and cannot) be instances of 'Labellable',</span><span>
</span><span id="line-501"></span><span class="hs-comment">--   you may wish to use 'gmap', 'nmap' or 'emap' to set them to a value</span><span>
</span><span id="line-502"></span><span class="hs-comment">--   such as @\&quot;\&quot;@.</span><span>
</span><span id="line-503"></span><span id="local-6989586621679230256"><span id="local-6989586621679230257"><span id="local-6989586621679230258"><span class="annot"><a href="Data.GraphViz.html#preview"><span class="hs-identifier hs-type">preview</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230256"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Graph</span></span><span> </span><span class="annot"><a href="#local-6989586621679230257"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.html#Labellable"><span class="hs-identifier hs-type">Labellable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230258"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.html#Labellable"><span class="hs-identifier hs-type">Labellable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230256"><span class="hs-identifier hs-type">el</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679230257"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230258"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679230256"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-504"></span><span id="preview"><span class="annot"><span class="annottext">preview :: forall el (gr :: * -&gt; * -&gt; *) nl.
(Ord el, Graph gr, Labellable nl, Labellable el) =&gt;
gr nl el -&gt; IO ()
</span><a href="Data.GraphViz.html#preview"><span class="hs-identifier hs-var hs-var">preview</span></a></span></span><span> </span><span id="local-6989586621679230687"><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230687"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ThreadId -&gt; IO ()
forall {a}. IO a -&gt; IO ()
</span><a href="#local-6989586621679230688"><span class="hs-identifier hs-var">ign</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ThreadId -&gt; IO ()) -&gt; IO ThreadId -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#forkIO"><span class="hs-identifier hs-var">forkIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall {a}. IO a -&gt; IO ()
</span><a href="#local-6989586621679230688"><span class="hs-identifier hs-var">ign</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph Node -&gt; GraphvizCanvas -&gt; IO ()
forall (dg :: * -&gt; *) n.
PrintDotRepr dg n =&gt;
dg n -&gt; GraphvizCanvas -&gt; IO ()
</span><a href="Data.GraphViz.Commands.html#runGraphvizCanvas%27"><span class="hs-identifier hs-var">runGraphvizCanvas'</span></a></span><span> </span><span class="annot"><span class="annottext">DotGraph Node
</span><a href="#local-6989586621679230690"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizCanvas
</span><a href="Data.GraphViz.Commands.html#Xlib"><span class="hs-identifier hs-var">Xlib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>    </span><span id="local-6989586621679230690"><span class="annot"><span class="annottext">dg :: DotGraph Node
</span><a href="#local-6989586621679230690"><span class="hs-identifier hs-var hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphvizParams Node nl el () nl -&gt; gr nl el -&gt; DotGraph Node)
-&gt; GraphvizParams Node nl el () nl -&gt; gr nl el -&gt; DotGraph Node
forall el (gr :: * -&gt; * -&gt; *) nl cl l a.
(Ord el, Graph gr) =&gt;
(GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; a)
-&gt; GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; a
</span><a href="Data.GraphViz.html#setDirectedness"><span class="hs-identifier hs-var">setDirectedness</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el () nl -&gt; gr nl el -&gt; DotGraph Node
forall cl (gr :: * -&gt; * -&gt; *) nl el l.
(Ord cl, Graph gr) =&gt;
GraphvizParams Node nl el cl l -&gt; gr nl el -&gt; DotGraph Node
</span><a href="Data.GraphViz.html#graphToDot"><span class="hs-identifier hs-var">graphToDot</span></a></span><span> </span><span class="annot"><span class="annottext">GraphvizParams Node nl el () nl
forall {n}. GraphvizParams n nl el () nl
</span><a href="#local-6989586621679230697"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">gr nl el
</span><a href="#local-6989586621679230687"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-507"></span><span>    </span><span id="local-6989586621679230697"><span class="annot"><span class="annottext">params :: GraphvizParams n nl el () nl
</span><a href="#local-6989586621679230697"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphvizParams n nl Any () nl
forall n nl el. GraphvizParams n nl el () nl
</span><a href="Data.GraphViz.html#nonClusteredParams"><span class="hs-identifier hs-var">nonClusteredParams</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtNode"><span class="hs-identifier hs-var">fmtNode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679230700"><span class="annot"><span class="annottext">nl
</span><a href="#local-6989586621679230700"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">nl -&gt; Attribute
forall a. Labellable a =&gt; a -&gt; Attribute
</span><a href="Data.GraphViz.Attributes.html#toLabel"><span class="hs-identifier hs-var">toLabel</span></a></span><span> </span><span class="annot"><span class="annottext">nl
</span><a href="#local-6989586621679230700"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-508"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.html#fmtEdge"><span class="hs-identifier hs-var">fmtEdge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679230701"><span class="annot"><span class="annottext">el
</span><a href="#local-6989586621679230701"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">el -&gt; Attribute
forall a. Labellable a =&gt; a -&gt; Attribute
</span><a href="Data.GraphViz.Attributes.html#toLabel"><span class="hs-identifier hs-var">toLabel</span></a></span><span> </span><span class="annot"><span class="annottext">el
</span><a href="#local-6989586621679230701"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-509"></span><span>                                </span><span class="hs-special">}</span><span>
</span><span id="line-510"></span><span>    </span><span id="local-6989586621679230688"><span class="annot"><span class="annottext">ign :: IO a -&gt; IO ()
</span><a href="#local-6989586621679230688"><span class="hs-identifier hs-var hs-var">ign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO a -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-511"></span></pre></body></html>