<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MonadComprehensions, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- |
   Module      : Data.GraphViz.Algorithms
   Description : Various algorithms on Graphviz graphs.
   Copyright   : (c) Matthew Sackman, Ivan Lazar Miljenovic
   License     : 3-Clause BSD-style
   Maintainer  : Ivan.Miljenovic@gmail.com

   Defines various algorithms for use on 'DotRepr' graphs.  These are
   typically re-implementations of behaviour found in existing Graphviz
   tools but without the I/O requirement.

   Note that one way that these algorithms differ from those found in
   Graphviz is that the order of clusters is /not/ maintained, which may
   affect layout in some cases.
 -}</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.GraphViz.Algorithms</span><span>
</span><span id="line-19"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Canonicalisation Options</span></span><span>
</span><span id="line-20"></span><span>         </span><span class="annot"><span class="hs-comment">-- $options</span></span><span>
</span><span id="line-21"></span><span>         </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier">CanonicaliseOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#defaultCanonOptions"><span class="hs-identifier">defaultCanonOptions</span></a></span><span>
</span><span id="line-23"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#dotLikeOptions"><span class="hs-identifier">dotLikeOptions</span></a></span><span>
</span><span id="line-24"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Canonicalisation</span></span><span>
</span><span id="line-25"></span><span>         </span><span class="annot"><span class="hs-comment">-- $canonicalisation</span></span><span>
</span><span id="line-26"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#canonicalise"><span class="hs-identifier">canonicalise</span></a></span><span>
</span><span id="line-27"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#canonicaliseOptions"><span class="hs-identifier">canonicaliseOptions</span></a></span><span>
</span><span id="line-28"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Dealing with transitive edges</span></span><span>
</span><span id="line-29"></span><span>         </span><span class="annot"><span class="hs-comment">-- $transitive</span></span><span>
</span><span id="line-30"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#transitiveReduction"><span class="hs-identifier">transitiveReduction</span></a></span><span>
</span><span id="line-31"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#transitiveReductionOptions"><span class="hs-identifier">transitiveReductionOptions</span></a></span><span>
</span><span id="line-32"></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html"><span class="hs-identifier">Data.GraphViz.Attributes.Complete</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier">Attributes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#defaultAttributeValue"><span class="hs-identifier">defaultAttributeValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Same.html"><span class="hs-identifier">Data.GraphViz.Attributes.Same</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Internal.Util.html"><span class="hs-identifier">Data.GraphViz.Internal.Util</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Internal.Util.html#bool"><span class="hs-identifier">bool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html"><span class="hs-identifier">Data.GraphViz.Types</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html"><span class="hs-identifier">Data.GraphViz.Types.Canonical</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html"><span class="hs-identifier">Data.GraphViz.Types.Internal.Common</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html"><span class="hs-identifier">Control.Arrow</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#first"><span class="hs-identifier">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#second"><span class="hs-identifier">second</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#%2A%2A%2A"><span class="hs-operator">(***)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.html"><span class="hs-identifier">Control.Monad.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier">State</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Lazy.html#execState"><span class="hs-identifier">execState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier">gets</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier">modify</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.DList</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DList</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html"><span class="hs-identifier">Data.Function</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html#on"><span class="hs-identifier">on</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#deleteBy"><span class="hs-identifier">deleteBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#groupBy"><span class="hs-identifier">groupBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#partition"><span class="hs-identifier">partition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#sortBy"><span class="hs-identifier">sortBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>                                      </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#%5C%5C"><span class="hs-operator">(\\)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#listToMaybe"><span class="hs-identifier">listToMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><span class="hs-comment">{- $options
   For simplicity, many algorithms end up using the canonicalisation
   functions to create the new 'DotGraph'.  'CanonicaliseOptions' allows
   you to configure how the output is generated.
 -}</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="CanonicaliseOptions"><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-var">CanonicaliseOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="COpts"><span class="annot"><a href="Data.GraphViz.Algorithms.html#COpts"><span class="hs-identifier hs-var">COpts</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Place edges in the clusters</span><span>
</span><span id="line-64"></span><span>                                   </span><span class="hs-comment">--   where their nodes are rather</span><span>
</span><span id="line-65"></span><span>                                   </span><span class="hs-comment">--   than in the top-level graph.</span><span>
</span><span id="line-66"></span><span>                                   </span><span id="edgesInClusters"><span class="annot"><span class="annottext">CanonicaliseOptions -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#edgesInClusters"><span class="hs-identifier hs-var hs-var">edgesInClusters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-67"></span><span>                                   </span><span class="hs-comment">-- | Put common 'Attributes' as</span><span>
</span><span id="line-68"></span><span>                                   </span><span class="hs-comment">--   top-level 'GlobalAttributes'.</span><span>
</span><span id="line-69"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span id="groupAttributes"><span class="annot"><span class="annottext">CanonicaliseOptions -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#groupAttributes"><span class="hs-identifier hs-var hs-var">groupAttributes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-70"></span><span>                                 </span><span class="hs-special">}</span><span>
</span><span id="line-71"></span><span>                         </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225944"><span id="local-6989586621679225949"><span class="annot"><span class="annottext">CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
(CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool)
-&gt; (CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool)
-&gt; Eq CanonicaliseOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
== :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
$c/= :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
/= :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679225956"><span id="local-6989586621679225961"><span id="local-6989586621679225965"><span id="local-6989586621679225969"><span id="local-6989586621679225972"><span id="local-6989586621679225975"><span id="local-6989586621679225978"><span class="annot"><span class="annottext">Eq CanonicaliseOptions
Eq CanonicaliseOptions =&gt;
(CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Ordering)
-&gt; (CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool)
-&gt; (CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool)
-&gt; (CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool)
-&gt; (CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool)
-&gt; (CanonicaliseOptions
    -&gt; CanonicaliseOptions -&gt; CanonicaliseOptions)
-&gt; (CanonicaliseOptions
    -&gt; CanonicaliseOptions -&gt; CanonicaliseOptions)
-&gt; Ord CanonicaliseOptions
CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Ordering
CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; CanonicaliseOptions
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Ordering
compare :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Ordering
$c&lt; :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
&lt; :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
$c&lt;= :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
&lt;= :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
$c&gt; :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
&gt; :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
$c&gt;= :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
&gt;= :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; Bool
$cmax :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; CanonicaliseOptions
max :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; CanonicaliseOptions
$cmin :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; CanonicaliseOptions
min :: CanonicaliseOptions -&gt; CanonicaliseOptions -&gt; CanonicaliseOptions
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679225982"><span id="local-6989586621679225989"><span id="local-6989586621679225993"><span class="annot"><span class="annottext">Int -&gt; CanonicaliseOptions -&gt; ShowS
[CanonicaliseOptions] -&gt; ShowS
CanonicaliseOptions -&gt; String
(Int -&gt; CanonicaliseOptions -&gt; ShowS)
-&gt; (CanonicaliseOptions -&gt; String)
-&gt; ([CanonicaliseOptions] -&gt; ShowS)
-&gt; Show CanonicaliseOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; CanonicaliseOptions -&gt; ShowS
showsPrec :: Int -&gt; CanonicaliseOptions -&gt; ShowS
$cshow :: CanonicaliseOptions -&gt; String
show :: CanonicaliseOptions -&gt; String
$cshowList :: [CanonicaliseOptions] -&gt; ShowS
showList :: [CanonicaliseOptions] -&gt; ShowS
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679225997"><span id="local-6989586621679226001"><span id="local-6989586621679226004"><span id="local-6989586621679226017"><span class="annot"><span class="annottext">ReadPrec [CanonicaliseOptions]
ReadPrec CanonicaliseOptions
Int -&gt; ReadS CanonicaliseOptions
ReadS [CanonicaliseOptions]
(Int -&gt; ReadS CanonicaliseOptions)
-&gt; ReadS [CanonicaliseOptions]
-&gt; ReadPrec CanonicaliseOptions
-&gt; ReadPrec [CanonicaliseOptions]
-&gt; Read CanonicaliseOptions
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS CanonicaliseOptions
readsPrec :: Int -&gt; ReadS CanonicaliseOptions
$creadList :: ReadS [CanonicaliseOptions]
readList :: ReadS [CanonicaliseOptions]
$creadPrec :: ReadPrec CanonicaliseOptions
readPrec :: ReadPrec CanonicaliseOptions
$creadListPrec :: ReadPrec [CanonicaliseOptions]
readListPrec :: ReadPrec [CanonicaliseOptions]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#defaultCanonOptions"><span class="hs-identifier hs-type">defaultCanonOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span>
</span><span id="line-74"></span><span id="defaultCanonOptions"><span class="annot"><span class="annottext">defaultCanonOptions :: CanonicaliseOptions
</span><a href="Data.GraphViz.Algorithms.html#defaultCanonOptions"><span class="hs-identifier hs-var hs-var">defaultCanonOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#COpts"><span class="hs-identifier hs-type">COpts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">edgesInClusters :: Bool
</span><a href="Data.GraphViz.Algorithms.html#edgesInClusters"><span class="hs-identifier hs-var">edgesInClusters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-75"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">groupAttributes :: Bool
</span><a href="Data.GraphViz.Algorithms.html#groupAttributes"><span class="hs-identifier hs-var">groupAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-76"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">-- | Options that are more like how @dot -Tcanon@ works.</span></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#dotLikeOptions"><span class="hs-identifier hs-type">dotLikeOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span>
</span><span id="line-80"></span><span id="dotLikeOptions"><span class="annot"><span class="annottext">dotLikeOptions :: CanonicaliseOptions
</span><a href="Data.GraphViz.Algorithms.html#dotLikeOptions"><span class="hs-identifier hs-var hs-var">dotLikeOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#COpts"><span class="hs-identifier hs-type">COpts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">edgesInClusters :: Bool
</span><a href="Data.GraphViz.Algorithms.html#edgesInClusters"><span class="hs-identifier hs-var">edgesInClusters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-81"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">groupAttributes :: Bool
</span><a href="Data.GraphViz.Algorithms.html#groupAttributes"><span class="hs-identifier hs-var">groupAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-82"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">{- $canonicalisation

These functions implement similar functionality to @dot -Tcanon@
(i.e. creates a canonical form of any 'DotRepr' graph).  without
requiring IO.

Note that due to implementation specifics the behaviour is not
identical; in particular:

* Any specified 'Attributes' that equal the defaults are stripped out
  (unless required to override a previous attribute that doesn't apply
  here).

* Grouping of attributes (when @'groupAttributes = True'@) is much
  more conservative; only those node/edge attributes that are common to
  /all/ nodes and edges within that cluster (and within sub-clusters)
  are made global.

* Sub-graphs aren't kept, only clusters.

* 'ColorScheme' Attributes are removed (as all @Color@ values embed
  any needed color scheme anyway) as the output order of attributes may
  change (and this matters for the Haskell side of things).

In particular, note that this function will create a single explicit
definition for every node in the original graph and place it in the
appropriate position in the cluster hierarchy.  All edges are found in
the deepest cluster that contains both nodes.

-}</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><span class="hs-comment">-- | Canonicalise with some sensible defaults.</span></span><span>
</span><span id="line-118"></span><span id="local-6989586621679225621"><span id="local-6989586621679225622"><span class="annot"><a href="Data.GraphViz.Algorithms.html#canonicalise"><span class="hs-identifier hs-type">canonicalise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.html#DotRepr"><span class="hs-identifier hs-type">DotRepr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225621"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225622"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225621"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225622"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225622"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-119"></span><span id="canonicalise"><span class="annot"><span class="annottext">canonicalise :: forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#canonicalise"><span class="hs-identifier hs-var hs-var">canonicalise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions -&gt; dg n -&gt; DotGraph n
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
CanonicaliseOptions -&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#canonicaliseOptions"><span class="hs-identifier hs-var">canonicaliseOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="Data.GraphViz.Algorithms.html#defaultCanonOptions"><span class="hs-identifier hs-var">defaultCanonOptions</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><span class="hs-comment">-- | As with 'canonicalise', but allow custom 'CanonicaliseOptions'.</span></span><span>
</span><span id="line-122"></span><span id="local-6989586621679225627"><span id="local-6989586621679225628"><span class="annot"><a href="Data.GraphViz.Algorithms.html#canonicaliseOptions"><span class="hs-identifier hs-type">canonicaliseOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.html#DotRepr"><span class="hs-identifier hs-type">DotRepr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225627"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225628"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span>
</span><span id="line-123"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225627"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225628"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225628"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-124"></span><span id="canonicaliseOptions"><span class="annot"><span class="annottext">canonicaliseOptions :: forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
CanonicaliseOptions -&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#canonicaliseOptions"><span class="hs-identifier hs-var hs-var">canonicaliseOptions</span></a></span></span><span> </span><span id="local-6989586621679226029"><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226029"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679226030"><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226030"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679226031"><span class="hs-identifier hs-var">cdg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#graphIsStrict"><span class="hs-identifier hs-type">graphIsStrict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226030"><span class="hs-identifier hs-type">dg</span></a></span><span>
</span><span id="line-125"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#graphIsDirected"><span class="hs-identifier hs-type">graphIsDirected</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226030"><span class="hs-identifier hs-type">dg</span></a></span><span>
</span><span id="line-126"></span><span>                                  </span><span class="hs-special">}</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679226031"><span class="annot"><span class="annottext">cdg :: DotGraph n
</span><a href="#local-6989586621679226031"><span class="hs-identifier hs-var hs-var">cdg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
-&gt; Maybe GraphID
-&gt; GlobalAttributes
-&gt; ClusterLookup
-&gt; NodeLookup n
-&gt; [DotEdge n]
-&gt; DotGraph n
forall n.
Ord n =&gt;
CanonicaliseOptions
-&gt; Maybe GraphID
-&gt; GlobalAttributes
-&gt; ClusterLookup
-&gt; NodeLookup n
-&gt; [DotEdge n]
-&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#createCanonical"><span class="hs-identifier hs-var">createCanonical</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226029"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">dg n -&gt; Maybe GraphID
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.html#getID"><span class="hs-identifier hs-var">getID</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226030"><span class="hs-identifier hs-var">dg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GlobalAttributes
</span><a href="#local-6989586621679226043"><span class="hs-identifier hs-var">gas</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterLookup
</span><a href="#local-6989586621679226044"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">NodeLookup n
</span><a href="#local-6989586621679226045"><span class="hs-identifier hs-var">nl</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226046"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679226043"><span class="annot"><span class="annottext">GlobalAttributes
</span><a href="#local-6989586621679226043"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679226044"><span class="annot"><span class="annottext">ClusterLookup
</span><a href="#local-6989586621679226044"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dg n -&gt; (GlobalAttributes, ClusterLookup)
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
dg n -&gt; (GlobalAttributes, ClusterLookup)
</span><a href="Data.GraphViz.Types.html#graphStructureInformationClean"><span class="hs-identifier hs-var">graphStructureInformationClean</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226030"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679226045"><span class="annot"><span class="annottext">nl :: NodeLookup n
</span><a href="#local-6989586621679226045"><span class="hs-identifier hs-var hs-var">nl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; dg n -&gt; NodeLookup n
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
Bool -&gt; dg n -&gt; NodeLookup n
</span><a href="Data.GraphViz.Types.html#nodeInformationClean"><span class="hs-identifier hs-var">nodeInformationClean</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226030"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679226046"><span class="annot"><span class="annottext">es :: [DotEdge n]
</span><a href="#local-6989586621679226046"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; dg n -&gt; [DotEdge n]
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
Bool -&gt; dg n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.html#edgeInformationClean"><span class="hs-identifier hs-var">edgeInformationClean</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226030"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">type</span><span> </span><span id="NodePath"><span class="annot"><a href="Data.GraphViz.Algorithms.html#NodePath"><span class="hs-identifier hs-var">NodePath</span></a></span></span><span> </span><span id="local-6989586621679226060"><span class="annot"><a href="#local-6989586621679226060"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier hs-type">DotNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226060"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">type</span><span> </span><span id="NodePaths"><span class="annot"><a href="Data.GraphViz.Algorithms.html#NodePaths"><span class="hs-identifier hs-var">NodePaths</span></a></span></span><span> </span><span id="local-6989586621679226061"><span class="annot"><a href="#local-6989586621679226061"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#NodePath"><span class="hs-identifier hs-type">NodePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226061"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span class="hs-keyword">type</span><span> </span><span id="EdgeClusters"><span class="annot"><a href="Data.GraphViz.Algorithms.html#EdgeClusters"><span class="hs-identifier hs-var">EdgeClusters</span></a></span></span><span> </span><span id="local-6989586621679226062"><span class="annot"><a href="#local-6989586621679226062"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226062"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span class="hs-keyword">type</span><span> </span><span id="EdgeLocations"><span class="annot"><a href="Data.GraphViz.Algorithms.html#EdgeLocations"><span class="hs-identifier hs-var">EdgeLocations</span></a></span></span><span> </span><span id="local-6989586621679226063"><span class="annot"><a href="#local-6989586621679226063"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#EdgeClusters"><span class="hs-identifier hs-type">EdgeClusters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226063"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226063"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">data</span><span> </span><span id="CanonControl"><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonControl"><span class="hs-identifier hs-var">CanonControl</span></a></span></span><span> </span><span id="local-6989586621679225645"><span class="annot"><a href="#local-6989586621679225645"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CC"><span class="annot"><a href="Data.GraphViz.Algorithms.html#CC"><span class="hs-identifier hs-var">CC</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="cOpts"><span class="annot"><span class="annottext">forall n. CanonControl n -&gt; CanonicaliseOptions
</span><a href="Data.GraphViz.Algorithms.html#cOpts"><span class="hs-identifier hs-var hs-var">cOpts</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span>
</span><span id="line-140"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="isGraph"><span class="annot"><span class="annottext">forall n. CanonControl n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#isGraph"><span class="hs-identifier hs-var hs-var">isGraph</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-141"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="clusters"><span class="annot"><span class="annottext">forall n. CanonControl n -&gt; ClusterLookup
</span><a href="Data.GraphViz.Algorithms.html#clusters"><span class="hs-identifier hs-var hs-var">clusters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Types.State.html#ClusterLookup"><span class="hs-identifier hs-type">ClusterLookup</span></a></span><span>
</span><span id="line-142"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="clustEs"><span class="annot"><span class="annottext">forall n. CanonControl n -&gt; EdgeLocations n
</span><a href="Data.GraphViz.Algorithms.html#clustEs"><span class="hs-identifier hs-var hs-var">clustEs</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#EdgeLocations"><span class="hs-identifier hs-type">EdgeLocations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225645"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="topID"><span class="annot"><span class="annottext">forall n. CanonControl n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Algorithms.html#topID"><span class="hs-identifier hs-var hs-var">topID</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="topAttrs"><span class="annot"><span class="annottext">forall n. CanonControl n -&gt; Attributes
</span><a href="Data.GraphViz.Algorithms.html#topAttrs"><span class="hs-identifier hs-var hs-var">topAttrs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span>
</span><span id="line-145"></span><span>                         </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621679225638"><span class="annot"><a href="Data.GraphViz.Algorithms.html#createCanonical"><span class="hs-identifier hs-type">createCanonical</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225638"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GraphID"><span class="hs-identifier hs-type">GraphID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span>
</span><span id="line-148"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.State.html#ClusterLookup"><span class="hs-identifier hs-type">ClusterLookup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.State.html#NodeLookup"><span class="hs-identifier hs-type">NodeLookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225638"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225638"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225638"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-149"></span><span id="createCanonical"><span class="annot"><span class="annottext">createCanonical :: forall n.
Ord n =&gt;
CanonicaliseOptions
-&gt; Maybe GraphID
-&gt; GlobalAttributes
-&gt; ClusterLookup
-&gt; NodeLookup n
-&gt; [DotEdge n]
-&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#createCanonical"><span class="hs-identifier hs-var hs-var">createCanonical</span></a></span></span><span> </span><span id="local-6989586621679226073"><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226073"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679226074"><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679226074"><span class="hs-identifier hs-var">gid</span></a></span></span><span> </span><span id="local-6989586621679226075"><span class="annot"><span class="annottext">GlobalAttributes
</span><a href="#local-6989586621679226075"><span class="hs-identifier hs-var">gas</span></a></span></span><span> </span><span id="local-6989586621679226076"><span class="annot"><span class="annottext">ClusterLookup
</span><a href="#local-6989586621679226076"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span id="local-6989586621679226077"><span class="annot"><span class="annottext">NodeLookup n
</span><a href="#local-6989586621679226077"><span class="hs-identifier hs-var">nl</span></a></span></span><span> </span><span id="local-6989586621679226078"><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226078"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotSubGraph n -&gt; DotGraph n
forall n. DotSubGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#promoteDSG"><span class="hs-identifier hs-var">promoteDSG</span></a></span><span> </span><span class="annot"><span class="annottext">(DotSubGraph n -&gt; DotGraph n) -&gt; DotSubGraph n -&gt; DotGraph n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n -&gt; NodePaths n -&gt; DotSubGraph n
forall n. CanonControl n -&gt; NodePaths n -&gt; DotSubGraph n
</span><a href="Data.GraphViz.Algorithms.html#makeGrouping"><span class="hs-identifier hs-var">makeGrouping</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226081"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">NodePaths n
</span><a href="#local-6989586621679226082"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679226085"><span class="annot"><span class="annottext">nUnlook :: (n, (t a, Attributes)) -&gt; ([a], DotNode n)
</span><a href="#local-6989586621679226085"><span class="hs-identifier hs-var hs-var">nUnlook</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679226086"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226086"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679226087"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679226087"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679226088"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226088"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; [a]
forall a. t a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679226087"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">n -&gt; Attributes -&gt; DotNode n
forall n. n -&gt; Attributes -&gt; DotNode n
</span><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier hs-var">DotNode</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226086"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226088"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-comment">-- DotNodes paired and sorted by their paths</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679226082"><span class="annot"><span class="annottext">ns :: NodePaths n
</span><a href="#local-6989586621679226082"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Maybe GraphID], DotNode n)
 -&gt; ([Maybe GraphID], DotNode n) -&gt; Ordering)
-&gt; NodePaths n -&gt; NodePaths n
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe GraphID] -&gt; [Maybe GraphID] -&gt; Ordering
forall a. Ord a =&gt; [a] -&gt; [a] -&gt; Ordering
</span><a href="Data.GraphViz.Algorithms.html#compLists"><span class="hs-identifier hs-var">compLists</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; [Maybe GraphID] -&gt; Ordering)
-&gt; (([Maybe GraphID], DotNode n) -&gt; [Maybe GraphID])
-&gt; ([Maybe GraphID], DotNode n)
-&gt; ([Maybe GraphID], DotNode n)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html#on"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID], DotNode n) -&gt; [Maybe GraphID]
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NodePaths n -&gt; NodePaths n)
-&gt; ([(n, (Seq (Maybe GraphID), Attributes))] -&gt; NodePaths n)
-&gt; [(n, (Seq (Maybe GraphID), Attributes))]
-&gt; NodePaths n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((n, (Seq (Maybe GraphID), Attributes))
 -&gt; ([Maybe GraphID], DotNode n))
-&gt; [(n, (Seq (Maybe GraphID), Attributes))] -&gt; NodePaths n
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(n, (Seq (Maybe GraphID), Attributes))
-&gt; ([Maybe GraphID], DotNode n)
forall {t :: * -&gt; *} {n} {a}.
Foldable t =&gt;
(n, (t a, Attributes)) -&gt; ([a], DotNode n)
</span><a href="#local-6989586621679226085"><span class="hs-identifier hs-var">nUnlook</span></a></span><span> </span><span class="annot"><span class="annottext">([(n, (Seq (Maybe GraphID), Attributes))] -&gt; NodePaths n)
-&gt; [(n, (Seq (Maybe GraphID), Attributes))] -&gt; NodePaths n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NodeLookup n -&gt; [(n, (Seq (Maybe GraphID), Attributes))]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NodeLookup n
</span><a href="#local-6989586621679226077"><span class="hs-identifier hs-var">nl</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679226103"><span class="annot"><span class="annottext">es' :: EdgeLocations n
</span><a href="#local-6989586621679226103"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#edgesInClusters"><span class="hs-identifier hs-var">edgesInClusters</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226073"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-156"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NodeLookup n -&gt; [DotEdge n] -&gt; EdgeLocations n
forall n. Ord n =&gt; NodeLookup n -&gt; [DotEdge n] -&gt; EdgeLocations n
</span><a href="Data.GraphViz.Algorithms.html#edgeClusters"><span class="hs-identifier hs-var">edgeClusters</span></a></span><span> </span><span class="annot"><span class="annottext">NodeLookup n
</span><a href="#local-6989586621679226077"><span class="hs-identifier hs-var">nl</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226078"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-157"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Maybe GraphID) [DotEdge n]
forall k a. Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226078"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679226081"><span class="annot"><span class="annottext">cc :: CanonControl n
</span><a href="#local-6989586621679226081"><span class="hs-identifier hs-var hs-var">cc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cOpts :: CanonicaliseOptions
</span><a href="Data.GraphViz.Algorithms.html#cOpts"><span class="hs-identifier hs-var">cOpts</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226073"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-160"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isGraph :: Bool
</span><a href="Data.GraphViz.Algorithms.html#isGraph"><span class="hs-identifier hs-var">isGraph</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clusters :: ClusterLookup
</span><a href="Data.GraphViz.Algorithms.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClusterLookup
</span><a href="#local-6989586621679226076"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-162"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clustEs :: EdgeLocations n
</span><a href="Data.GraphViz.Algorithms.html#clustEs"><span class="hs-identifier hs-var">clustEs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EdgeLocations n
</span><a href="#local-6989586621679226103"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-163"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">topID :: Maybe GraphID
</span><a href="Data.GraphViz.Algorithms.html#topID"><span class="hs-identifier hs-var">topID</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679226074"><span class="hs-identifier hs-var">gid</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">topAttrs :: Attributes
</span><a href="Data.GraphViz.Algorithms.html#topAttrs"><span class="hs-identifier hs-var">topAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalAttributes -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#attrs"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalAttributes
</span><a href="#local-6989586621679226075"><span class="hs-identifier hs-var">gas</span></a></span><span>
</span><span id="line-165"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span id="local-6989586621679225690"><span class="annot"><a href="Data.GraphViz.Algorithms.html#thisLevel"><span class="hs-identifier hs-type">thisLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#NodePaths"><span class="hs-identifier hs-type">NodePaths</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225690"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#NodePaths"><span class="hs-identifier hs-type">NodePaths</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225690"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotNode"><span class="hs-identifier hs-type">DotNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225690"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-168"></span><span id="thisLevel"><span class="annot"><span class="annottext">thisLevel :: forall n. NodePaths n -&gt; (NodePaths n, [DotNode n])
</span><a href="Data.GraphViz.Algorithms.html#thisLevel"><span class="hs-identifier hs-var hs-var">thisLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([([Maybe GraphID], DotNode n)] -&gt; [DotNode n])
-&gt; ([([Maybe GraphID], DotNode n)], [([Maybe GraphID], DotNode n)])
-&gt; ([([Maybe GraphID], DotNode n)], [DotNode n])
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([Maybe GraphID], DotNode n) -&gt; DotNode n)
-&gt; [([Maybe GraphID], DotNode n)] -&gt; [DotNode n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID], DotNode n) -&gt; DotNode n
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([([Maybe GraphID], DotNode n)], [([Maybe GraphID], DotNode n)])
 -&gt; ([([Maybe GraphID], DotNode n)], [DotNode n]))
-&gt; ([([Maybe GraphID], DotNode n)]
    -&gt; ([([Maybe GraphID], DotNode n)],
        [([Maybe GraphID], DotNode n)]))
-&gt; [([Maybe GraphID], DotNode n)]
-&gt; ([([Maybe GraphID], DotNode n)], [DotNode n])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(([Maybe GraphID], DotNode n) -&gt; Bool)
-&gt; [([Maybe GraphID], DotNode n)]
-&gt; ([([Maybe GraphID], DotNode n)], [([Maybe GraphID], DotNode n)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (([Maybe GraphID], DotNode n) -&gt; Bool)
-&gt; ([Maybe GraphID], DotNode n)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe GraphID] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; Bool)
-&gt; (([Maybe GraphID], DotNode n) -&gt; [Maybe GraphID])
-&gt; ([Maybe GraphID], DotNode n)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID], DotNode n) -&gt; [Maybe GraphID]
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621679225662"><span class="annot"><a href="Data.GraphViz.Algorithms.html#makeGrouping"><span class="hs-identifier hs-type">makeGrouping</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonControl"><span class="hs-identifier hs-type">CanonControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225662"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#NodePaths"><span class="hs-identifier hs-type">NodePaths</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225662"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotSubGraph"><span class="hs-identifier hs-type">DotSubGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225662"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-171"></span><span id="makeGrouping"><span class="annot"><span class="annottext">makeGrouping :: forall n. CanonControl n -&gt; NodePaths n -&gt; DotSubGraph n
</span><a href="Data.GraphViz.Algorithms.html#makeGrouping"><span class="hs-identifier hs-var hs-var">makeGrouping</span></a></span></span><span> </span><span id="local-6989586621679226115"><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679226116"><span class="annot"><span class="annottext">NodePaths n
</span><a href="#local-6989586621679226116"><span class="hs-identifier hs-var">cns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotSG"><span class="hs-identifier hs-type">DotSG</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">isCluster :: Bool
</span><a href="Data.GraphViz.Types.Canonical.html#isCluster"><span class="hs-identifier hs-var">isCluster</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-172"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">subGraphID :: Maybe GraphID
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphID"><span class="hs-identifier hs-var">subGraphID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679226120"><span class="hs-identifier hs-var">cID</span></a></span><span>
</span><span id="line-173"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">subGraphStmts :: DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphStmts"><span class="hs-identifier hs-var">subGraphStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226122"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-174"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679226120"><span class="annot"><span class="annottext">cID :: Maybe GraphID
</span><a href="#local-6989586621679226120"><span class="hs-identifier hs-var hs-var">cID</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CanonControl n -&gt; Bool
forall n. CanonControl n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#isGraph"><span class="hs-identifier hs-var">isGraph</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonControl n -&gt; Maybe GraphID
forall n. CanonControl n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Algorithms.html#topID"><span class="hs-identifier hs-var">topID</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe GraphID] -&gt; Maybe GraphID
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; Maybe GraphID)
-&gt; (NodePaths n -&gt; [Maybe GraphID]) -&gt; NodePaths n -&gt; Maybe GraphID
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID], DotNode n) -&gt; [Maybe GraphID]
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(([Maybe GraphID], DotNode n) -&gt; [Maybe GraphID])
-&gt; (NodePaths n -&gt; ([Maybe GraphID], DotNode n))
-&gt; NodePaths n
-&gt; [Maybe GraphID]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NodePaths n -&gt; ([Maybe GraphID], DotNode n)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">(NodePaths n -&gt; Maybe GraphID) -&gt; NodePaths n -&gt; Maybe GraphID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NodePaths n
</span><a href="#local-6989586621679226116"><span class="hs-identifier hs-var">cns</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679226131"><span class="annot"><span class="annottext">NodePaths n
</span><a href="#local-6989586621679226131"><span class="hs-identifier hs-var">nestedNs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679226132"><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679226132"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodePaths n -&gt; (NodePaths n, [DotNode n])
forall n. NodePaths n -&gt; (NodePaths n, [DotNode n])
</span><a href="Data.GraphViz.Algorithms.html#thisLevel"><span class="hs-identifier hs-var">thisLevel</span></a></span><span>
</span><span id="line-180"></span><span>                     </span><span class="annot"><span class="annottext">(NodePaths n -&gt; (NodePaths n, [DotNode n]))
-&gt; (NodePaths n -&gt; NodePaths n)
-&gt; NodePaths n
-&gt; (NodePaths n, [DotNode n])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodePaths n -&gt; NodePaths n)
-&gt; (NodePaths n -&gt; NodePaths n)
-&gt; Bool
-&gt; NodePaths n
-&gt; NodePaths n
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="Data.GraphViz.Internal.Util.html#bool"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([Maybe GraphID], DotNode n) -&gt; ([Maybe GraphID], DotNode n))
-&gt; NodePaths n -&gt; NodePaths n
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">((([Maybe GraphID], DotNode n) -&gt; ([Maybe GraphID], DotNode n))
 -&gt; NodePaths n -&gt; NodePaths n)
-&gt; (([Maybe GraphID], DotNode n) -&gt; ([Maybe GraphID], DotNode n))
-&gt; NodePaths n
-&gt; NodePaths n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; [Maybe GraphID])
-&gt; ([Maybe GraphID], DotNode n) -&gt; ([Maybe GraphID], DotNode n)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe GraphID] -&gt; [Maybe GraphID]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#tail"><span class="hs-identifier hs-var">tail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NodePaths n -&gt; NodePaths n
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanonControl n -&gt; Bool
forall n. CanonControl n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#isGraph"><span class="hs-identifier hs-var">isGraph</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>                     </span><span class="annot"><span class="annottext">(NodePaths n -&gt; (NodePaths n, [DotNode n]))
-&gt; NodePaths n -&gt; (NodePaths n, [DotNode n])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NodePaths n
</span><a href="#local-6989586621679226116"><span class="hs-identifier hs-var">cns</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679226137"><span class="annot"><span class="annottext">es :: [DotEdge n]
</span><a href="#local-6989586621679226137"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Map (Maybe GraphID) [DotEdge n], [DotEdge n]) -&gt; [DotEdge n])
-&gt; ((Map (Maybe GraphID) [DotEdge n], [DotEdge n]) -&gt; [DotEdge n])
-&gt; Bool
-&gt; (Map (Maybe GraphID) [DotEdge n], [DotEdge n])
-&gt; [DotEdge n]
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><a href="Data.GraphViz.Internal.Util.html#bool"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DotEdge n] -&gt; Maybe [DotEdge n] -&gt; [DotEdge n]
forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [DotEdge n] -&gt; [DotEdge n])
-&gt; ((Map (Maybe GraphID) [DotEdge n], [DotEdge n])
    -&gt; Maybe [DotEdge n])
-&gt; (Map (Maybe GraphID) [DotEdge n], [DotEdge n])
-&gt; [DotEdge n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
-&gt; Map (Maybe GraphID) [DotEdge n] -&gt; Maybe [DotEdge n]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679226120"><span class="hs-identifier hs-var">cID</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Maybe GraphID) [DotEdge n] -&gt; Maybe [DotEdge n])
-&gt; ((Map (Maybe GraphID) [DotEdge n], [DotEdge n])
    -&gt; Map (Maybe GraphID) [DotEdge n])
-&gt; (Map (Maybe GraphID) [DotEdge n], [DotEdge n])
-&gt; Maybe [DotEdge n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Maybe GraphID) [DotEdge n], [DotEdge n])
-&gt; Map (Maybe GraphID) [DotEdge n]
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map (Maybe GraphID) [DotEdge n], [DotEdge n]) -&gt; [DotEdge n]
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanonControl n -&gt; Bool
forall n. CanonControl n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#isGraph"><span class="hs-identifier hs-var">isGraph</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>         </span><span class="annot"><span class="annottext">((Map (Maybe GraphID) [DotEdge n], [DotEdge n]) -&gt; [DotEdge n])
-&gt; (Map (Maybe GraphID) [DotEdge n], [DotEdge n]) -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n -&gt; (Map (Maybe GraphID) [DotEdge n], [DotEdge n])
forall n. CanonControl n -&gt; EdgeLocations n
</span><a href="Data.GraphViz.Algorithms.html#clustEs"><span class="hs-identifier hs-var">clustEs</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679226141"><span class="annot"><span class="annottext">gas :: Attributes
</span><a href="#local-6989586621679226141"><span class="hs-identifier hs-var hs-var">gas</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CanonControl n -&gt; Bool
forall n. CanonControl n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#isGraph"><span class="hs-identifier hs-var">isGraph</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonControl n -&gt; Attributes
forall n. CanonControl n -&gt; Attributes
</span><a href="Data.GraphViz.Algorithms.html#topAttrs"><span class="hs-identifier hs-var">topAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalAttributes -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#attrs"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobalAttributes -&gt; Attributes)
-&gt; (([Seq (Maybe GraphID)], GlobalAttributes) -&gt; GlobalAttributes)
-&gt; ([Seq (Maybe GraphID)], GlobalAttributes)
-&gt; Attributes
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([Seq (Maybe GraphID)], GlobalAttributes) -&gt; GlobalAttributes
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(([Seq (Maybe GraphID)], GlobalAttributes) -&gt; Attributes)
-&gt; ([Seq (Maybe GraphID)], GlobalAttributes) -&gt; Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n -&gt; ClusterLookup
forall n. CanonControl n -&gt; ClusterLookup
</span><a href="Data.GraphViz.Algorithms.html#clusters"><span class="hs-identifier hs-var">clusters</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterLookup
-&gt; Maybe GraphID -&gt; ([Seq (Maybe GraphID)], GlobalAttributes)
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID
</span><a href="#local-6989586621679226120"><span class="hs-identifier hs-var">cID</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679226148"><span class="annot"><span class="annottext">subGs :: [DotSubGraph n]
</span><a href="#local-6989586621679226148"><span class="hs-identifier hs-var hs-var">subGs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodePaths n -&gt; DotSubGraph n) -&gt; [NodePaths n] -&gt; [DotSubGraph n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanonControl n -&gt; NodePaths n -&gt; DotSubGraph n
forall n. CanonControl n -&gt; NodePaths n -&gt; DotSubGraph n
</span><a href="Data.GraphViz.Algorithms.html#makeGrouping"><span class="hs-identifier hs-var">makeGrouping</span></a></span><span> </span><span class="annot"><span class="annottext">(CanonControl n -&gt; NodePaths n -&gt; DotSubGraph n)
-&gt; CanonControl n -&gt; NodePaths n -&gt; DotSubGraph n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#isGraph"><span class="hs-identifier hs-var">isGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-type">False</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>            </span><span class="annot"><span class="annottext">([NodePaths n] -&gt; [DotSubGraph n])
-&gt; (NodePaths n -&gt; [NodePaths n]) -&gt; NodePaths n -&gt; [DotSubGraph n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(([Maybe GraphID], DotNode n)
 -&gt; ([Maybe GraphID], DotNode n) -&gt; Bool)
-&gt; NodePaths n -&gt; [NodePaths n]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Maybe GraphID) -&gt; Maybe (Maybe GraphID) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Maybe GraphID) -&gt; Maybe (Maybe GraphID) -&gt; Bool)
-&gt; (([Maybe GraphID], DotNode n) -&gt; Maybe (Maybe GraphID))
-&gt; ([Maybe GraphID], DotNode n)
-&gt; ([Maybe GraphID], DotNode n)
-&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html#on"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe GraphID] -&gt; Maybe (Maybe GraphID)
forall a. [a] -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; Maybe (Maybe GraphID))
-&gt; (([Maybe GraphID], DotNode n) -&gt; [Maybe GraphID])
-&gt; ([Maybe GraphID], DotNode n)
-&gt; Maybe (Maybe GraphID)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID], DotNode n) -&gt; [Maybe GraphID]
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>            </span><span class="annot"><span class="annottext">(NodePaths n -&gt; [DotSubGraph n]) -&gt; NodePaths n -&gt; [DotSubGraph n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NodePaths n
</span><a href="#local-6989586621679226131"><span class="hs-identifier hs-var">nestedNs</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679226122"><span class="annot"><span class="annottext">stmts :: DotStatements n
</span><a href="#local-6989586621679226122"><span class="hs-identifier hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
-&gt; Attributes -&gt; DotStatements n -&gt; DotStatements n
forall n.
CanonicaliseOptions
-&gt; Attributes -&gt; DotStatements n -&gt; DotStatements n
</span><a href="Data.GraphViz.Algorithms.html#setGlobal"><span class="hs-identifier hs-var">setGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanonControl n -&gt; CanonicaliseOptions
forall n. CanonControl n -&gt; CanonicaliseOptions
</span><a href="Data.GraphViz.Algorithms.html#cOpts"><span class="hs-identifier hs-var">cOpts</span></a></span><span> </span><span class="annot"><span class="annottext">CanonControl n
</span><a href="#local-6989586621679226115"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226141"><span class="hs-identifier hs-var">gas</span></a></span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><span class="annottext">(DotStatements n -&gt; DotStatements n)
-&gt; DotStatements n -&gt; DotStatements n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStmts"><span class="hs-identifier hs-type">DotStmts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">attrStmts :: [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Canonical.html#attrStmts"><span class="hs-identifier hs-var">attrStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">subGraphs :: [DotSubGraph n]
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphs"><span class="hs-identifier hs-var">subGraphs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotSubGraph n]
</span><a href="#local-6989586621679226148"><span class="hs-identifier hs-var">subGs</span></a></span><span>
</span><span id="line-196"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nodeStmts :: [DotNode n]
</span><a href="Data.GraphViz.Types.Canonical.html#nodeStmts"><span class="hs-identifier hs-var">nodeStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679226132"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-197"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgeStmts :: [DotEdge n]
</span><a href="Data.GraphViz.Types.Canonical.html#edgeStmts"><span class="hs-identifier hs-var">edgeStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226137"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-198"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621679225720"><span class="annot"><a href="Data.GraphViz.Algorithms.html#setGlobal"><span class="hs-identifier hs-type">setGlobal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span>
</span><span id="line-201"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span> </span><span class="hs-comment">-- Specified cluster attributes</span><span>
</span><span id="line-202"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier hs-type">DotStatements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225720"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-203"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier hs-type">DotStatements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225720"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-204"></span><span id="setGlobal"><span class="annot"><span class="annottext">setGlobal :: forall n.
CanonicaliseOptions
-&gt; Attributes -&gt; DotStatements n -&gt; DotStatements n
</span><a href="Data.GraphViz.Algorithms.html#setGlobal"><span class="hs-identifier hs-var hs-var">setGlobal</span></a></span></span><span> </span><span id="local-6989586621679226155"><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226155"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679226156"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226156"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679226157"><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226157"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226157"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#attrStmts"><span class="hs-identifier hs-var">attrStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679226158"><span class="hs-identifier hs-type">globs'</span></a></span><span>
</span><span id="line-205"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#subGraphs"><span class="hs-identifier hs-var">subGraphs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679226159"><span class="hs-identifier hs-type">sgs'</span></a></span><span>
</span><span id="line-206"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#nodeStmts"><span class="hs-identifier hs-var">nodeStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679226160"><span class="hs-identifier hs-type">ns'</span></a></span><span>
</span><span id="line-207"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#edgeStmts"><span class="hs-identifier hs-var">edgeStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679226161"><span class="hs-identifier hs-type">es'</span></a></span><span>
</span><span id="line-208"></span><span>                                </span><span class="hs-special">}</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621679226162"><span class="annot"><span class="annottext">sgs :: [DotSubGraph n]
</span><a href="#local-6989586621679226162"><span class="hs-identifier hs-var hs-var">sgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotSubGraph n]
forall n. DotStatements n -&gt; [DotSubGraph n]
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphs"><span class="hs-identifier hs-var">subGraphs</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226157"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679226163"><span class="annot"><span class="annottext">sStmts :: [DotStatements n]
</span><a href="#local-6989586621679226163"><span class="hs-identifier hs-var hs-var">sStmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotSubGraph n -&gt; DotStatements n)
-&gt; [DotSubGraph n] -&gt; [DotStatements n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">DotSubGraph n -&gt; DotStatements n
forall n. DotSubGraph n -&gt; DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphStmts"><span class="hs-identifier hs-var">subGraphStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[DotSubGraph n]
</span><a href="#local-6989586621679226162"><span class="hs-identifier hs-var">sgs</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621679226164"><span class="annot"><span class="annottext">ns :: [DotNode n]
</span><a href="#local-6989586621679226164"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotNode n]
forall n. DotStatements n -&gt; [DotNode n]
</span><a href="Data.GraphViz.Types.Canonical.html#nodeStmts"><span class="hs-identifier hs-var">nodeStmts</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226157"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679226165"><span class="annot"><span class="annottext">es :: [DotEdge n]
</span><a href="#local-6989586621679226165"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotEdge n]
forall n. DotStatements n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Canonical.html#edgeStmts"><span class="hs-identifier hs-var">edgeStmts</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226157"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679226166"><span class="annot"><span class="annottext">sGlobs :: [(Attributes, Attributes, Attributes)]
</span><a href="#local-6989586621679226166"><span class="hs-identifier hs-var hs-var">sGlobs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotStatements n -&gt; (Attributes, Attributes, Attributes))
-&gt; [DotStatements n] -&gt; [(Attributes, Attributes, Attributes)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GlobalAttributes] -&gt; (Attributes, Attributes, Attributes)
</span><a href="Data.GraphViz.Types.Internal.Common.html#partitionGlobal"><span class="hs-identifier hs-var">partitionGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">([GlobalAttributes] -&gt; (Attributes, Attributes, Attributes))
-&gt; (DotStatements n -&gt; [GlobalAttributes])
-&gt; DotStatements n
-&gt; (Attributes, Attributes, Attributes)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [GlobalAttributes]
forall n. DotStatements n -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Types.Canonical.html#attrStmts"><span class="hs-identifier hs-var">attrStmts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DotStatements n]
</span><a href="#local-6989586621679226163"><span class="hs-identifier hs-var">sStmts</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679226168"><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226168"><span class="hs-identifier hs-var">sgas</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679226169"><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226169"><span class="hs-identifier hs-var">snas</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679226170"><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226170"><span class="hs-identifier hs-var">seas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Attributes, Attributes, Attributes)]
-&gt; ([Attributes], [Attributes], [Attributes])
forall a b c. [(a, b, c)] -&gt; ([a], [b], [c])
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#unzip3"><span class="hs-identifier hs-var">unzip3</span></a></span><span> </span><span class="annot"><span class="annottext">[(Attributes, Attributes, Attributes)]
</span><a href="#local-6989586621679226166"><span class="hs-identifier hs-var">sGlobs</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679226172"><span class="annot"><span class="annottext">gas' :: Attributes
</span><a href="#local-6989586621679226172"><span class="hs-identifier hs-var hs-var">gas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226156"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-comment">-- Can't change graph attrs! Need these!</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679226173"><span class="annot"><span class="annottext">nas' :: Attributes
</span><a href="#local-6989586621679226173"><span class="hs-identifier hs-var hs-var">nas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
-&gt; (DotStatements n -&gt; [DotNode n])
-&gt; [Attributes]
-&gt; [DotStatements n]
-&gt; [Attributes]
-&gt; Attributes
forall n a.
CanonicaliseOptions
-&gt; (DotStatements n -&gt; [a])
-&gt; [Attributes]
-&gt; [DotStatements n]
-&gt; [Attributes]
-&gt; Attributes
</span><a href="Data.GraphViz.Algorithms.html#getCommonGlobs"><span class="hs-identifier hs-var">getCommonGlobs</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226155"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotNode n]
forall n. DotStatements n -&gt; [DotNode n]
</span><a href="Data.GraphViz.Types.Canonical.html#nodeStmts"><span class="hs-identifier hs-var">nodeStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226169"><span class="hs-identifier hs-var">snas</span></a></span><span> </span><span class="annot"><span class="annottext">[DotStatements n]
</span><a href="#local-6989586621679226163"><span class="hs-identifier hs-var">sStmts</span></a></span><span> </span><span class="annot"><span class="annottext">([Attributes] -&gt; Attributes) -&gt; [Attributes] -&gt; Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DotNode n -&gt; Attributes) -&gt; [DotNode n] -&gt; [Attributes]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">DotNode n -&gt; Attributes
forall n. DotNode n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#nodeAttributes"><span class="hs-identifier hs-var">nodeAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679226164"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679226176"><span class="annot"><span class="annottext">eas' :: Attributes
</span><a href="#local-6989586621679226176"><span class="hs-identifier hs-var hs-var">eas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
-&gt; (DotStatements n -&gt; [DotEdge n])
-&gt; [Attributes]
-&gt; [DotStatements n]
-&gt; [Attributes]
-&gt; Attributes
forall n a.
CanonicaliseOptions
-&gt; (DotStatements n -&gt; [a])
-&gt; [Attributes]
-&gt; [DotStatements n]
-&gt; [Attributes]
-&gt; Attributes
</span><a href="Data.GraphViz.Algorithms.html#getCommonGlobs"><span class="hs-identifier hs-var">getCommonGlobs</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226155"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotEdge n]
forall n. DotStatements n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.Canonical.html#edgeStmts"><span class="hs-identifier hs-var">edgeStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226170"><span class="hs-identifier hs-var">seas</span></a></span><span> </span><span class="annot"><span class="annottext">[DotStatements n]
</span><a href="#local-6989586621679226163"><span class="hs-identifier hs-var">sStmts</span></a></span><span> </span><span class="annot"><span class="annottext">([Attributes] -&gt; Attributes) -&gt; [Attributes] -&gt; Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DotEdge n -&gt; Attributes) -&gt; [DotEdge n] -&gt; [Attributes]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; Attributes
forall n. DotEdge n -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#edgeAttributes"><span class="hs-identifier hs-var">edgeAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226165"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>    </span><span id="local-6989586621679226158"><span class="annot"><span class="annottext">globs' :: [GlobalAttributes]
</span><a href="#local-6989586621679226158"><span class="hs-identifier hs-var hs-var">globs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalAttributes] -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Algorithms.html#nonEmptyGAs"><span class="hs-identifier hs-var">nonEmptyGAs</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; GlobalAttributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#GraphAttrs"><span class="hs-identifier hs-var">GraphAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226172"><span class="hs-identifier hs-var">gas'</span></a></span><span>
</span><span id="line-224"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; GlobalAttributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#NodeAttrs"><span class="hs-identifier hs-var">NodeAttrs</span></a></span><span>  </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226173"><span class="hs-identifier hs-var">nas'</span></a></span><span>
</span><span id="line-225"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; GlobalAttributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#EdgeAttrs"><span class="hs-identifier hs-var">EdgeAttrs</span></a></span><span>  </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226176"><span class="hs-identifier hs-var">eas'</span></a></span><span>
</span><span id="line-226"></span><span>                         </span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679226160"><span class="annot"><span class="annottext">ns' :: [DotNode n]
</span><a href="#local-6989586621679226160"><span class="hs-identifier hs-var hs-var">ns'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotNode n -&gt; DotNode n) -&gt; [DotNode n] -&gt; [DotNode n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679226183"><span class="annot"><span class="annottext">DotNode n
</span><a href="#local-6989586621679226183"><span class="hs-identifier hs-var">dn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DotNode n
</span><a href="#local-6989586621679226183"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#nodeAttributes"><span class="hs-identifier hs-var">nodeAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#nodeAttributes"><span class="hs-identifier hs-var">nodeAttributes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226183"><span class="hs-identifier hs-type">dn</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#%5C%5C"><span class="hs-operator hs-type">\\</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226173"><span class="hs-identifier hs-type">nas'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DotNode n]
</span><a href="#local-6989586621679226164"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679226161"><span class="annot"><span class="annottext">es' :: [DotEdge n]
</span><a href="#local-6989586621679226161"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotEdge n -&gt; DotEdge n) -&gt; [DotEdge n] -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679226185"><span class="annot"><span class="annottext">DotEdge n
</span><a href="#local-6989586621679226185"><span class="hs-identifier hs-var">de</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DotEdge n
</span><a href="#local-6989586621679226185"><span class="hs-identifier hs-var">de</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#edgeAttributes"><span class="hs-identifier hs-var">edgeAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#edgeAttributes"><span class="hs-identifier hs-var">edgeAttributes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226185"><span class="hs-identifier hs-type">de</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#%5C%5C"><span class="hs-operator hs-type">\\</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226176"><span class="hs-identifier hs-type">eas'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226165"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679226186"><span class="annot"><span class="annottext">sgas' :: [Attributes]
</span><a href="#local-6989586621679226186"><span class="hs-identifier hs-var hs-var">sgas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; [Attributes] -&gt; [Attributes]
</span><a href="Data.GraphViz.Algorithms.html#updateGraphGlobs"><span class="hs-identifier hs-var">updateGraphGlobs</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226172"><span class="hs-identifier hs-var">gas'</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226168"><span class="hs-identifier hs-var">sgas</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679226189"><span class="annot"><span class="annottext">snas' :: [Attributes]
</span><a href="#local-6989586621679226189"><span class="hs-identifier hs-var hs-var">snas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; Attributes) -&gt; [Attributes] -&gt; [Attributes]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; Attributes -&gt; Attributes
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226173"><span class="hs-identifier hs-var">nas'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226169"><span class="hs-identifier hs-var">snas</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679226191"><span class="annot"><span class="annottext">seas' :: [Attributes]
</span><a href="#local-6989586621679226191"><span class="hs-identifier hs-var hs-var">seas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; Attributes) -&gt; [Attributes] -&gt; [Attributes]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attributes -&gt; Attributes -&gt; Attributes
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226176"><span class="hs-identifier hs-var">eas'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226170"><span class="hs-identifier hs-var">seas</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679226192"><span class="annot"><span class="annottext">sGlobs' :: [(Attributes, Attributes, Attributes)]
</span><a href="#local-6989586621679226192"><span class="hs-identifier hs-var hs-var">sGlobs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attributes]
-&gt; [Attributes]
-&gt; [Attributes]
-&gt; [(Attributes, Attributes, Attributes)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226186"><span class="hs-identifier hs-var">sgas'</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226189"><span class="hs-identifier hs-var">snas'</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226191"><span class="hs-identifier hs-var">seas'</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679226194"><span class="annot"><span class="annottext">sStmts' :: [DotStatements n]
</span><a href="#local-6989586621679226194"><span class="hs-identifier hs-var hs-var">sStmts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotStatements n
 -&gt; (Attributes, Attributes, Attributes) -&gt; DotStatements n)
-&gt; [DotStatements n]
-&gt; [(Attributes, Attributes, Attributes)]
-&gt; [DotStatements n]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679226196"><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226196"><span class="hs-identifier hs-var">sSt</span></a></span></span><span> </span><span id="local-6989586621679226197"><span class="annot"><span class="annottext">(Attributes, Attributes, Attributes)
</span><a href="#local-6989586621679226197"><span class="hs-identifier hs-var">sGl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226196"><span class="hs-identifier hs-var">sSt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#attrStmts"><span class="hs-identifier hs-var">attrStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#nonEmptyGAs"><span class="hs-identifier hs-type">nonEmptyGAs</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#unPartitionGlobal"><span class="hs-identifier hs-type">unPartitionGlobal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226197"><span class="hs-identifier hs-type">sGl</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                      </span><span class="annot"><span class="annottext">[DotStatements n]
</span><a href="#local-6989586621679226163"><span class="hs-identifier hs-var">sStmts</span></a></span><span>
</span><span id="line-237"></span><span>                      </span><span class="annot"><span class="annottext">[(Attributes, Attributes, Attributes)]
</span><a href="#local-6989586621679226192"><span class="hs-identifier hs-var">sGlobs'</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>    </span><span id="local-6989586621679226159"><span class="annot"><span class="annottext">sgs' :: [DotSubGraph n]
</span><a href="#local-6989586621679226159"><span class="hs-identifier hs-var hs-var">sgs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotSubGraph n -&gt; DotStatements n -&gt; DotSubGraph n)
-&gt; [DotSubGraph n] -&gt; [DotStatements n] -&gt; [DotSubGraph n]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679226199"><span class="annot"><span class="annottext">DotSubGraph n
</span><a href="#local-6989586621679226199"><span class="hs-identifier hs-var">sg</span></a></span></span><span> </span><span id="local-6989586621679226200"><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226200"><span class="hs-identifier hs-var">sSt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DotSubGraph n
</span><a href="#local-6989586621679226199"><span class="hs-identifier hs-var">sg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#subGraphStmts"><span class="hs-identifier hs-var">subGraphStmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679226200"><span class="hs-identifier hs-type">sSt</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DotSubGraph n]
</span><a href="#local-6989586621679226162"><span class="hs-identifier hs-var">sgs</span></a></span><span> </span><span class="annot"><span class="annottext">[DotStatements n]
</span><a href="#local-6989586621679226194"><span class="hs-identifier hs-var">sStmts'</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#updateGraphGlobs"><span class="hs-identifier hs-type">updateGraphGlobs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span id="updateGraphGlobs"><span class="annot"><span class="annottext">updateGraphGlobs :: Attributes -&gt; [Attributes] -&gt; [Attributes]
</span><a href="Data.GraphViz.Algorithms.html#updateGraphGlobs"><span class="hs-identifier hs-var hs-var">updateGraphGlobs</span></a></span></span><span> </span><span id="local-6989586621679226201"><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226201"><span class="hs-identifier hs-var">gas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; Attributes) -&gt; [Attributes] -&gt; [Attributes]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; Attributes
</span><a href="#local-6989586621679226202"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679226205"><span class="annot"><span class="annottext">gasS :: Set Attribute
</span><a href="#local-6989586621679226205"><span class="hs-identifier hs-var hs-var">gasS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; Set Attribute
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226201"><span class="hs-identifier hs-var">gas</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>    </span><span id="local-6989586621679226207"><span class="annot"><span class="annottext">override :: SAttrs
</span><a href="#local-6989586621679226207"><span class="hs-identifier hs-var hs-var">override</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; SAttrs) -&gt; Attributes -&gt; SAttrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; Attributes
</span><a href="Data.GraphViz.Algorithms.html#nonSameDefaults"><span class="hs-identifier hs-var">nonSameDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><a href="#local-6989586621679226201"><span class="hs-identifier hs-var">gas</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-comment">-- * Remove any identical values</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-comment">-- * Override any different values</span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621679226202"><span class="annot"><span class="annottext">go :: Attributes -&gt; Attributes
</span><a href="#local-6989586621679226202"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Attribute -&gt; Attributes
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">Set.toList</span></a></span><span>
</span><span id="line-251"></span><span>         </span><span class="annot"><span class="annottext">(Set Attribute -&gt; Attributes)
-&gt; (Attributes -&gt; Set Attribute) -&gt; Attributes -&gt; Attributes
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Attribute -&gt; Set Attribute -&gt; Set Attribute
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#difference"><span class="hs-operator hs-var">`Set.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set Attribute
</span><a href="#local-6989586621679226205"><span class="hs-identifier hs-var">gasS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Remove identical values</span><span>
</span><span id="line-252"></span><span>         </span><span class="annot"><span class="annottext">(Set Attribute -&gt; Set Attribute)
-&gt; (Attributes -&gt; Set Attribute) -&gt; Attributes -&gt; Set Attribute
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs -&gt; Set Attribute
</span><a href="Data.GraphViz.Attributes.Same.html#unSameSet"><span class="hs-identifier hs-var">unSameSet</span></a></span><span>
</span><span id="line-253"></span><span>         </span><span class="annot"><span class="annottext">(SAttrs -&gt; Set Attribute)
-&gt; (Attributes -&gt; SAttrs) -&gt; Attributes -&gt; Set Attribute
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SAttrs -&gt; SAttrs -&gt; SAttrs
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`Set.union`</span></a></span><span> </span><span class="annot"><span class="annottext">SAttrs
</span><a href="#local-6989586621679226207"><span class="hs-identifier hs-var">override</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Keeps existing values of constructors</span><span>
</span><span id="line-254"></span><span>         </span><span class="annot"><span class="annottext">(SAttrs -&gt; SAttrs)
-&gt; (Attributes -&gt; SAttrs) -&gt; Attributes -&gt; SAttrs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; SAttrs
</span><a href="Data.GraphViz.Attributes.Same.html#toSAttr"><span class="hs-identifier hs-var">toSAttr</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#nonSameDefaults"><span class="hs-identifier hs-type">nonSameDefaults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span>
</span><span id="line-257"></span><span id="nonSameDefaults"><span class="annot"><span class="annottext">nonSameDefaults :: Attributes -&gt; Attributes
</span><a href="Data.GraphViz.Algorithms.html#nonSameDefaults"><span class="hs-identifier hs-var hs-var">nonSameDefaults</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attribute -&gt; Maybe Attribute) -&gt; Attributes -&gt; Attributes
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679226217"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679226217"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679226218"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679226218"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679226218"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Maybe Attribute
</span><a href="Data.GraphViz.Attributes.Complete.html#defaultAttributeValue"><span class="hs-identifier hs-var">defaultAttributeValue</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679226217"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679226218"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679226217"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span id="local-6989586621679225730"><span id="local-6989586621679225731"><span class="annot"><a href="Data.GraphViz.Algorithms.html#getCommonGlobs"><span class="hs-identifier hs-type">getCommonGlobs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span>
</span><span id="line-260"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier hs-type">DotStatements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225730"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225731"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ From sub-graphs</span></span><span>
</span><span id="line-262"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier hs-type">DotStatements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225730"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Statements from the sub-graphs for testing.</span></span><span>
</span><span id="line-263"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ From nodes/edges</span></span><span>
</span><span id="line-264"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span></span></span><span>
</span><span id="line-265"></span><span id="getCommonGlobs"><span class="annot"><span class="annottext">getCommonGlobs :: forall n a.
CanonicaliseOptions
-&gt; (DotStatements n -&gt; [a])
-&gt; [Attributes]
-&gt; [DotStatements n]
-&gt; [Attributes]
-&gt; Attributes
</span><a href="Data.GraphViz.Algorithms.html#getCommonGlobs"><span class="hs-identifier hs-var hs-var">getCommonGlobs</span></a></span></span><span> </span><span id="local-6989586621679226223"><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226223"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679226224"><span class="annot"><span class="annottext">DotStatements n -&gt; [a]
</span><a href="#local-6989586621679226224"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679226225"><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226225"><span class="hs-identifier hs-var">sas</span></a></span></span><span> </span><span id="local-6989586621679226226"><span class="annot"><span class="annottext">[DotStatements n]
</span><a href="#local-6989586621679226226"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span id="local-6989586621679226227"><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226227"><span class="hs-keyword hs-var">as</span></a></span></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#groupAttributes"><span class="hs-identifier hs-var">groupAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226223"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226228"><span class="hs-identifier hs-var">sas'</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes] -&gt; [Attributes] -&gt; [Attributes]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226227"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-268"></span><span>                  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Attributes
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>                  </span><span id="local-6989586621679226229"><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226229"><span class="hs-identifier hs-var">as'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Attribute -&gt; Attributes
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Attribute -&gt; Attributes)
-&gt; ([Set Attribute] -&gt; Set Attribute)
-&gt; [Set Attribute]
-&gt; Attributes
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Attribute -&gt; Set Attribute -&gt; Set Attribute)
-&gt; [Set Attribute] -&gt; Set Attribute
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Attribute -&gt; Set Attribute -&gt; Set Attribute
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#intersection"><span class="hs-identifier hs-var">Set.intersection</span></a></span><span>
</span><span id="line-271"></span><span>                         </span><span class="annot"><span class="annottext">([Set Attribute] -&gt; Attributes) -&gt; [Set Attribute] -&gt; Attributes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; Set Attribute) -&gt; [Attributes] -&gt; [Set Attribute]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; Set Attribute
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226229"><span class="hs-identifier hs-var">as'</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679226228"><span class="annot"><span class="annottext">sas' :: [Attributes]
</span><a href="#local-6989586621679226228"><span class="hs-identifier hs-var hs-var">sas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DotStatements n -&gt; [a])
-&gt; [Attributes] -&gt; [DotStatements n] -&gt; [Attributes]
forall n a.
(DotStatements n -&gt; [a])
-&gt; [Attributes] -&gt; [DotStatements n] -&gt; [Attributes]
</span><a href="Data.GraphViz.Algorithms.html#keepIfAny"><span class="hs-identifier hs-var">keepIfAny</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [a]
</span><a href="#local-6989586621679226224"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226225"><span class="hs-identifier hs-var">sas</span></a></span><span> </span><span class="annot"><span class="annottext">[DotStatements n]
</span><a href="#local-6989586621679226226"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- Used to distinguish between having empty list of global attributes</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- for nodes or edges because there aren't any nodes/edges, or because</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- there aren't any common attributes</span><span>
</span><span id="line-278"></span><span id="local-6989586621679225753"><span id="local-6989586621679225754"><span class="annot"><a href="Data.GraphViz.Algorithms.html#keepIfAny"><span class="hs-identifier hs-type">keepIfAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier hs-type">DotStatements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225753"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225754"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier hs-type">DotStatements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225753"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-279"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Attributes.Complete.html#Attributes"><span class="hs-identifier hs-type">Attributes</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-280"></span><span id="keepIfAny"><span class="annot"><span class="annottext">keepIfAny :: forall n a.
(DotStatements n -&gt; [a])
-&gt; [Attributes] -&gt; [DotStatements n] -&gt; [Attributes]
</span><a href="Data.GraphViz.Algorithms.html#keepIfAny"><span class="hs-identifier hs-var hs-var">keepIfAny</span></a></span></span><span> </span><span id="local-6989586621679226233"><span class="annot"><span class="annottext">DotStatements n -&gt; [a]
</span><a href="#local-6989586621679226233"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679226234"><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226234"><span class="hs-identifier hs-var">sas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Attributes, Bool) -&gt; Attributes)
-&gt; [(Attributes, Bool)] -&gt; [Attributes]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes, Bool) -&gt; Attributes
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([(Attributes, Bool)] -&gt; [Attributes])
-&gt; ([DotStatements n] -&gt; [(Attributes, Bool)])
-&gt; [DotStatements n]
-&gt; [Attributes]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Attributes, Bool) -&gt; Bool)
-&gt; [(Attributes, Bool)] -&gt; [(Attributes, Bool)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes, Bool) -&gt; Bool
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">([(Attributes, Bool)] -&gt; [(Attributes, Bool)])
-&gt; ([DotStatements n] -&gt; [(Attributes, Bool)])
-&gt; [DotStatements n]
-&gt; [(Attributes, Bool)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes] -&gt; [Bool] -&gt; [(Attributes, Bool)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Attributes]
</span><a href="#local-6989586621679226234"><span class="hs-identifier hs-var">sas</span></a></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; [(Attributes, Bool)])
-&gt; ([DotStatements n] -&gt; [Bool])
-&gt; [DotStatements n]
-&gt; [(Attributes, Bool)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DotStatements n -&gt; Bool) -&gt; [DotStatements n] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DotStatements n -&gt; [a]) -&gt; DotStatements n -&gt; Bool
forall n a. (DotStatements n -&gt; [a]) -&gt; DotStatements n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#hasAny"><span class="hs-identifier hs-var">hasAny</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [a]
</span><a href="#local-6989586621679226233"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span id="local-6989586621679225760"><span id="local-6989586621679225761"><span class="annot"><a href="Data.GraphViz.Algorithms.html#hasAny"><span class="hs-identifier hs-type">hasAny</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier hs-type">DotStatements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225760"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotStatements"><span class="hs-identifier hs-type">DotStatements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225760"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-283"></span><span id="hasAny"><span class="annot"><span class="annottext">hasAny :: forall n a. (DotStatements n -&gt; [a]) -&gt; DotStatements n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#hasAny"><span class="hs-identifier hs-var hs-var">hasAny</span></a></span></span><span> </span><span id="local-6989586621679226238"><span class="annot"><span class="annottext">DotStatements n -&gt; [a]
</span><a href="#local-6989586621679226238"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679226239"><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226239"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Bool) -&gt; [a] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [a]
</span><a href="#local-6989586621679226238"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226239"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">(DotSubGraph n -&gt; Bool) -&gt; [DotSubGraph n] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DotStatements n -&gt; [a]) -&gt; DotStatements n -&gt; Bool
forall n a. (DotStatements n -&gt; [a]) -&gt; DotStatements n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#hasAny"><span class="hs-identifier hs-var">hasAny</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n -&gt; [a]
</span><a href="#local-6989586621679226238"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(DotStatements n -&gt; Bool)
-&gt; (DotSubGraph n -&gt; DotStatements n) -&gt; DotSubGraph n -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotSubGraph n -&gt; DotStatements n
forall n. DotSubGraph n -&gt; DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphStmts"><span class="hs-identifier hs-var">subGraphStmts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DotStatements n -&gt; [DotSubGraph n]
forall n. DotStatements n -&gt; [DotSubGraph n]
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphs"><span class="hs-identifier hs-var">subGraphs</span></a></span><span> </span><span class="annot"><span class="annottext">DotStatements n
</span><a href="#local-6989586621679226239"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span id="local-6989586621679225657"><span class="annot"><a href="Data.GraphViz.Algorithms.html#promoteDSG"><span class="hs-identifier hs-type">promoteDSG</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotSubGraph"><span class="hs-identifier hs-type">DotSubGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225657"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225657"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-286"></span><span id="promoteDSG"><span class="annot"><span class="annottext">promoteDSG :: forall n. DotSubGraph n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#promoteDSG"><span class="hs-identifier hs-var hs-var">promoteDSG</span></a></span></span><span> </span><span id="local-6989586621679226246"><span class="annot"><span class="annottext">DotSubGraph n
</span><a href="#local-6989586621679226246"><span class="hs-identifier hs-var">dsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">strictGraph :: Bool
</span><a href="Data.GraphViz.Types.Canonical.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-287"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">directedGraph :: Bool
</span><a href="Data.GraphViz.Types.Canonical.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-288"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphID :: Maybe GraphID
</span><a href="Data.GraphViz.Types.Canonical.html#graphID"><span class="hs-identifier hs-var">graphID</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotSubGraph n -&gt; Maybe GraphID
forall n. DotSubGraph n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphID"><span class="hs-identifier hs-var">subGraphID</span></a></span><span> </span><span class="annot"><span class="annottext">DotSubGraph n
</span><a href="#local-6989586621679226246"><span class="hs-identifier hs-var">dsg</span></a></span><span>
</span><span id="line-289"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">graphStatements :: DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#graphStatements"><span class="hs-identifier hs-var">graphStatements</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotSubGraph n -&gt; DotStatements n
forall n. DotSubGraph n -&gt; DotStatements n
</span><a href="Data.GraphViz.Types.Canonical.html#subGraphStmts"><span class="hs-identifier hs-var">subGraphStmts</span></a></span><span> </span><span class="annot"><span class="annottext">DotSubGraph n
</span><a href="#local-6989586621679226246"><span class="hs-identifier hs-var">dsg</span></a></span><span>
</span><span id="line-290"></span><span>                          </span><span class="hs-special">}</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- Same as compare for lists, except shorter lists are GT</span><span>
</span><span id="line-293"></span><span id="local-6989586621679225673"><span class="annot"><a href="Data.GraphViz.Algorithms.html#compLists"><span class="hs-identifier hs-type">compLists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225673"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225673"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225673"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a></span></span><span>
</span><span id="line-294"></span><span id="compLists"><span class="annot"><span class="annottext">compLists :: forall a. Ord a =&gt; [a] -&gt; [a] -&gt; Ordering
</span><a href="Data.GraphViz.Algorithms.html#compLists"><span class="hs-identifier hs-var hs-var">compLists</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#compLists"><span class="hs-identifier hs-var">compLists</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#compLists"><span class="hs-identifier hs-var">compLists</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#compLists"><span class="hs-identifier hs-var">compLists</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679226253"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679226253"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679226254"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679226254"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679226255"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679226255"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679226256"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679226256"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679226253"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679226255"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-298"></span><span>                            </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Ordering
forall a. Ord a =&gt; [a] -&gt; [a] -&gt; Ordering
</span><a href="Data.GraphViz.Algorithms.html#compLists"><span class="hs-identifier hs-var">compLists</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679226254"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679226256"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-299"></span><span>                            </span><span id="local-6989586621679226258"><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679226258"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679226258"><span class="hs-identifier hs-var">oth</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#nonEmptyGAs"><span class="hs-identifier hs-type">nonEmptyGAs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#GlobalAttributes"><span class="hs-identifier hs-type">GlobalAttributes</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span id="nonEmptyGAs"><span class="annot"><span class="annottext">nonEmptyGAs :: [GlobalAttributes] -&gt; [GlobalAttributes]
</span><a href="Data.GraphViz.Algorithms.html#nonEmptyGAs"><span class="hs-identifier hs-var hs-var">nonEmptyGAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalAttributes -&gt; Bool)
-&gt; [GlobalAttributes] -&gt; [GlobalAttributes]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (GlobalAttributes -&gt; Bool) -&gt; GlobalAttributes -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">(Attributes -&gt; Bool)
-&gt; (GlobalAttributes -&gt; Attributes) -&gt; GlobalAttributes -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalAttributes -&gt; Attributes
</span><a href="Data.GraphViz.Types.Internal.Common.html#attrs"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- Assign each edge into the cluster it belongs in.</span><span>
</span><span id="line-305"></span><span id="local-6989586621679225687"><span class="annot"><a href="Data.GraphViz.Algorithms.html#edgeClusters"><span class="hs-identifier hs-type">edgeClusters</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225687"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.State.html#NodeLookup"><span class="hs-identifier hs-type">NodeLookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225687"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225687"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#EdgeLocations"><span class="hs-identifier hs-type">EdgeLocations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225687"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-307"></span><span id="edgeClusters"><span class="annot"><span class="annottext">edgeClusters :: forall n. Ord n =&gt; NodeLookup n -&gt; [DotEdge n] -&gt; EdgeLocations n
</span><a href="Data.GraphViz.Algorithms.html#edgeClusters"><span class="hs-identifier hs-var hs-var">edgeClusters</span></a></span></span><span> </span><span id="local-6989586621679226263"><span class="annot"><span class="annottext">NodeLookup n
</span><a href="#local-6989586621679226263"><span class="hs-identifier hs-var">nl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([Maybe GraphID], DotEdge n)] -&gt; EdgeClusters n
forall {b'}. [([Maybe GraphID], b')] -&gt; Map (Maybe GraphID) [b']
</span><a href="#local-6989586621679226264"><span class="hs-identifier hs-var">toM</span></a></span><span> </span><span class="annot"><span class="annottext">([([Maybe GraphID], DotEdge n)] -&gt; EdgeClusters n)
-&gt; ([([Maybe GraphID], DotEdge n)] -&gt; [DotEdge n])
-&gt; ([([Maybe GraphID], DotEdge n)], [([Maybe GraphID], DotEdge n)])
-&gt; (EdgeClusters n, [DotEdge n])
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#%2A%2A%2A"><span class="hs-operator hs-var">***</span></a></span><span> </span><span class="annot"><span class="annottext">(([Maybe GraphID], DotEdge n) -&gt; DotEdge n)
-&gt; [([Maybe GraphID], DotEdge n)] -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID], DotEdge n) -&gt; DotEdge n
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([([Maybe GraphID], DotEdge n)], [([Maybe GraphID], DotEdge n)])
 -&gt; (EdgeClusters n, [DotEdge n]))
-&gt; ([DotEdge n]
    -&gt; ([([Maybe GraphID], DotEdge n)],
        [([Maybe GraphID], DotEdge n)]))
-&gt; [DotEdge n]
-&gt; (EdgeClusters n, [DotEdge n])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(([Maybe GraphID], DotEdge n) -&gt; Bool)
-&gt; [([Maybe GraphID], DotEdge n)]
-&gt; ([([Maybe GraphID], DotEdge n)], [([Maybe GraphID], DotEdge n)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (([Maybe GraphID], DotEdge n) -&gt; Bool)
-&gt; ([Maybe GraphID], DotEdge n)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe GraphID] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; Bool)
-&gt; (([Maybe GraphID], DotEdge n) -&gt; [Maybe GraphID])
-&gt; ([Maybe GraphID], DotEdge n)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID], DotEdge n) -&gt; [Maybe GraphID]
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                  </span><span class="annot"><span class="annottext">([([Maybe GraphID], DotEdge n)]
 -&gt; ([([Maybe GraphID], DotEdge n)],
     [([Maybe GraphID], DotEdge n)]))
-&gt; ([DotEdge n] -&gt; [([Maybe GraphID], DotEdge n)])
-&gt; [DotEdge n]
-&gt; ([([Maybe GraphID], DotEdge n)], [([Maybe GraphID], DotEdge n)])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DotEdge n -&gt; ([Maybe GraphID], DotEdge n))
-&gt; [DotEdge n] -&gt; [([Maybe GraphID], DotEdge n)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; ([Maybe GraphID], DotEdge n)
</span><a href="#local-6989586621679226265"><span class="hs-identifier hs-var">inClust</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679226267"><span class="annot"><span class="annottext">nl' :: Map n [Maybe GraphID]
</span><a href="#local-6989586621679226267"><span class="hs-identifier hs-var hs-var">nl'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Seq (Maybe GraphID), Attributes) -&gt; [Maybe GraphID])
-&gt; NodeLookup n -&gt; Map n [Maybe GraphID]
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Maybe GraphID) -&gt; [Maybe GraphID]
forall a. Seq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Maybe GraphID) -&gt; [Maybe GraphID])
-&gt; ((Seq (Maybe GraphID), Attributes) -&gt; Seq (Maybe GraphID))
-&gt; (Seq (Maybe GraphID), Attributes)
-&gt; [Maybe GraphID]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (Maybe GraphID), Attributes) -&gt; Seq (Maybe GraphID)
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NodeLookup n
</span><a href="#local-6989586621679226263"><span class="hs-identifier hs-var">nl</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-comment">-- DotEdge n -&gt; (Path, DotEdge n)</span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679226265"><span class="annot"><span class="annottext">inClust :: DotEdge n -&gt; ([Maybe GraphID], DotEdge n)
</span><a href="#local-6989586621679226265"><span class="hs-identifier hs-var hs-var">inClust</span></a></span></span><span> </span><span id="local-6989586621679226274"><span class="annot"><span class="annottext">de :: DotEdge n
</span><a href="#local-6989586621679226274"><span class="hs-identifier hs-var">de</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span id="local-6989586621679226276"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226276"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679226277"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226277"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Attributes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; DotEdge n -&gt; ([Maybe GraphID], DotEdge n))
-&gt; DotEdge n -&gt; [Maybe GraphID] -&gt; ([Maybe GraphID], DotEdge n)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DotEdge n
</span><a href="#local-6989586621679226274"><span class="hs-identifier hs-var">de</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                                   </span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; ([Maybe GraphID], DotEdge n))
-&gt; ([(Maybe GraphID, Maybe GraphID)] -&gt; [Maybe GraphID])
-&gt; [(Maybe GraphID, Maybe GraphID)]
-&gt; ([Maybe GraphID], DotEdge n)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe GraphID, Maybe GraphID) -&gt; Maybe GraphID)
-&gt; [(Maybe GraphID, Maybe GraphID)] -&gt; [Maybe GraphID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe GraphID, Maybe GraphID) -&gt; Maybe GraphID
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([(Maybe GraphID, Maybe GraphID)] -&gt; [Maybe GraphID])
-&gt; ([(Maybe GraphID, Maybe GraphID)]
    -&gt; [(Maybe GraphID, Maybe GraphID)])
-&gt; [(Maybe GraphID, Maybe GraphID)]
-&gt; [Maybe GraphID]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe GraphID, Maybe GraphID) -&gt; Bool)
-&gt; [(Maybe GraphID, Maybe GraphID)]
-&gt; [(Maybe GraphID, Maybe GraphID)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe GraphID -&gt; Maybe GraphID -&gt; Bool)
-&gt; (Maybe GraphID, Maybe GraphID) -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GraphID -&gt; Maybe GraphID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">(==)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>                                   </span><span class="annot"><span class="annottext">([(Maybe GraphID, Maybe GraphID)] -&gt; ([Maybe GraphID], DotEdge n))
-&gt; [(Maybe GraphID, Maybe GraphID)] -&gt; ([Maybe GraphID], DotEdge n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe GraphID]
-&gt; [Maybe GraphID] -&gt; [(Maybe GraphID, Maybe GraphID)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map n [Maybe GraphID]
</span><a href="#local-6989586621679226267"><span class="hs-identifier hs-var">nl'</span></a></span><span> </span><span class="annot"><span class="annottext">Map n [Maybe GraphID] -&gt; n -&gt; [Maybe GraphID]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226276"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map n [Maybe GraphID]
</span><a href="#local-6989586621679226267"><span class="hs-identifier hs-var">nl'</span></a></span><span> </span><span class="annot"><span class="annottext">Map n [Maybe GraphID] -&gt; n -&gt; [Maybe GraphID]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226277"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679226264"><span class="annot"><span class="annottext">toM :: [([Maybe GraphID], b')] -&gt; Map (Maybe GraphID) [b']
</span><a href="#local-6989586621679226264"><span class="hs-identifier hs-var hs-var">toM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DList b' -&gt; [b'])
-&gt; Map (Maybe GraphID) (DList b') -&gt; Map (Maybe GraphID) [b']
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="annot"><span class="annottext">DList b' -&gt; [b']
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DList.toList</span></span><span>
</span><span id="line-316"></span><span>          </span><span class="annot"><span class="annottext">(Map (Maybe GraphID) (DList b') -&gt; Map (Maybe GraphID) [b'])
-&gt; ([([Maybe GraphID], b')] -&gt; Map (Maybe GraphID) (DList b'))
-&gt; [([Maybe GraphID], b')]
-&gt; Map (Maybe GraphID) [b']
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DList b' -&gt; DList b' -&gt; DList b')
-&gt; [(Maybe GraphID, DList b')] -&gt; Map (Maybe GraphID) (DList b')
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromListWith"><span class="hs-identifier hs-var">Map.fromListWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DList b' -&gt; DList b' -&gt; DList b')
-&gt; DList b' -&gt; DList b' -&gt; DList b'
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">DList b' -&gt; DList b' -&gt; DList b'
forall a. DList a -&gt; DList a -&gt; DList a
</span><span class="hs-identifier hs-var">DList.append</span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>          </span><span class="annot"><span class="annottext">([(Maybe GraphID, DList b')] -&gt; Map (Maybe GraphID) (DList b'))
-&gt; ([([Maybe GraphID], b')] -&gt; [(Maybe GraphID, DList b')])
-&gt; [([Maybe GraphID], b')]
-&gt; Map (Maybe GraphID) (DList b')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(([Maybe GraphID], b') -&gt; (Maybe GraphID, DList b'))
-&gt; [([Maybe GraphID], b')] -&gt; [(Maybe GraphID, DList b')]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe GraphID] -&gt; Maybe GraphID
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe GraphID] -&gt; Maybe GraphID)
-&gt; (b' -&gt; DList b')
-&gt; ([Maybe GraphID], b')
-&gt; (Maybe GraphID, DList b')
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#%2A%2A%2A"><span class="hs-operator hs-var">***</span></a></span><span> </span><span class="annot"><span class="annottext">b' -&gt; DList b'
forall a. a -&gt; DList a
</span><span class="hs-identifier hs-var">DList.singleton</span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><span class="hs-comment">{- $transitive

   In large, cluttered graphs, it can often be difficult to see what
   is happening due to the number of edges being drawn.  As such, it is
   often useful to remove transitive edges from the graph before
   visualising it.

   For example, consider the following Dot graph:

   &gt; digraph {
   &gt;     a -&gt; b;
   &gt;     a -&gt; c;
   &gt;     b -&gt; c;
   &gt; }

   This graph has the transitive edge @a -&gt; c@ (as we can reach @c@ from @a@ via @b@).

   Graphviz comes with the @tred@ program to perform these transitive
   reductions.  'transitiveReduction' and 'transitiveReductionOptions'
   are pure Haskell re-implementations of @tred@ with the following differences:

   * @tred@ prints a message to stderr if a cycle is detected; these
     functions do not.

   * @tred@ preserves the original structure of the graph; these
     functions use the canonicalisation functions above to create the new
     graph (rather than re-implement creation functions for each one).

   When a graph contains cycles, an arbitrary edge from that cycle is
   ignored whilst calculating the transitive reduction.  Multiple edges
   are also reduced (such that only the first edge between two nodes is
   kept).

   Note that transitive reduction only makes sense for directed graphs;
   for undirected graphs these functions are identical to the
   canonicalisation functions above.

   The caveats for the canonicalisation functions also apply.
 -}</span></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span id="local-6989586621679226293"><span id="local-6989586621679226294"><span class="annot"><a href="Data.GraphViz.Algorithms.html#transitiveReduction"><span class="hs-identifier hs-type">transitiveReduction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.html#DotRepr"><span class="hs-identifier hs-type">DotRepr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226293"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226294"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226293"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226294"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226294"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-362"></span><span id="transitiveReduction"><span class="annot"><span class="annottext">transitiveReduction :: forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#transitiveReduction"><span class="hs-identifier hs-var hs-var">transitiveReduction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions -&gt; dg n -&gt; DotGraph n
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
CanonicaliseOptions -&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#transitiveReductionOptions"><span class="hs-identifier hs-var">transitiveReductionOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="Data.GraphViz.Algorithms.html#defaultCanonOptions"><span class="hs-identifier hs-var">defaultCanonOptions</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span id="local-6989586621679226297"><span id="local-6989586621679226298"><span class="annot"><a href="Data.GraphViz.Algorithms.html#transitiveReductionOptions"><span class="hs-identifier hs-type">transitiveReductionOptions</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Types.html#DotRepr"><span class="hs-identifier hs-type">DotRepr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226297"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226298"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#CanonicaliseOptions"><span class="hs-identifier hs-type">CanonicaliseOptions</span></a></span><span>
</span><span id="line-365"></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226297"><span class="hs-identifier hs-type">dg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226298"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#DotGraph"><span class="hs-identifier hs-type">DotGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226298"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-366"></span><span id="transitiveReductionOptions"><span class="annot"><span class="annottext">transitiveReductionOptions :: forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
CanonicaliseOptions -&gt; dg n -&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#transitiveReductionOptions"><span class="hs-identifier hs-var hs-var">transitiveReductionOptions</span></a></span></span><span> </span><span id="local-6989586621679226304"><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226304"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679226305"><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226305"><span class="hs-identifier hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotGraph n
</span><a href="#local-6989586621679226306"><span class="hs-identifier hs-var">cdg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#strictGraph"><span class="hs-identifier hs-var">strictGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#graphIsStrict"><span class="hs-identifier hs-type">graphIsStrict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226305"><span class="hs-identifier hs-type">dg</span></a></span><span>
</span><span id="line-367"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Canonical.html#directedGraph"><span class="hs-identifier hs-var">directedGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.html#graphIsDirected"><span class="hs-identifier hs-type">graphIsDirected</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226305"><span class="hs-identifier hs-type">dg</span></a></span><span>
</span><span id="line-368"></span><span>                                         </span><span class="hs-special">}</span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>    </span><span id="local-6989586621679226306"><span class="annot"><span class="annottext">cdg :: DotGraph n
</span><a href="#local-6989586621679226306"><span class="hs-identifier hs-var hs-var">cdg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
-&gt; Maybe GraphID
-&gt; GlobalAttributes
-&gt; ClusterLookup
-&gt; NodeLookup n
-&gt; [DotEdge n]
-&gt; DotGraph n
forall n.
Ord n =&gt;
CanonicaliseOptions
-&gt; Maybe GraphID
-&gt; GlobalAttributes
-&gt; ClusterLookup
-&gt; NodeLookup n
-&gt; [DotEdge n]
-&gt; DotGraph n
</span><a href="Data.GraphViz.Algorithms.html#createCanonical"><span class="hs-identifier hs-var">createCanonical</span></a></span><span> </span><span class="annot"><span class="annottext">CanonicaliseOptions
</span><a href="#local-6989586621679226304"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">dg n -&gt; Maybe GraphID
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; Maybe GraphID
</span><a href="Data.GraphViz.Types.html#getID"><span class="hs-identifier hs-var">getID</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226305"><span class="hs-identifier hs-var">dg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GlobalAttributes
</span><a href="#local-6989586621679226312"><span class="hs-identifier hs-var">gas</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterLookup
</span><a href="#local-6989586621679226313"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">NodeLookup n
</span><a href="#local-6989586621679226314"><span class="hs-identifier hs-var">nl</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226315"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679226312"><span class="annot"><span class="annottext">GlobalAttributes
</span><a href="#local-6989586621679226312"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679226313"><span class="annot"><span class="annottext">ClusterLookup
</span><a href="#local-6989586621679226313"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dg n -&gt; (GlobalAttributes, ClusterLookup)
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
dg n -&gt; (GlobalAttributes, ClusterLookup)
</span><a href="Data.GraphViz.Types.html#graphStructureInformationClean"><span class="hs-identifier hs-var">graphStructureInformationClean</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226305"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span id="local-6989586621679226314"><span class="annot"><span class="annottext">nl :: NodeLookup n
</span><a href="#local-6989586621679226314"><span class="hs-identifier hs-var hs-var">nl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; dg n -&gt; NodeLookup n
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
Bool -&gt; dg n -&gt; NodeLookup n
</span><a href="Data.GraphViz.Types.html#nodeInformationClean"><span class="hs-identifier hs-var">nodeInformationClean</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226305"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679226325"><span class="annot"><span class="annottext">es :: [DotEdge n]
</span><a href="#local-6989586621679226325"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; dg n -&gt; [DotEdge n]
forall (dg :: * -&gt; *) n.
DotRepr dg n =&gt;
Bool -&gt; dg n -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Types.html#edgeInformationClean"><span class="hs-identifier hs-var">edgeInformationClean</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226305"><span class="hs-identifier hs-var">dg</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679226315"><span class="annot"><span class="annottext">es' :: [DotEdge n]
</span><a href="#local-6989586621679226315"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">dg n -&gt; Bool
forall (dg :: * -&gt; *) n. DotRepr dg n =&gt; dg n -&gt; Bool
</span><a href="Data.GraphViz.Types.html#graphIsDirected"><span class="hs-identifier hs-var">graphIsDirected</span></a></span><span> </span><span class="annot"><span class="annottext">dg n
</span><a href="#local-6989586621679226305"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotEdge n] -&gt; [DotEdge n]
forall n. Ord n =&gt; [DotEdge n] -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Algorithms.html#rmTransEdges"><span class="hs-identifier hs-var">rmTransEdges</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226325"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-375"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226325"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span id="local-6989586621679225798"><span class="annot"><a href="Data.GraphViz.Algorithms.html#rmTransEdges"><span class="hs-identifier hs-type">rmTransEdges</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225798"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225798"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225798"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-378"></span><span id="rmTransEdges"><span class="annot"><span class="annottext">rmTransEdges :: forall n. Ord n =&gt; [DotEdge n] -&gt; [DotEdge n]
</span><a href="Data.GraphViz.Algorithms.html#rmTransEdges"><span class="hs-identifier hs-var hs-var">rmTransEdges</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#rmTransEdges"><span class="hs-identifier hs-var">rmTransEdges</span></a></span><span> </span><span id="local-6989586621679226335"><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226335"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TaggedValues n -&gt; [DotEdge n]) -&gt; [TaggedValues n] -&gt; [DotEdge n]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, DotEdge n) -&gt; DotEdge n)
-&gt; [(Int, DotEdge n)] -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, DotEdge n) -&gt; DotEdge n
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, DotEdge n)] -&gt; [DotEdge n])
-&gt; (TaggedValues n -&gt; [(Int, DotEdge n)])
-&gt; TaggedValues n
-&gt; [DotEdge n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedValues n -&gt; [(Int, DotEdge n)]
forall n. TaggedValues n -&gt; [TaggedEdge n]
</span><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var">outgoing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TaggedValues n] -&gt; [DotEdge n])
-&gt; [TaggedValues n] -&gt; [DotEdge n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (TaggedValues n) -&gt; [TaggedValues n]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">Map.elems</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (TaggedValues n)
</span><a href="#local-6989586621679226339"><span class="hs-identifier hs-var">esM</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679226340"><span class="annot"><span class="annottext">tes :: [(Int, DotEdge n)]
</span><a href="#local-6989586621679226340"><span class="hs-identifier hs-var hs-var">tes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DotEdge n] -&gt; [(Int, DotEdge n)]
forall n. [DotEdge n] -&gt; [TaggedEdge n]
</span><a href="Data.GraphViz.Algorithms.html#tagEdges"><span class="hs-identifier hs-var">tagEdges</span></a></span><span> </span><span class="annot"><span class="annottext">[DotEdge n]
</span><a href="#local-6989586621679226335"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621679226352"><span class="annot"><span class="annottext">esMS :: StateT (Map n (TaggedValues n), TagSet) Identity ()
</span><a href="#local-6989586621679226352"><span class="hs-identifier hs-var hs-var">esMS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">[(Int, DotEdge n)]
-&gt; StateT (Map n (TaggedValues n), TagSet) Identity ()
forall n. Ord n =&gt; [TaggedEdge n] -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#edgeGraph"><span class="hs-identifier hs-var">edgeGraph</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, DotEdge n)]
</span><a href="#local-6989586621679226340"><span class="hs-identifier hs-var">tes</span></a></span><span>
</span><span id="line-384"></span><span>              </span><span id="local-6989586621679226354"><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679226354"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Map n (TaggedValues n) -&gt; [n]) -&gt; TagState n [n]
forall n a. (TagMap n -&gt; a) -&gt; TagState n a
</span><a href="Data.GraphViz.Algorithms.html#getsMap"><span class="hs-identifier hs-var">getsMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map n (TaggedValues n) -&gt; [n]
forall k a. Map k a -&gt; [k]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">Map.keys</span></a></span><span>
</span><span id="line-385"></span><span>              </span><span class="annot"><span class="annottext">(n -&gt; StateT (Map n (TaggedValues n), TagSet) Identity ())
-&gt; [n] -&gt; StateT (Map n (TaggedValues n), TagSet) Identity ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; n -&gt; StateT (Map n (TaggedValues n), TagSet) Identity ()
forall n. Ord n =&gt; Int -&gt; n -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#traverseTag"><span class="hs-identifier hs-var">traverseTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.GraphViz.Algorithms.html#zeroTag"><span class="hs-identifier hs-var">zeroTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679226354"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span>    </span><span id="local-6989586621679226339"><span class="annot"><span class="annottext">esM :: Map n (TaggedValues n)
</span><a href="#local-6989586621679226339"><span class="hs-identifier hs-var hs-var">esM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map n (TaggedValues n), TagSet) -&gt; Map n (TaggedValues n)
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Map n (TaggedValues n), TagSet) -&gt; Map n (TaggedValues n))
-&gt; (Map n (TaggedValues n), TagSet) -&gt; Map n (TaggedValues n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT (Map n (TaggedValues n), TagSet) Identity ()
-&gt; (Map n (TaggedValues n), TagSet)
-&gt; (Map n (TaggedValues n), TagSet)
forall s a. State s a -&gt; s -&gt; s
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Lazy.html#execState"><span class="hs-identifier hs-var">execState</span></a></span><span> </span><span class="annot"><span class="annottext">StateT (Map n (TaggedValues n), TagSet) Identity ()
</span><a href="#local-6989586621679226352"><span class="hs-identifier hs-var">esMS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map n (TaggedValues n)
forall k a. Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TagSet
forall a. Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Data.GraphViz.Algorithms.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-390"></span><span class="hs-keyword">type</span><span> </span><span id="TagSet"><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagSet"><span class="hs-identifier hs-var">TagSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-391"></span><span class="hs-keyword">type</span><span> </span><span id="TaggedEdge"><span class="annot"><a href="Data.GraphViz.Algorithms.html#TaggedEdge"><span class="hs-identifier hs-var">TaggedEdge</span></a></span></span><span> </span><span id="local-6989586621679226362"><span class="annot"><a href="#local-6989586621679226362"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226362"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- A &quot;nonsense&quot; tag to use as an initial value</span><span>
</span><span id="line-394"></span><span class="annot"><a href="Data.GraphViz.Algorithms.html#zeroTag"><span class="hs-identifier hs-type">zeroTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span>
</span><span id="line-395"></span><span id="zeroTag"><span class="annot"><span class="annottext">zeroTag :: Int
</span><a href="Data.GraphViz.Algorithms.html#zeroTag"><span class="hs-identifier hs-var hs-var">zeroTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span id="local-6989586621679225808"><span class="annot"><a href="Data.GraphViz.Algorithms.html#tagEdges"><span class="hs-identifier hs-type">tagEdges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Types.Internal.Common.html#DotEdge"><span class="hs-identifier hs-type">DotEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225808"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TaggedEdge"><span class="hs-identifier hs-type">TaggedEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225808"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-398"></span><span id="tagEdges"><span class="annot"><span class="annottext">tagEdges :: forall n. [DotEdge n] -&gt; [TaggedEdge n]
</span><a href="Data.GraphViz.Algorithms.html#tagEdges"><span class="hs-identifier hs-var hs-var">tagEdges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [DotEdge n] -&gt; [(Int, DotEdge n)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#succ"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.GraphViz.Algorithms.html#zeroTag"><span class="hs-identifier hs-var">zeroTag</span></a></span><span class="hs-special">)</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-keyword">data</span><span> </span><span id="TaggedValues"><span class="annot"><a href="Data.GraphViz.Algorithms.html#TaggedValues"><span class="hs-identifier hs-var">TaggedValues</span></a></span></span><span> </span><span id="local-6989586621679225804"><span class="annot"><a href="#local-6989586621679225804"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TV"><span class="annot"><a href="Data.GraphViz.Algorithms.html#TV"><span class="hs-identifier hs-var">TV</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="marked"><span class="annot"><span class="annottext">forall n. TaggedValues n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#marked"><span class="hs-identifier hs-var hs-var">marked</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-401"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="incoming"><span class="annot"><span class="annottext">forall n. TaggedValues n -&gt; [TaggedEdge n]
</span><a href="Data.GraphViz.Algorithms.html#incoming"><span class="hs-identifier hs-var hs-var">incoming</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TaggedEdge"><span class="hs-identifier hs-type">TaggedEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225804"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="outgoing"><span class="annot"><span class="annottext">forall n. TaggedValues n -&gt; [TaggedEdge n]
</span><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var hs-var">outgoing</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TaggedEdge"><span class="hs-identifier hs-type">TaggedEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225804"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-403"></span><span>                         </span><span class="hs-special">}</span><span>
</span><span id="line-404"></span><span>                    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679226372"><span id="local-6989586621679226379"><span class="annot"><span class="annottext">TaggedValues n -&gt; TaggedValues n -&gt; Bool
(TaggedValues n -&gt; TaggedValues n -&gt; Bool)
-&gt; (TaggedValues n -&gt; TaggedValues n -&gt; Bool)
-&gt; Eq (TaggedValues n)
forall n. Eq n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall n. Eq n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Bool
== :: TaggedValues n -&gt; TaggedValues n -&gt; Bool
$c/= :: forall n. Eq n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Bool
/= :: TaggedValues n -&gt; TaggedValues n -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679226392"><span id="local-6989586621679226399"><span id="local-6989586621679226405"><span id="local-6989586621679226409"><span id="local-6989586621679226412"><span id="local-6989586621679226415"><span id="local-6989586621679226418"><span class="annot"><span class="annottext">Eq (TaggedValues n)
Eq (TaggedValues n) =&gt;
(TaggedValues n -&gt; TaggedValues n -&gt; Ordering)
-&gt; (TaggedValues n -&gt; TaggedValues n -&gt; Bool)
-&gt; (TaggedValues n -&gt; TaggedValues n -&gt; Bool)
-&gt; (TaggedValues n -&gt; TaggedValues n -&gt; Bool)
-&gt; (TaggedValues n -&gt; TaggedValues n -&gt; Bool)
-&gt; (TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n)
-&gt; (TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n)
-&gt; Ord (TaggedValues n)
TaggedValues n -&gt; TaggedValues n -&gt; Bool
TaggedValues n -&gt; TaggedValues n -&gt; Ordering
TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall n. Ord n =&gt; Eq (TaggedValues n)
forall n. Ord n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Bool
forall n. Ord n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Ordering
forall n.
Ord n =&gt;
TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
$ccompare :: forall n. Ord n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Ordering
compare :: TaggedValues n -&gt; TaggedValues n -&gt; Ordering
$c&lt; :: forall n. Ord n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Bool
&lt; :: TaggedValues n -&gt; TaggedValues n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Bool
&lt;= :: TaggedValues n -&gt; TaggedValues n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Bool
&gt; :: TaggedValues n -&gt; TaggedValues n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; TaggedValues n -&gt; TaggedValues n -&gt; Bool
&gt;= :: TaggedValues n -&gt; TaggedValues n -&gt; Bool
$cmax :: forall n.
Ord n =&gt;
TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
max :: TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
$cmin :: forall n.
Ord n =&gt;
TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
min :: TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679226428"><span id="local-6989586621679226436"><span id="local-6989586621679226440"><span class="annot"><span class="annottext">Int -&gt; TaggedValues n -&gt; ShowS
[TaggedValues n] -&gt; ShowS
TaggedValues n -&gt; String
(Int -&gt; TaggedValues n -&gt; ShowS)
-&gt; (TaggedValues n -&gt; String)
-&gt; ([TaggedValues n] -&gt; ShowS)
-&gt; Show (TaggedValues n)
forall n. Show n =&gt; Int -&gt; TaggedValues n -&gt; ShowS
forall n. Show n =&gt; [TaggedValues n] -&gt; ShowS
forall n. Show n =&gt; TaggedValues n -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall n. Show n =&gt; Int -&gt; TaggedValues n -&gt; ShowS
showsPrec :: Int -&gt; TaggedValues n -&gt; ShowS
$cshow :: forall n. Show n =&gt; TaggedValues n -&gt; String
show :: TaggedValues n -&gt; String
$cshowList :: forall n. Show n =&gt; [TaggedValues n] -&gt; ShowS
showList :: [TaggedValues n] -&gt; ShowS
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679226449"><span id="local-6989586621679226453"><span id="local-6989586621679226456"><span id="local-6989586621679226472"><span class="annot"><span class="annottext">ReadPrec [TaggedValues n]
ReadPrec (TaggedValues n)
Int -&gt; ReadS (TaggedValues n)
ReadS [TaggedValues n]
(Int -&gt; ReadS (TaggedValues n))
-&gt; ReadS [TaggedValues n]
-&gt; ReadPrec (TaggedValues n)
-&gt; ReadPrec [TaggedValues n]
-&gt; Read (TaggedValues n)
forall n. Read n =&gt; ReadPrec [TaggedValues n]
forall n. Read n =&gt; ReadPrec (TaggedValues n)
forall n. Read n =&gt; Int -&gt; ReadS (TaggedValues n)
forall n. Read n =&gt; ReadS [TaggedValues n]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: forall n. Read n =&gt; Int -&gt; ReadS (TaggedValues n)
readsPrec :: Int -&gt; ReadS (TaggedValues n)
$creadList :: forall n. Read n =&gt; ReadS [TaggedValues n]
readList :: ReadS [TaggedValues n]
$creadPrec :: forall n. Read n =&gt; ReadPrec (TaggedValues n)
readPrec :: ReadPrec (TaggedValues n)
$creadListPrec :: forall n. Read n =&gt; ReadPrec [TaggedValues n]
readListPrec :: ReadPrec [TaggedValues n]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621679225859"><span class="annot"><a href="Data.GraphViz.Algorithms.html#defTV"><span class="hs-identifier hs-type">defTV</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TaggedValues"><span class="hs-identifier hs-type">TaggedValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225859"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-407"></span><span id="defTV"><span class="annot"><span class="annottext">defTV :: forall n. TaggedValues n
</span><a href="Data.GraphViz.Algorithms.html#defTV"><span class="hs-identifier hs-var hs-var">defTV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [TaggedEdge n] -&gt; [TaggedEdge n] -&gt; TaggedValues n
forall n.
Bool -&gt; [TaggedEdge n] -&gt; [TaggedEdge n] -&gt; TaggedValues n
</span><a href="Data.GraphViz.Algorithms.html#TV"><span class="hs-identifier hs-var">TV</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">type</span><span> </span><span id="TagMap"><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagMap"><span class="hs-identifier hs-var">TagMap</span></a></span></span><span> </span><span id="local-6989586621679226480"><span class="annot"><a href="#local-6989586621679226480"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226480"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TaggedValues"><span class="hs-identifier hs-type">TaggedValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226480"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-keyword">type</span><span> </span><span id="TagState"><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagState"><span class="hs-identifier hs-var">TagState</span></a></span></span><span> </span><span id="local-6989586621679226481"><span class="annot"><a href="#local-6989586621679226481"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679226482"><span class="annot"><a href="#local-6989586621679226482"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagMap"><span class="hs-identifier hs-type">TagMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226481"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagSet"><span class="hs-identifier hs-type">TagSet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679226482"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span id="local-6989586621679225861"><span class="annot"><a href="Data.GraphViz.Algorithms.html#getMap"><span class="hs-identifier hs-type">getMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagState"><span class="hs-identifier hs-type">TagState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225861"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagMap"><span class="hs-identifier hs-type">TagMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225861"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-414"></span><span id="getMap"><span class="annot"><span class="annottext">getMap :: forall n. TagState n (TagMap n)
</span><a href="Data.GraphViz.Algorithms.html#getMap"><span class="hs-identifier hs-var hs-var">getMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TagMap n, TagSet) -&gt; TagMap n)
-&gt; StateT (TagMap n, TagSet) Identity (TagMap n)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">(TagMap n, TagSet) -&gt; TagMap n
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span id="local-6989586621679225816"><span id="local-6989586621679225818"><span class="annot"><a href="Data.GraphViz.Algorithms.html#getsMap"><span class="hs-identifier hs-type">getsMap</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagMap"><span class="hs-identifier hs-type">TagMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225816"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagState"><span class="hs-identifier hs-type">TagState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225816"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225818"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-417"></span><span id="getsMap"><span class="annot"><span class="annottext">getsMap :: forall n a. (TagMap n -&gt; a) -&gt; TagState n a
</span><a href="Data.GraphViz.Algorithms.html#getsMap"><span class="hs-identifier hs-var hs-var">getsMap</span></a></span></span><span> </span><span id="local-6989586621679226489"><span class="annot"><span class="annottext">TagMap n -&gt; a
</span><a href="#local-6989586621679226489"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TagMap n, TagSet) -&gt; a) -&gt; StateT (TagMap n, TagSet) Identity a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagMap n -&gt; a
</span><a href="#local-6989586621679226489"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(TagMap n -&gt; a)
-&gt; ((TagMap n, TagSet) -&gt; TagMap n) -&gt; (TagMap n, TagSet) -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TagMap n, TagSet) -&gt; TagMap n
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span id="local-6989586621679225871"><span class="annot"><a href="Data.GraphViz.Algorithms.html#modifyMap"><span class="hs-identifier hs-type">modifyMap</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagMap"><span class="hs-identifier hs-type">TagMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225871"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagMap"><span class="hs-identifier hs-type">TagMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225871"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagState"><span class="hs-identifier hs-type">TagState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225871"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-420"></span><span id="modifyMap"><span class="annot"><span class="annottext">modifyMap :: forall n. (TagMap n -&gt; TagMap n) -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#modifyMap"><span class="hs-identifier hs-var hs-var">modifyMap</span></a></span></span><span> </span><span id="local-6989586621679226494"><span class="annot"><span class="annottext">TagMap n -&gt; TagMap n
</span><a href="#local-6989586621679226494"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TagMap n, TagSet) -&gt; (TagMap n, TagSet))
-&gt; StateT (TagMap n, TagSet) Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TagMap n -&gt; TagMap n) -&gt; (TagMap n, TagSet) -&gt; (TagMap n, TagSet)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">TagMap n -&gt; TagMap n
</span><a href="#local-6989586621679226494"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span id="local-6989586621679225875"><span class="annot"><a href="Data.GraphViz.Algorithms.html#getSet"><span class="hs-identifier hs-type">getSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagState"><span class="hs-identifier hs-type">TagState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225875"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagSet"><span class="hs-identifier hs-type">TagSet</span></a></span></span><span>
</span><span id="line-423"></span><span id="getSet"><span class="annot"><span class="annottext">getSet :: forall n. TagState n TagSet
</span><a href="Data.GraphViz.Algorithms.html#getSet"><span class="hs-identifier hs-var hs-var">getSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TagMap n, TagSet) -&gt; TagSet)
-&gt; StateT (TagMap n, TagSet) Identity TagSet
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">(TagMap n, TagSet) -&gt; TagSet
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span id="local-6989586621679225877"><span class="annot"><a href="Data.GraphViz.Algorithms.html#modifySet"><span class="hs-identifier hs-type">modifySet</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagSet"><span class="hs-identifier hs-type">TagSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagSet"><span class="hs-identifier hs-type">TagSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagState"><span class="hs-identifier hs-type">TagState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225877"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-426"></span><span id="modifySet"><span class="annot"><span class="annottext">modifySet :: forall n. (TagSet -&gt; TagSet) -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#modifySet"><span class="hs-identifier hs-var hs-var">modifySet</span></a></span></span><span> </span><span id="local-6989586621679226502"><span class="annot"><span class="annottext">TagSet -&gt; TagSet
</span><a href="#local-6989586621679226502"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TagMap n, TagSet) -&gt; (TagMap n, TagSet))
-&gt; StateT (TagMap n, TagSet) Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TagSet -&gt; TagSet) -&gt; (TagMap n, TagSet) -&gt; (TagMap n, TagSet)
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">TagSet -&gt; TagSet
</span><a href="#local-6989586621679226502"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- Create the Map representing the graph from the edges.</span><span>
</span><span id="line-429"></span><span id="local-6989586621679225814"><span class="annot"><a href="Data.GraphViz.Algorithms.html#edgeGraph"><span class="hs-identifier hs-type">edgeGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225814"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TaggedEdge"><span class="hs-identifier hs-type">TaggedEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225814"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagState"><span class="hs-identifier hs-type">TagState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225814"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-430"></span><span id="edgeGraph"><span class="annot"><span class="annottext">edgeGraph :: forall n. Ord n =&gt; [TaggedEdge n] -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#edgeGraph"><span class="hs-identifier hs-var hs-var">edgeGraph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, DotEdge n) -&gt; StateT (TagMap n, TagSet) Identity ())
-&gt; [(Int, DotEdge n)] -&gt; StateT (TagMap n, TagSet) Identity ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, DotEdge n) -&gt; StateT (TagMap n, TagSet) Identity ()
forall {n}.
Ord n =&gt;
(Int, DotEdge n) -&gt; StateT (TagMap n, TagSet) Identity ()
</span><a href="#local-6989586621679226508"><span class="hs-identifier hs-var">addEdge</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, DotEdge n)] -&gt; StateT (TagMap n, TagSet) Identity ())
-&gt; ([(Int, DotEdge n)] -&gt; [(Int, DotEdge n)])
-&gt; [(Int, DotEdge n)]
-&gt; StateT (TagMap n, TagSet) Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, DotEdge n)] -&gt; [(Int, DotEdge n)]
forall a. [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-432"></span><span>    </span><span id="local-6989586621679226508"><span class="annot"><span class="annottext">addEdge :: (Int, DotEdge n) -&gt; StateT (TagMap n, TagSet) Identity ()
</span><a href="#local-6989586621679226508"><span class="hs-identifier hs-var hs-var">addEdge</span></a></span></span><span> </span><span id="local-6989586621679226517"><span class="annot"><span class="annottext">(Int, DotEdge n)
</span><a href="#local-6989586621679226517"><span class="hs-identifier hs-var">te</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; TaggedValues n -&gt; StateT (TagMap n, TagSet) Identity ()
forall {n}. Ord n =&gt; n -&gt; TaggedValues n -&gt; TagState n ()
</span><a href="#local-6989586621679226518"><span class="hs-identifier hs-var">addVal</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226519"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226520"><span class="hs-identifier hs-var">tvOut</span></a></span><span> </span><span class="annot"><span class="annottext">StateT (TagMap n, TagSet) Identity ()
-&gt; StateT (TagMap n, TagSet) Identity ()
-&gt; StateT (TagMap n, TagSet) Identity ()
forall a b.
StateT (TagMap n, TagSet) Identity a
-&gt; StateT (TagMap n, TagSet) Identity b
-&gt; StateT (TagMap n, TagSet) Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; TaggedValues n -&gt; StateT (TagMap n, TagSet) Identity ()
forall {n}. Ord n =&gt; n -&gt; TaggedValues n -&gt; TagState n ()
</span><a href="#local-6989586621679226518"><span class="hs-identifier hs-var">addVal</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226521"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226522"><span class="hs-identifier hs-var">tvIn</span></a></span><span>
</span><span id="line-433"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-434"></span><span>        </span><span id="local-6989586621679226523"><span class="annot"><span class="annottext">e :: DotEdge n
</span><a href="#local-6989586621679226523"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, DotEdge n) -&gt; DotEdge n
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, DotEdge n)
</span><a href="#local-6989586621679226517"><span class="hs-identifier hs-var">te</span></a></span><span>
</span><span id="line-435"></span><span>        </span><span id="local-6989586621679226519"><span class="annot"><span class="annottext">f :: n
</span><a href="#local-6989586621679226519"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#fromNode"><span class="hs-identifier hs-var">fromNode</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n
</span><a href="#local-6989586621679226523"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-436"></span><span>        </span><span id="local-6989586621679226521"><span class="annot"><span class="annottext">t :: n
</span><a href="#local-6989586621679226521"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#toNode"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n
</span><a href="#local-6989586621679226523"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-437"></span><span>        </span><span id="local-6989586621679226518"><span class="annot"><span class="annottext">addVal :: n -&gt; TaggedValues n -&gt; TagState n ()
</span><a href="#local-6989586621679226518"><span class="hs-identifier hs-var hs-var">addVal</span></a></span></span><span> </span><span id="local-6989586621679226530"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226530"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679226531"><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226531"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TagMap n -&gt; TagMap n) -&gt; TagState n ()
forall n. (TagMap n -&gt; TagMap n) -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#modifyMap"><span class="hs-identifier hs-var">modifyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n)
-&gt; n -&gt; TaggedValues n -&gt; TagMap n -&gt; TagMap n
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
forall {n}. TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
</span><a href="#local-6989586621679226533"><span class="hs-identifier hs-var">mergeTV</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226530"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226531"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>        </span><span id="local-6989586621679226522"><span class="annot"><span class="annottext">tvIn :: TaggedValues n
</span><a href="#local-6989586621679226522"><span class="hs-identifier hs-var hs-var">tvIn</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TaggedValues n
forall n. TaggedValues n
</span><a href="Data.GraphViz.Algorithms.html#defTV"><span class="hs-identifier hs-var">defTV</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#incoming"><span class="hs-identifier hs-var">incoming</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679226517"><span class="hs-identifier hs-type">te</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-439"></span><span>        </span><span id="local-6989586621679226520"><span class="annot"><span class="annottext">tvOut :: TaggedValues n
</span><a href="#local-6989586621679226520"><span class="hs-identifier hs-var hs-var">tvOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TaggedValues n
forall n. TaggedValues n
</span><a href="Data.GraphViz.Algorithms.html#defTV"><span class="hs-identifier hs-var">defTV</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var">outgoing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679226517"><span class="hs-identifier hs-type">te</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-440"></span><span>        </span><span id="local-6989586621679226533"><span class="annot"><span class="annottext">mergeTV :: TaggedValues n -&gt; TaggedValues n -&gt; TaggedValues n
</span><a href="#local-6989586621679226533"><span class="hs-identifier hs-var hs-var">mergeTV</span></a></span></span><span> </span><span id="local-6989586621679226534"><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226534"><span class="hs-identifier hs-var">tvNew</span></a></span></span><span> </span><span id="local-6989586621679226535"><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226535"><span class="hs-identifier hs-var">tv</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226535"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#incoming"><span class="hs-identifier hs-var">incoming</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#incoming"><span class="hs-identifier hs-var">incoming</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226534"><span class="hs-identifier hs-type">tvNew</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-type">++</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#incoming"><span class="hs-identifier hs-var">incoming</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226535"><span class="hs-identifier hs-type">tv</span></a></span><span>
</span><span id="line-441"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var">outgoing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var">outgoing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226534"><span class="hs-identifier hs-type">tvNew</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-type">++</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var">outgoing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226535"><span class="hs-identifier hs-type">tv</span></a></span><span>
</span><span id="line-442"></span><span>                               </span><span class="hs-special">}</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-comment">-- Perform a DFS to determine whether or not to keep each edge.</span><span>
</span><span id="line-445"></span><span id="local-6989586621679225825"><span class="annot"><a href="Data.GraphViz.Algorithms.html#traverseTag"><span class="hs-identifier hs-type">traverseTag</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225825"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225825"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#TagState"><span class="hs-identifier hs-type">TagState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225825"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-446"></span><span id="traverseTag"><span class="annot"><span class="annottext">traverseTag :: forall n. Ord n =&gt; Int -&gt; n -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#traverseTag"><span class="hs-identifier hs-var hs-var">traverseTag</span></a></span></span><span> </span><span id="local-6989586621679226547"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226547"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679226548"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226548"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TagState n ()
</span><a href="#local-6989586621679226549"><span class="hs-identifier hs-var">setMark</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-447"></span><span>                     </span><span class="annot"><span class="annottext">TagState n ()
</span><a href="#local-6989586621679226550"><span class="hs-identifier hs-var">checkIncoming</span></a></span><span>
</span><span id="line-448"></span><span>                     </span><span id="local-6989586621679226551"><span class="annot"><span class="annottext">[TaggedEdge n]
</span><a href="#local-6989586621679226551"><span class="hs-identifier hs-var">outEs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TagMap n -&gt; [TaggedEdge n]) -&gt; TagState n [TaggedEdge n]
forall n a. (TagMap n -&gt; a) -&gt; TagState n a
</span><a href="Data.GraphViz.Algorithms.html#getsMap"><span class="hs-identifier hs-var">getsMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TaggedEdge n]
-&gt; (TaggedValues n -&gt; [TaggedEdge n])
-&gt; Maybe (TaggedValues n)
-&gt; [TaggedEdge n]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">TaggedValues n -&gt; [TaggedEdge n]
forall n. TaggedValues n -&gt; [TaggedEdge n]
</span><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var">outgoing</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (TaggedValues n) -&gt; [TaggedEdge n])
-&gt; (TagMap n -&gt; Maybe (TaggedValues n))
-&gt; TagMap n
-&gt; [TaggedEdge n]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; TagMap n -&gt; Maybe (TaggedValues n)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226548"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>                     </span><span class="annot"><span class="annottext">(TaggedEdge n -&gt; TagState n ()) -&gt; [TaggedEdge n] -&gt; TagState n ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedEdge n -&gt; TagState n ()
forall {n}.
Ord n =&gt;
(Int, DotEdge n) -&gt; StateT (TagMap n, TagSet) Identity ()
</span><a href="#local-6989586621679226553"><span class="hs-identifier hs-var">maybeRecurse</span></a></span><span> </span><span class="annot"><span class="annottext">[TaggedEdge n]
</span><a href="#local-6989586621679226551"><span class="hs-identifier hs-var">outEs</span></a></span><span>
</span><span id="line-450"></span><span>                     </span><span class="annot"><span class="annottext">Bool -&gt; TagState n ()
</span><a href="#local-6989586621679226549"><span class="hs-identifier hs-var">setMark</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621679226549"><span class="annot"><span class="annottext">setMark :: Bool -&gt; TagState n ()
</span><a href="#local-6989586621679226549"><span class="hs-identifier hs-var hs-var">setMark</span></a></span></span><span> </span><span id="local-6989586621679226556"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679226556"><span class="hs-identifier hs-var">mrk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TagMap n -&gt; TagMap n) -&gt; TagState n ()
forall n. (TagMap n -&gt; TagMap n) -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#modifyMap"><span class="hs-identifier hs-var">modifyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TaggedValues n -&gt; TaggedValues n) -&gt; n -&gt; TagMap n -&gt; TagMap n
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679226558"><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226558"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226558"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#marked"><span class="hs-identifier hs-var">marked</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679226556"><span class="hs-identifier hs-type">mrk</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226548"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span>    </span><span id="local-6989586621679226563"><span class="annot"><span class="annottext">isMarked :: Map k (TaggedValues n) -&gt; k -&gt; Bool
</span><a href="#local-6989586621679226563"><span class="hs-identifier hs-var hs-var">isMarked</span></a></span></span><span> </span><span id="local-6989586621679226564"><span class="annot"><span class="annottext">Map k (TaggedValues n)
</span><a href="#local-6989586621679226564"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679226565"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679226565"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (TaggedValues n -&gt; Bool) -&gt; Maybe (TaggedValues n) -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedValues n -&gt; Bool
forall n. TaggedValues n -&gt; Bool
</span><a href="Data.GraphViz.Algorithms.html#marked"><span class="hs-identifier hs-var">marked</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (TaggedValues n) -&gt; Bool) -&gt; Maybe (TaggedValues n) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679226565"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k (TaggedValues n) -&gt; Maybe (TaggedValues n)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-operator hs-var">`Map.lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (TaggedValues n)
</span><a href="#local-6989586621679226564"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span>    </span><span id="local-6989586621679226550"><span class="annot"><span class="annottext">checkIncoming :: TagState n ()
</span><a href="#local-6989586621679226550"><span class="hs-identifier hs-var hs-var">checkIncoming</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679226578"><span class="annot"><span class="annottext">TagMap n
</span><a href="#local-6989586621679226578"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((TagMap n, TagSet) -&gt; TagMap n)
-&gt; StateT (TagMap n, TagSet) Identity (TagMap n)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">(TagMap n, TagSet) -&gt; TagMap n
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-457"></span><span>                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226581"><span class="annot"><span class="annottext">es :: [TaggedEdge n]
</span><a href="#local-6989586621679226581"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TaggedValues n -&gt; [TaggedEdge n]
forall n. TaggedValues n -&gt; [TaggedEdge n]
</span><a href="Data.GraphViz.Algorithms.html#incoming"><span class="hs-identifier hs-var">incoming</span></a></span><span> </span><span class="annot"><span class="annottext">(TaggedValues n -&gt; [TaggedEdge n])
-&gt; TaggedValues n -&gt; [TaggedEdge n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TagMap n
</span><a href="#local-6989586621679226578"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TagMap n -&gt; n -&gt; TaggedValues n
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226548"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-458"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621679226584"><span class="annot"><span class="annottext">[TaggedEdge n]
</span><a href="#local-6989586621679226584"><span class="hs-identifier hs-var">keepEs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679226585"><span class="annot"><span class="annottext">[TaggedEdge n]
</span><a href="#local-6989586621679226585"><span class="hs-identifier hs-var">delEs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TaggedEdge n -&gt; Bool)
-&gt; [TaggedEdge n] -&gt; ([TaggedEdge n], [TaggedEdge n])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagMap n -&gt; TaggedEdge n -&gt; Bool
forall {k} {n}.
Ord k =&gt;
Map k (TaggedValues n) -&gt; (Int, DotEdge k) -&gt; Bool
</span><a href="#local-6989586621679226586"><span class="hs-identifier hs-var">keepEdge</span></a></span><span> </span><span class="annot"><span class="annottext">TagMap n
</span><a href="#local-6989586621679226578"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TaggedEdge n]
</span><a href="#local-6989586621679226581"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-459"></span><span>                       </span><span class="annot"><span class="annottext">(TagMap n -&gt; TagMap n) -&gt; TagState n ()
forall n. (TagMap n -&gt; TagMap n) -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#modifyMap"><span class="hs-identifier hs-var">modifyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TaggedValues n -&gt; TaggedValues n) -&gt; n -&gt; TagMap n -&gt; TagMap n
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679226587"><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226587"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226587"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#incoming"><span class="hs-identifier hs-var">incoming</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679226584"><span class="hs-identifier hs-type">keepEs</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226548"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>                       </span><span class="annot"><span class="annottext">(TagSet -&gt; TagSet) -&gt; TagState n ()
forall n. (TagSet -&gt; TagSet) -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#modifySet"><span class="hs-identifier hs-var">modifySet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagSet -&gt; TagSet -&gt; TagSet
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">(TagSet -&gt; TagSet -&gt; TagSet) -&gt; TagSet -&gt; TagSet -&gt; TagSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; TagSet
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TaggedEdge n -&gt; Int) -&gt; [TaggedEdge n] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedEdge n -&gt; Int
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[TaggedEdge n]
</span><a href="#local-6989586621679226585"><span class="hs-identifier hs-var">delEs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>                       </span><span class="annot"><span class="annottext">(TaggedEdge n -&gt; TagState n ()) -&gt; [TaggedEdge n] -&gt; TagState n ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedEdge n -&gt; TagState n ()
forall {n}.
Ord n =&gt;
(Int, DotEdge n) -&gt; StateT (TagMap n, TagSet) Identity ()
</span><a href="#local-6989586621679226588"><span class="hs-identifier hs-var">delOtherEdge</span></a></span><span> </span><span class="annot"><span class="annottext">[TaggedEdge n]
</span><a href="#local-6989586621679226585"><span class="hs-identifier hs-var">delEs</span></a></span><span>
</span><span id="line-462"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621679226586"><span class="annot"><span class="annottext">keepEdge :: Map k (TaggedValues n) -&gt; (Int, DotEdge k) -&gt; Bool
</span><a href="#local-6989586621679226586"><span class="hs-identifier hs-var hs-var">keepEdge</span></a></span></span><span> </span><span id="local-6989586621679226594"><span class="annot"><span class="annottext">Map k (TaggedValues n)
</span><a href="#local-6989586621679226594"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679226595"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226595"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679226596"><span class="annot"><span class="annottext">DotEdge k
</span><a href="#local-6989586621679226596"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226547"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226595"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k (TaggedValues n) -&gt; k -&gt; Bool
forall {k} {n}. Ord k =&gt; Map k (TaggedValues n) -&gt; k -&gt; Bool
</span><a href="#local-6989586621679226563"><span class="hs-identifier hs-var">isMarked</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (TaggedValues n)
</span><a href="#local-6989586621679226594"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; k -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge k -&gt; k
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#fromNode"><span class="hs-identifier hs-var">fromNode</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge k
</span><a href="#local-6989586621679226596"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>        </span><span id="local-6989586621679226588"><span class="annot"><span class="annottext">delOtherEdge :: (Int, DotEdge n) -&gt; TagState n ()
</span><a href="#local-6989586621679226588"><span class="hs-identifier hs-var hs-var">delOtherEdge</span></a></span></span><span> </span><span id="local-6989586621679226601"><span class="annot"><span class="annottext">(Int, DotEdge n)
</span><a href="#local-6989586621679226601"><span class="hs-identifier hs-var">te</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TagMap n -&gt; TagMap n) -&gt; TagState n ()
forall n. (TagMap n -&gt; TagMap n) -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#modifyMap"><span class="hs-identifier hs-var">modifyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TaggedValues n -&gt; TaggedValues n) -&gt; n -&gt; TagMap n -&gt; TagMap n
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">TaggedValues n -&gt; TaggedValues n
</span><a href="#local-6989586621679226602"><span class="hs-identifier hs-var">delE</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; TagMap n -&gt; TagMap n)
-&gt; (DotEdge n -&gt; n) -&gt; DotEdge n -&gt; TagMap n -&gt; TagMap n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#fromNode"><span class="hs-identifier hs-var">fromNode</span></a></span><span> </span><span class="annot"><span class="annottext">(DotEdge n -&gt; TagMap n -&gt; TagMap n)
-&gt; DotEdge n -&gt; TagMap n -&gt; TagMap n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, DotEdge n) -&gt; DotEdge n
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, DotEdge n)
</span><a href="#local-6989586621679226601"><span class="hs-identifier hs-var">te</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-467"></span><span>            </span><span id="local-6989586621679226602"><span class="annot"><span class="annottext">delE :: TaggedValues n -&gt; TaggedValues n
</span><a href="#local-6989586621679226602"><span class="hs-identifier hs-var hs-var">delE</span></a></span></span><span> </span><span id="local-6989586621679226604"><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226604"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TaggedValues n
</span><a href="#local-6989586621679226604"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var">outgoing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#deleteBy"><span class="hs-identifier hs-type">deleteBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">(==)</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html#on"><span class="hs-operator hs-type">`on`</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-type">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679226601"><span class="hs-identifier hs-type">te</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="Data.GraphViz.Algorithms.html#outgoing"><span class="hs-identifier hs-var">outgoing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226604"><span class="hs-identifier hs-type">tv</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>    </span><span id="local-6989586621679226553"><span class="annot"><span class="annottext">maybeRecurse :: (Int, DotEdge n) -&gt; StateT (TagMap n, TagSet) Identity ()
</span><a href="#local-6989586621679226553"><span class="hs-identifier hs-var hs-var">maybeRecurse</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679226618"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226618"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679226619"><span class="annot"><span class="annottext">DotEdge n
</span><a href="#local-6989586621679226619"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679226620"><span class="annot"><span class="annottext">TagMap n
</span><a href="#local-6989586621679226620"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TagState n (TagMap n)
forall n. TagState n (TagMap n)
</span><a href="Data.GraphViz.Algorithms.html#getMap"><span class="hs-identifier hs-var">getMap</span></a></span><span>
</span><span id="line-470"></span><span>                             </span><span id="local-6989586621679226621"><span class="annot"><span class="annottext">TagSet
</span><a href="#local-6989586621679226621"><span class="hs-identifier hs-var">delSet</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TagState n TagSet
forall n. TagState n TagSet
</span><a href="Data.GraphViz.Algorithms.html#getSet"><span class="hs-identifier hs-var">getSet</span></a></span><span>
</span><span id="line-471"></span><span>                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226622"><span class="annot"><span class="annottext">n' :: n
</span><a href="#local-6989586621679226622"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DotEdge n -&gt; n
forall n. DotEdge n -&gt; n
</span><a href="Data.GraphViz.Types.Internal.Common.html#toNode"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">DotEdge n
</span><a href="#local-6989586621679226619"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-472"></span><span>                             </span><span class="annot"><span class="annottext">Bool
-&gt; StateT (TagMap n, TagSet) Identity ()
-&gt; StateT (TagMap n, TagSet) Identity ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TagMap n -&gt; n -&gt; Bool
forall {k} {n}. Ord k =&gt; Map k (TaggedValues n) -&gt; k -&gt; Bool
</span><a href="#local-6989586621679226563"><span class="hs-identifier hs-var">isMarked</span></a></span><span> </span><span class="annot"><span class="annottext">TagMap n
</span><a href="#local-6989586621679226620"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226622"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226618"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; TagSet -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">TagSet
</span><a href="#local-6989586621679226621"><span class="hs-identifier hs-var">delSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>                               </span><span class="annot"><span class="annottext">(StateT (TagMap n, TagSet) Identity ()
 -&gt; StateT (TagMap n, TagSet) Identity ())
-&gt; StateT (TagMap n, TagSet) Identity ()
-&gt; StateT (TagMap n, TagSet) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; n -&gt; StateT (TagMap n, TagSet) Identity ()
forall n. Ord n =&gt; Int -&gt; n -&gt; TagState n ()
</span><a href="Data.GraphViz.Algorithms.html#traverseTag"><span class="hs-identifier hs-var">traverseTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226618"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679226622"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-474"></span></pre></body></html>