<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Network.DNS.IO</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">dns-4.2.0: DNS library in Haskell</span><ul class="links" id="page-menu"><li><a href="src/Network.DNS.IO.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Network.DNS.IO</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Receiving DNS messages</a></li><li><a href="#g:2">Sending pre-encoded messages</a><ul><li><a href="#g:3">Encoding queries for transmission</a></li><li><a href="#g:4">Creating query response messages</a></li></ul></li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:receive">receive</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></li><li class="src short"><a href="#v:receiveFrom">receiveFrom</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a>, SockAddr)</li><li class="src short"><a href="#v:receiveVC">receiveVC</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></li><li class="src short"><a href="#v:send">send</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:sendTo">sendTo</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; SockAddr -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:sendVC">sendVC</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:sendAll">sendAll</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:encodeQuestion">encodeQuestion</a> :: <a href="Network-DNS-Types.html#t:Identifier" title="Network.DNS.Types">Identifier</a> -&gt; <a href="Network-DNS-Types.html#t:Question" title="Network.DNS.Types">Question</a> -&gt; <a href="Network-DNS-Types.html#t:QueryControls" title="Network.DNS.Types">QueryControls</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:encodeVC">encodeVC</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:responseA">responseA</a> :: <a href="Network-DNS-Types.html#t:Identifier" title="Network.DNS.Types">Identifier</a> -&gt; <a href="Network-DNS-Types.html#t:Question" title="Network.DNS.Types">Question</a> -&gt; [IPv4] -&gt; <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></li><li class="src short"><a href="#v:responseAAAA">responseAAAA</a> :: <a href="Network-DNS-Types.html#t:Identifier" title="Network.DNS.Types">Identifier</a> -&gt; <a href="Network-DNS-Types.html#t:Question" title="Network.DNS.Types">Question</a> -&gt; [IPv6] -&gt; <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Receiving DNS messages</h1></a><div class="top"><p class="src"><a id="v:receive" class="def">receive</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a> <a href="src/Network.DNS.IO.html#receive" class="link">Source</a> <a href="#v:receive" class="selflink">#</a></p><div class="doc"><p>Receive and decode a single <code><a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></code> from a UDP <code>Socket</code>, throwing away
 the client address.  Messages longer than <code><a href="Network-DNS-Types.html#v:maxUdpSize" title="Network.DNS.Types">maxUdpSize</a></code> are silently
 truncated, but this should not occur in practice, since we cap the advertised
 EDNS UDP buffer size limit at the same value.  A <code><a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a></code> is raised if I/O
 or message decoding fails.</p></div></div><div class="top"><p class="src"><a id="v:receiveFrom" class="def">receiveFrom</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a>, SockAddr) <a href="src/Network.DNS.IO.html#receiveFrom" class="link">Source</a> <a href="#v:receiveFrom" class="selflink">#</a></p><div class="doc"><p>Receive and decode a single <code><a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></code> from a UDP <code>Socket</code>.  Messages
 longer than <code><a href="Network-DNS-Types.html#v:maxUdpSize" title="Network.DNS.Types">maxUdpSize</a></code> are silently truncated, but this should not occur
 in practice, since we cap the advertised EDNS UDP buffer size limit at the
 same value.  A <code><a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a></code> is raised if I/O or message decoding fails.</p></div></div><div class="top"><p class="src"><a id="v:receiveVC" class="def">receiveVC</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a> <a href="src/Network.DNS.IO.html#receiveVC" class="link">Source</a> <a href="#v:receiveVC" class="selflink">#</a></p><div class="doc"><p>Receive and decode a single <code>DNSMesage</code> from a virtual-circuit (TCP).  It
 is up to the caller to implement any desired timeout. An <code><a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a></code> is
 raised if I/O or message decoding fails.</p></div></div><a href="#g:2" id="g:2"><h1>Sending pre-encoded messages</h1></a><div class="top"><p class="src"><a id="v:send" class="def">send</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Network.DNS.IO.html#send" class="link">Source</a> <a href="#v:send" class="selflink">#</a></p><div class="doc"><p>Send an encoded <code><a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></code> datagram over UDP.  The message length is
 implicit in the size of the UDP datagram.  With TCP you must use <code><a href="Network-DNS-IO.html#v:sendVC" title="Network.DNS.IO">sendVC</a></code>,
 because TCP does not have message boundaries, and each message needs to be
 prepended with an explicit length.  The socket must be explicitly connected
 to the destination nameserver.</p></div></div><div class="top"><p class="src"><a id="v:sendTo" class="def">sendTo</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; SockAddr -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Network.DNS.IO.html#sendTo" class="link">Source</a> <a href="#v:sendTo" class="selflink">#</a></p><div class="doc"><p>Send an encoded <code><a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></code> datagram over UDP to a given address.  The
 message length is implicit in the size of the UDP datagram.  With TCP you
 must use <code><a href="Network-DNS-IO.html#v:sendVC" title="Network.DNS.IO">sendVC</a></code>, because TCP does not have message boundaries, and each
 message needs to be prepended with an explicit length.</p></div></div><div class="top"><p class="src"><a id="v:sendVC" class="def">sendVC</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Network.DNS.IO.html#sendVC" class="link">Source</a> <a href="#v:sendVC" class="selflink">#</a></p><div class="doc"><p>Send a single encoded <code><a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></code> over TCP.  An explicit length is
 prepended to the encoded buffer before transmission.  If you want to
 send a batch of multiple encoded messages back-to-back over a single
 TCP connection, and then loop to collect the results, use <code><a href="Network-DNS-IO.html#v:encodeVC" title="Network.DNS.IO">encodeVC</a></code>
 to prefix each message with a length, and then use <code><a href="Network-DNS-IO.html#v:sendAll" title="Network.DNS.IO">sendAll</a></code> to send
 a concatenated batch of the resulting encapsulated messages.</p></div></div><div class="top"><p class="src"><a id="v:sendAll" class="def">sendAll</a> :: Socket -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Network.DNS.IO.html#sendAll" class="link">Source</a> <a href="#v:sendAll" class="selflink">#</a></p><div class="doc"><p>Send one or more encoded <code><a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></code> buffers over TCP, each allready
 encapsulated with an explicit length prefix (perhaps via <code><a href="Network-DNS-IO.html#v:encodeVC" title="Network.DNS.IO">encodeVC</a></code>) and
 then concatenated into a single buffer.  DO NOT use <code><a href="Network-DNS-IO.html#v:sendAll" title="Network.DNS.IO">sendAll</a></code> with UDP.</p></div></div><a href="#g:3" id="g:3"><h2>Encoding queries for transmission</h2></a><div class="top"><p class="src"><a id="v:encodeQuestion" class="def">encodeQuestion</a> <a href="src/Network.DNS.IO.html#encodeQuestion" class="link">Source</a> <a href="#v:encodeQuestion" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Network-DNS-Types.html#t:Identifier" title="Network.DNS.Types">Identifier</a></td><td class="doc"><p>Crypto random request id</p></td></tr><tr><td class="src">-&gt; <a href="Network-DNS-Types.html#t:Question" title="Network.DNS.Types">Question</a></td><td class="doc"><p>Query name and type</p></td></tr><tr><td class="src">-&gt; <a href="Network-DNS-Types.html#t:QueryControls" title="Network.DNS.Types">QueryControls</a></td><td class="doc"><p>Query flag and EDNS overrides</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>The encoded <code><a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></code> has the specified request ID.  The default values
 of the RD, AD, CD and DO flag bits, as well as various EDNS features, can be
 adjusted via the <code><a href="Network-DNS-Types.html#t:QueryControls" title="Network.DNS.Types">QueryControls</a></code> parameter.</p><p>The caller is responsible for generating the ID via a securely seeded
 CSPRNG.</p></div></div><div class="top"><p class="src"><a id="v:encodeVC" class="def">encodeVC</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.DNS.IO.html#encodeVC" class="link">Source</a> <a href="#v:encodeVC" class="selflink">#</a></p><div class="doc"><p>Encapsulate an encoded <code><a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></code> buffer for transmission over a TCP
 virtual circuit.  With TCP the buffer needs to start with an explicit
 length (the length is implicit with UDP).</p></div></div><a href="#g:4" id="g:4"><h2>Creating query response messages</h2></a><div class="top"><p class="src"><a id="v:responseA" class="def">responseA</a> :: <a href="Network-DNS-Types.html#t:Identifier" title="Network.DNS.Types">Identifier</a> -&gt; <a href="Network-DNS-Types.html#t:Question" title="Network.DNS.Types">Question</a> -&gt; [IPv4] -&gt; <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a> <a href="src/Network.DNS.IO.html#responseA" class="link">Source</a> <a href="#v:responseA" class="selflink">#</a></p><div class="doc"><p>Compose a response with a single IPv4 RRset.  If the query
 had an EDNS pseudo-header, a suitable EDNS pseudo-header must
 be added to the response message, or else a <code><a href="Network-DNS-Types.html#v:FormatErr" title="Network.DNS.Types">FormatErr</a></code> response
 must be sent.  The response TTL defaults to 300 seconds, and
 should be updated (to the same value across all the RRs) if some
 other TTL value is more appropriate.</p></div></div><div class="top"><p class="src"><a id="v:responseAAAA" class="def">responseAAAA</a> :: <a href="Network-DNS-Types.html#t:Identifier" title="Network.DNS.Types">Identifier</a> -&gt; <a href="Network-DNS-Types.html#t:Question" title="Network.DNS.Types">Question</a> -&gt; [IPv6] -&gt; <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a> <a href="src/Network.DNS.IO.html#responseAAAA" class="link">Source</a> <a href="#v:responseAAAA" class="selflink">#</a></p><div class="doc"><p>Compose a response with a single IPv6 RRset.  If the query
 had an EDNS pseudo-header, a suitable EDNS pseudo-header must
 be added to the response message, or else a <code><a href="Network-DNS-Types.html#v:FormatErr" title="Network.DNS.Types">FormatErr</a></code> response
 must be sent.  The response TTL defaults to 300 seconds, and
 should be updated (to the same value across all the RRs) if some
 other TTL value is more appropriate.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>