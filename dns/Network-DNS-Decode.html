<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Network.DNS.Decode</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">dns-4.2.0: DNS library in Haskell</span><ul class="links" id="page-menu"><li><a href="src/Network.DNS.Decode.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Network.DNS.Decode</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Decoding a single DNS message</a></li><li><a href="#g:2">Decoding multple length-encoded DNS messages,</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>DNS message decoders.</p><p>When in doubt, use the <code><a href="Network-DNS-Decode.html#v:decodeAt" title="Network.DNS.Decode">decodeAt</a></code> or <code><a href="Network-DNS-Decode.html#v:decodeManyAt" title="Network.DNS.Decode">decodeManyAt</a></code> functions, which
 correctly handle <em>circle-arithmetic</em> DNS timestamps, e.g., in <code>RRSIG</code>
 resource records.  The <code><a href="Network-DNS-Decode.html#v:decode" title="Network.DNS.Decode">decode</a></code>, and <code><a href="Network-DNS-Decode.html#v:decodeMany" title="Network.DNS.Decode">decodeMany</a></code> functions are only
 appropriate in pure contexts when the current time is not available, and
 <code>RRSIG</code> records are not expected or desired.</p><p>The <code><a href="Network-DNS-Decode.html#v:decodeMany" title="Network.DNS.Decode">decodeMany</a></code> and <code><a href="Network-DNS-Decode.html#v:decodeManyAt" title="Network.DNS.Decode">decodeManyAt</a></code> functions decode a buffer holding one or
 more messages, each preceded by 16-bit length in network byte order.  This
 encoding is generally only appropriate for DNS TCP, and because TCP does not
 preserve message boundaries, the decode is prepared to return a trailing
 message fragment to be completed and retried when more input arrives from
 network.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:decodeAt">decodeAt</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int64" title="Data.Int">Int64</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a> <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></li><li class="src short"><a href="#v:decode">decode</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a> <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></li><li class="src short"><a href="#v:decodeManyAt">decodeManyAt</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int64" title="Data.Int">Int64</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a> ([<a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a>], <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)</li><li class="src short"><a href="#v:decodeMany">decodeMany</a> :: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a> ([<a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a>], <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Decoding a single DNS message</h1></a><div class="top"><p class="src"><a id="v:decodeAt" class="def">decodeAt</a> <a href="src/Network.DNS.Decode.html#decodeAt" class="link">Source</a> <a href="#v:decodeAt" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int64" title="Data.Int">Int64</a></td><td class="doc"><p>current epoch time</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>encoded input buffer</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a> <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></td><td class="doc"><p>decoded message or error</p></td></tr></table></div><div class="doc"><p>Decode an input buffer containing a single encoded DNS message.  If the
 input buffer has excess content beyond the end of the message an error is
 returned.  DNS <em>circle-arithmetic</em> timestamps (e.g. in RRSIG records) are
 interpreted at the supplied epoch time.</p></div></div><div class="top"><p class="src"><a id="v:decode" class="def">decode</a> <a href="src/Network.DNS.Decode.html#decode" class="link">Source</a> <a href="#v:decode" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>encoded input buffer</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a> <a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a></td><td class="doc"><p>decoded message or error</p></td></tr></table></div><div class="doc"><p>Decode an input buffer containing a single encoded DNS message.  If the
 input buffer has excess content beyond the end of the message an error is
 returned.  DNS <em>circle-arithmetic</em> timestamps (e.g. in RRSIG records) are
 interpreted based on a nominal time in the year 2073 chosen to maximize
 the time range for which this gives correct translations of 32-bit epoch
 times to absolute 64-bit epoch times.  This will yield incorrect results
 starting circa 2141.</p></div></div><a href="#g:2" id="g:2"><h1>Decoding multple length-encoded DNS messages,</h1></a><div class="top"><p class="src"><a id="v:decodeManyAt" class="def">decodeManyAt</a> <a href="src/Network.DNS.Decode.html#decodeManyAt" class="link">Source</a> <a href="#v:decodeManyAt" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Int.html#t:Int64" title="Data.Int">Int64</a></td><td class="doc"><p>current epoch time</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>encoded input buffer</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a> ([<a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a>], <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)</td><td class="doc"><p>decoded messages and left-over partial message
 or error if any complete message fails to parse.</p></td></tr></table></div><div class="doc"><p>Decode a buffer containing multiple encoded DNS messages each preceded by
 a 16-bit length in network byte order.  Any left-over bytes of a partial
 message after the last complete message are returned as the second element
 of the result tuple.  DNS <em>circle-arithmetic</em> timestamps (e.g. in RRSIG
 records) are interpreted at the supplied epoch time.</p></div></div><div class="top"><p class="src"><a id="v:decodeMany" class="def">decodeMany</a> <a href="src/Network.DNS.Decode.html#decodeMany" class="link">Source</a> <a href="#v:decodeMany" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>encoded input buffer</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Network-DNS-Types.html#t:DNSError" title="Network.DNS.Types">DNSError</a> ([<a href="Network-DNS-Types.html#t:DNSMessage" title="Network.DNS.Types">DNSMessage</a>], <a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)</td><td class="doc"><p>decoded messages and left-over partial message
 or error if any complete message fails to parse.</p></td></tr></table></div><div class="doc"><p>Decode a buffer containing multiple encoded DNS messages each preceded by
 a 16-bit length in network byte order.  Any left-over bytes of a partial
 message after the last complete message are returned as the second element
 of the result tuple.  DNS <em>circle-arithmetic</em> timestamps (e.g. in RRSIG
 records) are interpreted based on a nominal time in the year 2078 chosen to
 give correct dates for DNS timestamps over a 136 year time range from the
 date the root zone was signed on the 15th of July 2010 until the 21st of
 August in 2146.  Outside this date range the output is off by some non-zero
 multiple 2^32 seconds.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>