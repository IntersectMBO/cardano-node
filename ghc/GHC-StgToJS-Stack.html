<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.StgToJS.Stack</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ghc-9.6.7: The GHC API</span><ul class="links" id="page-menu"><li><a href="src/GHC.StgToJS.Stack.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) The University of Glasgow 2001</td></tr><tr><th>License</th><td>BSD-style (see the file LICENSE)</td></tr><tr><th>Maintainer</th><td>Jeffrey Young  &lt;jeffrey.young@iohk.io&gt;
                Luite Stegeman &lt;luite.stegeman@iohk.io&gt;
                Sylvain Henry  &lt;sylvain.henry@iohk.io&gt;
                Josh Meredith  &lt;josh.meredith@iohk.io&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.StgToJS.Stack</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Thunk update</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Utilities and wrappers for Stack manipulation in JS Land.</p><p>In general, functions suffixed with a tick do the actual work, functions
 suffixed with an <a href="I.html">I</a> are identical to the non-I versions but work on <code><a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a></code>s</p><p>The stack in JS land is held in the special JS array 'h$stack' and the stack
 pointer is held in 'h$sp'. The top of the stack thus exists at
 'h$stack[h$sp]'. h$stack[h$sp + i] where i &gt; 0, moves deeper into the stack
 into older entries, whereas h$stack[h$sp - i] moves towards the top of the
 stack.</p><p>The stack layout algorithm is slightly peculiar. It makes an effort to
 remember recently popped things so that if these values need to be pushed
 then they can be quickly. The implementation for this is storing these values
 above the stack pointer, and the pushing will skip slots that we know we will
 use and fill in slots marked as unknown. Thus, you may find that our push and
 pop functions do some non-traditional stack manipulation such as adding slots
 in pop or removing slots in push.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:resetSlots">resetSlots</a> :: <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> a -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> a</li><li class="src short"><a href="#v:isolateSlots">isolateSlots</a> :: <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> a -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> a</li><li class="src short"><a href="#v:setSlots">setSlots</a> :: [<a href="GHC-StgToJS-Types.html#t:StackSlot" title="GHC.StgToJS.Types">StackSlot</a>] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> ()</li><li class="src short"><a href="#v:getSlots">getSlots</a> :: <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> [<a href="GHC-StgToJS-Types.html#t:StackSlot" title="GHC.StgToJS.Types">StackSlot</a>]</li><li class="src short"><a href="#v:addSlots">addSlots</a> :: [<a href="GHC-StgToJS-Types.html#t:StackSlot" title="GHC.StgToJS.Types">StackSlot</a>] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> ()</li><li class="src short"><a href="#v:dropSlots">dropSlots</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> ()</li><li class="src short"><a href="#v:addUnknownSlots">addUnknownSlots</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> ()</li><li class="src short"><a href="#v:push">push</a> :: [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:push-39-">push'</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:adjSpN">adjSpN</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:adjSpN-39-">adjSpN'</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:adjSp-39-">adjSp'</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:adjSp">adjSp</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:pushNN">pushNN</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Integer" title="GHC.Prelude.Basic">Integer</a> <a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a></li><li class="src short"><a href="#v:pushNN-39-">pushNN'</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Integer" title="GHC.Prelude.Basic">Integer</a> <a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a></li><li class="src short"><a href="#v:pushN-39-">pushN'</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> <a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a></li><li class="src short"><a href="#v:pushN">pushN</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> <a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a></li><li class="src short"><a href="#v:pushOptimized-39-">pushOptimized'</a> :: [(<a href="GHC-Types-Var.html#t:Id" title="GHC.Types.Var">Id</a>, <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a>)] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:pushOptimized">pushOptimized</a> :: [(<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>, <a href="GHC-Prelude-Basic.html#t:Bool" title="GHC.Prelude.Basic">Bool</a>)] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:pushLneFrame">pushLneFrame</a> :: <a href="GHC-Utils-Misc.html#t:HasDebugCallStack" title="GHC.Utils.Misc">HasDebugCallStack</a> =&gt; <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-ExprCtx.html#t:ExprCtx" title="GHC.StgToJS.ExprCtx">ExprCtx</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:popN">popN</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:popSkip">popSkip</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:popSkipI">popSkipI</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; [(<a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a>, <a href="GHC-StgToJS-Types.html#t:StackSlot" title="GHC.StgToJS.Types">StackSlot</a>)] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:loadSkip">loadSkip</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:updateThunk">updateThunk</a> :: <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:updateThunk-39-">updateThunk'</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:bhStats">bhStats</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-Prelude-Basic.html#t:Bool" title="GHC.Prelude.Basic">Bool</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:resetSlots" class="def">resetSlots</a> :: <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> a -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> a <a href="src/GHC.StgToJS.Stack.html#resetSlots" class="link">Source</a> <a href="#v:resetSlots" class="selflink">#</a></p><div class="doc"><p>Run the action, <code>m</code>, with no stack info</p></div></div><div class="top"><p class="src"><a id="v:isolateSlots" class="def">isolateSlots</a> :: <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> a -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> a <a href="src/GHC.StgToJS.Stack.html#isolateSlots" class="link">Source</a> <a href="#v:isolateSlots" class="selflink">#</a></p><div class="doc"><p>run the action, <code>m</code>, with current stack info, but don't let modifications
 propagate</p></div></div><div class="top"><p class="src"><a id="v:setSlots" class="def">setSlots</a> :: [<a href="GHC-StgToJS-Types.html#t:StackSlot" title="GHC.StgToJS.Types">StackSlot</a>] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> () <a href="src/GHC.StgToJS.Stack.html#setSlots" class="link">Source</a> <a href="#v:setSlots" class="selflink">#</a></p><div class="doc"><p>overwrite our stack knowledge</p></div></div><div class="top"><p class="src"><a id="v:getSlots" class="def">getSlots</a> :: <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> [<a href="GHC-StgToJS-Types.html#t:StackSlot" title="GHC.StgToJS.Types">StackSlot</a>] <a href="src/GHC.StgToJS.Stack.html#getSlots" class="link">Source</a> <a href="#v:getSlots" class="selflink">#</a></p><div class="doc"><p>retrieve our current stack knowledge</p></div></div><div class="top"><p class="src"><a id="v:addSlots" class="def">addSlots</a> :: [<a href="GHC-StgToJS-Types.html#t:StackSlot" title="GHC.StgToJS.Types">StackSlot</a>] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> () <a href="src/GHC.StgToJS.Stack.html#addSlots" class="link">Source</a> <a href="#v:addSlots" class="selflink">#</a></p><div class="doc"><p>add knowledge about the stack slots</p></div></div><div class="top"><p class="src"><a id="v:dropSlots" class="def">dropSlots</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> () <a href="src/GHC.StgToJS.Stack.html#dropSlots" class="link">Source</a> <a href="#v:dropSlots" class="selflink">#</a></p><div class="doc"><p>drop <code>n</code> slots from our stack knowledge</p></div></div><div class="top"><p class="src"><a id="v:addUnknownSlots" class="def">addUnknownSlots</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> () <a href="src/GHC.StgToJS.Stack.html#addUnknownSlots" class="link">Source</a> <a href="#v:addUnknownSlots" class="selflink">#</a></p><div class="doc"><p>add <code>n</code> unknown slots to our stack knowledge</p></div></div><div class="top"><p class="src"><a id="v:push" class="def">push</a> :: [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#push" class="link">Source</a> <a href="#v:push" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:push-39-" class="def">push'</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#push%27" class="link">Source</a> <a href="#v:push-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:adjSpN" class="def">adjSpN</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#adjSpN" class="link">Source</a> <a href="#v:adjSpN" class="selflink">#</a></p><div class="doc"><p>Shrink the stack and stack pointer. NB: This function is unsafe when the
 input <code>n</code>, is negative. This function wraps around <code><a href="GHC-StgToJS-Stack.html#v:adjSpN" title="GHC.StgToJS.Stack">adjSpN</a></code> which actually
 performs the work.</p></div></div><div class="top"><p class="src"><a id="v:adjSpN-39-" class="def">adjSpN'</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#adjSpN%27" class="link">Source</a> <a href="#v:adjSpN-39-" class="selflink">#</a></p><div class="doc"><p>Shrink the stack pointer by <code>n</code>. The stack grows downward so substract</p></div></div><div class="top"><p class="src"><a id="v:adjSp-39-" class="def">adjSp'</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#adjSp%27" class="link">Source</a> <a href="#v:adjSp-39-" class="selflink">#</a></p><div class="doc"><p>Grow the stack pointer by <code>n</code> without modifying the stack depth. The stack
 is just a JS array so we add to grow (instead of the traditional subtract)</p></div></div><div class="top"><p class="src"><a id="v:adjSp" class="def">adjSp</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#adjSp" class="link">Source</a> <a href="#v:adjSp" class="selflink">#</a></p><div class="doc"><p>Wrapper which adjusts the stack pointer <em>and</em> modifies the stack depth
 tracked in <code><a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a></code>. See also <code><a href="GHC-StgToJS-Stack.html#v:adjSp-39-" title="GHC.StgToJS.Stack">adjSp'</a></code> which actually does the stack pointer
 manipulation.</p></div></div><div class="top"><p class="src"><a id="v:pushNN" class="def">pushNN</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Integer" title="GHC.Prelude.Basic">Integer</a> <a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a> <a href="src/GHC.StgToJS.Stack.html#pushNN" class="link">Source</a> <a href="#v:pushNN" class="selflink">#</a></p><div class="doc"><p>Partial Push functions. Like <code><a href="GHC-StgToJS-Stack.html#v:pushN" title="GHC.StgToJS.Stack">pushN</a></code> except these push functions skip
 slots. For example,
 <code>
 function h$pp33(x1, x2) {
   h$sp += 6;
   h$stack[(h$sp - 5)] = x1;
   h$stack[(h$sp - 0)] = x2;
 };
 </code></p><p>The 33rd entry skips slots 1-4 to bind the top of the stack and the 6th
 slot. See <code><a href="GHC-StgToJS-Stack.html#v:pushOptimized" title="GHC.StgToJS.Stack">pushOptimized</a></code> and <code><a href="GHC-StgToJS-Stack.html#v:pushOptimized-39-" title="GHC.StgToJS.Stack">pushOptimized'</a></code> for use cases.</p></div></div><div class="top"><p class="src"><a id="v:pushNN-39-" class="def">pushNN'</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Integer" title="GHC.Prelude.Basic">Integer</a> <a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a> <a href="src/GHC.StgToJS.Stack.html#pushNN%27" class="link">Source</a> <a href="#v:pushNN-39-" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="GHC-StgToJS-Stack.html#v:pushN-39-" title="GHC.StgToJS.Stack">pushN'</a></code> but for the partial push functions</p></div></div><div class="top"><p class="src"><a id="v:pushN-39-" class="def">pushN'</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> <a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a> <a href="src/GHC.StgToJS.Stack.html#pushN%27" class="link">Source</a> <a href="#v:pushN-39-" class="selflink">#</a></p><div class="doc"><p>Convert all function symbols in <code><a href="GHC-StgToJS-Stack.html#v:pushN" title="GHC.StgToJS.Stack">pushN</a></code> to global top-level functions. This
 is a hack which converts the function symbols to variables. This hack is
 caught in <code><a href="GHC-StgToJS-Printer.html#v:prettyBlock-39-" title="GHC.StgToJS.Printer">prettyBlock'</a></code> to turn these into global
 functions.</p></div></div><div class="top"><p class="src"><a id="v:pushN" class="def">pushN</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> <a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a> <a href="src/GHC.StgToJS.Stack.html#pushN" class="link">Source</a> <a href="#v:pushN" class="selflink">#</a></p><div class="doc"><p>A constant array that holds global function symbols which do N pushes onto
 the stack. For example:
 <code>
 function h$p1(x1) {
   ++h$sp;
   h$stack[(h$sp - 0)] = x1;
 };
 function h$p2(x1, x2) {
   h$sp += 2;
   h$stack[(h$sp - 1)] = x1;
   h$stack[(h$sp - 0)] = x2;
 };
 </code></p><p>and so on up to 32.</p></div></div><div class="top"><p class="src"><a id="v:pushOptimized-39-" class="def">pushOptimized'</a> :: [(<a href="GHC-Types-Var.html#t:Id" title="GHC.Types.Var">Id</a>, <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a>)] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#pushOptimized%27" class="link">Source</a> <a href="#v:pushOptimized-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pushOptimized" class="def">pushOptimized</a> <a href="src/GHC.StgToJS.Stack.html#pushOptimized" class="link">Source</a> <a href="#v:pushOptimized" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>, <a href="GHC-Prelude-Basic.html#t:Bool" title="GHC.Prelude.Basic">Bool</a>)]</td><td class="doc"><p>contents of the slots, True if same value is already there</p></td></tr><tr><td class="src">-&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>optimized push that reuses existing values on stack automatically chooses
 an optimized partial push (h$ppN) function when possible.</p></div></div><div class="top"><p class="src"><a id="v:pushLneFrame" class="def">pushLneFrame</a> :: <a href="GHC-Utils-Misc.html#t:HasDebugCallStack" title="GHC.Utils.Misc">HasDebugCallStack</a> =&gt; <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-ExprCtx.html#t:ExprCtx" title="GHC.StgToJS.ExprCtx">ExprCtx</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#pushLneFrame" class="link">Source</a> <a href="#v:pushLneFrame" class="selflink">#</a></p><div class="doc"><p>push a let-no-escape frame onto the stack</p></div></div><div class="top"><p class="src"><a id="v:popN" class="def">popN</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#popN" class="link">Source</a> <a href="#v:popN" class="selflink">#</a></p><div class="doc"><p>Blindly pop N slots</p></div></div><div class="top"><p class="src"><a id="v:popSkip" class="def">popSkip</a> <a href="src/GHC.StgToJS.Stack.html#popSkip" class="link">Source</a> <a href="#v:popSkip" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a></td><td class="doc"><p>number of slots to skip</p></td></tr><tr><td class="src">-&gt; [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>]</td><td class="doc"><p>assign stack slot values to these</p></td></tr><tr><td class="src">-&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Pop things, don't update the stack knowledge in <code><a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a></code></p></div></div><div class="top"><p class="src"><a id="v:popSkipI" class="def">popSkipI</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; [(<a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a>, <a href="GHC-StgToJS-Types.html#t:StackSlot" title="GHC.StgToJS.Types">StackSlot</a>)] -&gt; <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#popSkipI" class="link">Source</a> <a href="#v:popSkipI" class="selflink">#</a></p><div class="doc"><p>Pop but preserve the first N slots</p></div></div><div class="top"><p class="src"><a id="v:loadSkip" class="def">loadSkip</a> :: <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> -&gt; [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#loadSkip" class="link">Source</a> <a href="#v:loadSkip" class="selflink">#</a></p><div class="doc"><p>Load 'length (xs :: [JExpr])' things from the stack at offset 'n :: Int'.
 This function does no stack pointer manipulation, it merely indexes into the
 stack and loads payloads into <code>xs</code>.</p></div></div><a href="#g:1" id="g:1"><h1>Thunk update</h1></a><div class="top"><p class="src"><a id="v:updateThunk" class="def">updateThunk</a> :: <a href="GHC-StgToJS-Types.html#t:G" title="GHC.StgToJS.Types">G</a> <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#updateThunk" class="link">Source</a> <a href="#v:updateThunk" class="selflink">#</a></p><div class="doc"><p>Wrapper around <code><a href="GHC-StgToJS-Stack.html#v:updateThunk-39-" title="GHC.StgToJS.Stack">updateThunk'</a></code>, performs the stack manipulation before
 updating the Thunk.</p></div></div><div class="top"><p class="src"><a id="v:updateThunk-39-" class="def">updateThunk'</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#updateThunk%27" class="link">Source</a> <a href="#v:updateThunk-39-" class="selflink">#</a></p><div class="doc"><p>Update a thunk by checking <code><a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a></code>. If the config inlines black
 holes then update inline, else make an explicit call to the black hole
 handler.</p></div></div><div class="top"><p class="src"><a id="v:bhStats" class="def">bhStats</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-Prelude-Basic.html#t:Bool" title="GHC.Prelude.Basic">Bool</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Stack.html#bhStats" class="link">Source</a> <a href="#v:bhStats" class="selflink">#</a></p><div class="doc"><p>Generate statements to update the current node with a blackhole</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>