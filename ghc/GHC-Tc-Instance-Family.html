<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.Tc.Instance.Family</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ghc-9.6.6: The GHC API</span><ul class="links" id="page-menu"><li><a href="src/GHC.Tc.Instance.Family.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.Tc.Instance.Family</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Injectivity</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>The <code>FamInst</code> type: family instance heads</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:FamInstEnvs">FamInstEnvs</a> = (<a href="GHC-Core-FamInstEnv.html#t:FamInstEnv" title="GHC.Core.FamInstEnv">FamInstEnv</a>, <a href="GHC-Core-FamInstEnv.html#t:FamInstEnv" title="GHC.Core.FamInstEnv">FamInstEnv</a>)</li><li class="src short"><a href="#v:tcGetFamInstEnvs">tcGetFamInstEnvs</a> :: <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> <a href="GHC-Tc-Instance-Family.html#t:FamInstEnvs" title="GHC.Tc.Instance.Family">FamInstEnvs</a></li><li class="src short"><a href="#v:checkFamInstConsistency">checkFamInstConsistency</a> :: [<a href="GHC-Unit-Types.html#t:Module" title="GHC.Unit.Types">Module</a>] -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> ()</li><li class="src short"><a href="#v:tcExtendLocalFamInstEnv">tcExtendLocalFamInstEnv</a> :: [<a href="GHC-Core-FamInstEnv.html#t:FamInst" title="GHC.Core.FamInstEnv">FamInst</a>] -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> a -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> a</li><li class="src short"><a href="#v:tcLookupDataFamInst">tcLookupDataFamInst</a> :: <a href="GHC-Tc-Instance-Family.html#t:FamInstEnvs" title="GHC.Tc.Instance.Family">FamInstEnvs</a> -&gt; <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> -&gt; [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>] -&gt; (<a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a>, [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>], <a href="GHC-Core-Coercion.html#t:Coercion" title="GHC.Core.Coercion">Coercion</a>)</li><li class="src short"><a href="#v:tcLookupDataFamInst_maybe">tcLookupDataFamInst_maybe</a> :: <a href="GHC-Tc-Instance-Family.html#t:FamInstEnvs" title="GHC.Tc.Instance.Family">FamInstEnvs</a> -&gt; <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> -&gt; [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> (<a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a>, [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>], <a href="GHC-Core-Coercion.html#t:Coercion" title="GHC.Core.Coercion">Coercion</a>)</li><li class="src short"><a href="#v:tcInstNewTyCon_maybe">tcInstNewTyCon_maybe</a> :: <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> -&gt; [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> (<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>, <a href="GHC-Tc-Types-Evidence.html#t:TcCoercion" title="GHC.Tc.Types.Evidence">TcCoercion</a>)</li><li class="src short"><a href="#v:tcTopNormaliseNewTypeTF_maybe">tcTopNormaliseNewTypeTF_maybe</a> :: <a href="GHC-Tc-Instance-Family.html#t:FamInstEnvs" title="GHC.Tc.Instance.Family">FamInstEnvs</a> -&gt; <a href="GHC-Types-Name-Reader.html#t:GlobalRdrEnv" title="GHC.Types.Name.Reader">GlobalRdrEnv</a> -&gt; <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> -&gt; <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> ((<a href="GHC-Data-Bag.html#t:Bag" title="GHC.Data.Bag">Bag</a> <a href="GHC-Types-Name-Reader.html#t:GlobalRdrElt" title="GHC.Types.Name.Reader">GlobalRdrElt</a>, <a href="GHC-Tc-Types-Evidence.html#t:TcCoercion" title="GHC.Tc.Types.Evidence">TcCoercion</a>), <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a>)</li><li class="src short"><a href="#v:newFamInst">newFamInst</a> :: <a href="GHC-Core-FamInstEnv.html#t:FamFlavor" title="GHC.Core.FamInstEnv">FamFlavor</a> -&gt; <a href="GHC-Core-Coercion-Axiom.html#t:CoAxiom" title="GHC.Core.Coercion.Axiom">CoAxiom</a> <a href="GHC-Core-Coercion-Axiom.html#t:Unbranched" title="GHC.Core.Coercion.Axiom">Unbranched</a> -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> <a href="GHC-Core-FamInstEnv.html#t:FamInst" title="GHC.Core.FamInstEnv">FamInst</a></li><li class="src short"><a href="#v:reportInjectivityErrors">reportInjectivityErrors</a> :: <a href="GHC-Driver-Session.html#t:DynFlags" title="GHC.Driver.Session">DynFlags</a> -&gt; <a href="GHC-Core-Coercion-Axiom.html#t:CoAxiom" title="GHC.Core.Coercion.Axiom">CoAxiom</a> br -&gt; <a href="GHC-Core-Coercion-Axiom.html#t:CoAxBranch" title="GHC.Core.Coercion.Axiom">CoAxBranch</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:Bool" title="GHC.Prelude.Basic">Bool</a>] -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> ()</li><li class="src short"><a href="#v:reportConflictingInjectivityErrs">reportConflictingInjectivityErrs</a> :: <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> -&gt; [<a href="GHC-Core-Coercion-Axiom.html#t:CoAxBranch" title="GHC.Core.Coercion.Axiom">CoAxBranch</a>] -&gt; <a href="GHC-Core-Coercion-Axiom.html#t:CoAxBranch" title="GHC.Core.Coercion.Axiom">CoAxBranch</a> -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FamInstEnvs" class="def">FamInstEnvs</a> = (<a href="GHC-Core-FamInstEnv.html#t:FamInstEnv" title="GHC.Core.FamInstEnv">FamInstEnv</a>, <a href="GHC-Core-FamInstEnv.html#t:FamInstEnv" title="GHC.Core.FamInstEnv">FamInstEnv</a>) <a href="src/GHC.Core.FamInstEnv.html#FamInstEnvs" class="link">Source</a> <a href="#t:FamInstEnvs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tcGetFamInstEnvs" class="def">tcGetFamInstEnvs</a> :: <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> <a href="GHC-Tc-Instance-Family.html#t:FamInstEnvs" title="GHC.Tc.Instance.Family">FamInstEnvs</a> <a href="src/GHC.Tc.Instance.Family.html#tcGetFamInstEnvs" class="link">Source</a> <a href="#v:tcGetFamInstEnvs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:checkFamInstConsistency" class="def">checkFamInstConsistency</a> :: [<a href="GHC-Unit-Types.html#t:Module" title="GHC.Unit.Types">Module</a>] -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> () <a href="src/GHC.Tc.Instance.Family.html#checkFamInstConsistency" class="link">Source</a> <a href="#v:checkFamInstConsistency" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tcExtendLocalFamInstEnv" class="def">tcExtendLocalFamInstEnv</a> :: [<a href="GHC-Core-FamInstEnv.html#t:FamInst" title="GHC.Core.FamInstEnv">FamInst</a>] -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> a -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> a <a href="src/GHC.Tc.Instance.Family.html#tcExtendLocalFamInstEnv" class="link">Source</a> <a href="#v:tcExtendLocalFamInstEnv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tcLookupDataFamInst" class="def">tcLookupDataFamInst</a> :: <a href="GHC-Tc-Instance-Family.html#t:FamInstEnvs" title="GHC.Tc.Instance.Family">FamInstEnvs</a> -&gt; <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> -&gt; [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>] -&gt; (<a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a>, [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>], <a href="GHC-Core-Coercion.html#t:Coercion" title="GHC.Core.Coercion">Coercion</a>) <a href="src/GHC.Tc.Instance.Family.html#tcLookupDataFamInst" class="link">Source</a> <a href="#v:tcLookupDataFamInst" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="GHC-Tc-Instance-Family.html#v:tcLookupDataFamInst_maybe" title="GHC.Tc.Instance.Family">tcLookupDataFamInst_maybe</a></code>, but returns the arguments back if
 there is no data family to unwrap.
 Returns a Representational coercion</p></div></div><div class="top"><p class="src"><a id="v:tcLookupDataFamInst_maybe" class="def">tcLookupDataFamInst_maybe</a> :: <a href="GHC-Tc-Instance-Family.html#t:FamInstEnvs" title="GHC.Tc.Instance.Family">FamInstEnvs</a> -&gt; <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> -&gt; [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> (<a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a>, [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>], <a href="GHC-Core-Coercion.html#t:Coercion" title="GHC.Core.Coercion">Coercion</a>) <a href="src/GHC.Tc.Instance.Family.html#tcLookupDataFamInst_maybe" class="link">Source</a> <a href="#v:tcLookupDataFamInst_maybe" class="selflink">#</a></p><div class="doc"><p>Converts a data family type (eg F [a]) to its representation type (eg FList a)
 and returns a coercion between the two: co :: F [a] ~R FList a.</p></div></div><div class="top"><p class="src"><a id="v:tcInstNewTyCon_maybe" class="def">tcInstNewTyCon_maybe</a> :: <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> -&gt; [<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> (<a href="GHC-Tc-Utils-TcType.html#t:TcType" title="GHC.Tc.Utils.TcType">TcType</a>, <a href="GHC-Tc-Types-Evidence.html#t:TcCoercion" title="GHC.Tc.Types.Evidence">TcCoercion</a>) <a href="src/GHC.Tc.Instance.Family.html#tcInstNewTyCon_maybe" class="link">Source</a> <a href="#v:tcInstNewTyCon_maybe" class="selflink">#</a></p><div class="doc"><p>If <code>co :: T ts ~ rep_ty</code> then:</p><pre>instNewTyCon_maybe T ts = Just (rep_ty, co)</pre><p>Checks for a newtype, and for being saturated
 Just like Coercion.instNewTyCon_maybe, but returns a TcCoercion</p></div></div><div class="top"><p class="src"><a id="v:tcTopNormaliseNewTypeTF_maybe" class="def">tcTopNormaliseNewTypeTF_maybe</a> :: <a href="GHC-Tc-Instance-Family.html#t:FamInstEnvs" title="GHC.Tc.Instance.Family">FamInstEnvs</a> -&gt; <a href="GHC-Types-Name-Reader.html#t:GlobalRdrEnv" title="GHC.Types.Name.Reader">GlobalRdrEnv</a> -&gt; <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> -&gt; <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> ((<a href="GHC-Data-Bag.html#t:Bag" title="GHC.Data.Bag">Bag</a> <a href="GHC-Types-Name-Reader.html#t:GlobalRdrElt" title="GHC.Types.Name.Reader">GlobalRdrElt</a>, <a href="GHC-Tc-Types-Evidence.html#t:TcCoercion" title="GHC.Tc.Types.Evidence">TcCoercion</a>), <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a>) <a href="src/GHC.Tc.Instance.Family.html#tcTopNormaliseNewTypeTF_maybe" class="link">Source</a> <a href="#v:tcTopNormaliseNewTypeTF_maybe" class="selflink">#</a></p><div class="doc"><p><code><a href="GHC-Tc-Instance-Family.html#v:tcTopNormaliseNewTypeTF_maybe" title="GHC.Tc.Instance.Family">tcTopNormaliseNewTypeTF_maybe</a></code> gets rid of top-level newtypes,
 potentially looking through newtype <em>instances</em> and type synonyms.</p><p>It is only used by the type inference engine (specifically, when
 solving representational equality), and hence it is careful to unwrap
 only if the relevant data constructor is in scope.  That's why
 it gets a GlobalRdrEnv argument.</p><p>It is careful not to unwrap data/newtype instances nor synonyms
 if it can't continue unwrapping.  Such care is necessary for proper
 error messages.</p><p>It does not look through type families.
 It does not normalise arguments to a tycon.</p><p>If the result is Just ((gres, co), rep_ty), then
    co : ty ~R rep_ty
    gres are the GREs for the data constructors that
                          had to be in scope</p></div></div><div class="top"><p class="src"><a id="v:newFamInst" class="def">newFamInst</a> :: <a href="GHC-Core-FamInstEnv.html#t:FamFlavor" title="GHC.Core.FamInstEnv">FamFlavor</a> -&gt; <a href="GHC-Core-Coercion-Axiom.html#t:CoAxiom" title="GHC.Core.Coercion.Axiom">CoAxiom</a> <a href="GHC-Core-Coercion-Axiom.html#t:Unbranched" title="GHC.Core.Coercion.Axiom">Unbranched</a> -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> <a href="GHC-Core-FamInstEnv.html#t:FamInst" title="GHC.Core.FamInstEnv">FamInst</a> <a href="src/GHC.Tc.Instance.Family.html#newFamInst" class="link">Source</a> <a href="#v:newFamInst" class="selflink">#</a></p></div><a href="#g:1" id="g:1"><h1>Injectivity</h1></a><div class="top"><p class="src"><a id="v:reportInjectivityErrors" class="def">reportInjectivityErrors</a> <a href="src/GHC.Tc.Instance.Family.html#reportInjectivityErrors" class="link">Source</a> <a href="#v:reportInjectivityErrors" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="GHC-Driver-Session.html#t:DynFlags" title="GHC.Driver.Session">DynFlags</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="GHC-Core-Coercion-Axiom.html#t:CoAxiom" title="GHC.Core.Coercion.Axiom">CoAxiom</a> br</td><td class="doc"><p>Type family for which we generate errors</p></td></tr><tr><td class="src">-&gt; <a href="GHC-Core-Coercion-Axiom.html#t:CoAxBranch" title="GHC.Core.Coercion.Axiom">CoAxBranch</a></td><td class="doc"><p>Currently checked equation (represented by axiom)</p></td></tr><tr><td class="src">-&gt; [<a href="GHC-Prelude-Basic.html#t:Bool" title="GHC.Prelude.Basic">Bool</a>]</td><td class="doc"><p>Injectivity annotation</p></td></tr><tr><td class="src">-&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Report a list of injectivity errors together with their source locations.
 Looks only at one equation; does not look for conflicts *among* equations.</p></div></div><div class="top"><p class="src"><a id="v:reportConflictingInjectivityErrs" class="def">reportConflictingInjectivityErrs</a> :: <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> -&gt; [<a href="GHC-Core-Coercion-Axiom.html#t:CoAxBranch" title="GHC.Core.Coercion.Axiom">CoAxBranch</a>] -&gt; <a href="GHC-Core-Coercion-Axiom.html#t:CoAxBranch" title="GHC.Core.Coercion.Axiom">CoAxBranch</a> -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> () <a href="src/GHC.Tc.Instance.Family.html#reportConflictingInjectivityErrs" class="link">Source</a> <a href="#v:reportConflictingInjectivityErrs" class="selflink">#</a></p><div class="doc"><p>Report error message for a pair of equations violating an injectivity
 annotation. No error message if there are no branches.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>