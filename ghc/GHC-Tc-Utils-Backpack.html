<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.Tc.Utils.Backpack</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ghc-9.6.6: The GHC API</span><ul class="links" id="page-menu"><li><a href="src/GHC.Tc.Utils.Backpack.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.Tc.Utils.Backpack</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:findExtraSigImports">findExtraSigImports</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Types-SourceFile.html#t:HscSource" title="GHC.Types.SourceFile">HscSource</a> -&gt; <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> [<a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>]</li><li class="src short"><a href="#v:implicitRequirements">implicitRequirements</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; [(<a href="GHC-Types-PkgQual.html#t:PkgQual" title="GHC.Types.PkgQual">PkgQual</a>, <a href="GHC-Types-SrcLoc.html#t:Located" title="GHC.Types.SrcLoc">Located</a> <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>)] -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> [<a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>]</li><li class="src short"><a href="#v:implicitRequirementsShallow">implicitRequirementsShallow</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; [(<a href="GHC-Types-PkgQual.html#t:PkgQual" title="GHC.Types.PkgQual">PkgQual</a>, <a href="GHC-Types-SrcLoc.html#t:Located" title="GHC.Types.SrcLoc">Located</a> <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>)] -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> ([<a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>], [<a href="GHC-Unit-Types.html#t:InstantiatedUnit" title="GHC.Unit.Types">InstantiatedUnit</a>])</li><li class="src short"><a href="#v:checkUnit">checkUnit</a> :: <a href="GHC-Unit-Types.html#t:Unit" title="GHC.Unit.Types">Unit</a> -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> ()</li><li class="src short"><a href="#v:tcRnCheckUnit">tcRnCheckUnit</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Unit-Types.html#t:Unit" title="GHC.Unit.Types">Unit</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Types-Error.html#t:Messages" title="GHC.Types.Error">Messages</a> <a href="GHC-Tc-Errors-Types.html#t:TcRnMessage" title="GHC.Tc.Errors.Types">TcRnMessage</a>, <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> ())</li><li class="src short"><a href="#v:tcRnMergeSignatures">tcRnMergeSignatures</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Hs.html#t:HsParsedModule" title="GHC.Hs">HsParsedModule</a> -&gt; <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a> -&gt; <a href="GHC-Unit-Module-ModIface.html#t:ModIface" title="GHC.Unit.Module.ModIface">ModIface</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Types-Error.html#t:Messages" title="GHC.Types.Error">Messages</a> <a href="GHC-Tc-Errors-Types.html#t:TcRnMessage" title="GHC.Tc.Errors.Types">TcRnMessage</a>, <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a>)</li><li class="src short"><a href="#v:mergeSignatures">mergeSignatures</a> :: <a href="GHC-Hs.html#t:HsParsedModule" title="GHC.Hs">HsParsedModule</a> -&gt; <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a> -&gt; <a href="GHC-Unit-Module-ModIface.html#t:ModIface" title="GHC.Unit.Module.ModIface">ModIface</a> -&gt; <a href="GHC-Tc-Types.html#t:TcRn" title="GHC.Tc.Types">TcRn</a> <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a></li><li class="src short"><a href="#v:tcRnInstantiateSignature">tcRnInstantiateSignature</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Unit-Types.html#t:Module" title="GHC.Unit.Types">Module</a> -&gt; <a href="GHC-Types-SrcLoc.html#t:RealSrcSpan" title="GHC.Types.SrcLoc">RealSrcSpan</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Types-Error.html#t:Messages" title="GHC.Types.Error">Messages</a> <a href="GHC-Tc-Errors-Types.html#t:TcRnMessage" title="GHC.Tc.Errors.Types">TcRnMessage</a>, <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a>)</li><li class="src short"><a href="#v:instantiateSignature">instantiateSignature</a> :: <a href="GHC-Tc-Types.html#t:TcRn" title="GHC.Tc.Types">TcRn</a> <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:findExtraSigImports" class="def">findExtraSigImports</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Types-SourceFile.html#t:HscSource" title="GHC.Types.SourceFile">HscSource</a> -&gt; <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> [<a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>] <a href="src/GHC.Tc.Utils.Backpack.html#findExtraSigImports" class="link">Source</a> <a href="#v:findExtraSigImports" class="selflink">#</a></p><div class="doc"><p>For a module <code>modname</code> of type <code><a href="GHC-Types-SourceFile.html#t:HscSource" title="GHC.Types.SourceFile">HscSource</a></code>, determine the list
 of extra &quot;imports&quot; of other requirements which should be considered part of
 the import of the requirement, because it transitively depends on those
 requirements by imports of modules from other packages.  The situation
 is something like this:</p><p>unit p where
          signature X
          signature Y
              import X</p><p>unit q where
          dependency p[X=&lt;A&gt;,Y=&lt;B&gt;]
          signature A
          signature B</p><p>Although q's B does not directly import A, we still have to make sure we
 process A first, because the merging process will cause B to indirectly
 import A.  This function finds the TRANSITIVE closure of all such imports
 we need to make.</p></div></div><div class="top"><p class="src"><a id="v:implicitRequirements" class="def">implicitRequirements</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; [(<a href="GHC-Types-PkgQual.html#t:PkgQual" title="GHC.Types.PkgQual">PkgQual</a>, <a href="GHC-Types-SrcLoc.html#t:Located" title="GHC.Types.SrcLoc">Located</a> <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>)] -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> [<a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>] <a href="src/GHC.Tc.Utils.Backpack.html#implicitRequirements" class="link">Source</a> <a href="#v:implicitRequirements" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:implicitRequirementsShallow" class="def">implicitRequirementsShallow</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; [(<a href="GHC-Types-PkgQual.html#t:PkgQual" title="GHC.Types.PkgQual">PkgQual</a>, <a href="GHC-Types-SrcLoc.html#t:Located" title="GHC.Types.SrcLoc">Located</a> <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>)] -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> ([<a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a>], [<a href="GHC-Unit-Types.html#t:InstantiatedUnit" title="GHC.Unit.Types">InstantiatedUnit</a>]) <a href="src/GHC.Tc.Utils.Backpack.html#implicitRequirementsShallow" class="link">Source</a> <a href="#v:implicitRequirementsShallow" class="selflink">#</a></p><div class="doc"><p>Like <code>implicitRequirements'</code>, but returns either the module name, if it is
 a free hole, or the instantiated unit the imported module is from, so that
 that instantiated unit can be processed and via the batch mod graph (rather
 than a transitive closure done here) all the free holes are still reachable.</p></div></div><div class="top"><p class="src"><a id="v:checkUnit" class="def">checkUnit</a> :: <a href="GHC-Unit-Types.html#t:Unit" title="GHC.Unit.Types">Unit</a> -&gt; <a href="GHC-Tc-Types.html#t:TcM" title="GHC.Tc.Types">TcM</a> () <a href="src/GHC.Tc.Utils.Backpack.html#checkUnit" class="link">Source</a> <a href="#v:checkUnit" class="selflink">#</a></p><div class="doc"><p>Given a <code><a href="GHC-Unit-Types.html#t:Unit" title="GHC.Unit.Types">Unit</a></code>, make sure it is well typed.  This is because
 unit IDs come from Cabal, which does not know if things are well-typed or
 not; a component may have been filled with implementations for the holes
 that don't actually fulfill the requirements.</p></div></div><div class="top"><p class="src"><a id="v:tcRnCheckUnit" class="def">tcRnCheckUnit</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Unit-Types.html#t:Unit" title="GHC.Unit.Types">Unit</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Types-Error.html#t:Messages" title="GHC.Types.Error">Messages</a> <a href="GHC-Tc-Errors-Types.html#t:TcRnMessage" title="GHC.Tc.Errors.Types">TcRnMessage</a>, <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> ()) <a href="src/GHC.Tc.Utils.Backpack.html#tcRnCheckUnit" class="link">Source</a> <a href="#v:tcRnCheckUnit" class="selflink">#</a></p><div class="doc"><p>Top-level driver for signature instantiation (run when compiling
 an <code>hsig</code> file.)</p></div></div><div class="top"><p class="src"><a id="v:tcRnMergeSignatures" class="def">tcRnMergeSignatures</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Hs.html#t:HsParsedModule" title="GHC.Hs">HsParsedModule</a> -&gt; <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a> -&gt; <a href="GHC-Unit-Module-ModIface.html#t:ModIface" title="GHC.Unit.Module.ModIface">ModIface</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Types-Error.html#t:Messages" title="GHC.Types.Error">Messages</a> <a href="GHC-Tc-Errors-Types.html#t:TcRnMessage" title="GHC.Tc.Errors.Types">TcRnMessage</a>, <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a>) <a href="src/GHC.Tc.Utils.Backpack.html#tcRnMergeSignatures" class="link">Source</a> <a href="#v:tcRnMergeSignatures" class="selflink">#</a></p><div class="doc"><p>Top-level driver for signature merging (run after typechecking
 an <code>hsig</code> file).</p></div></div><div class="top"><p class="src"><a id="v:mergeSignatures" class="def">mergeSignatures</a> :: <a href="GHC-Hs.html#t:HsParsedModule" title="GHC.Hs">HsParsedModule</a> -&gt; <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a> -&gt; <a href="GHC-Unit-Module-ModIface.html#t:ModIface" title="GHC.Unit.Module.ModIface">ModIface</a> -&gt; <a href="GHC-Tc-Types.html#t:TcRn" title="GHC.Tc.Types">TcRn</a> <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a> <a href="src/GHC.Tc.Utils.Backpack.html#mergeSignatures" class="link">Source</a> <a href="#v:mergeSignatures" class="selflink">#</a></p><div class="doc"><p>Given a local <code><a href="GHC-Unit-Module-ModIface.html#t:ModIface" title="GHC.Unit.Module.ModIface">ModIface</a></code>, merge all inherited requirements
 from <code><a href="GHC-Unit-State.html#v:requirementMerges" title="GHC.Unit.State">requirementMerges</a></code> into this signature, producing
 a final <code><a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a></code> that matches the local signature and
 all required signatures.</p></div></div><div class="top"><p class="src"><a id="v:tcRnInstantiateSignature" class="def">tcRnInstantiateSignature</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Unit-Types.html#t:Module" title="GHC.Unit.Types">Module</a> -&gt; <a href="GHC-Types-SrcLoc.html#t:RealSrcSpan" title="GHC.Types.SrcLoc">RealSrcSpan</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Types-Error.html#t:Messages" title="GHC.Types.Error">Messages</a> <a href="GHC-Tc-Errors-Types.html#t:TcRnMessage" title="GHC.Tc.Errors.Types">TcRnMessage</a>, <a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a>) <a href="src/GHC.Tc.Utils.Backpack.html#tcRnInstantiateSignature" class="link">Source</a> <a href="#v:tcRnInstantiateSignature" class="selflink">#</a></p><div class="doc"><p>Top-level driver for signature instantiation (run when compiling
 an <code>hsig</code> file.)</p></div></div><div class="top"><p class="src"><a id="v:instantiateSignature" class="def">instantiateSignature</a> :: <a href="GHC-Tc-Types.html#t:TcRn" title="GHC.Tc.Types">TcRn</a> <a href="GHC-Tc-Types.html#t:TcGblEnv" title="GHC.Tc.Types">TcGblEnv</a> <a href="src/GHC.Tc.Utils.Backpack.html#instantiateSignature" class="link">Source</a> <a href="#v:instantiateSignature" class="selflink">#</a></p><div class="doc"><p>Given <code><a href="GHC-Tc-Types.html#v:tcg_mod" title="GHC.Tc.Types">tcg_mod</a></code>, instantiate a <code><a href="GHC-Unit-Module-ModIface.html#t:ModIface" title="GHC.Unit.Module.ModIface">ModIface</a></code> from the indefinite
 library to use the actual implementations of the relevant entities,
 checking that the implementation matches the signature.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>