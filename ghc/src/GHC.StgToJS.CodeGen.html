<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BlockArguments #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="annot"><span class="hs-comment">-- | JavaScript code generator</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.StgToJS.CodeGen</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#stgToJS"><span class="hs-identifier">stgToJS</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html"><span class="hs-identifier">GHC.Driver.Flags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Flags.html#DumpFlag"><span class="hs-identifier">DumpFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_D_dump_js"><span class="hs-identifier">Opt_D_dump_js</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.JS.Ppr.html"><span class="hs-identifier">GHC.JS.Ppr</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.JS.Syntax.html"><span class="hs-identifier">GHC.JS.Syntax</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.JS.Make.html"><span class="hs-identifier">GHC.JS.Make</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.JS.Transform.html"><span class="hs-identifier">GHC.JS.Transform</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Arg.html"><span class="hs-identifier">GHC.StgToJS.Arg</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Sinker.html"><span class="hs-identifier">GHC.StgToJS.Sinker</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html"><span class="hs-identifier">GHC.StgToJS.Types</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.StgToJS.Object.html"><span class="hs-identifier">GHC.StgToJS.Object</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Object</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.StgUtils.html"><span class="hs-identifier">GHC.StgToJS.StgUtils</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.CoreUtils.html"><span class="hs-identifier">GHC.StgToJS.CoreUtils</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Deps.html"><span class="hs-identifier">GHC.StgToJS.Deps</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Expr.html"><span class="hs-identifier">GHC.StgToJS.Expr</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.ExprCtx.html"><span class="hs-identifier">GHC.StgToJS.ExprCtx</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Monad.html"><span class="hs-identifier">GHC.StgToJS.Monad</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Profiling.html"><span class="hs-identifier">GHC.StgToJS.Profiling</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Regs.html"><span class="hs-identifier">GHC.StgToJS.Regs</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.StaticPtr.html"><span class="hs-identifier">GHC.StgToJS.StaticPtr</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Symbols.html"><span class="hs-identifier">GHC.StgToJS.Symbols</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Stack.html"><span class="hs-identifier">GHC.StgToJS.Stack</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Ids.html"><span class="hs-identifier">GHC.StgToJS.Ids</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html"><span class="hs-identifier">GHC.Stg.Syntax</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier">scaledThing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.Types.html"><span class="hs-identifier">GHC.Linker.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Linker.Types.html#SptEntry"><span class="hs-identifier">SptEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.CostCentre.html"><span class="hs-identifier">GHC.Types.CostCentre</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.ForeignStubs.html"><span class="hs-identifier">GHC.Types.ForeignStubs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.ForeignStubs.html#ForeignStubs"><span class="hs-identifier">ForeignStubs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.ForeignStubs.html#getCHeader"><span class="hs-identifier">getCHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.ForeignStubs.html#getCStub"><span class="hs-identifier">getCStub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html"><span class="hs-identifier">GHC.Types.RepType</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghc-boot-9.6.7/src/GHC.Utils.Encoding.html#/GHC.Utils.Encoding.html"><span class="hs-identifier">GHC.Utils.Encoding</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html"><span class="hs-identifier">GHC.Utils.Logger</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html"><span class="hs-identifier">GHC.Utils.Binary</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#/Control.Monad.Trans.State.Strict.html"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator">(&lt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.6.7/src/Data.Set.html#/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Monoid.html#/Data.Monoid.html"><span class="hs-identifier">Data.Monoid</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../directory-1.3.8.5/src/System.Directory.html#/System.Directory.html"><span class="hs-identifier">System.Directory</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../template-haskell-2.20.0.0/src/System.FilePath.html#/System.FilePath.html"><span class="hs-identifier">System.FilePath</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><span class="hs-comment">-- | Code generator for JavaScript</span></span><span>
</span><span id="line-66"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#stgToJS"><span class="hs-identifier hs-type">stgToJS</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#StgToJSConfig"><span class="hs-identifier hs-type">StgToJSConfig</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#CgStgTopBinding"><span class="hs-identifier hs-type">CgStgTopBinding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Linker.Types.html#SptEntry"><span class="hs-identifier hs-type">SptEntry</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.ForeignStubs.html#ForeignStubs"><span class="hs-identifier hs-type">ForeignStubs</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.CostCentre.html#CollectedCCs"><span class="hs-identifier hs-type">CollectedCCs</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Output file name</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span id="stgToJS"><span class="annot"><span class="annottext">stgToJS :: Logger
-&gt; StgToJSConfig
-&gt; [CgStgTopBinding]
-&gt; Module
-&gt; [SptEntry]
-&gt; ForeignStubs
-&gt; CollectedCCs
-&gt; [Char]
-&gt; IO ()
</span><a href="GHC.StgToJS.CodeGen.html#stgToJS"><span class="hs-identifier hs-var hs-var">stgToJS</span></a></span></span><span> </span><span id="local-6989586621681907827"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681907827"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621681907828"><span class="annot"><span class="annottext">StgToJSConfig
</span><a href="#local-6989586621681907828"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621681907829"><span class="annot"><span class="annottext">[CgStgTopBinding]
</span><a href="#local-6989586621681907829"><span class="hs-identifier hs-var">stg_binds0</span></a></span></span><span> </span><span id="local-6989586621681907830"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907830"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span> </span><span id="local-6989586621681907831"><span class="annot"><span class="annottext">[SptEntry]
</span><a href="#local-6989586621681907831"><span class="hs-identifier hs-var">spt_entries</span></a></span></span><span> </span><span id="local-6989586621681907832"><span class="annot"><span class="annottext">ForeignStubs
</span><a href="#local-6989586621681907832"><span class="hs-identifier hs-var">foreign_stubs</span></a></span></span><span> </span><span id="local-6989586621681907833"><span class="annot"><span class="annottext">CollectedCCs
</span><a href="#local-6989586621681907833"><span class="hs-identifier hs-var">cccs</span></a></span></span><span> </span><span id="local-6989586621681907834"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681907834"><span class="hs-identifier hs-var">output_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681907835"><span class="annot"><span class="annottext">UniqFM Id CgStgExpr
</span><a href="#local-6989586621681907835"><span class="hs-identifier hs-var">unfloated_binds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681907836"><span class="annot"><span class="annottext">[CgStgTopBinding]
</span><a href="#local-6989586621681907836"><span class="hs-identifier hs-var">stg_binds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module
-&gt; [CgStgTopBinding] -&gt; (UniqFM Id CgStgExpr, [CgStgTopBinding])
</span><a href="GHC.StgToJS.Sinker.html#sinkPgm"><span class="hs-identifier hs-var">sinkPgm</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907830"><span class="hs-identifier hs-var">this_mod</span></a></span><span> </span><span class="annot"><span class="annottext">[CgStgTopBinding]
</span><a href="#local-6989586621681907829"><span class="hs-identifier hs-var">stg_binds0</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-comment">-- TODO: avoid top level lifting in core-2-core when the JS backend is</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-comment">-- enabled instead of undoing it here</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-comment">-- TODO: add dump pass for optimized STG ast for JS</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681907838"><span class="annot"><span class="annottext">Deps
</span><a href="#local-6989586621681907838"><span class="hs-identifier hs-var">deps</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681907839"><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907839"><span class="hs-identifier hs-var">lus</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StgToJSConfig
-&gt; Module
-&gt; UniqFM Id CgStgExpr
-&gt; G (Deps, [LinkableUnit])
-&gt; IO (Deps, [LinkableUnit])
forall a.
StgToJSConfig -&gt; Module -&gt; UniqFM Id CgStgExpr -&gt; G a -&gt; IO a
</span><a href="GHC.StgToJS.Monad.html#runG"><span class="hs-identifier hs-var">runG</span></a></span><span> </span><span class="annot"><span class="annottext">StgToJSConfig
</span><a href="#local-6989586621681907828"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907830"><span class="hs-identifier hs-var">this_mod</span></a></span><span> </span><span class="annot"><span class="annottext">UniqFM Id CgStgExpr
</span><a href="#local-6989586621681907835"><span class="hs-identifier hs-var">unfloated_binds</span></a></span><span> </span><span class="annot"><span class="annottext">(G (Deps, [LinkableUnit]) -&gt; IO (Deps, [LinkableUnit]))
-&gt; G (Deps, [LinkableUnit]) -&gt; IO (Deps, [LinkableUnit])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">G () -&gt; G ()
forall m. Monoid m =&gt; G m -&gt; G m
</span><a href="GHC.StgToJS.Profiling.html#ifProfilingM"><span class="hs-identifier hs-var">ifProfilingM</span></a></span><span> </span><span class="annot"><span class="annottext">(G () -&gt; G ()) -&gt; G () -&gt; G ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CollectedCCs -&gt; G ()
</span><a href="GHC.StgToJS.Profiling.html#initCostCentres"><span class="hs-identifier hs-var">initCostCentres</span></a></span><span> </span><span class="annot"><span class="annottext">CollectedCCs
</span><a href="#local-6989586621681907833"><span class="hs-identifier hs-var">cccs</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621681907843"><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907843"><span class="hs-identifier hs-var">lus</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt;
Module
-&gt; [CgStgTopBinding]
-&gt; [SptEntry]
-&gt; ForeignStubs
-&gt; G [LinkableUnit]
Module
-&gt; [CgStgTopBinding]
-&gt; [SptEntry]
-&gt; ForeignStubs
-&gt; G [LinkableUnit]
</span><a href="GHC.StgToJS.CodeGen.html#genUnits"><span class="hs-identifier hs-var">genUnits</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907830"><span class="hs-identifier hs-var">this_mod</span></a></span><span> </span><span class="annot"><span class="annottext">[CgStgTopBinding]
</span><a href="#local-6989586621681907836"><span class="hs-identifier hs-var">stg_binds</span></a></span><span> </span><span class="annot"><span class="annottext">[SptEntry]
</span><a href="#local-6989586621681907831"><span class="hs-identifier hs-var">spt_entries</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignStubs
</span><a href="#local-6989586621681907832"><span class="hs-identifier hs-var">foreign_stubs</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621681907845"><span class="annot"><span class="annottext">Deps
</span><a href="#local-6989586621681907845"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Module -&gt; [LinkableUnit] -&gt; G Deps
Module -&gt; [LinkableUnit] -&gt; G Deps
</span><a href="GHC.StgToJS.Deps.html#genDependencyData"><span class="hs-identifier hs-var">genDependencyData</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907830"><span class="hs-identifier hs-var">this_mod</span></a></span><span> </span><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907843"><span class="hs-identifier hs-var">lus</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">(Deps, [LinkableUnit]) -&gt; G (Deps, [LinkableUnit])
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Deps
</span><a href="#local-6989586621681907845"><span class="hs-identifier hs-var">deps</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907843"><span class="hs-identifier hs-var">lus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">-- Doc to dump when -ddump-js is enabled</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logger -&gt; DumpFlag -&gt; Bool
</span><a href="GHC.Utils.Logger.html#logHasDumpFlag"><span class="hs-identifier hs-var">logHasDumpFlag</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681907827"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="GHC.Driver.Flags.html#Opt_D_dump_js"><span class="hs-identifier hs-var">Opt_D_dump_js</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">Logger -&gt; DumpFlag -&gt; [Char] -&gt; DumpFormat -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Logger.html#putDumpFileMaybe"><span class="hs-identifier hs-var">putDumpFileMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681907827"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="GHC.Driver.Flags.html#Opt_D_dump_js"><span class="hs-identifier hs-var">Opt_D_dump_js</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;JavaScript code&quot;</span></span><span> </span><span class="annot"><span class="annottext">DumpFormat
</span><a href="GHC.Utils.Logger.html#FormatJS"><span class="hs-identifier hs-var">FormatJS</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">(SDoc -&gt; IO ()) -&gt; SDoc -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LinkableUnit -&gt; SDoc) -&gt; [LinkableUnit] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#docToSDoc"><span class="hs-identifier hs-var">docToSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; SDoc) -&gt; (LinkableUnit -&gt; Doc) -&gt; LinkableUnit -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">JStat -&gt; Doc
forall a. JsToDoc a =&gt; a -&gt; Doc
</span><a href="GHC.JS.Ppr.html#jsToDoc"><span class="hs-identifier hs-var">jsToDoc</span></a></span><span> </span><span class="annot"><span class="annottext">(JStat -&gt; Doc) -&gt; (LinkableUnit -&gt; JStat) -&gt; LinkableUnit -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ObjUnit -&gt; JStat
</span><a href="GHC.StgToJS.Types.html#oiStat"><span class="hs-identifier hs-var">oiStat</span></a></span><span> </span><span class="annot"><span class="annottext">(ObjUnit -&gt; JStat)
-&gt; (LinkableUnit -&gt; ObjUnit) -&gt; LinkableUnit -&gt; JStat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LinkableUnit -&gt; ObjUnit
</span><a href="GHC.StgToJS.Types.html#luObjUnit"><span class="hs-identifier hs-var">luObjUnit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907839"><span class="hs-identifier hs-var">lus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-comment">-- Write the object file</span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621681907857"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621681907857"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO BinHandle
</span><a href="GHC.Utils.Binary.html#openBinMem"><span class="hs-identifier hs-var">openBinMem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1024</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- a bit less than 4kB</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">BinHandle -&gt; ModuleName -&gt; Deps -&gt; [ObjUnit] -&gt; IO ()
</span><a href="GHC.StgToJS.Object.html#putObject"><span class="hs-identifier hs-var">Object.putObject</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621681907857"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; ModuleName
forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907830"><span class="hs-identifier hs-var">this_mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Deps
</span><a href="#local-6989586621681907838"><span class="hs-identifier hs-var">deps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LinkableUnit -&gt; ObjUnit) -&gt; [LinkableUnit] -&gt; [ObjUnit]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">LinkableUnit -&gt; ObjUnit
</span><a href="GHC.StgToJS.Types.html#luObjUnit"><span class="hs-identifier hs-var">luObjUnit</span></a></span><span> </span><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907839"><span class="hs-identifier hs-var">lus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; [Char] -&gt; IO ()
</span><a href="../../directory-1.3.8.5/src/System.Directory.html#createDirectoryIfMissing/System.Directory.html#createDirectoryIfMissing"><span class="hs-identifier hs-var">createDirectoryIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="../../filepath-1.4.301.0/src/System.FilePath.Posix.html#takeDirectory/System.FilePath.Posix.html#takeDirectory"><span class="hs-identifier hs-var">takeDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681907834"><span class="hs-identifier hs-var">output_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="annottext">BinHandle -&gt; [Char] -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#writeBinMem"><span class="hs-identifier hs-var">writeBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621681907857"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681907834"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><span class="hs-comment">-- | Generate the ingredients for the linkable units for this module</span></span><span>
</span><span id="line-105"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#genUnits"><span class="hs-identifier hs-type">genUnits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span>
</span><span id="line-106"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-107"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#CgStgTopBinding"><span class="hs-identifier hs-type">CgStgTopBinding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Linker.Types.html#SptEntry"><span class="hs-identifier hs-type">SptEntry</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.ForeignStubs.html#ForeignStubs"><span class="hs-identifier hs-type">ForeignStubs</span></a></span><span>
</span><span id="line-110"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ the linkable units</span></span><span>
</span><span id="line-111"></span><span id="genUnits"><span class="annot"><span class="annottext">genUnits :: (() :: Constraint) =&gt;
Module
-&gt; [CgStgTopBinding]
-&gt; [SptEntry]
-&gt; ForeignStubs
-&gt; G [LinkableUnit]
</span><a href="GHC.StgToJS.CodeGen.html#genUnits"><span class="hs-identifier hs-var hs-var">genUnits</span></a></span></span><span> </span><span id="local-6989586621681907874"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907874"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681907875"><span class="annot"><span class="annottext">[CgStgTopBinding]
</span><a href="#local-6989586621681907875"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621681907876"><span class="annot"><span class="annottext">[SptEntry]
</span><a href="#local-6989586621681907876"><span class="hs-identifier hs-var">spt_entries</span></a></span></span><span> </span><span id="local-6989586621681907877"><span class="annot"><span class="annottext">ForeignStubs
</span><a href="#local-6989586621681907877"><span class="hs-identifier hs-var">foreign_stubs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621681907878"><span class="annot"><span class="annottext">LinkableUnit
</span><a href="#local-6989586621681907878"><span class="hs-identifier hs-var">gbl</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">G LinkableUnit
(() :: Constraint) =&gt; G LinkableUnit
</span><a href="#local-6989586621681907879"><span class="hs-identifier hs-var">generateGlobalBlock</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621681907880"><span class="annot"><span class="annottext">LinkableUnit
</span><a href="#local-6989586621681907880"><span class="hs-identifier hs-var">exports</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">G LinkableUnit
(() :: Constraint) =&gt; G LinkableUnit
</span><a href="#local-6989586621681907881"><span class="hs-identifier hs-var">generateExportsBlock</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621681907882"><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907882"><span class="hs-identifier hs-var">others</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [CgStgTopBinding] -&gt; G [LinkableUnit]
(() :: Constraint) =&gt; Int -&gt; [CgStgTopBinding] -&gt; G [LinkableUnit]
</span><a href="#local-6989586621681907883"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[CgStgTopBinding]
</span><a href="#local-6989586621681907875"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">[LinkableUnit] -&gt; G [LinkableUnit]
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinkableUnit
</span><a href="#local-6989586621681907878"><span class="hs-identifier hs-var">gbl</span></a></span><span class="annot"><span class="annottext">LinkableUnit -&gt; [LinkableUnit] -&gt; [LinkableUnit]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">LinkableUnit
</span><a href="#local-6989586621681907880"><span class="hs-identifier hs-var">exports</span></a></span><span class="annot"><span class="annottext">LinkableUnit -&gt; [LinkableUnit] -&gt; [LinkableUnit]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907882"><span class="hs-identifier hs-var">others</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>      </span><span class="annot"><a href="#local-6989586621681907883"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span>
</span><span id="line-118"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                 </span><span class="hs-comment">-- the block we're generating (block 0 is the global unit for the module)</span><span>
</span><span id="line-119"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#CgStgTopBinding"><span class="hs-identifier hs-type">CgStgTopBinding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>      </span><span id="local-6989586621681907883"><span class="annot"><span class="annottext">go :: (() :: Constraint) =&gt; Int -&gt; [CgStgTopBinding] -&gt; G [LinkableUnit]
</span><a href="#local-6989586621681907883"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681907893"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681907893"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[LinkableUnit] -&gt; G [LinkableUnit]
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681907894"><span class="annot"><span class="annottext">CgStgTopBinding
</span><a href="#local-6989586621681907894"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681907895"><span class="annot"><span class="annottext">[CgStgTopBinding]
</span><a href="#local-6989586621681907895"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>          </span><span id="local-6989586621681907896"><span class="annot"><span class="annottext">Maybe LinkableUnit
</span><a href="#local-6989586621681907896"><span class="hs-identifier hs-var">mlu</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt;
CgStgTopBinding -&gt; Int -&gt; G (Maybe LinkableUnit)
CgStgTopBinding -&gt; Int -&gt; G (Maybe LinkableUnit)
</span><a href="#local-6989586621681907897"><span class="hs-identifier hs-var">generateBlock</span></a></span><span> </span><span class="annot"><span class="annottext">CgStgTopBinding
</span><a href="#local-6989586621681907894"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681907893"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-125"></span><span>          </span><span id="local-6989586621681907898"><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907898"><span class="hs-identifier hs-var">lus</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [CgStgTopBinding] -&gt; G [LinkableUnit]
(() :: Constraint) =&gt; Int -&gt; [CgStgTopBinding] -&gt; G [LinkableUnit]
</span><a href="#local-6989586621681907883"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681907893"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CgStgTopBinding]
</span><a href="#local-6989586621681907895"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-126"></span><span>          </span><span class="annot"><span class="annottext">[LinkableUnit] -&gt; G [LinkableUnit]
forall a. a -&gt; StateT GenState IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LinkableUnit]
-&gt; (LinkableUnit -&gt; [LinkableUnit])
-&gt; Maybe LinkableUnit
-&gt; [LinkableUnit]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Maybe.html#maybe/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907898"><span class="hs-identifier hs-var">lus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinkableUnit -&gt; [LinkableUnit] -&gt; [LinkableUnit]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LinkableUnit]
</span><a href="#local-6989586621681907898"><span class="hs-identifier hs-var">lus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe LinkableUnit
</span><a href="#local-6989586621681907896"><span class="hs-identifier hs-var">mlu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-comment">--   Generate the global unit that all other blocks in the module depend on</span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-comment">--   used for cost centres and static initializers</span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-comment">--   the global unit has no dependencies, exports the moduleGlobalSymbol</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><a href="#local-6989586621681907879"><span class="hs-identifier hs-type">generateGlobalBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span id="local-6989586621681907879"><span class="annot"><span class="annottext">generateGlobalBlock :: (() :: Constraint) =&gt; G LinkableUnit
</span><a href="#local-6989586621681907879"><span class="hs-identifier hs-var hs-var">generateGlobalBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>        </span><span id="local-6989586621681907911"><span class="annot"><span class="annottext">[JStat]
</span><a href="#local-6989586621681907911"><span class="hs-identifier hs-var">glbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; [JStat]) -&gt; StateT GenState IO [JStat]
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; [JStat]
</span><a href="GHC.StgToJS.Types.html#gsGlobal"><span class="hs-identifier hs-var">gsGlobal</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span id="local-6989586621681907914"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681907914"><span class="hs-identifier hs-var">staticInit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-135"></span><span>          </span><span class="annot"><span class="annottext">[SptEntry] -&gt; G JStat
</span><a href="GHC.StgToJS.StaticPtr.html#initStaticPtrs"><span class="hs-identifier hs-var">initStaticPtrs</span></a></span><span> </span><span class="annot"><span class="annottext">[SptEntry]
</span><a href="#local-6989586621681907876"><span class="hs-identifier hs-var">spt_entries</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681907916"><span class="annot"><span class="annottext">stat :: JStat
</span><a href="#local-6989586621681907916"><span class="hs-identifier hs-var hs-var">stat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- O.optimize .</span><span>
</span><span id="line-137"></span><span>                     </span><span class="annot"><span class="annottext">Maybe FastString -&gt; JStat -&gt; JStat
forall a. JMacro a =&gt; Maybe FastString -&gt; a -&gt; a
</span><a href="GHC.JS.Transform.html#jsSaturate"><span class="hs-identifier hs-var">jsSaturate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Maybe FastString
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Maybe FastString) -&gt; FastString -&gt; Maybe FastString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Int -&gt; FastString
</span><a href="GHC.StgToJS.CodeGen.html#modulePrefix"><span class="hs-identifier hs-var">modulePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907874"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                   </span><span class="annot"><span class="annottext">(JStat -&gt; JStat) -&gt; JStat -&gt; JStat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[JStat] -&gt; JStat
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mconcat/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[JStat] -&gt; [JStat]
forall a. [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#reverse/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[JStat]
</span><a href="#local-6989586621681907911"><span class="hs-identifier hs-var">glbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JStat -&gt; JStat -&gt; JStat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%3E/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681907914"><span class="hs-identifier hs-var">staticInit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681907920"><span class="annot"><span class="annottext">syms :: [FastString]
</span><a href="#local-6989586621681907920"><span class="hs-identifier hs-var hs-var">syms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Module -&gt; FastString
</span><a href="GHC.StgToJS.Symbols.html#moduleGlobalSymbol"><span class="hs-identifier hs-var">moduleGlobalSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907874"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681907922"><span class="annot"><span class="annottext">oi :: ObjUnit
</span><a href="#local-6989586621681907922"><span class="hs-identifier hs-var hs-var">oi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#ObjUnit"><span class="hs-identifier hs-type">ObjUnit</span></a></span><span>
</span><span id="line-141"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">oiSymbols :: [FastString]
</span><a href="GHC.StgToJS.Types.html#oiSymbols"><span class="hs-identifier hs-var">oiSymbols</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681907920"><span class="hs-identifier hs-var">syms</span></a></span><span>
</span><span id="line-142"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiClInfo :: [ClosureInfo]
</span><a href="GHC.StgToJS.Types.html#oiClInfo"><span class="hs-identifier hs-var">oiClInfo</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiStatic :: [StaticInfo]
</span><a href="GHC.StgToJS.Types.html#oiStatic"><span class="hs-identifier hs-var">oiStatic</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiStat :: JStat
</span><a href="GHC.StgToJS.Types.html#oiStat"><span class="hs-identifier hs-var">oiStat</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681907916"><span class="hs-identifier hs-var">stat</span></a></span><span>
</span><span id="line-145"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiRaw :: ByteString
</span><a href="GHC.StgToJS.Types.html#oiRaw"><span class="hs-identifier hs-var">oiRaw</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-146"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiFExports :: [ExpFun]
</span><a href="GHC.StgToJS.Types.html#oiFExports"><span class="hs-identifier hs-var">oiFExports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiFImports :: [ForeignJSRef]
</span><a href="GHC.StgToJS.Types.html#oiFImports"><span class="hs-identifier hs-var">oiFImports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681907930"><span class="annot"><span class="annottext">lu :: LinkableUnit
</span><a href="#local-6989586621681907930"><span class="hs-identifier hs-var hs-var">lu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span>
</span><span id="line-150"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">luObjUnit :: ObjUnit
</span><a href="GHC.StgToJS.Types.html#luObjUnit"><span class="hs-identifier hs-var">luObjUnit</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjUnit
</span><a href="#local-6989586621681907922"><span class="hs-identifier hs-var">oi</span></a></span><span>
</span><span id="line-151"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luIdExports :: [Id]
</span><a href="GHC.StgToJS.Types.html#luIdExports"><span class="hs-identifier hs-var">luIdExports</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luOtherExports :: [FastString]
</span><a href="#local-6989586621681907933"><span class="hs-identifier hs-var">luOtherExports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681907920"><span class="hs-identifier hs-var">syms</span></a></span><span>
</span><span id="line-153"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luIdDeps :: [Id]
</span><a href="#local-6989586621681907934"><span class="hs-identifier hs-var">luIdDeps</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luPseudoIdDeps :: [Unique]
</span><a href="#local-6989586621681907935"><span class="hs-identifier hs-var">luPseudoIdDeps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luOtherDeps :: [OtherSymb]
</span><a href="#local-6989586621681907936"><span class="hs-identifier hs-var">luOtherDeps</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luRequired :: Bool
</span><a href="#local-6989586621681907937"><span class="hs-identifier hs-var">luRequired</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-157"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luForeignRefs :: [ForeignJSRef]
</span><a href="#local-6989586621681907938"><span class="hs-identifier hs-var">luForeignRefs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">LinkableUnit -&gt; G LinkableUnit
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">LinkableUnit
</span><a href="#local-6989586621681907930"><span class="hs-identifier hs-var">lu</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><a href="#local-6989586621681907881"><span class="hs-identifier hs-type">generateExportsBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span id="local-6989586621681907881"><span class="annot"><span class="annottext">generateExportsBlock :: (() :: Constraint) =&gt; G LinkableUnit
</span><a href="#local-6989586621681907881"><span class="hs-identifier hs-var hs-var">generateExportsBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681907945"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681907945"><span class="hs-identifier hs-var">f_hdr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681907946"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681907946"><span class="hs-identifier hs-var">f_c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForeignStubs
</span><a href="#local-6989586621681907877"><span class="hs-identifier hs-var">foreign_stubs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>                                  </span><span class="annot"><span class="annottext">ForeignStubs
</span><a href="GHC.Types.ForeignStubs.html#NoStubs"><span class="hs-identifier hs-var">NoStubs</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>                                  </span><span class="annot"><a href="GHC.Types.ForeignStubs.html#ForeignStubs"><span class="hs-identifier hs-type">ForeignStubs</span></a></span><span> </span><span id="local-6989586621681907950"><span class="annot"><span class="annottext">CHeader
</span><a href="#local-6989586621681907950"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span id="local-6989586621681907951"><span class="annot"><span class="annottext">CStub
</span><a href="#local-6989586621681907951"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CHeader -&gt; SDoc
</span><a href="GHC.Types.ForeignStubs.html#getCHeader"><span class="hs-identifier hs-var">getCHeader</span></a></span><span> </span><span class="annot"><span class="annottext">CHeader
</span><a href="#local-6989586621681907950"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CStub -&gt; SDoc
</span><a href="GHC.Types.ForeignStubs.html#getCStub"><span class="hs-identifier hs-var">getCStub</span></a></span><span> </span><span class="annot"><span class="annottext">CStub
</span><a href="#local-6989586621681907951"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>            </span><span id="local-6989586621681907952"><span class="annot"><span class="annottext">unique_deps :: [Unique]
</span><a href="#local-6989586621681907952"><span class="hs-identifier hs-var hs-var">unique_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Unique) -&gt; [[Char]] -&gt; [Unique]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Unique
</span><a href="#local-6989586621681907953"><span class="hs-identifier hs-var">mkUniqueDep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]]
</span><a href="../../base-4.18.3.0/src/Data.OldList.html#lines/Data.OldList.html#lines"><span class="hs-identifier hs-var">lines</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [[Char]]) -&gt; [Char] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; SDoc -&gt; [Char]
</span><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-var">renderWithContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="GHC.Utils.Outputable.html#defaultSDocContext"><span class="hs-identifier hs-var">defaultSDocContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681907945"><span class="hs-identifier hs-var">f_hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>            </span><span id="local-6989586621681907953"><span class="annot"><span class="annottext">mkUniqueDep :: [Char] -&gt; Unique
</span><a href="#local-6989586621681907953"><span class="hs-identifier hs-var hs-var">mkUniqueDep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681907961"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681907961"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681907962"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681907962"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Word64 -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkUnique"><span class="hs-identifier hs-var">mkUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681907961"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Word64
forall a. Read a =&gt; [Char] -&gt; a
</span><a href="../../base-4.18.3.0/src/Text.Read.html#read/Text.Read.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681907962"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><a href="#local-6989586621681907953"><span class="hs-identifier hs-var">mkUniqueDep</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Unique
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;mkUniqueDep&quot;</span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681907966"><span class="annot"><span class="annottext">syms :: [FastString]
</span><a href="#local-6989586621681907966"><span class="hs-identifier hs-var hs-var">syms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Module -&gt; FastString
</span><a href="GHC.StgToJS.Symbols.html#moduleExportsSymbol"><span class="hs-identifier hs-var">moduleExportsSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907874"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681907968"><span class="annot"><span class="annottext">raw :: ByteString
</span><a href="#local-6989586621681907968"><span class="hs-identifier hs-var hs-var">raw</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ByteString
</span><a href="../../ghc-boot-9.6.7/src/GHC.Utils.Encoding.UTF8.html#utf8EncodeByteString/GHC.Utils.Encoding.UTF8.html#utf8EncodeByteString"><span class="hs-identifier hs-var">utf8EncodeByteString</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ByteString) -&gt; [Char] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; SDoc -&gt; [Char]
</span><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-var">renderWithContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="GHC.Utils.Outputable.html#defaultSDocContext"><span class="hs-identifier hs-var">defaultSDocContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681907946"><span class="hs-identifier hs-var">f_c</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681907970"><span class="annot"><span class="annottext">oi :: ObjUnit
</span><a href="#local-6989586621681907970"><span class="hs-identifier hs-var hs-var">oi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#ObjUnit"><span class="hs-identifier hs-type">ObjUnit</span></a></span><span>
</span><span id="line-173"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">oiSymbols :: [FastString]
</span><a href="GHC.StgToJS.Types.html#oiSymbols"><span class="hs-identifier hs-var">oiSymbols</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681907966"><span class="hs-identifier hs-var">syms</span></a></span><span>
</span><span id="line-174"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiClInfo :: [ClosureInfo]
</span><a href="GHC.StgToJS.Types.html#oiClInfo"><span class="hs-identifier hs-var">oiClInfo</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiStatic :: [StaticInfo]
</span><a href="GHC.StgToJS.Types.html#oiStatic"><span class="hs-identifier hs-var">oiStatic</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiStat :: JStat
</span><a href="GHC.StgToJS.Types.html#oiStat"><span class="hs-identifier hs-var">oiStat</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JStat
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-177"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiRaw :: ByteString
</span><a href="GHC.StgToJS.Types.html#oiRaw"><span class="hs-identifier hs-var">oiRaw</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681907968"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-178"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiFExports :: [ExpFun]
</span><a href="GHC.StgToJS.Types.html#oiFExports"><span class="hs-identifier hs-var">oiFExports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiFImports :: [ForeignJSRef]
</span><a href="GHC.StgToJS.Types.html#oiFImports"><span class="hs-identifier hs-var">oiFImports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681907971"><span class="annot"><span class="annottext">lu :: LinkableUnit
</span><a href="#local-6989586621681907971"><span class="hs-identifier hs-var hs-var">lu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span>
</span><span id="line-182"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">luObjUnit :: ObjUnit
</span><a href="GHC.StgToJS.Types.html#luObjUnit"><span class="hs-identifier hs-var">luObjUnit</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjUnit
</span><a href="#local-6989586621681907970"><span class="hs-identifier hs-var">oi</span></a></span><span>
</span><span id="line-183"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luIdExports :: [Id]
</span><a href="GHC.StgToJS.Types.html#luIdExports"><span class="hs-identifier hs-var">luIdExports</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luOtherExports :: [FastString]
</span><a href="#local-6989586621681907933"><span class="hs-identifier hs-var">luOtherExports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681907966"><span class="hs-identifier hs-var">syms</span></a></span><span>
</span><span id="line-185"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luIdDeps :: [Id]
</span><a href="#local-6989586621681907934"><span class="hs-identifier hs-var">luIdDeps</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luPseudoIdDeps :: [Unique]
</span><a href="#local-6989586621681907935"><span class="hs-identifier hs-var">luPseudoIdDeps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Unique]
</span><a href="#local-6989586621681907952"><span class="hs-identifier hs-var">unique_deps</span></a></span><span>
</span><span id="line-187"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luOtherDeps :: [OtherSymb]
</span><a href="#local-6989586621681907936"><span class="hs-identifier hs-var">luOtherDeps</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luRequired :: Bool
</span><a href="#local-6989586621681907937"><span class="hs-identifier hs-var">luRequired</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-189"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luForeignRefs :: [ForeignJSRef]
</span><a href="#local-6989586621681907938"><span class="hs-identifier hs-var">luForeignRefs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-190"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">LinkableUnit -&gt; G LinkableUnit
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">LinkableUnit
</span><a href="#local-6989586621681907971"><span class="hs-identifier hs-var">lu</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-comment">--   Generate the linkable unit for one binding or group of</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-comment">--   mutually recursive bindings</span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><a href="#local-6989586621681907897"><span class="hs-identifier hs-type">generateBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span>
</span><span id="line-196"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#CgStgTopBinding"><span class="hs-identifier hs-type">CgStgTopBinding</span></a></span><span>
</span><span id="line-197"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-198"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>      </span><span id="local-6989586621681907897"><span class="annot"><span class="annottext">generateBlock :: (() :: Constraint) =&gt;
CgStgTopBinding -&gt; Int -&gt; G (Maybe LinkableUnit)
</span><a href="#local-6989586621681907897"><span class="hs-identifier hs-var hs-var">generateBlock</span></a></span></span><span> </span><span id="local-6989586621681908011"><span class="annot"><span class="annottext">CgStgTopBinding
</span><a href="#local-6989586621681908011"><span class="hs-identifier hs-var">top_bind</span></a></span></span><span> </span><span id="local-6989586621681908012"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681908012"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CgStgTopBinding
</span><a href="#local-6989586621681908011"><span class="hs-identifier hs-var">top_bind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTopStringLit"><span class="hs-identifier hs-type">StgTopStringLit</span></a></span><span> </span><span id="local-6989586621681908014"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908014"><span class="hs-identifier hs-var">bnd</span></a></span></span><span> </span><span id="local-6989586621681908015"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681908015"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>          </span><span id="local-6989586621681908016"><span class="annot"><span class="annottext">[Ident]
</span><a href="#local-6989586621681908016"><span class="hs-identifier hs-var">bids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; G [Ident]
</span><a href="GHC.StgToJS.Ids.html#identsForId"><span class="hs-identifier hs-var">identsForId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908014"><span class="hs-identifier hs-var">bnd</span></a></span><span>
</span><span id="line-202"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ident]
</span><a href="#local-6989586621681908016"><span class="hs-identifier hs-var">bids</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.JS.Syntax.html#TxtI"><span class="hs-identifier hs-type">TxtI</span></a></span><span> </span><span id="local-6989586621681908019"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908019"><span class="hs-identifier hs-var">b1t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="GHC.JS.Syntax.html#TxtI"><span class="hs-identifier hs-type">TxtI</span></a></span><span> </span><span id="local-6989586621681908020"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908020"><span class="hs-identifier hs-var">b2t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>              </span><span class="hs-comment">-- [e1,e2] &lt;- genLit (MachStr str)</span><span>
</span><span id="line-205"></span><span>              </span><span class="annot"><span class="annottext">FastString -&gt; StaticVal -&gt; Maybe Ident -&gt; G ()
</span><a href="GHC.StgToJS.Monad.html#emitStatic"><span class="hs-identifier hs-var">emitStatic</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908019"><span class="hs-identifier hs-var">b1t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StaticUnboxed -&gt; StaticVal
</span><a href="GHC.StgToJS.Types.html#StaticUnboxed"><span class="hs-identifier hs-var">StaticUnboxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; StaticUnboxed
</span><a href="GHC.StgToJS.Types.html#StaticUnboxedString"><span class="hs-identifier hs-var">StaticUnboxedString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681908015"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Ident
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-206"></span><span>              </span><span class="annot"><span class="annottext">FastString -&gt; StaticVal -&gt; Maybe Ident -&gt; G ()
</span><a href="GHC.StgToJS.Monad.html#emitStatic"><span class="hs-identifier hs-var">emitStatic</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908020"><span class="hs-identifier hs-var">b2t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StaticUnboxed -&gt; StaticVal
</span><a href="GHC.StgToJS.Types.html#StaticUnboxed"><span class="hs-identifier hs-var">StaticUnboxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; StaticUnboxed
</span><a href="GHC.StgToJS.Types.html#StaticUnboxedStringOffset"><span class="hs-identifier hs-var">StaticUnboxedStringOffset</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681908015"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Ident
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-207"></span><span>              </span><span id="local-6989586621681908025"><span class="annot"><span class="annottext">[JStat]
</span><a href="#local-6989586621681908025"><span class="hs-identifier hs-var">_extraTl</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; [JStat]) -&gt; StateT GenState IO [JStat]
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenGroupState -&gt; [JStat]
</span><a href="GHC.StgToJS.Types.html#ggsToplevelStats"><span class="hs-identifier hs-var">ggsToplevelStats</span></a></span><span> </span><span class="annot"><span class="annottext">(GenGroupState -&gt; [JStat])
-&gt; (GenState -&gt; GenGroupState) -&gt; GenState -&gt; [JStat]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; GenGroupState
</span><a href="GHC.StgToJS.Types.html#gsGroup"><span class="hs-identifier hs-var">gsGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>              </span><span id="local-6989586621681908028"><span class="annot"><span class="annottext">[StaticInfo]
</span><a href="#local-6989586621681908028"><span class="hs-identifier hs-var">si</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; [StaticInfo]) -&gt; StateT GenState IO [StaticInfo]
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenGroupState -&gt; [StaticInfo]
</span><a href="GHC.StgToJS.Types.html#ggsStatic"><span class="hs-identifier hs-var">ggsStatic</span></a></span><span> </span><span class="annot"><span class="annottext">(GenGroupState -&gt; [StaticInfo])
-&gt; (GenState -&gt; GenGroupState) -&gt; GenState -&gt; [StaticInfo]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; GenGroupState
</span><a href="GHC.StgToJS.Types.html#gsGroup"><span class="hs-identifier hs-var">gsGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908032"><span class="annot"><span class="annottext">body :: JStat
</span><a href="#local-6989586621681908032"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JStat
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-comment">-- mconcat (reverse extraTl) &lt;&gt; b1 ||= e1 &lt;&gt; b2 ||= e2</span><span>
</span><span id="line-210"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908033"><span class="annot"><span class="annottext">stat :: JStat
</span><a href="#local-6989586621681908033"><span class="hs-identifier hs-var hs-var">stat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FastString -&gt; JStat -&gt; JStat
forall a. JMacro a =&gt; Maybe FastString -&gt; a -&gt; a
</span><a href="GHC.JS.Transform.html#jsSaturate"><span class="hs-identifier hs-var">jsSaturate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Maybe FastString
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Maybe FastString) -&gt; FastString -&gt; Maybe FastString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Int -&gt; FastString
</span><a href="GHC.StgToJS.CodeGen.html#modulePrefix"><span class="hs-identifier hs-var">modulePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907874"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681908012"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908032"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-211"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908034"><span class="annot"><span class="annottext">ids :: [Id]
</span><a href="#local-6989586621681908034"><span class="hs-identifier hs-var hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908014"><span class="hs-identifier hs-var">bnd</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>              </span><span id="local-6989586621681908035"><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908035"><span class="hs-identifier hs-var">syms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.JS.Syntax.html#TxtI"><span class="hs-identifier hs-type">TxtI</span></a></span><span> </span><span id="local-6989586621681908036"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908036"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908036"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Ident -&gt; [FastString])
-&gt; StateT GenState IO Ident -&gt; StateT GenState IO [FastString]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; StateT GenState IO Ident
</span><a href="GHC.StgToJS.Ids.html#identForId"><span class="hs-identifier hs-var">identForId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908014"><span class="hs-identifier hs-var">bnd</span></a></span><span>
</span><span id="line-213"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908039"><span class="annot"><span class="annottext">oi :: ObjUnit
</span><a href="#local-6989586621681908039"><span class="hs-identifier hs-var hs-var">oi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#ObjUnit"><span class="hs-identifier hs-type">ObjUnit</span></a></span><span>
</span><span id="line-214"></span><span>                        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">oiSymbols :: [FastString]
</span><a href="GHC.StgToJS.Types.html#oiSymbols"><span class="hs-identifier hs-var">oiSymbols</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908035"><span class="hs-identifier hs-var">syms</span></a></span><span>
</span><span id="line-215"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiClInfo :: [ClosureInfo]
</span><a href="GHC.StgToJS.Types.html#oiClInfo"><span class="hs-identifier hs-var">oiClInfo</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiStatic :: [StaticInfo]
</span><a href="GHC.StgToJS.Types.html#oiStatic"><span class="hs-identifier hs-var">oiStatic</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StaticInfo]
</span><a href="#local-6989586621681908028"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-217"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiStat :: JStat
</span><a href="GHC.StgToJS.Types.html#oiStat"><span class="hs-identifier hs-var">oiStat</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908033"><span class="hs-identifier hs-var">stat</span></a></span><span>
</span><span id="line-218"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiRaw :: ByteString
</span><a href="GHC.StgToJS.Types.html#oiRaw"><span class="hs-identifier hs-var">oiRaw</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-219"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiFExports :: [ExpFun]
</span><a href="GHC.StgToJS.Types.html#oiFExports"><span class="hs-identifier hs-var">oiFExports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiFImports :: [ForeignJSRef]
</span><a href="GHC.StgToJS.Types.html#oiFImports"><span class="hs-identifier hs-var">oiFImports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-222"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908040"><span class="annot"><span class="annottext">lu :: LinkableUnit
</span><a href="#local-6989586621681908040"><span class="hs-identifier hs-var hs-var">lu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span>
</span><span id="line-223"></span><span>                        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">luObjUnit :: ObjUnit
</span><a href="GHC.StgToJS.Types.html#luObjUnit"><span class="hs-identifier hs-var">luObjUnit</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjUnit
</span><a href="#local-6989586621681908039"><span class="hs-identifier hs-var">oi</span></a></span><span>
</span><span id="line-224"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luIdExports :: [Id]
</span><a href="GHC.StgToJS.Types.html#luIdExports"><span class="hs-identifier hs-var">luIdExports</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681908034"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-225"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luOtherExports :: [FastString]
</span><a href="#local-6989586621681907933"><span class="hs-identifier hs-var">luOtherExports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luIdDeps :: [Id]
</span><a href="#local-6989586621681907934"><span class="hs-identifier hs-var">luIdDeps</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luPseudoIdDeps :: [Unique]
</span><a href="#local-6989586621681907935"><span class="hs-identifier hs-var">luPseudoIdDeps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-228"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luOtherDeps :: [OtherSymb]
</span><a href="#local-6989586621681907936"><span class="hs-identifier hs-var">luOtherDeps</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luRequired :: Bool
</span><a href="#local-6989586621681907937"><span class="hs-identifier hs-var">luRequired</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-230"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luForeignRefs :: [ForeignJSRef]
</span><a href="#local-6989586621681907938"><span class="hs-identifier hs-var">luForeignRefs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-232"></span><span>              </span><span class="annot"><span class="annottext">Maybe LinkableUnit -&gt; G (Maybe LinkableUnit)
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinkableUnit -&gt; Maybe LinkableUnit
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">LinkableUnit
</span><a href="#local-6989586621681908040"><span class="hs-identifier hs-var">lu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>            </span><span class="annot"><span class="annottext">[Ident]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; G (Maybe LinkableUnit)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;generateBlock: invalid size&quot;</span></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTopLifted"><span class="hs-identifier hs-type">StgTopLifted</span></a></span><span> </span><span id="local-6989586621681908042"><span class="annot"><span class="annottext">GenStgBinding 'CodeGen
</span><a href="#local-6989586621681908042"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>          </span><span id="local-6989586621681908043"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908043"><span class="hs-identifier hs-var">tl</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevel"><span class="hs-identifier hs-var">genToplevel</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'CodeGen
</span><a href="#local-6989586621681908042"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-237"></span><span>          </span><span id="local-6989586621681908045"><span class="annot"><span class="annottext">[JStat]
</span><a href="#local-6989586621681908045"><span class="hs-identifier hs-var">extraTl</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; [JStat]) -&gt; StateT GenState IO [JStat]
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenGroupState -&gt; [JStat]
</span><a href="GHC.StgToJS.Types.html#ggsToplevelStats"><span class="hs-identifier hs-var">ggsToplevelStats</span></a></span><span> </span><span class="annot"><span class="annottext">(GenGroupState -&gt; [JStat])
-&gt; (GenState -&gt; GenGroupState) -&gt; GenState -&gt; [JStat]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; GenGroupState
</span><a href="GHC.StgToJS.Types.html#gsGroup"><span class="hs-identifier hs-var">gsGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>          </span><span id="local-6989586621681908046"><span class="annot"><span class="annottext">[ClosureInfo]
</span><a href="#local-6989586621681908046"><span class="hs-identifier hs-var">ci</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; [ClosureInfo]) -&gt; StateT GenState IO [ClosureInfo]
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenGroupState -&gt; [ClosureInfo]
</span><a href="GHC.StgToJS.Types.html#ggsClosureInfo"><span class="hs-identifier hs-var">ggsClosureInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(GenGroupState -&gt; [ClosureInfo])
-&gt; (GenState -&gt; GenGroupState) -&gt; GenState -&gt; [ClosureInfo]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; GenGroupState
</span><a href="GHC.StgToJS.Types.html#gsGroup"><span class="hs-identifier hs-var">gsGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>          </span><span id="local-6989586621681908048"><span class="annot"><span class="annottext">[StaticInfo]
</span><a href="#local-6989586621681908048"><span class="hs-identifier hs-var">si</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; [StaticInfo]) -&gt; StateT GenState IO [StaticInfo]
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenGroupState -&gt; [StaticInfo]
</span><a href="GHC.StgToJS.Types.html#ggsStatic"><span class="hs-identifier hs-var">ggsStatic</span></a></span><span> </span><span class="annot"><span class="annottext">(GenGroupState -&gt; [StaticInfo])
-&gt; (GenState -&gt; GenGroupState) -&gt; GenState -&gt; [StaticInfo]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; GenGroupState
</span><a href="GHC.StgToJS.Types.html#gsGroup"><span class="hs-identifier hs-var">gsGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>          </span><span id="local-6989586621681908049"><span class="annot"><span class="annottext">UniqFM Id CgStgExpr
</span><a href="#local-6989586621681908049"><span class="hs-identifier hs-var">unf</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; UniqFM Id CgStgExpr)
-&gt; StateT GenState IO (UniqFM Id CgStgExpr)
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; UniqFM Id CgStgExpr
</span><a href="GHC.StgToJS.Types.html#gsUnfloated"><span class="hs-identifier hs-var">gsUnfloated</span></a></span><span>
</span><span id="line-241"></span><span>          </span><span id="local-6989586621681908051"><span class="annot"><span class="annottext">Set OtherSymb
</span><a href="#local-6989586621681908051"><span class="hs-identifier hs-var">extraDeps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; Set OtherSymb) -&gt; StateT GenState IO (Set OtherSymb)
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenGroupState -&gt; Set OtherSymb
</span><a href="GHC.StgToJS.Types.html#ggsExtraDeps"><span class="hs-identifier hs-var">ggsExtraDeps</span></a></span><span> </span><span class="annot"><span class="annottext">(GenGroupState -&gt; Set OtherSymb)
-&gt; (GenState -&gt; GenGroupState) -&gt; GenState -&gt; Set OtherSymb
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; GenGroupState
</span><a href="GHC.StgToJS.Types.html#gsGroup"><span class="hs-identifier hs-var">gsGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>          </span><span id="local-6989586621681908053"><span class="annot"><span class="annottext">[ForeignJSRef]
</span><a href="#local-6989586621681908053"><span class="hs-identifier hs-var">fRefs</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState -&gt; [ForeignJSRef]) -&gt; StateT GenState IO [ForeignJSRef]
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.0/src/Control.Monad.Trans.State.Strict.html#gets/Control.Monad.Trans.State.Strict.html#gets"><span class="hs-identifier hs-var">State.gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenGroupState -&gt; [ForeignJSRef]
</span><a href="GHC.StgToJS.Types.html#ggsForeignRefs"><span class="hs-identifier hs-var">ggsForeignRefs</span></a></span><span> </span><span class="annot"><span class="annottext">(GenGroupState -&gt; [ForeignJSRef])
-&gt; (GenState -&gt; GenGroupState) -&gt; GenState -&gt; [ForeignJSRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenState -&gt; GenGroupState
</span><a href="GHC.StgToJS.Types.html#gsGroup"><span class="hs-identifier hs-var">gsGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>          </span><span class="annot"><span class="annottext">G ()
</span><a href="GHC.StgToJS.Monad.html#resetGroup"><span class="hs-identifier hs-var">resetGroup</span></a></span><span>
</span><span id="line-244"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908056"><span class="annot"><span class="annottext">allDeps :: [Id]
</span><a href="#local-6989586621681908056"><span class="hs-identifier hs-var hs-var">allDeps</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqFM Id CgStgExpr -&gt; GenStgBinding 'CodeGen -&gt; [Id]
</span><a href="GHC.StgToJS.StgUtils.html#collectIds"><span class="hs-identifier hs-var">collectIds</span></a></span><span> </span><span class="annot"><span class="annottext">UniqFM Id CgStgExpr
</span><a href="#local-6989586621681908049"><span class="hs-identifier hs-var">unf</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'CodeGen
</span><a href="#local-6989586621681908042"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-245"></span><span>              </span><span id="local-6989586621681908058"><span class="annot"><span class="annottext">topDeps :: [Id]
</span><a href="#local-6989586621681908058"><span class="hs-identifier hs-var hs-var">topDeps</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'CodeGen -&gt; [Id]
</span><a href="GHC.StgToJS.StgUtils.html#collectTopIds"><span class="hs-identifier hs-var">collectTopIds</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'CodeGen
</span><a href="#local-6989586621681908042"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-246"></span><span>              </span><span id="local-6989586621681908060"><span class="annot"><span class="annottext">required :: Bool
</span><a href="#local-6989586621681908060"><span class="hs-identifier hs-var hs-var">required</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'CodeGen -&gt; Bool
</span><a href="GHC.StgToJS.StgUtils.html#hasExport"><span class="hs-identifier hs-var">hasExport</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'CodeGen
</span><a href="#local-6989586621681908042"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-247"></span><span>              </span><span id="local-6989586621681908062"><span class="annot"><span class="annottext">stat :: JStat
</span><a href="#local-6989586621681908062"><span class="hs-identifier hs-var hs-var">stat</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Opt.optimize .</span><span>
</span><span id="line-248"></span><span>                         </span><span class="annot"><span class="annottext">Maybe FastString -&gt; JStat -&gt; JStat
forall a. JMacro a =&gt; Maybe FastString -&gt; a -&gt; a
</span><a href="GHC.JS.Transform.html#jsSaturate"><span class="hs-identifier hs-var">jsSaturate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Maybe FastString
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Maybe FastString) -&gt; FastString -&gt; Maybe FastString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Int -&gt; FastString
</span><a href="GHC.StgToJS.CodeGen.html#modulePrefix"><span class="hs-identifier hs-var">modulePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681907874"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681908012"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>                       </span><span class="annot"><span class="annottext">(JStat -&gt; JStat) -&gt; JStat -&gt; JStat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[JStat] -&gt; JStat
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mconcat/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[JStat] -&gt; [JStat]
forall a. [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#reverse/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[JStat]
</span><a href="#local-6989586621681908045"><span class="hs-identifier hs-var">extraTl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JStat -&gt; JStat -&gt; JStat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%3E/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908043"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-250"></span><span>          </span><span id="local-6989586621681908063"><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908063"><span class="hs-identifier hs-var">syms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; StateT GenState IO FastString)
-&gt; [Id] -&gt; StateT GenState IO [FastString]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ident -&gt; FastString)
-&gt; StateT GenState IO Ident -&gt; StateT GenState IO FastString
forall a b.
(a -&gt; b) -&gt; StateT GenState IO a -&gt; StateT GenState IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.JS.Syntax.html#TxtI"><span class="hs-identifier hs-type">TxtI</span></a></span><span> </span><span id="local-6989586621681908065"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908065"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908065"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT GenState IO Ident -&gt; StateT GenState IO FastString)
-&gt; (Id -&gt; StateT GenState IO Ident)
-&gt; Id
-&gt; StateT GenState IO FastString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; StateT GenState IO Ident
</span><a href="GHC.StgToJS.Ids.html#identForId"><span class="hs-identifier hs-var">identForId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681908058"><span class="hs-identifier hs-var">topDeps</span></a></span><span>
</span><span id="line-251"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908066"><span class="annot"><span class="annottext">oi :: ObjUnit
</span><a href="#local-6989586621681908066"><span class="hs-identifier hs-var hs-var">oi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#ObjUnit"><span class="hs-identifier hs-type">ObjUnit</span></a></span><span>
</span><span id="line-252"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">oiSymbols :: [FastString]
</span><a href="GHC.StgToJS.Types.html#oiSymbols"><span class="hs-identifier hs-var">oiSymbols</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908063"><span class="hs-identifier hs-var">syms</span></a></span><span>
</span><span id="line-253"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiClInfo :: [ClosureInfo]
</span><a href="GHC.StgToJS.Types.html#oiClInfo"><span class="hs-identifier hs-var">oiClInfo</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ClosureInfo]
</span><a href="#local-6989586621681908046"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-254"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiStatic :: [StaticInfo]
</span><a href="GHC.StgToJS.Types.html#oiStatic"><span class="hs-identifier hs-var">oiStatic</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StaticInfo]
</span><a href="#local-6989586621681908048"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-255"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiStat :: JStat
</span><a href="GHC.StgToJS.Types.html#oiStat"><span class="hs-identifier hs-var">oiStat</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908062"><span class="hs-identifier hs-var">stat</span></a></span><span>
</span><span id="line-256"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiRaw :: ByteString
</span><a href="GHC.StgToJS.Types.html#oiRaw"><span class="hs-identifier hs-var">oiRaw</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-257"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiFExports :: [ExpFun]
</span><a href="GHC.StgToJS.Types.html#oiFExports"><span class="hs-identifier hs-var">oiFExports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oiFImports :: [ForeignJSRef]
</span><a href="GHC.StgToJS.Types.html#oiFImports"><span class="hs-identifier hs-var">oiFImports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ForeignJSRef]
</span><a href="#local-6989586621681908053"><span class="hs-identifier hs-var">fRefs</span></a></span><span>
</span><span id="line-259"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-260"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908067"><span class="annot"><span class="annottext">lu :: LinkableUnit
</span><a href="#local-6989586621681908067"><span class="hs-identifier hs-var hs-var">lu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#LinkableUnit"><span class="hs-identifier hs-type">LinkableUnit</span></a></span><span>
</span><span id="line-261"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">luObjUnit :: ObjUnit
</span><a href="GHC.StgToJS.Types.html#luObjUnit"><span class="hs-identifier hs-var">luObjUnit</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjUnit
</span><a href="#local-6989586621681908066"><span class="hs-identifier hs-var">oi</span></a></span><span>
</span><span id="line-262"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luIdExports :: [Id]
</span><a href="GHC.StgToJS.Types.html#luIdExports"><span class="hs-identifier hs-var">luIdExports</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681908058"><span class="hs-identifier hs-var">topDeps</span></a></span><span>
</span><span id="line-263"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luOtherExports :: [FastString]
</span><a href="#local-6989586621681907933"><span class="hs-identifier hs-var">luOtherExports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-264"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luIdDeps :: [Id]
</span><a href="#local-6989586621681907934"><span class="hs-identifier hs-var">luIdDeps</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681908056"><span class="hs-identifier hs-var">allDeps</span></a></span><span>
</span><span id="line-265"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luPseudoIdDeps :: [Unique]
</span><a href="#local-6989586621681907935"><span class="hs-identifier hs-var">luPseudoIdDeps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luOtherDeps :: [OtherSymb]
</span><a href="#local-6989586621681907936"><span class="hs-identifier hs-var">luOtherDeps</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set OtherSymb -&gt; [OtherSymb]
forall a. Set a -&gt; [a]
</span><a href="../../containers-0.6.7/src/Data.Set.Internal.html#toList/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set OtherSymb
</span><a href="#local-6989586621681908051"><span class="hs-identifier hs-var">extraDeps</span></a></span><span>
</span><span id="line-267"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luRequired :: Bool
</span><a href="#local-6989586621681907937"><span class="hs-identifier hs-var">luRequired</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681908060"><span class="hs-identifier hs-var">required</span></a></span><span>
</span><span id="line-268"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">luForeignRefs :: [ForeignJSRef]
</span><a href="#local-6989586621681907938"><span class="hs-identifier hs-var">luForeignRefs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ForeignJSRef]
</span><a href="#local-6989586621681908053"><span class="hs-identifier hs-var">fRefs</span></a></span><span>
</span><span id="line-269"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>          </span><span class="annot"><span class="annottext">Maybe LinkableUnit -&gt; G (Maybe LinkableUnit)
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe LinkableUnit -&gt; G (Maybe LinkableUnit))
-&gt; Maybe LinkableUnit -&gt; G (Maybe LinkableUnit)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Any -&gt; Any
forall a b. [a] -&gt; b -&gt; b
</span><a href="GHC.Utils.Misc.html#seqList"><span class="hs-identifier hs-var">seqList</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681908058"><span class="hs-identifier hs-var">topDeps</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; Any) -&gt; Maybe LinkableUnit -&gt; Maybe LinkableUnit
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Any -&gt; Any
forall a b. [a] -&gt; b -&gt; b
</span><a href="GHC.Utils.Misc.html#seqList"><span class="hs-identifier hs-var">seqList</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681908056"><span class="hs-identifier hs-var">allDeps</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; Any) -&gt; Maybe LinkableUnit -&gt; Maybe LinkableUnit
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">LinkableUnit -&gt; Maybe LinkableUnit
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">LinkableUnit
</span><a href="#local-6989586621681908067"><span class="hs-identifier hs-var">lu</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="annot"><span class="hs-comment">-- | variable prefix for the nth block in module</span></span><span>
</span><span id="line-273"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#modulePrefix"><span class="hs-identifier hs-type">modulePrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-274"></span><span id="modulePrefix"><span class="annot"><span class="annottext">modulePrefix :: Module -&gt; Int -&gt; FastString
</span><a href="GHC.StgToJS.CodeGen.html#modulePrefix"><span class="hs-identifier hs-var hs-var">modulePrefix</span></a></span></span><span> </span><span id="local-6989586621681908071"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681908071"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681908072"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681908072"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908073"><span class="annot"><span class="annottext">encMod :: [Char]
</span><a href="#local-6989586621681908073"><span class="hs-identifier hs-var hs-var">encMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="../../ghc-boot-9.6.7/src/GHC.Utils.Encoding.html#zEncodeString/GHC.Utils.Encoding.html#zEncodeString"><span class="hs-identifier hs-var">zEncodeString</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (Module -&gt; [Char]) -&gt; Module -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; [Char]
</span><a href="Language.Haskell.Syntax.Module.Name.html#moduleNameString"><span class="hs-identifier hs-var">moduleNameString</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; [Char])
-&gt; (Module -&gt; ModuleName) -&gt; Module -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; ModuleName
forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">(Module -&gt; [Char]) -&gt; Module -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681908071"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; FastString) -&gt; [Char] -&gt; FastString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;h$&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681908073"><span class="hs-identifier hs-var">encMod</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;_id_&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../base-4.18.3.0/src/GHC.Show.html#show/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681908072"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#genToplevel"><span class="hs-identifier hs-type">genToplevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#CgStgBinding"><span class="hs-identifier hs-type">CgStgBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="annot"><a href="GHC.JS.Syntax.html#JStat"><span class="hs-identifier hs-type">JStat</span></a></span><span>
</span><span id="line-279"></span><span id="genToplevel"><span class="annot"><span class="annottext">genToplevel :: GenStgBinding 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevel"><span class="hs-identifier hs-var hs-var">genToplevel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgNonRec"><span class="hs-identifier hs-type">StgNonRec</span></a></span><span> </span><span id="local-6989586621681908080"><span class="annot"><span class="annottext">BinderP 'CodeGen
</span><a href="#local-6989586621681908080"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621681908081"><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908081"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; GenStgRhs 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevelDecl"><span class="hs-identifier hs-var">genToplevelDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'CodeGen
</span><a href="#local-6989586621681908080"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908081"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-280"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#genToplevel"><span class="hs-identifier hs-var">genToplevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRec"><span class="hs-identifier hs-type">StgRec</span></a></span><span> </span><span id="local-6989586621681908084"><span class="annot"><span class="annottext">[(BinderP 'CodeGen, GenStgRhs 'CodeGen)]
</span><a href="#local-6989586621681908084"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="annottext">[JStat] -&gt; JStat
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mconcat/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="annot"><span class="annottext">([JStat] -&gt; JStat) -&gt; StateT GenState IO [JStat] -&gt; G JStat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((Id, GenStgRhs 'CodeGen) -&gt; G JStat)
-&gt; [(Id, GenStgRhs 'CodeGen)] -&gt; StateT GenState IO [JStat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681908085"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908085"><span class="hs-identifier hs-var">bndr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681908086"><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908086"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; GenStgRhs 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevelDecl"><span class="hs-identifier hs-var">genToplevelDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908085"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908086"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Id, GenStgRhs 'CodeGen)]
[(BinderP 'CodeGen, GenStgRhs 'CodeGen)]
</span><a href="#local-6989586621681908084"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#genToplevelDecl"><span class="hs-identifier hs-type">genToplevelDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#CgStgRhs"><span class="hs-identifier hs-type">CgStgRhs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="annot"><a href="GHC.JS.Syntax.html#JStat"><span class="hs-identifier hs-type">JStat</span></a></span><span>
</span><span id="line-284"></span><span id="genToplevelDecl"><span class="annot"><span class="annottext">genToplevelDecl :: Id -&gt; GenStgRhs 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevelDecl"><span class="hs-identifier hs-var hs-var">genToplevelDecl</span></a></span></span><span> </span><span id="local-6989586621681908088"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908088"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681908089"><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908089"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621681908090"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908090"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">G JStat -&gt; G JStat
forall a. G a -&gt; G a
</span><a href="GHC.StgToJS.Stack.html#resetSlots"><span class="hs-identifier hs-var">resetSlots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; GenStgRhs 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevelConEntry"><span class="hs-identifier hs-var">genToplevelConEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908088"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908089"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621681908093"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908093"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">G JStat -&gt; G JStat
forall a. G a -&gt; G a
</span><a href="GHC.StgToJS.Stack.html#resetSlots"><span class="hs-identifier hs-var">resetSlots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; GenStgRhs 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevelRhs"><span class="hs-identifier hs-var">genToplevelRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908088"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908089"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><span class="annottext">JStat -&gt; G JStat
forall a. a -&gt; StateT GenState IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908090"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">JStat -&gt; JStat -&gt; JStat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%3E/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908093"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#genToplevelConEntry"><span class="hs-identifier hs-type">genToplevelConEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#CgStgRhs"><span class="hs-identifier hs-type">CgStgRhs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="annot"><a href="GHC.JS.Syntax.html#JStat"><span class="hs-identifier hs-type">JStat</span></a></span><span>
</span><span id="line-290"></span><span id="genToplevelConEntry"><span class="annot"><span class="annottext">genToplevelConEntry :: Id -&gt; GenStgRhs 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevelConEntry"><span class="hs-identifier hs-var hs-var">genToplevelConEntry</span></a></span></span><span> </span><span id="local-6989586621681908095"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908095"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681908096"><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908096"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908096"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-291"></span><span>   </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRhsCon"><span class="hs-identifier hs-type">StgRhsCon</span></a></span><span> </span><span id="local-6989586621681908098"><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621681908098"><span class="hs-identifier hs-var">_cc</span></a></span></span><span> </span><span id="local-6989586621681908099"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908099"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681908100"><span class="annot"><span class="annottext">ConstructorNumber
</span><a href="#local-6989586621681908100"><span class="hs-identifier hs-var">_mu</span></a></span></span><span> </span><span id="local-6989586621681908101"><span class="annot"><span class="annottext">[StgTickish]
</span><a href="#local-6989586621681908101"><span class="hs-identifier hs-var">_ts</span></a></span></span><span> </span><span id="local-6989586621681908102"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621681908102"><span class="hs-identifier hs-var">_args</span></a></span></span><span>
</span><span id="line-292"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Id.html#isDataConWorkId"><span class="hs-identifier hs-var">isDataConWorkId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908095"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-293"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Id -&gt; DataCon -&gt; LiveVars -&gt; G JStat
Id -&gt; DataCon -&gt; LiveVars -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genSetConInfo"><span class="hs-identifier hs-var">genSetConInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908095"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908099"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen -&gt; LiveVars
</span><a href="GHC.StgToJS.StgUtils.html#stgRhsLive"><span class="hs-identifier hs-var">stgRhsLive</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908096"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- NoSRT</span><span>
</span><span id="line-294"></span><span>   </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRhsClosure"><span class="hs-identifier hs-type">StgRhsClosure</span></a></span><span> </span><span class="annot"><span class="annottext">XRhsClosure 'CodeGen
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681908107"><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621681908107"><span class="hs-identifier hs-var">_cc</span></a></span></span><span> </span><span id="local-6989586621681908108"><span class="annot"><span class="annottext">UpdateFlag
</span><a href="#local-6989586621681908108"><span class="hs-identifier hs-var">_upd_flag</span></a></span></span><span> </span><span id="local-6989586621681908109"><span class="annot"><span class="annottext">[BinderP 'CodeGen]
</span><a href="#local-6989586621681908109"><span class="hs-identifier hs-var">_args</span></a></span></span><span> </span><span id="local-6989586621681908110"><span class="annot"><span class="annottext">CgStgExpr
</span><a href="#local-6989586621681908110"><span class="hs-identifier hs-var">_body</span></a></span></span><span>
</span><span id="line-295"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681908111"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908111"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe DataCon
</span><a href="GHC.Types.Id.html#isDataConWorkId_maybe"><span class="hs-identifier hs-var">isDataConWorkId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908095"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-296"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Id -&gt; DataCon -&gt; LiveVars -&gt; G JStat
Id -&gt; DataCon -&gt; LiveVars -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genSetConInfo"><span class="hs-identifier hs-var">genSetConInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908095"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908111"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen -&gt; LiveVars
</span><a href="GHC.StgToJS.StgUtils.html#stgRhsLive"><span class="hs-identifier hs-var">stgRhsLive</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908096"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- srt</span><span>
</span><span id="line-297"></span><span>   </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JStat -&gt; G JStat
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">JStat
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#genSetConInfo"><span class="hs-identifier hs-type">genSetConInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.StgUtils.html#LiveVars"><span class="hs-identifier hs-type">LiveVars</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="annot"><a href="GHC.JS.Syntax.html#JStat"><span class="hs-identifier hs-type">JStat</span></a></span><span>
</span><span id="line-300"></span><span id="genSetConInfo"><span class="annot"><span class="annottext">genSetConInfo :: (() :: Constraint) =&gt; Id -&gt; DataCon -&gt; LiveVars -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genSetConInfo"><span class="hs-identifier hs-var hs-var">genSetConInfo</span></a></span></span><span> </span><span id="local-6989586621681908123"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908123"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681908124"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908124"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681908125"><span class="annot"><span class="annottext">LiveVars
</span><a href="#local-6989586621681908125"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-comment">{- srt -}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621681908126"><span class="annot"><span class="annottext">Ident
</span><a href="#local-6989586621681908126"><span class="hs-identifier hs-var">ei</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; StateT GenState IO Ident
</span><a href="GHC.StgToJS.Ids.html#identForDataConEntryId"><span class="hs-identifier hs-var">identForDataConEntryId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908123"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621681908128"><span class="annot"><span class="annottext">CIStatic
</span><a href="#local-6989586621681908128"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LiveVars -&gt; G CIStatic
</span><a href="GHC.StgToJS.Expr.html#genStaticRefs"><span class="hs-identifier hs-var">genStaticRefs</span></a></span><span> </span><span class="annot"><span class="annottext">LiveVars
</span><a href="#local-6989586621681908125"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="annottext">ClosureInfo -&gt; G ()
</span><a href="GHC.StgToJS.Monad.html#emitClosureInfo"><span class="hs-identifier hs-var">emitClosureInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosureInfo -&gt; G ()) -&gt; ClosureInfo -&gt; G ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ident
-&gt; CIRegs
-&gt; FastString
-&gt; CILayout
-&gt; CIType
-&gt; CIStatic
-&gt; ClosureInfo
</span><a href="GHC.StgToJS.Types.html#ClosureInfo"><span class="hs-identifier hs-var">ClosureInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Ident
</span><a href="#local-6989586621681908126"><span class="hs-identifier hs-var">ei</span></a></span><span>
</span><span id="line-304"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [VarType] -&gt; CIRegs
</span><a href="GHC.StgToJS.Types.html#CIRegs"><span class="hs-identifier hs-var">CIRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VarType
</span><a href="GHC.StgToJS.Types.html#PtrV"><span class="hs-identifier hs-var">PtrV</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; FastString) -&gt; [Char] -&gt; FastString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext -&gt; SDoc -&gt; [Char]
</span><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-var">renderWithContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="GHC.Utils.Outputable.html#defaultSDocContext"><span class="hs-identifier hs-var">defaultSDocContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908124"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VarType] -&gt; CILayout
</span><a href="GHC.StgToJS.CoreUtils.html#fixedLayout"><span class="hs-identifier hs-var">fixedLayout</span></a></span><span> </span><span class="annot"><span class="annottext">([VarType] -&gt; CILayout) -&gt; [VarType] -&gt; CILayout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(UnaryType -&gt; VarType) -&gt; [UnaryType] -&gt; [VarType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; UnaryType -&gt; VarType
UnaryType -&gt; VarType
</span><a href="GHC.StgToJS.CoreUtils.html#uTypeVt"><span class="hs-identifier hs-var">uTypeVt</span></a></span><span> </span><span class="annot"><span class="annottext">[UnaryType]
</span><a href="#local-6989586621681908137"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CIType
</span><a href="GHC.StgToJS.Types.html#CICon"><span class="hs-identifier hs-var">CICon</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; CIType) -&gt; Int -&gt; CIType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Int
</span><a href="GHC.Core.DataCon.html#dataConTag"><span class="hs-identifier hs-var">dataConTag</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908124"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                                </span><span class="annot"><span class="annottext">CIStatic
</span><a href="#local-6989586621681908128"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="annottext">JStat -&gt; G JStat
forall a. a -&gt; StateT GenState IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ident
</span><a href="#local-6989586621681908126"><span class="hs-identifier hs-var">ei</span></a></span><span> </span><span class="annot"><span class="annottext">Ident -&gt; JExpr -&gt; JStat
</span><a href="GHC.JS.Make.html#%7C%7C%3D"><span class="hs-operator hs-var">||=</span></a></span><span> </span><span class="annot"><span class="annottext">JExpr
</span><a href="GHC.StgToJS.CodeGen.html#mkDataEntry"><span class="hs-identifier hs-var">mkDataEntry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>      </span><span class="hs-comment">-- dataConRepArgTys sometimes returns unboxed tuples. is that a bug?</span><span>
</span><span id="line-312"></span><span>      </span><span id="local-6989586621681908137"><span class="annot"><span class="annottext">fields :: [UnaryType]
</span><a href="#local-6989586621681908137"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scaled UnaryType -&gt; [UnaryType])
-&gt; [Scaled UnaryType] -&gt; [UnaryType]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PrimRep -&gt; UnaryType) -&gt; [PrimRep] -&gt; [UnaryType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; UnaryType
</span><a href="GHC.Types.RepType.html#primRepToType"><span class="hs-identifier hs-var">primRepToType</span></a></span><span> </span><span class="annot"><span class="annottext">([PrimRep] -&gt; [UnaryType])
-&gt; (Scaled UnaryType -&gt; [PrimRep])
-&gt; Scaled UnaryType
-&gt; [UnaryType]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; UnaryType -&gt; [PrimRep]
UnaryType -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">(UnaryType -&gt; [PrimRep])
-&gt; (Scaled UnaryType -&gt; UnaryType) -&gt; Scaled UnaryType -&gt; [PrimRep]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UnaryType -&gt; UnaryType
</span><a href="GHC.Types.RepType.html#unwrapType"><span class="hs-identifier hs-var">unwrapType</span></a></span><span> </span><span class="annot"><span class="annottext">(UnaryType -&gt; UnaryType)
-&gt; (Scaled UnaryType -&gt; UnaryType) -&gt; Scaled UnaryType -&gt; UnaryType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled UnaryType -&gt; UnaryType
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [Scaled UnaryType]
</span><a href="GHC.Core.DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908124"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>        </span><span class="hs-comment">-- concatMap (map slotTyToType . repTypeSlots . repType) (dataConRepArgTys d)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#mkDataEntry"><span class="hs-identifier hs-type">mkDataEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.JS.Syntax.html#JExpr"><span class="hs-identifier hs-type">JExpr</span></a></span><span>
</span><span id="line-317"></span><span id="mkDataEntry"><span class="annot"><span class="annottext">mkDataEntry :: JExpr
</span><a href="GHC.StgToJS.CodeGen.html#mkDataEntry"><span class="hs-identifier hs-var hs-var">mkDataEntry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JVal -&gt; JExpr
</span><a href="GHC.JS.Syntax.html#ValExpr"><span class="hs-identifier hs-var">ValExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(JVal -&gt; JExpr) -&gt; JVal -&gt; JExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Ident] -&gt; JStat -&gt; JVal
</span><a href="GHC.JS.Syntax.html#JFunc"><span class="hs-identifier hs-var">JFunc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="GHC.JS.Make.html#returnStack"><span class="hs-identifier hs-var">returnStack</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="GHC.StgToJS.CodeGen.html#genToplevelRhs"><span class="hs-identifier hs-type">genToplevelRhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#CgStgRhs"><span class="hs-identifier hs-type">CgStgRhs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToJS.Types.html#G"><span class="hs-identifier hs-type">G</span></a></span><span> </span><span class="annot"><a href="GHC.JS.Syntax.html#JStat"><span class="hs-identifier hs-type">JStat</span></a></span><span>
</span><span id="line-320"></span><span class="hs-comment">-- general cases:</span><span>
</span><span id="line-321"></span><span id="genToplevelRhs"><span class="annot"><span class="annottext">genToplevelRhs :: Id -&gt; GenStgRhs 'CodeGen -&gt; G JStat
</span><a href="GHC.StgToJS.CodeGen.html#genToplevelRhs"><span class="hs-identifier hs-var hs-var">genToplevelRhs</span></a></span></span><span> </span><span id="local-6989586621681908150"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908150"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681908151"><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908151"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908151"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRhsCon"><span class="hs-identifier hs-type">StgRhsCon</span></a></span><span> </span><span id="local-6989586621681908152"><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621681908152"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621681908153"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908153"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681908154"><span class="annot"><span class="annottext">ConstructorNumber
</span><a href="#local-6989586621681908154"><span class="hs-identifier hs-var">_mu</span></a></span></span><span> </span><span id="local-6989586621681908155"><span class="annot"><span class="annottext">[StgTickish]
</span><a href="#local-6989586621681908155"><span class="hs-identifier hs-var">_tys</span></a></span></span><span> </span><span id="local-6989586621681908156"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621681908156"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621681908157"><span class="annot"><span class="annottext">Ident
</span><a href="#local-6989586621681908157"><span class="hs-identifier hs-var">ii</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; StateT GenState IO Ident
</span><a href="GHC.StgToJS.Ids.html#identForId"><span class="hs-identifier hs-var">identForId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908150"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt;
Ident -&gt; CostCentreStack -&gt; DataCon -&gt; [StgArg] -&gt; G ()
Ident -&gt; CostCentreStack -&gt; DataCon -&gt; [StgArg] -&gt; G ()
</span><a href="GHC.StgToJS.Arg.html#allocConStatic"><span class="hs-identifier hs-var">allocConStatic</span></a></span><span> </span><span class="annot"><span class="annottext">Ident
</span><a href="#local-6989586621681908157"><span class="hs-identifier hs-var">ii</span></a></span><span> </span><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621681908152"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681908153"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621681908156"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">JStat -&gt; G JStat
forall a. a -&gt; StateT GenState IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">JStat
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRhsClosure"><span class="hs-identifier hs-type">StgRhsClosure</span></a></span><span> </span><span id="local-6989586621681908159"><span class="annot"><span class="annottext">XRhsClosure 'CodeGen
</span><a href="#local-6989586621681908159"><span class="hs-identifier hs-var">_ext</span></a></span></span><span> </span><span id="local-6989586621681908160"><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621681908160"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621681908161"><span class="annot"><span class="annottext">UpdateFlag
</span><a href="#local-6989586621681908161"><span class="hs-identifier hs-var">_upd_flag</span></a></span></span><span> </span><span class="hs-comment">{- srt -}</span><span> </span><span id="local-6989586621681908162"><span class="annot"><span class="annottext">[BinderP 'CodeGen]
</span><a href="#local-6989586621681908162"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621681908163"><span class="annot"><span class="annottext">CgStgExpr
</span><a href="#local-6989586621681908163"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-comment">{-
      algorithm:
       - collect all Id refs that are in the global id cache
       - count usage in body for each ref
       - order by increasing use
       - prepend loading lives var to body: body can stay the same
    -}</span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621681908164"><span class="annot"><span class="annottext">eid :: Ident
</span><a href="#local-6989586621681908164"><span class="hs-identifier hs-var">eid</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.JS.Syntax.html#TxtI"><span class="hs-identifier hs-type">TxtI</span></a></span><span> </span><span id="local-6989586621681908165"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908165"><span class="hs-identifier hs-var">eidt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; StateT GenState IO Ident
</span><a href="GHC.StgToJS.Ids.html#identForEntryId"><span class="hs-identifier hs-var">identForEntryId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908150"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.JS.Syntax.html#TxtI"><span class="hs-identifier hs-type">TxtI</span></a></span><span> </span><span id="local-6989586621681908167"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908167"><span class="hs-identifier hs-var">idt</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; StateT GenState IO Ident
</span><a href="GHC.StgToJS.Ids.html#identForId"><span class="hs-identifier hs-var">identForId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908150"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621681908168"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908168"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt;
ExprCtx -&gt; Id -&gt; StgReg -&gt; [Id] -&gt; CgStgExpr -&gt; G JStat
ExprCtx -&gt; Id -&gt; StgReg -&gt; [Id] -&gt; CgStgExpr -&gt; G JStat
</span><a href="GHC.StgToJS.Expr.html#genBody"><span class="hs-identifier hs-var">genBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; ExprCtx
</span><a href="GHC.StgToJS.ExprCtx.html#initExprCtx"><span class="hs-identifier hs-var">initExprCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908150"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681908150"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StgReg
</span><a href="GHC.StgToJS.Regs.html#R2"><span class="hs-identifier hs-var">R2</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'CodeGen]
</span><a href="#local-6989586621681908162"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">CgStgExpr
</span><a href="#local-6989586621681908163"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621681908172"><span class="annot"><span class="annottext">[GlobalOcc]
</span><a href="#local-6989586621681908172"><span class="hs-identifier hs-var">global_occs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">JStat -&gt; G [GlobalOcc]
</span><a href="GHC.StgToJS.Monad.html#globalOccs"><span class="hs-identifier hs-var">globalOccs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FastString -&gt; JStat -&gt; JStat
forall a. JMacro a =&gt; Maybe FastString -&gt; a -&gt; a
</span><a href="GHC.JS.Transform.html#jsSaturate"><span class="hs-identifier hs-var">jsSaturate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Maybe FastString
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;ghcjs_tmp_sat_&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908168"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908174"><span class="annot"><span class="annottext">lidents :: [Ident]
</span><a href="#local-6989586621681908174"><span class="hs-identifier hs-var hs-var">lidents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalOcc -&gt; Ident) -&gt; [GlobalOcc] -&gt; [Ident]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalOcc -&gt; Ident
</span><a href="GHC.StgToJS.Monad.html#global_ident"><span class="hs-identifier hs-var">global_ident</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalOcc]
</span><a href="#local-6989586621681908172"><span class="hs-identifier hs-var">global_occs</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908176"><span class="annot"><span class="annottext">lids :: [Id]
</span><a href="#local-6989586621681908176"><span class="hs-identifier hs-var hs-var">lids</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalOcc -&gt; Id) -&gt; [GlobalOcc] -&gt; [Id]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalOcc -&gt; Id
</span><a href="GHC.StgToJS.Monad.html#global_id"><span class="hs-identifier hs-var">global_id</span></a></span><span>    </span><span class="annot"><span class="annottext">[GlobalOcc]
</span><a href="#local-6989586621681908172"><span class="hs-identifier hs-var">global_occs</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908178"><span class="annot"><span class="annottext">lidents' :: [FastString]
</span><a href="#local-6989586621681908178"><span class="hs-identifier hs-var hs-var">lidents'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ident -&gt; FastString) -&gt; [Ident] -&gt; [FastString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ident -&gt; FastString
</span><a href="GHC.JS.Syntax.html#identFS"><span class="hs-identifier hs-var">identFS</span></a></span><span> </span><span class="annot"><span class="annottext">[Ident]
</span><a href="#local-6989586621681908174"><span class="hs-identifier hs-var">lidents</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="GHC.StgToJS.Types.html#CIStaticRefs"><span class="hs-identifier hs-type">CIStaticRefs</span></a></span><span> </span><span id="local-6989586621681908181"><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908181"><span class="hs-identifier hs-var">sr0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen -&gt; G CIStatic
</span><a href="GHC.StgToJS.Expr.html#genStaticRefsRhs"><span class="hs-identifier hs-var">genStaticRefsRhs</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'CodeGen
</span><a href="#local-6989586621681908151"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681908183"><span class="annot"><span class="annottext">sri :: [FastString]
</span><a href="#local-6989586621681908183"><span class="hs-identifier hs-var hs-var">sri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Bool) -&gt; [FastString] -&gt; [FastString]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; [FastString] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#notElem/Data.Foldable.html#notElem"><span class="hs-operator hs-var">`notElem`</span></a></span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908178"><span class="hs-identifier hs-var">lidents'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908181"><span class="hs-identifier hs-var">sr0</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span id="local-6989586621681908185"><span class="annot"><span class="annottext">sr :: CIStatic
</span><a href="#local-6989586621681908185"><span class="hs-identifier hs-var hs-var">sr</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FastString] -&gt; CIStatic
</span><a href="GHC.StgToJS.Types.html#CIStaticRefs"><span class="hs-identifier hs-var">CIStaticRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908183"><span class="hs-identifier hs-var">sri</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span id="local-6989586621681908186"><span class="annot"><span class="annottext">CIType
</span><a href="#local-6989586621681908186"><span class="hs-identifier hs-var">et</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; G CIType
(() :: Constraint) =&gt; [Id] -&gt; G CIType
</span><a href="GHC.StgToJS.Expr.html#genEntryType"><span class="hs-identifier hs-var">genEntryType</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'CodeGen]
</span><a href="#local-6989586621681908162"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621681908188"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908188"><span class="hs-identifier hs-var">ll</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; G JStat
</span><a href="GHC.StgToJS.Expr.html#loadLiveFun"><span class="hs-identifier hs-var">loadLiveFun</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681908176"><span class="hs-identifier hs-var">lids</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681908190"><span class="annot"><span class="annottext">StaticVal
</span><a href="#local-6989586621681908190"><span class="hs-identifier hs-var">static</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681908191"><span class="annot"><span class="annottext">CIRegs
</span><a href="#local-6989586621681908191"><span class="hs-identifier hs-var">regs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681908192"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908192"><span class="hs-identifier hs-var">upd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CIType
</span><a href="#local-6989586621681908186"><span class="hs-identifier hs-var">et</span></a></span><span> </span><span class="annot"><span class="annottext">CIType -&gt; CIType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CIType
</span><a href="GHC.StgToJS.Types.html#CIThunk"><span class="hs-identifier hs-var">CIThunk</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>          </span><span id="local-6989586621681908194"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908194"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">G JStat
</span><a href="GHC.StgToJS.Stack.html#updateThunk"><span class="hs-identifier hs-var">updateThunk</span></a></span><span>
</span><span id="line-350"></span><span>          </span><span class="annot"><span class="annottext">(StaticVal, CIRegs, JStat)
-&gt; StateT GenState IO (StaticVal, CIRegs, JStat)
forall a. a -&gt; StateT GenState IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (FastString, [StaticArg]) -&gt; StaticVal
</span><a href="GHC.StgToJS.Types.html#StaticThunk"><span class="hs-identifier hs-var">StaticThunk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FastString, [StaticArg]) -&gt; Maybe (FastString, [StaticArg])
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908165"><span class="hs-identifier hs-var">eidt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; StaticArg) -&gt; [FastString] -&gt; [StaticArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; StaticArg
</span><a href="GHC.StgToJS.Types.html#StaticObjArg"><span class="hs-identifier hs-var">StaticObjArg</span></a></span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908178"><span class="hs-identifier hs-var">lidents'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [VarType] -&gt; CIRegs
</span><a href="GHC.StgToJS.Types.html#CIRegs"><span class="hs-identifier hs-var">CIRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VarType
</span><a href="GHC.StgToJS.Types.html#PtrV"><span class="hs-identifier hs-var">PtrV</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908194"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(StaticVal, CIRegs, JStat)
-&gt; StateT GenState IO (StaticVal, CIRegs, JStat)
forall a. a -&gt; StateT GenState IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; [StaticArg] -&gt; StaticVal
</span><a href="GHC.StgToJS.Types.html#StaticFun"><span class="hs-identifier hs-var">StaticFun</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908165"><span class="hs-identifier hs-var">eidt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FastString -&gt; StaticArg) -&gt; [FastString] -&gt; [StaticArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; StaticArg
</span><a href="GHC.StgToJS.Types.html#StaticObjArg"><span class="hs-identifier hs-var">StaticObjArg</span></a></span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621681908178"><span class="hs-identifier hs-var">lidents'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-352"></span><span>                    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Ident] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Ident]
</span><a href="#local-6989586621681908174"><span class="hs-identifier hs-var">lidents</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [VarType] -&gt; CIRegs
</span><a href="GHC.StgToJS.Types.html#CIRegs"><span class="hs-identifier hs-var">CIRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; [VarType]) -&gt; [Id] -&gt; [VarType]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Id -&gt; [VarType]
Id -&gt; [VarType]
</span><a href="GHC.StgToJS.CoreUtils.html#idVt"><span class="hs-identifier hs-var">idVt</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'CodeGen]
</span><a href="#local-6989586621681908162"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>                                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [VarType] -&gt; CIRegs
</span><a href="GHC.StgToJS.Types.html#CIRegs"><span class="hs-identifier hs-var">CIRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarType
</span><a href="GHC.StgToJS.Types.html#PtrV"><span class="hs-identifier hs-var">PtrV</span></a></span><span> </span><span class="annot"><span class="annottext">VarType -&gt; [VarType] -&gt; [VarType]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Id -&gt; [VarType]) -&gt; [Id] -&gt; [VarType]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Id -&gt; [VarType]
Id -&gt; [VarType]
</span><a href="GHC.StgToJS.CoreUtils.html#idVt"><span class="hs-identifier hs-var">idVt</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'CodeGen]
</span><a href="#local-6989586621681908162"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JStat
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621681908201"><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908201"><span class="hs-identifier hs-var">setcc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">JStat -&gt; G JStat
forall m. Monoid m =&gt; m -&gt; G m
</span><a href="GHC.StgToJS.Profiling.html#ifProfiling"><span class="hs-identifier hs-var">ifProfiling</span></a></span><span> </span><span class="annot"><span class="annottext">(JStat -&gt; G JStat) -&gt; JStat -&gt; G JStat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-356"></span><span>               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CIType
</span><a href="#local-6989586621681908186"><span class="hs-identifier hs-var">et</span></a></span><span> </span><span class="annot"><span class="annottext">CIType -&gt; CIType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CIType
</span><a href="GHC.StgToJS.Types.html#CIThunk"><span class="hs-identifier hs-var">CIThunk</span></a></span><span>
</span><span id="line-357"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="GHC.StgToJS.Profiling.html#enterCostCentreThunk"><span class="hs-identifier hs-var">enterCostCentreThunk</span></a></span><span>
</span><span id="line-358"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CostCentreStack -&gt; JStat
</span><a href="GHC.StgToJS.Profiling.html#enterCostCentreFun"><span class="hs-identifier hs-var">enterCostCentreFun</span></a></span><span> </span><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621681908160"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><span class="annottext">ClosureInfo -&gt; G ()
</span><a href="GHC.StgToJS.Monad.html#emitClosureInfo"><span class="hs-identifier hs-var">emitClosureInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ident
-&gt; CIRegs
-&gt; FastString
-&gt; CILayout
-&gt; CIType
-&gt; CIStatic
-&gt; ClosureInfo
</span><a href="GHC.StgToJS.Types.html#ClosureInfo"><span class="hs-identifier hs-var">ClosureInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Ident
</span><a href="#local-6989586621681908164"><span class="hs-identifier hs-var">eid</span></a></span><span>
</span><span id="line-360"></span><span>                                 </span><span class="annot"><span class="annottext">CIRegs
</span><a href="#local-6989586621681908191"><span class="hs-identifier hs-var">regs</span></a></span><span>
</span><span id="line-361"></span><span>                                 </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908167"><span class="hs-identifier hs-var">idt</span></a></span><span>
</span><span id="line-362"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VarType] -&gt; CILayout
</span><a href="GHC.StgToJS.CoreUtils.html#fixedLayout"><span class="hs-identifier hs-var">fixedLayout</span></a></span><span> </span><span class="annot"><span class="annottext">([VarType] -&gt; CILayout) -&gt; [VarType] -&gt; CILayout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Id -&gt; VarType) -&gt; [Id] -&gt; [VarType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; UnaryType -&gt; VarType
UnaryType -&gt; VarType
</span><a href="GHC.StgToJS.CoreUtils.html#uTypeVt"><span class="hs-identifier hs-var">uTypeVt</span></a></span><span> </span><span class="annot"><span class="annottext">(UnaryType -&gt; VarType) -&gt; (Id -&gt; UnaryType) -&gt; Id -&gt; VarType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; UnaryType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681908176"><span class="hs-identifier hs-var">lids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>                                 </span><span class="annot"><span class="annottext">CIType
</span><a href="#local-6989586621681908186"><span class="hs-identifier hs-var">et</span></a></span><span>
</span><span id="line-364"></span><span>                                 </span><span class="annot"><span class="annottext">CIStatic
</span><a href="#local-6989586621681908185"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>    </span><span id="local-6989586621681908206"><span class="annot"><span class="annottext">Maybe Ident
</span><a href="#local-6989586621681908206"><span class="hs-identifier hs-var">ccId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CostCentreStack -&gt; G (Maybe Ident)
</span><a href="GHC.StgToJS.Profiling.html#costCentreStackLbl"><span class="hs-identifier hs-var">costCentreStackLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621681908160"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><span class="annottext">FastString -&gt; StaticVal -&gt; Maybe Ident -&gt; G ()
</span><a href="GHC.StgToJS.Monad.html#emitStatic"><span class="hs-identifier hs-var">emitStatic</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681908167"><span class="hs-identifier hs-var">idt</span></a></span><span> </span><span class="annot"><span class="annottext">StaticVal
</span><a href="#local-6989586621681908190"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Ident
</span><a href="#local-6989586621681908206"><span class="hs-identifier hs-var">ccId</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">JStat -&gt; G JStat
forall a. a -&gt; StateT GenState IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(JStat -&gt; G JStat) -&gt; JStat -&gt; G JStat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ident
</span><a href="#local-6989586621681908164"><span class="hs-identifier hs-var">eid</span></a></span><span> </span><span class="annot"><span class="annottext">Ident -&gt; JExpr -&gt; JStat
</span><a href="GHC.JS.Make.html#%7C%7C%3D"><span class="hs-operator hs-var">||=</span></a></span><span> </span><span class="annot"><span class="annottext">JVal -&gt; JExpr
forall a. ToJExpr a =&gt; a -&gt; JExpr
</span><a href="GHC.JS.Make.html#toJExpr"><span class="hs-identifier hs-var">toJExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ident] -&gt; JStat -&gt; JVal
</span><a href="GHC.JS.Syntax.html#JFunc"><span class="hs-identifier hs-var">JFunc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908188"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">JStat -&gt; JStat -&gt; JStat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%3E/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908192"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="annot"><span class="annottext">JStat -&gt; JStat -&gt; JStat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%3E/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908201"><span class="hs-identifier hs-var">setcc</span></a></span><span> </span><span class="annot"><span class="annottext">JStat -&gt; JStat -&gt; JStat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%3E/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JStat
</span><a href="#local-6989586621681908168"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span></pre></body></html>