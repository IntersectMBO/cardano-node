<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns   #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">-- | Tidying types and coercions for printing in error messages.</span></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Core.TyCo.Tidy</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Tidying type related things up for printing</span></span><span>
</span><span id="line-8"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier">tidyType</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTypes"><span class="hs-identifier">tidyTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenType"><span class="hs-identifier">tidyOpenType</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTypes"><span class="hs-identifier">tidyOpenTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier">tidyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndrs"><span class="hs-identifier">tidyVarBndrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVars"><span class="hs-identifier">tidyFreeTyCoVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#avoidNameClashes"><span class="hs-identifier">avoidNameClashes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVar"><span class="hs-identifier">tidyOpenTyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVars"><span class="hs-identifier">tidyOpenTyCoVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTyCoVarOcc"><span class="hs-identifier">tidyTyCoVarOcc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTopType"><span class="hs-identifier">tidyTopType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyCo"><span class="hs-identifier">tidyCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyCos"><span class="hs-identifier">tidyCos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinder"><span class="hs-identifier">tidyForAllTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinders"><span class="hs-identifier">tidyForAllTyBinders</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html"><span class="hs-identifier">GHC.Core.TyCo.FVs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier">tyCoVarsOfTypesWellScoped</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier">tyCoVarsOfTypeList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier">varName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Misc.html#strictMap"><span class="hs-identifier">strictMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.List.html#/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Traversable.html#mapAccumL/Data.Traversable.html#mapAccumL"><span class="hs-identifier">mapAccumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
\subsection{TidyType}
%*                                                                      *
%************************************************************************
-}</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | This tidies up a type for printing in an error message, or in</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- an interface file.</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- It doesn't change the uniques at all, just the print names.</span><span>
</span><span id="line-43"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndrs"><span class="hs-identifier hs-type">tidyVarBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span id="tidyVarBndrs"><span class="annot"><span class="annottext">tidyVarBndrs :: TidyEnv -&gt; [TyCoVar] -&gt; (TidyEnv, [TyCoVar])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndrs"><span class="hs-identifier hs-var hs-var">tidyVarBndrs</span></a></span></span><span> </span><span id="local-6989586621681569474"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569474"><span class="hs-identifier hs-var">tidy_env</span></a></span></span><span> </span><span id="local-6989586621681569475"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569475"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar))
-&gt; TidyEnv -&gt; [TyCoVar] -&gt; (TidyEnv, [TyCoVar])
forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><a href="../../base-4.18.2.1/src/Data.Traversable.html#mapAccumL/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier hs-var">tidyVarBndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyCoVar] -&gt; TidyEnv -&gt; TidyEnv
</span><a href="GHC.Core.TyCo.Tidy.html#avoidNameClashes"><span class="hs-identifier hs-var">avoidNameClashes</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569475"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569474"><span class="hs-identifier hs-var">tidy_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569475"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier hs-type">tidyVarBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span id="tidyVarBndr"><span class="annot"><span class="annottext">tidyVarBndr :: TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier hs-var hs-var">tidyVarBndr</span></a></span></span><span> </span><span id="local-6989586621681569476"><span class="annot"><span class="annottext">tidy_env :: TidyEnv
</span><a href="#local-6989586621681569476"><span class="hs-identifier hs-var">tidy_env</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621681569477"><span class="annot"><span class="annottext">TidyOccEnv
</span><a href="#local-6989586621681569477"><span class="hs-identifier hs-var">occ_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569478"><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569478"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681569479"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569479"><span class="hs-identifier hs-var">var</span></a></span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TidyOccEnv -&gt; OccName -&gt; (TidyOccEnv, OccName)
</span><a href="GHC.Types.Name.Occurrence.html#tidyOccName"><span class="hs-identifier hs-var">tidyOccName</span></a></span><span> </span><span class="annot"><span class="annottext">TidyOccEnv
</span><a href="#local-6989586621681569477"><span class="hs-identifier hs-var">occ_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVar -&gt; OccName
</span><a href="GHC.Core.TyCo.Tidy.html#getHelpfulOccName"><span class="hs-identifier hs-var">getHelpfulOccName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569479"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-50"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681569482"><span class="annot"><span class="annottext">TidyOccEnv
</span><a href="#local-6989586621681569482"><span class="hs-identifier hs-var">occ_env'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569483"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681569483"><span class="hs-identifier hs-var">occ'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyOccEnv
</span><a href="#local-6989586621681569482"><span class="hs-identifier hs-var">occ_env'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569484"><span class="hs-identifier hs-var">subst'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569485"><span class="hs-identifier hs-var">var'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>          </span><span id="local-6989586621681569484"><span class="annot"><span class="annottext">subst' :: VarEnv TyCoVar
</span><a href="#local-6989586621681569484"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar -&gt; TyCoVar -&gt; TyCoVar -&gt; VarEnv TyCoVar
forall a. VarEnv a -&gt; TyCoVar -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569478"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569479"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569485"><span class="hs-identifier hs-var">var'</span></a></span><span>
</span><span id="line-53"></span><span>          </span><span id="local-6989586621681569485"><span class="annot"><span class="annottext">var' :: TyCoVar
</span><a href="#local-6989586621681569485"><span class="hs-identifier hs-var hs-var">var'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; TyCoVar -&gt; TyCoVar
</span><a href="GHC.Types.Var.html#updateVarType"><span class="hs-identifier hs-var">updateVarType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569476"><span class="hs-identifier hs-var">tidy_env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVar -&gt; Name -&gt; TyCoVar
</span><a href="GHC.Types.Var.html#setVarName"><span class="hs-identifier hs-var">setVarName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569479"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681569489"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>          </span><span id="local-6989586621681569489"><span class="annot"><span class="annottext">name' :: Name
</span><a href="#local-6989586621681569489"><span class="hs-identifier hs-var hs-var">name'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName -&gt; Name
</span><a href="GHC.Types.Name.html#tidyNameOcc"><span class="hs-identifier hs-var">tidyNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681569491"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681569483"><span class="hs-identifier hs-var">occ'</span></a></span><span>
</span><span id="line-55"></span><span>          </span><span id="local-6989586621681569491"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681569491"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; Name
</span><a href="GHC.Types.Var.html#varName"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569479"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#avoidNameClashes"><span class="hs-identifier hs-type">avoidNameClashes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- Seed the occ_env with clashes among the names, see</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Note [Tidying multiple names at once] in GHC.Types.Name.Occurrence</span><span>
</span><span id="line-60"></span><span id="avoidNameClashes"><span class="annot"><span class="annottext">avoidNameClashes :: [TyCoVar] -&gt; TidyEnv -&gt; TidyEnv
</span><a href="GHC.Core.TyCo.Tidy.html#avoidNameClashes"><span class="hs-identifier hs-var hs-var">avoidNameClashes</span></a></span></span><span> </span><span id="local-6989586621681569493"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569493"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681569494"><span class="annot"><span class="annottext">TidyOccEnv
</span><a href="#local-6989586621681569494"><span class="hs-identifier hs-var">occ_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569495"><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569495"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyOccEnv -&gt; [OccName] -&gt; TidyOccEnv
</span><a href="GHC.Types.Name.Occurrence.html#avoidClashesOccEnv"><span class="hs-identifier hs-var">avoidClashesOccEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TidyOccEnv
</span><a href="#local-6989586621681569494"><span class="hs-identifier hs-var">occ_env</span></a></span><span> </span><span class="annot"><span class="annottext">[OccName]
</span><a href="#local-6989586621681569497"><span class="hs-identifier hs-var">occs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569495"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621681569497"><span class="annot"><span class="annottext">occs :: [OccName]
</span><a href="#local-6989586621681569497"><span class="hs-identifier hs-var hs-var">occs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCoVar -&gt; OccName) -&gt; [TyCoVar] -&gt; [OccName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; OccName
</span><a href="GHC.Core.TyCo.Tidy.html#getHelpfulOccName"><span class="hs-identifier hs-var">getHelpfulOccName</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569493"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#getHelpfulOccName"><span class="hs-identifier hs-type">getHelpfulOccName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- A TcTyVar with a System Name is probably a</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- unification variable; when we tidy them we give them a trailing</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- &quot;0&quot; (or 1 etc) so that they don't take precedence for the</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- un-modified name. Plus, indicating a unification variable in</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- this way is a helpful clue for users</span><span>
</span><span id="line-71"></span><span id="getHelpfulOccName"><span class="annot"><span class="annottext">getHelpfulOccName :: TyCoVar -&gt; OccName
</span><a href="GHC.Core.TyCo.Tidy.html#getHelpfulOccName"><span class="hs-identifier hs-var hs-var">getHelpfulOccName</span></a></span></span><span> </span><span id="local-6989586621681569498"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569498"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isSystemName"><span class="hs-identifier hs-var">isSystemName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681569500"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTcTyVar"><span class="hs-identifier hs-var">isTcTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569498"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkTyVarOccFS"><span class="hs-identifier hs-var">mkTyVarOccFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681569504"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; FastString -&gt; FastString
</span><a href="GHC.Data.FastString.html#appendFS"><span class="hs-operator hs-var">`appendFS`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681569504"><span class="hs-identifier hs-var">occ</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>   </span><span id="local-6989586621681569500"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681569500"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; Name
</span><a href="GHC.Types.Var.html#varName"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569498"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-78"></span><span>   </span><span id="local-6989586621681569504"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621681569504"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
forall a. NamedThing a =&gt; a -&gt; OccName
</span><a href="GHC.Types.Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681569500"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621681569407"><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinder"><span class="hs-identifier hs-type">tidyForAllTyBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681569407"><span class="hs-identifier hs-type">vis</span></a></span><span>
</span><span id="line-81"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681569407"><span class="hs-identifier hs-type">vis</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-82"></span><span id="tidyForAllTyBinder"><span class="annot"><span class="annottext">tidyForAllTyBinder :: forall vis.
TidyEnv -&gt; VarBndr TyCoVar vis -&gt; (TidyEnv, VarBndr TyCoVar vis)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinder"><span class="hs-identifier hs-var hs-var">tidyForAllTyBinder</span></a></span></span><span> </span><span id="local-6989586621681569508"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569508"><span class="hs-identifier hs-var">tidy_env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621681569510"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569510"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681569511"><span class="annot"><span class="annottext">vis
</span><a href="#local-6989586621681569511"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569512"><span class="hs-identifier hs-var">tidy_env'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; vis -&gt; VarBndr TyCoVar vis
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569513"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">vis
</span><a href="#local-6989586621681569511"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681569512"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569512"><span class="hs-identifier hs-var">tidy_env'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569513"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569513"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier hs-var">tidyVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569508"><span class="hs-identifier hs-var">tidy_env</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569510"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span id="local-6989586621681569412"><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinders"><span class="hs-identifier hs-type">tidyForAllTyBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681569412"><span class="hs-identifier hs-type">vis</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681569412"><span class="hs-identifier hs-type">vis</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-89"></span><span id="tidyForAllTyBinders"><span class="annot"><span class="annottext">tidyForAllTyBinders :: forall vis.
TidyEnv
-&gt; [VarBndr TyCoVar vis] -&gt; (TidyEnv, [VarBndr TyCoVar vis])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinders"><span class="hs-identifier hs-var hs-var">tidyForAllTyBinders</span></a></span></span><span> </span><span id="local-6989586621681569515"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569515"><span class="hs-identifier hs-var">tidy_env</span></a></span></span><span> </span><span id="local-6989586621681569516"><span class="annot"><span class="annottext">[VarBndr TyCoVar vis]
</span><a href="#local-6989586621681569516"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TidyEnv -&gt; VarBndr TyCoVar vis -&gt; (TidyEnv, VarBndr TyCoVar vis))
-&gt; TidyEnv
-&gt; [VarBndr TyCoVar vis]
-&gt; (TidyEnv, [VarBndr TyCoVar vis])
forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><a href="../../base-4.18.2.1/src/Data.Traversable.html#mapAccumL/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; VarBndr TyCoVar vis -&gt; (TidyEnv, VarBndr TyCoVar vis)
forall vis.
TidyEnv -&gt; VarBndr TyCoVar vis -&gt; (TidyEnv, VarBndr TyCoVar vis)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyForAllTyBinder"><span class="hs-identifier hs-var">tidyForAllTyBinder</span></a></span><span>
</span><span id="line-91"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyCoVar] -&gt; TidyEnv -&gt; TidyEnv
</span><a href="GHC.Core.TyCo.Tidy.html#avoidNameClashes"><span class="hs-identifier hs-var">avoidNameClashes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VarBndr TyCoVar vis] -&gt; [TyCoVar]
forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TyCoVar vis]
</span><a href="#local-6989586621681569516"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569515"><span class="hs-identifier hs-var">tidy_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VarBndr TyCoVar vis]
</span><a href="#local-6989586621681569516"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-94"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVars"><span class="hs-identifier hs-type">tidyFreeTyCoVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- ^ Add the free 'TyVar's to the env in tidy form,</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- so that we can tidy the type they are free in</span><span>
</span><span id="line-97"></span><span id="tidyFreeTyCoVars"><span class="annot"><span class="annottext">tidyFreeTyCoVars :: TidyEnv -&gt; [TyCoVar] -&gt; TidyEnv
</span><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var hs-var">tidyFreeTyCoVars</span></a></span></span><span> </span><span id="local-6989586621681569519"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569519"><span class="hs-identifier hs-var">tidy_env</span></a></span></span><span> </span><span id="local-6989586621681569520"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569520"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TidyEnv, [TyCoVar]) -&gt; TidyEnv
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.2.1/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; [TyCoVar] -&gt; (TidyEnv, [TyCoVar])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVars"><span class="hs-identifier hs-var">tidyOpenTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569519"><span class="hs-identifier hs-var">tidy_env</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569520"><span class="hs-identifier hs-var">tyvars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-101"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVars"><span class="hs-identifier hs-type">tidyOpenTyCoVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span id="tidyOpenTyCoVars"><span class="annot"><span class="annottext">tidyOpenTyCoVars :: TidyEnv -&gt; [TyCoVar] -&gt; (TidyEnv, [TyCoVar])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVars"><span class="hs-identifier hs-var hs-var">tidyOpenTyCoVars</span></a></span></span><span> </span><span id="local-6989586621681569522"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569522"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681569523"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569523"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar))
-&gt; TidyEnv -&gt; [TyCoVar] -&gt; (TidyEnv, [TyCoVar])
forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><a href="../../base-4.18.2.1/src/Data.Traversable.html#mapAccumL/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVar"><span class="hs-identifier hs-var">tidyOpenTyCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569522"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569523"><span class="hs-identifier hs-var">tyvars</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-105"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVar"><span class="hs-identifier hs-type">tidyOpenTyCoVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- ^ Treat a new 'TyCoVar' as a binder, and give it a fresh tidy name</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- using the environment if one has not already been allocated. See</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- also 'tidyVarBndr'</span><span>
</span><span id="line-109"></span><span id="tidyOpenTyCoVar"><span class="annot"><span class="annottext">tidyOpenTyCoVar :: TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVar"><span class="hs-identifier hs-var hs-var">tidyOpenTyCoVar</span></a></span></span><span> </span><span id="local-6989586621681569524"><span class="annot"><span class="annottext">env :: TidyEnv
</span><a href="#local-6989586621681569524"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyOccEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569525"><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569525"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681569526"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569526"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar -&gt; TyCoVar -&gt; Maybe TyCoVar
forall a. VarEnv a -&gt; TyCoVar -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569525"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569526"><span class="hs-identifier hs-var">tyvar</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681569528"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569528"><span class="hs-identifier hs-var">tyvar'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569524"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569528"><span class="hs-identifier hs-var">tyvar'</span></a></span><span class="hs-special">)</span><span>              </span><span class="hs-comment">-- Already substituted</span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="annottext">Maybe TyCoVar
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681569529"><span class="annot"><span class="annottext">env' :: TidyEnv
</span><a href="#local-6989586621681569529"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [TyCoVar] -&gt; TidyEnv
</span><a href="GHC.Core.TyCo.Tidy.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var">tidyFreeTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569524"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [TyCoVar]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569526"><span class="hs-identifier hs-var">tyvar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier hs-var">tidyVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569529"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569526"><span class="hs-identifier hs-var">tyvar</span></a></span><span>  </span><span class="hs-comment">-- Treat it as a binder</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-117"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTyCoVarOcc"><span class="hs-identifier hs-type">tidyTyCoVarOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span>
</span><span id="line-118"></span><span id="tidyTyCoVarOcc"><span class="annot"><span class="annottext">tidyTyCoVarOcc :: TidyEnv -&gt; TyCoVar -&gt; TyCoVar
</span><a href="GHC.Core.TyCo.Tidy.html#tidyTyCoVarOcc"><span class="hs-identifier hs-var hs-var">tidyTyCoVarOcc</span></a></span></span><span> </span><span id="local-6989586621681569531"><span class="annot"><span class="annottext">env :: TidyEnv
</span><a href="#local-6989586621681569531"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyOccEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569532"><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569532"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681569533"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569533"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar -&gt; TyCoVar -&gt; Maybe TyCoVar
forall a. VarEnv a -&gt; TyCoVar -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569532"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569533"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">Maybe TyCoVar
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; TyCoVar -&gt; TyCoVar
</span><a href="GHC.Types.Var.html#updateVarType"><span class="hs-identifier hs-var">updateVarType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569531"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569533"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681569534"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569534"><span class="hs-identifier hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569534"><span class="hs-identifier hs-var">tv'</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">{-
Note [Strictness in tidyType and friends]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Since the result of tidying will be inserted into the HPT, a potentially
long-lived structure, we generally want to avoid pieces of the old AST
being retained by the thunks produced by tidying.

For this reason we take great care to ensure that all pieces of the tidied AST
are evaluated strictly.  So you will see lots of strict applications ($!) and
uses of `strictMap` in `tidyType`, `tidyTypes` and `tidyCo`.

In the case of tidying of lists (e.g. lists of arguments) we prefer to use
`strictMap f xs` rather than `seqList (map f xs)` as the latter will
unnecessarily allocate a thunk, which will then be almost-immediately
evaluated, for each list element.

Making `tidyType` strict has a rather large effect on performance: see #14738.
Sometimes as much as a 5% reduction in allocation.
-}</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Tidy a list of Types</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- See Note [Strictness in tidyType and friends]</span><span>
</span><span id="line-149"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTypes"><span class="hs-identifier hs-type">tidyTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span id="tidyTypes"><span class="annot"><span class="annottext">tidyTypes :: TidyEnv -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Tidy.html#tidyTypes"><span class="hs-identifier hs-var hs-var">tidyTypes</span></a></span></span><span> </span><span id="local-6989586621681569535"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569535"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681569536"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681569536"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="GHC.Utils.Misc.html#strictMap"><span class="hs-identifier hs-var">strictMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569535"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681569536"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Tidy a Type</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- See Note [Strictness in tidyType and friends]</span><span>
</span><span id="line-158"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-type">tidyType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-159"></span><span id="tidyType"><span class="annot"><span class="annottext">tidyType :: TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var hs-var">tidyType</span></a></span></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621681569537"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621681569537"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569537"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-comment">-- Preserve sharing</span><span>
</span><span id="line-160"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span id="local-6989586621681569539"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569539"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621681569541"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569541"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVar -&gt; Type) -&gt; TyCoVar -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; TyCoVar -&gt; TyCoVar
</span><a href="GHC.Core.TyCo.Tidy.html#tidyTyCoVarOcc"><span class="hs-identifier hs-var">tidyTyCoVarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569539"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569541"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-161"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621681569543"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621681569543"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569543"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-comment">-- Preserve sharing if possible</span><span>
</span><span id="line-162"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span id="local-6989586621681569545"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569545"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681569546"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681569546"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621681569547"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681569547"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681569546"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Tidy.html#tidyTypes"><span class="hs-identifier hs-var">tidyTypes</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569545"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681569547"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-163"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span id="local-6989586621681569548"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569548"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621681569550"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569550"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681569551"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569551"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569548"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569550"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569548"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569551"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span id="local-6989586621681569552"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569552"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681569553"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621681569553"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681569555"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569555"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681569556"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569556"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681569557"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569557"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681569558"><span class="annot"><span class="annottext">w' :: Type
</span><a href="#local-6989586621681569558"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569552"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569555"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-165"></span><span>                                           </span><span class="hs-special">;</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681569559"><span class="annot"><span class="annottext">arg' :: Type
</span><a href="#local-6989586621681569559"><span class="hs-identifier hs-var hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569552"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569556"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-166"></span><span>                                           </span><span class="hs-special">;</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681569560"><span class="annot"><span class="annottext">res' :: Type
</span><a href="#local-6989586621681569560"><span class="hs-identifier hs-var hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569552"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569557"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-167"></span><span>                                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569553"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681569558"><span class="hs-identifier hs-type">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681569559"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681569560"><span class="hs-identifier hs-type">res'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span id="local-6989586621681569564"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569564"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681569565"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621681569565"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TyCoVar, ForAllTyFlag)] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#mkForAllTys%27"><span class="hs-identifier hs-var">mkForAllTys'</span></a></span><span> </span><span class="annot"><span class="annottext">([(TyCoVar, ForAllTyFlag)] -&gt; Type -&gt; Type)
-&gt; [(TyCoVar, ForAllTyFlag)] -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyCoVar] -&gt; [ForAllTyFlag] -&gt; [(TyCoVar, ForAllTyFlag)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base-4.18.2.1/src/GHC.List.html#zip/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569568"><span class="hs-identifier hs-var">tvs'</span></a></span><span> </span><span class="annot"><span class="annottext">[ForAllTyFlag]
</span><a href="#local-6989586621681569569"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569570"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569571"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681569572"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569572"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569569"><span class="annot"><span class="annottext">[ForAllTyFlag]
</span><a href="#local-6989586621681569569"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569571"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569571"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyCoVar], [ForAllTyFlag], Type)
</span><a href="GHC.Core.TyCo.Tidy.html#splitForAllTyCoVars%27"><span class="hs-identifier hs-var">splitForAllTyCoVars'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569565"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681569570"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569570"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569568"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569568"><span class="hs-identifier hs-var">tvs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [TyCoVar] -&gt; (TidyEnv, [TyCoVar])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndrs"><span class="hs-identifier hs-var">tidyVarBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569564"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569572"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-172"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span id="local-6989586621681569574"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569574"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621681569576"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569576"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681569577"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569577"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion -&gt; Type) -&gt; Type -&gt; KindCoercion -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569574"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569576"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; Type) -&gt; KindCoercion -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Tidy.html#tidyCo"><span class="hs-identifier hs-var">tidyCo</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569574"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569577"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span id="local-6989586621681569578"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569578"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621681569580"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569580"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; Type) -&gt; KindCoercion -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Tidy.html#tidyCo"><span class="hs-identifier hs-var">tidyCo</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569578"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569580"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- The following two functions differ from mkForAllTys and splitForAllTyCoVars in that</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- they expect/preserve the ForAllTyFlag argument. These belong to &quot;GHC.Core.Type&quot;, but</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- how should they be named?</span><span>
</span><span id="line-179"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#mkForAllTys%27"><span class="hs-identifier hs-type">mkForAllTys'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-180"></span><span id="mkForAllTys%27"><span class="annot"><span class="annottext">mkForAllTys' :: [(TyCoVar, ForAllTyFlag)] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#mkForAllTys%27"><span class="hs-identifier hs-var hs-var">mkForAllTys'</span></a></span></span><span> </span><span id="local-6989586621681569581"><span class="annot"><span class="annottext">[(TyCoVar, ForAllTyFlag)]
</span><a href="#local-6989586621681569581"><span class="hs-identifier hs-var">tvvs</span></a></span></span><span> </span><span id="local-6989586621681569582"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569582"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TyCoVar, ForAllTyFlag) -&gt; Type -&gt; Type)
-&gt; Type -&gt; [(TyCoVar, ForAllTyFlag)] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVar, ForAllTyFlag) -&gt; Type -&gt; Type
</span><a href="#local-6989586621681569584"><span class="hs-identifier hs-var">strictMkForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569582"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[(TyCoVar, ForAllTyFlag)]
</span><a href="#local-6989586621681569581"><span class="hs-identifier hs-var">tvvs</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621681569584"><span class="annot"><span class="annottext">strictMkForAllTy :: (TyCoVar, ForAllTyFlag) -&gt; Type -&gt; Type
</span><a href="#local-6989586621681569584"><span class="hs-identifier hs-var hs-var">strictMkForAllTy</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681569585"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569585"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681569586"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621681569586"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681569587"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569587"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyBinder -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">(ForAllTyBinder -&gt; Type -&gt; Type) -&gt; ForAllTyBinder -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVar -&gt; ForAllTyFlag -&gt; ForAllTyBinder
forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVar -&gt; ForAllTyFlag -&gt; ForAllTyBinder)
-&gt; TyCoVar -&gt; ForAllTyFlag -&gt; ForAllTyBinder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569585"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ForAllTyFlag -&gt; ForAllTyBinder) -&gt; ForAllTyFlag -&gt; ForAllTyBinder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621681569586"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569587"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#splitForAllTyCoVars%27"><span class="hs-identifier hs-type">splitForAllTyCoVars'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span id="splitForAllTyCoVars%27"><span class="annot"><span class="annottext">splitForAllTyCoVars' :: Type -&gt; ([TyCoVar], [ForAllTyFlag], Type)
</span><a href="GHC.Core.TyCo.Tidy.html#splitForAllTyCoVars%27"><span class="hs-identifier hs-var hs-var">splitForAllTyCoVars'</span></a></span></span><span> </span><span id="local-6989586621681569588"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569588"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
-&gt; [TyCoVar] -&gt; [ForAllTyFlag] -&gt; ([TyCoVar], [ForAllTyFlag], Type)
</span><a href="#local-6989586621681569589"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569588"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621681569589"><span class="annot"><span class="annottext">go :: Type
-&gt; [TyCoVar] -&gt; [ForAllTyFlag] -&gt; ([TyCoVar], [ForAllTyFlag], Type)
</span><a href="#local-6989586621681569589"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621681569590"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569590"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681569591"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621681569591"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681569592"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569592"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681569593"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569593"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681569594"><span class="annot"><span class="annottext">[ForAllTyFlag]
</span><a href="#local-6989586621681569594"><span class="hs-identifier hs-var">viss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
-&gt; [TyCoVar] -&gt; [ForAllTyFlag] -&gt; ([TyCoVar], [ForAllTyFlag], Type)
</span><a href="#local-6989586621681569589"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569592"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569590"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">TyCoVar -&gt; [TyCoVar] -&gt; [TyCoVar]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569593"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621681569591"><span class="hs-identifier hs-var">vis</span></a></span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; [ForAllTyFlag] -&gt; [ForAllTyFlag]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[ForAllTyFlag]
</span><a href="#local-6989586621681569594"><span class="hs-identifier hs-var">viss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="#local-6989586621681569589"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681569595"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569595"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                          </span><span id="local-6989586621681569596"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569596"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681569597"><span class="annot"><span class="annottext">[ForAllTyFlag]
</span><a href="#local-6989586621681569597"><span class="hs-identifier hs-var">viss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyCoVar] -&gt; [TyCoVar]
forall a. [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.List.html#reverse/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569596"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ForAllTyFlag] -&gt; [ForAllTyFlag]
forall a. [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.List.html#reverse/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[ForAllTyFlag]
</span><a href="#local-6989586621681569597"><span class="hs-identifier hs-var">viss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569595"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Grabs the free type variables, tidies them</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- and then uses 'tidyType' to work over the type itself</span><span>
</span><span id="line-194"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTypes"><span class="hs-identifier hs-type">tidyOpenTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span id="tidyOpenTypes"><span class="annot"><span class="annottext">tidyOpenTypes :: TidyEnv -&gt; [Type] -&gt; (TidyEnv, [Type])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTypes"><span class="hs-identifier hs-var hs-var">tidyOpenTypes</span></a></span></span><span> </span><span id="local-6989586621681569599"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569599"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681569600"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681569600"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569601"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Tidy.html#tidyTypes"><span class="hs-identifier hs-var">tidyTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyOccEnv
</span><a href="#local-6989586621681569602"><span class="hs-identifier hs-var">trimmed_occ_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569603"><span class="hs-identifier hs-var">var_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681569600"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681569601"><span class="annot"><span class="annottext">env' :: TidyEnv
</span><a href="#local-6989586621681569601"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyOccEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569603"><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569603"><span class="hs-identifier hs-var">var_env</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569604"><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569604"><span class="hs-identifier hs-var">tvs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [TyCoVar] -&gt; (TidyEnv, [TyCoVar])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTyCoVars"><span class="hs-identifier hs-var">tidyOpenTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569599"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">([TyCoVar] -&gt; (TidyEnv, [TyCoVar]))
-&gt; [TyCoVar] -&gt; (TidyEnv, [TyCoVar])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-199"></span><span>                                </span><span class="annot"><span class="annottext">[Type] -&gt; [TyCoVar]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier hs-var">tyCoVarsOfTypesWellScoped</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681569600"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621681569602"><span class="annot"><span class="annottext">trimmed_occ_env :: TidyOccEnv
</span><a href="#local-6989586621681569602"><span class="hs-identifier hs-var hs-var">trimmed_occ_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OccName] -&gt; TidyOccEnv
</span><a href="GHC.Types.Name.Occurrence.html#initTidyOccEnv"><span class="hs-identifier hs-var">initTidyOccEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyCoVar -&gt; OccName) -&gt; [TyCoVar] -&gt; [OccName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; OccName
forall a. NamedThing a =&gt; a -&gt; OccName
</span><a href="GHC.Types.Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCoVar]
</span><a href="#local-6989586621681569604"><span class="hs-identifier hs-var">tvs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>      </span><span class="hs-comment">-- The idea here was that we restrict the new TidyEnv to the</span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-comment">-- _free_ vars of the types, so that we don't gratuitously rename</span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-comment">-- the _bound_ variables of the types.</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-206"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyOpenType"><span class="hs-identifier hs-type">tidyOpenType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span id="tidyOpenType"><span class="annot"><span class="annottext">tidyOpenType :: TidyEnv -&gt; Type -&gt; (TidyEnv, Type)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenType"><span class="hs-identifier hs-var hs-var">tidyOpenType</span></a></span></span><span> </span><span id="local-6989586621681569606"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569606"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681569607"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569607"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681569608"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569608"><span class="hs-identifier hs-var">env'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681569609"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569609"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; [Type] -&gt; (TidyEnv, [Type])
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenTypes"><span class="hs-identifier hs-var">tidyOpenTypes</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569606"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569607"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-208"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569608"><span class="hs-identifier hs-var">env'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569609"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-211"></span><span class="annot"><span class="hs-comment">-- | Calls 'tidyType' on a top-level type (i.e. with an empty tidying environment)</span></span><span>
</span><span id="line-212"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyTopType"><span class="hs-identifier hs-type">tidyTopType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-213"></span><span id="tidyTopType"><span class="annot"><span class="annottext">tidyTopType :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyTopType"><span class="hs-identifier hs-var hs-var">tidyTopType</span></a></span></span><span> </span><span id="local-6989586621681569610"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569610"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="GHC.Types.Var.Env.html#emptyTidyEnv"><span class="hs-identifier hs-var">emptyTidyEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569610"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Tidy a Coercion</span><span>
</span><span id="line-218"></span><span class="hs-comment">--</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- See Note [Strictness in tidyType and friends]</span><span>
</span><span id="line-220"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyCo"><span class="hs-identifier hs-type">tidyCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-221"></span><span id="tidyCo"><span class="annot"><span class="annottext">tidyCo :: TidyEnv -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Tidy.html#tidyCo"><span class="hs-identifier hs-var hs-var">tidyCo</span></a></span></span><span> </span><span id="local-6989586621681569613"><span class="annot"><span class="annottext">env :: TidyEnv
</span><a href="#local-6989586621681569613"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyOccEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569614"><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569614"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681569615"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569615"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569615"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621681569617"><span class="annot"><span class="annottext">go_mco :: MCoercion -&gt; MCoercion
</span><a href="#local-6989586621681569617"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><a href="#local-6989586621681569617"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621681569620"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569620"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-var">MCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; MCoercion) -&gt; KindCoercion -&gt; MCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569620"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621681569616"><span class="annot"><span class="annottext">go :: KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621681569622"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569622"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion) -&gt; Type -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569613"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569622"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621681569624"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681569624"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681569625"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569625"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681569626"><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621681569626"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; MCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-var">GRefl</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681569624"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; MCoercion -&gt; KindCoercion)
-&gt; Type -&gt; MCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569613"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569625"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MCoercion -&gt; KindCoercion) -&gt; MCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercion -&gt; MCoercion
</span><a href="#local-6989586621681569617"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621681569626"><span class="hs-identifier hs-var">mco</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621681569628"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681569628"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681569629"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681569629"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681569630"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621681569630"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role -&gt; TyCon -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681569628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681569629"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="GHC.Utils.Misc.html#strictMap"><span class="hs-identifier hs-var">strictMap</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621681569630"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621681569632"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569632"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621681569633"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569633"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569632"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569633"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span id="local-6989586621681569635"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569635"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681569636"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569636"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621681569637"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569637"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCoVar -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCoVar -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; TyCoVar -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569638"><span class="hs-identifier hs-var">tvp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569636"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Tidy.html#tidyCo"><span class="hs-identifier hs-var">tidyCo</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569639"><span class="hs-identifier hs-var">envp</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569637"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>                               </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681569639"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569639"><span class="hs-identifier hs-var">envp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681569638"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569638"><span class="hs-identifier hs-var">tvp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; TyCoVar -&gt; (TidyEnv, TyCoVar)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyVarBndr"><span class="hs-identifier hs-var">tidyVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569613"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569635"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-233"></span><span>            </span><span class="hs-comment">-- the case above duplicates a bit of work in tidying h and the kind</span><span>
</span><span id="line-234"></span><span>            </span><span class="hs-comment">-- of tv. But the alternative is to use coercionKind, which seems worse.</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span id="local-6989586621681569641"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681569641"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681569642"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681569642"><span class="hs-identifier hs-var">afl</span></a></span></span><span> </span><span id="local-6989586621681569643"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681569643"><span class="hs-identifier hs-var">afr</span></a></span></span><span> </span><span id="local-6989586621681569644"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569644"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681569645"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569645"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621681569646"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569646"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
-&gt; FunTyFlag
-&gt; FunTyFlag
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
-&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-var">FunCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681569641"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681569642"><span class="hs-identifier hs-var">afl</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681569643"><span class="hs-identifier hs-var">afr</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569644"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569645"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569646"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621681569648"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569648"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar -&gt; TyCoVar -&gt; Maybe TyCoVar
forall a. VarEnv a -&gt; TyCoVar -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv TyCoVar
</span><a href="#local-6989586621681569614"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569648"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-237"></span><span>                                 </span><span class="annot"><span class="annottext">Maybe TyCoVar
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569648"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-238"></span><span>                                 </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681569649"><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569649"><span class="hs-identifier hs-var">cv'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCoVar -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoVar
</span><a href="#local-6989586621681569649"><span class="hs-identifier hs-var">cv'</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621681569651"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621681569651"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercionHole -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-var">HoleCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621681569651"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomInstCo"><span class="hs-identifier hs-type">AxiomInstCo</span></a></span><span> </span><span id="local-6989586621681569653"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621681569653"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681569654"><span class="annot"><span class="annottext">BranchIndex
</span><a href="#local-6989586621681569654"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621681569655"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621681569655"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; BranchIndex -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621681569653"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">BranchIndex
</span><a href="#local-6989586621681569654"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="GHC.Utils.Misc.html#strictMap"><span class="hs-identifier hs-var">strictMap</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621681569655"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span id="local-6989586621681569657"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621681569657"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681569658"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681569658"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681569659"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569659"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681569660"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569660"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a></span><span> </span><span class="annot"><span class="annottext">(UnivCoProvenance -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion)
-&gt; UnivCoProvenance -&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; UnivCoProvenance
</span><a href="#local-6989586621681569661"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621681569657"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Role -&gt; Type -&gt; Type -&gt; KindCoercion)
-&gt; Role -&gt; Type -&gt; Type -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681569658"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; KindCoercion) -&gt; Type -&gt; Type -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span>
</span><span id="line-242"></span><span>                                </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569613"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569659"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; KindCoercion) -&gt; Type -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Tidy.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569613"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681569660"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621681569663"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569663"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569663"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621681569665"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569665"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621681569666"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569666"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569665"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569666"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span id="local-6989586621681569668"><span class="annot"><span class="annottext">CoSel
</span><a href="#local-6989586621681569668"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681569669"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569669"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoSel -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-var">SelCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoSel
</span><a href="#local-6989586621681569668"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569669"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621681569671"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621681569671"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621681569672"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569672"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftOrRight -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621681569671"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569672"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621681569674"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569674"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621681569675"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569675"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion -&gt; KindCoercion)
-&gt; KindCoercion -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569674"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569675"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621681569677"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569677"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569677"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621681569679"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569679"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; KindCoercion -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569679"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-type">AxiomRuleCo</span></a></span><span> </span><span id="local-6989586621681569681"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621681569681"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621681569682"><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621681569682"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiomRule -&gt; [KindCoercion] -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621681569681"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">([KindCoercion] -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; KindCoercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="GHC.Utils.Misc.html#strictMap"><span class="hs-identifier hs-var">strictMap</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[KindCoercion]
</span><a href="#local-6989586621681569682"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621681569661"><span class="annot"><span class="annottext">go_prov :: UnivCoProvenance -&gt; UnivCoProvenance
</span><a href="#local-6989586621681569661"><span class="hs-identifier hs-var hs-var">go_prov</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-type">PhantomProv</span></a></span><span> </span><span id="local-6989586621681569684"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569684"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; UnivCoProvenance)
-&gt; KindCoercion -&gt; UnivCoProvenance
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569684"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="#local-6989586621681569661"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-type">ProofIrrelProv</span></a></span><span> </span><span id="local-6989586621681569686"><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569686"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a></span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; UnivCoProvenance)
-&gt; KindCoercion -&gt; UnivCoProvenance
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; KindCoercion
</span><a href="#local-6989586621681569616"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><a href="#local-6989586621681569686"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><a href="#local-6989586621681569661"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span id="local-6989586621681569687"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621681569687"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PluginProv"><span class="hs-identifier hs-type">PluginProv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621681569687"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="#local-6989586621681569661"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span id="local-6989586621681569689"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621681569689"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CorePrepProv"><span class="hs-identifier hs-type">CorePrepProv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621681569689"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><a href="GHC.Core.TyCo.Tidy.html#tidyCos"><span class="hs-identifier hs-type">tidyCos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TidyEnv"><span class="hs-identifier hs-type">TidyEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span id="tidyCos"><span class="annot"><span class="annottext">tidyCos :: TidyEnv -&gt; [KindCoercion] -&gt; [KindCoercion]
</span><a href="GHC.Core.TyCo.Tidy.html#tidyCos"><span class="hs-identifier hs-var hs-var">tidyCos</span></a></span></span><span> </span><span id="local-6989586621681569691"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569691"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(KindCoercion -&gt; KindCoercion) -&gt; [KindCoercion] -&gt; [KindCoercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="GHC.Utils.Misc.html#strictMap"><span class="hs-identifier hs-var">strictMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv -&gt; KindCoercion -&gt; KindCoercion
</span><a href="GHC.Core.TyCo.Tidy.html#tidyCo"><span class="hs-identifier hs-var">tidyCo</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681569691"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span></pre></body></html>