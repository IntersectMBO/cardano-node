<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span> </span><span class="hs-comment">-- Wrinkle in Note [Trees That Grow]</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns        #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE DisambiguateRecordFields #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">{-
%
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998
-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Tc.Gen.Head</span><span>
</span><span id="line-19"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier">HsExprArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier">EValArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcPass"><span class="hs-identifier">TcPass</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier">AppCtxt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier">appCtxtLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#insideExpansion"><span class="hs-identifier">insideExpansion</span></a></span><span>
</span><span id="line-21"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#splitHsApps"><span class="hs-identifier">splitHsApps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier">rebuildHsApps</span></a></span><span>
</span><span id="line-22"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addArgWrap"><span class="hs-identifier">addArgWrap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier">isHsValArg</span></a></span><span>
</span><span id="line-23"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier">countLeadingValArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier">isVisibleArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#pprHsExprArgTc"><span class="hs-identifier">pprHsExprArgTc</span></a></span><span>
</span><span id="line-24"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier">countVisAndInvisValArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countHsWrapperInvisArgs"><span class="hs-identifier">countHsWrapperInvisArgs</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAppHead"><span class="hs-identifier">tcInferAppHead</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier">tcInferAppHead_maybe</span></a></span><span>
</span><span id="line-27"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier">tcInferId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcCheckId"><span class="hs-identifier">tcCheckId</span></a></span><span>
</span><span id="line-28"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier">obviousSig</span></a></span><span>
</span><span id="line-29"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier">tyConOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tyConOfET"><span class="hs-identifier">tyConOfET</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#lookupParents"><span class="hs-identifier">lookupParents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#fieldNotInType"><span class="hs-identifier">fieldNotInType</span></a></span><span>
</span><span id="line-30"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#notSelector"><span class="hs-identifier">notSelector</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#nonBidirectionalErr"><span class="hs-identifier">nonBidirectionalErr</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addHeadCtxt"><span class="hs-identifier">addHeadCtxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addExprCtxt"><span class="hs-identifier">addExprCtxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addFunResCtxt"><span class="hs-identifier">addFunResCtxt</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Expr.html"><span class="hs-identifier">GHC.Tc.Gen.Expr</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Expr.html#tcExpr"><span class="hs-identifier">tcExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Expr.html#tcCheckMonoExprNC"><span class="hs-identifier">tcCheckMonoExprNC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Expr.html#tcCheckPolyExprNC"><span class="hs-identifier">tcCheckPolyExprNC</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.HsType.html"><span class="hs-identifier">GHC.Tc.Gen.HsType</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html"><span class="hs-identifier">GHC.Rename.Unbound</span></a></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html#unknownNameSuggestions"><span class="hs-identifier">unknownNameSuggestions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html#WhatLooking"><span class="hs-identifier">WhatLooking</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Bind.html"><span class="hs-identifier">GHC.Tc.Gen.Bind</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Bind.html#chooseInferredQuantifiers"><span class="hs-identifier">chooseInferredQuantifiers</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html"><span class="hs-identifier">GHC.Tc.Gen.Sig</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcUserTypeSig"><span class="hs-identifier">tcUserTypeSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcInstSig"><span class="hs-identifier">tcInstSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#lhsSigWcTypeContextSpan"><span class="hs-identifier">lhsSigWcTypeContextSpan</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.TyCl.PatSyn.html"><span class="hs-identifier">GHC.Tc.TyCl.PatSyn</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.TyCl.PatSyn.html#patSynBuilderOcc"><span class="hs-identifier">patSynBuilderOcc</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Unify.html"><span class="hs-identifier">GHC.Tc.Utils.Unify</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Concrete.html"><span class="hs-identifier">GHC.Tc.Utils.Concrete</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Concrete.html#hasFixedRuntimeRep_syntactic"><span class="hs-identifier">hasFixedRuntimeRep_syntactic</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html"><span class="hs-identifier">GHC.Tc.Utils.Instantiate</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Instance.Family.html"><span class="hs-identifier">GHC.Tc.Instance.Family</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Instance.Family.html#tcLookupDataFamInst"><span class="hs-identifier">tcLookupDataFamInst</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier">getModule</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html"><span class="hs-identifier">GHC.Tc.Errors.Types</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html"><span class="hs-identifier">GHC.Tc.Solver</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html#InferMode"><span class="hs-identifier">InferMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html#simplifyInfer"><span class="hs-identifier">simplifyInfer</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html"><span class="hs-identifier">GHC.Tc.Utils.Env</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcMType.html"><span class="hs-identifier">GHC.Tc.Utils.TcMType</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html"><span class="hs-identifier">GHC.Tc.Types.Origin</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TcType</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html"><span class="hs-identifier">GHC.Tc.Types.Evidence</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.Syn.Type.html"><span class="hs-identifier">GHC.Hs.Syn.Type</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html"><span class="hs-identifier">GHC.Core.FamInstEnv</span></a></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier">FamInstEnvs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html"><span class="hs-identifier">GHC.Core.UsageEnv</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#unitUE"><span class="hs-identifier">unitUE</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.PatSyn.html"><span class="hs-identifier">GHC.Core.PatSyn</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.PatSyn.html#PatSyn"><span class="hs-identifier">PatSyn</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html"><span class="hs-identifier">GHC.Core.ConLike</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier">ConLike</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isInvisibleFunArg"><span class="hs-identifier">isInvisibleFunArg</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html"><span class="hs-identifier">GHC.Types.Id.Info</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Error.html"><span class="hs-identifier">GHC.Types.Error</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#multiplicityTy"><span class="hs-identifier">multiplicityTy</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.TH.html"><span class="hs-identifier">GHC.Builtin.Names.TH</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.TH.html#liftStringName"><span class="hs-identifier">liftStringName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.TH.html#liftName"><span class="hs-identifier">liftName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html"><span class="hs-identifier">GHC.Driver.Env</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html"><span class="hs-identifier">GHC.Utils.Panic.Plain</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
              HsExprArg: auxiliary data type
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">{- Note [HsExprArg]
~~~~~~~~~~~~~~~~~~~
The data type HsExprArg :: TcPass -&gt; Type
is a very local type, used only within this module and GHC.Tc.Gen.App

* It's really a zipper for an application chain
  See Note [Application chains and heads] in GHC.Tc.Gen.App for
  what an &quot;application chain&quot; is.

* It's a GHC-specific type, so using TTG only where necessary

* It is indexed by TcPass, meaning
  - HsExprArg TcpRn:
      The result of splitHsApps, which decomposes a HsExpr GhcRn

  - HsExprArg TcpInst:
      The result of tcInstFun, which instantiates the function type
      Adds EWrap nodes, the argument type in EValArg,
      and the kind-checked type in ETypeArg

  - HsExprArg TcpTc:
      The result of tcArg, which typechecks the value args
      In EValArg we now have a (LHsExpr GhcTc)

* rebuildPrefixApps is dual to splitHsApps, and zips an application
  back into a HsExpr

Note [EValArg]
~~~~~~~~~~~~~~
The data type EValArg is the payload of the EValArg constructor of
HsExprArg; i.e. a value argument of the application.  EValArg has two
forms:

* ValArg: payload is just the expression itself. Simple.

* ValArgQL: captures the results of applying quickLookArg to the
  argument in a ValArg.  When we later want to typecheck that argument
  we can just carry on from where quick-look left off.  The fields of
  ValArgQL exactly capture what is needed to complete the job.

Invariants:

1. With QL switched off, all arguments are ValArg; no ValArgQL

2. With QL switched on, tcInstFun converts some ValArgs to ValArgQL,
   under the conditions when quick-look should happen (eg the argument
   type is guarded) -- see quickLookArg

Note [splitHsApps]
~~~~~~~~~~~~~~~~~~
The key function
  splitHsApps :: HsExpr GhcRn -&gt; (HsExpr GhcRn, HsExpr GhcRn, [HsExprArg 'TcpRn])
takes apart either an HsApp, or an infix OpApp, returning

* The &quot;head&quot; of the application, an expression that is often a variable;
  this is used for typechecking

* The &quot;user head&quot; or &quot;error head&quot; of the application, to be reported to the
  user in case of an error.  Example:
         (`op` e)
  expands (via HsExpanded) to
         (rightSection op e)
  but we don't want to see 'rightSection' in error messages. So we keep the
  innermost un-expanded head as the &quot;error head&quot;.

* A list of HsExprArg, the arguments
-}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">data</span><span> </span><span id="TcPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcPass"><span class="hs-identifier hs-var">TcPass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TcpRn"><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-var">TcpRn</span></a></span></span><span>     </span><span class="hs-comment">-- Arguments decomposed</span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="TcpInst"><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-var">TcpInst</span></a></span></span><span>   </span><span class="hs-comment">-- Function instantiated</span><span>
</span><span id="line-170"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="TcpTc"><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpTc"><span class="hs-identifier hs-var">TcpTc</span></a></span></span><span>     </span><span class="hs-comment">-- Typechecked</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">data</span><span> </span><span id="HsExprArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-var">HsExprArg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682057149"><span class="annot"><a href="#local-6989586621682057149"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcPass"><span class="hs-identifier hs-type">TcPass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- See Note [HsExprArg]</span><span>
</span><span id="line-174"></span><span>    </span><span id="EValArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-var">EValArg</span></a></span></span><span>  </span><span class="hs-special">{</span><span> </span><span id="eva_ctxt"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var hs-var">eva_ctxt</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-175"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_arg"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var hs-var">eva_arg</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057149"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-176"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_arg_ty"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; XEVAType p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg_ty"><span class="hs-identifier hs-var hs-var">eva_arg_ty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XEVAType"><span class="hs-identifier hs-type">XEVAType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057149"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ETypeArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-var">ETypeArg</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="eva_ctxt"><span class="annot"><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-179"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_at"><span class="annot"><span class="annottext">forall (p :: TcPass).
HsExprArg p -&gt; LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_at"><span class="hs-identifier hs-var hs-var">eva_at</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Concrete.html#LHsToken"><span class="hs-identifier hs-type">LHsToken</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_hs_ty"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; LHsWcType (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_hs_ty"><span class="hs-identifier hs-var hs-var">eva_hs_ty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>  </span><span class="hs-comment">-- The type arg</span><span>
</span><span id="line-181"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_ty"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; XETAType p
</span><a href="GHC.Tc.Gen.Head.html#eva_ty"><span class="hs-identifier hs-var hs-var">eva_ty</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XETAType"><span class="hs-identifier hs-type">XETAType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057149"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-comment">-- Kind-checked type arg</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EPrag"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-var">EPrag</span></a></span></span><span>    </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-184"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-type">XPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057149"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EWrap"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span></span><span>    </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">data</span><span> </span><span id="EWrap"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EPar"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-var">EPar</span></a></span></span><span>    </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-189"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="EExpand"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-var">EExpand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="EHsWrap"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-var">EHsWrap</span></a></span></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">data</span><span> </span><span id="EValArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-var">EValArg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682057686"><span class="annot"><a href="#local-6989586621682057686"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcPass"><span class="hs-identifier hs-type">TcPass</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>  </span><span class="hs-comment">-- See Note [EValArg]</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621682057167"><span id="ValArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-var">ValArg</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-type">XPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057167"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057167"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>  </span><span id="ValArgQL"><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArgQL"><span class="hs-identifier hs-var">ValArgQL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><span id="va_expr"><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; LHsExpr (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#va_expr"><span class="hs-identifier hs-var hs-var">va_expr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>        </span><span class="hs-comment">-- Original application</span><span>
</span><span id="line-197"></span><span>                                                </span><span class="hs-comment">-- For location and error msgs</span><span>
</span><span id="line-198"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="va_fun"><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; (HsExpr GhcTc, AppCtxt)
</span><a href="GHC.Tc.Gen.Head.html#va_fun"><span class="hs-identifier hs-var hs-var">va_fun</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Function of the application,</span><span>
</span><span id="line-199"></span><span>                                                   </span><span class="hs-comment">-- typechecked, plus its context</span><span>
</span><span id="line-200"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="va_args"><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; [HsExprArg 'TcpInst]
</span><a href="GHC.Tc.Gen.Head.html#va_args"><span class="hs-identifier hs-var hs-var">va_args</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Args, instantiated</span><span>
</span><span id="line-201"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="va_ty"><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; TcSigmaType
</span><a href="GHC.Tc.Gen.Head.html#va_ty"><span class="hs-identifier hs-var hs-var">va_ty</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span> </span><span class="hs-special">}</span><span>          </span><span class="hs-comment">-- Result type</span><span>
</span><span id="line-202"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span>  </span><span class="hs-comment">-- Only exists in TcpInst phase</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">data</span><span> </span><span id="AppCtxt"><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-var">AppCtxt</span></a></span></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VAExpansion"><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-var">VAExpansion</span></a></span></span><span>
</span><span id="line-206"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Inside an expansion of this expression</span><span>
</span><span id="line-207"></span><span>       </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>           </span><span class="hs-comment">-- The SrcSpan of the expression</span><span>
</span><span id="line-208"></span><span>                         </span><span class="hs-comment">--    noSrcSpan if outermost; see Note [AppCtxt]</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="VACall"><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span></span><span>
</span><span id="line-211"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>  </span><span class="hs-comment">-- In the third argument of function f</span><span>
</span><span id="line-212"></span><span>       </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>             </span><span class="hs-comment">-- The SrcSpan of the application (f e1 e2 e3)</span><span>
</span><span id="line-213"></span><span>                         </span><span class="hs-comment">--    noSrcSpan if outermost; see Note [AppCtxt]</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">{- Note [AppCtxt]
~~~~~~~~~~~~~~~~~
In a call (f e1 ... en), we pair up each argument with an AppCtxt. For
example, the AppCtxt for e3 allows us to say
    &quot;In the third argument of `f`&quot;
See splitHsApps.

To do this we must take a quick look into the expression to find the
function at the head (`f` in this case) and how many arguments it
has. That is what the funcion top_ctxt does.

If the function part is an expansion, we don't want to look further.
For example, with rebindable syntax the expression
    (if e1 then e2 else e3) e4 e5
might expand to
    (ifThenElse e1 e2 e3) e4 e5
For e4 we an AppCtxt that says &quot;In the first argument of (if ...)&quot;,
not &quot;In the fourth argument of ifThenElse&quot;.  So top_ctxt stops
at expansions.

The SrcSpan in an AppCtxt describes the whole call.  We initialise
it to noSrcSpan, because splitHsApps deals in HsExpr not LHsExpr, so
we don't have a span for the whole call; and we use that noSrcSpan in
GHC.Tc.Gen.App.tcInstFun (set_fun_ctxt) to avoid pushing &quot;In the expression `f`&quot;
a second time.
-}</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-type">appCtxtLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>
</span><span id="line-243"></span><span id="appCtxtLoc"><span class="annot"><span class="annottext">appCtxtLoc :: AppCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var hs-var">appCtxtLoc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057700"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682057700"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682057700"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-244"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var">appCtxtLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057701"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682057701"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682057701"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#insideExpansion"><span class="hs-identifier hs-type">insideExpansion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-247"></span><span id="insideExpansion"><span class="annot"><span class="annottext">insideExpansion :: AppCtxt -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#insideExpansion"><span class="hs-identifier hs-var hs-var">insideExpansion</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-248"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#insideExpansion"><span class="hs-identifier hs-var">insideExpansion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621682057713"><span class="annot"><span class="annottext">ppr :: AppCtxt -&gt; SDoc
</span><a href="#local-6989586621682057713"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span id="local-6989586621682057715"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057715"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;VAExpansion&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057715"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span id="local-6989586621682057718"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057718"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682057719"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057719"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;VACall&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; SDoc
forall doc. IsLine doc =&gt; ThLevel -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057719"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057718"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="XPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-var">XPass</span></a></span></span><span> </span><span id="local-6989586621682057721"><span class="annot"><a href="#local-6989586621682057721"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="XPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-var">XPass</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Hs.Extension.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span id="XPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-var">XPass</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Hs.Extension.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span id="XPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-var">XPass</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpTc"><span class="hs-identifier hs-type">TcpTc</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Hs.Extension.html#Typechecked"><span class="hs-identifier hs-type">Typechecked</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="XETAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XETAType"><span class="hs-identifier hs-var">XETAType</span></a></span></span><span> </span><span id="local-6989586621682057722"><span class="annot"><a href="#local-6989586621682057722"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>  </span><span class="hs-comment">-- Type arguments</span><span>
</span><span id="line-260"></span><span>  </span><span id="XETAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XETAType"><span class="hs-identifier hs-var">XETAType</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#NoExtField"><span class="hs-identifier hs-type">NoExtField</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span id="XETAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XETAType"><span class="hs-identifier hs-var">XETAType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="XEVAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XEVAType"><span class="hs-identifier hs-var">XEVAType</span></a></span></span><span> </span><span id="local-6989586621682057724"><span class="annot"><a href="#local-6989586621682057724"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>  </span><span class="hs-comment">-- Value arguments</span><span>
</span><span id="line-264"></span><span>  </span><span id="XEVAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XEVAType"><span class="hs-identifier hs-var">XEVAType</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#NoExtField"><span class="hs-identifier hs-type">NoExtField</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="XEVAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XEVAType"><span class="hs-identifier hs-var">XEVAType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-type">mkEValArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span>
</span><span id="line-268"></span><span id="mkEValArg"><span class="annot"><span class="annottext">mkEValArg :: AppCtxt -&gt; LHsExpr (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-var hs-var">mkEValArg</span></a></span></span><span> </span><span id="local-6989586621682057726"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057726"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057727"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057727"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: EValArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass (XPass 'TcpRn)) -&gt; EValArg 'TcpRn
forall (p :: TcPass). LHsExpr (GhcPass (XPass p)) -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-var">ValArg</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
LHsExpr (GhcPass (XPass 'TcpRn))
</span><a href="#local-6989586621682057727"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ctxt :: AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057726"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-269"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_arg_ty :: XEVAType 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#eva_arg_ty"><span class="hs-identifier hs-var">eva_arg_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoExtField
XEVAType 'TcpRn
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#mkETypeArg"><span class="hs-identifier hs-type">mkETypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Concrete.html#LHsToken"><span class="hs-identifier hs-type">LHsToken</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span>
</span><span id="line-272"></span><span id="mkETypeArg"><span class="annot"><span class="annottext">mkETypeArg :: AppCtxt
-&gt; LHsToken &quot;@&quot; (GhcPass 'Renamed)
-&gt; LHsWcType (GhcPass 'Renamed)
-&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkETypeArg"><span class="hs-identifier hs-var hs-var">mkETypeArg</span></a></span></span><span> </span><span id="local-6989586621682057730"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057730"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057731"><span class="annot"><span class="annottext">LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><a href="#local-6989586621682057731"><span class="hs-identifier hs-var">at</span></a></span></span><span> </span><span id="local-6989586621682057732"><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682057732"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_ctxt :: AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057730"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-274"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_at :: LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_at"><span class="hs-identifier hs-var">eva_at</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><a href="#local-6989586621682057731"><span class="hs-identifier hs-var">at</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_hs_ty :: LHsWcType (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_hs_ty"><span class="hs-identifier hs-var">eva_hs_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682057732"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-275"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ty :: XETAType 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#eva_ty"><span class="hs-identifier hs-var">eva_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoExtField
XETAType 'TcpRn
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addArgWrap"><span class="hs-identifier hs-type">addArgWrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span id="addArgWrap"><span class="annot"><span class="annottext">addArgWrap :: HsWrapper -&gt; [HsExprArg 'TcpInst] -&gt; [HsExprArg 'TcpInst]
</span><a href="GHC.Tc.Gen.Head.html#addArgWrap"><span class="hs-identifier hs-var hs-var">addArgWrap</span></a></span></span><span> </span><span id="local-6989586621682057733"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057733"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621682057734"><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621682057734"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-279"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; Bool
</span><a href="GHC.Tc.Types.Evidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057733"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621682057734"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-280"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EWrap -&gt; HsExprArg 'TcpInst
forall (p :: TcPass). EWrap -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; EWrap
</span><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-var">EHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057733"><span class="hs-identifier hs-var">wrap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpInst -&gt; [HsExprArg 'TcpInst] -&gt; [HsExprArg 'TcpInst]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621682057734"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#splitHsApps"><span class="hs-identifier hs-type">splitHsApps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-283"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Head</span><span>
</span><span id="line-284"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- Args</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- See Note [splitHsApps]</span><span>
</span><span id="line-286"></span><span id="splitHsApps"><span class="annot"><span class="annottext">splitHsApps :: HsExpr (GhcPass 'Renamed)
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="GHC.Tc.Gen.Head.html#splitHsApps"><span class="hs-identifier hs-var hs-var">splitHsApps</span></a></span></span><span> </span><span id="local-6989586621682057736"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057736"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057736"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel -&gt; HsExpr (GhcPass 'Renamed) -&gt; AppCtxt
</span><a href="#local-6989586621682057738"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057736"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="#local-6989586621682057738"><span class="hs-identifier hs-type">top_ctxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-comment">-- Always returns VACall fun n_val_args noSrcSpan</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-comment">-- to initialise the argument splitting in 'go'</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-comment">-- See Note [AppCtxt]</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621682057738"><span class="annot"><span class="annottext">top_ctxt :: ThLevel -&gt; HsExpr (GhcPass 'Renamed) -&gt; AppCtxt
</span><a href="#local-6989586621682057738"><span class="hs-identifier hs-var hs-var">top_ctxt</span></a></span></span><span> </span><span id="local-6989586621682057739"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057739"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;(&quot; (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057741"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057741"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;)&quot; (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
forall {l}.
ThLevel -&gt; GenLocated l (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621682057742"><span class="hs-identifier hs-var">top_lctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057739"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed))
</span><a href="#local-6989586621682057741"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="#local-6989586621682057738"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621682057743"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057743"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057745"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057745"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
forall {l}.
ThLevel -&gt; GenLocated l (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621682057742"><span class="hs-identifier hs-var">top_lctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057743"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed))
</span><a href="#local-6989586621682057745"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="#local-6989586621682057738"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621682057746"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057746"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057748"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057748"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc (GhcPass 'Renamed))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
forall {l}.
ThLevel -&gt; GenLocated l (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621682057742"><span class="hs-identifier hs-var">top_lctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057746"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed))
</span><a href="#local-6989586621682057748"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="#local-6989586621682057738"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621682057750"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057750"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-type">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057752"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057752"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
forall {l}.
ThLevel -&gt; GenLocated l (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621682057742"><span class="hs-identifier hs-var">top_lctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057750"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed))
</span><a href="#local-6989586621682057752"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="#local-6989586621682057738"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621682057753"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057753"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpanded"><span class="hs-identifier hs-type">HsExpanded</span></a></span><span> </span><span id="local-6989586621682057756"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057756"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057756"><span class="hs-identifier hs-var">orig</span></a></span><span>      </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057753"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="#local-6989586621682057738"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621682057758"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057758"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682057759"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057759"><span class="hs-identifier hs-var">other_fun</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057759"><span class="hs-identifier hs-var">other_fun</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057758"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621682057742"><span class="annot"><span class="annottext">top_lctxt :: ThLevel -&gt; GenLocated l (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621682057742"><span class="hs-identifier hs-var hs-var">top_lctxt</span></a></span></span><span> </span><span id="local-6989586621682057760"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057760"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057762"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057762"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; HsExpr (GhcPass 'Renamed) -&gt; AppCtxt
</span><a href="#local-6989586621682057738"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057760"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057762"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="#local-6989586621682057737"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-comment">-- Modify the AppCtxt as we walk inwards, so it describes the next argument</span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621682057737"><span class="annot"><span class="annottext">go :: HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621682057737"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;(&quot; (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682057763"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057763"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682057764"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057764"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;)&quot; (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span id="local-6989586621682057765"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057765"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057766"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057766"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057764"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621682057767"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057763"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057765"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EWrap -&gt; HsExprArg 'TcpRn
forall (p :: TcPass). EWrap -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; EWrap
</span><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-var">EPar</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057765"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; [HsExprArg 'TcpRn] -&gt; [HsExprArg 'TcpRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057766"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057768"><span class="annot"><span class="annottext">HsPragE (GhcPass 'Renamed)
</span><a href="#local-6989586621682057768"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682057769"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057769"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682057770"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057770"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span id="local-6989586621682057771"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057771"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057772"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057772"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057770"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621682057767"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057769"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057771"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; HsPragE (GhcPass (XPass 'TcpRn)) -&gt; HsExprArg 'TcpRn
forall (p :: TcPass).
AppCtxt -&gt; HsPragE (GhcPass (XPass p)) -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-var">EPrag</span></a></span><span>      </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057771"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass 'Renamed)
HsPragE (GhcPass (XPass 'TcpRn))
</span><a href="#local-6989586621682057768"><span class="hs-identifier hs-var">p</span></a></span><span>     </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; [HsExprArg 'TcpRn] -&gt; [HsExprArg 'TcpRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057772"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682057773"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057773"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682057774"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057774"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682057775"><span class="annot"><span class="annottext">LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><a href="#local-6989586621682057775"><span class="hs-identifier hs-var">at</span></a></span></span><span> </span><span id="local-6989586621682057776"><span class="annot"><span class="annottext">LHsWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621682057776"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682057777"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057777"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057778"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057778"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057774"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621682057779"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057773"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057777"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt
-&gt; LHsToken &quot;@&quot; (GhcPass 'Renamed)
-&gt; LHsWcType (GhcPass 'Renamed)
-&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkETypeArg"><span class="hs-identifier hs-var">mkETypeArg</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057777"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><a href="#local-6989586621682057775"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc (GhcPass 'Renamed))
LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682057776"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; [HsExprArg 'TcpRn] -&gt; [HsExprArg 'TcpRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057778"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-type">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682057780"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057780"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682057781"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057781"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682057782"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057782"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>       </span><span id="local-6989586621682057783"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057783"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057784"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057784"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057781"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621682057779"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057780"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057783"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; LHsExpr (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-var">mkEValArg</span></a></span><span>  </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057783"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057782"><span class="hs-identifier hs-var">arg</span></a></span><span>   </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; [HsExprArg 'TcpRn] -&gt; [HsExprArg 'TcpRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057784"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-comment">-- See Note [Looking through HsExpanded]</span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpanded"><span class="hs-identifier hs-type">HsExpanded</span></a></span><span> </span><span id="local-6989586621682057785"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057785"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span id="local-6989586621682057786"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057786"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682057787"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057787"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057788"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057788"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-311"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057786"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-var">VAExpansion</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057785"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var">appCtxtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057787"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EWrap -&gt; HsExprArg 'TcpRn
forall (p :: TcPass). EWrap -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; EWrap
</span><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-var">EExpand</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057785"><span class="hs-identifier hs-var">orig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; [HsExprArg 'TcpRn] -&gt; [HsExprArg 'TcpRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057788"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-comment">-- See Note [Desugar OpApp in the typechecker]</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682057789"><span class="annot"><span class="annottext">e :: HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057789"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#OpApp"><span class="hs-identifier hs-type">OpApp</span></a></span><span> </span><span class="annot"><span class="annottext">XOpApp (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057791"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057791"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682057792"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057792"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682057793"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057793"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682057794"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057794"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057795"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057795"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057793"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057793"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057792"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">AppCtxt -&gt; LHsExpr (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-var">mkEValArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057793"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#generatedSrcSpan"><span class="hs-identifier hs-var">generatedSrcSpan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057791"><span class="hs-identifier hs-var">arg1</span></a></span><span>
</span><span id="line-318"></span><span>          </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; [HsExprArg 'TcpRn] -&gt; [HsExprArg 'TcpRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">AppCtxt -&gt; LHsExpr (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-var">mkEValArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057793"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#generatedSrcSpan"><span class="hs-identifier hs-var">generatedSrcSpan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057794"><span class="hs-identifier hs-var">arg2</span></a></span><span>
</span><span id="line-319"></span><span>          </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; [HsExprArg 'TcpRn] -&gt; [HsExprArg 'TcpRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">EWrap -&gt; HsExprArg 'TcpRn
forall (p :: TcPass). EWrap -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; EWrap
</span><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-var">EExpand</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057789"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>          </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; [HsExprArg 'TcpRn] -&gt; [HsExprArg 'TcpRn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057795"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="#local-6989586621682057737"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682057798"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057798"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682057799"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057799"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057800"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057800"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057798"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057799"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682057800"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><a href="#local-6989586621682057767"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#SrcSpanAnnA"><span class="hs-identifier hs-type">SrcSpanAnnA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621682057767"><span class="annot"><span class="annottext">set :: SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621682057767"><span class="hs-identifier hs-var hs-var">set</span></a></span></span><span> </span><span id="local-6989586621682057801"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057801"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span id="local-6989586621682057802"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057802"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682057803"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057803"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057802"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057803"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057801"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="#local-6989586621682057767"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057804"><span class="annot"><span class="annottext">ctxt :: AppCtxt
</span><a href="#local-6989586621682057804"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057804"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="#local-6989586621682057779"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#SrcSpanAnnA"><span class="hs-identifier hs-type">SrcSpanAnnA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621682057779"><span class="annot"><span class="annottext">dec :: SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621682057779"><span class="hs-identifier hs-var hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621682057805"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057805"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span id="local-6989586621682057806"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057806"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682057807"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057807"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057806"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057807"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621682057805"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="#local-6989586621682057779"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057808"><span class="annot"><span class="annottext">ctxt :: AppCtxt
</span><a href="#local-6989586621682057808"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057808"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-- | Rebuild an application: takes a type-checked application head</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- expression together with arguments in the form of typechecked 'HsExprArg's</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- and returns a typechecked application of the head to the arguments.</span><span>
</span><span id="line-335"></span><span class="hs-comment">--</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- This performs a representation-polymorphism check to ensure that the</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- remaining value arguments in an application have a fixed RuntimeRep.</span><span>
</span><span id="line-338"></span><span class="hs-comment">--</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- See Note [Checking for representation-polymorphic built-ins].</span><span>
</span><span id="line-340"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-type">rebuildHsApps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-341"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ the function being applied</span></span><span>
</span><span id="line-342"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-343"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpTc"><span class="hs-identifier hs-type">TcpTc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-344"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ the arguments to the function</span></span><span>
</span><span id="line-345"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span>
</span><span id="line-346"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ result type of the application</span></span><span>
</span><span id="line-347"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span id="rebuildHsApps"><span class="annot"><span class="annottext">rebuildHsApps :: HsExpr GhcTc
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpTc]
-&gt; TcSigmaType
-&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var hs-var">rebuildHsApps</span></a></span></span><span> </span><span id="local-6989586621682057809"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057809"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682057810"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057810"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682057811"><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057811"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682057812"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682057812"><span class="hs-identifier hs-var">app_res_rho</span></a></span></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc] -&gt; TcSigmaType -&gt; HsExpr GhcTc -&gt; TcM ()
(() :: Constraint) =&gt;
[HsExprArg 'TcpTc] -&gt; TcSigmaType -&gt; HsExpr GhcTc -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#tcRemainingValArgs"><span class="hs-identifier hs-var">tcRemainingValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057811"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682057812"><span class="hs-identifier hs-var">app_res_rho</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057809"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-350"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; TcM (HsExpr GhcTc)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc -&gt; TcM (HsExpr GhcTc))
-&gt; HsExpr GhcTc -&gt; TcM (HsExpr GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var">rebuild_hs_apps</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057809"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057810"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057811"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- | The worker function for 'rebuildHsApps': simply rebuilds</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- an application chain in which arguments are specified as</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- typechecked 'HsExprArg's.</span><span>
</span><span id="line-355"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-type">rebuild_hs_apps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-356"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ the function being applied</span></span><span>
</span><span id="line-357"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-358"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpTc"><span class="hs-identifier hs-type">TcpTc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-359"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ the arguments to the function</span></span><span>
</span><span id="line-360"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-361"></span><span id="rebuild_hs_apps"><span class="annot"><span class="annottext">rebuild_hs_apps :: HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var hs-var">rebuild_hs_apps</span></a></span></span><span> </span><span id="local-6989586621682057815"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057815"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057815"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-362"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var">rebuild_hs_apps</span></a></span><span> </span><span id="local-6989586621682057816"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057816"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682057817"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057817"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682057818"><span class="annot"><span class="annottext">HsExprArg 'TcpTc
</span><a href="#local-6989586621682057818"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057819"><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057819"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpTc
</span><a href="#local-6989586621682057818"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-type">ValArg</span></a></span><span> </span><span id="local-6989586621682057820"><span class="annot"><span class="annottext">LHsExpr (GhcPass (XPass 'TcpTc))
</span><a href="#local-6989586621682057820"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ctxt :: forall (p :: TcPass). HsExprArg p -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682057821"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057821"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var">rebuild_hs_apps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XApp GhcTc -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc -&gt; HsExpr GhcTc
forall p. XApp p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp GhcTc
EpAnn NoEpAnns
forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682057823"><span class="hs-identifier hs-var">lfun</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
LHsExpr (GhcPass (XPass 'TcpTc))
</span><a href="#local-6989586621682057820"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057821"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057819"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_hs_ty :: forall (p :: TcPass). HsExprArg p -&gt; LHsWcType (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_hs_ty"><span class="hs-identifier hs-var">eva_hs_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682057824"><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682057824"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_at :: forall (p :: TcPass).
HsExprArg p -&gt; LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_at"><span class="hs-identifier hs-var">eva_at</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682057825"><span class="annot"><span class="annottext">LHsToken &quot;@&quot; (GhcPass 'Renamed)
</span><a href="#local-6989586621682057825"><span class="hs-identifier hs-var">at</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ty :: forall (p :: TcPass). HsExprArg p -&gt; XETAType p
</span><a href="GHC.Tc.Gen.Head.html#eva_ty"><span class="hs-identifier hs-var">eva_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682057826"><span class="annot"><span class="annottext">XETAType 'TcpTc
</span><a href="#local-6989586621682057826"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ctxt :: forall (p :: TcPass). HsExprArg p -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682057827"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057827"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-367"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var">rebuild_hs_apps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XAppTypeE GhcTc
-&gt; LHsExpr GhcTc
-&gt; LHsToken &quot;@&quot; GhcTc
-&gt; LHsWcType (NoGhcTc GhcTc)
-&gt; HsExpr GhcTc
forall p.
XAppTypeE p
-&gt; LHsExpr p -&gt; LHsToken &quot;@&quot; p -&gt; LHsWcType (NoGhcTc p) -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-var">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE GhcTc
XETAType 'TcpTc
</span><a href="#local-6989586621682057826"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682057823"><span class="hs-identifier hs-var">lfun</span></a></span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;@&quot; (GhcPass 'Renamed)
LHsToken &quot;@&quot; GhcTc
</span><a href="#local-6989586621682057825"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc GhcTc)
LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682057824"><span class="hs-identifier hs-var">hs_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057827"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057819"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-type">EPrag</span></a></span><span> </span><span id="local-6989586621682057828"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057828"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span> </span><span id="local-6989586621682057829"><span class="annot"><span class="annottext">HsPragE (GhcPass (XPass 'TcpTc))
</span><a href="#local-6989586621682057829"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var">rebuild_hs_apps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPragE GhcTc -&gt; HsPragE GhcTc -&gt; LHsExpr GhcTc -&gt; HsExpr GhcTc
forall p. XPragE p -&gt; HsPragE p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-var">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE GhcTc
HsPragE (GhcPass (XPass 'TcpTc))
</span><a href="#local-6989586621682057829"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682057823"><span class="hs-identifier hs-var">lfun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057828"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057819"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-type">EPar</span></a></span><span> </span><span id="local-6989586621682057830"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057830"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var">rebuild_hs_apps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; HsExpr GhcTc
forall (id :: Pass). LHsExpr (GhcPass id) -&gt; HsExpr (GhcPass id)
</span><a href="GHC.Hs.Expr.html#gHsPar"><span class="hs-identifier hs-var">gHsPar</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682057823"><span class="hs-identifier hs-var">lfun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057830"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057819"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-372"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-type">EExpand</span></a></span><span> </span><span id="local-6989586621682057832"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057832"><span class="hs-identifier hs-var">orig</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var">rebuild_hs_apps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XXExpr GhcTc -&gt; HsExpr GhcTc
forall p. XXExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-var">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpansion (HsExpr (GhcPass 'Renamed)) (HsExpr GhcTc)
-&gt; XXExprGhcTc
</span><a href="GHC.Hs.Expr.html#ExpansionExpr"><span class="hs-identifier hs-var">ExpansionExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; HsExpr GhcTc
-&gt; HsExpansion (HsExpr (GhcPass 'Renamed)) (HsExpr GhcTc)
forall orig expanded. orig -&gt; expanded -&gt; HsExpansion orig expanded
</span><a href="GHC.Hs.Expr.html#HsExpanded"><span class="hs-identifier hs-var">HsExpanded</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682057832"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057816"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057817"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057819"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-374"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-type">EHsWrap</span></a></span><span> </span><span id="local-6989586621682057834"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057834"><span class="hs-identifier hs-var">wrap</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuild_hs_apps"><span class="hs-identifier hs-var">rebuild_hs_apps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057834"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057816"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057817"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057819"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>    </span><span id="local-6989586621682057823"><span class="annot"><span class="annottext">lfun :: GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682057823"><span class="hs-identifier hs-var hs-var">lfun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
-&gt; HsExpr GhcTc -&gt; GenLocated SrcSpanAnnA (HsExpr GhcTc)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcSpanAnnA
forall ann. SrcSpan -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#noAnnSrcSpan"><span class="hs-identifier hs-var">noAnnSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">(SrcSpan -&gt; SrcSpanAnnA) -&gt; SrcSpan -&gt; SrcSpanAnnA
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var">appCtxtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682057817"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057816"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">{- Note [Checking for representation-polymorphic built-ins]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We cannot have representation-polymorphic or levity-polymorphic
function arguments. See Note [Representation polymorphism invariants]
in GHC.Core.  That is checked by the calls to `hasFixedRuntimeRep` in
`tcEValArg`.

But some /built-in/ functions have representation-polymorphic argument
types. Users can't define such Ids; they are all GHC built-ins or data
constructors.  Specifically they are:

1. A few wired-in Ids such as coerce and unsafeCoerce#,
2. Primops, such as raise#.
3. Newtype constructors with `UnliftedNewtypes` which have
   a representation-polymorphic argument.
4. Representation-polymorphic data constructors: unboxed tuples
   and unboxed sums.

For (1) consider
  badId :: forall r (a :: TYPE r). a -&gt; a
  badId = unsafeCoerce# @r @r @a @a

The wired-in function
  unsafeCoerce# :: forall (r1 :: RuntimeRep) (r2 :: RuntimeRep)
                   (a :: TYPE r1) (b :: TYPE r2).
                   a -&gt; b
has a convenient but representation-polymorphic type. It has no
binding; instead it has a compulsory unfolding, after which we
would have
  badId = /\r /\(a :: TYPE r). \(x::a). ...body of unsafeCorece#...
And this is no good because of that rep-poly \(x::a).  So we want
to reject this.

On the other hand
  goodId :: forall (a :: Type). a -&gt; a
  goodId = unsafeCoerce# @LiftedRep @LiftedRep @a @a

is absolutely fine, because after we inline the unfolding, the \(x::a)
is representation-monomorphic.

Test cases: T14561, RepPolyWrappedVar2.

For primops (2) the situation is similar; they are eta-expanded in
CorePrep to be saturated, and that eta-expansion must not add a
representation-polymorphic lambda.

Test cases: T14561b, RepPolyWrappedVar, UnliftedNewtypesCoerceFail.

For (3), consider a representation-polymorphic newtype with
UnliftedNewtypes:

  type Id :: forall r. TYPE r -&gt; TYPE r
  newtype Id a where { MkId :: a }

  bad :: forall r (a :: TYPE r). a -&gt; Id a
  bad = MkId @r @a             -- Want to reject

  good :: forall (a :: Type). a -&gt; Id a
  good = MkId @LiftedRep @a   -- Want to accept

Test cases: T18481, UnliftedNewtypesLevityBinder

So these cases need special treatment. We add a special case
in tcApp to check whether an application of an Id has any remaining
representation-polymorphic arguments, after instantiation and application
of previous arguments.  This is achieved by the tcRemainingValArgs
function, which computes the types of the remaining value arguments, and checks
that each of these have a fixed runtime representation.

Note that this function also ensures that data constructors always
appear saturated, by performing eta-expansion if necessary.
See Note [Typechecking data constructors].

Wrinkle [Arity]

  We don't want to check for arguments past the arity of the function.

  For example

      raise# :: forall {r :: RuntimeRep} (a :: Type) (b :: TYPE r). a -&gt; b

  has arity 1, so an instantiation such as:

      foo :: forall w r (z :: TYPE r). w -&gt; z -&gt; z
      foo = raise# @w @(z -&gt; z)

  is unproblematic.  This means we must take care not to perform a
  representation-polymorphism check on `z`.

  To achieve this, we consult the arity of the 'Id' which is the head
  of the application (or just use 1 for a newtype constructor),
  and keep track of how many value-level arguments we have seen,
  to ensure we stop checking once we reach the arity.
  This is slightly complicated by the need to include both visible
  and invisible arguments, as the arity counts both:
  see GHC.Tc.Gen.Head.countVisAndInvisValArgs.

  Test cases: T20330{a,b}

Wrinkle [Syntactic check]

  We only perform a syntactic check in tcRemainingValArgs. That is,
  we will reject partial applications such as:

    type RR :: RuntimeREp
    type family RR where { RR = IntRep }
    type T :: TYPE RR
    type family T where { T = Int# }

    (# , #) @LiftedRep @RR e1

  Why do we reject? Wee would need to elaborate this partial application
  of (# , #) as follows:

    let x1 = e1
    in
      ( \ @(ty2 :: TYPE RR) (x2 :: ty2 |&gt; TYPE RR[0])
      -&gt; ( ( (# , #) @LiftedRep @RR @Char @ty2 x1 ) |&gt; co1 )
           x2
      ) |&gt; co2

  That is, we need to cast the partial application

    (# , #) @LiftedRep @RR @Char @ty2 x1

  so that the next argument we provide to it has a fixed RuntimeRep,
  and then eta-expand it. This is quite tricky, and other parts
  of the compiler aren't set up to handle this mix of applications
  and casts (e.g. checkCanEtaExpand in GHC.Core.Lint).

  So we refrain from doing so, and instead limit ourselves to a simple syntactic
  check. See the wiki page https://gitlab.haskell.org/ghc/ghc/-/wikis/Remaining-ValArgs
  for a more in-depth discussion.
-}</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-comment">-- | Typecheck the remaining value arguments in a partial application,</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- ensuring they have a fixed RuntimeRep in the sense of Note [Fixed RuntimeRep]</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-517"></span><span class="hs-comment">--</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-519"></span><span class="hs-comment">--</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- &gt; repPolyId :: forall r (a :: TYPE r). a -&gt; a</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- &gt; repPolyId = coerce</span><span>
</span><span id="line-522"></span><span class="hs-comment">--</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- This is an invalid instantiation of 'coerce', as we can't eta expand it</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- to</span><span>
</span><span id="line-525"></span><span class="hs-comment">--</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- &gt; \@r \@(a :: TYPE r) (x :: a) -&gt; coerce @r @a @a x</span><span>
</span><span id="line-527"></span><span class="hs-comment">--</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- because the binder `x` does not have a fixed runtime representation.</span><span>
</span><span id="line-529"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcRemainingValArgs"><span class="hs-identifier hs-type">tcRemainingValArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span>
</span><span id="line-530"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpTc"><span class="hs-identifier hs-type">TcpTc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-531"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span>
</span><span id="line-532"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-533"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span id="tcRemainingValArgs"><span class="annot"><span class="annottext">tcRemainingValArgs :: (() :: Constraint) =&gt;
[HsExprArg 'TcpTc] -&gt; TcSigmaType -&gt; HsExpr GhcTc -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#tcRemainingValArgs"><span class="hs-identifier hs-var hs-var">tcRemainingValArgs</span></a></span></span><span> </span><span id="local-6989586621682057876"><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057876"><span class="hs-identifier hs-var">applied_args</span></a></span></span><span> </span><span id="local-6989586621682057877"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682057877"><span class="hs-identifier hs-var">app_res_rho</span></a></span></span><span> </span><span id="local-6989586621682057878"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057878"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057878"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057880"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682057880"><span class="hs-identifier hs-var">fun_id</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-comment">-- (1): unsafeCoerce#</span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-comment">-- 'unsafeCoerce#' is peculiar: it is patched in manually as per</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-comment">-- Note [Wiring in unsafeCoerce#] in GHC.HsToCore.</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-comment">-- Unfortunately, even though its arity is set to 1 in GHC.HsToCore.mkUnsafeCoercePrimPair,</span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-comment">-- at this stage, if we query idArity, we get 0. This is because</span><span>
</span><span id="line-543"></span><span>    </span><span class="hs-comment">-- we end up looking at the non-patched version of unsafeCoerce#</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-comment">-- defined in Unsafe.Coerce, and that one indeed has arity 0.</span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-comment">-- We thus manually specify the correct arity of 1 here.</span><span>
</span><span id="line-547"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682057880"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unsafeCoercePrimName"><span class="hs-identifier hs-var">unsafeCoercePrimName</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; RepPolyFun -&gt; TcM ()
</span><a href="#local-6989586621682057883"><span class="hs-identifier hs-var">tc_remaining_args</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; RepPolyFun
</span><a href="GHC.Tc.Types.Origin.html#RepPolyWiredIn"><span class="hs-identifier hs-var">RepPolyWiredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682057880"><span class="hs-identifier hs-var">fun_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-comment">-- (2): primops and other wired-in representation-polymorphic functions,</span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-comment">-- such as 'rightSection', 'oneShot', etc; see bindings with Compulsory unfoldings</span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-comment">-- in GHC.Types.Id.Make</span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isWiredInName"><span class="hs-identifier hs-var">isWiredInName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682057880"><span class="hs-identifier hs-var">fun_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Id.html#hasNoBinding"><span class="hs-identifier hs-var">hasNoBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682057880"><span class="hs-identifier hs-var">fun_id</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; RepPolyFun -&gt; TcM ()
</span><a href="#local-6989586621682057883"><span class="hs-identifier hs-var">tc_remaining_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; ThLevel
</span><a href="GHC.Types.Id.html#idArity"><span class="hs-identifier hs-var">idArity</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682057880"><span class="hs-identifier hs-var">fun_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; RepPolyFun
</span><a href="GHC.Tc.Types.Origin.html#RepPolyWiredIn"><span class="hs-identifier hs-var">RepPolyWiredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682057880"><span class="hs-identifier hs-var">fun_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>       </span><span class="hs-comment">-- NB: idArity consults the IdInfo of the Id. This can be a problem</span><span>
</span><span id="line-556"></span><span>       </span><span class="hs-comment">-- in the presence of hs-boot files, as we might not have finished</span><span>
</span><span id="line-557"></span><span>       </span><span class="hs-comment">-- typechecking; inspecting the IdInfo at this point can cause</span><span>
</span><span id="line-558"></span><span>       </span><span class="hs-comment">-- strange Core Lint errors (see #20447).</span><span>
</span><span id="line-559"></span><span>       </span><span class="hs-comment">-- We avoid this entirely by only checking wired-in names,</span><span>
</span><span id="line-560"></span><span>       </span><span class="hs-comment">-- as those are the only ones this check is applicable to anyway.</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ConLikeTc"><span class="hs-identifier hs-type">ConLikeTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span id="local-6989586621682057891"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057891"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-comment">-- (3): Representation-polymorphic newtype constructors.</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isNewDataCon"><span class="hs-identifier hs-var">isNewDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057891"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-comment">-- (4): Unboxed tuples and unboxed sums</span><span>
</span><span id="line-566"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedTupleDataCon"><span class="hs-identifier hs-var">isUnboxedTupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057891"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedSumDataCon"><span class="hs-identifier hs-var">isUnboxedSumDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057891"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; RepPolyFun -&gt; TcM ()
</span><a href="#local-6989586621682057883"><span class="hs-identifier hs-var">tc_remaining_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; ThLevel
</span><a href="#local-6989586621682057896"><span class="hs-identifier hs-var">dc_val_arity</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057891"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; RepPolyFun
</span><a href="GHC.Tc.Types.Origin.html#RepPolyDataCon"><span class="hs-identifier hs-var">RepPolyDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057891"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><a href="#local-6989586621682057896"><span class="hs-identifier hs-type">dc_val_arity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621682057896"><span class="annot"><span class="annottext">dc_val_arity :: DataCon -&gt; ThLevel
</span><a href="#local-6989586621682057896"><span class="hs-identifier hs-var hs-var">dc_val_arity</span></a></span></span><span> </span><span id="local-6989586621682057899"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057899"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcSigmaType -&gt; Bool) -&gt; [TcSigmaType] -&gt; ThLevel
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ThLevel
</span><a href="GHC.Utils.Misc.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (TcSigmaType -&gt; Bool) -&gt; TcSigmaType -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="GHC.Core.Predicate.html#isEqPrimPred"><span class="hs-identifier hs-var">isEqPrimPred</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [TcSigmaType]
</span><a href="GHC.Core.DataCon.html#dataConTheta"><span class="hs-identifier hs-var">dataConTheta</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057899"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>                     </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType] -&gt; ThLevel
forall a. [a] -&gt; ThLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ThLevel
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [TcSigmaType]
</span><a href="GHC.Core.DataCon.html#dataConStupidTheta"><span class="hs-identifier hs-var">dataConStupidTheta</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057899"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>                     </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; ThLevel
</span><a href="GHC.Core.DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682057899"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-comment">-- Count how many value-level arguments this data constructor expects:</span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-comment">--    - dictionary arguments from the context (including the stupid context),</span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-comment">--    - source value arguments.</span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-comment">-- Tests: EtaExpandDataCon, EtaExpandStupid{1,2}.</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><a href="#local-6989586621682057908"><span class="hs-identifier hs-type">nb_applied_vis_val_args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-584"></span><span>    </span><span id="local-6989586621682057908"><span class="annot"><span class="annottext">nb_applied_vis_val_args :: ThLevel
</span><a href="#local-6989586621682057908"><span class="hs-identifier hs-var hs-var">nb_applied_vis_val_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsExprArg 'TcpTc -&gt; Bool) -&gt; [HsExprArg 'TcpTc] -&gt; ThLevel
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ThLevel
</span><a href="GHC.Utils.Misc.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpTc -&gt; Bool
forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier hs-var">isHsValArg</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057876"><span class="hs-identifier hs-var">applied_args</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><a href="#local-6989586621682057909"><span class="hs-identifier hs-type">nb_applied_val_args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-587"></span><span>    </span><span id="local-6989586621682057909"><span class="annot"><span class="annottext">nb_applied_val_args :: ThLevel
</span><a href="#local-6989586621682057909"><span class="hs-identifier hs-var hs-var">nb_applied_val_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057876"><span class="hs-identifier hs-var">applied_args</span></a></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><a href="#local-6989586621682057883"><span class="hs-identifier hs-type">tc_remaining_args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#RepPolyFun"><span class="hs-identifier hs-type">RepPolyFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621682057883"><span class="annot"><span class="annottext">tc_remaining_args :: ThLevel -&gt; RepPolyFun -&gt; TcM ()
</span><a href="#local-6989586621682057883"><span class="hs-identifier hs-var hs-var">tc_remaining_args</span></a></span></span><span> </span><span id="local-6989586621682057910"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057910"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621682057911"><span class="annot"><span class="annottext">RepPolyFun
</span><a href="#local-6989586621682057911"><span class="hs-identifier hs-var">rep_poly_fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-591"></span><span>      </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; [(Scaled TcSigmaType, FunTyFlag)] -&gt; TcM ()
</span><a href="#local-6989586621682057912"><span class="hs-identifier hs-var">tc_rem_args</span></a></span><span>
</span><span id="line-592"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057908"><span class="hs-identifier hs-var">nb_applied_vis_val_args</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057909"><span class="hs-identifier hs-var">nb_applied_val_args</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>        </span><span class="annot"><span class="annottext">[(Scaled TcSigmaType, FunTyFlag)]
</span><a href="#local-6989586621682057913"><span class="hs-identifier hs-var">rem_arg_tys</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><a href="#local-6989586621682057913"><span class="hs-identifier hs-type">rem_arg_tys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier hs-type">FunTyFlag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-599"></span><span>      </span><span id="local-6989586621682057913"><span class="annot"><span class="annottext">rem_arg_tys :: [(Scaled TcSigmaType, FunTyFlag)]
</span><a href="#local-6989586621682057913"><span class="hs-identifier hs-var hs-var">rem_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; [(Scaled TcSigmaType, FunTyFlag)]
</span><a href="GHC.Core.Type.html#getRuntimeArgTys"><span class="hs-identifier hs-var">getRuntimeArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682057877"><span class="hs-identifier hs-var">app_res_rho</span></a></span><span>
</span><span id="line-600"></span><span>        </span><span class="hs-comment">-- We do not need to zonk app_res_rho first, because the number of arrows</span><span>
</span><span id="line-601"></span><span>        </span><span class="hs-comment">-- in the (possibly instantiated) inferred type of the function will</span><span>
</span><span id="line-602"></span><span>        </span><span class="hs-comment">-- be at least the arity of the function.</span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span>      </span><span class="hs-comment">-- The following function is essentially &quot;mapM hasFixedRuntimeRep rem_arg_tys&quot;,</span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-comment">-- but we need to keep track of indices for error messages, hence the manual recursion.</span><span>
</span><span id="line-606"></span><span>      </span><span class="annot"><a href="#local-6989586621682057912"><span class="hs-identifier hs-type">tc_rem_args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-607"></span><span>                     </span><span class="hs-comment">-- visible value argument index, starting from 1</span><span>
</span><span id="line-608"></span><span>                     </span><span class="hs-comment">-- (only used to report the argument position in error messages)</span><span>
</span><span id="line-609"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-610"></span><span>                     </span><span class="hs-comment">-- value argument index, starting from 1</span><span>
</span><span id="line-611"></span><span>                     </span><span class="hs-comment">-- used to count up to the arity to ensure that</span><span>
</span><span id="line-612"></span><span>                     </span><span class="hs-comment">-- we don't check too many argument types</span><span>
</span><span id="line-613"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier hs-type">FunTyFlag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-614"></span><span>                     </span><span class="hs-comment">-- run-time argument types</span><span>
</span><span id="line-615"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>      </span><span id="local-6989586621682057912"><span class="annot"><span class="annottext">tc_rem_args :: ThLevel -&gt; ThLevel -&gt; [(Scaled TcSigmaType, FunTyFlag)] -&gt; TcM ()
</span><a href="#local-6989586621682057912"><span class="hs-identifier hs-var hs-var">tc_rem_args</span></a></span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057915"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057915"><span class="hs-identifier hs-var">i_val</span></a></span></span><span> </span><span class="annot"><span class="annottext">[(Scaled TcSigmaType, FunTyFlag)]
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-617"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057915"><span class="hs-identifier hs-var">i_val</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057910"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-618"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>      </span><span class="annot"><a href="#local-6989586621682057912"><span class="hs-identifier hs-var">tc_rem_args</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>        </span><span class="hs-comment">-- Should never happen: it would mean that the arity is higher</span><span>
</span><span id="line-621"></span><span>        </span><span class="hs-comment">-- than the number of arguments apparent from the type.</span><span>
</span><span id="line-622"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcRemainingValArgs&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682057918"><span class="hs-identifier hs-var">debug_msg</span></a></span><span>
</span><span id="line-623"></span><span>      </span><span class="annot"><a href="#local-6989586621682057912"><span class="hs-identifier hs-var">tc_rem_args</span></a></span><span> </span><span id="local-6989586621682057919"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057919"><span class="hs-identifier hs-var">i_visval</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682057920"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057920"><span class="hs-identifier hs-var">i_val</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682057922"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682057922"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682057923"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682057923"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057924"><span class="annot"><span class="annottext">[(Scaled TcSigmaType, FunTyFlag)]
</span><a href="#local-6989586621682057924"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682057925"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057925"><span class="hs-identifier hs-var">i_visval'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682057926"><span class="annot"><span class="annottext">ArgPos
</span><a href="#local-6989586621682057926"><span class="hs-identifier hs-var">arg_pos</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleFunArg"><span class="hs-identifier hs-var">isInvisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682057923"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057919"><span class="hs-identifier hs-var">i_visval</span></a></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArgPos
</span><a href="GHC.Tc.Types.Origin.html#ArgPosInvis"><span class="hs-identifier hs-var">ArgPosInvis</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057919"><span class="hs-identifier hs-var">i_visval</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ArgPos
</span><a href="GHC.Tc.Types.Origin.html#ArgPosVis"><span class="hs-identifier hs-var">ArgPosVis</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057919"><span class="hs-identifier hs-var">i_visval</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>                   </span><span id="local-6989586621682057929"><span class="annot"><span class="annottext">frr_ctxt :: FixedRuntimeRepContext
</span><a href="#local-6989586621682057929"><span class="hs-identifier hs-var hs-var">frr_ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RepPolyFun -&gt; ArgPos -&gt; FixedRuntimeRepContext
</span><a href="GHC.Tc.Types.Origin.html#FRRNoBindingResArg"><span class="hs-identifier hs-var">FRRNoBindingResArg</span></a></span><span> </span><span class="annot"><span class="annottext">RepPolyFun
</span><a href="#local-6989586621682057911"><span class="hs-identifier hs-var">rep_poly_fun</span></a></span><span> </span><span class="annot"><span class="annottext">ArgPos
</span><a href="#local-6989586621682057926"><span class="hs-identifier hs-var">arg_pos</span></a></span><span>
</span><span id="line-628"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt;
FixedRuntimeRepContext -&gt; TcSigmaType -&gt; TcM ()
FixedRuntimeRepContext -&gt; TcSigmaType -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Concrete.html#hasFixedRuntimeRep_syntactic"><span class="hs-identifier hs-var">hasFixedRuntimeRep_syntactic</span></a></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepContext
</span><a href="#local-6989586621682057929"><span class="hs-identifier hs-var">frr_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682057922"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-629"></span><span>                 </span><span class="hs-comment">-- Why is this a syntactic check? See Wrinkle [Syntactic check] in</span><span>
</span><span id="line-630"></span><span>                 </span><span class="hs-comment">-- Note [Checking for representation-polymorphic built-ins].</span><span>
</span><span id="line-631"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; [(Scaled TcSigmaType, FunTyFlag)] -&gt; TcM ()
</span><a href="#local-6989586621682057912"><span class="hs-identifier hs-var">tc_rem_args</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057925"><span class="hs-identifier hs-var">i_visval'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057920"><span class="hs-identifier hs-var">i_val</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Scaled TcSigmaType, FunTyFlag)]
</span><a href="#local-6989586621682057924"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>      </span><span class="annot"><a href="#local-6989586621682057918"><span class="hs-identifier hs-type">debug_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-634"></span><span>      </span><span id="local-6989586621682057918"><span class="annot"><span class="annottext">debug_msg :: SDoc
</span><a href="#local-6989586621682057918"><span class="hs-identifier hs-var hs-var">debug_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-635"></span><span>        </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-636"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;app_head =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682057878"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-637"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arity =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057910"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-638"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;applied_args =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621682057876"><span class="hs-identifier hs-var">applied_args</span></a></span><span>
</span><span id="line-639"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nb_applied_val_args =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682057909"><span class="hs-identifier hs-var">nb_applied_val_args</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span id="local-6989586621682057211"><span class="annot"><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier hs-type">isHsValArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057211"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-643"></span><span id="isHsValArg"><span class="annot"><span class="annottext">isHsValArg :: forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier hs-var hs-var">isHsValArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-644"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier hs-var">isHsValArg</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg id
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span id="local-6989586621682057932"><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-type">countLeadingValArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057932"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-647"></span><span id="countLeadingValArgs"><span class="annot"><span class="annottext">countLeadingValArgs :: forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var hs-var">countLeadingValArgs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-648"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057935"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057935"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057935"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-649"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057936"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057936"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057936"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-650"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-type">EPrag</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057937"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057937"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057937"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-651"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span id="local-6989586621682057938"><span class="annot"><a href="GHC.Tc.Gen.Head.html#isValArg"><span class="hs-identifier hs-type">isValArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057938"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-654"></span><span id="isValArg"><span class="annot"><span class="annottext">isValArg :: forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isValArg"><span class="hs-identifier hs-var hs-var">isValArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-655"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isValArg"><span class="hs-identifier hs-var">isValArg</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg id
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span id="local-6989586621682057940"><span class="annot"><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-type">isVisibleArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057940"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-658"></span><span id="isVisibleArg"><span class="annot"><span class="annottext">isVisibleArg :: forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-var hs-var">isVisibleArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-659"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-var">isVisibleArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-660"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-var">isVisibleArg</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg id
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span class="hs-comment">-- | Count visible and invisible value arguments in a list</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- of 'HsExprArg' arguments.</span><span>
</span><span id="line-664"></span><span id="local-6989586621682057212"><span class="annot"><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-type">countVisAndInvisValArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057212"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span></span><span>
</span><span id="line-665"></span><span id="countVisAndInvisValArgs"><span class="annot"><span class="annottext">countVisAndInvisValArgs :: forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var hs-var">countVisAndInvisValArgs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-666"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057944"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057944"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057944"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-667"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span id="local-6989586621682057945"><span class="annot"><span class="annottext">EWrap
</span><a href="#local-6989586621682057945"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057946"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057946"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EWrap
</span><a href="#local-6989586621682057945"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-type">EHsWrap</span></a></span><span> </span><span id="local-6989586621682057947"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057947"><span class="hs-identifier hs-var">hsWrap</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countHsWrapperInvisArgs"><span class="hs-identifier hs-var">countHsWrapperInvisArgs</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057947"><span class="hs-identifier hs-var">hsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057946"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-669"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-type">EPar</span></a></span><span>   </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057946"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-670"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-type">EExpand</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057946"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-671"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-type">EPrag</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057948"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057948"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057948"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-672"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682057949"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057949"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsExprArg id] -&gt; ThLevel
forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countVisAndInvisValArgs"><span class="hs-identifier hs-var">countVisAndInvisValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621682057949"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="hs-comment">-- | Counts the number of invisible term-level arguments applied by an 'HsWrapper'.</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- Precondition: this wrapper contains no abstractions.</span><span>
</span><span id="line-676"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countHsWrapperInvisArgs"><span class="hs-identifier hs-type">countHsWrapperInvisArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span>
</span><span id="line-677"></span><span id="countHsWrapperInvisArgs"><span class="annot"><span class="annottext">countHsWrapperInvisArgs :: HsWrapper -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countHsWrapperInvisArgs"><span class="hs-identifier hs-var hs-var">countHsWrapperInvisArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; ThLevel
forall {a}. Num a =&gt; HsWrapper -&gt; a
</span><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-678"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621682057950"><span class="annot"><span class="annottext">go :: HsWrapper -&gt; a
</span><a href="#local-6989586621682057950"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-680"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpCompose"><span class="hs-identifier hs-type">WpCompose</span></a></span><span> </span><span id="local-6989586621682057965"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057965"><span class="hs-identifier hs-var">wrap1</span></a></span></span><span> </span><span id="local-6989586621682057966"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057966"><span class="hs-identifier hs-var">wrap2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; a
</span><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057965"><span class="hs-identifier hs-var">wrap1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; a
</span><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057966"><span class="hs-identifier hs-var">wrap2</span></a></span><span>
</span><span id="line-681"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682057967"><span class="annot"><span class="annottext">fun :: HsWrapper
</span><a href="#local-6989586621682057967"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpFun"><span class="hs-identifier hs-type">WpFun</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; a
forall {a} {a}. Outputable a =&gt; a -&gt; a
</span><a href="#local-6989586621682057969"><span class="hs-identifier hs-var">nope</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057967"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpCast"><span class="hs-identifier hs-type">WpCast</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682057971"><span class="annot"><span class="annottext">evLam :: HsWrapper
</span><a href="#local-6989586621682057971"><span class="hs-identifier hs-var">evLam</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpEvLam"><span class="hs-identifier hs-type">WpEvLam</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; a
forall {a} {a}. Outputable a =&gt; a -&gt; a
</span><a href="#local-6989586621682057969"><span class="hs-identifier hs-var">nope</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057971"><span class="hs-identifier hs-var">evLam</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpEvApp"><span class="hs-identifier hs-type">WpEvApp</span></a></span><span> </span><span class="annot"><span class="annottext">EvTerm
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-685"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682057974"><span class="annot"><span class="annottext">tyLam :: HsWrapper
</span><a href="#local-6989586621682057974"><span class="hs-identifier hs-var">tyLam</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpTyLam"><span class="hs-identifier hs-type">WpTyLam</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; a
forall {a} {a}. Outputable a =&gt; a -&gt; a
</span><a href="#local-6989586621682057969"><span class="hs-identifier hs-var">nope</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682057974"><span class="hs-identifier hs-var">tyLam</span></a></span><span>
</span><span id="line-686"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpTyApp"><span class="hs-identifier hs-type">WpTyApp</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-687"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpLet"><span class="hs-identifier hs-type">WpLet</span></a></span><span> </span><span class="annot"><span class="annottext">TcEvBinds
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-688"></span><span>    </span><span class="annot"><a href="#local-6989586621682057950"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#WpMultCoercion"><span class="hs-identifier hs-type">WpMultCoercion</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621682057969"><span class="annot"><span class="annottext">nope :: a -&gt; a
</span><a href="#local-6989586621682057969"><span class="hs-identifier hs-var hs-var">nope</span></a></span></span><span> </span><span id="local-6989586621682057983"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057983"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; a
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;countHsWrapperInvisApps&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682057983"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682057148"><span class="annot"><a href="GHC.Hs.Extension.html#OutputableBndrId"><span class="hs-identifier hs-type">OutputableBndrId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-type">XPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057148"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057148"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-693"></span><span>  </span><span id="local-6989586621682058006"><span class="annot"><span class="annottext">ppr :: HsExprArg p -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058007"><span class="annot"><span class="annottext">EValArg p
</span><a href="#local-6989586621682058007"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EValArg&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EValArg p -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">EValArg p
</span><a href="#local-6989586621682058007"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-694"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-type">EPrag</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058008"><span class="annot"><span class="annottext">HsPragE (GhcPass (XPass p))
</span><a href="#local-6989586621682058008"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EPrag&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass (XPass p)) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass (XPass p))
</span><a href="#local-6989586621682058008"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-695"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_hs_ty :: forall (p :: TcPass). HsExprArg p -&gt; LHsWcType (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_hs_ty"><span class="hs-identifier hs-var">eva_hs_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058009"><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682058009"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWildCardBndrs
  (GhcPass 'Renamed)
  (GenLocated SrcSpanAnnA (HsType (GhcPass 'Renamed)))
-&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
HsWildCardBndrs
  (GhcPass 'Renamed)
  (GenLocated SrcSpanAnnA (HsType (GhcPass 'Renamed)))
</span><a href="#local-6989586621682058009"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-696"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span id="local-6989586621682058012"><span class="annot"><span class="annottext">EWrap
</span><a href="#local-6989586621682058012"><span class="hs-identifier hs-var">wrap</span></a></span></span><span class="hs-special">)</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EWrap -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">EWrap
</span><a href="#local-6989586621682058012"><span class="hs-identifier hs-var">wrap</span></a></span><span>
</span><span id="line-697"></span><span>
</span><span id="line-698"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-699"></span><span>  </span><span id="local-6989586621682058021"><span class="annot"><span class="annottext">ppr :: EWrap -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-type">EPar</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EPar&quot;</span></span><span>
</span><span id="line-700"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-type">EHsWrap</span></a></span><span> </span><span id="local-6989586621682058022"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058022"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EHsWrap&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058022"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-701"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-type">EExpand</span></a></span><span> </span><span id="local-6989586621682058023"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058023"><span class="hs-identifier hs-var">orig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EExpand&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058023"><span class="hs-identifier hs-var">orig</span></a></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682057147"><span class="annot"><a href="GHC.Hs.Extension.html#OutputableBndrId"><span class="hs-identifier hs-type">OutputableBndrId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-type">XPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057147"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057147"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-704"></span><span>  </span><span id="local-6989586621682058030"><span class="annot"><span class="annottext">ppr :: EValArg p -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-type">ValArg</span></a></span><span> </span><span id="local-6989586621682058031"><span class="annot"><span class="annottext">LHsExpr (GhcPass (XPass p))
</span><a href="#local-6989586621682058031"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr (GhcPass (XPass p))) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass (XPass p))
GenLocated SrcSpanAnnA (HsExpr (GhcPass (XPass p)))
</span><a href="#local-6989586621682058031"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-705"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArgQL"><span class="hs-identifier hs-type">ValArgQL</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">va_fun :: EValArg 'TcpInst -&gt; (HsExpr GhcTc, AppCtxt)
</span><a href="GHC.Tc.Gen.Head.html#va_fun"><span class="hs-identifier hs-var">va_fun</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058045"><span class="annot"><span class="annottext">(HsExpr GhcTc, AppCtxt)
</span><a href="#local-6989586621682058045"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">va_args :: EValArg 'TcpInst -&gt; [HsExprArg 'TcpInst]
</span><a href="GHC.Tc.Gen.Head.html#va_args"><span class="hs-identifier hs-var">va_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058046"><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621682058046"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">va_ty :: EValArg 'TcpInst -&gt; TcSigmaType
</span><a href="GHC.Tc.Gen.Head.html#va_ty"><span class="hs-identifier hs-var">va_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058047"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058047"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ValArgQL&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, AppCtxt) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, AppCtxt)
</span><a href="#local-6989586621682058045"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>         </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpInst] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621682058046"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;va_ty:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058047"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#pprHsExprArgTc"><span class="hs-identifier hs-type">pprHsExprArgTc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-710"></span><span id="pprHsExprArgTc"><span class="annot"><span class="annottext">pprHsExprArgTc :: HsExprArg 'TcpInst -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#pprHsExprArgTc"><span class="hs-identifier hs-var hs-var">pprHsExprArgTc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058049"><span class="annot"><span class="annottext">EValArg 'TcpInst
</span><a href="#local-6989586621682058049"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_arg_ty :: forall (p :: TcPass). HsExprArg p -&gt; XEVAType p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg_ty"><span class="hs-identifier hs-var">eva_arg_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058050"><span class="annot"><span class="annottext">XEVAType 'TcpInst
</span><a href="#local-6989586621682058050"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EValArg&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">EValArg 'TcpInst
</span><a href="#local-6989586621682058049"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
XEVAType 'TcpInst
</span><a href="#local-6989586621682058050"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#pprHsExprArgTc"><span class="hs-identifier hs-var">pprHsExprArgTc</span></a></span><span> </span><span id="local-6989586621682058052"><span class="annot"><span class="annottext">HsExprArg 'TcpInst
</span><a href="#local-6989586621682058052"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpInst -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpInst
</span><a href="#local-6989586621682058052"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span class="hs-comment">{- Note [Desugar OpApp in the typechecker]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Operator sections are desugared in the renamer; see GHC.Rename.Expr
Note [Handling overloaded and rebindable constructs].
But for reasons explained there, we rename OpApp to OpApp.  Then,
here in the typechecker, we desugar it to a use of HsExpanded.
That makes it possible to typecheck something like
     e1 `f` e2
where
   f :: forall a. t1 -&gt; forall b. t2 -&gt; t3

Note [Looking through HsExpanded]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When creating an application chain in splitHsApps, we must deal with
     HsExpanded f1 (f `HsApp` e1) `HsApp` e2 `HsApp` e3

as a single application chain `f e1 e2 e3`.  Otherwise stuff like overloaded
labels (#19154) won't work.

It's easy to achieve this: `splitHsApps` unwraps `HsExpanded`.
-}</span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 tcInferAppHead
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAppHead"><span class="hs-identifier hs-type">tcInferAppHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-744"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- Infer type of the head of an application</span><span>
</span><span id="line-746"></span><span class="hs-comment">--   i.e. the 'f' in (f e1 ... en)</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- See Note [Application chains and heads] in GHC.Tc.Gen.App</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- We get back a /SigmaType/ because we have special cases for</span><span>
</span><span id="line-749"></span><span class="hs-comment">--   * A bare identifier (just look it up)</span><span>
</span><span id="line-750"></span><span class="hs-comment">--     This case also covers a record selector HsRecSel</span><span>
</span><span id="line-751"></span><span class="hs-comment">--   * An expression with a type signature (e :: ty)</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- See Note [Application chains and heads] in GHC.Tc.Gen.App</span><span>
</span><span id="line-753"></span><span class="hs-comment">--</span><span>
</span><span id="line-754"></span><span class="hs-comment">-- Why do we need the arguments to infer the type of the head of the</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- application? Simply to inform add_head_ctxt about whether or not</span><span>
</span><span id="line-756"></span><span class="hs-comment">-- to put push a new &quot;In the expression...&quot; context. (We don't push a</span><span>
</span><span id="line-757"></span><span class="hs-comment">-- new one if there are no arguments, because we already have.)</span><span>
</span><span id="line-758"></span><span class="hs-comment">--</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- Note that [] and (,,) are both HsVar:</span><span>
</span><span id="line-760"></span><span class="hs-comment">--   see Note [Empty lists] and [ExplicitTuple] in GHC.Hs.Expr</span><span>
</span><span id="line-761"></span><span class="hs-comment">--</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- NB: 'e' cannot be HsApp, HsTyApp, HsPrag, HsPar, because those</span><span>
</span><span id="line-763"></span><span class="hs-comment">--     cases are dealt with by splitHsApps.</span><span>
</span><span id="line-764"></span><span class="hs-comment">--</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- See Note [tcApp: typechecking applications] in GHC.Tc.Gen.App</span><span>
</span><span id="line-766"></span><span id="tcInferAppHead"><span class="annot"><span class="annottext">tcInferAppHead :: (HsExpr (GhcPass 'Renamed), AppCtxt)
-&gt; [HsExprArg 'TcpRn] -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferAppHead"><span class="hs-identifier hs-var hs-var">tcInferAppHead</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058053"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058053"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682058054"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682058054"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682058055"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682058055"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. AppCtxt -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#addHeadCtxt"><span class="hs-identifier hs-var">addHeadCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682058054"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM (HsExpr GhcTc, TcSigmaType)
 -&gt; TcM (HsExpr GhcTc, TcSigmaType))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-768"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058056"><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058056"><span class="hs-identifier hs-var">mb_tc_fun</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn] -&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
</span><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier hs-var">tcInferAppHead_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058053"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682058055"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-769"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058056"><span class="hs-identifier hs-var">mb_tc_fun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-770"></span><span>            </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058057"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058057"><span class="hs-identifier hs-var">fun'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058058"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058058"><span class="hs-identifier hs-var">fun_sigma</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058057"><span class="hs-identifier hs-var">fun'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058058"><span class="hs-identifier hs-var">fun_sigma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>            </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ExpRhoType -&gt; TcM (HsExpr GhcTc))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. (ExpRhoType -&gt; TcM a) -&gt; TcM (a, TcSigmaType)
</span><a href="GHC.Tc.Utils.TcMType.html#tcInfer"><span class="hs-identifier hs-var">tcInfer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ExpRhoType -&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Expr.html#tcExpr"><span class="hs-identifier hs-var">tcExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058053"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier hs-type">tcInferAppHead_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-774"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-775"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- See Note [Application chains and heads] in GHC.Tc.Gen.App</span><span>
</span><span id="line-777"></span><span class="hs-comment">-- Returns Nothing for a complicated head</span><span>
</span><span id="line-778"></span><span id="tcInferAppHead_maybe"><span class="annot"><span class="annottext">tcInferAppHead_maybe :: HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn] -&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
</span><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier hs-var hs-var">tcInferAppHead_maybe</span></a></span></span><span> </span><span id="local-6989586621682058060"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058060"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682058061"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682058061"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-779"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058060"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-780"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058062"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058062"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; Maybe (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">((HsExpr GhcTc, TcSigmaType) -&gt; Maybe (HsExpr GhcTc, TcSigmaType))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
-&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier hs-var">tcInferId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058062"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-781"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsRecSel"><span class="hs-identifier hs-type">HsRecSel</span></a></span><span> </span><span class="annot"><span class="annottext">XRecSel (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058065"><span class="annot"><span class="annottext">FieldOcc (GhcPass 'Renamed)
</span><a href="#local-6989586621682058065"><span class="hs-identifier hs-var">f</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; Maybe (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">((HsExpr GhcTc, TcSigmaType) -&gt; Maybe (HsExpr GhcTc, TcSigmaType))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
-&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FieldOcc (GhcPass 'Renamed) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferRecSelId"><span class="hs-identifier hs-var">tcInferRecSelId</span></a></span><span> </span><span class="annot"><span class="annottext">FieldOcc (GhcPass 'Renamed)
</span><a href="#local-6989586621682058065"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-782"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExprWithTySig"><span class="hs-identifier hs-type">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">XExprWithTySig (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058068"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058068"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682058069"><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621682058069"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; Maybe (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">((HsExpr GhcTc, TcSigmaType) -&gt; Maybe (HsExpr GhcTc, TcSigmaType))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
-&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
-&gt; LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcExprWithSig"><span class="hs-identifier hs-var">tcExprWithSig</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058068"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621682058069"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-783"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLitE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058072"><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621682058072"><span class="hs-identifier hs-var">lit</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; Maybe (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">((HsExpr GhcTc, TcSigmaType) -&gt; Maybe (HsExpr GhcTc, TcSigmaType))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
-&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferOverLit"><span class="hs-identifier hs-var">tcInferOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621682058072"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-784"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsUntypedSplice"><span class="hs-identifier hs-type">HsUntypedSplice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsUntypedSpliceTop"><span class="hs-identifier hs-type">HsUntypedSpliceTop</span></a></span><span> </span><span class="annot"><span class="annottext">ThModFinalizers
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058076"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058076"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsUntypedSplice (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-785"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn] -&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
</span><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier hs-var">tcInferAppHead_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058076"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682058061"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-786"></span><span>      </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
-&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span id="local-6989586621682057240"><span class="annot"><a href="GHC.Tc.Gen.Head.html#addHeadCtxt"><span class="hs-identifier hs-type">addHeadCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057240"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-789"></span><span id="addHeadCtxt"><span class="annot"><span class="annottext">addHeadCtxt :: forall a. AppCtxt -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#addHeadCtxt"><span class="hs-identifier hs-var hs-var">addHeadCtxt</span></a></span></span><span> </span><span id="local-6989586621682058077"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682058077"><span class="hs-identifier hs-var">fun_ctxt</span></a></span></span><span> </span><span id="local-6989586621682058078"><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621682058078"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; Bool
</span><a href="GHC.Types.SrcLoc.html#isGoodSrcSpan"><span class="hs-identifier hs-var">isGoodSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682058080"><span class="hs-identifier hs-var">fun_loc</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- noSrcSpan =&gt; no arguments</span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621682058078"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>                  </span><span class="hs-comment">-- =&gt; context is already set</span><span>
</span><span id="line-792"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-793"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcM a -&gt; TcM a
forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682058080"><span class="hs-identifier hs-var">fun_loc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM a -&gt; TcM a) -&gt; TcM a -&gt; TcM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-794"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682058077"><span class="hs-identifier hs-var">fun_ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-795"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span id="local-6989586621682058082"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058082"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; TcM a -&gt; TcM a
forall a. HsExpr (GhcPass 'Renamed) -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Gen.Head.html#addExprCtxt"><span class="hs-identifier hs-var">addExprCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058082"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621682058078"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-796"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621682058078"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-798"></span><span>    </span><span id="local-6989586621682058080"><span class="annot"><span class="annottext">fun_loc :: SrcSpan
</span><a href="#local-6989586621682058080"><span class="hs-identifier hs-var hs-var">fun_loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var">appCtxtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621682058077"><span class="hs-identifier hs-var">fun_ctxt</span></a></span><span>
</span><span id="line-799"></span><span>
</span><span id="line-800"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 Record selectors
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferRecSelId"><span class="hs-identifier hs-type">tcInferRecSelId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-807"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span id="tcInferRecSelId"><span class="annot"><span class="annottext">tcInferRecSelId :: FieldOcc (GhcPass 'Renamed) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferRecSelId"><span class="hs-identifier hs-var hs-var">tcInferRecSelId</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a></span><span> </span><span id="local-6989586621682058084"><span class="annot"><span class="annottext">XCFieldOcc (GhcPass 'Renamed)
</span><a href="#local-6989586621682058084"><span class="hs-identifier hs-var">sel_name</span></a></span></span><span> </span><span id="local-6989586621682058085"><span class="annot"><span class="annottext">XRec (GhcPass 'Renamed) RdrName
</span><a href="#local-6989586621682058085"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058086"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058086"><span class="hs-identifier hs-var">sel_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM Var
</span><a href="#local-6989586621682058087"><span class="hs-identifier hs-var">tc_rec_sel_id</span></a></span><span>
</span><span id="line-810"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058088"><span class="annot"><span class="annottext">expr :: HsExpr GhcTc
</span><a href="#local-6989586621682058088"><span class="hs-identifier hs-var hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XRecSel GhcTc -&gt; FieldOcc GhcTc -&gt; HsExpr GhcTc
forall p. XRecSel p -&gt; FieldOcc p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsRecSel"><span class="hs-identifier hs-var">HsRecSel</span></a></span><span> </span><span class="annot"><span class="annottext">XRecSel GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCFieldOcc GhcTc -&gt; XRec GhcTc RdrName -&gt; FieldOcc GhcTc
forall pass. XCFieldOcc pass -&gt; XRec pass RdrName -&gt; FieldOcc pass
</span><a href="Language.Haskell.Syntax.Type.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a></span><span> </span><span class="annot"><span class="annottext">XCFieldOcc GhcTc
Var
</span><a href="#local-6989586621682058086"><span class="hs-identifier hs-var">sel_id</span></a></span><span> </span><span class="annot"><span class="annottext">XRec (GhcPass 'Renamed) RdrName
XRec GhcTc RdrName
</span><a href="#local-6989586621682058085"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-811"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058088"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058086"><span class="hs-identifier hs-var">sel_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-813"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-814"></span><span>       </span><span class="annot"><a href="#local-6989586621682058090"><span class="hs-identifier hs-type">occ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span>
</span><span id="line-815"></span><span>       </span><span id="local-6989586621682058090"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621682058090"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated (SrcAnn NameAnn) RdrName -&gt; RdrName
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">XRec (GhcPass 'Renamed) RdrName
GenLocated (SrcAnn NameAnn) RdrName
</span><a href="#local-6989586621682058085"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span>       </span><span class="annot"><a href="#local-6989586621682058087"><span class="hs-identifier hs-type">tc_rec_sel_id</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span>
</span><span id="line-818"></span><span>       </span><span class="hs-comment">-- Like tc_infer_id, but returns an Id not a HsExpr,</span><span>
</span><span id="line-819"></span><span>       </span><span class="hs-comment">-- so we can wrap it back up into a HsRecSel</span><span>
</span><span id="line-820"></span><span>       </span><span id="local-6989586621682058087"><span class="annot"><span class="annottext">tc_rec_sel_id :: TcM Var
</span><a href="#local-6989586621682058087"><span class="hs-identifier hs-var hs-var">tc_rec_sel_id</span></a></span></span><span>
</span><span id="line-821"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058094"><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621682058094"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM TcTyThing
</span><a href="GHC.Tc.Utils.Env.html#tcLookup"><span class="hs-identifier hs-var">tcLookup</span></a></span><span> </span><span class="annot"><span class="annottext">XCFieldOcc (GhcPass 'Renamed)
Name
</span><a href="#local-6989586621682058084"><span class="hs-identifier hs-var">sel_name</span></a></span><span>
</span><span id="line-822"></span><span>              </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621682058094"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-823"></span><span>                    </span><span class="annot"><a href="GHC.Tc.Types.html#ATcId"><span class="hs-identifier hs-type">ATcId</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tct_id :: TcTyThing -&gt; Var
</span><a href="GHC.Tc.Types.html#tct_id"><span class="hs-identifier hs-var">tct_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058098"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058098"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-824"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Var -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_naughty"><span class="hs-identifier hs-var">check_naughty</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621682058090"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058098"><span class="hs-identifier hs-var">id</span></a></span><span>  </span><span class="hs-comment">-- See Note [Local record selectors]</span><span>
</span><span id="line-825"></span><span>                            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_local_id"><span class="hs-identifier hs-var">check_local_id</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058098"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-826"></span><span>                            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcM Var
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058098"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span>                    </span><span class="annot"><a href="GHC.Tc.Types.html#AGlobal"><span class="hs-identifier hs-type">AGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#AnId"><span class="hs-identifier hs-type">AnId</span></a></span><span> </span><span id="local-6989586621682058103"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058103"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Var -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_naughty"><span class="hs-identifier hs-var">check_naughty</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621682058090"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058103"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-830"></span><span>                            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcM Var
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058103"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-831"></span><span>                           </span><span class="hs-comment">-- A global cannot possibly be ill-staged</span><span>
</span><span id="line-832"></span><span>                           </span><span class="hs-comment">-- nor does it need the 'lifting' treatment</span><span>
</span><span id="line-833"></span><span>                           </span><span class="hs-comment">-- hence no checkTh stuff here</span><span>
</span><span id="line-834"></span><span>
</span><span id="line-835"></span><span>                    </span><span class="annot"><span class="annottext">TcTyThing
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcM Var
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcM Var) -&gt; TcRnMessage -&gt; TcM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TcTyThing -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnExpectedValueId"><span class="hs-identifier hs-var">TcRnExpectedValueId</span></a></span><span> </span><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621682058094"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span class="hs-comment">-- A type signature on the argument of an ambiguous record selector or</span><span>
</span><span id="line-840"></span><span class="hs-comment">-- the record expression in an update must be &quot;obvious&quot;, i.e. the</span><span>
</span><span id="line-841"></span><span class="hs-comment">-- outermost constructor ignoring parentheses.</span><span>
</span><span id="line-842"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-type">obviousSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span id="obviousSig"><span class="annot"><span class="annottext">obviousSig :: HsExpr (GhcPass 'Renamed)
-&gt; Maybe (LHsSigWcType (GhcPass 'Renamed))
</span><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var hs-var">obviousSig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExprWithTySig"><span class="hs-identifier hs-type">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">XExprWithTySig (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058106"><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621682058106"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWildCardBndrs
  (GhcPass 'Renamed)
  (GenLocated SrcSpanAnnA (HsSigType (GhcPass 'Renamed)))
-&gt; Maybe
     (HsWildCardBndrs
        (GhcPass 'Renamed)
        (GenLocated SrcSpanAnnA (HsSigType (GhcPass 'Renamed))))
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
HsWildCardBndrs
  (GhcPass 'Renamed)
  (GenLocated SrcSpanAnnA (HsSigType (GhcPass 'Renamed)))
</span><a href="#local-6989586621682058106"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-844"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;(&quot; (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058107"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058107"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsToken &quot;)&quot; (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; Maybe (LHsSigWcType (GhcPass 'Renamed))
</span><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed))
-&gt; HsExpr (GhcPass 'Renamed)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed))
</span><a href="#local-6989586621682058107"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058108"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058108"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; Maybe (LHsSigWcType (GhcPass 'Renamed))
</span><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed))
-&gt; HsExpr (GhcPass 'Renamed)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed))
</span><a href="#local-6989586621682058108"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (LHsSigWcType (GhcPass 'Renamed))
Maybe
  (HsWildCardBndrs
     (GhcPass 'Renamed)
     (GenLocated SrcSpanAnnA (HsSigType (GhcPass 'Renamed))))
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-847"></span><span>
</span><span id="line-848"></span><span class="hs-comment">-- Extract the outermost TyCon of a type, if there is one; for</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- data families this is the representation tycon (because that's</span><span>
</span><span id="line-850"></span><span class="hs-comment">-- where the fields live).</span><span>
</span><span id="line-851"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier hs-type">tyConOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-852"></span><span id="tyConOf"><span class="annot"><span class="annottext">tyConOf :: FamInstEnvs -&gt; TcSigmaType -&gt; Maybe TyCon
</span><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier hs-var hs-var">tyConOf</span></a></span></span><span> </span><span id="local-6989586621682058109"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682058109"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span></span><span> </span><span id="local-6989586621682058110"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058110"><span class="hs-identifier hs-var">ty0</span></a></span></span><span>
</span><span id="line-853"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TcSigmaType -&gt; Maybe (TyCon, [TcSigmaType])
TcSigmaType -&gt; Maybe (TyCon, [TcSigmaType])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058112"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-854"></span><span>      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058113"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682058113"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058114"><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058114"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyCon, [TcSigmaType], Coercion) -&gt; TyCon
forall a b c. (a, b, c) -&gt; a
</span><a href="GHC.Utils.Misc.html#fstOf3"><span class="hs-identifier hs-var">fstOf3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FamInstEnvs
-&gt; TyCon -&gt; [TcSigmaType] -&gt; (TyCon, [TcSigmaType], Coercion)
</span><a href="GHC.Tc.Instance.Family.html#tcLookupDataFamInst"><span class="hs-identifier hs-var">tcLookupDataFamInst</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682058109"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682058113"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058114"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-855"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TyCon, [TcSigmaType])
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-856"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058112"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058112"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Var], [TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitSigmaTy"><span class="hs-identifier hs-var">tcSplitSigmaTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058110"><span class="hs-identifier hs-var">ty0</span></a></span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span class="hs-comment">-- Variant of tyConOf that works for ExpTypes</span><span>
</span><span id="line-860"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tyConOfET"><span class="hs-identifier hs-type">tyConOfET</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpRhoType"><span class="hs-identifier hs-type">ExpRhoType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-861"></span><span id="tyConOfET"><span class="annot"><span class="annottext">tyConOfET :: FamInstEnvs -&gt; ExpRhoType -&gt; Maybe TyCon
</span><a href="GHC.Tc.Gen.Head.html#tyConOfET"><span class="hs-identifier hs-var hs-var">tyConOfET</span></a></span></span><span> </span><span id="local-6989586621682058117"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682058117"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span></span><span> </span><span id="local-6989586621682058118"><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621682058118"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; TcSigmaType -&gt; Maybe TyCon
</span><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier hs-var">tyConOf</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621682058117"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span><span> </span><span class="annot"><span class="annottext">(TcSigmaType -&gt; Maybe TyCon) -&gt; Maybe TcSigmaType -&gt; Maybe TyCon
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3D%3C%3C/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType -&gt; Maybe TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#checkingExpType_maybe"><span class="hs-identifier hs-var">checkingExpType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621682058118"><span class="hs-identifier hs-var">ty0</span></a></span><span>
</span><span id="line-862"></span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-comment">-- For an ambiguous record field, find all the candidate record</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- selectors (as GlobalRdrElts) and their parents.</span><span>
</span><span id="line-866"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#lookupParents"><span class="hs-identifier hs-type">lookupParents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelParent"><span class="hs-identifier hs-type">RecSelParent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-867"></span><span id="lookupParents"><span class="annot"><span class="annottext">lookupParents :: Bool -&gt; RdrName -&gt; RnM [(RecSelParent, GlobalRdrElt)]
</span><a href="GHC.Tc.Gen.Head.html#lookupParents"><span class="hs-identifier hs-var hs-var">lookupParents</span></a></span></span><span> </span><span id="local-6989586621682058121"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682058121"><span class="hs-identifier hs-var">is_selector</span></a></span></span><span> </span><span id="local-6989586621682058122"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621682058122"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-868"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058123"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621682058123"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-869"></span><span>        </span><span class="hs-comment">-- Filter by isRecFldGRE because otherwise a non-selector variable with</span><span>
</span><span id="line-870"></span><span>        </span><span class="hs-comment">-- an overlapping name can get through when NoFieldSelectors is enabled.</span><span>
</span><span id="line-871"></span><span>        </span><span class="hs-comment">-- See Note [NoFieldSelectors] in GHC.Rename.Env.</span><span>
</span><span id="line-872"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058125"><span class="annot"><span class="annottext">all_gres :: [GlobalRdrElt]
</span><a href="#local-6989586621682058125"><span class="hs-identifier hs-var hs-var">all_gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; GlobalRdrEnv -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_RdrName%27"><span class="hs-identifier hs-var">lookupGRE_RdrName'</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621682058122"><span class="hs-identifier hs-var">rdr</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621682058123"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-873"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058127"><span class="annot"><span class="annottext">gres :: [GlobalRdrElt]
</span><a href="#local-6989586621682058127"><span class="hs-identifier hs-var hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682058121"><span class="hs-identifier hs-var">is_selector</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalRdrElt -&gt; Bool) -&gt; [GlobalRdrElt] -&gt; [GlobalRdrElt]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isFieldSelectorGRE"><span class="hs-identifier hs-var">isFieldSelectorGRE</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621682058125"><span class="hs-identifier hs-var">all_gres</span></a></span><span>
</span><span id="line-874"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalRdrElt -&gt; Bool) -&gt; [GlobalRdrElt] -&gt; [GlobalRdrElt]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isRecFldGRE"><span class="hs-identifier hs-var">isRecFldGRE</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621682058125"><span class="hs-identifier hs-var">all_gres</span></a></span><span>
</span><span id="line-875"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GlobalRdrElt
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (RecSelParent, GlobalRdrElt))
-&gt; [GlobalRdrElt] -&gt; RnM [(RecSelParent, GlobalRdrElt)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (RecSelParent, GlobalRdrElt)
</span><a href="#local-6989586621682058131"><span class="hs-identifier hs-var">lookupParent</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621682058127"><span class="hs-identifier hs-var">gres</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-876"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-877"></span><span>    </span><span class="annot"><a href="#local-6989586621682058131"><span class="hs-identifier hs-type">lookupParent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelParent"><span class="hs-identifier hs-type">RecSelParent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-878"></span><span>    </span><span id="local-6989586621682058131"><span class="annot"><span class="annottext">lookupParent :: GlobalRdrElt
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (RecSelParent, GlobalRdrElt)
</span><a href="#local-6989586621682058131"><span class="hs-identifier hs-var hs-var">lookupParent</span></a></span></span><span> </span><span id="local-6989586621682058132"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621682058132"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058133"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058133"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM Var
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621682058132"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span>                          </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Maybe RecSelParent
</span><a href="GHC.Types.Id.html#recordSelectorTyCon_maybe"><span class="hs-identifier hs-var">recordSelectorTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058133"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-880"></span><span>                              </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682058137"><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621682058137"><span class="hs-identifier hs-var">rstc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RecSelParent, GlobalRdrElt)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (RecSelParent, GlobalRdrElt)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621682058137"><span class="hs-identifier hs-var">rstc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621682058132"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>                              </span><span class="annot"><span class="annottext">Maybe RecSelParent
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcRnMessage
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (RecSelParent, GlobalRdrElt)
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; TcRnMessage
</span><a href="GHC.Tc.Gen.Head.html#notSelector"><span class="hs-identifier hs-var">notSelector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621682058132"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#fieldNotInType"><span class="hs-identifier hs-type">fieldNotInType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelParent"><span class="hs-identifier hs-type">RecSelParent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span>
</span><span id="line-885"></span><span id="fieldNotInType"><span class="annot"><span class="annottext">fieldNotInType :: RecSelParent -&gt; RdrName -&gt; TcRnMessage
</span><a href="GHC.Tc.Gen.Head.html#fieldNotInType"><span class="hs-identifier hs-var hs-var">fieldNotInType</span></a></span></span><span> </span><span id="local-6989586621682058138"><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621682058138"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682058139"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621682058139"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-886"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; NotInScopeError -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#mkTcRnNotInScope"><span class="hs-identifier hs-var">mkTcRnNotInScope</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621682058139"><span class="hs-identifier hs-var">rdr</span></a></span><span> </span><span class="annot"><span class="annottext">(NotInScopeError -&gt; TcRnMessage) -&gt; NotInScopeError -&gt; TcRnMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-887"></span><span>    </span><span class="annot"><span class="annottext">SDoc -&gt; NotInScopeError
</span><a href="GHC.Tc.Errors.Types.html#UnknownSubordinate"><span class="hs-identifier hs-var">UnknownSubordinate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;field of type&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecSelParent -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621682058138"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#notSelector"><span class="hs-identifier hs-type">notSelector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span>
</span><span id="line-890"></span><span id="notSelector"><span class="annot"><span class="annottext">notSelector :: Name -&gt; TcRnMessage
</span><a href="GHC.Tc.Gen.Head.html#notSelector"><span class="hs-identifier hs-var hs-var">notSelector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnNotARecordSelector"><span class="hs-identifier hs-var">TcRnNotARecordSelector</span></a></span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span>
</span><span id="line-893"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                Expressions with a type signature
                        expr :: type
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcExprWithSig"><span class="hs-identifier hs-type">tcExprWithSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#NoGhcTc"><span class="hs-identifier hs-type">NoGhcTc</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span id="tcExprWithSig"><span class="annot"><span class="annottext">tcExprWithSig :: LHsExpr (GhcPass 'Renamed)
-&gt; LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcExprWithSig"><span class="hs-identifier hs-var hs-var">tcExprWithSig</span></a></span></span><span> </span><span id="local-6989586621682058144"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058144"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682058145"><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621682058145"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span>
</span><span id="line-903"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058146"><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621682058146"><span class="hs-identifier hs-var">sig_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM TcIdSigInfo -&gt; TcM TcIdSigInfo
forall r. TcM r -&gt; TcM r
</span><a href="GHC.Tc.Utils.Monad.html#checkNoErrs"><span class="hs-identifier hs-var">checkNoErrs</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM TcIdSigInfo -&gt; TcM TcIdSigInfo)
-&gt; TcM TcIdSigInfo -&gt; TcM TcIdSigInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>  </span><span class="hs-comment">-- Avoid error cascade</span><span>
</span><span id="line-904"></span><span>                     </span><span class="annot"><span class="annottext">SrcSpan
-&gt; LHsSigWcType (GhcPass 'Renamed) -&gt; Maybe Name -&gt; TcM TcIdSigInfo
</span><a href="GHC.Tc.Gen.Sig.html#tcUserTypeSig"><span class="hs-identifier hs-var">tcUserTypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682058148"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
LHsSigWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682058145"><span class="hs-identifier hs-var">hs_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-905"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058149"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058149"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058150"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058150"><span class="hs-identifier hs-var">poly_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
-&gt; LHsExpr (GhcPass 'Renamed)
-&gt; TcIdSigInfo
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcExprSig"><span class="hs-identifier hs-var">tcExprSig</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621682058152"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058144"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621682058146"><span class="hs-identifier hs-var">sig_info</span></a></span><span>
</span><span id="line-906"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XExprWithTySig GhcTc
-&gt; LHsExpr GhcTc -&gt; LHsSigWcType (NoGhcTc GhcTc) -&gt; HsExpr GhcTc
forall p.
XExprWithTySig p
-&gt; LHsExpr p -&gt; LHsSigWcType (NoGhcTc p) -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#ExprWithTySig"><span class="hs-identifier hs-var">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">XExprWithTySig GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058149"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
LHsSigWcType (NoGhcTc GhcTc)
</span><a href="#local-6989586621682058145"><span class="hs-identifier hs-var">hs_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058150"><span class="hs-identifier hs-var">poly_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-907"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-908"></span><span>    </span><span id="local-6989586621682058148"><span class="annot"><span class="annottext">loc :: SrcSpan
</span><a href="#local-6989586621682058148"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsSigType (GhcPass 'Renamed)) -&gt; SrcSpan
forall a e. GenLocated (SrcSpanAnn' a) e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsSigWcType (GhcPass 'Renamed) -&gt; LHsSigType (GhcPass 'Renamed)
forall pass. LHsSigWcType pass -&gt; LHsSigType pass
</span><a href="GHC.Hs.Type.html#dropWildCards"><span class="hs-identifier hs-var">dropWildCards</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
LHsSigWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682058145"><span class="hs-identifier hs-var">hs_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>    </span><span id="local-6989586621682058152"><span class="annot"><span class="annottext">ctxt :: UserTypeCtxt
</span><a href="#local-6989586621682058152"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReportRedundantConstraints -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#ExprSigCtxt"><span class="hs-identifier hs-var">ExprSigCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsSigWcType (GhcPass 'Renamed) -&gt; ReportRedundantConstraints
</span><a href="GHC.Tc.Gen.Sig.html#lhsSigWcTypeContextSpan"><span class="hs-identifier hs-var">lhsSigWcTypeContextSpan</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
LHsSigWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621682058145"><span class="hs-identifier hs-var">hs_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span>
</span><span id="line-911"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcExprSig"><span class="hs-identifier hs-type">tcExprSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#UserTypeCtxt"><span class="hs-identifier hs-type">UserTypeCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span id="tcExprSig"><span class="annot"><span class="annottext">tcExprSig :: UserTypeCtxt
-&gt; LHsExpr (GhcPass 'Renamed)
-&gt; TcIdSigInfo
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcExprSig"><span class="hs-identifier hs-var hs-var">tcExprSig</span></a></span></span><span> </span><span id="local-6989586621682058156"><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621682058156"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621682058157"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058157"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#CompleteSig"><span class="hs-identifier hs-type">CompleteSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_bndr :: TcIdSigInfo -&gt; Var
</span><a href="GHC.Tc.Types.html#sig_bndr"><span class="hs-identifier hs-var">sig_bndr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058160"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058160"><span class="hs-identifier hs-var">poly_id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: TcIdSigInfo -&gt; SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058162"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682058162"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682058162"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM (LHsExpr GhcTc, TcSigmaType)
 -&gt; TcM (LHsExpr GhcTc, TcSigmaType))
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>   </span><span class="hs-comment">-- Sets the location for the implication constraint</span><span>
</span><span id="line-914"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058163"><span class="annot"><span class="annottext">poly_ty :: TcSigmaType
</span><a href="#local-6989586621682058163"><span class="hs-identifier hs-var hs-var">poly_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058160"><span class="hs-identifier hs-var">poly_id</span></a></span><span>
</span><span id="line-915"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058164"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058164"><span class="hs-identifier hs-var">wrap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058165"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058165"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
-&gt; TcSigmaType
-&gt; (TcSigmaType -&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc)))
-&gt; TcM (HsWrapper, GenLocated SrcSpanAnnA (HsExpr GhcTc))
forall result.
UserTypeCtxt
-&gt; TcSigmaType
-&gt; (TcSigmaType -&gt; TcM result)
-&gt; TcM (HsWrapper, result)
</span><a href="GHC.Tc.Utils.Unify.html#tcSkolemiseScoped"><span class="hs-identifier hs-var">tcSkolemiseScoped</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621682058156"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058163"><span class="hs-identifier hs-var">poly_ty</span></a></span><span> </span><span class="annot"><span class="annottext">((TcSigmaType -&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc)))
 -&gt; TcM (HsWrapper, GenLocated SrcSpanAnnA (HsExpr GhcTc)))
-&gt; (TcSigmaType -&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc)))
-&gt; TcM (HsWrapper, GenLocated SrcSpanAnnA (HsExpr GhcTc))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682058167"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058167"><span class="hs-identifier hs-var">rho_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-916"></span><span>                          </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed) -&gt; TcSigmaType -&gt; TcM (LHsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Expr.html#tcCheckMonoExprNC"><span class="hs-identifier hs-var">tcCheckMonoExprNC</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058157"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058167"><span class="hs-identifier hs-var">rho_ty</span></a></span><span>
</span><span id="line-917"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsExpr GhcTc), TcSigmaType)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058164"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058165"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058163"><span class="hs-identifier hs-var">poly_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-918"></span><span>
</span><span id="line-919"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcExprSig"><span class="hs-identifier hs-var">tcExprSig</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682058169"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058169"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682058170"><span class="annot"><span class="annottext">sig :: TcIdSigInfo
</span><a href="#local-6989586621682058170"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#PartialSig"><span class="hs-identifier hs-type">PartialSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">psig_name :: TcIdSigInfo -&gt; Name
</span><a href="GHC.Tc.Types.html#psig_name"><span class="hs-identifier hs-var">psig_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058173"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058173"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: TcIdSigInfo -&gt; SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058174"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682058174"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-920"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682058174"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM (LHsExpr GhcTc, TcSigmaType)
 -&gt; TcM (LHsExpr GhcTc, TcSigmaType))
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
-&gt; TcM (LHsExpr GhcTc, TcSigmaType)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>   </span><span class="hs-comment">-- Sets the location for the implication constraint</span><span>
</span><span id="line-921"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058175"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621682058175"><span class="hs-identifier hs-var">tclvl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058176"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621682058176"><span class="hs-identifier hs-var">wanted</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058177"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058177"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058178"><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058178"><span class="hs-identifier hs-var">sig_inst</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcIdSigInst)
-&gt; TcM
     (TcLevel, WantedConstraints,
      (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcIdSigInst))
forall a. TcM a -&gt; TcM (TcLevel, WantedConstraints, a)
</span><a href="GHC.Tc.Utils.Monad.html#pushLevelAndCaptureConstraints"><span class="hs-identifier hs-var">pushLevelAndCaptureConstraints</span></a></span><span>  </span><span class="annot"><span class="annottext">(TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcIdSigInst)
 -&gt; TcM
      (TcLevel, WantedConstraints,
       (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcIdSigInst)))
-&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcIdSigInst)
-&gt; TcM
     (TcLevel, WantedConstraints,
      (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcIdSigInst))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-923"></span><span>                </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058180"><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058180"><span class="hs-identifier hs-var">sig_inst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo -&gt; TcM TcIdSigInst
</span><a href="GHC.Tc.Gen.Sig.html#tcInstSig"><span class="hs-identifier hs-var">tcInstSig</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621682058170"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-924"></span><span>                   </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058181"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058181"><span class="hs-identifier hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Name, Var)]
-&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc))
-&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc))
forall r. [(Name, Var)] -&gt; TcM r -&gt; TcM r
</span><a href="GHC.Tc.Utils.Env.html#tcExtendNameTyVarEnv"><span class="hs-identifier hs-var">tcExtendNameTyVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(InvisTVBinder -&gt; Var) -&gt; [(Name, InvisTVBinder)] -&gt; [(Name, Var)]
forall (f :: * -&gt; *) b c a.
Functor f =&gt;
(b -&gt; c) -&gt; f (a, b) -&gt; f (a, c)
</span><a href="GHC.Utils.Misc.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="annot"><span class="annottext">InvisTVBinder -&gt; Var
forall tv argf. VarBndr tv argf -&gt; tv
</span><a href="GHC.Types.Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a></span><span> </span><span class="annot"><span class="annottext">([(Name, InvisTVBinder)] -&gt; [(Name, Var)])
-&gt; [(Name, InvisTVBinder)] -&gt; [(Name, Var)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst -&gt; [(Name, InvisTVBinder)]
</span><a href="GHC.Tc.Types.html#sig_inst_skols"><span class="hs-identifier hs-var">sig_inst_skols</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058180"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc))
 -&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc)))
-&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc))
-&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-925"></span><span>                              </span><span class="annot"><span class="annottext">[(Name, Var)] -&gt; TcM (LHsExpr GhcTc) -&gt; TcM (LHsExpr GhcTc)
forall r. [(Name, Var)] -&gt; TcM r -&gt; TcM r
</span><a href="GHC.Tc.Utils.Env.html#tcExtendNameTyVarEnv"><span class="hs-identifier hs-var">tcExtendNameTyVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; [(Name, Var)]
</span><a href="GHC.Tc.Types.html#sig_inst_wcs"><span class="hs-identifier hs-var">sig_inst_wcs</span></a></span><span>   </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058180"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcM (LHsExpr GhcTc) -&gt; TcM (LHsExpr GhcTc))
-&gt; TcM (LHsExpr GhcTc) -&gt; TcM (LHsExpr GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-926"></span><span>                              </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed) -&gt; TcSigmaType -&gt; TcM (LHsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Expr.html#tcCheckPolyExprNC"><span class="hs-identifier hs-var">tcCheckPolyExprNC</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058169"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; TcSigmaType
</span><a href="GHC.Tc.Types.html#sig_inst_tau"><span class="hs-identifier hs-var">sig_inst_tau</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058180"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsExpr GhcTc), TcIdSigInst)
-&gt; TcM (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcIdSigInst)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058181"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058180"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-928"></span><span>       </span><span class="hs-comment">-- See Note [Partial expression signatures]</span><span>
</span><span id="line-929"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058188"><span class="annot"><span class="annottext">tau :: TcSigmaType
</span><a href="#local-6989586621682058188"><span class="hs-identifier hs-var hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcIdSigInst -&gt; TcSigmaType
</span><a href="GHC.Tc.Types.html#sig_inst_tau"><span class="hs-identifier hs-var">sig_inst_tau</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058178"><span class="hs-identifier hs-var">sig_inst</span></a></span><span>
</span><span id="line-930"></span><span>             </span><span id="local-6989586621682058189"><span class="annot"><span class="annottext">infer_mode :: InferMode
</span><a href="#local-6989586621682058189"><span class="hs-identifier hs-var hs-var">infer_mode</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; [TcSigmaType]
</span><a href="GHC.Tc.Types.html#sig_inst_theta"><span class="hs-identifier hs-var">sig_inst_theta</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058178"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe TcSigmaType -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Maybe.html#isNothing/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; Maybe TcSigmaType
</span><a href="GHC.Tc.Types.html#sig_inst_wcx"><span class="hs-identifier hs-var">sig_inst_wcx</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058178"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InferMode
</span><a href="GHC.Tc.Solver.html#ApplyMR"><span class="hs-identifier hs-var">ApplyMR</span></a></span><span>
</span><span id="line-933"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-934"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InferMode
</span><a href="GHC.Tc.Solver.html#NoRestrictions"><span class="hs-identifier hs-var">NoRestrictions</span></a></span><span>
</span><span id="line-935"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682058196"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058196"><span class="hs-identifier hs-var">qtvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058197"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058197"><span class="hs-identifier hs-var">givens</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058198"><span class="annot"><span class="annottext">TcEvBinds
</span><a href="#local-6989586621682058198"><span class="hs-identifier hs-var">ev_binds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058199"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621682058199"><span class="hs-identifier hs-var">residual</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-936"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM ([Var], [Var], TcEvBinds, Bool)
-&gt; TcM (([Var], [Var], TcEvBinds, Bool), WantedConstraints)
forall a. TcM a -&gt; TcM (a, WantedConstraints)
</span><a href="GHC.Tc.Utils.Monad.html#captureConstraints"><span class="hs-identifier hs-var">captureConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM ([Var], [Var], TcEvBinds, Bool)
 -&gt; TcM (([Var], [Var], TcEvBinds, Bool), WantedConstraints))
-&gt; TcM ([Var], [Var], TcEvBinds, Bool)
-&gt; TcM (([Var], [Var], TcEvBinds, Bool), WantedConstraints)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
-&gt; InferMode
-&gt; [TcIdSigInst]
-&gt; [(Name, TcSigmaType)]
-&gt; WantedConstraints
-&gt; TcM ([Var], [Var], TcEvBinds, Bool)
</span><a href="GHC.Tc.Solver.html#simplifyInfer"><span class="hs-identifier hs-var">simplifyInfer</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621682058175"><span class="hs-identifier hs-var">tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">InferMode
</span><a href="#local-6989586621682058189"><span class="hs-identifier hs-var">infer_mode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058178"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058173"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058188"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621682058176"><span class="hs-identifier hs-var">wanted</span></a></span><span>
</span><span id="line-937"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WantedConstraints -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#emitConstraints"><span class="hs-identifier hs-var">emitConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621682058199"><span class="hs-identifier hs-var">residual</span></a></span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058202"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058202"><span class="hs-identifier hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058188"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-940"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058204"><span class="annot"><span class="annottext">inferred_theta :: [TcSigmaType]
</span><a href="#local-6989586621682058204"><span class="hs-identifier hs-var hs-var">inferred_theta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; TcSigmaType) -&gt; [Var] -&gt; [TcSigmaType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcSigmaType
</span><a href="GHC.Tc.Utils.TcType.html#evVarPred"><span class="hs-identifier hs-var">evVarPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058197"><span class="hs-identifier hs-var">givens</span></a></span><span>
</span><span id="line-941"></span><span>             </span><span id="local-6989586621682058206"><span class="annot"><span class="annottext">tau_tvs :: TyCoVarSet
</span><a href="#local-6989586621682058206"><span class="hs-identifier hs-var hs-var">tau_tvs</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058202"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-942"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058208"><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621682058208"><span class="hs-identifier hs-var">binders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058209"><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058209"><span class="hs-identifier hs-var">my_theta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WantedConstraints
-&gt; [TcSigmaType]
-&gt; TyCoVarSet
-&gt; [Var]
-&gt; Maybe TcIdSigInst
-&gt; TcM ([InvisTVBinder], [TcSigmaType])
</span><a href="GHC.Tc.Gen.Bind.html#chooseInferredQuantifiers"><span class="hs-identifier hs-var">chooseInferredQuantifiers</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621682058199"><span class="hs-identifier hs-var">residual</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058204"><span class="hs-identifier hs-var">inferred_theta</span></a></span><span>
</span><span id="line-943"></span><span>                                   </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621682058206"><span class="hs-identifier hs-var">tau_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058196"><span class="hs-identifier hs-var">qtvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; Maybe TcIdSigInst
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621682058178"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058210"><span class="annot"><span class="annottext">inferred_sigma :: TcSigmaType
</span><a href="#local-6989586621682058210"><span class="hs-identifier hs-var hs-var">inferred_sigma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
(() :: Constraint) =&gt;
[Var] -&gt; [TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Tc.Utils.TcType.html#mkInfSigmaTy"><span class="hs-identifier hs-var">mkInfSigmaTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058196"><span class="hs-identifier hs-var">qtvs</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058204"><span class="hs-identifier hs-var">inferred_theta</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058202"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-945"></span><span>             </span><span id="local-6989586621682058212"><span class="annot"><span class="annottext">my_sigma :: TcSigmaType
</span><a href="#local-6989586621682058212"><span class="hs-identifier hs-var hs-var">my_sigma</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621682058208"><span class="hs-identifier hs-var">binders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
(() :: Constraint) =&gt; [TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier hs-var">mkPhiTy</span></a></span><span>  </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058209"><span class="hs-identifier hs-var">my_theta</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058202"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-946"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058215"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058215"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058210"><span class="hs-identifier hs-var">inferred_sigma</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcSigmaType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058212"><span class="hs-identifier hs-var">my_sigma</span></a></span><span> </span><span class="hs-comment">-- NB: eqType ignores vis.</span><span>
</span><span id="line-947"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; IOEnv (Env TcGblEnv TcLclEnv) HsWrapper
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a></span><span>  </span><span class="hs-comment">-- Fast path; also avoids complaint when we infer</span><span>
</span><span id="line-948"></span><span>                                          </span><span class="hs-comment">-- an ambiguous type and have AllowAmbiguousType</span><span>
</span><span id="line-949"></span><span>                                          </span><span class="hs-comment">-- e..g infer  x :: forall a. F a -&gt; Int</span><span>
</span><span id="line-950"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CtOrigin
-&gt; UserTypeCtxt
-&gt; TcSigmaType
-&gt; TcSigmaType
-&gt; IOEnv (Env TcGblEnv TcLclEnv) HsWrapper
</span><a href="GHC.Tc.Utils.Unify.html#tcSubTypeSigma"><span class="hs-identifier hs-var">tcSubTypeSigma</span></a></span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#ExprSigOrigin"><span class="hs-identifier hs-var">ExprSigOrigin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReportRedundantConstraints -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#ExprSigCtxt"><span class="hs-identifier hs-var">ExprSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">ReportRedundantConstraints
</span><a href="GHC.Tc.Types.Origin.html#NoRRC"><span class="hs-identifier hs-var">NoRRC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058210"><span class="hs-identifier hs-var">inferred_sigma</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058212"><span class="hs-identifier hs-var">my_sigma</span></a></span><span>
</span><span id="line-951"></span><span>
</span><span id="line-952"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcExpSig&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058196"><span class="hs-identifier hs-var">qtvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058197"><span class="hs-identifier hs-var">givens</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058210"><span class="hs-identifier hs-var">inferred_sigma</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058212"><span class="hs-identifier hs-var">my_sigma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058223"><span class="annot"><span class="annottext">poly_wrap :: HsWrapper
</span><a href="#local-6989586621682058223"><span class="hs-identifier hs-var hs-var">poly_wrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058215"><span class="hs-identifier hs-var">wrap</span></a></span><span>
</span><span id="line-954"></span><span>                         </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#mkWpTyLams"><span class="hs-identifier hs-var">mkWpTyLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058196"><span class="hs-identifier hs-var">qtvs</span></a></span><span>
</span><span id="line-955"></span><span>                         </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#mkWpEvLams"><span class="hs-identifier hs-var">mkWpEvLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058197"><span class="hs-identifier hs-var">givens</span></a></span><span>
</span><span id="line-956"></span><span>                         </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcEvBinds -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#mkWpLet"><span class="hs-identifier hs-var">mkWpLet</span></a></span><span>  </span><span class="annot"><span class="annottext">TcEvBinds
</span><a href="#local-6989586621682058198"><span class="hs-identifier hs-var">ev_binds</span></a></span><span>
</span><span id="line-957"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsExpr GhcTc), TcSigmaType)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated SrcSpanAnnA (HsExpr GhcTc), TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058223"><span class="hs-identifier hs-var">poly_wrap</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058177"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058212"><span class="hs-identifier hs-var">my_sigma</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span>
</span><span id="line-960"></span><span class="hs-comment">{- Note [Partial expression signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Partial type signatures on expressions are easy to get wrong.  But
here is a guiding principle
    e :: ty
should behave like
    let x :: ty
        x = e
    in x

So for partial signatures we apply the MR if no context is given.  So
   e :: IO _          apply the MR
   e :: _ =&gt; IO _     do not apply the MR
just like in GHC.Tc.Gen.Bind.decideGeneralisationPlan

This makes a difference (#11670):
   peek :: Ptr a -&gt; IO CLong
   peek ptr = peekElemOff undefined 0 :: _
from (peekElemOff undefined 0) we get
          type: IO w
   constraints: Storable w

We must NOT try to generalise over 'w' because the signature specifies
no constraints so we'll complain about not being able to solve
Storable w.  Instead, don't generalise; then _ gets instantiated to
CLong, as it should.
-}</span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span>
</span><span id="line-989"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 Overloaded literals
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-994"></span><span>
</span><span id="line-995"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferOverLit"><span class="hs-identifier hs-type">tcInferOverLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-996"></span><span id="tcInferOverLit"><span class="annot"><span class="annottext">tcInferOverLit :: HsOverLit (GhcPass 'Renamed) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferOverLit"><span class="hs-identifier hs-var hs-var">tcInferOverLit</span></a></span></span><span> </span><span id="local-6989586621682058228"><span class="annot"><span class="annottext">lit :: HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621682058228"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#OverLit"><span class="hs-identifier hs-type">OverLit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ol_val :: forall p. HsOverLit p -&gt; OverLitVal
</span><a href="Language.Haskell.Syntax.Lit.html#ol_val"><span class="hs-identifier hs-var">ol_val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058231"><span class="annot"><span class="annottext">OverLitVal
</span><a href="#local-6989586621682058231"><span class="hs-identifier hs-var">val</span></a></span></span><span>
</span><span id="line-997"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ol_ext :: forall p. HsOverLit p -&gt; XOverLit p
</span><a href="Language.Haskell.Syntax.Lit.html#ol_ext"><span class="hs-identifier hs-var">ol_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Hs.Lit.html#OverLitRn"><span class="hs-identifier hs-type">OverLitRn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:ol_rebindable:OverLitRn :: OverLitRn -&gt; Bool
</span><a href="GHC.Hs.Lit.html#%24sel%3Aol_rebindable%3AOverLitRn"><span class="hs-identifier hs-var">ol_rebindable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058235"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682058235"><span class="hs-identifier hs-var">rebindable</span></a></span></span><span>
</span><span id="line-998"></span><span>                                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:ol_from_fun:OverLitRn :: OverLitRn -&gt; LIdP (GhcPass 'Renamed)
</span><a href="GHC.Hs.Lit.html#%24sel%3Aol_from_fun%3AOverLitRn"><span class="hs-identifier hs-var">ol_from_fun</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682058237"><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><a href="#local-6989586621682058237"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621682058238"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058238"><span class="hs-identifier hs-var">from_name</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Desugar &quot;3&quot; to (fromInteger (3 :: Integer))</span><span>
</span><span id="line-1000"></span><span>    </span><span class="hs-comment">--   where fromInteger is gotten by looking up from_name, and</span><span>
</span><span id="line-1001"></span><span>    </span><span class="hs-comment">--   the (3 :: Integer) is returned by mkOverLit</span><span>
</span><span id="line-1002"></span><span>    </span><span class="hs-comment">-- Ditto the string literal &quot;foo&quot; to (fromString (&quot;foo&quot; :: String))</span><span>
</span><span id="line-1003"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058239"><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621682058239"><span class="hs-identifier hs-var">hs_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OverLitVal -&gt; TcM (HsLit GhcTc)
</span><a href="GHC.Tc.Utils.Instantiate.html#mkOverLit"><span class="hs-identifier hs-var">mkOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">OverLitVal
</span><a href="#local-6989586621682058231"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-1004"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058241"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058241"><span class="hs-identifier hs-var">from_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM Var
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058238"><span class="hs-identifier hs-var">from_name</span></a></span><span>
</span><span id="line-1005"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058242"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058242"><span class="hs-identifier hs-var">wrap1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058243"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058243"><span class="hs-identifier hs-var">from_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtOrigin -&gt; TcSigmaType -&gt; TcM (HsWrapper, TcSigmaType)
</span><a href="GHC.Tc.Utils.Instantiate.html#topInstantiate"><span class="hs-identifier hs-var">topInstantiate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed) -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#LiteralOrigin"><span class="hs-identifier hs-var">LiteralOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621682058228"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058241"><span class="hs-identifier hs-var">from_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1006"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-1007"></span><span>           </span><span id="local-6989586621682058246"><span class="annot"><span class="annottext">thing :: TypedThing
</span><a href="#local-6989586621682058246"><span class="hs-identifier hs-var hs-var">thing</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TypedThing
</span><a href="GHC.Tc.Types.Origin.html#NameThing"><span class="hs-identifier hs-var">NameThing</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058238"><span class="hs-identifier hs-var">from_name</span></a></span><span>
</span><span id="line-1008"></span><span>           </span><span id="local-6989586621682058248"><span class="annot"><span class="annottext">mb_thing :: Maybe TypedThing
</span><a href="#local-6989586621682058248"><span class="hs-identifier hs-var hs-var">mb_thing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypedThing -&gt; Maybe TypedThing
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TypedThing
</span><a href="#local-6989586621682058246"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-1009"></span><span>           </span><span id="local-6989586621682058249"><span class="annot"><span class="annottext">herald :: ExpectedFunTyOrigin
</span><a href="#local-6989586621682058249"><span class="hs-identifier hs-var hs-var">herald</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypedThing -&gt; HsExpr GhcTc -&gt; ExpectedFunTyOrigin
forall (p :: Pass).
OutputableBndrId p =&gt;
TypedThing -&gt; HsExpr (GhcPass p) -&gt; ExpectedFunTyOrigin
</span><a href="GHC.Tc.Types.Origin.html#ExpectedFunTyArg"><span class="hs-identifier hs-var">ExpectedFunTyArg</span></a></span><span> </span><span class="annot"><span class="annottext">TypedThing
</span><a href="#local-6989586621682058246"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XLitE GhcTc -&gt; HsLit GhcTc -&gt; HsExpr GhcTc
forall p. XLitE p -&gt; HsLit p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a></span><span> </span><span class="annot"><span class="annottext">XLitE GhcTc
EpAnn NoEpAnns
forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621682058239"><span class="hs-identifier hs-var">hs_lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1010"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058252"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058252"><span class="hs-identifier hs-var">wrap2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058253"><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621682058253"><span class="hs-identifier hs-var">sarg_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058254"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058254"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExpectedFunTyOrigin
-&gt; Maybe TypedThing
-&gt; (ThLevel, [Scaled TcSigmaType])
-&gt; TcSigmaType
-&gt; TcM (HsWrapper, Scaled TcSigmaType, TcSigmaType)
</span><a href="GHC.Tc.Utils.Unify.html#matchActualFunTySigma"><span class="hs-identifier hs-var">matchActualFunTySigma</span></a></span><span> </span><span class="annot"><span class="annottext">ExpectedFunTyOrigin
</span><a href="#local-6989586621682058249"><span class="hs-identifier hs-var">herald</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TypedThing
</span><a href="#local-6989586621682058248"><span class="hs-identifier hs-var">mb_thing</span></a></span><span>
</span><span id="line-1011"></span><span>                                                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058243"><span class="hs-identifier hs-var">from_ty</span></a></span><span>
</span><span id="line-1012"></span><span>
</span><span id="line-1013"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058256"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682058256"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TypedThing -&gt; TcSigmaType -&gt; TcSigmaType -&gt; TcM Coercion
</span><a href="GHC.Tc.Utils.Unify.html#unifyType"><span class="hs-identifier hs-var">unifyType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TypedThing
</span><a href="#local-6989586621682058248"><span class="hs-identifier hs-var">mb_thing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLit GhcTc -&gt; TcSigmaType
forall (p :: Pass). HsLit (GhcPass p) -&gt; TcSigmaType
</span><a href="GHC.Hs.Syn.Type.html#hsLitType"><span class="hs-identifier hs-var">hsLitType</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621682058239"><span class="hs-identifier hs-var">hs_lit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled TcSigmaType -&gt; TcSigmaType
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621682058253"><span class="hs-identifier hs-var">sarg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1014"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058260"><span class="annot"><span class="annottext">lit_expr :: GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058260"><span class="hs-identifier hs-var hs-var">lit_expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
-&gt; HsExpr GhcTc -&gt; GenLocated SrcSpanAnnA (HsExpr GhcTc)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcAnn NameAnn -&gt; SrcSpanAnnA
forall a ann. SrcSpanAnn' a -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-var">l2l</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><a href="#local-6989586621682058237"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc -&gt; GenLocated SrcSpanAnnA (HsExpr GhcTc))
-&gt; HsExpr GhcTc -&gt; GenLocated SrcSpanAnnA (HsExpr GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrapCo"><span class="hs-identifier hs-var">mkHsWrapCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682058256"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc -&gt; HsExpr GhcTc) -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1015"></span><span>                        </span><span class="annot"><span class="annottext">XLitE GhcTc -&gt; HsLit GhcTc -&gt; HsExpr GhcTc
forall p. XLitE p -&gt; HsLit p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a></span><span> </span><span class="annot"><span class="annottext">XLitE GhcTc
EpAnn NoEpAnns
forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621682058239"><span class="hs-identifier hs-var">hs_lit</span></a></span><span>
</span><span id="line-1016"></span><span>             </span><span id="local-6989586621682058263"><span class="annot"><span class="annottext">from_expr :: HsExpr GhcTc
</span><a href="#local-6989586621682058263"><span class="hs-identifier hs-var hs-var">from_expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058252"><span class="hs-identifier hs-var">wrap2</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058242"><span class="hs-identifier hs-var">wrap1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc -&gt; HsExpr GhcTc) -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1017"></span><span>                         </span><span class="annot"><span class="annottext">XVar GhcTc -&gt; LIdP GhcTc -&gt; HsExpr GhcTc
forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcAnn NameAnn -&gt; Var -&gt; GenLocated (SrcAnn NameAnn) Var
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><a href="#local-6989586621682058237"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058241"><span class="hs-identifier hs-var">from_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1018"></span><span>             </span><span id="local-6989586621682058264"><span class="annot"><span class="annottext">witness :: HsExpr GhcTc
</span><a href="#local-6989586621682058264"><span class="hs-identifier hs-var hs-var">witness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XApp GhcTc -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc -&gt; HsExpr GhcTc
forall p. XApp p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp GhcTc
EpAnn NoEpAnns
forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA
-&gt; HsExpr GhcTc -&gt; GenLocated SrcSpanAnnA (HsExpr GhcTc)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcAnn NameAnn -&gt; SrcSpanAnnA
forall a ann. SrcSpanAnn' a -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-var">l2l</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><a href="#local-6989586621682058237"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058263"><span class="hs-identifier hs-var">from_expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621682058260"><span class="hs-identifier hs-var">lit_expr</span></a></span><span>
</span><span id="line-1019"></span><span>             </span><span id="local-6989586621682058265"><span class="annot"><span class="annottext">lit' :: HsOverLit GhcTc
</span><a href="#local-6989586621682058265"><span class="hs-identifier hs-var hs-var">lit'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621682058228"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#ol_ext"><span class="hs-identifier hs-var">ol_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Hs.Lit.html#OverLitTc"><span class="hs-identifier hs-type">OverLitTc</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Hs.Lit.html#%24sel%3Aol_rebindable%3AOverLitTc"><span class="hs-identifier hs-var">ol_rebindable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682058235"><span class="hs-identifier hs-type">rebindable</span></a></span><span>
</span><span id="line-1020"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Hs.Lit.html#%24sel%3Aol_witness%3AOverLitTc"><span class="hs-identifier hs-var">ol_witness</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682058264"><span class="hs-identifier hs-type">witness</span></a></span><span>
</span><span id="line-1021"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Hs.Lit.html#%24sel%3Aol_type%3AOverLitTc"><span class="hs-identifier hs-var">ol_type</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682058254"><span class="hs-identifier hs-type">res_ty</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1022"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOverLitE GhcTc -&gt; HsOverLit GhcTc -&gt; HsExpr GhcTc
forall p. XOverLitE p -&gt; HsOverLit p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLitE GhcTc
EpAnn NoEpAnns
forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621682058265"><span class="hs-identifier hs-var">lit'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058254"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 tcInferId, tcCheckId
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1029"></span><span>
</span><span id="line-1030"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcCheckId"><span class="hs-identifier hs-type">tcCheckId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpRhoType"><span class="hs-identifier hs-type">ExpRhoType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1031"></span><span id="tcCheckId"><span class="annot"><span class="annottext">tcCheckId :: Name -&gt; ExpRhoType -&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Head.html#tcCheckId"><span class="hs-identifier hs-var hs-var">tcCheckId</span></a></span></span><span> </span><span id="local-6989586621682058270"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058270"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682058271"><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621682058271"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-1032"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058272"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058272"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058273"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058273"><span class="hs-identifier hs-var">actual_res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier hs-var">tcInferId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058270"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1033"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcCheckId&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058270"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058273"><span class="hs-identifier hs-var">actual_res_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpRhoType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621682058271"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1034"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; TcSigmaType
-&gt; ExpRhoType
-&gt; TcM (HsExpr GhcTc)
-&gt; TcM (HsExpr GhcTc)
forall a.
HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; TcSigmaType
-&gt; ExpRhoType
-&gt; TcM a
-&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#addFunResCtxt"><span class="hs-identifier hs-var">addFunResCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058274"><span class="hs-identifier hs-var">rn_fun</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058273"><span class="hs-identifier hs-var">actual_res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621682058271"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM (HsExpr GhcTc) -&gt; TcM (HsExpr GhcTc))
-&gt; TcM (HsExpr GhcTc) -&gt; TcM (HsExpr GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1035"></span><span>         </span><span class="annot"><span class="annottext">CtOrigin
-&gt; HsExpr (GhcPass 'Renamed)
-&gt; HsExpr GhcTc
-&gt; TcSigmaType
-&gt; ExpRhoType
-&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Utils.Unify.html#tcWrapResultO"><span class="hs-identifier hs-var">tcWrapResultO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058270"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058274"><span class="hs-identifier hs-var">rn_fun</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058272"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058273"><span class="hs-identifier hs-var">actual_res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621682058271"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1036"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1037"></span><span>    </span><span id="local-6989586621682058274"><span class="annot"><span class="annottext">rn_fun :: HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058274"><span class="hs-identifier hs-var hs-var">rn_fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XVar (GhcPass 'Renamed)
-&gt; LIdP (GhcPass 'Renamed) -&gt; HsExpr (GhcPass 'Renamed)
forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar (GhcPass 'Renamed)
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; GenLocated (SrcAnn NameAnn) Name
forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058270"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-1040"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier hs-type">tcInferId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span class="hs-comment">-- Look up an occurrence of an Id</span><span>
</span><span id="line-1042"></span><span class="hs-comment">-- Do not instantiate its type</span><span>
</span><span id="line-1043"></span><span id="tcInferId"><span class="annot"><span class="annottext">tcInferId :: Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier hs-var hs-var">tcInferId</span></a></span></span><span> </span><span id="local-6989586621682058278"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058278"><span class="hs-identifier hs-var">id_name</span></a></span></span><span>
</span><span id="line-1044"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058278"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#assertIdKey"><span class="hs-identifier hs-var">assertIdKey</span></a></span><span>
</span><span id="line-1045"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058281"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682058281"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-1046"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_IgnoreAsserts"><span class="hs-identifier hs-var">Opt_IgnoreAsserts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682058281"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-1047"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_id"><span class="hs-identifier hs-var">tc_infer_id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058278"><span class="hs-identifier hs-var">id_name</span></a></span><span>
</span><span id="line-1048"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_assert"><span class="hs-identifier hs-var">tc_infer_assert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058278"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1051"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058287"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058287"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058288"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058288"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_id"><span class="hs-identifier hs-var">tc_infer_id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058278"><span class="hs-identifier hs-var">id_name</span></a></span><span>
</span><span id="line-1052"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcInferId&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058278"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058288"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1053"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058287"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058288"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1054"></span><span>
</span><span id="line-1055"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tc_infer_assert"><span class="hs-identifier hs-type">tc_infer_assert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1056"></span><span class="hs-comment">-- Deal with an occurrence of 'assert'</span><span>
</span><span id="line-1057"></span><span class="hs-comment">-- See Note [Adding the implicit parameter to 'assert']</span><span>
</span><span id="line-1058"></span><span id="tc_infer_assert"><span class="annot"><span class="annottext">tc_infer_assert :: Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_assert"><span class="hs-identifier hs-var hs-var">tc_infer_assert</span></a></span></span><span> </span><span id="local-6989586621682058289"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058289"><span class="hs-identifier hs-var">assert_name</span></a></span></span><span>
</span><span id="line-1059"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058290"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058290"><span class="hs-identifier hs-var">assert_error_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM Var
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#assertErrorName"><span class="hs-identifier hs-var">assertErrorName</span></a></span><span>
</span><span id="line-1060"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058292"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058292"><span class="hs-identifier hs-var">wrap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058293"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058293"><span class="hs-identifier hs-var">id_rho</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtOrigin -&gt; TcSigmaType -&gt; TcM (HsWrapper, TcSigmaType)
</span><a href="GHC.Tc.Utils.Instantiate.html#topInstantiate"><span class="hs-identifier hs-var">topInstantiate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058289"><span class="hs-identifier hs-var">assert_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1061"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058290"><span class="hs-identifier hs-var">assert_error_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1062"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621682058292"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XVar GhcTc -&gt; LIdP GhcTc -&gt; HsExpr GhcTc
forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; GenLocated (SrcAnn NameAnn) Var
forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058290"><span class="hs-identifier hs-var">assert_error_id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058293"><span class="hs-identifier hs-var">id_rho</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tc_infer_id"><span class="hs-identifier hs-type">tc_infer_id</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1066"></span><span id="tc_infer_id"><span class="annot"><span class="annottext">tc_infer_id :: Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_id"><span class="hs-identifier hs-var hs-var">tc_infer_id</span></a></span></span><span> </span><span id="local-6989586621682058294"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058294"><span class="hs-identifier hs-var">id_name</span></a></span></span><span>
</span><span id="line-1067"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058295"><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621682058295"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM TcTyThing
</span><a href="GHC.Tc.Utils.Env.html#tcLookup"><span class="hs-identifier hs-var">tcLookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058294"><span class="hs-identifier hs-var">id_name</span></a></span><span>
</span><span id="line-1068"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621682058295"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1069"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#ATcId"><span class="hs-identifier hs-type">ATcId</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tct_id :: TcTyThing -&gt; Var
</span><a href="GHC.Tc.Types.html#tct_id"><span class="hs-identifier hs-var">tct_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682058296"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058296"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1070"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_local_id"><span class="hs-identifier hs-var">check_local_id</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058296"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1071"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall {p} {an} {m :: * -&gt; *}.
(IdP p ~ Var, XVar p ~ NoExtField,
 XRec p Var ~ GenLocated (SrcAnn an) Var, Monad m) =&gt;
Var -&gt; m (HsExpr p, TcSigmaType)
</span><a href="#local-6989586621682058297"><span class="hs-identifier hs-var">return_id</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058296"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1072"></span><span>
</span><span id="line-1073"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#AGlobal"><span class="hs-identifier hs-type">AGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#AnId"><span class="hs-identifier hs-type">AnId</span></a></span><span> </span><span id="local-6989586621682058298"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058298"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall {p} {an} {m :: * -&gt; *}.
(IdP p ~ Var, XVar p ~ NoExtField,
 XRec p Var ~ GenLocated (SrcAnn an) Var, Monad m) =&gt;
Var -&gt; m (HsExpr p, TcSigmaType)
</span><a href="#local-6989586621682058297"><span class="hs-identifier hs-var">return_id</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058298"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1074"></span><span>               </span><span class="hs-comment">-- A global cannot possibly be ill-staged</span><span>
</span><span id="line-1075"></span><span>               </span><span class="hs-comment">-- nor does it need the 'lifting' treatment</span><span>
</span><span id="line-1076"></span><span>               </span><span class="hs-comment">-- Hence no checkTh stuff here</span><span>
</span><span id="line-1077"></span><span>
</span><span id="line-1078"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#AGlobal"><span class="hs-identifier hs-type">AGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#AConLike"><span class="hs-identifier hs-type">AConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span id="local-6989586621682058300"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058300"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferDataCon"><span class="hs-identifier hs-var">tcInferDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058300"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1079"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#AGlobal"><span class="hs-identifier hs-type">AGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#AConLike"><span class="hs-identifier hs-type">AConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#PatSynCon"><span class="hs-identifier hs-type">PatSynCon</span></a></span><span> </span><span id="local-6989586621682058303"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621682058303"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; PatSyn -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferPatSyn"><span class="hs-identifier hs-var">tcInferPatSyn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058294"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621682058303"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1080"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcTyThing -&gt; Maybe TyCon
</span><a href="GHC.Tc.Types.html#tcTyThingTyCon_maybe"><span class="hs-identifier hs-var">tcTyThingTyCon_maybe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682058306"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682058306"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058307"><span class="hs-identifier hs-var">fail_tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682058306"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-comment">-- TyCon or TcTyCon</span><span>
</span><span id="line-1081"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#ATyVar"><span class="hs-identifier hs-type">ATyVar</span></a></span><span> </span><span id="local-6989586621682058309"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058309"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058310"><span class="hs-identifier hs-var">fail_tyvar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058309"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1082"></span><span>
</span><span id="line-1083"></span><span>             </span><span class="annot"><span class="annottext">TcTyThing
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcM (HsExpr GhcTc, TcSigmaType))
-&gt; TcRnMessage -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TcTyThing -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnExpectedValueId"><span class="hs-identifier hs-var">TcRnExpectedValueId</span></a></span><span> </span><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621682058295"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1084"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1085"></span><span>    </span><span id="local-6989586621682058307"><span class="annot"><span class="annottext">fail_tycon :: TyCon -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058307"><span class="hs-identifier hs-var hs-var">fail_tycon</span></a></span></span><span> </span><span id="local-6989586621682058311"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682058311"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1086"></span><span>      </span><span id="local-6989586621682058312"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621682058312"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-1087"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058313"><span class="annot"><span class="annottext">nm :: Name
</span><a href="#local-6989586621682058313"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682058311"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1088"></span><span>          </span><span id="local-6989586621682058315"><span class="annot"><span class="annottext">pprov :: SDoc
</span><a href="#local-6989586621682058315"><span class="hs-identifier hs-var hs-var">pprov</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; Name -&gt; Maybe GlobalRdrElt
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621682058312"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058313"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1089"></span><span>                      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682058317"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621682058317"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; SDoc
</span><a href="GHC.Types.Name.Reader.html#pprNameProvenance"><span class="hs-identifier hs-var">pprNameProvenance</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621682058317"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span>                      </span><span class="annot"><span class="annottext">Maybe GlobalRdrElt
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-1091"></span><span>      </span><span class="annot"><span class="annottext">NameSpace -&gt; Name -&gt; SDoc -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058321"><span class="hs-identifier hs-var">fail_with_msg</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#dataName"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058313"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682058315"><span class="hs-identifier hs-var">pprov</span></a></span><span>
</span><span id="line-1092"></span><span>
</span><span id="line-1093"></span><span>    </span><span id="local-6989586621682058310"><span class="annot"><span class="annottext">fail_tyvar :: Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058310"><span class="hs-identifier hs-var hs-var">fail_tyvar</span></a></span></span><span> </span><span id="local-6989586621682058323"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058323"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1094"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058324"><span class="annot"><span class="annottext">pprov :: SDoc
</span><a href="#local-6989586621682058324"><span class="hs-identifier hs-var hs-var">pprov</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bound at&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058323"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1095"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; Name -&gt; SDoc -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058321"><span class="hs-identifier hs-var">fail_with_msg</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058323"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682058324"><span class="hs-identifier hs-var">pprov</span></a></span><span>
</span><span id="line-1096"></span><span>
</span><span id="line-1097"></span><span>    </span><span id="local-6989586621682058321"><span class="annot"><span class="annottext">fail_with_msg :: NameSpace -&gt; Name -&gt; SDoc -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621682058321"><span class="hs-identifier hs-var hs-var">fail_with_msg</span></a></span></span><span> </span><span id="local-6989586621682058327"><span class="annot"><span class="annottext">NameSpace
</span><a href="#local-6989586621682058327"><span class="hs-identifier hs-var">whatName</span></a></span></span><span> </span><span id="local-6989586621682058328"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058328"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621682058329"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682058329"><span class="hs-identifier hs-var">pprov</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1098"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682058330"><span class="annot"><span class="annottext">[ImportError]
</span><a href="#local-6989586621682058330"><span class="hs-identifier hs-var">import_errs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058331"><span class="annot"><span class="annottext">[GhcHint]
</span><a href="#local-6989586621682058331"><span class="hs-identifier hs-var">hints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameSpace
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ([ImportError], [GhcHint])
</span><a href="#local-6989586621682058332"><span class="hs-identifier hs-var">get_suggestions</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="#local-6989586621682058327"><span class="hs-identifier hs-var">whatName</span></a></span><span>
</span><span id="line-1099"></span><span>      </span><span id="local-6989586621682058333"><span class="annot"><span class="annottext">UnitState
</span><a href="#local-6989586621682058333"><span class="hs-identifier hs-var">unit_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; HscEnv -&gt; UnitState
HscEnv -&gt; UnitState
</span><a href="GHC.Driver.Env.html#hsc_units"><span class="hs-identifier hs-var">hsc_units</span></a></span><span> </span><span class="annot"><span class="annottext">(HscEnv -&gt; UnitState)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) HscEnv
-&gt; IOEnv (Env TcGblEnv TcLclEnv) UnitState
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) HscEnv
forall gbl lcl. TcRnIf gbl lcl HscEnv
</span><a href="GHC.Tc.Utils.Monad.html#getTopEnv"><span class="hs-identifier hs-var">getTopEnv</span></a></span><span>
</span><span id="line-1100"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-1101"></span><span>        </span><span class="hs-comment">-- TODO: unfortunate to have to convert to SDoc here.</span><span>
</span><span id="line-1102"></span><span>        </span><span class="hs-comment">-- This should go away once we refactor ErrInfo.</span><span>
</span><span id="line-1103"></span><span>        </span><span id="local-6989586621682058336"><span class="annot"><span class="annottext">hint_msg :: SDoc
</span><a href="#local-6989586621682058336"><span class="hs-identifier hs-var hs-var">hint_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(GhcHint -&gt; SDoc) -&gt; [GhcHint] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">GhcHint -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[GhcHint]
</span><a href="#local-6989586621682058331"><span class="hs-identifier hs-var">hints</span></a></span><span>
</span><span id="line-1104"></span><span>        </span><span id="local-6989586621682058337"><span class="annot"><span class="annottext">import_err_msg :: SDoc
</span><a href="#local-6989586621682058337"><span class="hs-identifier hs-var hs-var">import_err_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ImportError -&gt; SDoc) -&gt; [ImportError] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">ImportError -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportError]
</span><a href="#local-6989586621682058330"><span class="hs-identifier hs-var">import_errs</span></a></span><span>
</span><span id="line-1105"></span><span>        </span><span id="local-6989586621682058338"><span class="annot"><span class="annottext">info :: ErrInfo
</span><a href="#local-6989586621682058338"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ErrInfo"><span class="hs-identifier hs-type">ErrInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errInfoContext :: SDoc
</span><a href="GHC.Tc.Errors.Types.html#errInfoContext"><span class="hs-identifier hs-var">errInfoContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682058329"><span class="hs-identifier hs-var">pprov</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errInfoSupplementary :: SDoc
</span><a href="GHC.Tc.Errors.Types.html#errInfoSupplementary"><span class="hs-identifier hs-var">errInfoSupplementary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682058337"><span class="hs-identifier hs-var">import_err_msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682058336"><span class="hs-identifier hs-var">hint_msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1106"></span><span>      </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcM (HsExpr GhcTc, TcSigmaType))
-&gt; TcRnMessage -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UnitState -&gt; TcRnMessageDetailed -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnMessageWithInfo"><span class="hs-identifier hs-var">TcRnMessageWithInfo</span></a></span><span> </span><span class="annot"><span class="annottext">UnitState
</span><a href="#local-6989586621682058333"><span class="hs-identifier hs-var">unit_state</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-1107"></span><span>              </span><span class="annot"><span class="annottext">ErrInfo -&gt; TcRnMessage -&gt; TcRnMessageDetailed
</span><a href="GHC.Tc.Utils.Monad.html#mkDetailedMessage"><span class="hs-identifier hs-var">mkDetailedMessage</span></a></span><span> </span><span class="annot"><span class="annottext">ErrInfo
</span><a href="#local-6989586621682058338"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Bool -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIncorrectNameSpace"><span class="hs-identifier hs-var">TcRnIncorrectNameSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058328"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>
</span><span id="line-1109"></span><span>    </span><span id="local-6989586621682058332"><span class="annot"><span class="annottext">get_suggestions :: NameSpace
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ([ImportError], [GhcHint])
</span><a href="#local-6989586621682058332"><span class="hs-identifier hs-var hs-var">get_suggestions</span></a></span></span><span> </span><span id="local-6989586621682058345"><span class="annot"><span class="annottext">NameSpace
</span><a href="#local-6989586621682058345"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1110"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058346"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621682058346"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; FastString -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkOccNameFS"><span class="hs-identifier hs-var">mkOccNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="#local-6989586621682058345"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; OccName
forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058294"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1111"></span><span>       </span><span id="local-6989586621682058350"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682058350"><span class="hs-identifier hs-var">dflags</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-1112"></span><span>       </span><span id="local-6989586621682058351"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621682058351"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-1113"></span><span>       </span><span id="local-6989586621682058352"><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621682058352"><span class="hs-identifier hs-var">lcl_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RnM LocalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a></span><span>
</span><span id="line-1114"></span><span>       </span><span id="local-6989586621682058354"><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621682058354"><span class="hs-identifier hs-var">imp_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn ImportAvails
</span><a href="GHC.Tc.Utils.Monad.html#getImports"><span class="hs-identifier hs-var">getImports</span></a></span><span>
</span><span id="line-1115"></span><span>       </span><span id="local-6989586621682058356"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621682058356"><span class="hs-identifier hs-var">curr_mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) Module
forall (m :: * -&gt; *). HasModule m =&gt; m Module
</span><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a></span><span>
</span><span id="line-1116"></span><span>       </span><span id="local-6989586621682058357"><span class="annot"><span class="annottext">HomePackageTable
</span><a href="#local-6989586621682058357"><span class="hs-identifier hs-var">hpt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRnIf TcGblEnv TcLclEnv HomePackageTable
forall gbl lcl. TcRnIf gbl lcl HomePackageTable
</span><a href="GHC.Tc.Utils.Monad.html#getHpt"><span class="hs-identifier hs-var">getHpt</span></a></span><span>
</span><span id="line-1117"></span><span>       </span><span class="annot"><span class="annottext">([ImportError], [GhcHint])
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ([ImportError], [GhcHint])
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(([ImportError], [GhcHint])
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) ([ImportError], [GhcHint]))
-&gt; ([ImportError], [GhcHint])
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ([ImportError], [GhcHint])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WhatLooking
-&gt; DynFlags
-&gt; HomePackageTable
-&gt; Module
-&gt; GlobalRdrEnv
-&gt; LocalRdrEnv
-&gt; ImportAvails
-&gt; RdrName
-&gt; ([ImportError], [GhcHint])
</span><a href="GHC.Rename.Unbound.html#unknownNameSuggestions"><span class="hs-identifier hs-var">unknownNameSuggestions</span></a></span><span> </span><span class="annot"><span class="annottext">WhatLooking
</span><a href="GHC.Rename.Unbound.html#WL_Anything"><span class="hs-identifier hs-var">WL_Anything</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682058350"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HomePackageTable
</span><a href="#local-6989586621682058357"><span class="hs-identifier hs-var">hpt</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621682058356"><span class="hs-identifier hs-var">curr_mod</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621682058351"><span class="hs-identifier hs-var">rdr_env</span></a></span><span>
</span><span id="line-1118"></span><span>         </span><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621682058352"><span class="hs-identifier hs-var">lcl_env</span></a></span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621682058354"><span class="hs-identifier hs-var">imp_info</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; RdrName
</span><a href="GHC.Types.Name.Reader.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621682058346"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1119"></span><span>
</span><span id="line-1120"></span><span>    </span><span id="local-6989586621682058297"><span class="annot"><span class="annottext">return_id :: Var -&gt; m (HsExpr p, TcSigmaType)
</span><a href="#local-6989586621682058297"><span class="hs-identifier hs-var hs-var">return_id</span></a></span></span><span> </span><span id="local-6989586621682058375"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058375"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsExpr p, TcSigmaType) -&gt; m (HsExpr p, TcSigmaType)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XVar p -&gt; LIdP p -&gt; HsExpr p
forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar p
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; GenLocated (SrcAnn an) Var
forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058375"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058375"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1121"></span><span>
</span><span id="line-1122"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#check_local_id"><span class="hs-identifier hs-type">check_local_id</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span id="check_local_id"><span class="annot"><span class="annottext">check_local_id :: Var -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_local_id"><span class="hs-identifier hs-var hs-var">check_local_id</span></a></span></span><span> </span><span id="local-6989586621682058377"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058377"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-1124"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#checkThLocalId"><span class="hs-identifier hs-var">checkThLocalId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058377"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1125"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#tcEmitBindingUsage"><span class="hs-identifier hs-var">tcEmitBindingUsage</span></a></span><span> </span><span class="annot"><span class="annottext">(UsageEnv -&gt; TcM ()) -&gt; UsageEnv -&gt; TcM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcSigmaType -&gt; UsageEnv
forall n. NamedThing n =&gt; n -&gt; TcSigmaType -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#unitUE"><span class="hs-identifier hs-var">unitUE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058377"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="GHC.Core.Type.html#OneTy"><span class="hs-identifier hs-var">OneTy</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1126"></span><span>
</span><span id="line-1127"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#check_naughty"><span class="hs-identifier hs-type">check_naughty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span id="check_naughty"><span class="annot"><span class="annottext">check_naughty :: OccName -&gt; Var -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_naughty"><span class="hs-identifier hs-var hs-var">check_naughty</span></a></span></span><span> </span><span id="local-6989586621682058381"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621682058381"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682058382"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058382"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-1129"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Id.html#isNaughtyRecordSelector"><span class="hs-identifier hs-var">isNaughtyRecordSelector</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058382"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcM ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnRecSelectorEscapedTyVar"><span class="hs-identifier hs-var">TcRnRecSelectorEscapedTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621682058381"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1131"></span><span>
</span><span id="line-1132"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferDataCon"><span class="hs-identifier hs-type">tcInferDataCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span class="hs-comment">-- See Note [Typechecking data constructors]</span><span>
</span><span id="line-1134"></span><span id="tcInferDataCon"><span class="annot"><span class="annottext">tcInferDataCon :: DataCon -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferDataCon"><span class="hs-identifier hs-var hs-var">tcInferDataCon</span></a></span></span><span> </span><span id="local-6989586621682058385"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058385"><span class="hs-identifier hs-var">con</span></a></span></span><span>
</span><span id="line-1135"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058386"><span class="annot"><span class="annottext">tvbs :: [InvisTVBinder]
</span><a href="#local-6989586621682058386"><span class="hs-identifier hs-var hs-var">tvbs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [InvisTVBinder]
</span><a href="GHC.Core.DataCon.html#dataConUserTyVarBinders"><span class="hs-identifier hs-var">dataConUserTyVarBinders</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058385"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1136"></span><span>             </span><span id="local-6989586621682058388"><span class="annot"><span class="annottext">tvs :: [Var]
</span><a href="#local-6989586621682058388"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; [Var]
forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621682058386"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1137"></span><span>             </span><span id="local-6989586621682058390"><span class="annot"><span class="annottext">theta :: [TcSigmaType]
</span><a href="#local-6989586621682058390"><span class="hs-identifier hs-var hs-var">theta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [TcSigmaType]
</span><a href="GHC.Core.DataCon.html#dataConOtherTheta"><span class="hs-identifier hs-var">dataConOtherTheta</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058385"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1138"></span><span>             </span><span id="local-6989586621682058392"><span class="annot"><span class="annottext">args :: [Scaled TcSigmaType]
</span><a href="#local-6989586621682058392"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Scaled TcSigmaType]
</span><a href="GHC.Core.DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058385"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1139"></span><span>             </span><span id="local-6989586621682058394"><span class="annot"><span class="annottext">res :: TcSigmaType
</span><a href="#local-6989586621682058394"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; TcSigmaType
</span><a href="GHC.Core.DataCon.html#dataConOrigResTy"><span class="hs-identifier hs-var">dataConOrigResTy</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058385"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1140"></span><span>             </span><span id="local-6989586621682058396"><span class="annot"><span class="annottext">stupid_theta :: [TcSigmaType]
</span><a href="#local-6989586621682058396"><span class="hs-identifier hs-var hs-var">stupid_theta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [TcSigmaType]
</span><a href="GHC.Core.DataCon.html#dataConStupidTheta"><span class="hs-identifier hs-var">dataConStupidTheta</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058385"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1141"></span><span>
</span><span id="line-1142"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058397"><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058397"><span class="hs-identifier hs-var">scaled_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Scaled TcSigmaType
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Scaled TcSigmaType))
-&gt; [Scaled TcSigmaType]
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [Scaled TcSigmaType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Scaled TcSigmaType)
</span><a href="#local-6989586621682058398"><span class="hs-identifier hs-var">linear_to_poly</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058392"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1143"></span><span>
</span><span id="line-1144"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058399"><span class="annot"><span class="annottext">full_theta :: [TcSigmaType]
</span><a href="#local-6989586621682058399"><span class="hs-identifier hs-var hs-var">full_theta</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058396"><span class="hs-identifier hs-var">stupid_theta</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType] -&gt; [TcSigmaType] -&gt; [TcSigmaType]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058390"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-1145"></span><span>             </span><span id="local-6989586621682058400"><span class="annot"><span class="annottext">all_arg_tys :: [Scaled TcSigmaType]
</span><a href="#local-6989586621682058400"><span class="hs-identifier hs-var hs-var">all_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TcSigmaType -&gt; Scaled TcSigmaType)
-&gt; [TcSigmaType] -&gt; [Scaled TcSigmaType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Scaled TcSigmaType
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var">unrestricted</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058399"><span class="hs-identifier hs-var">full_theta</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
-&gt; [Scaled TcSigmaType] -&gt; [Scaled TcSigmaType]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058397"><span class="hs-identifier hs-var">scaled_arg_tys</span></a></span><span>
</span><span id="line-1146"></span><span>                </span><span class="hs-comment">-- We are building the type of the data con wrapper, so the</span><span>
</span><span id="line-1147"></span><span>                </span><span class="hs-comment">-- type must precisely match the construction in</span><span>
</span><span id="line-1148"></span><span>                </span><span class="hs-comment">-- GHC.Core.DataCon.dataConWrapperType.</span><span>
</span><span id="line-1149"></span><span>                </span><span class="hs-comment">-- See Note [Instantiating stupid theta]</span><span>
</span><span id="line-1150"></span><span>                </span><span class="hs-comment">-- in GHC.Core.DataCon.</span><span>
</span><span id="line-1151"></span><span>
</span><span id="line-1152"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">XXExpr GhcTc -&gt; HsExpr GhcTc
forall p. XXExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-var">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConLike -&gt; [Var] -&gt; [Scaled TcSigmaType] -&gt; XXExprGhcTc
</span><a href="GHC.Hs.Expr.html#ConLikeTc"><span class="hs-identifier hs-var">ConLikeTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; ConLike
</span><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682058385"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682058388"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058400"><span class="hs-identifier hs-var">all_arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1153"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621682058386"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">(TcSigmaType -&gt; TcSigmaType) -&gt; TcSigmaType -&gt; TcSigmaType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
(() :: Constraint) =&gt; [TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier hs-var">mkPhiTy</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621682058399"><span class="hs-identifier hs-var">full_theta</span></a></span><span> </span><span class="annot"><span class="annottext">(TcSigmaType -&gt; TcSigmaType) -&gt; TcSigmaType -&gt; TcSigmaType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1154"></span><span>                  </span><span class="annot"><span class="annottext">[Scaled TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
(() :: Constraint) =&gt;
[Scaled TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Rep.html#mkScaledFunTys"><span class="hs-identifier hs-var">mkScaledFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058397"><span class="hs-identifier hs-var">scaled_arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058394"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1156"></span><span>    </span><span class="annot"><a href="#local-6989586621682058398"><span class="hs-identifier hs-type">linear_to_poly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span>    </span><span class="hs-comment">-- linear_to_poly implements point (3,4)</span><span>
</span><span id="line-1158"></span><span>    </span><span class="hs-comment">-- of Note [Typechecking data constructors]</span><span>
</span><span id="line-1159"></span><span>    </span><span id="local-6989586621682058398"><span class="annot"><span class="annottext">linear_to_poly :: Scaled TcSigmaType
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Scaled TcSigmaType)
</span><a href="#local-6989586621682058398"><span class="hs-identifier hs-var hs-var">linear_to_poly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="GHC.Core.Type.html#OneTy"><span class="hs-identifier hs-var">OneTy</span></a></span><span> </span><span id="local-6989586621682058403"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058403"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058404"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058404"><span class="hs-identifier hs-var">mul_var</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#newFlexiTyVarTy"><span class="hs-identifier hs-var">newFlexiTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="GHC.Builtin.Types.html#multiplicityTy"><span class="hs-identifier hs-var">multiplicityTy</span></a></span><span>
</span><span id="line-1160"></span><span>                                          </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Scaled TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcSigmaType -&gt; Scaled TcSigmaType
forall a. TcSigmaType -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058404"><span class="hs-identifier hs-var">mul_var</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058403"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1161"></span><span>    </span><span class="annot"><a href="#local-6989586621682058398"><span class="hs-identifier hs-var">linear_to_poly</span></a></span><span> </span><span id="local-6989586621682058406"><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621682058406"><span class="hs-identifier hs-var">scaled_ty</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Scaled TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621682058406"><span class="hs-identifier hs-var">scaled_ty</span></a></span><span>
</span><span id="line-1162"></span><span>
</span><span id="line-1163"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferPatSyn"><span class="hs-identifier hs-type">tcInferPatSyn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1164"></span><span id="tcInferPatSyn"><span class="annot"><span class="annottext">tcInferPatSyn :: Name -&gt; PatSyn -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferPatSyn"><span class="hs-identifier hs-var hs-var">tcInferPatSyn</span></a></span></span><span> </span><span id="local-6989586621682058407"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058407"><span class="hs-identifier hs-var">id_name</span></a></span></span><span> </span><span id="local-6989586621682058408"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621682058408"><span class="hs-identifier hs-var">ps</span></a></span></span><span>
</span><span id="line-1165"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PatSyn -&gt; Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.TyCl.PatSyn.html#patSynBuilderOcc"><span class="hs-identifier hs-var">patSynBuilderOcc</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621682058408"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1166"></span><span>       </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058409"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058409"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682058410"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058410"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, TcSigmaType) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058409"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058410"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1167"></span><span>       </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcM (HsExpr GhcTc, TcSigmaType)
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; TcRnMessage
</span><a href="GHC.Tc.Gen.Head.html#nonBidirectionalErr"><span class="hs-identifier hs-var">nonBidirectionalErr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058407"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#nonBidirectionalErr"><span class="hs-identifier hs-type">nonBidirectionalErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span>
</span><span id="line-1170"></span><span id="nonBidirectionalErr"><span class="annot"><span class="annottext">nonBidirectionalErr :: Name -&gt; TcRnMessage
</span><a href="GHC.Tc.Gen.Head.html#nonBidirectionalErr"><span class="hs-identifier hs-var hs-var">nonBidirectionalErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnPatSynNotBidirectional"><span class="hs-identifier hs-var">TcRnPatSynNotBidirectional</span></a></span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span class="hs-comment">{- Note [Adding the implicit parameter to 'assert']
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The typechecker transforms (assert e1 e2) to (assertError e1 e2).
This isn't really the Right Thing because there's no way to &quot;undo&quot;
if you want to see the original source code in the typechecker
output.  We'll have fix this in due course, when we care more about
being able to reconstruct the exact original program.

Note [Typechecking data constructors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As per Note [Polymorphisation of linear fields] in
GHC.Core.Multiplicity, linear fields of data constructors get a
polymorphic multiplicity when the data constructor is used as a term:

    Just :: forall {p} a. a %p -&gt; Maybe a

So at an occurrence of a data constructor we do the following:

1. Typechecking, in tcInferDataCon.

  a. Get the original type of the constructor, say
     K :: forall (r :: RuntimeRep) (a :: TYPE r). a %1 -&gt; T r a
     Note the %1: it is linear

  b. We are going to return a ConLikeTc, thus:
     XExpr (ConLikeTc K [r,a] [Scaled p a])
      :: forall (r :: RuntimeRep) (a :: TYPE r). a %p -&gt; T r a
   where 'p' is a fresh multiplicity unification variable.

   To get the returned ConLikeTc, we allocate a fresh multiplicity
   variable for each linear argument, and store the type, scaled by
   the fresh multiplicity variable in the ConLikeTc; along with
   the type of the ConLikeTc. This is done by linear_to_poly.

   If the argument is not linear (perhaps explicitly declared as
   non-linear by the user), don't bother with this.

2. Desugaring, in dsConLike.

  a. The (ConLikeTc K [r,a] [Scaled p a]) is desugared to
     (/\r (a :: TYPE r). \(x %p :: a). K @r @a x)
   which has the desired type given in the previous bullet.

   The 'p' is the multiplicity unification variable, which
   will by now have been unified to something, or defaulted in
   `GHC.Tc.Utils.Zonk.commitFlexi`. So it won't just be an
   (unbound) variable.

   So a saturated application (K e), where e::Int will desugar to
     (/\r (a :: TYPE r). ..etc..)
        @LiftedRep @Int e
   and all those lambdas will beta-reduce away in the simple optimiser
   (see Wrinkle [Representation-polymorphic lambdas] below).

   But for an /unsaturated/ application, such as `map (K @LiftedRep @Int) xs`,
   beta reduction will leave (\x %Many :: Int. K x), which is the type `map`
   expects whereas if we had just plain K, with its linear type, we'd
   get a type mismatch. That's why we do this funky desugaring.

Wrinkles

  [ConLikeTc arguments]

    Note that the [TcType] argument to ConLikeTc is strictly redundant; those are
    the type variables from the dataConUserTyVarBinders of the data constructor.
    Similarly in the [Scaled TcType] field of ConLikeTc, the types come directly
    from the data constructor.  The only bit that /isn't/ redundant is the
    fresh multiplicity variables!

    So an alternative would be to define ConLikeTc like this:
        | ConLikeTc [TcType]    -- Just the multiplicity variables
    But then the desugarer would need to repeat some of the work done here.
    So for now at least ConLikeTc records this strictly-redundant info.

  [Representation-polymorphic lambdas]

    The lambda expression we produce in (4) can have representation-polymorphic
    arguments, as indeed in (/\r (a :: TYPE r). \(x %p :: a). K @r @a x),
    we have a lambda-bound variable x :: (a :: TYPE r).
    This goes against the representation polymorphism invariants given in
    Note [Representation polymorphism invariants] in GHC.Core. The trick is that
    this this lambda will always be instantiated in a way that upholds the invariants.
    This is achieved as follows:

      A. Any arguments to such lambda abstractions are guaranteed to have
         a fixed runtime representation. This is enforced in 'tcApp' by
         'matchActualFunTySigma'.

      B. If there are fewer arguments than there are bound term variables,
         hasFixedRuntimeRep_remainingValArgs will ensure that we are still
         instantiating at a representation-monomorphic type, e.g.

         ( /\r (a :: TYPE r). \ (x %p :: a). K @r @a x) @IntRep @Int#
           :: Int# -&gt; T IntRep Int#

      C. In the output of the desugarer in (4) above, we have a representation
         polymorphic lambda, which Lint would normally reject. So for that one
         pass, we switch off Lint's representation-polymorphism checks; see
         the `lf_check_fixed_rep` flag in `LintFlags`.
-}</span><span>
</span><span id="line-1272"></span><span>
</span><span id="line-1273"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                 Template Haskell checks
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1280"></span><span>
</span><span id="line-1281"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#checkThLocalId"><span class="hs-identifier hs-type">checkThLocalId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- The renamer has already done checkWellStaged,</span><span>
</span><span id="line-1283"></span><span class="hs-comment">--   in RnSplice.checkThLocalName, so don't repeat that here.</span><span>
</span><span id="line-1284"></span><span class="hs-comment">-- Here we just add constraints for cross-stage lifting</span><span>
</span><span id="line-1285"></span><span id="checkThLocalId"><span class="annot"><span class="annottext">checkThLocalId :: Var -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#checkThLocalId"><span class="hs-identifier hs-var hs-var">checkThLocalId</span></a></span></span><span> </span><span id="local-6989586621682058412"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058412"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-1286"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058413"><span class="annot"><span class="annottext">Maybe (TopLevelFlag, ThLevel, ThStage)
</span><a href="#local-6989586621682058413"><span class="hs-identifier hs-var">mb_local_use</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcRn (Maybe (TopLevelFlag, ThLevel, ThStage))
</span><a href="GHC.Tc.Utils.Monad.html#getStageAndBindLevel"><span class="hs-identifier hs-var">getStageAndBindLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058412"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1287"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (TopLevelFlag, ThLevel, ThStage)
</span><a href="#local-6989586621682058413"><span class="hs-identifier hs-var">mb_local_use</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1288"></span><span>             </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058415"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682058415"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058416"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682058416"><span class="hs-identifier hs-var">bind_lvl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058417"><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621682058417"><span class="hs-identifier hs-var">use_stage</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1289"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ThStage -&gt; ThLevel
</span><a href="GHC.Tc.Types.html#thLevel"><span class="hs-identifier hs-var">thLevel</span></a></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621682058417"><span class="hs-identifier hs-var">use_stage</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682058416"><span class="hs-identifier hs-var">bind_lvl</span></a></span><span>
</span><span id="line-1290"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Var -&gt; ThStage -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#checkCrossStageLifting"><span class="hs-identifier hs-var">checkCrossStageLifting</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682058415"><span class="hs-identifier hs-var">top_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058412"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621682058417"><span class="hs-identifier hs-var">use_stage</span></a></span><span>
</span><span id="line-1291"></span><span>             </span><span class="annot"><span class="annottext">Maybe (TopLevelFlag, ThLevel, ThStage)
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Not a locally-bound thing, or</span><span>
</span><span id="line-1292"></span><span>                               </span><span class="hs-comment">-- no cross-stage link</span><span>
</span><span id="line-1293"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-1294"></span><span>
</span><span id="line-1295"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-1296"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#checkCrossStageLifting"><span class="hs-identifier hs-type">checkCrossStageLifting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1297"></span><span class="hs-comment">-- If we are inside typed brackets, and (use_lvl &gt; bind_lvl)</span><span>
</span><span id="line-1298"></span><span class="hs-comment">-- we must check whether there's a cross-stage lift to do</span><span>
</span><span id="line-1299"></span><span class="hs-comment">-- Examples   \x -&gt; [|| x ||]</span><span>
</span><span id="line-1300"></span><span class="hs-comment">--            [|| map ||]</span><span>
</span><span id="line-1301"></span><span class="hs-comment">--</span><span>
</span><span id="line-1302"></span><span class="hs-comment">-- This is similar to checkCrossStageLifting in GHC.Rename.Splice, but</span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- this code is applied to *typed* brackets.</span><span>
</span><span id="line-1304"></span><span>
</span><span id="line-1305"></span><span id="checkCrossStageLifting"><span class="annot"><span class="annottext">checkCrossStageLifting :: TopLevelFlag -&gt; Var -&gt; ThStage -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#checkCrossStageLifting"><span class="hs-identifier hs-var hs-var">checkCrossStageLifting</span></a></span></span><span> </span><span id="local-6989586621682058420"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682058420"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span> </span><span id="local-6989586621682058421"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058421"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#Brack"><span class="hs-identifier hs-type">Brack</span></a></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TcPending"><span class="hs-identifier hs-type">TcPending</span></a></span><span> </span><span id="local-6989586621682058424"><span class="annot"><span class="annottext">TcRef [PendingTcSplice]
</span><a href="#local-6989586621682058424"><span class="hs-identifier hs-var">ps_var</span></a></span></span><span> </span><span id="local-6989586621682058425"><span class="annot"><span class="annottext">TcRef WantedConstraints
</span><a href="#local-6989586621682058425"><span class="hs-identifier hs-var">lie_var</span></a></span></span><span> </span><span id="local-6989586621682058426"><span class="annot"><span class="annottext">QuoteWrapper
</span><a href="#local-6989586621682058426"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1306"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Bool
</span><a href="GHC.Types.Basic.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682058420"><span class="hs-identifier hs-var">top_lvl</span></a></span><span>
</span><span id="line-1307"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcM () -&gt; TcM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058430"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#keepAlive"><span class="hs-identifier hs-var">keepAlive</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058430"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1308"></span><span>    </span><span class="hs-comment">-- See Note [Keeping things alive for Template Haskell] in GHC.Rename.Splice</span><span>
</span><span id="line-1309"></span><span>
</span><span id="line-1310"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1311"></span><span>  </span><span class="hs-glyph">=</span><span>     </span><span class="hs-comment">-- Nested identifiers, such as 'x' in</span><span>
</span><span id="line-1312"></span><span>        </span><span class="hs-comment">-- E.g. \x -&gt; [|| h x ||]</span><span>
</span><span id="line-1313"></span><span>        </span><span class="hs-comment">-- We must behave as if the reference to x was</span><span>
</span><span id="line-1314"></span><span>        </span><span class="hs-comment">--      h $(lift x)</span><span>
</span><span id="line-1315"></span><span>        </span><span class="hs-comment">-- We use 'x' itself as the splice proxy, used by</span><span>
</span><span id="line-1316"></span><span>        </span><span class="hs-comment">-- the desugarer to stitch it all back together.</span><span>
</span><span id="line-1317"></span><span>        </span><span class="hs-comment">-- If 'x' occurs many times we may get many identical</span><span>
</span><span id="line-1318"></span><span>        </span><span class="hs-comment">-- bindings of the same splice proxy, but that doesn't</span><span>
</span><span id="line-1319"></span><span>        </span><span class="hs-comment">-- matter, although it's a mite untidy.</span><span>
</span><span id="line-1320"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058432"><span class="annot"><span class="annottext">id_ty :: TcSigmaType
</span><a href="#local-6989586621682058432"><span class="hs-identifier hs-var hs-var">id_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058421"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1321"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRnMessage -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#checkTc"><span class="hs-identifier hs-var">checkTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058432"><span class="hs-identifier hs-var">id_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnSplicePolymorphicLocalVar"><span class="hs-identifier hs-var">TcRnSplicePolymorphicLocalVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058421"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1322"></span><span>               </span><span class="hs-comment">-- If x is polymorphic, its occurrence sites might</span><span>
</span><span id="line-1323"></span><span>               </span><span class="hs-comment">-- have different instantiations, so we can't use plain</span><span>
</span><span id="line-1324"></span><span>               </span><span class="hs-comment">-- 'x' as the splice proxy name.  I don't know how to</span><span>
</span><span id="line-1325"></span><span>               </span><span class="hs-comment">-- solve this, and it's probably unimportant, so I'm</span><span>
</span><span id="line-1326"></span><span>               </span><span class="hs-comment">-- just going to flag an error for now</span><span>
</span><span id="line-1327"></span><span>
</span><span id="line-1328"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058436"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058436"><span class="hs-identifier hs-var">lift</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier hs-var">isStringTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058432"><span class="hs-identifier hs-var">id_ty</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-1329"></span><span>                     </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058438"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058438"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM Var
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.TH.html#liftStringName"><span class="hs-identifier hs-var">GHC.Builtin.Names.TH.liftStringName</span></a></span><span>
</span><span id="line-1330"></span><span>                                     </span><span class="hs-comment">-- See Note [Lifting strings]</span><span>
</span><span id="line-1331"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; TcM (HsExpr GhcTc)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XVar GhcTc -&gt; LIdP GhcTc -&gt; HsExpr GhcTc
forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; GenLocated (SrcAnn NameAnn) Var
forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058438"><span class="hs-identifier hs-var">sid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1332"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-1333"></span><span>                     </span><span class="annot"><span class="annottext">TcRef WantedConstraints -&gt; TcM (HsExpr GhcTc) -&gt; TcM (HsExpr GhcTc)
forall a. TcRef WantedConstraints -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#setConstraintVar"><span class="hs-identifier hs-var">setConstraintVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcRef WantedConstraints
</span><a href="#local-6989586621682058425"><span class="hs-identifier hs-var">lie_var</span></a></span><span>   </span><span class="annot"><span class="annottext">(TcM (HsExpr GhcTc) -&gt; TcM (HsExpr GhcTc))
-&gt; TcM (HsExpr GhcTc) -&gt; TcM (HsExpr GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1334"></span><span>                          </span><span class="hs-comment">-- Put the 'lift' constraint into the right LIE</span><span>
</span><span id="line-1335"></span><span>                     </span><span class="annot"><span class="annottext">CtOrigin -&gt; Name -&gt; [TcSigmaType] -&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Utils.Instantiate.html#newMethodFromName"><span class="hs-identifier hs-var">newMethodFromName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058430"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1336"></span><span>                                       </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.TH.html#liftName"><span class="hs-identifier hs-var">GHC.Builtin.Names.TH.liftName</span></a></span><span>
</span><span id="line-1337"></span><span>                                       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; TcSigmaType -&gt; TcSigmaType
TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058432"><span class="hs-identifier hs-var">id_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058432"><span class="hs-identifier hs-var">id_ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1338"></span><span>
</span><span id="line-1339"></span><span>                   </span><span class="hs-comment">-- Warning for implicit lift (#17804)</span><span>
</span><span id="line-1340"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(ErrInfo -&gt; TcRnMessage) -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#addDetailedDiagnostic"><span class="hs-identifier hs-var">addDetailedDiagnostic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; ErrInfo -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnImplicitLift"><span class="hs-identifier hs-var">TcRnImplicitLift</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; ErrInfo -&gt; TcRnMessage) -&gt; Name -&gt; ErrInfo -&gt; TcRnMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058421"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1341"></span><span>
</span><span id="line-1342"></span><span>                   </span><span class="hs-comment">-- Update the pending splices</span><span>
</span><span id="line-1343"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058444"><span class="annot"><span class="annottext">[PendingTcSplice]
</span><a href="#local-6989586621682058444"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRef [PendingTcSplice]
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [PendingTcSplice]
forall a env. IORef a -&gt; IOEnv env a
</span><a href="GHC.Data.IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcRef [PendingTcSplice]
</span><a href="#local-6989586621682058424"><span class="hs-identifier hs-var">ps_var</span></a></span><span>
</span><span id="line-1344"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682058446"><span class="annot"><span class="annottext">pending_splice :: PendingTcSplice
</span><a href="#local-6989586621682058446"><span class="hs-identifier hs-var hs-var">pending_splice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; LHsExpr GhcTc -&gt; PendingTcSplice
</span><a href="GHC.Hs.Expr.html#PendingTcSplice"><span class="hs-identifier hs-var">PendingTcSplice</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682058430"><span class="hs-identifier hs-var">id_name</span></a></span><span>
</span><span id="line-1345"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc
forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QuoteWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#applyQuoteWrapper"><span class="hs-identifier hs-var">applyQuoteWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">QuoteWrapper
</span><a href="#local-6989586621682058426"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; GenLocated SrcSpanAnnA (HsExpr GhcTc)
forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621682058436"><span class="hs-identifier hs-var">lift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1346"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdP GhcTc -&gt; LHsExpr GhcTc
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcTc
Var
</span><a href="#local-6989586621682058421"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1347"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TcRef [PendingTcSplice] -&gt; [PendingTcSplice] -&gt; TcM ()
forall a env. IORef a -&gt; a -&gt; IOEnv env ()
</span><a href="GHC.Data.IOEnv.html#writeMutVar"><span class="hs-identifier hs-var">writeMutVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcRef [PendingTcSplice]
</span><a href="#local-6989586621682058424"><span class="hs-identifier hs-var">ps_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PendingTcSplice
</span><a href="#local-6989586621682058446"><span class="hs-identifier hs-var">pending_splice</span></a></span><span> </span><span class="annot"><span class="annottext">PendingTcSplice -&gt; [PendingTcSplice] -&gt; [PendingTcSplice]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PendingTcSplice]
</span><a href="#local-6989586621682058444"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1348"></span><span>
</span><span id="line-1349"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1350"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1351"></span><span>    </span><span id="local-6989586621682058430"><span class="annot"><span class="annottext">id_name :: Name
</span><a href="#local-6989586621682058430"><span class="hs-identifier hs-var hs-var">id_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682058421"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1352"></span><span>
</span><span id="line-1353"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#checkCrossStageLifting"><span class="hs-identifier hs-var">checkCrossStageLifting</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcM ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1354"></span><span>
</span><span id="line-1355"></span><span class="hs-comment">{-
Note [Lifting strings]
~~~~~~~~~~~~~~~~~~~~~~
If we see $(... [| s |] ...) where s::String, we don't want to
generate a mass of Cons (CharL 'x') (Cons (CharL 'y') ...)) etc.
So this conditional short-circuits the lifting mechanism to generate
(liftString &quot;xy&quot;) in that case.  I didn't want to use overlapping instances
for the Lift class in TH.Syntax, because that can lead to overlapping-instance
errors in a polymorphic situation.

If this check fails (which isn't impossible) we get another chance; see
Note [Converting strings] in Convert.hs

Note [Local record selectors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Record selectors for TyCons in this module are ordinary local bindings,
which show up as ATcIds rather than AGlobals.  So we need to check for
naughtiness in both branches.  c.f. GHC.Tc.TyCl.Utils.mkRecSelBinds.
-}</span><span>
</span><span id="line-1374"></span><span>
</span><span id="line-1375"></span><span>
</span><span id="line-1376"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
         Error reporting for function result mis-matches
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1381"></span><span>
</span><span id="line-1382"></span><span id="local-6989586621682057333"><span class="annot"><a href="GHC.Tc.Gen.Head.html#addFunResCtxt"><span class="hs-identifier hs-type">addFunResCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1383"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpRhoType"><span class="hs-identifier hs-type">ExpRhoType</span></a></span><span>
</span><span id="line-1384"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057333"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1385"></span><span class="hs-comment">-- When we have a mis-match in the return type of a function</span><span>
</span><span id="line-1386"></span><span class="hs-comment">-- try to give a helpful message about too many/few arguments</span><span>
</span><span id="line-1387"></span><span class="hs-comment">-- But not in generated code, where we don't want</span><span>
</span><span id="line-1388"></span><span class="hs-comment">-- to mention internal (rebindable syntax) function names</span><span>
</span><span id="line-1389"></span><span id="addFunResCtxt"><span class="annot"><span class="annottext">addFunResCtxt :: forall a.
HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; TcSigmaType
-&gt; ExpRhoType
-&gt; TcM a
-&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#addFunResCtxt"><span class="hs-identifier hs-var hs-var">addFunResCtxt</span></a></span></span><span> </span><span id="local-6989586621682058480"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058480"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682058481"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682058481"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682058482"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058482"><span class="hs-identifier hs-var">fun_res_ty</span></a></span></span><span> </span><span id="local-6989586621682058483"><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621682058483"><span class="hs-identifier hs-var">env_ty</span></a></span></span><span> </span><span id="local-6989586621682058484"><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621682058484"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1390"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TidyEnv -&gt; TcM (TidyEnv, SDoc)) -&gt; TcM a -&gt; TcM a
forall a. (TidyEnv -&gt; TcM (TidyEnv, SDoc)) -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addLandmarkErrCtxtM"><span class="hs-identifier hs-var">addLandmarkErrCtxtM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682058486"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621682058486"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621682058486"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; (TidyEnv, SDoc))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) SDoc -&gt; TcM (TidyEnv, SDoc)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) SDoc
</span><a href="#local-6989586621682058487"><span class="hs-identifier hs-var">mk_msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621682058484"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-1391"></span><span>      </span><span class="hs-comment">-- NB: use a landmark error context, so that an empty context</span><span>
</span><span id="line-1392"></span><span>      </span><span class="hs-comment">-- doesn't suppress some more useful context</span><span>
</span><span id="line-1393"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1394"></span><span>    </span><span id="local-6989586621682058487"><span class="annot"><span class="annottext">mk_msg :: IOEnv (Env TcGblEnv TcLclEnv) SDoc
</span><a href="#local-6989586621682058487"><span class="hs-identifier hs-var hs-var">mk_msg</span></a></span></span><span>
</span><span id="line-1395"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058488"><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621682058488"><span class="hs-identifier hs-var">mb_env_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExpRhoType -&gt; TcM (Maybe TcSigmaType)
</span><a href="GHC.Tc.Utils.TcMType.html#readExpType_maybe"><span class="hs-identifier hs-var">readExpType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621682058483"><span class="hs-identifier hs-var">env_ty</span></a></span><span>
</span><span id="line-1396"></span><span>                     </span><span class="hs-comment">-- by the time the message is rendered, the ExpType</span><span>
</span><span id="line-1397"></span><span>                     </span><span class="hs-comment">-- will be filled in (except if we're debugging)</span><span>
</span><span id="line-1398"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058490"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058490"><span class="hs-identifier hs-var">fun_res'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058482"><span class="hs-identifier hs-var">fun_res_ty</span></a></span><span>
</span><span id="line-1399"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682058491"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058491"><span class="hs-identifier hs-var">env'</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621682058488"><span class="hs-identifier hs-var">mb_env_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1400"></span><span>                           </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682058492"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058492"><span class="hs-identifier hs-var">env_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058492"><span class="hs-identifier hs-var">env_ty</span></a></span><span>
</span><span id="line-1401"></span><span>                           </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1402"></span><span>                             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682058493"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682058493"><span class="hs-identifier hs-var">dumping</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DumpFlag -&gt; TcRnIf TcGblEnv TcLclEnv Bool
forall gbl lcl. DumpFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#doptM"><span class="hs-identifier hs-var">doptM</span></a></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="GHC.Driver.Flags.html#Opt_D_dump_tc_trace"><span class="hs-identifier hs-var">Opt_D_dump_tc_trace</span></a></span><span>
</span><span id="line-1403"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682058493"><span class="hs-identifier hs-var">dumping</span></a></span><span>
</span><span id="line-1404"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#newFlexiTyVarTy"><span class="hs-identifier hs-var">newFlexiTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1405"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- See Note [Splitting nested sigma types in mismatched</span><span>
</span><span id="line-1406"></span><span>                 </span><span class="hs-comment">--           function types]</span><span>
</span><span id="line-1407"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058498"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058498"><span class="hs-identifier hs-var">fun_tau</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Var], [TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitNestedSigmaTys"><span class="hs-identifier hs-var">tcSplitNestedSigmaTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058490"><span class="hs-identifier hs-var">fun_res'</span></a></span><span>
</span><span id="line-1408"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058500"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058500"><span class="hs-identifier hs-var">env_tau</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Var], [TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitNestedSigmaTys"><span class="hs-identifier hs-var">tcSplitNestedSigmaTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058491"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-1409"></span><span>                     </span><span class="hs-comment">-- env_ty is an ExpRhoTy, but with simple subsumption it</span><span>
</span><span id="line-1410"></span><span>                     </span><span class="hs-comment">-- is not deeply skolemised, so still use tcSplitNestedSigmaTys</span><span>
</span><span id="line-1411"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621682058501"><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058501"><span class="hs-identifier hs-var">args_fun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058502"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058502"><span class="hs-identifier hs-var">res_fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Scaled TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-var">tcSplitFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058498"><span class="hs-identifier hs-var">fun_tau</span></a></span><span>
</span><span id="line-1412"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621682058504"><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058504"><span class="hs-identifier hs-var">args_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682058505"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058505"><span class="hs-identifier hs-var">res_env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Scaled TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-var">tcSplitFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058500"><span class="hs-identifier hs-var">env_tau</span></a></span><span>
</span><span id="line-1413"></span><span>                 </span><span id="local-6989586621682058506"><span class="annot"><span class="annottext">n_fun :: ThLevel
</span><a href="#local-6989586621682058506"><span class="hs-identifier hs-var hs-var">n_fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType] -&gt; ThLevel
forall a. [a] -&gt; ThLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ThLevel
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058501"><span class="hs-identifier hs-var">args_fun</span></a></span><span>
</span><span id="line-1414"></span><span>                 </span><span id="local-6989586621682058507"><span class="annot"><span class="annottext">n_env :: ThLevel
</span><a href="#local-6989586621682058507"><span class="hs-identifier hs-var hs-var">n_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType] -&gt; ThLevel
forall a. [a] -&gt; ThLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ThLevel
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621682058504"><span class="hs-identifier hs-var">args_env</span></a></span><span>
</span><span id="line-1415"></span><span>                 </span><span id="local-6989586621682058508"><span class="annot"><span class="annottext">info :: SDoc
</span><a href="#local-6989586621682058508"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- Check for too few args</span><span>
</span><span id="line-1416"></span><span>                         </span><span class="hs-comment">--  fun_tau = a -&gt; b, res_tau = Int</span><span>
</span><span id="line-1417"></span><span>                         </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682058506"><span class="hs-identifier hs-var">n_fun</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682058507"><span class="hs-identifier hs-var">n_env</span></a></span><span>
</span><span id="line-1418"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="#local-6989586621682058509"><span class="hs-identifier hs-var">not_fun</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058505"><span class="hs-identifier hs-var">res_env</span></a></span><span>
</span><span id="line-1419"></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Probable cause:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058480"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1420"></span><span>                         </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is applied to too few arguments&quot;</span></span><span>
</span><span id="line-1421"></span><span>
</span><span id="line-1422"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- Check for too many args</span><span>
</span><span id="line-1423"></span><span>                         </span><span class="hs-comment">-- fun_tau = a -&gt; Int,   res_tau = a -&gt; b -&gt; c -&gt; d</span><span>
</span><span id="line-1424"></span><span>                         </span><span class="hs-comment">-- The final guard suppresses the message when there</span><span>
</span><span id="line-1425"></span><span>                         </span><span class="hs-comment">-- aren't enough args to drop; eg. the call is (f e1)</span><span>
</span><span id="line-1426"></span><span>                         </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682058506"><span class="hs-identifier hs-var">n_fun</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682058507"><span class="hs-identifier hs-var">n_env</span></a></span><span>
</span><span id="line-1427"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="#local-6989586621682058509"><span class="hs-identifier hs-var">not_fun</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058502"><span class="hs-identifier hs-var">res_fun</span></a></span><span>
</span><span id="line-1428"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682058506"><span class="hs-identifier hs-var">n_fun</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; ThLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExprArg 'TcpRn -&gt; Bool) -&gt; [HsExprArg 'TcpRn] -&gt; ThLevel
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ThLevel
</span><a href="GHC.Utils.Misc.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn -&gt; Bool
forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isValArg"><span class="hs-identifier hs-var">isValArg</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621682058481"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; ThLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621682058507"><span class="hs-identifier hs-var">n_env</span></a></span><span>
</span><span id="line-1429"></span><span>                          </span><span class="hs-comment">-- Never suggest that a naked variable is</span><span>
</span><span id="line-1430"></span><span>                                           </span><span class="hs-comment">-- applied to too many args!</span><span>
</span><span id="line-1431"></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Possible cause:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058480"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1432"></span><span>                         </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is applied to too many arguments&quot;</span></span><span>
</span><span id="line-1433"></span><span>
</span><span id="line-1434"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1435"></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">Outputable.empty</span></a></span><span>
</span><span id="line-1436"></span><span>
</span><span id="line-1437"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) SDoc
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682058508"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1438"></span><span>
</span><span id="line-1439"></span><span>    </span><span id="local-6989586621682058509"><span class="annot"><span class="annottext">not_fun :: TcSigmaType -&gt; Bool
</span><a href="#local-6989586621682058509"><span class="hs-identifier hs-var hs-var">not_fun</span></a></span></span><span> </span><span id="local-6989586621682058513"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058513"><span class="hs-identifier hs-var">ty</span></a></span></span><span>   </span><span class="hs-comment">-- ty is definitely not an arrow type,</span><span>
</span><span id="line-1440"></span><span>                 </span><span class="hs-comment">-- and cannot conceivably become one</span><span>
</span><span id="line-1441"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TcSigmaType -&gt; Maybe (TyCon, [TcSigmaType])
TcSigmaType -&gt; Maybe (TyCon, [TcSigmaType])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621682058513"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1442"></span><span>          </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682058514"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682058514"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682058514"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1443"></span><span>          </span><span class="annot"><span class="annottext">Maybe (TyCon, [TcSigmaType])
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1444"></span><span>
</span><span id="line-1445"></span><span class="hs-comment">{-
Note [Splitting nested sigma types in mismatched function types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When one applies a function to too few arguments, GHC tries to determine this
fact if possible so that it may give a helpful error message. It accomplishes
this by checking if the type of the applied function has more argument types
than supplied arguments.

Previously, GHC computed the number of argument types through tcSplitSigmaTy.
This is incorrect in the face of nested foralls, however!
This caused Ticket #13311, for instance:

  f :: forall a. (Monoid a) =&gt; Int -&gt; forall b. (Monoid b) =&gt; Maybe a -&gt; Maybe b

If one uses `f` like so:

  do { f; putChar 'a' }

Then tcSplitSigmaTy will decompose the type of `f` into:

  Tyvars: [a]
  Context: (Monoid a)
  Argument types: []
  Return type: Int -&gt; forall b. Monoid b =&gt; Maybe a -&gt; Maybe b

That is, it will conclude that there are *no* argument types, and since `f`
was given no arguments, it won't print a helpful error message. On the other
hand, tcSplitNestedSigmaTys correctly decomposes `f`'s type down to:

  Tyvars: [a, b]
  Context: (Monoid a, Monoid b)
  Argument types: [Int, Maybe a]
  Return type: Maybe b

So now GHC recognizes that `f` has one more argument type than it was actually
provided.

Notice that tcSplitNestedSigmaTys looks through function arrows too, regardless
of simple/deep subsumption.  Here we are concerned only whether there is a
mis-match in the number of value arguments.
-}</span><span>
</span><span id="line-1486"></span><span>
</span><span id="line-1487"></span><span>
</span><span id="line-1488"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
             Misc utility functions
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1493"></span><span>
</span><span id="line-1494"></span><span id="local-6989586621682057258"><span class="annot"><a href="GHC.Tc.Gen.Head.html#addExprCtxt"><span class="hs-identifier hs-type">addExprCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057258"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682057258"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1495"></span><span id="addExprCtxt"><span class="annot"><span class="annottext">addExprCtxt :: forall a. HsExpr (GhcPass 'Renamed) -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Gen.Head.html#addExprCtxt"><span class="hs-identifier hs-var hs-var">addExprCtxt</span></a></span></span><span> </span><span id="local-6989586621682058516"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058516"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682058517"><span class="annot"><span class="annottext">TcRn a
</span><a href="#local-6989586621682058517"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1496"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058516"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1497"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsUnboundVar"><span class="hs-identifier hs-type">HsUnboundVar</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcRn a
</span><a href="#local-6989586621682058517"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-1498"></span><span>      </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; TcRn a -&gt; TcRn a
forall a. SDoc -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#exprCtxt"><span class="hs-identifier hs-var">exprCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058516"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcRn a
</span><a href="#local-6989586621682058517"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-1499"></span><span>   </span><span class="hs-comment">-- The HsUnboundVar special case addresses situations like</span><span>
</span><span id="line-1500"></span><span>   </span><span class="hs-comment">--    f x = _</span><span>
</span><span id="line-1501"></span><span>   </span><span class="hs-comment">-- when we don't want to say &quot;In the expression: _&quot;,</span><span>
</span><span id="line-1502"></span><span>   </span><span class="hs-comment">-- because it is mentioned in the error message itself</span><span>
</span><span id="line-1503"></span><span>
</span><span id="line-1504"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#exprCtxt"><span class="hs-identifier hs-type">exprCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1505"></span><span id="exprCtxt"><span class="annot"><span class="annottext">exprCtxt :: HsExpr (GhcPass 'Renamed) -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#exprCtxt"><span class="hs-identifier hs-var hs-var">exprCtxt</span></a></span></span><span> </span><span id="local-6989586621682058521"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058521"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the expression:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; HsExpr (GhcPass 'Renamed)
forall (p :: Pass). HsExpr (GhcPass p) -&gt; HsExpr (GhcPass p)
</span><a href="GHC.Hs.Expr.html#stripParensHsExpr"><span class="hs-identifier hs-var">stripParensHsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621682058521"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1506"></span></pre></body></html>