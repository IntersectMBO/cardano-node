<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- (c) The University of Glasgow 1993-2004</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- The native code generator's monad.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.CmmToAsm.Monad</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NcgImpl"><span class="hs-identifier">NcgImpl</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier">NatM_State</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#mkNatM_State"><span class="hs-identifier">mkNatM_State</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier">NatM</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- instance Monad</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#initNat"><span class="hs-identifier">initNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImportNat"><span class="hs-identifier">addImportNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addNodeBetweenNat"><span class="hs-identifier">addNodeBetweenNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier">addImmediateSuccessorNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier">updateCfgNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getUniqueNat"><span class="hs-identifier">getUniqueNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier">setDeltaNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier">getConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier">getPlatform</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier">getDeltaNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getThisModuleNat"><span class="hs-identifier">getThisModuleNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier">getBlockIdNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier">getNewLabelNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier">getNewRegNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier">getPicBaseMaybeNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseNat"><span class="hs-identifier">getPicBaseNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier">getCfgWeights</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier">getFileId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier">getDebugBlock</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#DwarfFiles"><span class="hs-identifier">DwarfFiles</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><span class="hs-comment">-- * 64-bit registers on 32-bit architectures</span></span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier">Reg64</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier">RegCode64</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier">getNewReg64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier">localReg64</span></a></span><span>
</span><span id="line-44"></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html"><span class="hs-identifier">GHC.Platform.Reg</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html"><span class="hs-identifier">GHC.CmmToAsm.Format</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Reg.Target.html"><span class="hs-identifier">GHC.CmmToAsm.Reg.Target</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html"><span class="hs-identifier">GHC.CmmToAsm.Config</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Types.html"><span class="hs-identifier">GHC.CmmToAsm.Types</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html"><span class="hs-identifier">GHC.Cmm.BlockId</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Collections.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Collections</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Label</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html"><span class="hs-identifier">GHC.Cmm.CLabel</span></a></span><span>           </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#CLabel"><span class="hs-identifier">CLabel</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html"><span class="hs-identifier">GHC.Cmm.DebugBlock</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html"><span class="hs-identifier">GHC.Cmm.Expr</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier">LocalReg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier">isWord64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier">FastString</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html"><span class="hs-identifier">GHC.Types.Unique.FM</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html"><span class="hs-identifier">GHC.Types.Unique.Supply</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier">Unique</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier">SDoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#HDoc"><span class="hs-identifier">HDoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier">pprPanic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.State.Strict.html"><span class="hs-identifier">GHC.Utils.Monad.State.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Monad.State.Strict.html#State"><span class="hs-identifier">State</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.State.Strict.html#runState"><span class="hs-identifier">runState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.State.Strict.html#state"><span class="hs-identifier">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html"><span class="hs-identifier">GHC.CmmToAsm.CFG</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.Weight.html"><span class="hs-identifier">GHC.CmmToAsm.CFG.Weight</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="NcgImpl"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NcgImpl"><span class="hs-identifier hs-var">NcgImpl</span></a></span></span><span> </span><span id="local-6989586621681837337"><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span></span><span> </span><span id="local-6989586621681837338"><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span></span><span> </span><span id="local-6989586621681837339"><span class="annot"><a href="#local-6989586621681837339"><span class="hs-identifier hs-type">jumpDest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NcgImpl"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NcgImpl"><span class="hs-identifier hs-var">NcgImpl</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-78"></span><span>    </span><span id="ncgConfig"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest -&gt; NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#ncgConfig"><span class="hs-identifier hs-var hs-var">ncgConfig</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>    </span><span id="cmmTopCodeGen"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest
-&gt; RawCmmDecl -&gt; NatM [NatCmmDecl statics instr]
</span><a href="GHC.CmmToAsm.Monad.html#cmmTopCodeGen"><span class="hs-identifier hs-var hs-var">cmmTopCodeGen</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmDecl"><span class="hs-identifier hs-type">RawCmmDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>    </span><span id="generateJumpTableForInstr"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest
-&gt; instr -&gt; Maybe (NatCmmDecl statics instr)
</span><a href="GHC.CmmToAsm.Monad.html#generateJumpTableForInstr"><span class="hs-identifier hs-var hs-var">generateJumpTableForInstr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>    </span><span id="getJumpDestBlockId"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest -&gt; jumpDest -&gt; Maybe BlockId
</span><a href="GHC.CmmToAsm.Monad.html#getJumpDestBlockId"><span class="hs-identifier hs-var hs-var">getJumpDestBlockId</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681837339"><span class="hs-identifier hs-type">jumpDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-comment">-- | Does this jump always jump to a single destination and is shortcutable?</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-comment">-- We use this to determine shortcutable instructions - See Note [What is shortcutting]</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">-- Note that if we return a destination here we *most* support the relevant shortcutting in</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">-- shortcutStatics for jump tables and shortcutJump for the instructions itself.</span><span>
</span><span id="line-87"></span><span>    </span><span id="canShortcut"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest -&gt; instr -&gt; Maybe jumpDest
</span><a href="GHC.CmmToAsm.Monad.html#canShortcut"><span class="hs-identifier hs-var hs-var">canShortcut</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837339"><span class="hs-identifier hs-type">jumpDest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Replace references to blockIds with other destinations - used to update jump tables.</span></span><span>
</span><span id="line-89"></span><span>    </span><span id="shortcutStatics"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest
-&gt; (BlockId -&gt; Maybe jumpDest) -&gt; statics -&gt; statics
</span><a href="GHC.CmmToAsm.Monad.html#shortcutStatics"><span class="hs-identifier hs-var hs-var">shortcutStatics</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837339"><span class="hs-identifier hs-type">jumpDest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Change the jump destination(s) of an instruction.</span></span><span>
</span><span id="line-91"></span><span>    </span><span id="shortcutJump"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest
-&gt; (BlockId -&gt; Maybe jumpDest) -&gt; instr -&gt; instr
</span><a href="GHC.CmmToAsm.Monad.html#shortcutJump"><span class="hs-identifier hs-var hs-var">shortcutJump</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837339"><span class="hs-identifier hs-type">jumpDest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- | 'Module' is only for printing internal labels. See Note [Internal proc</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- labels] in CLabel.</span><span>
</span><span id="line-94"></span><span>    </span><span id="pprNatCmmDeclS"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest -&gt; NatCmmDecl statics instr -&gt; SDoc
</span><a href="GHC.CmmToAsm.Monad.html#pprNatCmmDeclS"><span class="hs-identifier hs-var hs-var">pprNatCmmDeclS</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>    </span><span id="pprNatCmmDeclH"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest -&gt; NatCmmDecl statics instr -&gt; HDoc
</span><a href="GHC.CmmToAsm.Monad.html#pprNatCmmDeclH"><span class="hs-identifier hs-var hs-var">pprNatCmmDeclH</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#HDoc"><span class="hs-identifier hs-type">HDoc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-comment">-- see Note [pprNatCmmDeclS and pprNatCmmDeclH]</span><span>
</span><span id="line-97"></span><span>    </span><span id="maxSpillSlots"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest -&gt; Int
</span><a href="GHC.CmmToAsm.Monad.html#maxSpillSlots"><span class="hs-identifier hs-var hs-var">maxSpillSlots</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>    </span><span id="allocatableRegs"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest -&gt; [RealReg]
</span><a href="GHC.CmmToAsm.Monad.html#allocatableRegs"><span class="hs-identifier hs-var hs-var">allocatableRegs</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#RealReg"><span class="hs-identifier hs-type">RealReg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>    </span><span id="ncgAllocMoreStack"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest
-&gt; Int
-&gt; NatCmmDecl statics instr
-&gt; UniqSM (NatCmmDecl statics instr, [(BlockId, BlockId)])
</span><a href="GHC.CmmToAsm.Monad.html#ncgAllocMoreStack"><span class="hs-identifier hs-var hs-var">ncgAllocMoreStack</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span>
</span><span id="line-100"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837337"><span class="hs-identifier hs-type">statics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- ^ The list of block ids records the redirected jumps to allow us to update</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- the CFG.</span><span>
</span><span id="line-103"></span><span>    </span><span id="ncgMakeFarBranches"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest
-&gt; Platform
-&gt; LabelMap RawCmmStatics
-&gt; [NatBasicBlock instr]
-&gt; UniqSM [NatBasicBlock instr]
</span><a href="GHC.CmmToAsm.Monad.html#ncgMakeFarBranches"><span class="hs-identifier hs-var hs-var">ncgMakeFarBranches</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>    </span><span id="extractUnwindPoints"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest -&gt; [instr] -&gt; [UnwindPoint]
</span><a href="GHC.CmmToAsm.Monad.html#extractUnwindPoints"><span class="hs-identifier hs-var hs-var">extractUnwindPoints</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#UnwindPoint"><span class="hs-identifier hs-type">UnwindPoint</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">-- ^ given the instruction sequence of a block, produce a list of</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">-- the block's 'UnwindPoint's</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- See Note [What is this unwinding business?] in &quot;GHC.Cmm.DebugBlock&quot;</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">-- and Note [Unwinding information in the NCG] in this module.</span><span>
</span><span id="line-110"></span><span>    </span><span id="invertCondBranches"><span class="annot"><span class="annottext">forall statics instr jumpDest.
NcgImpl statics instr jumpDest
-&gt; Maybe CFG
-&gt; LabelMap RawCmmStatics
-&gt; [NatBasicBlock instr]
-&gt; [NatBasicBlock instr]
</span><a href="GHC.CmmToAsm.Monad.html#invertCondBranches"><span class="hs-identifier hs-var hs-var">invertCondBranches</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837338"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- ^ Turn the sequence of @jcc l1; jmp l2@ into @jncc l2; \&lt;block_l1&gt;@</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- when possible.</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">{- Note [supporting shortcutting]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For the concept of shortcutting see Note [What is shortcutting].

In order to support shortcutting across multiple backends uniformly we
use canShortcut, shortcutStatics and shortcutJump.

canShortcut tells us if the backend support shortcutting of a instruction
and if so what destination we should retarget instruction to instead.

shortcutStatics exists to allow us to update jump destinations in jump tables.

shortcutJump updates the instructions itself.

A backend can opt out of those by always returning Nothing for canShortcut
and implementing shortcutStatics/shortcutJump as \_ x -&gt; x

-}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">{- Note [pprNatCmmDeclS and pprNatCmmDeclH]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Each NcgImpl provides two implementations of its CmmDecl printer, pprNatCmmDeclS
and pprNatCmmDeclH, which are specialized to SDoc and HDoc, respectively
(see Note [SDoc versus HDoc] in GHC.Utils.Outputable). These are both internally
implemented as a single, polymorphic function, but they need to be stored using
monomorphic types to ensure the specialized versions are used, which is
essential for performance (see Note [SPECIALIZE to HDoc] in GHC.Utils.Outputable).

One might wonder why we bother with pprNatCmmDeclS and SDoc at all, since we
have a perfectly serviceable HDoc-based implementation that is more efficient.
However, it turns out we benefit from keeping both, for two (related) reasons:

  1. Although we absolutely want to take care to use pprNatCmmDeclH for actual
     code generation (the improved performance there is why we have HDoc at
     all!), we also sometimes print assembly for debug dumps, when requested via
     -ddump-asm. In this case, it&#8217;s more convenient to produce an SDoc, which
     can be concatenated with other SDocs for consistency with the general-
     purpose dump file infrastructure.

  2. Some debug information is sometimes useful to include in -ddump-asm that is
     neither necessary nor useful in normal code generation, and it turns out to
     be tricky to format neatly using the one-line-at-a-time model of HLine/HDoc.

Therefore, we provide both pprNatCmmDeclS and pprNatCmmDeclH, and we sometimes
include additional information in the SDoc variant using dualDoc
(see Note [dualLine and dualDoc] in GHC.Utils.Outputable). However, it is
absolutely *critical* that pprNatCmmDeclS is not actually used unless -ddump-asm
is provided, as that would rather defeat the whole point. (Fortunately, the
difference in allocations between the two implementations is so vast that such a
mistake would readily show up in performance tests). -}</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">data</span><span> </span><span id="NatM_State"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-var">NatM_State</span></a></span></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="NatM_State"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-var">NatM_State</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-169"></span><span>                </span><span id="natm_us"><span class="annot"><span class="annottext">NatM_State -&gt; UniqSupply
</span><a href="GHC.CmmToAsm.Monad.html#natm_us"><span class="hs-identifier hs-var hs-var">natm_us</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>                </span><span id="natm_delta"><span class="annot"><span class="annottext">NatM_State -&gt; Int
</span><a href="GHC.CmmToAsm.Monad.html#natm_delta"><span class="hs-identifier hs-var hs-var">natm_delta</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Stack offset for unwinding information</span></span><span>
</span><span id="line-171"></span><span>                </span><span id="natm_imports"><span class="annot"><span class="annottext">NatM_State -&gt; [CLabel]
</span><a href="GHC.CmmToAsm.Monad.html#natm_imports"><span class="hs-identifier hs-var hs-var">natm_imports</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>                </span><span id="natm_pic"><span class="annot"><span class="annottext">NatM_State -&gt; Maybe Reg
</span><a href="GHC.CmmToAsm.Monad.html#natm_pic"><span class="hs-identifier hs-var hs-var">natm_pic</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>                </span><span id="natm_config"><span class="annot"><span class="annottext">NatM_State -&gt; NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#natm_config"><span class="hs-identifier hs-var hs-var">natm_config</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>                </span><span id="natm_fileid"><span class="annot"><span class="annottext">NatM_State -&gt; DwarfFiles
</span><a href="GHC.CmmToAsm.Monad.html#natm_fileid"><span class="hs-identifier hs-var hs-var">natm_fileid</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#DwarfFiles"><span class="hs-identifier hs-type">DwarfFiles</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>                </span><span id="natm_debug_map"><span class="annot"><span class="annottext">NatM_State -&gt; LabelMap DebugBlock
</span><a href="GHC.CmmToAsm.Monad.html#natm_debug_map"><span class="hs-identifier hs-var hs-var">natm_debug_map</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#DebugBlock"><span class="hs-identifier hs-type">DebugBlock</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>                </span><span id="natm_cfg"><span class="annot"><span class="annottext">NatM_State -&gt; CFG
</span><a href="GHC.CmmToAsm.Monad.html#natm_cfg"><span class="hs-identifier hs-var hs-var">natm_cfg</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-comment">-- ^ Having a CFG with additional information is essential for some</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-comment">-- operations. However we can't reconstruct all information once we</span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-comment">-- generated instructions. So instead we update the CFG as we go.</span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">type</span><span> </span><span id="DwarfFiles"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#DwarfFiles"><span class="hs-identifier hs-var">DwarfFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">newtype</span><span> </span><span id="NatM"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span></span><span> </span><span id="local-6989586621681837454"><span class="annot"><a href="#local-6989586621681837454"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NatM%27"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM%27"><span class="hs-identifier hs-var">NatM'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Monad.State.Strict.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837454"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681837595"><span id="local-6989586621681837599"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; NatM a -&gt; NatM b)
-&gt; (forall a b. a -&gt; NatM b -&gt; NatM a) -&gt; Functor NatM
forall a b. a -&gt; NatM b -&gt; NatM a
forall a b. (a -&gt; b) -&gt; NatM a -&gt; NatM b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; NatM a -&gt; NatM b
fmap :: forall a b. (a -&gt; b) -&gt; NatM a -&gt; NatM b
$c&lt;$ :: forall a b. a -&gt; NatM b -&gt; NatM a
&lt;$ :: forall a b. a -&gt; NatM b -&gt; NatM a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#Functor/GHC.Base.html#Functor"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681837605"><span id="local-6989586621681837610"><span id="local-6989586621681837614"><span id="local-6989586621681837618"><span id="local-6989586621681837622"><span class="annot"><span class="annottext">Functor NatM
Functor NatM =&gt;
(forall a. a -&gt; NatM a)
-&gt; (forall a b. NatM (a -&gt; b) -&gt; NatM a -&gt; NatM b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; NatM a -&gt; NatM b -&gt; NatM c)
-&gt; (forall a b. NatM a -&gt; NatM b -&gt; NatM b)
-&gt; (forall a b. NatM a -&gt; NatM b -&gt; NatM a)
-&gt; Applicative NatM
forall a. a -&gt; NatM a
forall a b. NatM a -&gt; NatM b -&gt; NatM a
forall a b. NatM a -&gt; NatM b -&gt; NatM b
forall a b. NatM (a -&gt; b) -&gt; NatM a -&gt; NatM b
forall a b c. (a -&gt; b -&gt; c) -&gt; NatM a -&gt; NatM b -&gt; NatM c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a. a -&gt; NatM a
pure :: forall a. a -&gt; NatM a
$c&lt;*&gt; :: forall a b. NatM (a -&gt; b) -&gt; NatM a -&gt; NatM b
&lt;*&gt; :: forall a b. NatM (a -&gt; b) -&gt; NatM a -&gt; NatM b
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; NatM a -&gt; NatM b -&gt; NatM c
liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; NatM a -&gt; NatM b -&gt; NatM c
$c*&gt; :: forall a b. NatM a -&gt; NatM b -&gt; NatM b
*&gt; :: forall a b. NatM a -&gt; NatM b -&gt; NatM b
$c&lt;* :: forall a b. NatM a -&gt; NatM b -&gt; NatM a
&lt;* :: forall a b. NatM a -&gt; NatM b -&gt; NatM a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#Applicative/GHC.Base.html#Applicative"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681837630"><span id="local-6989586621681837635"><span id="local-6989586621681837639"><span class="annot"><span class="annottext">Applicative NatM
Applicative NatM =&gt;
(forall a b. NatM a -&gt; (a -&gt; NatM b) -&gt; NatM b)
-&gt; (forall a b. NatM a -&gt; NatM b -&gt; NatM b)
-&gt; (forall a. a -&gt; NatM a)
-&gt; Monad NatM
forall a. a -&gt; NatM a
forall a b. NatM a -&gt; NatM b -&gt; NatM b
forall a b. NatM a -&gt; (a -&gt; NatM b) -&gt; NatM b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a b. NatM a -&gt; (a -&gt; NatM b) -&gt; NatM b
&gt;&gt;= :: forall a b. NatM a -&gt; (a -&gt; NatM b) -&gt; NatM b
$c&gt;&gt; :: forall a b. NatM a -&gt; NatM b -&gt; NatM b
&gt;&gt; :: forall a b. NatM a -&gt; NatM b -&gt; NatM b
$creturn :: forall a. a -&gt; NatM a
return :: forall a. a -&gt; NatM a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#Monad/GHC.Base.html#Monad"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.State.Strict.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681837449"><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681837449"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837449"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-189"></span><span class="hs-keyword">pattern</span><span> </span><span id="NatM"><span id="%24mNatM"><span id="%24bNatM"><span class="annot"><span class="annottext">$mNatM :: forall {r} {a}.
NatM a
-&gt; ((NatM_State -&gt; (a, NatM_State)) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bNatM :: forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var hs-var hs-var hs-var">NatM</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621681837646"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM%27"><span class="hs-identifier hs-type">NatM'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Monad.State.Strict.html#runState"><span class="hs-identifier hs-type">runState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621681837646"><span class="annot"><a href="#local-6989586621681837646"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span id="local-6989586621681837647"><span class="annot"><span class="annottext">NatM_State -&gt; (a, NatM_State)
</span><a href="#local-6989586621681837647"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State NatM_State a -&gt; NatM a
forall a. State NatM_State a -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM%27"><span class="hs-identifier hs-var">NatM'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NatM_State -&gt; (a, NatM_State)) -&gt; State NatM_State a
forall s a. (s -&gt; (a, s)) -&gt; State s a
</span><a href="GHC.Utils.Monad.State.Strict.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State -&gt; (a, NatM_State)
</span><a href="#local-6989586621681837647"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-pragma hs-type">NatM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621681837457"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#unNat"><span class="hs-identifier hs-type">unNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837457"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681837457"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-194"></span><span id="unNat"><span class="annot"><span class="annottext">unNat :: forall a. NatM a -&gt; NatM_State -&gt; (a, NatM_State)
</span><a href="GHC.CmmToAsm.Monad.html#unNat"><span class="hs-identifier hs-var hs-var">unNat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span id="local-6989586621681837649"><span class="annot"><span class="annottext">NatM_State -&gt; (a, NatM_State)
</span><a href="#local-6989586621681837649"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatM_State -&gt; (a, NatM_State)
</span><a href="#local-6989586621681837649"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#mkNatM_State"><span class="hs-identifier hs-type">mkNatM_State</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#DwarfFiles"><span class="hs-identifier hs-type">DwarfFiles</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#DebugBlock"><span class="hs-identifier hs-type">DebugBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span>
</span><span id="line-198"></span><span id="mkNatM_State"><span class="annot"><span class="annottext">mkNatM_State :: UniqSupply
-&gt; Int
-&gt; NCGConfig
-&gt; DwarfFiles
-&gt; LabelMap DebugBlock
-&gt; CFG
-&gt; NatM_State
</span><a href="GHC.CmmToAsm.Monad.html#mkNatM_State"><span class="hs-identifier hs-var hs-var">mkNatM_State</span></a></span></span><span> </span><span id="local-6989586621681837650"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681837650"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621681837651"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681837651"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span id="local-6989586621681837652"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621681837652"><span class="hs-identifier hs-var">config</span></a></span></span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681837653"><span class="annot"><span class="annottext">DwarfFiles
</span><a href="#local-6989586621681837653"><span class="hs-identifier hs-var">dwf</span></a></span></span><span> </span><span id="local-6989586621681837654"><span class="annot"><span class="annottext">LabelMap DebugBlock
</span><a href="#local-6989586621681837654"><span class="hs-identifier hs-var">dbg</span></a></span></span><span> </span><span id="local-6989586621681837655"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621681837655"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>                </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span>
</span><span id="line-201"></span><span>                        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">natm_us :: UniqSupply
</span><a href="GHC.CmmToAsm.Monad.html#natm_us"><span class="hs-identifier hs-var">natm_us</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681837650"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-202"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">natm_delta :: Int
</span><a href="GHC.CmmToAsm.Monad.html#natm_delta"><span class="hs-identifier hs-var">natm_delta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681837651"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-203"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">natm_imports :: [CLabel]
</span><a href="GHC.CmmToAsm.Monad.html#natm_imports"><span class="hs-identifier hs-var">natm_imports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">natm_pic :: Maybe Reg
</span><a href="GHC.CmmToAsm.Monad.html#natm_pic"><span class="hs-identifier hs-var">natm_pic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Reg
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-205"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">natm_config :: NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#natm_config"><span class="hs-identifier hs-var">natm_config</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621681837652"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-206"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">natm_fileid :: DwarfFiles
</span><a href="GHC.CmmToAsm.Monad.html#natm_fileid"><span class="hs-identifier hs-var">natm_fileid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DwarfFiles
</span><a href="#local-6989586621681837653"><span class="hs-identifier hs-var">dwf</span></a></span><span>
</span><span id="line-207"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">natm_debug_map :: LabelMap DebugBlock
</span><a href="GHC.CmmToAsm.Monad.html#natm_debug_map"><span class="hs-identifier hs-var">natm_debug_map</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LabelMap DebugBlock
</span><a href="#local-6989586621681837654"><span class="hs-identifier hs-var">dbg</span></a></span><span>
</span><span id="line-208"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">natm_cfg :: CFG
</span><a href="GHC.CmmToAsm.Monad.html#natm_cfg"><span class="hs-identifier hs-var">natm_cfg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621681837655"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-209"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621681837459"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#initNat"><span class="hs-identifier hs-type">initNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681837459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM_State"><span class="hs-identifier hs-type">NatM_State</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-212"></span><span id="initNat"><span class="annot"><span class="annottext">initNat :: forall a. NatM_State -&gt; NatM a -&gt; (a, NatM_State)
</span><a href="GHC.CmmToAsm.Monad.html#initNat"><span class="hs-identifier hs-var hs-var">initNat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM a -&gt; NatM_State -&gt; (a, NatM_State))
-&gt; NatM_State -&gt; NatM a -&gt; (a, NatM_State)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#flip/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">NatM a -&gt; NatM_State -&gt; (a, NatM_State)
forall a. NatM a -&gt; NatM_State -&gt; (a, NatM_State)
</span><a href="GHC.CmmToAsm.Monad.html#unNat"><span class="hs-identifier hs-var">unNat</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681837662"><span class="annot"><a href="GHC.Types.Unique.Supply.html#MonadUnique"><span class="hs-identifier hs-type">MonadUnique</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621681837666"><span class="annot"><span class="annottext">getUniqueSupplyM :: NatM UniqSupply
</span><a href="#local-6989586621681837666"><span class="hs-identifier hs-var hs-var hs-var hs-var">getUniqueSupplyM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (UniqSupply, NatM_State)) -&gt; NatM UniqSupply
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (UniqSupply, NatM_State)) -&gt; NatM UniqSupply)
-&gt; (NatM_State -&gt; (UniqSupply, NatM_State)) -&gt; NatM UniqSupply
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681837668"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837668"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (UniqSupply, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#splitUniqSupply"><span class="hs-identifier hs-var">splitUniqSupply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; UniqSupply
</span><a href="GHC.CmmToAsm.Monad.html#natm_us"><span class="hs-identifier hs-var">natm_us</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837668"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681837670"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681837670"><span class="hs-identifier hs-var">us1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681837671"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681837671"><span class="hs-identifier hs-var">us2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681837670"><span class="hs-identifier hs-var">us1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837668"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_us"><span class="hs-identifier hs-var">natm_us</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681837671"><span class="hs-identifier hs-type">us2</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621681837672"><span class="annot"><span class="annottext">getUniqueM :: NatM Unique
</span><a href="#local-6989586621681837672"><span class="hs-identifier hs-var hs-var hs-var hs-var">getUniqueM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Unique, NatM_State)) -&gt; NatM Unique
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (Unique, NatM_State)) -&gt; NatM Unique)
-&gt; (NatM_State -&gt; (Unique, NatM_State)) -&gt; NatM Unique
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681837674"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837674"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (Unique, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; UniqSupply
</span><a href="GHC.CmmToAsm.Monad.html#natm_us"><span class="hs-identifier hs-var">natm_us</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837674"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681837676"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837676"><span class="hs-identifier hs-var">uniq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681837677"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681837677"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837676"><span class="hs-identifier hs-var">uniq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837674"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_us"><span class="hs-identifier hs-var">natm_us</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681837677"><span class="hs-identifier hs-type">us'</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getUniqueNat"><span class="hs-identifier hs-type">getUniqueNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-224"></span><span id="getUniqueNat"><span class="annot"><span class="annottext">getUniqueNat :: NatM Unique
</span><a href="GHC.CmmToAsm.Monad.html#getUniqueNat"><span class="hs-identifier hs-var hs-var">getUniqueNat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Unique, NatM_State)) -&gt; NatM Unique
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (Unique, NatM_State)) -&gt; NatM Unique)
-&gt; (NatM_State -&gt; (Unique, NatM_State)) -&gt; NatM Unique
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681837678"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837678"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (Unique, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a></span><span> </span><span class="annot"><span class="annottext">(UniqSupply -&gt; (Unique, UniqSupply))
-&gt; UniqSupply -&gt; (Unique, UniqSupply)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State -&gt; UniqSupply
</span><a href="GHC.CmmToAsm.Monad.html#natm_us"><span class="hs-identifier hs-var">natm_us</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837678"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681837679"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837679"><span class="hs-identifier hs-var">uniq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681837680"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681837680"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837679"><span class="hs-identifier hs-var">uniq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837678"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_us"><span class="hs-identifier hs-var">natm_us</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681837680"><span class="hs-identifier hs-type">us'</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-type">getDeltaNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-229"></span><span id="getDeltaNat"><span class="annot"><span class="annottext">getDeltaNat :: NatM Int
</span><a href="GHC.CmmToAsm.Monad.html#getDeltaNat"><span class="hs-identifier hs-var hs-var">getDeltaNat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Int, NatM_State)) -&gt; NatM Int
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (Int, NatM_State)) -&gt; NatM Int)
-&gt; (NatM_State -&gt; (Int, NatM_State)) -&gt; NatM Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681837681"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837681"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; Int
</span><a href="GHC.CmmToAsm.Monad.html#natm_delta"><span class="hs-identifier hs-var">natm_delta</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837681"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837681"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><span class="hs-comment">-- | Get CFG edge weights</span></span><span>
</span><span id="line-232"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier hs-type">getCfgWeights</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.Weight.html#Weights"><span class="hs-identifier hs-type">Weights</span></a></span><span>
</span><span id="line-233"></span><span id="getCfgWeights"><span class="annot"><span class="annottext">getCfgWeights :: NatM Weights
</span><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier hs-var hs-var">getCfgWeights</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Weights, NatM_State)) -&gt; NatM Weights
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (Weights, NatM_State)) -&gt; NatM Weights)
-&gt; (NatM_State -&gt; (Weights, NatM_State)) -&gt; NatM Weights
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681837682"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837682"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Weights
</span><a href="GHC.CmmToAsm.Config.html#ncgCfgWeights"><span class="hs-identifier hs-var">ncgCfgWeights</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#natm_config"><span class="hs-identifier hs-var">natm_config</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837682"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837682"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-type">setDeltaNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span id="setDeltaNat"><span class="annot"><span class="annottext">setDeltaNat :: Int -&gt; NatM ()
</span><a href="GHC.CmmToAsm.Monad.html#setDeltaNat"><span class="hs-identifier hs-var hs-var">setDeltaNat</span></a></span></span><span> </span><span id="local-6989586621681837684"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681837684"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; ((), NatM_State)) -&gt; NatM ()
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; ((), NatM_State)) -&gt; NatM ())
-&gt; (NatM_State -&gt; ((), NatM_State)) -&gt; NatM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681837685"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837685"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837685"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_delta"><span class="hs-identifier hs-var">natm_delta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681837684"><span class="hs-identifier hs-type">delta</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getThisModuleNat"><span class="hs-identifier hs-type">getThisModuleNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-239"></span><span id="getThisModuleNat"><span class="annot"><span class="annottext">getThisModuleNat :: NatM Module
</span><a href="GHC.CmmToAsm.Monad.html#getThisModuleNat"><span class="hs-identifier hs-var hs-var">getThisModuleNat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Module, NatM_State)) -&gt; NatM Module
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (Module, NatM_State)) -&gt; NatM Module)
-&gt; (NatM_State -&gt; (Module, NatM_State)) -&gt; NatM Module
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681837686"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837686"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Module
</span><a href="GHC.CmmToAsm.Config.html#ncgThisModule"><span class="hs-identifier hs-var">ncgThisModule</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Module) -&gt; NCGConfig -&gt; Module
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State -&gt; NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#natm_config"><span class="hs-identifier hs-var">natm_config</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837686"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837686"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#HasModule"><span class="hs-identifier hs-type">HasModule</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621681837691"><span class="annot"><span class="annottext">getModule :: NatM Module
</span><a href="#local-6989586621681837691"><span class="hs-identifier hs-var hs-var hs-var hs-var">getModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatM Module
</span><a href="GHC.CmmToAsm.Monad.html#getThisModuleNat"><span class="hs-identifier hs-var">getThisModuleNat</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImportNat"><span class="hs-identifier hs-type">addImportNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="addImportNat"><span class="annot"><span class="annottext">addImportNat :: CLabel -&gt; NatM ()
</span><a href="GHC.CmmToAsm.Monad.html#addImportNat"><span class="hs-identifier hs-var hs-var">addImportNat</span></a></span></span><span> </span><span id="local-6989586621681837693"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621681837693"><span class="hs-identifier hs-var">imp</span></a></span></span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; ((), NatM_State)) -&gt; NatM ()
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; ((), NatM_State)) -&gt; NatM ())
-&gt; (NatM_State -&gt; ((), NatM_State)) -&gt; NatM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681837694"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837694"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837694"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_imports"><span class="hs-identifier hs-var">natm_imports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681837693"><span class="hs-identifier hs-type">imp</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_imports"><span class="hs-identifier hs-var">natm_imports</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837694"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-type">updateCfgNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CFG.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span id="updateCfgNat"><span class="annot"><span class="annottext">updateCfgNat :: (CFG -&gt; CFG) -&gt; NatM ()
</span><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-var hs-var">updateCfgNat</span></a></span></span><span> </span><span id="local-6989586621681837695"><span class="annot"><span class="annottext">CFG -&gt; CFG
</span><a href="#local-6989586621681837695"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-250"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; ((), NatM_State)) -&gt; NatM ()
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; ((), NatM_State)) -&gt; NatM ())
-&gt; (NatM_State -&gt; ((), NatM_State)) -&gt; NatM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681837696"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837696"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681837697"><span class="annot"><span class="annottext">cfg' :: CFG
</span><a href="#local-6989586621681837697"><span class="hs-identifier hs-var hs-var">cfg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CFG -&gt; CFG
</span><a href="#local-6989586621681837695"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; CFG
</span><a href="GHC.CmmToAsm.Monad.html#natm_cfg"><span class="hs-identifier hs-var">natm_cfg</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837696"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837696"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_cfg"><span class="hs-identifier hs-var">natm_cfg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681837697"><span class="hs-identifier hs-type">cfg'</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><span class="hs-comment">-- | Record that we added a block between `from` and `old`.</span></span><span>
</span><span id="line-254"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addNodeBetweenNat"><span class="hs-identifier hs-type">addNodeBetweenNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span id="addNodeBetweenNat"><span class="annot"><span class="annottext">addNodeBetweenNat :: BlockId -&gt; BlockId -&gt; BlockId -&gt; NatM ()
</span><a href="GHC.CmmToAsm.Monad.html#addNodeBetweenNat"><span class="hs-identifier hs-var hs-var">addNodeBetweenNat</span></a></span></span><span> </span><span id="local-6989586621681837698"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837698"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621681837699"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837699"><span class="hs-identifier hs-var">between</span></a></span></span><span> </span><span id="local-6989586621681837700"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837700"><span class="hs-identifier hs-var">to</span></a></span></span><span>
</span><span id="line-256"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>   </span><span id="local-6989586621681837701"><span class="annot"><span class="annottext">Weights
</span><a href="#local-6989586621681837701"><span class="hs-identifier hs-var">weights</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Weights
</span><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier hs-var">getCfgWeights</span></a></span><span>
</span><span id="line-257"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681837702"><span class="annot"><span class="annottext">jmpWeight :: EdgeWeight
</span><a href="#local-6989586621681837702"><span class="hs-identifier hs-var hs-var">jmpWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; EdgeWeight
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Weights -&gt; Int
</span><a href="GHC.CmmToAsm.CFG.Weight.html#uncondWeight"><span class="hs-identifier hs-var">uncondWeight</span></a></span><span> </span><span class="annot"><span class="annottext">Weights
</span><a href="#local-6989586621681837701"><span class="hs-identifier hs-var">weights</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="annottext">(CFG -&gt; CFG) -&gt; NatM ()
</span><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-var">updateCfgNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EdgeWeight -&gt; BlockId -&gt; BlockId -&gt; BlockId -&gt; CFG -&gt; CFG
</span><a href="#local-6989586621681837704"><span class="hs-identifier hs-var">updateCfg</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeWeight
</span><a href="#local-6989586621681837702"><span class="hs-identifier hs-var">jmpWeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837698"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837699"><span class="hs-identifier hs-var">between</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837700"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- When transforming A -&gt; B to A -&gt; A' -&gt; B</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- A -&gt; A' keeps the old edge info while</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- A' -&gt; B gets the info for an unconditional</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">-- jump.</span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621681837704"><span class="annot"><span class="annottext">updateCfg :: EdgeWeight -&gt; BlockId -&gt; BlockId -&gt; BlockId -&gt; CFG -&gt; CFG
</span><a href="#local-6989586621681837704"><span class="hs-identifier hs-var hs-var">updateCfg</span></a></span></span><span> </span><span id="local-6989586621681837705"><span class="annot"><span class="annottext">EdgeWeight
</span><a href="#local-6989586621681837705"><span class="hs-identifier hs-var">weight</span></a></span></span><span> </span><span id="local-6989586621681837706"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837706"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621681837707"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837707"><span class="hs-identifier hs-var">between</span></a></span></span><span> </span><span id="local-6989586621681837708"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837708"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621681837709"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621681837709"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681837710"><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621681837710"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; BlockId -&gt; CFG -&gt; Maybe EdgeInfo
</span><a href="GHC.CmmToAsm.CFG.html#getEdgeInfo"><span class="hs-identifier hs-var">getEdgeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837706"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837708"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621681837709"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; BlockId -&gt; EdgeInfo -&gt; CFG -&gt; CFG
</span><a href="GHC.CmmToAsm.CFG.html#addEdge"><span class="hs-identifier hs-var">addEdge</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837706"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837707"><span class="hs-identifier hs-var">between</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeInfo
</span><a href="#local-6989586621681837710"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(CFG -&gt; CFG) -&gt; (CFG -&gt; CFG) -&gt; CFG -&gt; CFG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-267"></span><span>          </span><span class="annot"><span class="annottext">BlockId -&gt; BlockId -&gt; EdgeWeight -&gt; CFG -&gt; CFG
</span><a href="GHC.CmmToAsm.CFG.html#addWeightEdge"><span class="hs-identifier hs-var">addWeightEdge</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837707"><span class="hs-identifier hs-var">between</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837708"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeWeight
</span><a href="#local-6989586621681837705"><span class="hs-identifier hs-var">weight</span></a></span><span> </span><span class="annot"><span class="annottext">(CFG -&gt; CFG) -&gt; (CFG -&gt; CFG) -&gt; CFG -&gt; CFG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="annottext">BlockId -&gt; BlockId -&gt; CFG -&gt; CFG
</span><a href="GHC.CmmToAsm.CFG.html#delEdge"><span class="hs-identifier hs-var">delEdge</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837706"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837708"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">(CFG -&gt; CFG) -&gt; CFG -&gt; CFG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621681837709"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-269"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; CFG
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed to update cfg: Untracked edge&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockId, BlockId) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837706"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837700"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Place `succ` after `block` and change any edges</span><span>
</span><span id="line-274"></span><span class="hs-comment">--   block -&gt; X to `succ` -&gt; X</span><span>
</span><span id="line-275"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier hs-type">addImmediateSuccessorNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span id="addImmediateSuccessorNat"><span class="annot"><span class="annottext">addImmediateSuccessorNat :: BlockId -&gt; BlockId -&gt; NatM ()
</span><a href="GHC.CmmToAsm.Monad.html#addImmediateSuccessorNat"><span class="hs-identifier hs-var hs-var">addImmediateSuccessorNat</span></a></span></span><span> </span><span id="local-6989586621681837717"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837717"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span id="local-6989586621681837718"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837718"><span class="hs-identifier hs-var">succ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>   </span><span id="local-6989586621681837719"><span class="annot"><span class="annottext">Weights
</span><a href="#local-6989586621681837719"><span class="hs-identifier hs-var">weights</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Weights
</span><a href="GHC.CmmToAsm.Monad.html#getCfgWeights"><span class="hs-identifier hs-var">getCfgWeights</span></a></span><span>
</span><span id="line-278"></span><span>   </span><span class="annot"><span class="annottext">(CFG -&gt; CFG) -&gt; NatM ()
</span><a href="GHC.CmmToAsm.Monad.html#updateCfgNat"><span class="hs-identifier hs-var">updateCfgNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Weights -&gt; BlockId -&gt; BlockId -&gt; CFG -&gt; CFG
</span><a href="GHC.CmmToAsm.CFG.html#addImmediateSuccessor"><span class="hs-identifier hs-var">addImmediateSuccessor</span></a></span><span> </span><span class="annot"><span class="annottext">Weights
</span><a href="#local-6989586621681837719"><span class="hs-identifier hs-var">weights</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837717"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837718"><span class="hs-identifier hs-var">succ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-type">getBlockIdNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-281"></span><span id="getBlockIdNat"><span class="annot"><span class="annottext">getBlockIdNat :: NatM BlockId
</span><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-var hs-var">getBlockIdNat</span></a></span></span><span>
</span><span id="line-282"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; BlockId
</span><a href="GHC.Cmm.BlockId.html#mkBlockId"><span class="hs-identifier hs-var">mkBlockId</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique -&gt; BlockId) -&gt; NatM Unique -&gt; NatM BlockId
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NatM Unique
</span><a href="GHC.CmmToAsm.Monad.html#getUniqueNat"><span class="hs-identifier hs-var">getUniqueNat</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-type">getNewLabelNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a></span><span>
</span><span id="line-285"></span><span id="getNewLabelNat"><span class="annot"><span class="annottext">getNewLabelNat :: NatM CLabel
</span><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-var hs-var">getNewLabelNat</span></a></span></span><span>
</span><span id="line-286"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; CLabel
</span><a href="GHC.Cmm.BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockId -&gt; CLabel) -&gt; NatM BlockId -&gt; NatM CLabel
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NatM BlockId
</span><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-var">getBlockIdNat</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>
</span><span id="line-290"></span><span id="getNewRegNat"><span class="annot"><span class="annottext">getNewRegNat :: Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var hs-var">getNewRegNat</span></a></span></span><span> </span><span id="local-6989586621681837724"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621681837724"><span class="hs-identifier hs-var">rep</span></a></span></span><span>
</span><span id="line-291"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681837725"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837725"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Unique
</span><a href="GHC.CmmToAsm.Monad.html#getUniqueNat"><span class="hs-identifier hs-var">getUniqueNat</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span id="local-6989586621681837726"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681837726"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">Reg -&gt; NatM Reg
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VirtualReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegVirtual"><span class="hs-identifier hs-var">RegVirtual</span></a></span><span> </span><span class="annot"><span class="annottext">(VirtualReg -&gt; Reg) -&gt; VirtualReg -&gt; Reg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Unique -&gt; Format -&gt; VirtualReg
</span><a href="GHC.CmmToAsm.Reg.Target.html#targetMkVirtualReg"><span class="hs-identifier hs-var">targetMkVirtualReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681837726"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837725"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621681837724"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><span class="hs-comment">-- | Two 32-bit regs used as a single virtual 64-bit register</span></span><span>
</span><span id="line-297"></span><span class="hs-keyword">data</span><span> </span><span id="Reg64"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Reg64"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Higher part</span></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Lower part</span></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-comment">-- | Two 32-bit regs used as a single virtual 64-bit register</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- and the code to set them appropriately</span><span>
</span><span id="line-303"></span><span class="hs-keyword">data</span><span> </span><span id="RegCode64"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-var">RegCode64</span></a></span></span><span> </span><span id="local-6989586621681837730"><span class="annot"><a href="#local-6989586621681837730"><span class="hs-identifier hs-type">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RegCode64"><span class="annot"><a href="GHC.CmmToAsm.Monad.html#RegCode64"><span class="hs-identifier hs-var">RegCode64</span></a></span></span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><a href="#local-6989586621681837730"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Code to initialize the registers</span></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Higher part</span></span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Lower part</span></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><span class="hs-comment">-- | Return a virtual 64-bit register</span></span><span>
</span><span id="line-309"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-type">getNewReg64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span>
</span><span id="line-310"></span><span id="getNewReg64"><span class="annot"><span class="annottext">getNewReg64 :: NatM Reg64
</span><a href="GHC.CmmToAsm.Monad.html#getNewReg64"><span class="hs-identifier hs-var hs-var">getNewReg64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681837732"><span class="annot"><span class="annottext">rep :: Format
</span><a href="#local-6989586621681837732"><span class="hs-identifier hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621681837734"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837734"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Unique
</span><a href="GHC.CmmToAsm.Monad.html#getUniqueNat"><span class="hs-identifier hs-var">getUniqueNat</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621681837735"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681837735"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681837736"><span class="annot"><span class="annottext">vLo :: VirtualReg
</span><a href="#local-6989586621681837736"><span class="hs-identifier hs-var hs-var">vLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Unique -&gt; Format -&gt; VirtualReg
</span><a href="GHC.CmmToAsm.Reg.Target.html#targetMkVirtualReg"><span class="hs-identifier hs-var">targetMkVirtualReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681837735"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837734"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621681837732"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681837737"><span class="annot"><span class="annottext">lo :: Reg
</span><a href="#local-6989586621681837737"><span class="hs-identifier hs-var hs-var">lo</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VirtualReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegVirtual"><span class="hs-identifier hs-var">RegVirtual</span></a></span><span> </span><span class="annot"><span class="annottext">(VirtualReg -&gt; Reg) -&gt; VirtualReg -&gt; Reg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Unique -&gt; Format -&gt; VirtualReg
</span><a href="GHC.CmmToAsm.Reg.Target.html#targetMkVirtualReg"><span class="hs-identifier hs-var">targetMkVirtualReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681837735"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837734"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621681837732"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681837738"><span class="annot"><span class="annottext">hi :: Reg
</span><a href="#local-6989586621681837738"><span class="hs-identifier hs-var hs-var">hi</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VirtualReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegVirtual"><span class="hs-identifier hs-var">RegVirtual</span></a></span><span> </span><span class="annot"><span class="annottext">(VirtualReg -&gt; Reg) -&gt; VirtualReg -&gt; Reg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VirtualReg -&gt; VirtualReg
</span><a href="GHC.Platform.Reg.html#getHiVirtualRegFromLo"><span class="hs-identifier hs-var">getHiVirtualRegFromLo</span></a></span><span> </span><span class="annot"><span class="annottext">VirtualReg
</span><a href="#local-6989586621681837736"><span class="hs-identifier hs-var">vLo</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><span class="annottext">Reg64 -&gt; NatM Reg64
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Reg64 -&gt; NatM Reg64) -&gt; Reg64 -&gt; NatM Reg64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837738"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837737"><span class="hs-identifier hs-var">lo</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Convert a 64-bit LocalReg into two virtual 32-bit regs.</span><span>
</span><span id="line-320"></span><span class="hs-comment">--</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- Used to handle 64-bit &quot;registers&quot; on 32-bit architectures</span><span>
</span><span id="line-322"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-type">localReg64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-type">Reg64</span></a></span><span>
</span><span id="line-323"></span><span id="localReg64"><span class="annot"><span class="annottext">localReg64 :: HasDebugCallStack =&gt; LocalReg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#localReg64"><span class="hs-identifier hs-var hs-var">localReg64</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span id="local-6989586621681837746"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837746"><span class="hs-identifier hs-var">vu</span></a></span></span><span> </span><span id="local-6989586621681837747"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621681837747"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isWord64"><span class="hs-identifier hs-var">isWord64</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621681837747"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681837748"><span class="annot"><span class="annottext">lo :: Reg
</span><a href="#local-6989586621681837748"><span class="hs-identifier hs-var hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VirtualReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegVirtual"><span class="hs-identifier hs-var">RegVirtual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique -&gt; VirtualReg
</span><a href="GHC.Platform.Reg.html#VirtualRegI"><span class="hs-identifier hs-var">VirtualRegI</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681837746"><span class="hs-identifier hs-var">vu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>                      </span><span id="local-6989586621681837750"><span class="annot"><span class="annottext">hi :: Reg
</span><a href="#local-6989586621681837750"><span class="hs-identifier hs-var hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#getHiVRegFromLo"><span class="hs-identifier hs-var">getHiVRegFromLo</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837748"><span class="hs-identifier hs-var">lo</span></a></span><span>
</span><span id="line-326"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Reg64
</span><a href="GHC.CmmToAsm.Monad.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837750"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837748"><span class="hs-identifier hs-var">lo</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Reg64
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;localReg64&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621681837747"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier hs-type">getPicBaseMaybeNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span id="getPicBaseMaybeNat"><span class="annot"><span class="annottext">getPicBaseMaybeNat :: NatM (Maybe Reg)
</span><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier hs-var hs-var">getPicBaseMaybeNat</span></a></span></span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Maybe Reg, NatM_State)) -&gt; NatM (Maybe Reg)
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681837752"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837752"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; Maybe Reg
</span><a href="GHC.CmmToAsm.Monad.html#natm_pic"><span class="hs-identifier hs-var">natm_pic</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837752"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837752"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseNat"><span class="hs-identifier hs-type">getPicBaseNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>
</span><span id="line-336"></span><span id="getPicBaseNat"><span class="annot"><span class="annottext">getPicBaseNat :: Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getPicBaseNat"><span class="hs-identifier hs-var hs-var">getPicBaseNat</span></a></span></span><span> </span><span id="local-6989586621681837753"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621681837753"><span class="hs-identifier hs-var">rep</span></a></span></span><span>
</span><span id="line-337"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>   </span><span id="local-6989586621681837754"><span class="annot"><span class="annottext">Maybe Reg
</span><a href="#local-6989586621681837754"><span class="hs-identifier hs-var">mbPicBase</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM (Maybe Reg)
</span><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier hs-var">getPicBaseMaybeNat</span></a></span><span>
</span><span id="line-338"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Reg
</span><a href="#local-6989586621681837754"><span class="hs-identifier hs-var">mbPicBase</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>                </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681837755"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837755"><span class="hs-identifier hs-var">picBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; NatM Reg
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837755"><span class="hs-identifier hs-var">picBase</span></a></span><span>
</span><span id="line-340"></span><span>                </span><span class="annot"><span class="annottext">Maybe Reg
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-341"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>                        </span><span id="local-6989586621681837756"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837756"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621681837753"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-343"></span><span>                        </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Reg, NatM_State)) -&gt; NatM Reg
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681837757"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837757"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621681837756"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837757"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_pic"><span class="hs-identifier hs-var">natm_pic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681837756"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><span class="hs-comment">-- | Get native code generator configuration</span></span><span>
</span><span id="line-346"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-type">getConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span>
</span><span id="line-347"></span><span id="getConfig"><span class="annot"><span class="annottext">getConfig :: NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var hs-var">getConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (NCGConfig, NatM_State)) -&gt; NatM NCGConfig
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (NCGConfig, NatM_State)) -&gt; NatM NCGConfig)
-&gt; (NatM_State -&gt; (NCGConfig, NatM_State)) -&gt; NatM NCGConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681837758"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837758"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#natm_config"><span class="hs-identifier hs-var">natm_config</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837758"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837758"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><span class="hs-comment">-- | Get target platform from native code generator configuration</span></span><span>
</span><span id="line-350"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-351"></span><span id="getPlatform"><span class="annot"><span class="annottext">getPlatform :: NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var hs-var">getPlatform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(NCGConfig -&gt; Platform) -&gt; NatM NCGConfig -&gt; NatM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier hs-type">getFileId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-354"></span><span id="getFileId"><span class="annot"><span class="annottext">getFileId :: FastString -&gt; NatM Int
</span><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier hs-var hs-var">getFileId</span></a></span></span><span> </span><span id="local-6989586621681837760"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681837760"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Int, NatM_State)) -&gt; NatM Int
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (Int, NatM_State)) -&gt; NatM Int)
-&gt; (NatM_State -&gt; (Int, NatM_State)) -&gt; NatM Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681837761"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837761"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DwarfFiles -&gt; FastString -&gt; Maybe (FastString, Int)
forall key elt. Uniquable key =&gt; UniqFM key elt -&gt; key -&gt; Maybe elt
</span><a href="GHC.Types.Unique.FM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; DwarfFiles
</span><a href="GHC.CmmToAsm.Monad.html#natm_fileid"><span class="hs-identifier hs-var">natm_fileid</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837761"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681837760"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681837763"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681837763"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681837763"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837761"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><span class="annottext">Maybe (FastString, Int)
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681837764"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621681837764"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">DwarfFiles -&gt; Int
forall key elt. UniqFM key elt -&gt; Int
</span><a href="GHC.Types.Unique.FM.html#sizeUFM"><span class="hs-identifier hs-var">sizeUFM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; DwarfFiles
</span><a href="GHC.CmmToAsm.Monad.html#natm_fileid"><span class="hs-identifier hs-var">natm_fileid</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837761"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>                      </span><span id="local-6989586621681837767"><span class="annot"><span class="annottext">fids :: DwarfFiles
</span><a href="#local-6989586621681837767"><span class="hs-identifier hs-var hs-var">fids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DwarfFiles -&gt; FastString -&gt; (FastString, Int) -&gt; DwarfFiles
forall key elt.
Uniquable key =&gt;
UniqFM key elt -&gt; key -&gt; elt -&gt; UniqFM key elt
</span><a href="GHC.Types.Unique.FM.html#addToUFM"><span class="hs-identifier hs-var">addToUFM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; DwarfFiles
</span><a href="GHC.CmmToAsm.Monad.html#natm_fileid"><span class="hs-identifier hs-var">natm_fileid</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837761"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681837760"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681837760"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681837764"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681837764"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, NatM_State) -&gt; (Int, NatM_State)
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">DwarfFiles
</span><a href="#local-6989586621681837767"><span class="hs-identifier hs-var">fids</span></a></span><span> </span><span class="annot"><span class="annottext">DwarfFiles -&gt; (Int, NatM_State) -&gt; (Int, NatM_State)
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681837764"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837761"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#natm_fileid"><span class="hs-identifier hs-var">natm_fileid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681837767"><span class="hs-identifier hs-type">fids</span></a></span><span>  </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier hs-type">getDebugBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#DebugBlock"><span class="hs-identifier hs-type">DebugBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span id="getDebugBlock"><span class="annot"><span class="annottext">getDebugBlock :: BlockId -&gt; NatM (Maybe DebugBlock)
</span><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier hs-var hs-var">getDebugBlock</span></a></span></span><span> </span><span id="local-6989586621681837770"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681837770"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NatM_State -&gt; (Maybe DebugBlock, NatM_State))
-&gt; NatM (Maybe DebugBlock)
forall a. (NatM_State -&gt; (a, NatM_State)) -&gt; NatM a
</span><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-var">NatM</span></a></span><span> </span><span class="annot"><span class="annottext">((NatM_State -&gt; (Maybe DebugBlock, NatM_State))
 -&gt; NatM (Maybe DebugBlock))
-&gt; (NatM_State -&gt; (Maybe DebugBlock, NatM_State))
-&gt; NatM (Maybe DebugBlock)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681837771"><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837771"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyOf LabelMap -&gt; LabelMap DebugBlock -&gt; Maybe DebugBlock
forall a. KeyOf LabelMap -&gt; LabelMap a -&gt; Maybe a
forall (map :: * -&gt; *) a.
IsMap map =&gt;
KeyOf map -&gt; map a -&gt; Maybe a
</span><a href="GHC.Cmm.Dataflow.Collections.html#mapLookup"><span class="hs-identifier hs-var">mapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">KeyOf LabelMap
BlockId
</span><a href="#local-6989586621681837770"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NatM_State -&gt; LabelMap DebugBlock
</span><a href="GHC.CmmToAsm.Monad.html#natm_debug_map"><span class="hs-identifier hs-var">natm_debug_map</span></a></span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837771"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NatM_State
</span><a href="#local-6989586621681837771"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span></pre></body></html>