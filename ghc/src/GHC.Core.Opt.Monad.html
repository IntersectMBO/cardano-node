<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The AQUA Project, Glasgow University, 1993-1998

-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Core.Opt.Monad</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types used in core-to-core passes</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#FloatOutSwitches"><span class="hs-identifier">FloatOutSwitches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- * The monad</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier">CoreM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#runCoreM"><span class="hs-identifier">runCoreM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#mapDynFlagsCoreM"><span class="hs-identifier">mapDynFlagsCoreM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#dropSimplCount"><span class="hs-identifier">dropSimplCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Reading from the monad</span></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getHscEnv"><span class="hs-identifier">getHscEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier">getModule</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#initRuleEnv"><span class="hs-identifier">initRuleEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getExternalRuleBase"><span class="hs-identifier">getExternalRuleBase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier">getDynFlags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getPackageFamInstEnv"><span class="hs-identifier">getPackageFamInstEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getInteractiveContext"><span class="hs-identifier">getInteractiveContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getUniqTag"><span class="hs-identifier">getUniqTag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getNamePprCtx"><span class="hs-identifier">getNamePprCtx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getSrcSpanM"><span class="hs-identifier">getSrcSpanM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Writing to the monad</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#addSimplCount"><span class="hs-identifier">addSimplCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Lifting into the monad</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#liftIOWithCount"><span class="hs-identifier">liftIOWithCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Dealing with annotations</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getAnnotations"><span class="hs-identifier">getAnnotations</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getFirstAnnotations"><span class="hs-identifier">getFirstAnnotations</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Screen output</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#putMsg"><span class="hs-identifier">putMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#putMsgS"><span class="hs-identifier">putMsgS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#errorMsg"><span class="hs-identifier">errorMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#msg"><span class="hs-identifier">msg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#fatalErrorMsg"><span class="hs-identifier">fatalErrorMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#fatalErrorMsgS"><span class="hs-identifier">fatalErrorMsgS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#debugTraceMsg"><span class="hs-identifier">debugTraceMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#debugTraceMsgS"><span class="hs-identifier">debugTraceMsgS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Text.Read.html#read/Text.Read.html#read"><span class="hs-identifier">read</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html"><span class="hs-identifier">GHC.Driver.Env</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html"><span class="hs-identifier">GHC.Core.Rules</span></a></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleBase"><span class="hs-identifier">RuleBase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleEnv"><span class="hs-identifier">RuleEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#mkRuleEnv"><span class="hs-identifier">mkRuleEnv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Stats.html"><span class="hs-identifier">GHC.Core.Opt.Stats</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Stats.html#SimplCount"><span class="hs-identifier">SimplCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Stats.html#zeroSimplCount"><span class="hs-identifier">zeroSimplCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Stats.html#plusSimplCount"><span class="hs-identifier">plusSimplCount</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Annotations.html"><span class="hs-identifier">GHC.Types.Annotations</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html"><span class="hs-identifier">GHC.Types.Unique.Supply</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Error.html"><span class="hs-identifier">GHC.Types.Error</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#errorDiagnostic"><span class="hs-identifier">errorDiagnostic</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html"><span class="hs-identifier">GHC.Utils.Logger</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html"><span class="hs-identifier">GHC.Utils.Monad</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.IOEnv.html"><span class="hs-identifier">GHC.Data.IOEnv</span></a></span><span> </span><span class="hs-keyword">hiding</span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.IOEnv.html#failM"><span class="hs-identifier">failM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.IOEnv.html#failWithM"><span class="hs-identifier">failWithM</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.Data.IOEnv.html"><span class="hs-identifier">GHC.Data.IOEnv</span></a></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IOEnv</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Context.html"><span class="hs-identifier">GHC.Runtime.Context</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Runtime.Context.html#InteractiveContext"><span class="hs-identifier">InteractiveContext</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html"><span class="hs-identifier">GHC.Unit.Module.ModGuts</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.External.html"><span class="hs-identifier">GHC.Unit.External</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Bifunctor.html#/Data.Bifunctor.html"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Bifunctor.html#bimap/Data.Bifunctor.html#bimap"><span class="hs-identifier">bimap</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Dynamic.html#/Data.Dynamic.html"><span class="hs-identifier">Data.Dynamic</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Maybe.html#/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Maybe.html#listToMaybe/Data.Maybe.html#listToMaybe"><span class="hs-identifier">listToMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Word.html#/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Applicative.html#/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#Alternative/GHC.Base.html#Alternative"><span class="hs-identifier">Alternative</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">data</span><span> </span><span id="FloatOutSwitches"><span class="annot"><a href="GHC.Core.Opt.Monad.html#FloatOutSwitches"><span class="hs-identifier hs-var">FloatOutSwitches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FloatOutSwitches"><span class="annot"><a href="GHC.Core.Opt.Monad.html#FloatOutSwitches"><span class="hs-identifier hs-var">FloatOutSwitches</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-77"></span><span>  </span><span id="floatOutLambdas"><span class="annot"><span class="annottext">FloatOutSwitches -&gt; Maybe Int
</span><a href="GHC.Core.Opt.Monad.html#floatOutLambdas"><span class="hs-identifier hs-var hs-var">floatOutLambdas</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ^ Just n &lt;=&gt; float lambdas to top level, if</span><span>
</span><span id="line-78"></span><span>                                   </span><span class="hs-comment">-- doing so will abstract over n or fewer</span><span>
</span><span id="line-79"></span><span>                                   </span><span class="hs-comment">-- value variables</span><span>
</span><span id="line-80"></span><span>                                   </span><span class="hs-comment">-- Nothing &lt;=&gt; float all lambdas to top level,</span><span>
</span><span id="line-81"></span><span>                                   </span><span class="hs-comment">--             regardless of how many free variables</span><span>
</span><span id="line-82"></span><span>                                   </span><span class="hs-comment">-- Just 0 is the vanilla case: float a lambda</span><span>
</span><span id="line-83"></span><span>                                   </span><span class="hs-comment">--    iff it has no free vars</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>  </span><span id="floatOutConstants"><span class="annot"><span class="annottext">FloatOutSwitches -&gt; Bool
</span><a href="GHC.Core.Opt.Monad.html#floatOutConstants"><span class="hs-identifier hs-var hs-var">floatOutConstants</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- ^ True &lt;=&gt; float constants to top level,</span><span>
</span><span id="line-86"></span><span>                                   </span><span class="hs-comment">--            even if they do not escape a lambda</span><span>
</span><span id="line-87"></span><span>  </span><span id="floatOutOverSatApps"><span class="annot"><span class="annottext">FloatOutSwitches -&gt; Bool
</span><a href="GHC.Core.Opt.Monad.html#floatOutOverSatApps"><span class="hs-identifier hs-var hs-var">floatOutOverSatApps</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>                             </span><span class="hs-comment">-- ^ True &lt;=&gt; float out over-saturated applications</span><span>
</span><span id="line-89"></span><span>                             </span><span class="hs-comment">--            based on arity information.</span><span>
</span><span id="line-90"></span><span>                             </span><span class="hs-comment">-- See Note [Floating over-saturated applications]</span><span>
</span><span id="line-91"></span><span>                             </span><span class="hs-comment">-- in GHC.Core.Opt.SetLevels</span><span>
</span><span id="line-92"></span><span>  </span><span id="floatToTopLevelOnly"><span class="annot"><span class="annottext">FloatOutSwitches -&gt; Bool
</span><a href="GHC.Core.Opt.Monad.html#floatToTopLevelOnly"><span class="hs-identifier hs-var hs-var">floatToTopLevelOnly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Allow floating to the top level only.</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#FloatOutSwitches"><span class="hs-identifier hs-type">FloatOutSwitches</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621681936435"><span class="annot"><span class="annottext">ppr :: FloatOutSwitches -&gt; SDoc
</span><a href="#local-6989586621681936435"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FloatOutSwitches -&gt; SDoc
</span><a href="GHC.Core.Opt.Monad.html#pprFloatOutSwitches"><span class="hs-identifier hs-var">pprFloatOutSwitches</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#pprFloatOutSwitches"><span class="hs-identifier hs-type">pprFloatOutSwitches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#FloatOutSwitches"><span class="hs-identifier hs-type">FloatOutSwitches</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-98"></span><span id="pprFloatOutSwitches"><span class="annot"><span class="annottext">pprFloatOutSwitches :: FloatOutSwitches -&gt; SDoc
</span><a href="GHC.Core.Opt.Monad.html#pprFloatOutSwitches"><span class="hs-identifier hs-var hs-var">pprFloatOutSwitches</span></a></span></span><span> </span><span id="local-6989586621681936438"><span class="annot"><span class="annottext">FloatOutSwitches
</span><a href="#local-6989586621681936438"><span class="hs-identifier hs-var">sw</span></a></span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FOS&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-100"></span><span>     </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; [SDoc] -&gt; [SDoc]
forall doc. IsLine doc =&gt; doc -&gt; [doc] -&gt; [doc]
</span><a href="GHC.Utils.Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; [SDoc]) -&gt; [SDoc] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-101"></span><span>     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Lam =&quot;</span></span><span>    </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatOutSwitches -&gt; Maybe Int
</span><a href="GHC.Core.Opt.Monad.html#floatOutLambdas"><span class="hs-identifier hs-var">floatOutLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">FloatOutSwitches
</span><a href="#local-6989586621681936438"><span class="hs-identifier hs-var">sw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Consts =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatOutSwitches -&gt; Bool
</span><a href="GHC.Core.Opt.Monad.html#floatOutConstants"><span class="hs-identifier hs-var">floatOutConstants</span></a></span><span> </span><span class="annot"><span class="annottext">FloatOutSwitches
</span><a href="#local-6989586621681936438"><span class="hs-identifier hs-var">sw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;OverSatApps =&quot;</span></span><span>   </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatOutSwitches -&gt; Bool
</span><a href="GHC.Core.Opt.Monad.html#floatOutOverSatApps"><span class="hs-identifier hs-var">floatOutOverSatApps</span></a></span><span> </span><span class="annot"><span class="annottext">FloatOutSwitches
</span><a href="#local-6989586621681936438"><span class="hs-identifier hs-var">sw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
             Monad and carried data structure definitions
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">data</span><span> </span><span id="CoreReader"><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreReader"><span class="hs-identifier hs-var">CoreReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CoreReader"><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreReader"><span class="hs-identifier hs-var">CoreReader</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-114"></span><span>        </span><span id="cr_hsc_env"><span class="annot"><span class="annottext">CoreReader -&gt; HscEnv
</span><a href="GHC.Core.Opt.Monad.html#cr_hsc_env"><span class="hs-identifier hs-var hs-var">cr_hsc_env</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>        </span><span id="cr_rule_base"><span class="annot"><span class="annottext">CoreReader -&gt; RuleBase
</span><a href="GHC.Core.Opt.Monad.html#cr_rule_base"><span class="hs-identifier hs-var hs-var">cr_rule_base</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleBase"><span class="hs-identifier hs-type">RuleBase</span></a></span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- Home package table rules</span><span>
</span><span id="line-116"></span><span>        </span><span id="cr_module"><span class="annot"><span class="annottext">CoreReader -&gt; Module
</span><a href="GHC.Core.Opt.Monad.html#cr_module"><span class="hs-identifier hs-var hs-var">cr_module</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>        </span><span id="cr_name_ppr_ctx"><span class="annot"><span class="annottext">CoreReader -&gt; NamePprCtx
</span><a href="GHC.Core.Opt.Monad.html#cr_name_ppr_ctx"><span class="hs-identifier hs-var hs-var">cr_name_ppr_ctx</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#NamePprCtx"><span class="hs-identifier hs-type">NamePprCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>        </span><span id="cr_loc"><span class="annot"><span class="annottext">CoreReader -&gt; SrcSpan
</span><a href="GHC.Core.Opt.Monad.html#cr_loc"><span class="hs-identifier hs-var hs-var">cr_loc</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- Use this for log/error messages so they</span><span>
</span><span id="line-119"></span><span>                                             </span><span class="hs-comment">-- are at least tagged with the right source file</span><span>
</span><span id="line-120"></span><span>        </span><span id="cr_uniq_tag"><span class="annot"><span class="annottext">CoreReader -&gt; Char
</span><a href="GHC.Core.Opt.Monad.html#cr_uniq_tag"><span class="hs-identifier hs-var hs-var">cr_uniq_tag</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>      </span><span class="hs-comment">-- Tag for creating unique values</span><span>
</span><span id="line-121"></span><span class="hs-special">}</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- Note: CoreWriter used to be defined with data, rather than newtype.  If it</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- is defined that way again, the cw_simpl_count field, at least, must be</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- strict to avoid a space leak (#7702).</span><span>
</span><span id="line-126"></span><span class="hs-keyword">newtype</span><span> </span><span id="CoreWriter"><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-var">CoreWriter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CoreWriter"><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-var">CoreWriter</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-127"></span><span>        </span><span id="cw_simpl_count"><span class="annot"><span class="annottext">CoreWriter -&gt; SimplCount
</span><a href="GHC.Core.Opt.Monad.html#cw_simpl_count"><span class="hs-identifier hs-var hs-var">cw_simpl_count</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Stats.html#SimplCount"><span class="hs-identifier hs-type">SimplCount</span></a></span><span>
</span><span id="line-128"></span><span class="hs-special">}</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#emptyWriter"><span class="hs-identifier hs-type">emptyWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ -ddump-simpl-stats</span></span><span>
</span><span id="line-131"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span>
</span><span id="line-132"></span><span id="emptyWriter"><span class="annot"><span class="annottext">emptyWriter :: Bool -&gt; CoreWriter
</span><a href="GHC.Core.Opt.Monad.html#emptyWriter"><span class="hs-identifier hs-var hs-var">emptyWriter</span></a></span></span><span> </span><span id="local-6989586621681936455"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681936455"><span class="hs-identifier hs-var">dump_simpl_stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">cw_simpl_count :: SimplCount
</span><a href="GHC.Core.Opt.Monad.html#cw_simpl_count"><span class="hs-identifier hs-var">cw_simpl_count</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SimplCount
</span><a href="GHC.Core.Opt.Stats.html#zeroSimplCount"><span class="hs-identifier hs-var">zeroSimplCount</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681936455"><span class="hs-identifier hs-var">dump_simpl_stats</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#plusWriter"><span class="hs-identifier hs-type">plusWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span>
</span><span id="line-137"></span><span id="plusWriter"><span class="annot"><span class="annottext">plusWriter :: CoreWriter -&gt; CoreWriter -&gt; CoreWriter
</span><a href="GHC.Core.Opt.Monad.html#plusWriter"><span class="hs-identifier hs-var hs-var">plusWriter</span></a></span></span><span> </span><span id="local-6989586621681936457"><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936457"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621681936458"><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936458"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">cw_simpl_count :: SimplCount
</span><a href="GHC.Core.Opt.Monad.html#cw_simpl_count"><span class="hs-identifier hs-var">cw_simpl_count</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreWriter -&gt; SimplCount
</span><a href="GHC.Core.Opt.Monad.html#cw_simpl_count"><span class="hs-identifier hs-var">cw_simpl_count</span></a></span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936457"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SimplCount -&gt; SimplCount -&gt; SimplCount
</span><a href="GHC.Core.Opt.Stats.html#plusSimplCount"><span class="hs-operator hs-var">`plusSimplCount`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreWriter -&gt; SimplCount
</span><a href="GHC.Core.Opt.Monad.html#cw_simpl_count"><span class="hs-identifier hs-var">cw_simpl_count</span></a></span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936458"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">type</span><span> </span><span id="CoreIOEnv"><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreIOEnv"><span class="hs-identifier hs-var">CoreIOEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.IOEnv.html#IOEnv"><span class="hs-identifier hs-type">IOEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreReader"><span class="hs-identifier hs-type">CoreReader</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | The monad used by Core-to-Core passes to register simplification statistics.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--  Also used to have common state (in the form of UniqueSupply) for generating Uniques.</span><span>
</span><span id="line-145"></span><span class="hs-keyword">newtype</span><span> </span><span id="CoreM"><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span></span><span> </span><span id="local-6989586621681936221"><span class="annot"><a href="#local-6989586621681936221"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CoreM"><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unCoreM"><span class="annot"><span class="annottext">forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var hs-var">unCoreM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreIOEnv"><span class="hs-identifier hs-type">CoreIOEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681936221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681936462"><span id="local-6989586621681936466"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; CoreM a -&gt; CoreM b)
-&gt; (forall a b. a -&gt; CoreM b -&gt; CoreM a) -&gt; Functor CoreM
forall a b. a -&gt; CoreM b -&gt; CoreM a
forall a b. (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
fmap :: forall a b. (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
$c&lt;$ :: forall a b. a -&gt; CoreM b -&gt; CoreM a
&lt;$ :: forall a b. a -&gt; CoreM b -&gt; CoreM a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#Functor/GHC.Base.html#Functor"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681936474"><span id="local-6989586621681936477"><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#Monad/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621681936483"><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936483"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621681936484"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. CoreM a -&gt; (a -&gt; CoreM b) -&gt; CoreM b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></a></span></span><span> </span><span id="local-6989586621681936485"><span class="annot"><span class="annottext">a -&gt; CoreM b
</span><a href="#local-6989586621681936485"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (b, CoreWriter) -&gt; CoreM b
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreIOEnv (b, CoreWriter) -&gt; CoreM b)
-&gt; CoreIOEnv (b, CoreWriter) -&gt; CoreM b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681936486"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936486"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681936487"><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936487"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM a -&gt; CoreIOEnv (a, CoreWriter)
forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var">unCoreM</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936483"><span class="hs-identifier hs-var">mx</span></a></span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681936488"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681936488"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681936489"><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936489"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM b -&gt; CoreIOEnv (b, CoreWriter)
forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var">unCoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; CoreM b
</span><a href="#local-6989586621681936485"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936486"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681936490"><span class="annot"><span class="annottext">w :: CoreWriter
</span><a href="#local-6989586621681936490"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936487"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreWriter -&gt; CoreWriter -&gt; CoreWriter
</span><a href="GHC.Core.Opt.Monad.html#plusWriter"><span class="hs-operator hs-var">`plusWriter`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936489"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-153"></span><span>            </span><span class="annot"><span class="annottext">(b, CoreWriter) -&gt; CoreIOEnv (b, CoreWriter)
forall a. a -&gt; IOEnv CoreReader a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">((b, CoreWriter) -&gt; CoreIOEnv (b, CoreWriter))
-&gt; (b, CoreWriter) -&gt; CoreIOEnv (b, CoreWriter)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreWriter -&gt; (b, CoreWriter) -&gt; (b, CoreWriter)
forall a b. a -&gt; b -&gt; b
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936490"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681936488"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936490"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>            </span><span class="hs-comment">-- forcing w before building the tuple avoids a space leak</span><span>
</span><span id="line-155"></span><span>            </span><span class="hs-comment">-- (#7702)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681936496"><span id="local-6989586621681936500"><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#Applicative/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621681936503"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; CoreM a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span> </span><span id="local-6989586621681936504"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936504"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreIOEnv (a, CoreWriter) -&gt; CoreM a)
-&gt; CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; CoreIOEnv (a, CoreWriter)
forall a. a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#nop"><span class="hs-identifier hs-var">nop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936504"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621681936507"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. CoreM (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%2A%3E/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreM (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#ap/GHC.Base.html#ap"><span class="hs-identifier hs-var">ap</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621681936510"><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936510"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681936511"><span class="annot"><span class="annottext">*&gt; :: forall a b. CoreM a -&gt; CoreM b -&gt; CoreM b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2A%3E/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">*&gt;</span></a></span></span><span> </span><span id="local-6989586621681936512"><span class="annot"><span class="annottext">CoreM b
</span><a href="#local-6989586621681936512"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936510"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a -&gt; (a -&gt; CoreM b) -&gt; CoreM b
forall a b. CoreM a -&gt; (a -&gt; CoreM b) -&gt; CoreM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreM b
</span><a href="#local-6989586621681936512"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681936518"><span id="local-6989586621681936522"><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#Alternative/GHC.Base.html#Alternative"><span class="hs-identifier hs-type">Alternative</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621681936527"><span class="annot"><span class="annottext">empty :: forall a. CoreM a
</span><a href="#local-6989586621681936527"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter)
forall a. IOEnv CoreReader a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#empty/GHC.Base.html#empty"><span class="hs-identifier hs-var">Control.Applicative.empty</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621681936530"><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936530"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681936531"><span class="annot"><span class="annottext">&lt;|&gt; :: forall a. CoreM a -&gt; CoreM a -&gt; CoreM a
</span><a href="#local-6989586621681936531"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;|&gt;</span></a></span></span><span> </span><span id="local-6989586621681936533"><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936533"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreM a -&gt; CoreIOEnv (a, CoreWriter)
forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var">unCoreM</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936530"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter)
-&gt; CoreIOEnv (a, CoreWriter) -&gt; CoreIOEnv (a, CoreWriter)
forall a.
IOEnv CoreReader a -&gt; IOEnv CoreReader a -&gt; IOEnv CoreReader a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%7C%3E/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a -&gt; CoreIOEnv (a, CoreWriter)
forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var">unCoreM</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936533"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681936539"><span id="local-6989586621681936543"><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#MonadPlus/GHC.Base.html#MonadPlus"><span class="hs-identifier hs-type">MonadPlus</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span></span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681936551"><span class="annot"><a href="GHC.Types.Unique.Supply.html#MonadUnique"><span class="hs-identifier hs-type">MonadUnique</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621681936557"><span class="annot"><span class="annottext">getUniqueSupplyM :: CoreM UniqSupply
</span><a href="#local-6989586621681936557"><span class="hs-identifier hs-var hs-var hs-var hs-var">getUniqueSupplyM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>        </span><span id="local-6989586621681936559"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681936559"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; Char) -&gt; CoreM Char
forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; Char
</span><a href="GHC.Core.Opt.Monad.html#cr_uniq_tag"><span class="hs-identifier hs-var">cr_uniq_tag</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">IO UniqSupply -&gt; CoreM UniqSupply
forall a. IO a -&gt; CoreM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO UniqSupply -&gt; CoreM UniqSupply)
-&gt; IO UniqSupply -&gt; CoreM UniqSupply
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; IO UniqSupply
</span><a href="GHC.Types.Unique.Supply.html#mkSplitUniqSupply"><span class="hs-identifier hs-var">mkSplitUniqSupply</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681936559"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621681936565"><span class="annot"><span class="annottext">getUniqueM :: CoreM Unique
</span><a href="#local-6989586621681936565"><span class="hs-identifier hs-var hs-var hs-var hs-var">getUniqueM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>        </span><span id="local-6989586621681936567"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681936567"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; Char) -&gt; CoreM Char
forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; Char
</span><a href="GHC.Core.Opt.Monad.html#cr_uniq_tag"><span class="hs-identifier hs-var">cr_uniq_tag</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">IO Unique -&gt; CoreM Unique
forall a. IO a -&gt; CoreM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Unique -&gt; CoreM Unique) -&gt; IO Unique -&gt; CoreM Unique
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; IO Unique
</span><a href="GHC.Types.Unique.Supply.html#uniqFromTag"><span class="hs-identifier hs-var">uniqFromTag</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681936567"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621681936280"><span class="annot"><a href="GHC.Core.Opt.Monad.html#runCoreM"><span class="hs-identifier hs-type">runCoreM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-178"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleBase"><span class="hs-identifier hs-type">RuleBase</span></a></span><span>
</span><span id="line-179"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Mask</span></span><span>
</span><span id="line-180"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-181"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#NamePprCtx"><span class="hs-identifier hs-type">NamePprCtx</span></a></span><span>
</span><span id="line-182"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>
</span><span id="line-183"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936280"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-184"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681936280"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Stats.html#SimplCount"><span class="hs-identifier hs-type">SimplCount</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-185"></span><span id="runCoreM"><span class="annot"><span class="annottext">runCoreM :: forall a.
HscEnv
-&gt; RuleBase
-&gt; Char
-&gt; Module
-&gt; NamePprCtx
-&gt; SrcSpan
-&gt; CoreM a
-&gt; IO (a, SimplCount)
</span><a href="GHC.Core.Opt.Monad.html#runCoreM"><span class="hs-identifier hs-var hs-var">runCoreM</span></a></span></span><span> </span><span id="local-6989586621681936571"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681936571"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621681936572"><span class="annot"><span class="annottext">RuleBase
</span><a href="#local-6989586621681936572"><span class="hs-identifier hs-var">rule_base</span></a></span></span><span> </span><span id="local-6989586621681936573"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681936573"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621681936574"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681936574"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681936575"><span class="annot"><span class="annottext">NamePprCtx
</span><a href="#local-6989586621681936575"><span class="hs-identifier hs-var">name_ppr_ctx</span></a></span></span><span> </span><span id="local-6989586621681936576"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681936576"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681936577"><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936577"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, CoreWriter) -&gt; (a, SimplCount))
-&gt; IO (a, CoreWriter) -&gt; IO (a, SimplCount)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#liftM/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">(a, CoreWriter) -&gt; (a, SimplCount)
forall a. (a, CoreWriter) -&gt; (a, SimplCount)
</span><a href="#local-6989586621681936579"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (a, CoreWriter) -&gt; IO (a, SimplCount))
-&gt; IO (a, CoreWriter) -&gt; IO (a, SimplCount)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader
-&gt; IOEnv CoreReader (a, CoreWriter) -&gt; IO (a, CoreWriter)
forall env a. env -&gt; IOEnv env a -&gt; IO a
</span><a href="GHC.Data.IOEnv.html#runIOEnv"><span class="hs-identifier hs-var">runIOEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader
</span><a href="#local-6989586621681936581"><span class="hs-identifier hs-var">reader</span></a></span><span> </span><span class="annot"><span class="annottext">(IOEnv CoreReader (a, CoreWriter) -&gt; IO (a, CoreWriter))
-&gt; IOEnv CoreReader (a, CoreWriter) -&gt; IO (a, CoreWriter)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a -&gt; IOEnv CoreReader (a, CoreWriter)
forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var">unCoreM</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936577"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621681936581"><span class="annot"><span class="annottext">reader :: CoreReader
</span><a href="#local-6989586621681936581"><span class="hs-identifier hs-var hs-var">reader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreReader"><span class="hs-identifier hs-type">CoreReader</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-189"></span><span>            </span><span class="annot"><span class="annottext">cr_hsc_env :: HscEnv
</span><a href="GHC.Core.Opt.Monad.html#cr_hsc_env"><span class="hs-identifier hs-var">cr_hsc_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681936571"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>            </span><span class="annot"><span class="annottext">cr_rule_base :: RuleBase
</span><a href="GHC.Core.Opt.Monad.html#cr_rule_base"><span class="hs-identifier hs-var">cr_rule_base</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleBase
</span><a href="#local-6989586621681936572"><span class="hs-identifier hs-var">rule_base</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>            </span><span class="annot"><span class="annottext">cr_module :: Module
</span><a href="GHC.Core.Opt.Monad.html#cr_module"><span class="hs-identifier hs-var">cr_module</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681936574"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>            </span><span class="annot"><span class="annottext">cr_name_ppr_ctx :: NamePprCtx
</span><a href="GHC.Core.Opt.Monad.html#cr_name_ppr_ctx"><span class="hs-identifier hs-var">cr_name_ppr_ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamePprCtx
</span><a href="#local-6989586621681936575"><span class="hs-identifier hs-var">name_ppr_ctx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>            </span><span class="annot"><span class="annottext">cr_loc :: SrcSpan
</span><a href="GHC.Core.Opt.Monad.html#cr_loc"><span class="hs-identifier hs-var">cr_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681936576"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><span class="annottext">cr_uniq_tag :: Char
</span><a href="GHC.Core.Opt.Monad.html#cr_uniq_tag"><span class="hs-identifier hs-var">cr_uniq_tag</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681936573"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621681936285"><span class="annot"><a href="#local-6989586621681936579"><span class="hs-identifier hs-type">extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681936285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681936285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Stats.html#SimplCount"><span class="hs-identifier hs-type">SimplCount</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621681936579"><span class="annot"><span class="annottext">extract :: forall a. (a, CoreWriter) -&gt; (a, SimplCount)
</span><a href="#local-6989586621681936579"><span class="hs-identifier hs-var hs-var">extract</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681936582"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936582"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681936583"><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936583"><span class="hs-identifier hs-var">writer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936582"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreWriter -&gt; SimplCount
</span><a href="GHC.Core.Opt.Monad.html#cw_simpl_count"><span class="hs-identifier hs-var">cw_simpl_count</span></a></span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936583"><span class="hs-identifier hs-var">writer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
             Core combinators, not exported
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span id="local-6989586621681936253"><span class="annot"><a href="GHC.Core.Opt.Monad.html#nop"><span class="hs-identifier hs-type">nop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681936253"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreIOEnv"><span class="hs-identifier hs-type">CoreIOEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681936253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-209"></span><span id="nop"><span class="annot"><span class="annottext">nop :: forall a. a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#nop"><span class="hs-identifier hs-var hs-var">nop</span></a></span></span><span> </span><span id="local-6989586621681936587"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936587"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621681936588"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681936588"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span> </span><span class="annot"><span class="annottext">(HscEnv -&gt; Logger)
-&gt; (CoreReader -&gt; HscEnv) -&gt; CoreReader -&gt; Logger
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; HscEnv
</span><a href="GHC.Core.Opt.Monad.html#cr_hsc_env"><span class="hs-identifier hs-var">cr_hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; Logger)
-&gt; IOEnv CoreReader CoreReader -&gt; IOEnv CoreReader Logger
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IOEnv CoreReader CoreReader
forall env. IOEnv env env
</span><a href="GHC.Data.IOEnv.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">(a, CoreWriter) -&gt; CoreIOEnv (a, CoreWriter)
forall a. a -&gt; IOEnv CoreReader a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936587"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CoreWriter
</span><a href="GHC.Core.Opt.Monad.html#emptyWriter"><span class="hs-identifier hs-var">emptyWriter</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; CoreWriter) -&gt; Bool -&gt; CoreWriter
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Logger -&gt; DumpFlag -&gt; Bool
</span><a href="GHC.Utils.Logger.html#logHasDumpFlag"><span class="hs-identifier hs-var">logHasDumpFlag</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681936588"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="GHC.Driver.Flags.html#Opt_D_dump_simpl_stats"><span class="hs-identifier hs-var">Opt_D_dump_simpl_stats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span id="local-6989586621681936277"><span class="annot"><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-type">read</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreReader"><span class="hs-identifier hs-type">CoreReader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681936277"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936277"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-214"></span><span id="read"><span class="annot"><span class="annottext">read :: forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var hs-var">read</span></a></span></span><span> </span><span id="local-6989586621681936596"><span class="annot"><span class="annottext">CoreReader -&gt; a
</span><a href="#local-6989586621681936596"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreIOEnv (a, CoreWriter) -&gt; CoreM a)
-&gt; CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IOEnv CoreReader CoreReader
forall env. IOEnv env env
</span><a href="GHC.Data.IOEnv.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a></span><span> </span><span class="annot"><span class="annottext">IOEnv CoreReader CoreReader
-&gt; (CoreReader -&gt; CoreIOEnv (a, CoreWriter))
-&gt; CoreIOEnv (a, CoreWriter)
forall a b.
IOEnv CoreReader a
-&gt; (a -&gt; IOEnv CoreReader b) -&gt; IOEnv CoreReader b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681936597"><span class="annot"><span class="annottext">CoreReader
</span><a href="#local-6989586621681936597"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; CoreIOEnv (a, CoreWriter)
forall a. a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#nop"><span class="hs-identifier hs-var">nop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreReader -&gt; a
</span><a href="#local-6989586621681936596"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader
</span><a href="#local-6989586621681936597"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#write"><span class="hs-identifier hs-type">write</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span id="write"><span class="annot"><span class="annottext">write :: CoreWriter -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#write"><span class="hs-identifier hs-var hs-var">write</span></a></span></span><span> </span><span id="local-6989586621681936599"><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936599"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv ((), CoreWriter) -&gt; CoreM ()
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreIOEnv ((), CoreWriter) -&gt; CoreM ())
-&gt; CoreIOEnv ((), CoreWriter) -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((), CoreWriter) -&gt; CoreIOEnv ((), CoreWriter)
forall a. a -&gt; IOEnv CoreReader a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><a href="#local-6989586621681936599"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- \subsection{Lifting IO into the monad}</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><span class="hs-comment">-- | Lift an 'IOEnv' operation into 'CoreM'</span></span><span>
</span><span id="line-222"></span><span id="local-6989586621681936300"><span class="annot"><a href="GHC.Core.Opt.Monad.html#liftIOEnv"><span class="hs-identifier hs-type">liftIOEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreIOEnv"><span class="hs-identifier hs-type">CoreIOEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936300"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-223"></span><span id="liftIOEnv"><span class="annot"><span class="annottext">liftIOEnv :: forall a. CoreIOEnv a -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#liftIOEnv"><span class="hs-identifier hs-var hs-var">liftIOEnv</span></a></span></span><span> </span><span id="local-6989586621681936602"><span class="annot"><span class="annottext">CoreIOEnv a
</span><a href="#local-6989586621681936602"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreIOEnv a
</span><a href="#local-6989586621681936602"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">CoreIOEnv a
-&gt; (a -&gt; CoreIOEnv (a, CoreWriter)) -&gt; CoreIOEnv (a, CoreWriter)
forall a b.
IOEnv CoreReader a
-&gt; (a -&gt; IOEnv CoreReader b) -&gt; IOEnv CoreReader b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681936603"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936603"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; CoreIOEnv (a, CoreWriter)
forall a. a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#nop"><span class="hs-identifier hs-var">nop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936603"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#MonadIO/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621681936610"><span class="annot"><span class="annottext">liftIO :: forall a. IO a -&gt; CoreM a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv a -&gt; CoreM a
forall a. CoreIOEnv a -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#liftIOEnv"><span class="hs-identifier hs-var">liftIOEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreIOEnv a -&gt; CoreM a)
-&gt; (IO a -&gt; CoreIOEnv a) -&gt; IO a -&gt; CoreM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; CoreIOEnv a
forall a. IO a -&gt; IOEnv CoreReader a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">IOEnv.liftIO</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><span class="hs-comment">-- | Lift an 'IO' operation into 'CoreM' while consuming its 'SimplCount'</span></span><span>
</span><span id="line-229"></span><span id="local-6989586621681936304"><span class="annot"><a href="GHC.Core.Opt.Monad.html#liftIOWithCount"><span class="hs-identifier hs-type">liftIOWithCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.Stats.html#SimplCount"><span class="hs-identifier hs-type">SimplCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681936304"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936304"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-230"></span><span id="liftIOWithCount"><span class="annot"><span class="annottext">liftIOWithCount :: forall a. IO (SimplCount, a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#liftIOWithCount"><span class="hs-identifier hs-var hs-var">liftIOWithCount</span></a></span></span><span> </span><span id="local-6989586621681936615"><span class="annot"><span class="annottext">IO (SimplCount, a)
</span><a href="#local-6989586621681936615"><span class="hs-identifier hs-var">what</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (SimplCount, a) -&gt; CoreM (SimplCount, a)
forall a. IO a -&gt; CoreM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO (SimplCount, a)
</span><a href="#local-6989586621681936615"><span class="hs-identifier hs-var">what</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM (SimplCount, a) -&gt; ((SimplCount, a) -&gt; CoreM a) -&gt; CoreM a
forall a b. CoreM a -&gt; (a -&gt; CoreM b) -&gt; CoreM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3E%3E%3D/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681936616"><span class="annot"><span class="annottext">SimplCount
</span><a href="#local-6989586621681936616"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681936617"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936617"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimplCount -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#addSimplCount"><span class="hs-identifier hs-var">addSimplCount</span></a></span><span> </span><span class="annot"><span class="annottext">SimplCount
</span><a href="#local-6989586621681936616"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM () -&gt; CoreM a -&gt; CoreM a
forall a b. CoreM a -&gt; CoreM b -&gt; CoreM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3E%3E/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; CoreM a
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936617"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
             Reader, writer and state accessors
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getHscEnv"><span class="hs-identifier hs-type">getHscEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-241"></span><span id="getHscEnv"><span class="annot"><span class="annottext">getHscEnv :: CoreM HscEnv
</span><a href="GHC.Core.Opt.Monad.html#getHscEnv"><span class="hs-identifier hs-var hs-var">getHscEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; HscEnv) -&gt; CoreM HscEnv
forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; HscEnv
</span><a href="GHC.Core.Opt.Monad.html#cr_hsc_env"><span class="hs-identifier hs-var">cr_hsc_env</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getHomeRuleBase"><span class="hs-identifier hs-type">getHomeRuleBase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleBase"><span class="hs-identifier hs-type">RuleBase</span></a></span><span>
</span><span id="line-244"></span><span id="getHomeRuleBase"><span class="annot"><span class="annottext">getHomeRuleBase :: CoreM RuleBase
</span><a href="GHC.Core.Opt.Monad.html#getHomeRuleBase"><span class="hs-identifier hs-var hs-var">getHomeRuleBase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; RuleBase) -&gt; CoreM RuleBase
forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; RuleBase
</span><a href="GHC.Core.Opt.Monad.html#cr_rule_base"><span class="hs-identifier hs-var">cr_rule_base</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#initRuleEnv"><span class="hs-identifier hs-type">initRuleEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleEnv"><span class="hs-identifier hs-type">RuleEnv</span></a></span><span>
</span><span id="line-247"></span><span id="initRuleEnv"><span class="annot"><span class="annottext">initRuleEnv :: ModGuts -&gt; CoreM RuleEnv
</span><a href="GHC.Core.Opt.Monad.html#initRuleEnv"><span class="hs-identifier hs-var hs-var">initRuleEnv</span></a></span></span><span> </span><span id="local-6989586621681936619"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621681936619"><span class="hs-identifier hs-var">guts</span></a></span></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681936620"><span class="annot"><span class="annottext">RuleBase
</span><a href="#local-6989586621681936620"><span class="hs-identifier hs-var">hpt_rules</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM RuleBase
</span><a href="GHC.Core.Opt.Monad.html#getHomeRuleBase"><span class="hs-identifier hs-var">getHomeRuleBase</span></a></span><span>
</span><span id="line-249"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681936621"><span class="annot"><span class="annottext">RuleBase
</span><a href="#local-6989586621681936621"><span class="hs-identifier hs-var">eps_rules</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM RuleBase
</span><a href="GHC.Core.Opt.Monad.html#getExternalRuleBase"><span class="hs-identifier hs-var">getExternalRuleBase</span></a></span><span>
</span><span id="line-250"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">RuleEnv -&gt; CoreM RuleEnv
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; RuleBase -&gt; RuleBase -&gt; RuleEnv
</span><a href="GHC.Core.Rules.html#mkRuleEnv"><span class="hs-identifier hs-var">mkRuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621681936619"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="annot"><span class="annottext">RuleBase
</span><a href="#local-6989586621681936621"><span class="hs-identifier hs-var">eps_rules</span></a></span><span> </span><span class="annot"><span class="annottext">RuleBase
</span><a href="#local-6989586621681936620"><span class="hs-identifier hs-var">hpt_rules</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getExternalRuleBase"><span class="hs-identifier hs-type">getExternalRuleBase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleBase"><span class="hs-identifier hs-type">RuleBase</span></a></span><span>
</span><span id="line-253"></span><span id="getExternalRuleBase"><span class="annot"><span class="annottext">getExternalRuleBase :: CoreM RuleBase
</span><a href="GHC.Core.Opt.Monad.html#getExternalRuleBase"><span class="hs-identifier hs-var hs-var">getExternalRuleBase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExternalPackageState -&gt; RuleBase
</span><a href="GHC.Unit.External.html#eps_rule_base"><span class="hs-identifier hs-var">eps_rule_base</span></a></span><span> </span><span class="annot"><span class="annottext">(ExternalPackageState -&gt; RuleBase)
-&gt; CoreM ExternalPackageState -&gt; CoreM RuleBase
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM ExternalPackageState
</span><a href="GHC.Core.Opt.Monad.html#get_eps"><span class="hs-identifier hs-var">get_eps</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getNamePprCtx"><span class="hs-identifier hs-type">getNamePprCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#NamePprCtx"><span class="hs-identifier hs-type">NamePprCtx</span></a></span><span>
</span><span id="line-256"></span><span id="getNamePprCtx"><span class="annot"><span class="annottext">getNamePprCtx :: CoreM NamePprCtx
</span><a href="GHC.Core.Opt.Monad.html#getNamePprCtx"><span class="hs-identifier hs-var hs-var">getNamePprCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; NamePprCtx) -&gt; CoreM NamePprCtx
forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; NamePprCtx
</span><a href="GHC.Core.Opt.Monad.html#cr_name_ppr_ctx"><span class="hs-identifier hs-var">cr_name_ppr_ctx</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getSrcSpanM"><span class="hs-identifier hs-type">getSrcSpanM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>
</span><span id="line-259"></span><span id="getSrcSpanM"><span class="annot"><span class="annottext">getSrcSpanM :: CoreM SrcSpan
</span><a href="GHC.Core.Opt.Monad.html#getSrcSpanM"><span class="hs-identifier hs-var hs-var">getSrcSpanM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; SrcSpan) -&gt; CoreM SrcSpan
forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; SrcSpan
</span><a href="GHC.Core.Opt.Monad.html#cr_loc"><span class="hs-identifier hs-var">cr_loc</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#addSimplCount"><span class="hs-identifier hs-type">addSimplCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Stats.html#SimplCount"><span class="hs-identifier hs-type">SimplCount</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span id="addSimplCount"><span class="annot"><span class="annottext">addSimplCount :: SimplCount -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#addSimplCount"><span class="hs-identifier hs-var hs-var">addSimplCount</span></a></span></span><span> </span><span id="local-6989586621681936624"><span class="annot"><span class="annottext">SimplCount
</span><a href="#local-6989586621681936624"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreWriter -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#write"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreWriter"><span class="hs-identifier hs-type">CoreWriter</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cw_simpl_count :: SimplCount
</span><a href="GHC.Core.Opt.Monad.html#cw_simpl_count"><span class="hs-identifier hs-var">cw_simpl_count</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplCount
</span><a href="#local-6989586621681936624"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getUniqTag"><span class="hs-identifier hs-type">getUniqTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-265"></span><span id="getUniqTag"><span class="annot"><span class="annottext">getUniqTag :: CoreM Char
</span><a href="GHC.Core.Opt.Monad.html#getUniqTag"><span class="hs-identifier hs-var hs-var">getUniqTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; Char) -&gt; CoreM Char
forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; Char
</span><a href="GHC.Core.Opt.Monad.html#cr_uniq_tag"><span class="hs-identifier hs-var">cr_uniq_tag</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- Convenience accessors for useful fields of HscEnv</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="annot"><span class="hs-comment">-- | Adjust the dyn flags passed to the argument action</span></span><span>
</span><span id="line-270"></span><span id="local-6989586621681936310"><span class="annot"><a href="GHC.Core.Opt.Monad.html#mapDynFlagsCoreM"><span class="hs-identifier hs-type">mapDynFlagsCoreM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936310"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936310"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-271"></span><span id="mapDynFlagsCoreM"><span class="annot"><span class="annottext">mapDynFlagsCoreM :: forall a. (DynFlags -&gt; DynFlags) -&gt; CoreM a -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#mapDynFlagsCoreM"><span class="hs-identifier hs-var hs-var">mapDynFlagsCoreM</span></a></span></span><span> </span><span id="local-6989586621681936627"><span class="annot"><span class="annottext">DynFlags -&gt; DynFlags
</span><a href="#local-6989586621681936627"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681936628"><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936628"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreIOEnv (a, CoreWriter) -&gt; CoreM a)
-&gt; CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">!</span><span id="local-6989586621681936629"><span class="annot"><span class="annottext">CoreReader
</span><a href="#local-6989586621681936629"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv CoreReader CoreReader
forall env. IOEnv env env
</span><a href="GHC.Data.IOEnv.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681936630"><span class="annot"><span class="annottext">e' :: CoreReader
</span><a href="#local-6989586621681936630"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreReader
</span><a href="#local-6989586621681936629"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#cr_hsc_env"><span class="hs-identifier hs-var">cr_hsc_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html#hscUpdateFlags"><span class="hs-identifier hs-type">hscUpdateFlags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936627"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#cr_hsc_env"><span class="hs-identifier hs-var">cr_hsc_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936629"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><span class="annottext">IO (a, CoreWriter) -&gt; CoreIOEnv (a, CoreWriter)
forall a. IO a -&gt; IOEnv CoreReader a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (a, CoreWriter) -&gt; CoreIOEnv (a, CoreWriter))
-&gt; IO (a, CoreWriter) -&gt; CoreIOEnv (a, CoreWriter)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; CoreIOEnv (a, CoreWriter) -&gt; IO (a, CoreWriter)
forall env a. env -&gt; IOEnv env a -&gt; IO a
</span><a href="GHC.Data.IOEnv.html#runIOEnv"><span class="hs-identifier hs-var">runIOEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader
</span><a href="#local-6989586621681936630"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreIOEnv (a, CoreWriter) -&gt; IO (a, CoreWriter))
-&gt; CoreIOEnv (a, CoreWriter) -&gt; IO (a, CoreWriter)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a -&gt; CoreIOEnv (a, CoreWriter)
forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var">unCoreM</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936628"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Drop the single count of the argument action so it doesn't effect</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- the total.</span><span>
</span><span id="line-278"></span><span id="local-6989586621681936312"><span class="annot"><a href="GHC.Core.Opt.Monad.html#dropSimplCount"><span class="hs-identifier hs-type">dropSimplCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936312"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936312"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-279"></span><span id="dropSimplCount"><span class="annot"><span class="annottext">dropSimplCount :: forall a. CoreM a -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#dropSimplCount"><span class="hs-identifier hs-var hs-var">dropSimplCount</span></a></span></span><span> </span><span id="local-6989586621681936634"><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936634"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a. CoreIOEnv (a, CoreWriter) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-var">CoreM</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreIOEnv (a, CoreWriter) -&gt; CoreM a)
-&gt; CoreIOEnv (a, CoreWriter) -&gt; CoreM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681936635"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936635"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreWriter
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM a -&gt; CoreIOEnv (a, CoreWriter)
forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var">unCoreM</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM a
</span><a href="#local-6989586621681936634"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="annottext">CoreM a -&gt; CoreIOEnv (a, CoreWriter)
forall a. CoreM a -&gt; CoreIOEnv (a, CoreWriter)
</span><a href="GHC.Core.Opt.Monad.html#unCoreM"><span class="hs-identifier hs-var">unCoreM</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreM a -&gt; CoreIOEnv (a, CoreWriter))
-&gt; CoreM a -&gt; CoreIOEnv (a, CoreWriter)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; CoreM a
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681936635"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#HasDynFlags"><span class="hs-identifier hs-type">HasDynFlags</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621681936640"><span class="annot"><span class="annottext">getDynFlags :: CoreM DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var hs-var hs-var hs-var">getDynFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HscEnv -&gt; DynFlags) -&gt; CoreM HscEnv -&gt; CoreM DynFlags
forall a b. (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM HscEnv
</span><a href="GHC.Core.Opt.Monad.html#getHscEnv"><span class="hs-identifier hs-var">getHscEnv</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#HasLogger"><span class="hs-identifier hs-type">HasLogger</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621681936645"><span class="annot"><span class="annottext">getLogger :: CoreM Logger
</span><a href="#local-6989586621681936645"><span class="hs-identifier hs-var hs-var hs-var hs-var">getLogger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HscEnv -&gt; Logger) -&gt; CoreM HscEnv -&gt; CoreM Logger
forall a b. (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM HscEnv
</span><a href="GHC.Core.Opt.Monad.html#getHscEnv"><span class="hs-identifier hs-var">getHscEnv</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#HasModule"><span class="hs-identifier hs-type">HasModule</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621681936650"><span class="annot"><span class="annottext">getModule :: CoreM Module
</span><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier hs-var hs-var hs-var hs-var">getModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreReader -&gt; Module) -&gt; CoreM Module
forall a. (CoreReader -&gt; a) -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="annot"><span class="annottext">CoreReader -&gt; Module
</span><a href="GHC.Core.Opt.Monad.html#cr_module"><span class="hs-identifier hs-var">cr_module</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getInteractiveContext"><span class="hs-identifier hs-type">getInteractiveContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Runtime.Context.html#InteractiveContext"><span class="hs-identifier hs-type">InteractiveContext</span></a></span><span>
</span><span id="line-293"></span><span id="getInteractiveContext"><span class="annot"><span class="annottext">getInteractiveContext :: CoreM InteractiveContext
</span><a href="GHC.Core.Opt.Monad.html#getInteractiveContext"><span class="hs-identifier hs-var hs-var">getInteractiveContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; InteractiveContext
</span><a href="GHC.Driver.Env.Types.html#hsc_IC"><span class="hs-identifier hs-var">hsc_IC</span></a></span><span> </span><span class="annot"><span class="annottext">(HscEnv -&gt; InteractiveContext)
-&gt; CoreM HscEnv -&gt; CoreM InteractiveContext
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM HscEnv
</span><a href="GHC.Core.Opt.Monad.html#getHscEnv"><span class="hs-identifier hs-var">getHscEnv</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#getPackageFamInstEnv"><span class="hs-identifier hs-type">getPackageFamInstEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.External.html#PackageFamInstEnv"><span class="hs-identifier hs-type">PackageFamInstEnv</span></a></span><span>
</span><span id="line-296"></span><span id="getPackageFamInstEnv"><span class="annot"><span class="annottext">getPackageFamInstEnv :: CoreM PackageFamInstEnv
</span><a href="GHC.Core.Opt.Monad.html#getPackageFamInstEnv"><span class="hs-identifier hs-var hs-var">getPackageFamInstEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExternalPackageState -&gt; PackageFamInstEnv
</span><a href="GHC.Unit.External.html#eps_fam_inst_env"><span class="hs-identifier hs-var">eps_fam_inst_env</span></a></span><span> </span><span class="annot"><span class="annottext">(ExternalPackageState -&gt; PackageFamInstEnv)
-&gt; CoreM ExternalPackageState -&gt; CoreM PackageFamInstEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM ExternalPackageState
</span><a href="GHC.Core.Opt.Monad.html#get_eps"><span class="hs-identifier hs-var">get_eps</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#get_eps"><span class="hs-identifier hs-type">get_eps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.External.html#ExternalPackageState"><span class="hs-identifier hs-type">ExternalPackageState</span></a></span><span>
</span><span id="line-299"></span><span id="get_eps"><span class="annot"><span class="annottext">get_eps :: CoreM ExternalPackageState
</span><a href="GHC.Core.Opt.Monad.html#get_eps"><span class="hs-identifier hs-var hs-var">get_eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621681936653"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681936653"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM HscEnv
</span><a href="GHC.Core.Opt.Monad.html#getHscEnv"><span class="hs-identifier hs-var">getHscEnv</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">IO ExternalPackageState -&gt; CoreM ExternalPackageState
forall a. IO a -&gt; CoreM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ExternalPackageState -&gt; CoreM ExternalPackageState)
-&gt; IO ExternalPackageState -&gt; CoreM ExternalPackageState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; IO ExternalPackageState
</span><a href="GHC.Driver.Env.html#hscEPS"><span class="hs-identifier hs-var">hscEPS</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681936653"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
             Dealing with annotations
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Get all annotations of a given type. This happens lazily, that is</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- no deserialization will take place until the [a] is actually demanded and</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- the [a] can also be empty (the UniqFM is not filtered).</span><span>
</span><span id="line-314"></span><span class="hs-comment">--</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- This should be done once at the start of a Core-to-Core pass that uses</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- annotations.</span><span>
</span><span id="line-317"></span><span class="hs-comment">--</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- See Note [Annotations]</span><span>
</span><span id="line-319"></span><span id="local-6989586621681936321"><span class="annot"><a href="GHC.Core.Opt.Monad.html#getAnnotations"><span class="hs-identifier hs-type">getAnnotations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Typeable.Internal.html#Typeable/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936321"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Word.html#Word8/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681936321"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Env.html#ModuleEnv"><span class="hs-identifier hs-type">ModuleEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681936321"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681936321"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-320"></span><span id="getAnnotations"><span class="annot"><span class="annottext">getAnnotations :: forall a.
Typeable a =&gt;
([Word8] -&gt; a) -&gt; ModGuts -&gt; CoreM (ModuleEnv [a], NameEnv [a])
</span><a href="GHC.Core.Opt.Monad.html#getAnnotations"><span class="hs-identifier hs-var hs-var">getAnnotations</span></a></span></span><span> </span><span id="local-6989586621681936661"><span class="annot"><span class="annottext">[Word8] -&gt; a
</span><a href="#local-6989586621681936661"><span class="hs-identifier hs-var">deserialize</span></a></span></span><span> </span><span id="local-6989586621681936662"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621681936662"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>     </span><span id="local-6989586621681936663"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681936663"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM HscEnv
</span><a href="GHC.Core.Opt.Monad.html#getHscEnv"><span class="hs-identifier hs-var">getHscEnv</span></a></span><span>
</span><span id="line-322"></span><span>     </span><span id="local-6989586621681936664"><span class="annot"><span class="annottext">AnnEnv
</span><a href="#local-6989586621681936664"><span class="hs-identifier hs-var">ann_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO AnnEnv -&gt; CoreM AnnEnv
forall a. IO a -&gt; CoreM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO AnnEnv -&gt; CoreM AnnEnv) -&gt; IO AnnEnv -&gt; CoreM AnnEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; Maybe ModGuts -&gt; IO AnnEnv
</span><a href="GHC.Driver.Env.html#prepareAnnotations"><span class="hs-identifier hs-var">prepareAnnotations</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681936663"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Maybe ModGuts
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621681936662"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>     </span><span class="annot"><span class="annottext">(ModuleEnv [a], NameEnv [a]) -&gt; CoreM (ModuleEnv [a], NameEnv [a])
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Word8] -&gt; a) -&gt; AnnEnv -&gt; (ModuleEnv [a], NameEnv [a])
forall a.
Typeable a =&gt;
([Word8] -&gt; a) -&gt; AnnEnv -&gt; (ModuleEnv [a], NameEnv [a])
</span><a href="GHC.Types.Annotations.html#deserializeAnns"><span class="hs-identifier hs-var">deserializeAnns</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; a
</span><a href="#local-6989586621681936661"><span class="hs-identifier hs-var">deserialize</span></a></span><span> </span><span class="annot"><span class="annottext">AnnEnv
</span><a href="#local-6989586621681936664"><span class="hs-identifier hs-var">ann_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="annot"><span class="hs-comment">-- | Get at most one annotation of a given type per annotatable item.</span></span><span>
</span><span id="line-326"></span><span id="local-6989586621681936327"><span class="annot"><a href="GHC.Core.Opt.Monad.html#getFirstAnnotations"><span class="hs-identifier hs-type">getFirstAnnotations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Typeable.Internal.html#Typeable/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936327"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Word.html#Word8/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681936327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Env.html#ModuleEnv"><span class="hs-identifier hs-type">ModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681936327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-327"></span><span id="getFirstAnnotations"><span class="annot"><span class="annottext">getFirstAnnotations :: forall a.
Typeable a =&gt;
([Word8] -&gt; a) -&gt; ModGuts -&gt; CoreM (ModuleEnv a, NameEnv a)
</span><a href="GHC.Core.Opt.Monad.html#getFirstAnnotations"><span class="hs-identifier hs-var hs-var">getFirstAnnotations</span></a></span></span><span> </span><span id="local-6989586621681936672"><span class="annot"><span class="annottext">[Word8] -&gt; a
</span><a href="#local-6989586621681936672"><span class="hs-identifier hs-var">deserialize</span></a></span></span><span> </span><span id="local-6989586621681936673"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621681936673"><span class="hs-identifier hs-var">guts</span></a></span></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModuleEnv [a] -&gt; ModuleEnv a)
-&gt; (NameEnv [a] -&gt; NameEnv a)
-&gt; (ModuleEnv [a], NameEnv [a])
-&gt; (ModuleEnv a, NameEnv a)
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><a href="../../base-4.18.3.0/src/Data.Bifunctor.html#bimap/Data.Bifunctor.html#bimap"><span class="hs-identifier hs-var">bimap</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleEnv [a] -&gt; ModuleEnv a
forall {b}. ModuleEnv [b] -&gt; ModuleEnv b
</span><a href="#local-6989586621681936674"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv [a] -&gt; NameEnv a
forall {b}. NameEnv [b] -&gt; NameEnv b
</span><a href="#local-6989586621681936675"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">((ModuleEnv [a], NameEnv [a]) -&gt; (ModuleEnv a, NameEnv a))
-&gt; CoreM (ModuleEnv [a], NameEnv [a])
-&gt; CoreM (ModuleEnv a, NameEnv a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; a) -&gt; ModGuts -&gt; CoreM (ModuleEnv [a], NameEnv [a])
forall a.
Typeable a =&gt;
([Word8] -&gt; a) -&gt; ModGuts -&gt; CoreM (ModuleEnv [a], NameEnv [a])
</span><a href="GHC.Core.Opt.Monad.html#getAnnotations"><span class="hs-identifier hs-var">getAnnotations</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; a
</span><a href="#local-6989586621681936672"><span class="hs-identifier hs-var">deserialize</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621681936673"><span class="hs-identifier hs-var">guts</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621681936674"><span class="annot"><span class="annottext">mod :: ModuleEnv [b] -&gt; ModuleEnv b
</span><a href="#local-6989586621681936674"><span class="hs-identifier hs-var hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Module -&gt; [b] -&gt; Maybe b) -&gt; ModuleEnv [b] -&gt; ModuleEnv b
forall a b. (Module -&gt; a -&gt; Maybe b) -&gt; ModuleEnv a -&gt; ModuleEnv b
</span><a href="GHC.Unit.Module.Env.html#mapMaybeModuleEnv"><span class="hs-identifier hs-var">mapMaybeModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([b] -&gt; Maybe b) -&gt; Module -&gt; [b] -&gt; Maybe b
forall a b. a -&gt; b -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#const/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Maybe b
forall a. [a] -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/Data.Maybe.html#listToMaybe/Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621681936675"><span class="annot"><span class="annottext">name :: NameEnv [b] -&gt; NameEnv b
</span><a href="#local-6989586621681936675"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; Maybe b) -&gt; NameEnv [b] -&gt; NameEnv b
forall a b. (a -&gt; Maybe b) -&gt; NameEnv a -&gt; NameEnv b
</span><a href="GHC.Types.Name.Env.html#mapMaybeNameEnv"><span class="hs-identifier hs-var">mapMaybeNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Maybe b
forall a. [a] -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/Data.Maybe.html#listToMaybe/Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">{-
Note [Annotations]
~~~~~~~~~~~~~~~~~~
A Core-to-Core pass that wants to make use of annotations calls
getAnnotations or getFirstAnnotations at the beginning to obtain a UniqFM with
annotations of a specific type. This produces all annotations from interface
files read so far. However, annotations from interface files read during the
pass will not be visible until getAnnotations is called again. This is similar
to how rules work and probably isn't too bad.

The current implementation could be optimised a bit: when looking up
annotations for a thing from the HomePackageTable, we could search directly in
the module where the thing is defined rather than building one UniqFM which
contains all annotations we know of. This would work because annotations can
only be given to things defined in the same module. However, since we would
only want to deserialise every annotation once, we would have to build a cache
for every module in the HTP. In the end, it's probably not worth it as long as
we aren't using annotations heavily.

************************************************************************
*                                                                      *
                Direct screen output
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#msg"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#MessageClass"><span class="hs-identifier hs-type">MessageClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span id="msg"><span class="annot"><span class="annottext">msg :: MessageClass -&gt; SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#msg"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621681936679"><span class="annot"><span class="annottext">MessageClass
</span><a href="#local-6989586621681936679"><span class="hs-identifier hs-var">msg_class</span></a></span></span><span> </span><span id="local-6989586621681936680"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681936680"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>    </span><span id="local-6989586621681936681"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681936681"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM Logger
forall (m :: * -&gt; *). HasLogger m =&gt; m Logger
</span><a href="GHC.Utils.Logger.html#getLogger"><span class="hs-identifier hs-var">getLogger</span></a></span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621681936682"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681936682"><span class="hs-identifier hs-var">loc</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM SrcSpan
</span><a href="GHC.Core.Opt.Monad.html#getSrcSpanM"><span class="hs-identifier hs-var">getSrcSpanM</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621681936683"><span class="annot"><span class="annottext">NamePprCtx
</span><a href="#local-6989586621681936683"><span class="hs-identifier hs-var">name_ppr_ctx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM NamePprCtx
</span><a href="GHC.Core.Opt.Monad.html#getNamePprCtx"><span class="hs-identifier hs-var">getNamePprCtx</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681936684"><span class="annot"><span class="annottext">sty :: PprStyle
</span><a href="#local-6989586621681936684"><span class="hs-identifier hs-var hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MessageClass
</span><a href="#local-6989586621681936679"><span class="hs-identifier hs-var">msg_class</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-365"></span><span>                </span><span class="annot"><a href="GHC.Types.Error.html#MCDiagnostic"><span class="hs-identifier hs-type">MCDiagnostic</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe DiagnosticCode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="#local-6989586621681936686"><span class="hs-identifier hs-var">err_sty</span></a></span><span>
</span><span id="line-366"></span><span>                </span><span class="annot"><span class="annottext">MessageClass
</span><a href="GHC.Types.Error.html#MCDump"><span class="hs-identifier hs-var">MCDump</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="#local-6989586621681936688"><span class="hs-identifier hs-var">dump_sty</span></a></span><span>
</span><span id="line-367"></span><span>                </span><span class="annot"><span class="annottext">MessageClass
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="#local-6989586621681936689"><span class="hs-identifier hs-var">user_sty</span></a></span><span>
</span><span id="line-368"></span><span>        </span><span id="local-6989586621681936686"><span class="annot"><span class="annottext">err_sty :: PprStyle
</span><a href="#local-6989586621681936686"><span class="hs-identifier hs-var hs-var">err_sty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamePprCtx -&gt; PprStyle
</span><a href="GHC.Utils.Outputable.html#mkErrStyle"><span class="hs-identifier hs-var">mkErrStyle</span></a></span><span> </span><span class="annot"><span class="annottext">NamePprCtx
</span><a href="#local-6989586621681936683"><span class="hs-identifier hs-var">name_ppr_ctx</span></a></span><span>
</span><span id="line-369"></span><span>        </span><span id="local-6989586621681936689"><span class="annot"><span class="annottext">user_sty :: PprStyle
</span><a href="#local-6989586621681936689"><span class="hs-identifier hs-var hs-var">user_sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamePprCtx -&gt; Depth -&gt; PprStyle
</span><a href="GHC.Utils.Outputable.html#mkUserStyle"><span class="hs-identifier hs-var">mkUserStyle</span></a></span><span> </span><span class="annot"><span class="annottext">NamePprCtx
</span><a href="#local-6989586621681936683"><span class="hs-identifier hs-var">name_ppr_ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="GHC.Utils.Outputable.html#AllTheWay"><span class="hs-identifier hs-var">AllTheWay</span></a></span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621681936688"><span class="annot"><span class="annottext">dump_sty :: PprStyle
</span><a href="#local-6989586621681936688"><span class="hs-identifier hs-var hs-var">dump_sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamePprCtx -&gt; PprStyle
</span><a href="GHC.Utils.Outputable.html#mkDumpStyle"><span class="hs-identifier hs-var">mkDumpStyle</span></a></span><span> </span><span class="annot"><span class="annottext">NamePprCtx
</span><a href="#local-6989586621681936683"><span class="hs-identifier hs-var">name_ppr_ctx</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; CoreM ()
forall a. IO a -&gt; CoreM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.3.0/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; CoreM ()) -&gt; IO () -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Logger -&gt; MessageClass -&gt; SrcSpan -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Logger.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681936681"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">MessageClass
</span><a href="#local-6989586621681936679"><span class="hs-identifier hs-var">msg_class</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681936682"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PprStyle -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#withPprStyle"><span class="hs-identifier hs-var">withPprStyle</span></a></span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="#local-6989586621681936684"><span class="hs-identifier hs-var">sty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681936680"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><span class="hs-comment">-- | Output a String message to the screen</span></span><span>
</span><span id="line-374"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#putMsgS"><span class="hs-identifier hs-type">putMsgS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span id="putMsgS"><span class="annot"><span class="annottext">putMsgS :: String -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#putMsgS"><span class="hs-identifier hs-var hs-var">putMsgS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#putMsg"><span class="hs-identifier hs-var">putMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM ()) -&gt; (String -&gt; SDoc) -&gt; String -&gt; CoreM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="annot"><span class="hs-comment">-- | Output a message to the screen</span></span><span>
</span><span id="line-378"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#putMsg"><span class="hs-identifier hs-type">putMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span id="putMsg"><span class="annot"><span class="annottext">putMsg :: SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#putMsg"><span class="hs-identifier hs-var hs-var">putMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageClass -&gt; SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#msg"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">MessageClass
</span><a href="GHC.Types.Error.html#MCInfo"><span class="hs-identifier hs-var">MCInfo</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="annot"><span class="hs-comment">-- | Output an error to the screen. Does not cause the compiler to die.</span></span><span>
</span><span id="line-382"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#errorMsg"><span class="hs-identifier hs-type">errorMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span id="errorMsg"><span class="annot"><span class="annottext">errorMsg :: SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#errorMsg"><span class="hs-identifier hs-var hs-var">errorMsg</span></a></span></span><span> </span><span id="local-6989586621681936697"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681936697"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageClass -&gt; SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#msg"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">MessageClass
</span><a href="GHC.Utils.Error.html#errorDiagnostic"><span class="hs-identifier hs-var">errorDiagnostic</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681936697"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><span class="hs-comment">-- | Output a fatal error to the screen. Does not cause the compiler to die.</span></span><span>
</span><span id="line-386"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#fatalErrorMsgS"><span class="hs-identifier hs-type">fatalErrorMsgS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span id="fatalErrorMsgS"><span class="annot"><span class="annottext">fatalErrorMsgS :: String -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#fatalErrorMsgS"><span class="hs-identifier hs-var hs-var">fatalErrorMsgS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#fatalErrorMsg"><span class="hs-identifier hs-var">fatalErrorMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM ()) -&gt; (String -&gt; SDoc) -&gt; String -&gt; CoreM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="annot"><span class="hs-comment">-- | Output a fatal error to the screen. Does not cause the compiler to die.</span></span><span>
</span><span id="line-390"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#fatalErrorMsg"><span class="hs-identifier hs-type">fatalErrorMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span id="fatalErrorMsg"><span class="annot"><span class="annottext">fatalErrorMsg :: SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#fatalErrorMsg"><span class="hs-identifier hs-var hs-var">fatalErrorMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageClass -&gt; SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#msg"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">MessageClass
</span><a href="GHC.Types.Error.html#MCFatal"><span class="hs-identifier hs-var">MCFatal</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><span class="hs-comment">-- | Output a string debugging message at verbosity level of @-v@ or higher</span></span><span>
</span><span id="line-394"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#debugTraceMsgS"><span class="hs-identifier hs-type">debugTraceMsgS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span id="debugTraceMsgS"><span class="annot"><span class="annottext">debugTraceMsgS :: String -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#debugTraceMsgS"><span class="hs-identifier hs-var hs-var">debugTraceMsgS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM ()) -&gt; (String -&gt; SDoc) -&gt; String -&gt; CoreM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- | Outputs a debugging message at verbosity level of @-v@ or higher</span></span><span>
</span><span id="line-398"></span><span class="annot"><a href="GHC.Core.Opt.Monad.html#debugTraceMsg"><span class="hs-identifier hs-type">debugTraceMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span id="debugTraceMsg"><span class="annot"><span class="annottext">debugTraceMsg :: SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#debugTraceMsg"><span class="hs-identifier hs-var hs-var">debugTraceMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageClass -&gt; SDoc -&gt; CoreM ()
</span><a href="GHC.Core.Opt.Monad.html#msg"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">MessageClass
</span><a href="GHC.Types.Error.html#MCDump"><span class="hs-identifier hs-var">MCDump</span></a></span><span>
</span><span id="line-400"></span></pre></body></html>