<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">-- | Handy functions for creating much Core syntax</span></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Core.Make</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-5"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Constructing normal syntax</span></span><span>
</span><span id="line-6"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreLet"><span class="hs-identifier">mkCoreLet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreLets"><span class="hs-identifier">mkCoreLets</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApp"><span class="hs-identifier">mkCoreApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier">mkCoreApps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier">mkCoreConApps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreLams"><span class="hs-identifier">mkCoreLams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkWildCase"><span class="hs-identifier">mkWildCase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkIfThenElse"><span class="hs-identifier">mkIfThenElse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkWildValBinder"><span class="hs-identifier">mkWildValBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkWildEvBinder"><span class="hs-identifier">mkWildEvBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>        </span><span class="annot"><a href="GHC.Core.Utils.html#mkSingleAltCase"><span class="hs-identifier">mkSingleAltCase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#sortQuantVars"><span class="hs-identifier">sortQuantVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#castBottomExpr"><span class="hs-identifier">castBottomExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Constructing boxed literals</span></span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkLitRubbish"><span class="hs-identifier">mkLitRubbish</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkWordExpr"><span class="hs-identifier">mkWordExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkIntExpr"><span class="hs-identifier">mkIntExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkIntExprInt"><span class="hs-identifier">mkIntExprInt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkUncheckedIntExpr"><span class="hs-identifier">mkUncheckedIntExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier">mkIntegerExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier">mkNaturalExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkFloatExpr"><span class="hs-identifier">mkFloatExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkDoubleExpr"><span class="hs-identifier">mkDoubleExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkCharExpr"><span class="hs-identifier">mkCharExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkStringExpr"><span class="hs-identifier">mkStringExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkStringExprFS"><span class="hs-identifier">mkStringExprFS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkStringExprFSWith"><span class="hs-identifier">mkStringExprFSWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#MkStringIds"><span class="hs-identifier">MkStringIds</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#getMkStringIds"><span class="hs-identifier">getMkStringIds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Floats</span></span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#FloatBind"><span class="hs-identifier">FloatBind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#wrapFloat"><span class="hs-identifier">wrapFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#wrapFloats"><span class="hs-identifier">wrapFloats</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#floatBindings"><span class="hs-identifier">floatBindings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Constructing small tuples</span></span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreVarTupTy"><span class="hs-identifier">mkCoreVarTupTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreTup"><span class="hs-identifier">mkCoreTup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier">mkCoreUnboxedTuple</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedSum"><span class="hs-identifier">mkCoreUnboxedSum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreTupBoxity"><span class="hs-identifier">mkCoreTupBoxity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#unitExpr"><span class="hs-identifier">unitExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Constructing big tuples</span></span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkChunkified"><span class="hs-identifier">mkChunkified</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier">chunkify</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreVarTup"><span class="hs-identifier">mkBigCoreVarTup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreVarTupSolo"><span class="hs-identifier">mkBigCoreVarTupSolo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreVarTupTy"><span class="hs-identifier">mkBigCoreVarTupTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreTupTy"><span class="hs-identifier">mkBigCoreTupTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreTup"><span class="hs-identifier">mkBigCoreTup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>          </span><span class="annot"><span class="hs-comment">-- * Deconstructing big tuples</span></span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkBigTupleSelector"><span class="hs-identifier">mkBigTupleSelector</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkBigTupleSelectorSolo"><span class="hs-identifier">mkBigTupleSelectorSolo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkBigTupleCase"><span class="hs-identifier">mkBigTupleCase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Constructing list expressions</span></span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkNilExpr"><span class="hs-identifier">mkNilExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkConsExpr"><span class="hs-identifier">mkConsExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkListExpr"><span class="hs-identifier">mkListExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkFoldrExpr"><span class="hs-identifier">mkFoldrExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkBuildExpr"><span class="hs-identifier">mkBuildExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Constructing Maybe expressions</span></span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkNothingExpr"><span class="hs-identifier">mkNothingExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkJustExpr"><span class="hs-identifier">mkJustExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Error Ids</span></span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#mkRuntimeErrorApp"><span class="hs-identifier">mkRuntimeErrorApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkImpossibleExpr"><span class="hs-identifier">mkImpossibleExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkAbsentErrorApp"><span class="hs-identifier">mkAbsentErrorApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#errorIds"><span class="hs-identifier">errorIds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#rEC_CON_ERROR_ID"><span class="hs-identifier">rEC_CON_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier">nO_METHOD_BINDING_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#pAT_ERROR_ID"><span class="hs-identifier">pAT_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#rEC_SEL_ERROR_ID"><span class="hs-identifier">rEC_SEL_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><a href="GHC.Core.Make.html#tYPE_ERROR_ID"><span class="hs-identifier">tYPE_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#aBSENT_SUM_FIELD_ERROR_ID"><span class="hs-identifier">aBSENT_SUM_FIELD_ERROR_ID</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#EvVar"><span class="hs-identifier">EvVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#setTyVarUnique"><span class="hs-identifier">setTyVarUnique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#visArgConstraintLike"><span class="hs-identifier">visArgConstraintLike</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.TyThing.html"><span class="hs-identifier">GHC.Types.TyThing</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html"><span class="hs-identifier">GHC.Types.Id.Info</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Cpr.html"><span class="hs-identifier">GHC.Types.Cpr</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TypeOrConstraint"><span class="hs-identifier">TypeOrConstraint</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Demand.html"><span class="hs-identifier">GHC.Types.Demand</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>      </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier">varName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html"><span class="hs-identifier">GHC.Types.Unique.Supply</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html"><span class="hs-identifier">GHC.Core.Utils</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier">exprType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#mkSingleAltCase"><span class="hs-identifier">mkSingleAltCase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#bindNonRec"><span class="hs-identifier">bindNonRec</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html"><span class="hs-identifier">GHC.Core.TyCo.Compare</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-identifier">eqType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier">isCoVar</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier">DataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier">dataConWorkId</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Multiplicity.html"><span class="hs-identifier">GHC.Core.Multiplicity</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html"><span class="hs-identifier">GHC.Utils.Panic.Plain</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Settings.Constants.html"><span class="hs-identifier">GHC.Settings.Constants</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Settings.Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier">mAX_TUPLE_SIZE</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.List.html#/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.OldList.html#partition/Data.OldList.html#partition"><span class="hs-identifier">partition</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Char.html#/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#ord/GHC.Base.html#ord"><span class="hs-identifier">ord</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApp"><span class="hs-operator hs-type">`mkCoreApp`</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-operator hs-type">`mkCoreApps`</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Basic GHC.Core construction}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Sort the variables, putting type and covars first, in scoped order,</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- and then other Ids</span><span>
</span><span id="line-101"></span><span class="hs-comment">--</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- It is a deterministic sort, meaning it doesn't look at the values of</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- Uniques. For explanation why it's important See Note [Unique Determinism]</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- in GHC.Types.Unique.</span><span>
</span><span id="line-105"></span><span class="annot"><a href="GHC.Core.Make.html#sortQuantVars"><span class="hs-identifier hs-type">sortQuantVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span id="sortQuantVars"><span class="annot"><span class="annottext">sortQuantVars :: [Id] -&gt; [Id]
</span><a href="GHC.Core.Make.html#sortQuantVars"><span class="hs-identifier hs-var hs-var">sortQuantVars</span></a></span></span><span> </span><span id="local-6989586621681673229"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673229"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673230"><span class="hs-identifier hs-var">sorted_tcvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [Id] -&gt; [Id]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673231"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681673232"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673232"><span class="hs-identifier hs-var">tcvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673231"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673231"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Bool) -&gt; [Id] -&gt; ([Id], [Id])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base-4.18.3.0/src/Data.OldList.html#partition/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Bool) -&gt; (Id -&gt; Bool) -&gt; Id -&gt; Bool
forall (f :: * -&gt; *). Applicative f =&gt; f Bool -&gt; f Bool -&gt; f Bool
</span><a href="GHC.Utils.Misc.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">&lt;||&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673229"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621681673230"><span class="annot"><span class="annottext">sorted_tcvs :: [Id]
</span><a href="#local-6989586621681673230"><span class="hs-identifier hs-var hs-var">sorted_tcvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [Id]
</span><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673232"><span class="hs-identifier hs-var">tcvs</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Bind a binding group over an expression, using a @let@ or @case@ as</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- appropriate (see &quot;GHC.Core#let_can_float_invariant&quot;)</span><span>
</span><span id="line-113"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreLet"><span class="hs-identifier hs-type">mkCoreLet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-114"></span><span id="mkCoreLet"><span class="annot"><span class="annottext">mkCoreLet :: CoreBind -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreLet"><span class="hs-identifier hs-var hs-var">mkCoreLet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-type">NonRec</span></a></span><span> </span><span id="local-6989586621681673237"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673237"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621681673238"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673238"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681673239"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673239"><span class="hs-identifier hs-var">body</span></a></span></span><span>        </span><span class="hs-comment">-- See Note [Core let-can-float invariant]</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Id -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
Id -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#bindNonRec"><span class="hs-identifier hs-var">bindNonRec</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673237"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673238"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673239"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-116"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreLet"><span class="hs-identifier hs-var">mkCoreLet</span></a></span><span> </span><span id="local-6989586621681673240"><span class="annot"><span class="annottext">CoreBind
</span><a href="#local-6989586621681673240"><span class="hs-identifier hs-var">bind</span></a></span></span><span> </span><span id="local-6989586621681673241"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673241"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreBind -&gt; CoreExpr -&gt; CoreExpr
forall b. Bind b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBind
</span><a href="#local-6989586621681673240"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673241"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Create a lambda where the given expression has a number of variables</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- bound over it. The leftmost binder is that bound by the outermost</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- lambda in the result</span><span>
</span><span id="line-122"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreLams"><span class="hs-identifier hs-type">mkCoreLams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-123"></span><span id="mkCoreLams"><span class="annot"><span class="annottext">mkCoreLams :: [Id] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreLams"><span class="hs-identifier hs-var hs-var">mkCoreLams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | Bind a list of binding groups over an expression. The leftmost binding</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- group becomes the outermost group in the resulting expression</span><span>
</span><span id="line-127"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreLets"><span class="hs-identifier hs-type">mkCoreLets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-128"></span><span id="mkCoreLets"><span class="annot"><span class="annottext">mkCoreLets :: [CoreBind] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreLets"><span class="hs-identifier hs-var hs-var">mkCoreLets</span></a></span></span><span> </span><span id="local-6989586621681673245"><span class="annot"><span class="annottext">[CoreBind]
</span><a href="#local-6989586621681673245"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621681673246"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673246"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreBind -&gt; CoreExpr -&gt; CoreExpr)
-&gt; CoreExpr -&gt; [CoreBind] -&gt; CoreExpr
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBind -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreLet"><span class="hs-identifier hs-var">mkCoreLet</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673246"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreBind]
</span><a href="#local-6989586621681673245"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | Construct an expression which represents the application of a number of</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- expressions to that of a data constructor expression. The leftmost expression</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- in the list is applied first</span><span>
</span><span id="line-133"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-type">mkCoreConApps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-134"></span><span id="mkCoreConApps"><span class="annot"><span class="annottext">mkCoreConApps :: DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var hs-var">mkCoreConApps</span></a></span></span><span> </span><span id="local-6989586621681673248"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681673248"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681673249"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673249"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-var">mkCoreApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Id
</span><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier hs-var">dataConWorkId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681673248"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673249"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Construct an expression which represents the application of a number of</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- expressions to another. The leftmost expression in the list is applied first</span><span>
</span><span id="line-138"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-type">mkCoreApps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ function</span></span><span>
</span><span id="line-139"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ arguments</span></span><span>
</span><span id="line-140"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-141"></span><span id="mkCoreApps"><span class="annot"><span class="annottext">mkCoreApps :: CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-var hs-var">mkCoreApps</span></a></span></span><span> </span><span id="local-6989586621681673251"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673251"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681673252"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673252"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, Kind) -&gt; CoreExpr
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((CoreExpr, Kind) -&gt; CoreExpr) -&gt; (CoreExpr, Kind) -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">((CoreExpr, Kind) -&gt; CoreExpr -&gt; (CoreExpr, Kind))
-&gt; (CoreExpr, Kind) -&gt; [CoreExpr] -&gt; (CoreExpr, Kind)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldl%27/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; (CoreExpr, Kind) -&gt; CoreExpr -&gt; (CoreExpr, Kind)
</span><a href="GHC.Core.Make.html#mkCoreAppTyped"><span class="hs-identifier hs-var">mkCoreAppTyped</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681673256"><span class="hs-identifier hs-var">doc_string</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673251"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673257"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673252"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621681673256"><span class="annot"><span class="annottext">doc_string :: SDoc
</span><a href="#local-6989586621681673256"><span class="hs-identifier hs-var hs-var">doc_string</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673257"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673251"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673252"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621681673257"><span class="annot"><span class="annottext">fun_ty :: Kind
</span><a href="#local-6989586621681673257"><span class="hs-identifier hs-var hs-var">fun_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673251"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | Construct an expression which represents the application of one expression</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- to the other</span><span>
</span><span id="line-150"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApp"><span class="hs-identifier hs-type">mkCoreApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-151"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ function</span></span><span>
</span><span id="line-152"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ argument</span></span><span>
</span><span id="line-153"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-154"></span><span id="mkCoreApp"><span class="annot"><span class="annottext">mkCoreApp :: SDoc -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreApp"><span class="hs-identifier hs-var hs-var">mkCoreApp</span></a></span></span><span> </span><span id="local-6989586621681673260"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681673260"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681673261"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673261"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681673262"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673262"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, Kind) -&gt; CoreExpr
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((CoreExpr, Kind) -&gt; CoreExpr) -&gt; (CoreExpr, Kind) -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; (CoreExpr, Kind) -&gt; CoreExpr -&gt; (CoreExpr, Kind)
</span><a href="GHC.Core.Make.html#mkCoreAppTyped"><span class="hs-identifier hs-var">mkCoreAppTyped</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681673260"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673261"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673261"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673262"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Construct an expression which represents the application of one expression</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- paired with its type to an argument. The result is paired with its type. This</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- function is not exported and used in the definition of 'mkCoreApp' and</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- 'mkCoreApps'.</span><span>
</span><span id="line-161"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreAppTyped"><span class="hs-identifier hs-type">mkCoreAppTyped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span id="mkCoreAppTyped"><span class="annot"><span class="annottext">mkCoreAppTyped :: SDoc -&gt; (CoreExpr, Kind) -&gt; CoreExpr -&gt; (CoreExpr, Kind)
</span><a href="GHC.Core.Make.html#mkCoreAppTyped"><span class="hs-identifier hs-var hs-var">mkCoreAppTyped</span></a></span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681673264"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673264"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673265"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673265"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621681673267"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673267"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673264"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673267"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind -&gt; Kind
Kind -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#piResultTy"><span class="hs-identifier hs-var">piResultTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673265"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673267"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreAppTyped"><span class="hs-identifier hs-var">mkCoreAppTyped</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681673270"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673270"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673271"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673271"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span id="local-6989586621681673273"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681673273"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673270"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; CoreExpr
forall b. Coercion -&gt; Expr b
</span><a href="GHC.Core.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681673273"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#funResultTy"><span class="hs-identifier hs-var">funResultTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673271"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreAppTyped"><span class="hs-identifier hs-var">mkCoreAppTyped</span></a></span><span> </span><span id="local-6989586621681673275"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681673275"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681673276"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673276"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673277"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673277"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681673278"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673278"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; (CoreExpr, Kind) -&gt; (CoreExpr, Kind)
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier hs-var">isFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673277"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673276"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673278"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681673275"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673276"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673278"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#funResultTy"><span class="hs-identifier hs-var">funResultTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673277"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
              Building case expressions
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="GHC.Core.Make.html#mkWildEvBinder"><span class="hs-identifier hs-type">mkWildEvBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a></span><span>
</span><span id="line-177"></span><span id="mkWildEvBinder"><span class="annot"><span class="annottext">mkWildEvBinder :: Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mkWildEvBinder"><span class="hs-identifier hs-var hs-var">mkWildEvBinder</span></a></span></span><span> </span><span id="local-6989586621681673282"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673282"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mkWildValBinder"><span class="hs-identifier hs-var">mkWildValBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673282"><span class="hs-identifier hs-var">pred</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Make a /wildcard binder/. This is typically used when you need a binder</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- that you expect to use only at a *binding* site.  Do not use it at</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- occurrence sites because it has a single, fixed unique, and it's very</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- easy to get into difficulties with shadowing.  That's why it is used so little.</span><span>
</span><span id="line-183"></span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- See Note [WildCard binders] in &quot;GHC.Core.Opt.Simplify.Env&quot;</span><span>
</span><span id="line-185"></span><span class="annot"><a href="GHC.Core.Make.html#mkWildValBinder"><span class="hs-identifier hs-type">mkWildValBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-186"></span><span id="mkWildValBinder"><span class="annot"><span class="annottext">mkWildValBinder :: Kind -&gt; Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mkWildValBinder"><span class="hs-identifier hs-var hs-var">mkWildValBinder</span></a></span></span><span> </span><span id="local-6989586621681673285"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673285"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681673286"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673286"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Kind -&gt; Id
</span><a href="GHC.Types.Id.html#mkLocalIdOrCoVar"><span class="hs-identifier hs-var">mkLocalIdOrCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#wildCardName"><span class="hs-identifier hs-var">wildCardName</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673285"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673286"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">-- &quot;OrCoVar&quot; since a coercion can be a scrutinee with -fdefer-type-errors</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">-- (e.g. see test T15695). Ticket #17291 covers fixing this problem.</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Make a case expression whose case binder is unused</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- The alts and res_ty should not have any occurrences of WildId</span><span>
</span><span id="line-192"></span><span class="annot"><a href="GHC.Core.Make.html#mkWildCase"><span class="hs-identifier hs-type">mkWildCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ scrutinee</span></span><span>
</span><span id="line-193"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-194"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ res_ty</span></span><span>
</span><span id="line-195"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ alts</span></span><span>
</span><span id="line-196"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-197"></span><span id="mkWildCase"><span class="annot"><span class="annottext">mkWildCase :: CoreExpr -&gt; Scaled Kind -&gt; Kind -&gt; [CoreAlt] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkWildCase"><span class="hs-identifier hs-var hs-var">mkWildCase</span></a></span></span><span> </span><span id="local-6989586621681673289"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673289"><span class="hs-identifier hs-var">scrut</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span id="local-6989586621681673291"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673291"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681673292"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673292"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681673293"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673293"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span id="local-6989586621681673294"><span class="annot"><span class="annottext">[CoreAlt]
</span><a href="#local-6989586621681673294"><span class="hs-identifier hs-var">alts</span></a></span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; Kind -&gt; [CoreAlt] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; Kind -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673289"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mkWildValBinder"><span class="hs-identifier hs-var">mkWildValBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673291"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673292"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673293"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreAlt]
</span><a href="#local-6989586621681673294"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="GHC.Core.Make.html#mkIfThenElse"><span class="hs-identifier hs-type">mkIfThenElse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ guard</span></span><span>
</span><span id="line-201"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ then</span></span><span>
</span><span id="line-202"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ else</span></span><span>
</span><span id="line-203"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-204"></span><span id="mkIfThenElse"><span class="annot"><span class="annottext">mkIfThenElse :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIfThenElse"><span class="hs-identifier hs-var hs-var">mkIfThenElse</span></a></span></span><span> </span><span id="local-6989586621681673296"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673296"><span class="hs-identifier hs-var">guard</span></a></span></span><span> </span><span id="local-6989586621681673297"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673297"><span class="hs-identifier hs-var">then_expr</span></a></span></span><span> </span><span id="local-6989586621681673298"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673298"><span class="hs-identifier hs-var">else_expr</span></a></span></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- Not going to be refining, so okay to take the type of the &quot;then&quot; clause</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Scaled Kind -&gt; Kind -&gt; [CoreAlt] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkWildCase"><span class="hs-identifier hs-var">mkWildCase</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673296"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Scaled Kind
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#linear"><span class="hs-identifier hs-var">linear</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#boolTy"><span class="hs-identifier hs-var">boolTy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673297"><span class="hs-identifier hs-var">then_expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#falseDataCon"><span class="hs-identifier hs-var">falseDataCon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673298"><span class="hs-identifier hs-var">else_expr</span></a></span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- Increasing order of tag!</span><span>
</span><span id="line-208"></span><span>           </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#trueDataCon"><span class="hs-identifier hs-var">trueDataCon</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673297"><span class="hs-identifier hs-var">then_expr</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="GHC.Core.Make.html#castBottomExpr"><span class="hs-identifier hs-type">castBottomExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- (castBottomExpr e ty), assuming that 'e' diverges,</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- return an expression of type 'ty'</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- See Note [Empty case alternatives] in GHC.Core</span><span>
</span><span id="line-214"></span><span id="castBottomExpr"><span class="annot"><span class="annottext">castBottomExpr :: CoreExpr -&gt; Kind -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#castBottomExpr"><span class="hs-identifier hs-var hs-var">castBottomExpr</span></a></span></span><span> </span><span id="local-6989586621681673305"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673305"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681673306"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673306"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673307"><span class="hs-identifier hs-var">e_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673306"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673305"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; Kind -&gt; [CoreAlt] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; Kind -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673305"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mkWildValBinder"><span class="hs-identifier hs-var">mkWildValBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#OneTy"><span class="hs-identifier hs-var">OneTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673307"><span class="hs-identifier hs-var">e_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673306"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621681673307"><span class="annot"><span class="annottext">e_ty :: Kind
</span><a href="#local-6989586621681673307"><span class="hs-identifier hs-var hs-var">e_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673305"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><a href="GHC.Core.Make.html#mkLitRubbish"><span class="hs-identifier hs-type">mkLitRubbish</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- Make a rubbish-literal CoreExpr of the given type.</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- Fail (returning Nothing) if</span><span>
</span><span id="line-223"></span><span class="hs-comment">--    * the RuntimeRep of the Type is not monomorphic;</span><span>
</span><span id="line-224"></span><span class="hs-comment">--    * the type is (a ~# b), the type of coercion</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- See INVARIANT 1 and 2 of item (2) in Note [Rubbish literals]</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- in GHC.Types.Literal</span><span>
</span><span id="line-227"></span><span id="mkLitRubbish"><span class="annot"><span class="annottext">mkLitRubbish :: Kind -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Make.html#mkLitRubbish"><span class="hs-identifier hs-var hs-var">mkLitRubbish</span></a></span></span><span> </span><span id="local-6989586621681673309"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673309"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier hs-var">noFreeVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673312"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>   </span><span class="hs-comment">-- Satisfy INVARIANT 1</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="GHC.Core.Type.html#isCoVarType"><span class="hs-identifier hs-var">isCoVarType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673309"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>   </span><span class="hs-comment">-- Satisfy INVARIANT 2</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Kind -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621681673316"><span class="hs-identifier hs-var">torc</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673312"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Kind] -&gt; CoreExpr
forall b. Expr b -&gt; [Kind] -&gt; Expr b
</span><a href="GHC.Core.html#mkTyApps"><span class="hs-operator hs-var">`mkTyApps`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673309"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681673316"><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621681673316"><span class="hs-identifier hs-var">torc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673312"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673312"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Maybe (TypeOrConstraint, Kind)
</span><a href="GHC.Core.Type.html#sORTKind_maybe"><span class="hs-identifier hs-var">sORTKind_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673309"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Making literals}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Int@</span></span><span>
</span><span id="line-246"></span><span class="annot"><a href="GHC.Core.Make.html#mkIntExpr"><span class="hs-identifier hs-type">mkIntExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>        </span><span class="hs-comment">-- Result = I# i :: Int</span><span>
</span><span id="line-247"></span><span id="mkIntExpr"><span class="annot"><span class="annottext">mkIntExpr :: Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntExpr"><span class="hs-identifier hs-var hs-var">mkIntExpr</span></a></span></span><span> </span><span id="local-6989586621681673320"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673320"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681673321"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673321"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#intDataCon"><span class="hs-identifier hs-var">intDataCon</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
forall b. Platform -&gt; Integer -&gt; Expr b
</span><a href="GHC.Core.html#mkIntLit"><span class="hs-identifier hs-var">mkIntLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673320"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673321"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Int@. Don't check</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- that the number is in the range of the target platform @Int@</span><span>
</span><span id="line-251"></span><span class="annot"><a href="GHC.Core.Make.html#mkUncheckedIntExpr"><span class="hs-identifier hs-type">mkUncheckedIntExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>        </span><span class="hs-comment">-- Result = I# i :: Int</span><span>
</span><span id="line-252"></span><span id="mkUncheckedIntExpr"><span class="annot"><span class="annottext">mkUncheckedIntExpr :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkUncheckedIntExpr"><span class="hs-identifier hs-var hs-var">mkUncheckedIntExpr</span></a></span></span><span> </span><span id="local-6989586621681673324"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673324"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#intDataCon"><span class="hs-identifier hs-var">intDataCon</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitIntUnchecked"><span class="hs-identifier hs-var">mkLitIntUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673324"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Int@</span></span><span>
</span><span id="line-255"></span><span class="annot"><a href="GHC.Core.Make.html#mkIntExprInt"><span class="hs-identifier hs-type">mkIntExprInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>         </span><span class="hs-comment">-- Result = I# i :: Int</span><span>
</span><span id="line-256"></span><span id="mkIntExprInt"><span class="annot"><span class="annottext">mkIntExprInt :: Platform -&gt; Int -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntExprInt"><span class="hs-identifier hs-var hs-var">mkIntExprInt</span></a></span></span><span> </span><span id="local-6989586621681673326"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673326"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681673327"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673327"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#intDataCon"><span class="hs-identifier hs-var">intDataCon</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
forall b. Platform -&gt; Integer -&gt; Expr b
</span><a href="GHC.Core.html#mkIntLit"><span class="hs-identifier hs-var">mkIntLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673326"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673327"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to a @Word@ with the given value</span></span><span>
</span><span id="line-259"></span><span class="annot"><a href="GHC.Core.Make.html#mkWordExpr"><span class="hs-identifier hs-type">mkWordExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-260"></span><span id="mkWordExpr"><span class="annot"><span class="annottext">mkWordExpr :: Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkWordExpr"><span class="hs-identifier hs-var hs-var">mkWordExpr</span></a></span></span><span> </span><span id="local-6989586621681673328"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673328"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681673329"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673329"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#wordDataCon"><span class="hs-identifier hs-var">wordDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
forall b. Platform -&gt; Integer -&gt; Expr b
</span><a href="GHC.Core.html#mkWordLit"><span class="hs-identifier hs-var">mkWordLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673328"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673329"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Integer@</span></span><span>
</span><span id="line-263"></span><span class="annot"><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-type">mkIntegerExpr</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>  </span><span class="hs-comment">-- Result :: Integer</span><span>
</span><span id="line-264"></span><span id="mkIntegerExpr"><span class="annot"><span class="annottext">mkIntegerExpr :: Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var hs-var">mkIntegerExpr</span></a></span></span><span> </span><span id="local-6989586621681673332"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673332"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681673333"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673333"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Bool
</span><a href="GHC.Platform.html#platformInIntRange"><span class="hs-identifier hs-var">platformInIntRange</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673332"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673333"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#integerISDataCon"><span class="hs-identifier hs-var">integerISDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
forall b. Platform -&gt; Integer -&gt; Expr b
</span><a href="GHC.Core.html#mkIntLit"><span class="hs-identifier hs-var">mkIntLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673332"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673333"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673333"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#integerINDataCon"><span class="hs-identifier hs-var">integerINDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitBigNat"><span class="hs-identifier hs-var">mkLitBigNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#negate/GHC.Num.html#negate"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673333"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#integerIPDataCon"><span class="hs-identifier hs-var">integerIPDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitBigNat"><span class="hs-identifier hs-var">mkLitBigNat</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673333"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Natural@</span></span><span>
</span><span id="line-270"></span><span class="annot"><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-type">mkNaturalExpr</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-271"></span><span id="mkNaturalExpr"><span class="annot"><span class="annottext">mkNaturalExpr :: Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-var hs-var">mkNaturalExpr</span></a></span></span><span> </span><span id="local-6989586621681673340"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673340"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681673341"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673341"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Bool
</span><a href="GHC.Platform.html#platformInWordRange"><span class="hs-identifier hs-var">platformInWordRange</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673340"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673341"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#naturalNSDataCon"><span class="hs-identifier hs-var">naturalNSDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
forall b. Platform -&gt; Integer -&gt; Expr b
</span><a href="GHC.Core.html#mkWordLit"><span class="hs-identifier hs-var">mkWordLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681673340"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673341"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#naturalNBDataCon"><span class="hs-identifier hs-var">naturalNBDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitBigNat"><span class="hs-identifier hs-var">mkLitBigNat</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681673341"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Float@</span></span><span>
</span><span id="line-276"></span><span class="annot"><a href="GHC.Core.Make.html#mkFloatExpr"><span class="hs-identifier hs-type">mkFloatExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-277"></span><span id="mkFloatExpr"><span class="annot"><span class="annottext">mkFloatExpr :: Float -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkFloatExpr"><span class="hs-identifier hs-var hs-var">mkFloatExpr</span></a></span></span><span> </span><span id="local-6989586621681673345"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621681673345"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#floatDataCon"><span class="hs-identifier hs-var">floatDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Float -&gt; CoreExpr
forall b. Float -&gt; Expr b
</span><a href="GHC.Core.html#mkFloatLitFloat"><span class="hs-identifier hs-var">mkFloatLitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621681673345"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Double@</span></span><span>
</span><span id="line-280"></span><span class="annot"><a href="GHC.Core.Make.html#mkDoubleExpr"><span class="hs-identifier hs-type">mkDoubleExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-281"></span><span id="mkDoubleExpr"><span class="annot"><span class="annottext">mkDoubleExpr :: Double -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkDoubleExpr"><span class="hs-identifier hs-var hs-var">mkDoubleExpr</span></a></span></span><span> </span><span id="local-6989586621681673348"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681673348"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#doubleDataCon"><span class="hs-identifier hs-var">doubleDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; CoreExpr
forall b. Double -&gt; Expr b
</span><a href="GHC.Core.html#mkDoubleLitDouble"><span class="hs-identifier hs-var">mkDoubleLitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681673348"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @Char@</span></span><span>
</span><span id="line-285"></span><span class="annot"><a href="GHC.Core.Make.html#mkCharExpr"><span class="hs-identifier hs-type">mkCharExpr</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>      </span><span class="hs-comment">-- Result = C# c :: Int</span><span>
</span><span id="line-286"></span><span id="mkCharExpr"><span class="annot"><span class="annottext">mkCharExpr :: Char -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCharExpr"><span class="hs-identifier hs-var hs-var">mkCharExpr</span></a></span></span><span> </span><span id="local-6989586621681673351"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681673351"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#charDataCon"><span class="hs-identifier hs-var">charDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; CoreExpr
forall b. Char -&gt; Expr b
</span><a href="GHC.Core.html#mkCharLit"><span class="hs-identifier hs-var">mkCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681673351"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to the given @String@</span></span><span>
</span><span id="line-289"></span><span id="local-6989586621681672973"><span class="annot"><a href="GHC.Core.Make.html#mkStringExpr"><span class="hs-identifier hs-type">mkStringExpr</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.TyThing.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681672973"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681672973"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span><span>  </span><span class="hs-comment">-- Result :: String</span><span>
</span><span id="line-290"></span><span id="mkStringExpr"><span class="annot"><span class="annottext">mkStringExpr :: forall (m :: * -&gt; *). MonadThings m =&gt; String -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExpr"><span class="hs-identifier hs-var hs-var">mkStringExpr</span></a></span></span><span> </span><span id="local-6989586621681673356"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673356"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; m CoreExpr
forall (m :: * -&gt; *). MonadThings m =&gt; FastString -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFS"><span class="hs-identifier hs-var">mkStringExprFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673356"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><span class="hs-comment">-- | Create a 'CoreExpr' which will evaluate to a string morally equivalent to the given @FastString@</span></span><span>
</span><span id="line-293"></span><span id="local-6989586621681672977"><span class="annot"><a href="GHC.Core.Make.html#mkStringExprFS"><span class="hs-identifier hs-type">mkStringExprFS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.TyThing.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681672977"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681672977"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span><span>  </span><span class="hs-comment">-- Result :: String</span><span>
</span><span id="line-294"></span><span id="mkStringExprFS"><span class="annot"><span class="annottext">mkStringExprFS :: forall (m :: * -&gt; *). MonadThings m =&gt; FastString -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFS"><span class="hs-identifier hs-var hs-var">mkStringExprFS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; m Id) -&gt; FastString -&gt; m CoreExpr
forall (m :: * -&gt; *).
Monad m =&gt;
(Name -&gt; m Id) -&gt; FastString -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFSLookup"><span class="hs-identifier hs-var">mkStringExprFSLookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Id
forall (m :: * -&gt; *). MonadThings m =&gt; Name -&gt; m Id
</span><a href="GHC.Types.TyThing.html#lookupId"><span class="hs-identifier hs-var">lookupId</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span id="local-6989586621681672980"><span class="annot"><a href="GHC.Core.Make.html#mkStringExprFSLookup"><span class="hs-identifier hs-type">mkStringExprFSLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#Monad/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681672980"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681672980"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681672980"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span><span>
</span><span id="line-297"></span><span id="mkStringExprFSLookup"><span class="annot"><span class="annottext">mkStringExprFSLookup :: forall (m :: * -&gt; *).
Monad m =&gt;
(Name -&gt; m Id) -&gt; FastString -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFSLookup"><span class="hs-identifier hs-var hs-var">mkStringExprFSLookup</span></a></span></span><span> </span><span id="local-6989586621681673371"><span class="annot"><span class="annottext">Name -&gt; m Id
</span><a href="#local-6989586621681673371"><span class="hs-identifier hs-var">lookupM</span></a></span></span><span> </span><span id="local-6989586621681673372"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681673372"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621681673373"><span class="annot"><span class="annottext">MkStringIds
</span><a href="#local-6989586621681673373"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; m Id) -&gt; m MkStringIds
forall (m :: * -&gt; *).
Applicative m =&gt;
(Name -&gt; m Id) -&gt; m MkStringIds
</span><a href="GHC.Core.Make.html#getMkStringIds"><span class="hs-identifier hs-var">getMkStringIds</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Id
</span><a href="#local-6989586621681673371"><span class="hs-identifier hs-var">lookupM</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><span class="annottext">CoreExpr -&gt; m CoreExpr
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkStringIds -&gt; FastString -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFSWith"><span class="hs-identifier hs-var">mkStringExprFSWith</span></a></span><span> </span><span class="annot"><span class="annottext">MkStringIds
</span><a href="#local-6989586621681673373"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681673372"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span id="local-6989586621681672984"><span class="annot"><a href="GHC.Core.Make.html#getMkStringIds"><span class="hs-identifier hs-type">getMkStringIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#Applicative/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681672984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681672984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681672984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#MkStringIds"><span class="hs-identifier hs-type">MkStringIds</span></a></span></span><span>
</span><span id="line-302"></span><span id="getMkStringIds"><span class="annot"><span class="annottext">getMkStringIds :: forall (m :: * -&gt; *).
Applicative m =&gt;
(Name -&gt; m Id) -&gt; m MkStringIds
</span><a href="GHC.Core.Make.html#getMkStringIds"><span class="hs-identifier hs-var hs-var">getMkStringIds</span></a></span></span><span> </span><span id="local-6989586621681673379"><span class="annot"><span class="annottext">Name -&gt; m Id
</span><a href="#local-6989586621681673379"><span class="hs-identifier hs-var">lookupM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Id -&gt; MkStringIds
</span><a href="GHC.Core.Make.html#MkStringIds"><span class="hs-identifier hs-var">MkStringIds</span></a></span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Id -&gt; MkStringIds) -&gt; m Id -&gt; m (Id -&gt; MkStringIds)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Id
</span><a href="#local-6989586621681673379"><span class="hs-identifier hs-var">lookupM</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unpackCStringName"><span class="hs-identifier hs-var">unpackCStringName</span></a></span><span> </span><span class="annot"><span class="annottext">m (Id -&gt; MkStringIds) -&gt; m Id -&gt; m MkStringIds
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%2A%3E/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Id
</span><a href="#local-6989586621681673379"><span class="hs-identifier hs-var">lookupM</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unpackCStringUtf8Name"><span class="hs-identifier hs-var">unpackCStringUtf8Name</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-keyword">data</span><span> </span><span id="MkStringIds"><span class="annot"><a href="GHC.Core.Make.html#MkStringIds"><span class="hs-identifier hs-var">MkStringIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkStringIds"><span class="annot"><a href="GHC.Core.Make.html#MkStringIds"><span class="hs-identifier hs-var">MkStringIds</span></a></span></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="unpackCStringId"><span class="annot"><span class="annottext">MkStringIds -&gt; Id
</span><a href="GHC.Core.Make.html#unpackCStringId"><span class="hs-identifier hs-var hs-var">unpackCStringId</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unpackCStringUtf8Id"><span class="annot"><span class="annottext">MkStringIds -&gt; Id
</span><a href="GHC.Core.Make.html#unpackCStringUtf8Id"><span class="hs-identifier hs-var hs-var">unpackCStringUtf8Id</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="GHC.Core.Make.html#mkStringExprFSWith"><span class="hs-identifier hs-type">mkStringExprFSWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#MkStringIds"><span class="hs-identifier hs-type">MkStringIds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-310"></span><span id="mkStringExprFSWith"><span class="annot"><span class="annottext">mkStringExprFSWith :: MkStringIds -&gt; FastString -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFSWith"><span class="hs-identifier hs-var hs-var">mkStringExprFSWith</span></a></span></span><span> </span><span id="local-6989586621681673386"><span class="annot"><span class="annottext">MkStringIds
</span><a href="#local-6989586621681673386"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621681673387"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681673387"><span class="hs-identifier hs-var">str</span></a></span></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Bool
</span><a href="GHC.Data.FastString.html#nullFS"><span class="hs-identifier hs-var">nullFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681673387"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNilExpr"><span class="hs-identifier hs-var">mkNilExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.html#charTy"><span class="hs-identifier hs-var">charTy</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621681673391"><span class="hs-identifier hs-var">safeChar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673392"><span class="hs-identifier hs-var">chars</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681673393"><span class="annot"><span class="annottext">unpack_id :: Id
</span><a href="#local-6989586621681673393"><span class="hs-identifier hs-var hs-var">unpack_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MkStringIds -&gt; Id
</span><a href="GHC.Core.Make.html#unpackCStringId"><span class="hs-identifier hs-var">unpackCStringId</span></a></span><span> </span><span class="annot"><span class="annottext">MkStringIds
</span><a href="#local-6989586621681673386"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673393"><span class="hs-identifier hs-var">unpack_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673394"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681673395"><span class="annot"><span class="annottext">unpack_utf8_id :: Id
</span><a href="#local-6989586621681673395"><span class="hs-identifier hs-var hs-var">unpack_utf8_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MkStringIds -&gt; Id
</span><a href="GHC.Core.Make.html#unpackCStringUtf8Id"><span class="hs-identifier hs-var">unpackCStringUtf8Id</span></a></span><span> </span><span class="annot"><span class="annottext">MkStringIds
</span><a href="#local-6989586621681673386"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673395"><span class="hs-identifier hs-var">unpack_utf8_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673394"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621681673392"><span class="annot"><span class="annottext">chars :: String
</span><a href="#local-6989586621681673392"><span class="hs-identifier hs-var hs-var">chars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; String
</span><a href="GHC.Data.FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681673387"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621681673391"><span class="annot"><span class="annottext">safeChar :: Char -&gt; Bool
</span><a href="#local-6989586621681673391"><span class="hs-identifier hs-var hs-var">safeChar</span></a></span></span><span> </span><span id="local-6989586621681673402"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681673402"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#ord/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681673402"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#ord/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681673402"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x7F</span></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621681673394"><span class="annot"><span class="annottext">lit :: CoreExpr
</span><a href="#local-6989586621681673394"><span class="hs-identifier hs-var hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; ByteString
</span><a href="GHC.Data.FastString.html#bytesFS"><span class="hs-identifier hs-var">bytesFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681673387"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
     Creating tuples and their types for Core expressions
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">{- Note [Flattening one-tuples]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This family of functions creates a tuple of variables/expressions/types.
  mkCoreTup [e1,e2,e3] = (e1,e2,e3)
What if there is just one variable/expression/type in the argument?
We could do one of two things:

* Flatten it out, so that
    mkCoreTup [e1] = e1

* Build a one-tuple (see Note [One-tuples] in GHC.Builtin.Types)
    mkCoreTupSolo [e1] = Solo e1
  We use a suffix &quot;Solo&quot; to indicate this.

Usually we want the former, but occasionally the latter.

NB: The logic in tupleDataCon knows about () and Solo and (,), etc.

Note [Don't flatten tuples from HsSyn]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If we get an explicit 1-tuple from HsSyn somehow (likely: Template Haskell),
we should treat it really as a 1-tuple, without flattening. Note that a
1-tuple and a flattened value have different performance and laziness
characteristics, so should just do what we're asked.

This arose from discussions in #16881.

One-tuples that arise internally depend on the circumstance; often flattening
is a good idea. Decisions are made on a case-by-case basis.

'mkCoreBoxedTuple` and `mkBigCoreVarTupSolo` build tuples without flattening.
-}</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | Build a small tuple holding the specified expressions</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- One-tuples are *not* flattened; see Note [Flattening one-tuples]</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- See also Note [Don't flatten tuples from HsSyn]</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- Arguments must have kind Type</span><span>
</span><span id="line-372"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreBoxedTuple"><span class="hs-identifier hs-type">mkCoreBoxedTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-373"></span><span id="mkCoreBoxedTuple"><span class="annot"><span class="annottext">mkCoreBoxedTuple :: (() :: Constraint) =&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreBoxedTuple"><span class="hs-identifier hs-var hs-var">mkCoreBoxedTuple</span></a></span></span><span> </span><span id="local-6989586621681673418"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673418"><span class="hs-identifier hs-var">cs</span></a></span></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SDoc
-&gt; (DataCon -&gt; [CoreExpr] -&gt; CoreExpr)
-&gt; DataCon
-&gt; [CoreExpr]
-&gt; CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bool) -&gt; [CoreExpr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="GHC.Core.Type.html#tcIsLiftedTypeKind"><span class="hs-identifier hs-var">tcIsLiftedTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Bool) -&gt; (CoreExpr -&gt; Kind) -&gt; CoreExpr -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; (CoreExpr -&gt; Kind) -&gt; CoreExpr -&gt; Kind
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673418"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreExpr] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673418"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreExpr] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673418"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; CoreExpr) -&gt; (CoreExpr -&gt; Kind) -&gt; CoreExpr -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673418"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673418"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- | Build a small unboxed tuple holding the specified expressions.</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- Do not include the RuntimeRep specifiers; this function calculates them</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- for you.</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- Does /not/ flatten one-tuples; see Note [Flattening one-tuples]</span><span>
</span><span id="line-383"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-type">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-384"></span><span id="mkCoreUnboxedTuple"><span class="annot"><span class="annottext">mkCoreUnboxedTuple :: [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-var hs-var">mkCoreUnboxedTuple</span></a></span></span><span> </span><span id="local-6989586621681673424"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673424"><span class="hs-identifier hs-var">exps</span></a></span></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Kind] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673426"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Kind -&gt; CoreExpr) -&gt; [Kind] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; CoreExpr) -&gt; (Kind -&gt; Kind) -&gt; Kind -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673426"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; CoreExpr) -&gt; [Kind] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673426"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673424"><span class="hs-identifier hs-var">exps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-388"></span><span>    </span><span id="local-6989586621681673426"><span class="annot"><span class="annottext">tys :: [Kind]
</span><a href="#local-6989586621681673426"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Kind) -&gt; [CoreExpr] -&gt; [Kind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673424"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="annot"><span class="hs-comment">-- | Make a core tuple of the given boxity; don't flatten 1-tuples</span></span><span>
</span><span id="line-391"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreTupBoxity"><span class="hs-identifier hs-type">mkCoreTupBoxity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Boxity"><span class="hs-identifier hs-type">Boxity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-392"></span><span id="mkCoreTupBoxity"><span class="annot"><span class="annottext">mkCoreTupBoxity :: Boxity -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreTupBoxity"><span class="hs-identifier hs-var hs-var">mkCoreTupBoxity</span></a></span></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a></span><span>   </span><span id="local-6989586621681673428"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673428"><span class="hs-identifier hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
(() :: Constraint) =&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreBoxedTuple"><span class="hs-identifier hs-var">mkCoreBoxedTuple</span></a></span><span>   </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673428"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-393"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreTupBoxity"><span class="hs-identifier hs-var">mkCoreTupBoxity</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span id="local-6989586621681673429"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673429"><span class="hs-identifier hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-var">mkCoreUnboxedTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673429"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | Build the type of a small tuple that holds the specified variables</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening one-tuples]</span><span>
</span><span id="line-397"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreVarTupTy"><span class="hs-identifier hs-type">mkCoreVarTupTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-398"></span><span id="mkCoreVarTupTy"><span class="annot"><span class="annottext">mkCoreVarTupTy :: [Id] -&gt; Kind
</span><a href="GHC.Core.Make.html#mkCoreVarTupTy"><span class="hs-identifier hs-var hs-var">mkCoreVarTupTy</span></a></span></span><span> </span><span id="local-6989586621681673430"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673430"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind
</span><a href="GHC.Builtin.Types.html#mkBoxedTupleTy"><span class="hs-identifier hs-var">mkBoxedTupleTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; Kind) -&gt; [Id] -&gt; [Kind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673430"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-comment">-- | Build a small tuple holding the specified expressions</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening one-tuples]</span><span>
</span><span id="line-402"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreTup"><span class="hs-identifier hs-type">mkCoreTup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-403"></span><span id="mkCoreTup"><span class="annot"><span class="annottext">mkCoreTup :: [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreTup"><span class="hs-identifier hs-var hs-var">mkCoreTup</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681673433"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673433"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673433"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-404"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreTup"><span class="hs-identifier hs-var">mkCoreTup</span></a></span><span> </span><span id="local-6989586621681673434"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673434"><span class="hs-identifier hs-var">cs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
(() :: Constraint) =&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreBoxedTuple"><span class="hs-identifier hs-var">mkCoreBoxedTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673434"><span class="hs-identifier hs-var">cs</span></a></span><span>   </span><span class="hs-comment">-- non-1-tuples are uniform</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- | Build an unboxed sum.</span><span>
</span><span id="line-407"></span><span class="hs-comment">--</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- Alternative number (&quot;alt&quot;) starts from 1.</span><span>
</span><span id="line-409"></span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedSum"><span class="hs-identifier hs-type">mkCoreUnboxedSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-410"></span><span id="mkCoreUnboxedSum"><span class="annot"><span class="annottext">mkCoreUnboxedSum :: Int -&gt; Int -&gt; [Kind] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedSum"><span class="hs-identifier hs-var hs-var">mkCoreUnboxedSum</span></a></span></span><span> </span><span id="local-6989586621681673435"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673435"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621681673436"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673436"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621681673437"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673437"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621681673438"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673438"><span class="hs-identifier hs-var">exp</span></a></span></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CoreExpr -&gt; CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Kind] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673437"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673435"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; CoreExpr -&gt; CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673436"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673435"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#sumDataCon"><span class="hs-identifier hs-var">sumDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673436"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673435"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Kind -&gt; CoreExpr) -&gt; [Kind] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; CoreExpr) -&gt; (Kind -&gt; Kind) -&gt; Kind -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673437"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-415"></span><span>                   </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; CoreExpr) -&gt; [Kind] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673437"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-416"></span><span>                   </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673438"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">{- Note [Big tuples]
~~~~~~~~~~~~~~~~~~~~
&quot;Big&quot; tuples (`mkBigCoreTup` and friends) are more general than &quot;small&quot;
ones (`mkCoreTup` and friends) in two ways.

1. GHCs built-in tuples can only go up to 'mAX_TUPLE_SIZE' in arity, but
   we might conceivably want to build such a massive tuple as part of the
   output of a desugaring stage (notably that for list comprehensions).

   `mkBigCoreTup` encodes such big tuples by creating and pattern
   matching on /nested/ small tuples that are directly expressible by
   GHC.

   Nesting policy: it's better to have a 2-tuple of 10-tuples (3 objects)
   than a 10-tuple of 2-tuples (11 objects), so we want the leaves of any
   construction to be big.

2. When desugaring arrows we gather up a tuple of free variables, which
   may include dictionaries (of kind Constraint) and unboxed values.

   These can't live in a tuple. `mkBigCoreTup` encodes such tuples by
   boxing up the offending arguments: see Note [Boxing constructors]
   in GHC.Builtin.Types.

If you just use the 'mkBigCoreTup', 'mkBigCoreVarTupTy', 'mkBigTupleSelector'
and 'mkBigTupleCase' functions to do all your work with tuples you should be
fine, and not have to worry about the arity limitation, or kind limitation at
all.

The &quot;big&quot; tuple operations flatten 1-tuples just like &quot;small&quot; tuples.
But see Note [Don't flatten tuples from HsSyn]
-}</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreVarTupSolo"><span class="hs-identifier hs-type">mkBigCoreVarTupSolo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- Same as mkBigCoreVarTup, but:</span><span>
</span><span id="line-453"></span><span class="hs-comment">--   - one-tuples are not flattened</span><span>
</span><span id="line-454"></span><span class="hs-comment">--     see Note [Flattening one-tuples]</span><span>
</span><span id="line-455"></span><span class="hs-comment">--   - arguments should have kind Type</span><span>
</span><span id="line-456"></span><span id="mkBigCoreVarTupSolo"><span class="annot"><span class="annottext">mkBigCoreVarTupSolo :: [Id] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkBigCoreVarTupSolo"><span class="hs-identifier hs-var hs-var">mkBigCoreVarTupSolo</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681673441"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673441"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
(() :: Constraint) =&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreBoxedTuple"><span class="hs-identifier hs-var">mkCoreBoxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673441"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreVarTupSolo"><span class="hs-identifier hs-var">mkBigCoreVarTupSolo</span></a></span><span> </span><span id="local-6989586621681673442"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673442"><span class="hs-identifier hs-var">ids</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([CoreExpr] -&gt; CoreExpr) -&gt; [CoreExpr] -&gt; CoreExpr
forall a. ([a] -&gt; a) -&gt; [a] -&gt; a
</span><a href="GHC.Core.Make.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreTup"><span class="hs-identifier hs-var">mkCoreTup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; CoreExpr) -&gt; [Id] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673442"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- | Build a big tuple holding the specified variables</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening one-tuples]</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- Arguments don't have to have kind Type</span><span>
</span><span id="line-462"></span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreVarTup"><span class="hs-identifier hs-type">mkBigCoreVarTup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-463"></span><span id="mkBigCoreVarTup"><span class="annot"><span class="annottext">mkBigCoreVarTup :: [Id] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkBigCoreVarTup"><span class="hs-identifier hs-var hs-var">mkBigCoreVarTup</span></a></span></span><span> </span><span id="local-6989586621681673443"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673443"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkBigCoreTup"><span class="hs-identifier hs-var">mkBigCoreTup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; CoreExpr) -&gt; [Id] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673443"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- | Build a &quot;big&quot; tuple holding the specified expressions</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening one-tuples]</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- Arguments don't have to have kind Type; ones that do not are boxed</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- This function crashes (in wrapBox) if given a non-Type</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- argument that it doesn't know how to box.</span><span>
</span><span id="line-470"></span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreTup"><span class="hs-identifier hs-type">mkBigCoreTup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-471"></span><span id="mkBigCoreTup"><span class="annot"><span class="annottext">mkBigCoreTup :: [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkBigCoreTup"><span class="hs-identifier hs-var hs-var">mkBigCoreTup</span></a></span></span><span> </span><span id="local-6989586621681673444"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673444"><span class="hs-identifier hs-var">exprs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([CoreExpr] -&gt; CoreExpr) -&gt; [CoreExpr] -&gt; CoreExpr
forall a. ([a] -&gt; a) -&gt; [a] -&gt; a
</span><a href="GHC.Core.Make.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreTup"><span class="hs-identifier hs-var">mkCoreTup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#wrapBox"><span class="hs-identifier hs-var">wrapBox</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673444"><span class="hs-identifier hs-var">exprs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- | Build the type of a big tuple that holds the specified variables</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening one-tuples]</span><span>
</span><span id="line-475"></span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreVarTupTy"><span class="hs-identifier hs-type">mkBigCoreVarTupTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-476"></span><span id="mkBigCoreVarTupTy"><span class="annot"><span class="annottext">mkBigCoreVarTupTy :: [Id] -&gt; Kind
</span><a href="GHC.Core.Make.html#mkBigCoreVarTupTy"><span class="hs-identifier hs-var hs-var">mkBigCoreVarTupTy</span></a></span></span><span> </span><span id="local-6989586621681673446"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673446"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind
</span><a href="GHC.Core.Make.html#mkBigCoreTupTy"><span class="hs-identifier hs-var">mkBigCoreTupTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; Kind) -&gt; [Id] -&gt; [Kind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673446"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- | Build the type of a big tuple that holds the specified type of thing</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- One-tuples are flattened; see Note [Flattening one-tuples]</span><span>
</span><span id="line-480"></span><span class="annot"><a href="GHC.Core.Make.html#mkBigCoreTupTy"><span class="hs-identifier hs-type">mkBigCoreTupTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-481"></span><span id="mkBigCoreTupTy"><span class="annot"><span class="annottext">mkBigCoreTupTy :: [Kind] -&gt; Kind
</span><a href="GHC.Core.Make.html#mkBigCoreTupTy"><span class="hs-identifier hs-var hs-var">mkBigCoreTupTy</span></a></span></span><span> </span><span id="local-6989586621681673447"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673447"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Kind] -&gt; Kind) -&gt; [Kind] -&gt; Kind
forall a. ([a] -&gt; a) -&gt; [a] -&gt; a
</span><a href="GHC.Core.Make.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind
</span><a href="GHC.Builtin.Types.html#mkBoxedTupleTy"><span class="hs-identifier hs-var">mkBoxedTupleTy</span></a></span><span> </span><span class="annot"><span class="annottext">([Kind] -&gt; Kind) -&gt; [Kind] -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-482"></span><span>                     </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; [Kind] -&gt; [Kind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="GHC.Core.Make.html#boxTy"><span class="hs-identifier hs-var">boxTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673447"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="annot"><span class="hs-comment">-- | The unit expression</span></span><span>
</span><span id="line-485"></span><span class="annot"><a href="GHC.Core.Make.html#unitExpr"><span class="hs-identifier hs-type">unitExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-486"></span><span id="unitExpr"><span class="annot"><span class="annottext">unitExpr :: CoreExpr
</span><a href="GHC.Core.Make.html#unitExpr"><span class="hs-identifier hs-var hs-var">unitExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.html#unitDataConId"><span class="hs-identifier hs-var">unitDataConId</span></a></span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><span id="line-489"></span><span class="annot"><a href="GHC.Core.Make.html#wrapBox"><span class="hs-identifier hs-type">wrapBox</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- ^ If (e :: ty) and (ty :: Type), wrapBox is a no-op</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- But if (ty :: ki), and ki is not Type, wrapBox returns (K @ty e)</span><span>
</span><span id="line-492"></span><span class="hs-comment">--     which has kind Type</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- where K is the boxing data constructor for ki</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- See Note [Boxing constructors] in GHC.Builtin.Types</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- Panics if there /is/ no boxing data con</span><span>
</span><span id="line-496"></span><span id="wrapBox"><span class="annot"><span class="annottext">wrapBox :: CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#wrapBox"><span class="hs-identifier hs-var hs-var">wrapBox</span></a></span></span><span> </span><span id="local-6989586621681673450"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673450"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; BoxingInfo Id
forall b. Kind -&gt; BoxingInfo b
</span><a href="GHC.Builtin.Types.html#boxingDataCon"><span class="hs-identifier hs-var">boxingDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673452"><span class="hs-identifier hs-var">e_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-498"></span><span>      </span><span class="annot"><span class="annottext">BoxingInfo Id
</span><a href="GHC.Builtin.Types.html#BI_NoBoxNeeded"><span class="hs-identifier hs-var">BI_NoBoxNeeded</span></a></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673450"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-499"></span><span>      </span><span class="annot"><a href="GHC.Builtin.Types.html#BI_Box"><span class="hs-identifier hs-type">BI_Box</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bi_inst_con :: forall b. BoxingInfo b -&gt; Expr b
</span><a href="GHC.Builtin.Types.html#bi_inst_con"><span class="hs-identifier hs-var">bi_inst_con</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681673456"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673456"><span class="hs-identifier hs-var">boxing_expr</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673456"><span class="hs-identifier hs-var">boxing_expr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673450"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-500"></span><span>      </span><span class="annot"><span class="annottext">BoxingInfo Id
</span><a href="GHC.Builtin.Types.html#BI_NoBoxAvailable"><span class="hs-identifier hs-var">BI_NoBoxAvailable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; CoreExpr
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapBox&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673450"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673450"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>                           </span><span class="hs-comment">-- We should do better than panicing: #22336</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-503"></span><span>    </span><span id="local-6989586621681673452"><span class="annot"><span class="annottext">e_ty :: Kind
</span><a href="#local-6989586621681673452"><span class="hs-identifier hs-var hs-var">e_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673450"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="annot"><a href="GHC.Core.Make.html#boxTy"><span class="hs-identifier hs-type">boxTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-506"></span><span class="hs-comment">-- ^ `boxTy ty` is the boxed version of `ty`. That is,</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- if `e :: ty`, then `wrapBox e :: boxTy ty`.</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- Note that if `ty :: Type`, `boxTy ty` just returns `ty`.</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- Panics if it is not possible to box `ty`, like `wrapBox` (#22336)</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- See Note [Boxing constructors] in GHC.Builtin.Types</span><span>
</span><span id="line-511"></span><span id="boxTy"><span class="annot"><span class="annottext">boxTy :: Kind -&gt; Kind
</span><a href="GHC.Core.Make.html#boxTy"><span class="hs-identifier hs-var hs-var">boxTy</span></a></span></span><span> </span><span id="local-6989586621681673459"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673459"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; BoxingInfo Any
forall b. Kind -&gt; BoxingInfo b
</span><a href="GHC.Builtin.Types.html#boxingDataCon"><span class="hs-identifier hs-var">boxingDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673459"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>      </span><span class="annot"><span class="annottext">BoxingInfo Any
</span><a href="GHC.Builtin.Types.html#BI_NoBoxNeeded"><span class="hs-identifier hs-var">BI_NoBoxNeeded</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673459"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-514"></span><span>      </span><span class="annot"><a href="GHC.Builtin.Types.html#BI_Box"><span class="hs-identifier hs-type">BI_Box</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bi_boxed_type :: forall b. BoxingInfo b -&gt; Kind
</span><a href="GHC.Builtin.Types.html#bi_boxed_type"><span class="hs-identifier hs-var">bi_boxed_type</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681673461"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673461"><span class="hs-identifier hs-var">box_ty</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673461"><span class="hs-identifier hs-var">box_ty</span></a></span><span>
</span><span id="line-515"></span><span>      </span><span class="annot"><span class="annottext">BoxingInfo Any
</span><a href="GHC.Builtin.Types.html#BI_NoBoxAvailable"><span class="hs-identifier hs-var">BI_NoBoxAvailable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Kind
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;boxTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673459"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>                           </span><span class="hs-comment">-- We should do better than panicing: #22336</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="annot"><a href="GHC.Core.Make.html#unwrapBox"><span class="hs-identifier hs-type">unwrapBox</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-519"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- If v's type required boxing (i.e it is unlifted or a constraint)</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- then (unwrapBox us v body) returns</span><span>
</span><span id="line-522"></span><span class="hs-comment">--          (case box_v of MkDict v -&gt; body)</span><span>
</span><span id="line-523"></span><span class="hs-comment">--          together with box_v</span><span>
</span><span id="line-524"></span><span class="hs-comment">--      where box_v is a fresh variable</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- Otherwise unwrapBox is a no-op</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- Panics if no box is available (#22336)</span><span>
</span><span id="line-527"></span><span id="unwrapBox"><span class="annot"><span class="annottext">unwrapBox :: UniqSupply -&gt; Id -&gt; CoreExpr -&gt; (UniqSupply, Id, CoreExpr)
</span><a href="GHC.Core.Make.html#unwrapBox"><span class="hs-identifier hs-var hs-var">unwrapBox</span></a></span></span><span> </span><span id="local-6989586621681673463"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673463"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621681673464"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673464"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621681673465"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673465"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; BoxingInfo Any
forall b. Kind -&gt; BoxingInfo b
</span><a href="GHC.Builtin.Types.html#boxingDataCon"><span class="hs-identifier hs-var">boxingDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673466"><span class="hs-identifier hs-var">var_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-529"></span><span>      </span><span class="annot"><span class="annottext">BoxingInfo Any
</span><a href="GHC.Builtin.Types.html#BI_NoBoxNeeded"><span class="hs-identifier hs-var">BI_NoBoxNeeded</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673463"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673464"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673465"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>      </span><span class="annot"><span class="annottext">BoxingInfo Any
</span><a href="GHC.Builtin.Types.html#BI_NoBoxAvailable"><span class="hs-identifier hs-var">BI_NoBoxAvailable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (UniqSupply, Id, CoreExpr)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unwrapBox&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673464"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673466"><span class="hs-identifier hs-var">var_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>                           </span><span class="hs-comment">-- We should do better than panicing: #22336</span><span>
</span><span id="line-532"></span><span>      </span><span class="annot"><a href="GHC.Builtin.Types.html#BI_Box"><span class="hs-identifier hs-type">BI_Box</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bi_data_con :: forall b. BoxingInfo b -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#bi_data_con"><span class="hs-identifier hs-var">bi_data_con</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681673468"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681673468"><span class="hs-identifier hs-var">box_con</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bi_boxed_type :: forall b. BoxingInfo b -&gt; Kind
</span><a href="GHC.Builtin.Types.html#bi_boxed_type"><span class="hs-identifier hs-var">bi_boxed_type</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681673469"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673469"><span class="hs-identifier hs-var">box_ty</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-533"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673470"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673471"><span class="hs-identifier hs-var">var'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673472"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>         </span><span class="hs-keyword">where</span><span>
</span><span id="line-535"></span><span>           </span><span id="local-6989586621681673471"><span class="annot"><span class="annottext">var' :: Id
</span><a href="#local-6989586621681673471"><span class="hs-identifier hs-var hs-var">var'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Unique -&gt; Kind -&gt; Kind -&gt; Id
</span><a href="GHC.Types.Id.html#mkSysLocal"><span class="hs-identifier hs-var">mkSysLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;uc&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681673475"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673469"><span class="hs-identifier hs-var">box_ty</span></a></span><span>
</span><span id="line-536"></span><span>           </span><span id="local-6989586621681673472"><span class="annot"><span class="annottext">body' :: CoreExpr
</span><a href="#local-6989586621681673472"><span class="hs-identifier hs-var hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; Kind -&gt; [CoreAlt] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; Kind -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673471"><span class="hs-identifier hs-var">var'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673471"><span class="hs-identifier hs-var">var'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673465"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>                        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681673468"><span class="hs-identifier hs-var">box_con</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673464"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673465"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-539"></span><span>    </span><span id="local-6989586621681673466"><span class="annot"><span class="annottext">var_ty :: Kind
</span><a href="#local-6989586621681673466"><span class="hs-identifier hs-var hs-var">var_ty</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673464"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681673475"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681673475"><span class="hs-identifier hs-var">uniq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673470"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673470"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (Unique, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673463"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="annot"><span class="hs-comment">-- | Lifts a \&quot;small\&quot; constructor into a \&quot;big\&quot; constructor by recursive decomposition</span></span><span>
</span><span id="line-543"></span><span id="local-6989586621681673005"><span class="annot"><a href="GHC.Core.Make.html#mkChunkified"><span class="hs-identifier hs-type">mkChunkified</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681673005"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681673005"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>      </span><span class="annot"><span class="hs-comment">-- ^ \&quot;Small\&quot; constructor function, of maximum input arity 'mAX_TUPLE_SIZE'</span></span><span>
</span><span id="line-544"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681673005"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Possible \&quot;big\&quot; list of things to construct from</span></span><span>
</span><span id="line-545"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681673005"><span class="hs-identifier hs-type">a</span></a></span></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ Constructed thing made possible by recursive decomposition</span></span><span>
</span><span id="line-546"></span><span id="mkChunkified"><span class="annot"><span class="annottext">mkChunkified :: forall a. ([a] -&gt; a) -&gt; [a] -&gt; a
</span><a href="GHC.Core.Make.html#mkChunkified"><span class="hs-identifier hs-var hs-var">mkChunkified</span></a></span></span><span> </span><span id="local-6989586621681673477"><span class="annot"><span class="annottext">[a] -&gt; a
</span><a href="#local-6989586621681673477"><span class="hs-identifier hs-var">small_tuple</span></a></span></span><span> </span><span id="local-6989586621681673478"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673478"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; a
</span><a href="#local-6989586621681673479"><span class="hs-identifier hs-var">mk_big_tuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. [a] -&gt; [[a]]
</span><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673478"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-comment">-- Each sub-list is short enough to fit in a tuple</span><span>
</span><span id="line-549"></span><span>    </span><span id="local-6989586621681673479"><span class="annot"><span class="annottext">mk_big_tuple :: [[a]] -&gt; a
</span><a href="#local-6989586621681673479"><span class="hs-identifier hs-var hs-var">mk_big_tuple</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681673480"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673480"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
</span><a href="#local-6989586621681673477"><span class="hs-identifier hs-var">small_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673480"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="#local-6989586621681673479"><span class="hs-identifier hs-var">mk_big_tuple</span></a></span><span> </span><span id="local-6989586621681673481"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621681673481"><span class="hs-identifier hs-var">as_s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; a
</span><a href="#local-6989586621681673479"><span class="hs-identifier hs-var">mk_big_tuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. [a] -&gt; [[a]]
</span><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; [[a]] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
</span><a href="#local-6989586621681673477"><span class="hs-identifier hs-var">small_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621681673481"><span class="hs-identifier hs-var">as_s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span id="local-6989586621681673015"><span class="annot"><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier hs-type">chunkify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681673015"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681673015"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-553"></span><span class="hs-comment">-- ^ Split a list into lists that are small enough to have a corresponding</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- tuple arity. The sub-lists of the result all have length &lt;= 'mAX_TUPLE_SIZE'</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- But there may be more than 'mAX_TUPLE_SIZE' sub-lists</span><span>
</span><span id="line-556"></span><span id="chunkify"><span class="annot"><span class="annottext">chunkify :: forall a. [a] -&gt; [[a]]
</span><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier hs-var hs-var">chunkify</span></a></span></span><span> </span><span id="local-6989586621681673484"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673484"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673485"><span class="hs-identifier hs-var">n_xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Settings.Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673484"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. [a] -&gt; [[a]]
</span><a href="#local-6989586621681673486"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673484"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621681673485"><span class="annot"><span class="annottext">n_xs :: Int
</span><a href="#local-6989586621681673485"><span class="hs-identifier hs-var hs-var">n_xs</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673484"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621681673486"><span class="annot"><span class="annottext">split :: [a] -&gt; [[a]]
</span><a href="#local-6989586621681673486"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-562"></span><span>    </span><span class="annot"><a href="#local-6989586621681673486"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621681673487"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673487"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#take/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Settings.Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673487"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]] -&gt; [[a]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
</span><a href="#local-6989586621681673486"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#drop/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Settings.Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681673487"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Tuple destructors}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-comment">-- | Builds a selector which scrutinises the given</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- expression and extracts the one name from the list given.</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- If you want the no-shadowing rule to apply, the caller</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- is responsible for making sure that none of these names</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- are in scope.</span><span>
</span><span id="line-578"></span><span class="hs-comment">--</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- If there is just one 'Id' in the tuple, then the selector is</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- just the identity.</span><span>
</span><span id="line-581"></span><span class="hs-comment">--</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- If necessary, we pattern match on a \&quot;big\&quot; tuple.</span><span>
</span><span id="line-583"></span><span class="hs-comment">--</span><span>
</span><span id="line-584"></span><span class="hs-comment">-- A tuple selector is not linear in its argument. Consequently, the case</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- expression built by `mkBigTupleSelector` must consume its scrutinee 'Many'</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- times. And all the argument variables must have multiplicity 'Many'.</span><span>
</span><span id="line-587"></span><span class="annot"><a href="GHC.Core.Make.html#mkBigTupleSelector"><span class="hs-identifier hs-type">mkBigTupleSelector</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkBigTupleSelectorSolo"><span class="hs-identifier hs-type">mkBigTupleSelectorSolo</span></a></span><span>
</span><span id="line-588"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>         </span><span class="annot"><span class="hs-comment">-- ^ The 'Id's to pattern match the tuple against</span></span><span>
</span><span id="line-589"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ The 'Id' to select</span></span><span>
</span><span id="line-590"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ A variable of the same type as the scrutinee</span></span><span>
</span><span id="line-591"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Scrutinee</span></span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Selector expression</span></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-comment">-- mkBigTupleSelector [a,b,c,d] b v e</span><span>
</span><span id="line-595"></span><span class="hs-comment">--          = case e of v {</span><span>
</span><span id="line-596"></span><span class="hs-comment">--                (p,q) -&gt; case p of p {</span><span>
</span><span id="line-597"></span><span class="hs-comment">--                           (a,b) -&gt; b }}</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- We use 'tpl' vars for the p,q, since shadowing does not matter.</span><span>
</span><span id="line-599"></span><span class="hs-comment">--</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- In fact, it's more convenient to generate it innermost first, getting</span><span>
</span><span id="line-601"></span><span class="hs-comment">--</span><span>
</span><span id="line-602"></span><span class="hs-comment">--        case (case e of v</span><span>
</span><span id="line-603"></span><span class="hs-comment">--                (p,q) -&gt; p) of p</span><span>
</span><span id="line-604"></span><span class="hs-comment">--          (a,b) -&gt; b</span><span>
</span><span id="line-605"></span><span id="mkBigTupleSelector"><span class="annot"><span class="annottext">mkBigTupleSelector :: [Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkBigTupleSelector"><span class="hs-identifier hs-var hs-var">mkBigTupleSelector</span></a></span></span><span> </span><span id="local-6989586621681673490"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673490"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621681673491"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673491"><span class="hs-identifier hs-var">the_var</span></a></span></span><span> </span><span id="local-6989586621681673492"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673492"><span class="hs-identifier hs-var">scrut_var</span></a></span></span><span> </span><span id="local-6989586621681673493"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673493"><span class="hs-identifier hs-var">scrut</span></a></span></span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Id]] -&gt; Id -&gt; CoreExpr
</span><a href="#local-6989586621681673494"><span class="hs-identifier hs-var">mk_tup_sel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [[Id]]
forall a. [a] -&gt; [[a]]
</span><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673490"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673491"><span class="hs-identifier hs-var">the_var</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621681673494"><span class="annot"><span class="annottext">mk_tup_sel :: [[Id]] -&gt; Id -&gt; CoreExpr
</span><a href="#local-6989586621681673494"><span class="hs-identifier hs-var hs-var">mk_tup_sel</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681673495"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673495"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621681673496"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673496"><span class="hs-identifier hs-var">the_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleSelector"><span class="hs-identifier hs-var">mkSmallTupleSelector</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673495"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673496"><span class="hs-identifier hs-var">the_var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673492"><span class="hs-identifier hs-var">scrut_var</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673493"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><a href="#local-6989586621681673494"><span class="hs-identifier hs-var">mk_tup_sel</span></a></span><span> </span><span id="local-6989586621681673498"><span class="annot"><span class="annottext">[[Id]]
</span><a href="#local-6989586621681673498"><span class="hs-identifier hs-var">vars_s</span></a></span></span><span> </span><span id="local-6989586621681673499"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673499"><span class="hs-identifier hs-var">the_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleSelector"><span class="hs-identifier hs-var">mkSmallTupleSelector</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673500"><span class="hs-identifier hs-var">group</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673499"><span class="hs-identifier hs-var">the_var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673501"><span class="hs-identifier hs-var">tpl_v</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-610"></span><span>                                </span><span class="annot"><span class="annottext">[[Id]] -&gt; Id -&gt; CoreExpr
</span><a href="#local-6989586621681673494"><span class="hs-identifier hs-var">mk_tup_sel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [[Id]]
forall a. [a] -&gt; [[a]]
</span><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673502"><span class="hs-identifier hs-var">tpl_vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673501"><span class="hs-identifier hs-var">tpl_v</span></a></span><span>
</span><span id="line-611"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-612"></span><span>          </span><span id="local-6989586621681673503"><span class="annot"><span class="annottext">tpl_tys :: [Kind]
</span><a href="#local-6989586621681673503"><span class="hs-identifier hs-var hs-var">tpl_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Kind] -&gt; Kind
</span><a href="GHC.Builtin.Types.html#mkBoxedTupleTy"><span class="hs-identifier hs-var">mkBoxedTupleTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; Kind) -&gt; [Id] -&gt; [Kind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673504"><span class="hs-identifier hs-var">gp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681673504"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673504"><span class="hs-identifier hs-var">gp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Id]]
</span><a href="#local-6989586621681673498"><span class="hs-identifier hs-var">vars_s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span>          </span><span id="local-6989586621681673502"><span class="annot"><span class="annottext">tpl_vs :: [Id]
</span><a href="#local-6989586621681673502"><span class="hs-identifier hs-var hs-var">tpl_vs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; [Id]
</span><a href="GHC.Types.Id.html#mkTemplateLocals"><span class="hs-identifier hs-var">mkTemplateLocals</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681673503"><span class="hs-identifier hs-var">tpl_tys</span></a></span><span>
</span><span id="line-614"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621681673501"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673501"><span class="hs-identifier hs-var">tpl_v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673500"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673500"><span class="hs-identifier hs-var">group</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673506"><span class="hs-identifier hs-var">tpl</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673507"><span class="hs-identifier hs-var">gp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681673506"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673506"><span class="hs-identifier hs-var">tpl</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681673507"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673507"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Id] -&gt; [[Id]] -&gt; [(Id, [Id])]
forall a b. (() :: Constraint) =&gt; String -&gt; [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="GHC.Utils.Misc.html#zipEqual"><span class="hs-identifier hs-var">zipEqual</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkBigTupleSelector&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673502"><span class="hs-identifier hs-var">tpl_vs</span></a></span><span> </span><span class="annot"><span class="annottext">[[Id]]
</span><a href="#local-6989586621681673498"><span class="hs-identifier hs-var">vars_s</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-615"></span><span>                                         </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673499"><span class="hs-identifier hs-var">the_var</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; [Id] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#elem/Data.Foldable.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673507"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- ^ 'mkBigTupleSelectorSolo' is like 'mkBigTupleSelector'</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- but one-tuples are NOT flattened (see Note [Flattening one-tuples])</span><span>
</span><span id="line-618"></span><span id="mkBigTupleSelectorSolo"><span class="annot"><span class="annottext">mkBigTupleSelectorSolo :: [Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkBigTupleSelectorSolo"><span class="hs-identifier hs-var hs-var">mkBigTupleSelectorSolo</span></a></span></span><span> </span><span id="local-6989586621681673510"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673510"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621681673511"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673511"><span class="hs-identifier hs-var">the_var</span></a></span></span><span> </span><span id="local-6989586621681673512"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673512"><span class="hs-identifier hs-var">scrut_var</span></a></span></span><span> </span><span id="local-6989586621681673513"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673513"><span class="hs-identifier hs-var">scrut</span></a></span></span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673510"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleSelector1"><span class="hs-identifier hs-var">mkSmallTupleSelector1</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673510"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673511"><span class="hs-identifier hs-var">the_var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673512"><span class="hs-identifier hs-var">scrut_var</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673513"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkBigTupleSelector"><span class="hs-identifier hs-var">mkBigTupleSelector</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673510"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673511"><span class="hs-identifier hs-var">the_var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673512"><span class="hs-identifier hs-var">scrut_var</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673513"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span class="hs-comment">-- | `mkSmallTupleSelector` is like 'mkBigTupleSelector', but for tuples that</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- are guaranteed never to be &quot;big&quot;.  Also does not unwrap boxed types.</span><span>
</span><span id="line-626"></span><span class="hs-comment">--</span><span>
</span><span id="line-627"></span><span class="hs-comment">-- &gt; mkSmallTupleSelector [x] x v e = [| e |]</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- &gt; mkSmallTupleSelector [x,y,z] x v e = [| case e of v { (x,y,z) -&gt; x } |]</span><span>
</span><span id="line-629"></span><span class="annot"><a href="GHC.Core.Make.html#mkSmallTupleSelector"><span class="hs-identifier hs-type">mkSmallTupleSelector</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkSmallTupleSelector1"><span class="hs-identifier hs-type">mkSmallTupleSelector1</span></a></span><span>
</span><span id="line-630"></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- The tuple args</span><span>
</span><span id="line-631"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>          </span><span class="hs-comment">-- The selected one</span><span>
</span><span id="line-632"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>          </span><span class="hs-comment">-- A variable of the same type as the scrutinee</span><span>
</span><span id="line-633"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>    </span><span class="hs-comment">-- Scrutinee</span><span>
</span><span id="line-634"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-635"></span><span id="mkSmallTupleSelector"><span class="annot"><span class="annottext">mkSmallTupleSelector :: [Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleSelector"><span class="hs-identifier hs-var hs-var">mkSmallTupleSelector</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681673515"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673515"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621681673516"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673516"><span class="hs-identifier hs-var">should_be_the_same_var</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681673517"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673517"><span class="hs-identifier hs-var">scrut</span></a></span></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CoreExpr -&gt; CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673515"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Id -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673516"><span class="hs-identifier hs-var">should_be_the_same_var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673517"><span class="hs-identifier hs-var">scrut</span></a></span><span>  </span><span class="hs-comment">-- Special case for 1-tuples</span><span>
</span><span id="line-638"></span><span class="annot"><a href="GHC.Core.Make.html#mkSmallTupleSelector"><span class="hs-identifier hs-var">mkSmallTupleSelector</span></a></span><span> </span><span id="local-6989586621681673518"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673518"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621681673519"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673519"><span class="hs-identifier hs-var">the_var</span></a></span></span><span> </span><span id="local-6989586621681673520"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673520"><span class="hs-identifier hs-var">scrut_var</span></a></span></span><span> </span><span id="local-6989586621681673521"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673521"><span class="hs-identifier hs-var">scrut</span></a></span></span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleSelector1"><span class="hs-identifier hs-var">mkSmallTupleSelector1</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673518"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673519"><span class="hs-identifier hs-var">the_var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673520"><span class="hs-identifier hs-var">scrut_var</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673521"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-comment">-- ^ 'mkSmallTupleSelector1' is like 'mkSmallTupleSelector'</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- but one-tuples are NOT flattened (see Note [Flattening one-tuples])</span><span>
</span><span id="line-643"></span><span id="mkSmallTupleSelector1"><span class="annot"><span class="annottext">mkSmallTupleSelector1 :: [Id] -&gt; Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleSelector1"><span class="hs-identifier hs-var hs-var">mkSmallTupleSelector1</span></a></span></span><span> </span><span id="local-6989586621681673522"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673522"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621681673523"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673523"><span class="hs-identifier hs-var">the_var</span></a></span></span><span> </span><span id="local-6989586621681673524"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673524"><span class="hs-identifier hs-var">scrut_var</span></a></span></span><span> </span><span id="local-6989586621681673525"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673525"><span class="hs-identifier hs-var">scrut</span></a></span></span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CoreExpr -&gt; CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Bool
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; Bool
</span><a href="GHC.Utils.Misc.html#notNull"><span class="hs-identifier hs-var">notNull</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673522"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-645"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; Kind -&gt; [CoreAlt] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; Kind -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673525"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673524"><span class="hs-identifier hs-var">scrut_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673523"><span class="hs-identifier hs-var">the_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>         </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673522"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673522"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673523"><span class="hs-identifier hs-var">the_var</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-comment">-- | A generalization of 'mkBigTupleSelector', allowing the body</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- of the case to be an arbitrary expression.</span><span>
</span><span id="line-650"></span><span class="hs-comment">--</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- To avoid shadowing, we use uniques to invent new variables.</span><span>
</span><span id="line-652"></span><span class="hs-comment">--</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- If necessary we pattern match on a &quot;big&quot; tuple.</span><span>
</span><span id="line-654"></span><span class="annot"><a href="GHC.Core.Make.html#mkBigTupleCase"><span class="hs-identifier hs-type">mkBigTupleCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ For inventing names of intermediate variables</span></span><span>
</span><span id="line-655"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ The tuple identifiers to pattern match on;</span><span>
</span><span id="line-656"></span><span>                                   </span><span class="hs-comment">--   Bring these into scope in the body</span><span>
</span><span id="line-657"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Body of the case</span></span><span>
</span><span id="line-658"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Scrutinee</span></span><span>
</span><span id="line-659"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-660"></span><span class="hs-comment">-- ToDo: eliminate cases where none of the variables are needed.</span><span>
</span><span id="line-661"></span><span class="hs-comment">--</span><span>
</span><span id="line-662"></span><span class="hs-comment">--         mkBigTupleCase uniqs [a,b,c,d] body v e</span><span>
</span><span id="line-663"></span><span class="hs-comment">--           = case e of v { (p,q) -&gt;</span><span>
</span><span id="line-664"></span><span class="hs-comment">--             case p of p { (a,b) -&gt;</span><span>
</span><span id="line-665"></span><span class="hs-comment">--             case q of q { (c,d) -&gt;</span><span>
</span><span id="line-666"></span><span class="hs-comment">--             body }}}</span><span>
</span><span id="line-667"></span><span id="mkBigTupleCase"><span class="annot"><span class="annottext">mkBigTupleCase :: UniqSupply -&gt; [Id] -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkBigTupleCase"><span class="hs-identifier hs-var hs-var">mkBigTupleCase</span></a></span></span><span> </span><span id="local-6989586621681673527"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673527"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621681673528"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673528"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621681673529"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673529"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621681673530"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673530"><span class="hs-identifier hs-var">scrut</span></a></span></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; [[Id]] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621681673531"><span class="hs-identifier hs-var">mk_tuple_case</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673532"><span class="hs-identifier hs-var">wrapped_us</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [[Id]]
forall a. [a] -&gt; [[a]]
</span><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673533"><span class="hs-identifier hs-var">wrapped_vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673534"><span class="hs-identifier hs-var">wrapped_body</span></a></span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-670"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681673532"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673532"><span class="hs-identifier hs-var">wrapped_us</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673533"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673533"><span class="hs-identifier hs-var">wrapped_vars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673534"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673534"><span class="hs-identifier hs-var">wrapped_body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id
 -&gt; (UniqSupply, [Id], CoreExpr) -&gt; (UniqSupply, [Id], CoreExpr))
-&gt; (UniqSupply, [Id], CoreExpr)
-&gt; [Id]
-&gt; (UniqSupply, [Id], CoreExpr)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; (UniqSupply, [Id], CoreExpr) -&gt; (UniqSupply, [Id], CoreExpr)
</span><a href="#local-6989586621681673535"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673527"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673529"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673528"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span>    </span><span id="local-6989586621681673536"><span class="annot"><span class="annottext">scrut_ty :: Kind
</span><a href="#local-6989586621681673536"><span class="hs-identifier hs-var hs-var">scrut_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673530"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621681673535"><span class="annot"><span class="annottext">unwrap :: Id -&gt; (UniqSupply, [Id], CoreExpr) -&gt; (UniqSupply, [Id], CoreExpr)
</span><a href="#local-6989586621681673535"><span class="hs-identifier hs-var hs-var">unwrap</span></a></span></span><span> </span><span id="local-6989586621681673537"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673537"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681673538"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673538"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681673539"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673539"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681673540"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673540"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673541"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673542"><span class="hs-identifier hs-var">var'</span></a></span><span class="annot"><span class="annottext">Id -&gt; [Id] -&gt; [Id]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673539"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673543"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-677"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681673541"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673541"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673542"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673542"><span class="hs-identifier hs-var">var'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673543"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673543"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; Id -&gt; CoreExpr -&gt; (UniqSupply, Id, CoreExpr)
</span><a href="GHC.Core.Make.html#unwrapBox"><span class="hs-identifier hs-var">unwrapBox</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673538"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673537"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673540"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span>    </span><span class="annot"><a href="#local-6989586621681673531"><span class="hs-identifier hs-type">mk_tuple_case</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-comment">-- mk_tuple_case [[a1..an], [b1..bm], ...] body</span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-comment">--    case scrut of (p,q, ...) -&gt;</span><span>
</span><span id="line-682"></span><span>    </span><span class="hs-comment">--    case p of (a1,..an) -&gt;</span><span>
</span><span id="line-683"></span><span>    </span><span class="hs-comment">--    case q of (b1,..bm) -&gt;</span><span>
</span><span id="line-684"></span><span>    </span><span class="hs-comment">--    ... -&gt; body</span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-comment">-- This is the case where don't need any nesting</span><span>
</span><span id="line-686"></span><span>    </span><span id="local-6989586621681673531"><span class="annot"><span class="annottext">mk_tuple_case :: UniqSupply -&gt; [[Id]] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621681673531"><span class="hs-identifier hs-var hs-var">mk_tuple_case</span></a></span></span><span> </span><span id="local-6989586621681673544"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673544"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681673545"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673545"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621681673546"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673546"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-687"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleCase"><span class="hs-identifier hs-var">mkSmallTupleCase</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673545"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673546"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673548"><span class="hs-identifier hs-var">scrut_var</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673530"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-688"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-689"></span><span>        </span><span id="local-6989586621681673548"><span class="annot"><span class="annottext">scrut_var :: Id
</span><a href="#local-6989586621681673548"><span class="hs-identifier hs-var hs-var">scrut_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673530"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-690"></span><span>                       </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681673549"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673549"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673549"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-691"></span><span>                       </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UniqSupply, Id) -&gt; Id
forall a b. (a, b) -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#snd/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply -&gt; Kind -&gt; (UniqSupply, Id)
</span><a href="#local-6989586621681673551"><span class="hs-identifier hs-var">new_var</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673544"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673536"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>    </span><span class="hs-comment">-- This is the case where we must nest tuples at least once</span><span>
</span><span id="line-694"></span><span>    </span><span class="annot"><a href="#local-6989586621681673531"><span class="hs-identifier hs-var">mk_tuple_case</span></a></span><span> </span><span id="local-6989586621681673552"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673552"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621681673553"><span class="annot"><span class="annottext">[[Id]]
</span><a href="#local-6989586621681673553"><span class="hs-identifier hs-var">vars_s</span></a></span></span><span> </span><span id="local-6989586621681673554"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673554"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; [[Id]] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621681673531"><span class="hs-identifier hs-var">mk_tuple_case</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673555"><span class="hs-identifier hs-var">us'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [[Id]]
forall a. [a] -&gt; [[a]]
</span><a href="GHC.Core.Make.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673556"><span class="hs-identifier hs-var">vars'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673557"><span class="hs-identifier hs-var">body'</span></a></span><span>
</span><span id="line-696"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-697"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681673555"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673555"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673556"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673556"><span class="hs-identifier hs-var">vars'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673557"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673557"><span class="hs-identifier hs-var">body'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Id]
 -&gt; (UniqSupply, [Id], CoreExpr) -&gt; (UniqSupply, [Id], CoreExpr))
-&gt; (UniqSupply, [Id], CoreExpr)
-&gt; [[Id]]
-&gt; (UniqSupply, [Id], CoreExpr)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
-&gt; (UniqSupply, [Id], CoreExpr) -&gt; (UniqSupply, [Id], CoreExpr)
</span><a href="#local-6989586621681673558"><span class="hs-identifier hs-var">one_tuple_case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673552"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673554"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Id]]
</span><a href="#local-6989586621681673553"><span class="hs-identifier hs-var">vars_s</span></a></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span>    </span><span id="local-6989586621681673558"><span class="annot"><span class="annottext">one_tuple_case :: [Id]
-&gt; (UniqSupply, [Id], CoreExpr) -&gt; (UniqSupply, [Id], CoreExpr)
</span><a href="#local-6989586621681673558"><span class="hs-identifier hs-var hs-var">one_tuple_case</span></a></span></span><span> </span><span id="local-6989586621681673559"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673559"><span class="hs-identifier hs-var">chunk_vars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681673560"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673560"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673561"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673561"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673562"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673562"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673563"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673564"><span class="hs-identifier hs-var">scrut_var</span></a></span><span class="annot"><span class="annottext">Id -&gt; [Id] -&gt; [Id]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673561"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673565"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-702"></span><span>        </span><span id="local-6989586621681673566"><span class="annot"><span class="annottext">tup_ty :: Kind
</span><a href="#local-6989586621681673566"><span class="hs-identifier hs-var hs-var">tup_ty</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind
</span><a href="GHC.Builtin.Types.html#mkBoxedTupleTy"><span class="hs-identifier hs-var">mkBoxedTupleTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; Kind) -&gt; [Id] -&gt; [Kind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673559"><span class="hs-identifier hs-var">chunk_vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681673563"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673563"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673564"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673564"><span class="hs-identifier hs-var">scrut_var</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; Kind -&gt; (UniqSupply, Id)
</span><a href="#local-6989586621681673551"><span class="hs-identifier hs-var">new_var</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673560"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673566"><span class="hs-identifier hs-var">tup_ty</span></a></span><span>
</span><span id="line-704"></span><span>        </span><span id="local-6989586621681673565"><span class="annot"><span class="annottext">body' :: CoreExpr
</span><a href="#local-6989586621681673565"><span class="hs-identifier hs-var hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleCase"><span class="hs-identifier hs-var">mkSmallTupleCase</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673559"><span class="hs-identifier hs-var">chunk_vars</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673562"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673564"><span class="hs-identifier hs-var">scrut_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673564"><span class="hs-identifier hs-var">scrut_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span>    </span><span class="annot"><a href="#local-6989586621681673551"><span class="hs-identifier hs-type">new_var</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>    </span><span id="local-6989586621681673551"><span class="annot"><span class="annottext">new_var :: UniqSupply -&gt; Kind -&gt; (UniqSupply, Id)
</span><a href="#local-6989586621681673551"><span class="hs-identifier hs-var hs-var">new_var</span></a></span></span><span> </span><span id="local-6989586621681673567"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673567"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621681673568"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673568"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673569"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673570"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>       </span><span class="hs-keyword">where</span><span>
</span><span id="line-709"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621681673571"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681673571"><span class="hs-identifier hs-var">uniq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673569"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673569"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (Unique, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681673567"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-710"></span><span>         </span><span id="local-6989586621681673570"><span class="annot"><span class="annottext">id :: Id
</span><a href="#local-6989586621681673570"><span class="hs-identifier hs-var hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Unique -&gt; Kind -&gt; Kind -&gt; Id
</span><a href="GHC.Types.Id.html#mkSysLocal"><span class="hs-identifier hs-var">mkSysLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ds&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681673571"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673568"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-711"></span><span>
</span><span id="line-712"></span><span class="hs-comment">-- | As 'mkBigTupleCase', but for a tuple that is small enough to be guaranteed</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- not to need nesting.</span><span>
</span><span id="line-714"></span><span class="annot"><a href="GHC.Core.Make.html#mkSmallTupleCase"><span class="hs-identifier hs-type">mkSmallTupleCase</span></a></span><span>
</span><span id="line-715"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>         </span><span class="annot"><span class="hs-comment">-- ^ The tuple args</span></span><span>
</span><span id="line-716"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Body of the case</span></span><span>
</span><span id="line-717"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ A variable of the same type as the scrutinee</span></span><span>
</span><span id="line-718"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Scrutinee</span></span><span>
</span><span id="line-719"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span id="mkSmallTupleCase"><span class="annot"><span class="annottext">mkSmallTupleCase :: [Id] -&gt; CoreExpr -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkSmallTupleCase"><span class="hs-identifier hs-var hs-var">mkSmallTupleCase</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681673572"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673572"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621681673573"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673573"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621681673574"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673574"><span class="hs-identifier hs-var">_scrut_var</span></a></span></span><span> </span><span id="local-6989586621681673575"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673575"><span class="hs-identifier hs-var">scrut</span></a></span></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Id -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
Id -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#bindNonRec"><span class="hs-identifier hs-var">bindNonRec</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673572"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673575"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673573"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-723"></span><span class="annot"><a href="GHC.Core.Make.html#mkSmallTupleCase"><span class="hs-identifier hs-var">mkSmallTupleCase</span></a></span><span> </span><span id="local-6989586621681673576"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673576"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621681673577"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673577"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621681673578"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673578"><span class="hs-identifier hs-var">scrut_var</span></a></span></span><span> </span><span id="local-6989586621681673579"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673579"><span class="hs-identifier hs-var">scrut</span></a></span></span><span>
</span><span id="line-724"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; Kind -&gt; [CoreAlt] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; Kind -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673579"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673578"><span class="hs-identifier hs-var">scrut_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; CoreExpr -&gt; Kind
CoreExpr -&gt; Kind
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673577"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>         </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673576"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673576"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673577"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Floats
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span class="hs-keyword">data</span><span> </span><span id="FloatBind"><span class="annot"><a href="GHC.Core.Make.html#FloatBind"><span class="hs-identifier hs-var">FloatBind</span></a></span></span><span>
</span><span id="line-736"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FloatLet"><span class="annot"><a href="GHC.Core.Make.html#FloatLet"><span class="hs-identifier hs-var">FloatLet</span></a></span></span><span>  </span><span class="annot"><a href="GHC.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FloatCase"><span class="annot"><a href="GHC.Core.Make.html#FloatCase"><span class="hs-identifier hs-var">FloatCase</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-738"></span><span>      </span><span class="hs-comment">-- case e of y { C ys -&gt; ... }</span><span>
</span><span id="line-739"></span><span>      </span><span class="hs-comment">-- See Note [Floating single-alternative cases] in GHC.Core.Opt.SetLevels</span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#FloatBind"><span class="hs-identifier hs-type">FloatBind</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-742"></span><span>  </span><span id="local-6989586621681673601"><span class="annot"><span class="annottext">ppr :: FloatBind -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#FloatLet"><span class="hs-identifier hs-type">FloatLet</span></a></span><span> </span><span id="local-6989586621681673602"><span class="annot"><span class="annottext">CoreBind
</span><a href="#local-6989586621681673602"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LET&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBind -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBind
</span><a href="#local-6989586621681673602"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-743"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#FloatCase"><span class="hs-identifier hs-type">FloatCase</span></a></span><span> </span><span id="local-6989586621681673605"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673605"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681673606"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673606"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621681673607"><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621681673607"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681673608"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673608"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CASE&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673605"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673606"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>                                </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AltCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621681673607"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673608"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="annot"><a href="GHC.Core.Make.html#wrapFloat"><span class="hs-identifier hs-type">wrapFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#FloatBind"><span class="hs-identifier hs-type">FloatBind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-747"></span><span id="wrapFloat"><span class="annot"><span class="annottext">wrapFloat :: FloatBind -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#wrapFloat"><span class="hs-identifier hs-var hs-var">wrapFloat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#FloatLet"><span class="hs-identifier hs-type">FloatLet</span></a></span><span> </span><span id="local-6989586621681673610"><span class="annot"><span class="annottext">CoreBind
</span><a href="#local-6989586621681673610"><span class="hs-identifier hs-var">defns</span></a></span></span><span class="hs-special">)</span><span>       </span><span id="local-6989586621681673611"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673611"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreBind -&gt; CoreExpr -&gt; CoreExpr
forall b. Bind b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBind
</span><a href="#local-6989586621681673610"><span class="hs-identifier hs-var">defns</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673611"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-748"></span><span class="annot"><a href="GHC.Core.Make.html#wrapFloat"><span class="hs-identifier hs-var">wrapFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#FloatCase"><span class="hs-identifier hs-type">FloatCase</span></a></span><span> </span><span id="local-6989586621681673612"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673612"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681673613"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673613"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621681673614"><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621681673614"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681673615"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673615"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681673616"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673616"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Id -&gt; AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkSingleAltCase"><span class="hs-identifier hs-var">mkSingleAltCase</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673612"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673613"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621681673614"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673615"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673616"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span class="hs-comment">-- | Applies the floats from right to left. That is @wrapFloats [b1, b2, &#8230;, bn]</span><span>
</span><span id="line-751"></span><span class="hs-comment">-- u = let b1 in let b2 in &#8230; in let bn in u@</span><span>
</span><span id="line-752"></span><span class="annot"><a href="GHC.Core.Make.html#wrapFloats"><span class="hs-identifier hs-type">wrapFloats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Make.html#FloatBind"><span class="hs-identifier hs-type">FloatBind</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-753"></span><span id="wrapFloats"><span class="annot"><span class="annottext">wrapFloats :: [FloatBind] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#wrapFloats"><span class="hs-identifier hs-var hs-var">wrapFloats</span></a></span></span><span> </span><span id="local-6989586621681673617"><span class="annot"><span class="annottext">[FloatBind]
</span><a href="#local-6989586621681673617"><span class="hs-identifier hs-var">floats</span></a></span></span><span> </span><span id="local-6989586621681673618"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673618"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FloatBind -&gt; CoreExpr -&gt; CoreExpr)
-&gt; CoreExpr -&gt; [FloatBind] -&gt; CoreExpr
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">FloatBind -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#wrapFloat"><span class="hs-identifier hs-var">wrapFloat</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673618"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">[FloatBind]
</span><a href="#local-6989586621681673617"><span class="hs-identifier hs-var">floats</span></a></span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span class="annot"><a href="GHC.Core.Make.html#bindBindings"><span class="hs-identifier hs-type">bindBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-756"></span><span id="bindBindings"><span class="annot"><span class="annottext">bindBindings :: CoreBind -&gt; [Id]
</span><a href="GHC.Core.Make.html#bindBindings"><span class="hs-identifier hs-var hs-var">bindBindings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-type">NonRec</span></a></span><span> </span><span id="local-6989586621681673620"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673620"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673620"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-757"></span><span class="annot"><a href="GHC.Core.Make.html#bindBindings"><span class="hs-identifier hs-var">bindBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span id="local-6989586621681673622"><span class="annot"><span class="annottext">[(Id, CoreExpr)]
</span><a href="#local-6989586621681673622"><span class="hs-identifier hs-var">bnds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Id, CoreExpr) -&gt; Id) -&gt; [(Id, CoreExpr)] -&gt; [Id]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Id, CoreExpr) -&gt; Id
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Id, CoreExpr)]
</span><a href="#local-6989586621681673622"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-758"></span><span>
</span><span id="line-759"></span><span class="annot"><a href="GHC.Core.Make.html#floatBindings"><span class="hs-identifier hs-type">floatBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#FloatBind"><span class="hs-identifier hs-type">FloatBind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-760"></span><span id="floatBindings"><span class="annot"><span class="annottext">floatBindings :: FloatBind -&gt; [Id]
</span><a href="GHC.Core.Make.html#floatBindings"><span class="hs-identifier hs-var hs-var">floatBindings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#FloatLet"><span class="hs-identifier hs-type">FloatLet</span></a></span><span> </span><span id="local-6989586621681673623"><span class="annot"><span class="annottext">CoreBind
</span><a href="#local-6989586621681673623"><span class="hs-identifier hs-var">bnd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreBind -&gt; [Id]
</span><a href="GHC.Core.Make.html#bindBindings"><span class="hs-identifier hs-var">bindBindings</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBind
</span><a href="#local-6989586621681673623"><span class="hs-identifier hs-var">bnd</span></a></span><span>
</span><span id="line-761"></span><span class="annot"><a href="GHC.Core.Make.html#floatBindings"><span class="hs-identifier hs-var">floatBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#FloatCase"><span class="hs-identifier hs-type">FloatCase</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681673624"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673624"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681673625"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673625"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673624"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Id -&gt; [Id] -&gt; [Id]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681673625"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Common list manipulation expressions}
*                                                                      *
************************************************************************

Call the constructor Ids when building explicit lists, so that they
interact well with rules.
-}</span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span class="annot"><span class="hs-comment">-- | Makes a list @[]@ for lists of the specified type</span></span><span>
</span><span id="line-775"></span><span class="annot"><a href="GHC.Core.Make.html#mkNilExpr"><span class="hs-identifier hs-type">mkNilExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-776"></span><span id="mkNilExpr"><span class="annot"><span class="annottext">mkNilExpr :: Kind -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNilExpr"><span class="hs-identifier hs-var hs-var">mkNilExpr</span></a></span></span><span> </span><span id="local-6989586621681673626"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673626"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#nilDataCon"><span class="hs-identifier hs-var">nilDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673626"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span class="annot"><span class="hs-comment">-- | Makes a list @(:)@ for lists of the specified type</span></span><span>
</span><span id="line-779"></span><span class="annot"><a href="GHC.Core.Make.html#mkConsExpr"><span class="hs-identifier hs-type">mkConsExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-780"></span><span id="mkConsExpr"><span class="annot"><span class="annottext">mkConsExpr :: Kind -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkConsExpr"><span class="hs-identifier hs-var hs-var">mkConsExpr</span></a></span></span><span> </span><span id="local-6989586621681673628"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673628"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681673629"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673629"><span class="hs-identifier hs-var">hd</span></a></span></span><span> </span><span id="local-6989586621681673630"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673630"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-var">mkCoreConApps</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#consDataCon"><span class="hs-identifier hs-var">consDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673628"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673629"><span class="hs-identifier hs-var">hd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673630"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span class="annot"><span class="hs-comment">-- | Make a list containing the given expressions, where the list has the given type</span></span><span>
</span><span id="line-783"></span><span class="annot"><a href="GHC.Core.Make.html#mkListExpr"><span class="hs-identifier hs-type">mkListExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-784"></span><span id="mkListExpr"><span class="annot"><span class="annottext">mkListExpr :: Kind -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkListExpr"><span class="hs-identifier hs-var hs-var">mkListExpr</span></a></span></span><span> </span><span id="local-6989586621681673632"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673632"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681673633"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673633"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr -&gt; CoreExpr)
-&gt; CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkConsExpr"><span class="hs-identifier hs-var">mkConsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673632"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNilExpr"><span class="hs-identifier hs-var">mkNilExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673632"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621681673633"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="annot"><span class="hs-comment">-- | Make a fully applied 'foldr' expression</span></span><span>
</span><span id="line-787"></span><span id="local-6989586621681673030"><span class="annot"><a href="GHC.Core.Make.html#mkFoldrExpr"><span class="hs-identifier hs-type">mkFoldrExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.TyThing.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681673030"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-788"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Element type of the list</span></span><span>
</span><span id="line-789"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Fold result type</span></span><span>
</span><span id="line-790"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ &quot;Cons&quot; function expression for the fold</span></span><span>
</span><span id="line-791"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ &quot;Nil&quot; expression for the fold</span></span><span>
</span><span id="line-792"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ List expression being folded acress</span></span><span>
</span><span id="line-793"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681673030"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span><span>
</span><span id="line-794"></span><span id="mkFoldrExpr"><span class="annot"><span class="annottext">mkFoldrExpr :: forall (m :: * -&gt; *).
MonadThings m =&gt;
Kind -&gt; Kind -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkFoldrExpr"><span class="hs-identifier hs-var hs-var">mkFoldrExpr</span></a></span></span><span> </span><span id="local-6989586621681673639"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673639"><span class="hs-identifier hs-var">elt_ty</span></a></span></span><span> </span><span id="local-6989586621681673640"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673640"><span class="hs-identifier hs-var">result_ty</span></a></span></span><span> </span><span id="local-6989586621681673641"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673641"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681673642"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673642"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681673643"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673643"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-795"></span><span>    </span><span id="local-6989586621681673644"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673644"><span class="hs-identifier hs-var">foldr_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Id
forall (m :: * -&gt; *). MonadThings m =&gt; Name -&gt; m Id
</span><a href="GHC.Types.TyThing.html#lookupId"><span class="hs-identifier hs-var">lookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#foldrName"><span class="hs-identifier hs-var">foldrName</span></a></span><span>
</span><span id="line-796"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr -&gt; m CoreExpr
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673644"><span class="hs-identifier hs-var">foldr_id</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673639"><span class="hs-identifier hs-var">elt_ty</span></a></span><span>
</span><span id="line-797"></span><span>           </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673640"><span class="hs-identifier hs-var">result_ty</span></a></span><span>
</span><span id="line-798"></span><span>           </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673641"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-799"></span><span>           </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673642"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-800"></span><span>           </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673643"><span class="hs-identifier hs-var">list</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>
</span><span id="line-802"></span><span class="annot"><span class="hs-comment">-- | Make a 'build' expression applied to a locally-bound worker function</span></span><span>
</span><span id="line-803"></span><span id="local-6989586621681673033"><span class="annot"><a href="GHC.Core.Make.html#mkBuildExpr"><span class="hs-identifier hs-type">mkBuildExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Monad.Fail.html#MonadFail/Control.Monad.Fail.html#MonadFail"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681673033"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.TyThing.html#MonadThings"><span class="hs-identifier hs-type">MonadThings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681673033"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#MonadUnique"><span class="hs-identifier hs-type">MonadUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681673033"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>                                     </span><span class="annot"><span class="hs-comment">-- ^ Type of list elements to be built</span></span><span>
</span><span id="line-805"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681673033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Function that, given information about the 'Id's</span><span>
</span><span id="line-806"></span><span>                                                        </span><span class="hs-comment">-- of the binders for the build worker function, returns</span><span>
</span><span id="line-807"></span><span>                                                        </span><span class="hs-comment">-- the body of that worker</span><span>
</span><span id="line-808"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681673033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span><span>
</span><span id="line-809"></span><span id="mkBuildExpr"><span class="annot"><span class="annottext">mkBuildExpr :: forall (m :: * -&gt; *).
(MonadFail m, MonadThings m, MonadUnique m) =&gt;
Kind -&gt; ((Id, Kind) -&gt; (Id, Kind) -&gt; m CoreExpr) -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkBuildExpr"><span class="hs-identifier hs-var hs-var">mkBuildExpr</span></a></span></span><span> </span><span id="local-6989586621681673664"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673664"><span class="hs-identifier hs-var">elt_ty</span></a></span></span><span> </span><span id="local-6989586621681673665"><span class="annot"><span class="annottext">(Id, Kind) -&gt; (Id, Kind) -&gt; m CoreExpr
</span><a href="#local-6989586621681673665"><span class="hs-identifier hs-var">mk_build_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-810"></span><span>    </span><span id="local-6989586621681673666"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673666"><span class="hs-identifier hs-var">n_tyvar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; m Id
forall {m :: * -&gt; *}. MonadUnique m =&gt; Id -&gt; m Id
</span><a href="#local-6989586621681673667"><span class="hs-identifier hs-var">newTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span>
</span><span id="line-811"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681673669"><span class="annot"><span class="annottext">n_ty :: Kind
</span><a href="#local-6989586621681673669"><span class="hs-identifier hs-var hs-var">n_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673666"><span class="hs-identifier hs-var">n_tyvar</span></a></span><span>
</span><span id="line-812"></span><span>        </span><span id="local-6989586621681673671"><span class="annot"><span class="annottext">c_ty :: Kind
</span><a href="#local-6989586621681673671"><span class="hs-identifier hs-var hs-var">c_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTysMany"><span class="hs-identifier hs-var">mkVisFunTysMany</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673664"><span class="hs-identifier hs-var">elt_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673669"><span class="hs-identifier hs-var">n_ty</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673669"><span class="hs-identifier hs-var">n_ty</span></a></span><span>
</span><span id="line-813"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621681673673"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673673"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681673674"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673674"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[m Id] -&gt; m [Id]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#sequence/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FastString -&gt; Kind -&gt; Kind -&gt; m Id
forall (m :: * -&gt; *).
MonadUnique m =&gt;
FastString -&gt; Kind -&gt; Kind -&gt; m Id
</span><a href="GHC.Types.Id.html#mkSysLocalM"><span class="hs-identifier hs-var">mkSysLocalM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;c&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673671"><span class="hs-identifier hs-var">c_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Kind -&gt; Kind -&gt; m Id
forall (m :: * -&gt; *).
MonadUnique m =&gt;
FastString -&gt; Kind -&gt; Kind -&gt; m Id
</span><a href="GHC.Types.Id.html#mkSysLocalM"><span class="hs-identifier hs-var">mkSysLocalM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673669"><span class="hs-identifier hs-var">n_ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span>    </span><span id="local-6989586621681673677"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673677"><span class="hs-identifier hs-var">build_inside</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Id, Kind) -&gt; (Id, Kind) -&gt; m CoreExpr
</span><a href="#local-6989586621681673665"><span class="hs-identifier hs-var">mk_build_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673673"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673671"><span class="hs-identifier hs-var">c_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673674"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673669"><span class="hs-identifier hs-var">n_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span>    </span><span id="local-6989586621681673678"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673678"><span class="hs-identifier hs-var">build_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Id
forall (m :: * -&gt; *). MonadThings m =&gt; Name -&gt; m Id
</span><a href="GHC.Types.TyThing.html#lookupId"><span class="hs-identifier hs-var">lookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#buildName"><span class="hs-identifier hs-var">buildName</span></a></span><span>
</span><span id="line-818"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr -&gt; m CoreExpr
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; m CoreExpr) -&gt; CoreExpr -&gt; m CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673678"><span class="hs-identifier hs-var">build_id</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673664"><span class="hs-identifier hs-var">elt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673666"><span class="hs-identifier hs-var">n_tyvar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673673"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673674"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673677"><span class="hs-identifier hs-var">build_inside</span></a></span><span>
</span><span id="line-819"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-820"></span><span>    </span><span id="local-6989586621681673667"><span class="annot"><span class="annottext">newTyVar :: Id -&gt; m Id
</span><a href="#local-6989586621681673667"><span class="hs-identifier hs-var hs-var">newTyVar</span></a></span></span><span> </span><span id="local-6989586621681673693"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673693"><span class="hs-identifier hs-var">tyvar_tmpl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-821"></span><span>      </span><span id="local-6989586621681673694"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681673694"><span class="hs-identifier hs-var">uniq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Unique
forall (m :: * -&gt; *). MonadUnique m =&gt; m Unique
</span><a href="GHC.Types.Unique.Supply.html#getUniqueM"><span class="hs-identifier hs-var">getUniqueM</span></a></span><span>
</span><span id="line-822"></span><span>      </span><span class="annot"><span class="annottext">Id -&gt; m Id
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Unique -&gt; Id
</span><a href="GHC.Types.Var.html#setTyVarUnique"><span class="hs-identifier hs-var">setTyVarUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673693"><span class="hs-identifier hs-var">tyvar_tmpl</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681673694"><span class="hs-identifier hs-var">uniq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
             Manipulating Maybe data type
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-831"></span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span class="annot"><span class="hs-comment">-- | Makes a Nothing for the specified type</span></span><span>
</span><span id="line-834"></span><span class="annot"><a href="GHC.Core.Make.html#mkNothingExpr"><span class="hs-identifier hs-type">mkNothingExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-835"></span><span id="mkNothingExpr"><span class="annot"><span class="annottext">mkNothingExpr :: Kind -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNothingExpr"><span class="hs-identifier hs-var hs-var">mkNothingExpr</span></a></span></span><span> </span><span id="local-6989586621681673696"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673696"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
forall b. DataCon -&gt; [Arg b] -&gt; Arg b
</span><a href="GHC.Core.html#mkConApp"><span class="hs-identifier hs-var">mkConApp</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#nothingDataCon"><span class="hs-identifier hs-var">nothingDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673696"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="annot"><span class="hs-comment">-- | Makes a Just from a value of the specified type</span></span><span>
</span><span id="line-838"></span><span class="annot"><a href="GHC.Core.Make.html#mkJustExpr"><span class="hs-identifier hs-type">mkJustExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-839"></span><span id="mkJustExpr"><span class="annot"><span class="annottext">mkJustExpr :: Kind -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkJustExpr"><span class="hs-identifier hs-var hs-var">mkJustExpr</span></a></span></span><span> </span><span id="local-6989586621681673699"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673699"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681673700"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673700"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [CoreExpr] -&gt; CoreExpr
forall b. DataCon -&gt; [Arg b] -&gt; Arg b
</span><a href="GHC.Core.html#mkConApp"><span class="hs-identifier hs-var">mkConApp</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#justDataCon"><span class="hs-identifier hs-var">justDataCon</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673699"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673700"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                      Error expressions
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span class="annot"><a href="GHC.Core.Make.html#mkRuntimeErrorApp"><span class="hs-identifier hs-type">mkRuntimeErrorApp</span></a></span><span>
</span><span id="line-851"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>           </span><span class="hs-comment">-- Should be of type</span><span>
</span><span id="line-852"></span><span>                        </span><span class="hs-comment">--   forall (r::RuntimeRep) (a::TYPE r). Addr# -&gt; a</span><span>
</span><span id="line-853"></span><span>                        </span><span class="hs-comment">--      or (a :: CONSTRAINT r)</span><span>
</span><span id="line-854"></span><span>                        </span><span class="hs-comment">--      where Addr# points to a UTF8 encoded string</span><span>
</span><span id="line-855"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>         </span><span class="hs-comment">-- The type to instantiate 'a'</span><span>
</span><span id="line-856"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>       </span><span class="hs-comment">-- The string to print</span><span>
</span><span id="line-857"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span id="mkRuntimeErrorApp"><span class="annot"><span class="annottext">mkRuntimeErrorApp :: Id -&gt; Kind -&gt; String -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkRuntimeErrorApp"><span class="hs-identifier hs-var hs-var">mkRuntimeErrorApp</span></a></span></span><span> </span><span id="local-6989586621681673702"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673702"><span class="hs-identifier hs-var">err_id</span></a></span></span><span> </span><span id="local-6989586621681673703"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673703"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span id="local-6989586621681673704"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673704"><span class="hs-identifier hs-var">err_msg</span></a></span></span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr
forall b. Expr b -&gt; [Expr b] -&gt; Expr b
</span><a href="GHC.Core.html#mkApps"><span class="hs-identifier hs-var">mkApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673702"><span class="hs-identifier hs-var">err_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673703"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673703"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673706"><span class="hs-identifier hs-var">err_string</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-862"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-863"></span><span>    </span><span id="local-6989586621681673706"><span class="annot"><span class="annottext">err_string :: CoreExpr
</span><a href="#local-6989586621681673706"><span class="hs-identifier hs-var hs-var">err_string</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitString"><span class="hs-identifier hs-var">mkLitString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673704"><span class="hs-identifier hs-var">err_msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                     Error Ids
*                                                                      *
************************************************************************

GHC randomly injects these into the code.

@patError@ is just a version of @error@ for pattern-matching
failures.  It knows various ``codes'' which expand to longer
strings---this saves space!

@absentErr@ is a thing we put in for ``absent'' arguments.  They jolly
well shouldn't be yanked on, but if one is, then you will get a
friendly message from @absentErr@ (rather than a totally random
crash).
-}</span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span class="annot"><a href="GHC.Core.Make.html#errorIds"><span class="hs-identifier hs-type">errorIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-885"></span><span id="errorIds"><span class="annot"><span class="annottext">errorIds :: [Id]
</span><a href="GHC.Core.Make.html#errorIds"><span class="hs-identifier hs-var hs-var">errorIds</span></a></span></span><span>
</span><span id="line-886"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier hs-var">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-887"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier hs-var">nO_METHOD_BINDING_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-888"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#pAT_ERROR_ID"><span class="hs-identifier hs-var">pAT_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-889"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-var">rEC_CON_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-890"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#rEC_SEL_ERROR_ID"><span class="hs-identifier hs-var">rEC_SEL_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-891"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#iMPOSSIBLE_ERROR_ID"><span class="hs-identifier hs-var">iMPOSSIBLE_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#iMPOSSIBLE_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-var">iMPOSSIBLE_CONSTRAINT_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-892"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_ERROR_ID</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_CONSTRAINT_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-893"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_SUM_FIELD_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_SUM_FIELD_ERROR_ID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-894"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#tYPE_ERROR_ID"><span class="hs-identifier hs-var">tYPE_ERROR_ID</span></a></span><span>   </span><span class="hs-comment">-- Used with Opt_DeferTypeErrors, see #10284</span><span>
</span><span id="line-895"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span class="annot"><a href="GHC.Core.Make.html#recSelErrorName"><span class="hs-identifier hs-type">recSelErrorName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#recConErrorName"><span class="hs-identifier hs-type">recConErrorName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#patErrorName"><span class="hs-identifier hs-type">patErrorName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-898"></span><span class="annot"><a href="GHC.Core.Make.html#nonExhaustiveGuardsErrorName"><span class="hs-identifier hs-type">nonExhaustiveGuardsErrorName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#noMethodBindingErrorName"><span class="hs-identifier hs-type">noMethodBindingErrorName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-899"></span><span class="annot"><a href="GHC.Core.Make.html#typeErrorName"><span class="hs-identifier hs-type">typeErrorName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-900"></span><span class="annot"><a href="GHC.Core.Make.html#absentSumFieldErrorName"><span class="hs-identifier hs-type">absentSumFieldErrorName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-901"></span><span>
</span><span id="line-902"></span><span id="recSelErrorName"><span class="annot"><span class="annottext">recSelErrorName :: Name
</span><a href="GHC.Core.Make.html#recSelErrorName"><span class="hs-identifier hs-var hs-var">recSelErrorName</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;recSelError&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#recSelErrorIdKey"><span class="hs-identifier hs-var">recSelErrorIdKey</span></a></span><span>     </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#rEC_SEL_ERROR_ID"><span class="hs-identifier hs-var">rEC_SEL_ERROR_ID</span></a></span><span>
</span><span id="line-903"></span><span id="recConErrorName"><span class="annot"><span class="annottext">recConErrorName :: Name
</span><a href="GHC.Core.Make.html#recConErrorName"><span class="hs-identifier hs-var hs-var">recConErrorName</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;recConError&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#recConErrorIdKey"><span class="hs-identifier hs-var">recConErrorIdKey</span></a></span><span>     </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-var">rEC_CON_ERROR_ID</span></a></span><span>
</span><span id="line-904"></span><span id="patErrorName"><span class="annot"><span class="annottext">patErrorName :: Name
</span><a href="GHC.Core.Make.html#patErrorName"><span class="hs-identifier hs-var hs-var">patErrorName</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;patError&quot;</span></span><span>        </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#patErrorIdKey"><span class="hs-identifier hs-var">patErrorIdKey</span></a></span><span>        </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#pAT_ERROR_ID"><span class="hs-identifier hs-var">pAT_ERROR_ID</span></a></span><span>
</span><span id="line-905"></span><span id="typeErrorName"><span class="annot"><span class="annottext">typeErrorName :: Name
</span><a href="GHC.Core.Make.html#typeErrorName"><span class="hs-identifier hs-var hs-var">typeErrorName</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typeError&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#typeErrorIdKey"><span class="hs-identifier hs-var">typeErrorIdKey</span></a></span><span>       </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#tYPE_ERROR_ID"><span class="hs-identifier hs-var">tYPE_ERROR_ID</span></a></span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span id="noMethodBindingErrorName"><span class="annot"><span class="annottext">noMethodBindingErrorName :: Name
</span><a href="GHC.Core.Make.html#noMethodBindingErrorName"><span class="hs-identifier hs-var hs-var">noMethodBindingErrorName</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;noMethodBindingError&quot;</span></span><span>
</span><span id="line-908"></span><span>                                  </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#noMethodBindingErrorIdKey"><span class="hs-identifier hs-var">noMethodBindingErrorIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier hs-var">nO_METHOD_BINDING_ERROR_ID</span></a></span><span>
</span><span id="line-909"></span><span id="nonExhaustiveGuardsErrorName"><span class="annot"><span class="annottext">nonExhaustiveGuardsErrorName :: Name
</span><a href="GHC.Core.Make.html#nonExhaustiveGuardsErrorName"><span class="hs-identifier hs-var hs-var">nonExhaustiveGuardsErrorName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nonExhaustiveGuardsError&quot;</span></span><span>
</span><span id="line-910"></span><span>                                  </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#nonExhaustiveGuardsErrorIdKey"><span class="hs-identifier hs-var">nonExhaustiveGuardsErrorIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier hs-var">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a></span><span>
</span><span id="line-911"></span><span>
</span><span id="line-912"></span><span class="annot"><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-type">err_nm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-913"></span><span id="err_nm"><span class="annot"><span class="annottext">err_nm :: String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var hs-var">err_nm</span></a></span></span><span> </span><span id="local-6989586621681673726"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673726"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621681673727"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681673727"><span class="hs-identifier hs-var">uniq</span></a></span></span><span> </span><span id="local-6989586621681673728"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673728"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; FastString -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#cONTROL_EXCEPTION_BASE"><span class="hs-identifier hs-var">cONTROL_EXCEPTION_BASE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673726"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681673727"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673728"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="annot"><a href="GHC.Core.Make.html#rEC_SEL_ERROR_ID"><span class="hs-identifier hs-type">rEC_SEL_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-type">rEC_CON_ERROR_ID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-916"></span><span class="annot"><a href="GHC.Core.Make.html#pAT_ERROR_ID"><span class="hs-identifier hs-type">pAT_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier hs-type">nO_METHOD_BINDING_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier hs-type">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-917"></span><span class="annot"><a href="GHC.Core.Make.html#tYPE_ERROR_ID"><span class="hs-identifier hs-type">tYPE_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#aBSENT_SUM_FIELD_ERROR_ID"><span class="hs-identifier hs-type">aBSENT_SUM_FIELD_ERROR_ID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-918"></span><span id="rEC_SEL_ERROR_ID"><span class="annot"><span class="annottext">rEC_SEL_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#rEC_SEL_ERROR_ID"><span class="hs-identifier hs-var hs-var">rEC_SEL_ERROR_ID</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#recSelErrorName"><span class="hs-identifier hs-var">recSelErrorName</span></a></span><span>
</span><span id="line-919"></span><span id="rEC_CON_ERROR_ID"><span class="annot"><span class="annottext">rEC_CON_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-var hs-var">rEC_CON_ERROR_ID</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#recConErrorName"><span class="hs-identifier hs-var">recConErrorName</span></a></span><span>
</span><span id="line-920"></span><span id="pAT_ERROR_ID"><span class="annot"><span class="annottext">pAT_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#pAT_ERROR_ID"><span class="hs-identifier hs-var hs-var">pAT_ERROR_ID</span></a></span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#patErrorName"><span class="hs-identifier hs-var">patErrorName</span></a></span><span>
</span><span id="line-921"></span><span id="nO_METHOD_BINDING_ERROR_ID"><span class="annot"><span class="annottext">nO_METHOD_BINDING_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#nO_METHOD_BINDING_ERROR_ID"><span class="hs-identifier hs-var hs-var">nO_METHOD_BINDING_ERROR_ID</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#noMethodBindingErrorName"><span class="hs-identifier hs-var">noMethodBindingErrorName</span></a></span><span>
</span><span id="line-922"></span><span id="nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="annot"><span class="annottext">nON_EXHAUSTIVE_GUARDS_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier hs-var hs-var">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#nonExhaustiveGuardsErrorName"><span class="hs-identifier hs-var">nonExhaustiveGuardsErrorName</span></a></span><span>
</span><span id="line-923"></span><span id="tYPE_ERROR_ID"><span class="annot"><span class="annottext">tYPE_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#tYPE_ERROR_ID"><span class="hs-identifier hs-var hs-var">tYPE_ERROR_ID</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#typeErrorName"><span class="hs-identifier hs-var">typeErrorName</span></a></span><span>
</span><span id="line-924"></span><span>
</span><span id="line-925"></span><span class="hs-comment">-- Note [aBSENT_SUM_FIELD_ERROR_ID]</span><span>
</span><span id="line-926"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-927"></span><span class="hs-comment">-- Unboxed sums are transformed into unboxed tuples in GHC.Stg.Unarise.mkUbxSum</span><span>
</span><span id="line-928"></span><span class="hs-comment">-- and fields that can't be reached are filled with rubbish values.</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- For instance, consider the case of the program:</span><span>
</span><span id="line-930"></span><span class="hs-comment">--</span><span>
</span><span id="line-931"></span><span class="hs-comment">--     f :: (# Int | Float# #) -&gt; Int</span><span>
</span><span id="line-932"></span><span class="hs-comment">--     f = ...</span><span>
</span><span id="line-933"></span><span class="hs-comment">--</span><span>
</span><span id="line-934"></span><span class="hs-comment">--     x = f (# | 2.0## #)</span><span>
</span><span id="line-935"></span><span class="hs-comment">--</span><span>
</span><span id="line-936"></span><span class="hs-comment">-- Unarise will represent f's unboxed sum argument as a tuple (# Int#, Int,</span><span>
</span><span id="line-937"></span><span class="hs-comment">-- Float# #), where Int# is a tag. Consequently, `x` will be rewritten to:</span><span>
</span><span id="line-938"></span><span class="hs-comment">--</span><span>
</span><span id="line-939"></span><span class="hs-comment">--     x = f (# 2#, ???, 2.0## #)</span><span>
</span><span id="line-940"></span><span class="hs-comment">--</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- We must come up with some rubbish literal to use in place of `???`. In the</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- case of unboxed integer types this is easy: we can simply use 0 for</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- Int#/Word# and 0.0 Float#/Double#.</span><span>
</span><span id="line-944"></span><span class="hs-comment">--</span><span>
</span><span id="line-945"></span><span class="hs-comment">-- However, coming up with a rubbish pointer value is more delicate as the</span><span>
</span><span id="line-946"></span><span class="hs-comment">-- value must satisfy the following requirements:</span><span>
</span><span id="line-947"></span><span class="hs-comment">--</span><span>
</span><span id="line-948"></span><span class="hs-comment">--    1. it needs to be a valid closure pointer for the GC (not a NULL pointer)</span><span>
</span><span id="line-949"></span><span class="hs-comment">--</span><span>
</span><span id="line-950"></span><span class="hs-comment">--    2. it can't take arguments because it's used in unarise and applying an</span><span>
</span><span id="line-951"></span><span class="hs-comment">--       argument would require allocating a thunk, which is both difficult to</span><span>
</span><span id="line-952"></span><span class="hs-comment">--       do and costly.</span><span>
</span><span id="line-953"></span><span class="hs-comment">--</span><span>
</span><span id="line-954"></span><span class="hs-comment">--    3. it shouldn't be CAFfy since this would make otherwise non-CAFfy</span><span>
</span><span id="line-955"></span><span class="hs-comment">--       bindings CAFfy, incurring a cost in GC performance. Given that unboxed</span><span>
</span><span id="line-956"></span><span class="hs-comment">--       sums are intended to be used in performance-critical code, this is to</span><span>
</span><span id="line-957"></span><span class="hs-comment">--       We work-around this by declaring the absentSumFieldError as non-CAFfy,</span><span>
</span><span id="line-958"></span><span class="hs-comment">--       as described in Note [Wired-in exceptions are not CAFfy].</span><span>
</span><span id="line-959"></span><span class="hs-comment">--</span><span>
</span><span id="line-960"></span><span class="hs-comment">--       Getting this wrong causes hard-to-debug runtime issues, see #15038.</span><span>
</span><span id="line-961"></span><span class="hs-comment">--</span><span>
</span><span id="line-962"></span><span class="hs-comment">--    4. it can't be defined in `base` package.  Afterall, not all code which</span><span>
</span><span id="line-963"></span><span class="hs-comment">--       uses unboxed sums uses depends upon `base`.  Specifically, this became</span><span>
</span><span id="line-964"></span><span class="hs-comment">--       an issue when we wanted to use unboxed sums in boot libraries used by</span><span>
</span><span id="line-965"></span><span class="hs-comment">--       `base`, see #17791.</span><span>
</span><span id="line-966"></span><span class="hs-comment">--</span><span>
</span><span id="line-967"></span><span class="hs-comment">-- To fill this role we define `ghc-prim:GHC.Prim.Panic.absentSumFieldError`</span><span>
</span><span id="line-968"></span><span class="hs-comment">-- with the type:</span><span>
</span><span id="line-969"></span><span class="hs-comment">--</span><span>
</span><span id="line-970"></span><span class="hs-comment">--    absentSumFieldError :: forall a. a</span><span>
</span><span id="line-971"></span><span class="hs-comment">--</span><span>
</span><span id="line-972"></span><span class="hs-comment">-- Note that this type is something of a lie since Unarise may use it at an</span><span>
</span><span id="line-973"></span><span class="hs-comment">-- unlifted type. However, this lie is benign as absent sum fields are examined</span><span>
</span><span id="line-974"></span><span class="hs-comment">-- only by the GC, which does not care about levity..</span><span>
</span><span id="line-975"></span><span class="hs-comment">--</span><span>
</span><span id="line-976"></span><span class="hs-comment">-- When entered, this closure calls `stg_panic#`, which immediately halts</span><span>
</span><span id="line-977"></span><span class="hs-comment">-- execution and cannot be caught. This is in contrast to most other runtime</span><span>
</span><span id="line-978"></span><span class="hs-comment">-- errors, which are thrown as proper Haskell exceptions. This design is</span><span>
</span><span id="line-979"></span><span class="hs-comment">-- intentional since entering an absent sum field is an indication that</span><span>
</span><span id="line-980"></span><span class="hs-comment">-- something has gone horribly wrong, very likely due to a compiler bug.</span><span>
</span><span id="line-981"></span><span class="hs-comment">--</span><span>
</span><span id="line-982"></span><span>
</span><span id="line-983"></span><span class="hs-comment">-- Note [Wired-in exceptions are not CAFfy]</span><span>
</span><span id="line-984"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-985"></span><span class="hs-comment">-- GHC has logic wiring-in a small number of exceptions, which may be thrown in</span><span>
</span><span id="line-986"></span><span class="hs-comment">-- generated code. Specifically, these are implemented via closures (defined</span><span>
</span><span id="line-987"></span><span class="hs-comment">-- in `GHC.Prim.Exception` in `ghc-prim`) which, when entered, raise the desired</span><span>
</span><span id="line-988"></span><span class="hs-comment">-- exception. For instance, in the case of OverflowError we have</span><span>
</span><span id="line-989"></span><span class="hs-comment">--</span><span>
</span><span id="line-990"></span><span class="hs-comment">--     raiseOverflow :: forall a. a</span><span>
</span><span id="line-991"></span><span class="hs-comment">--     raiseOverflow = runRW# (\s -&gt;</span><span>
</span><span id="line-992"></span><span class="hs-comment">--         case raiseOverflow# s of</span><span>
</span><span id="line-993"></span><span class="hs-comment">--           (# _, _ #) -&gt; let x = x in x)</span><span>
</span><span id="line-994"></span><span class="hs-comment">--</span><span>
</span><span id="line-995"></span><span class="hs-comment">-- where `raiseOverflow#` is defined in the rts/Exception.cmm.</span><span>
</span><span id="line-996"></span><span class="hs-comment">--</span><span>
</span><span id="line-997"></span><span class="hs-comment">-- Note that `raiseOverflow` and friends, being top-level thunks, are CAFs.</span><span>
</span><span id="line-998"></span><span class="hs-comment">-- Normally, this would be reflected in their IdInfo; however, as these</span><span>
</span><span id="line-999"></span><span class="hs-comment">-- functions are widely used and CAFfyness is transitive, we very much want to</span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- avoid declaring them as CAFfy. This is especially true in especially in</span><span>
</span><span id="line-1001"></span><span class="hs-comment">-- performance-critical code like that using unboxed sums and</span><span>
</span><span id="line-1002"></span><span class="hs-comment">-- absentSumFieldError.</span><span>
</span><span id="line-1003"></span><span class="hs-comment">--</span><span>
</span><span id="line-1004"></span><span class="hs-comment">-- Consequently, `mkExceptionId` instead declares the exceptions to be</span><span>
</span><span id="line-1005"></span><span class="hs-comment">-- non-CAFfy and rather ensure in the RTS (in `initBuiltinGcRoots` in</span><span>
</span><span id="line-1006"></span><span class="hs-comment">-- rts/RtsStartup.c) that these closures remain reachable by creating a</span><span>
</span><span id="line-1007"></span><span class="hs-comment">-- StablePtr to each. Note that we are using the StablePtr mechanism not</span><span>
</span><span id="line-1008"></span><span class="hs-comment">-- because we need a StablePtr# object, but rather because the stable pointer</span><span>
</span><span id="line-1009"></span><span class="hs-comment">-- table is a source of GC roots.</span><span>
</span><span id="line-1010"></span><span class="hs-comment">--</span><span>
</span><span id="line-1011"></span><span class="hs-comment">-- At some point we could consider removing this optimisation as it is quite</span><span>
</span><span id="line-1012"></span><span class="hs-comment">-- fragile, but we do want to be careful to avoid adding undue cost. Unboxed</span><span>
</span><span id="line-1013"></span><span class="hs-comment">-- sums in particular are intended to be used in performance-critical contexts.</span><span>
</span><span id="line-1014"></span><span class="hs-comment">--</span><span>
</span><span id="line-1015"></span><span class="hs-comment">-- See #15038, #21141.</span><span>
</span><span id="line-1016"></span><span>
</span><span id="line-1017"></span><span id="absentSumFieldErrorName"><span class="annot"><span class="annottext">absentSumFieldErrorName :: Name
</span><a href="GHC.Core.Make.html#absentSumFieldErrorName"><span class="hs-identifier hs-var hs-var">absentSumFieldErrorName</span></a></span></span><span>
</span><span id="line-1018"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; FastString -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span>
</span><span id="line-1019"></span><span>      </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM_PANIC"><span class="hs-identifier hs-var">gHC_PRIM_PANIC</span></a></span><span>
</span><span id="line-1020"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;absentSumFieldError&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span><span>      </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#absentSumFieldErrorIdKey"><span class="hs-identifier hs-var">absentSumFieldErrorIdKey</span></a></span><span>
</span><span id="line-1022"></span><span>      </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_SUM_FIELD_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_SUM_FIELD_ERROR_ID</span></a></span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span id="aBSENT_SUM_FIELD_ERROR_ID"><span class="annot"><span class="annottext">aBSENT_SUM_FIELD_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#aBSENT_SUM_FIELD_ERROR_ID"><span class="hs-identifier hs-var hs-var">aBSENT_SUM_FIELD_ERROR_ID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkExceptionId"><span class="hs-identifier hs-var">mkExceptionId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#absentSumFieldErrorName"><span class="hs-identifier hs-var">absentSumFieldErrorName</span></a></span><span>
</span><span id="line-1025"></span><span>
</span><span id="line-1026"></span><span class="hs-comment">-- | Exception with type \&quot;forall a. a\&quot;</span><span>
</span><span id="line-1027"></span><span class="hs-comment">--</span><span>
</span><span id="line-1028"></span><span class="hs-comment">-- Any exceptions added via this function needs to be added to</span><span>
</span><span id="line-1029"></span><span class="hs-comment">-- the RTS's initBuiltinGcRoots() function.</span><span>
</span><span id="line-1030"></span><span class="annot"><a href="GHC.Core.Make.html#mkExceptionId"><span class="hs-identifier hs-type">mkExceptionId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1031"></span><span id="mkExceptionId"><span class="annot"><span class="annottext">mkExceptionId :: Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkExceptionId"><span class="hs-identifier hs-var hs-var">mkExceptionId</span></a></span></span><span> </span><span id="local-6989586621681673736"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681673736"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-1032"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkVanillaGlobalWithInfo"><span class="hs-identifier hs-var">mkVanillaGlobalWithInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681673736"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1033"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- forall a . a</span><span>
</span><span id="line-1034"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Demand] -&gt; IdInfo
</span><a href="GHC.Core.Make.html#divergingIdInfo"><span class="hs-identifier hs-var">divergingIdInfo</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; CafInfo -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setCafInfo"><span class="hs-operator hs-var">`setCafInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">CafInfo
</span><a href="GHC.Types.Id.Info.html#NoCafRefs"><span class="hs-identifier hs-var">NoCafRefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1035"></span><span>         </span><span class="hs-comment">-- See Note [Wired-in exceptions are not CAFfy]</span><span>
</span><span id="line-1036"></span><span>
</span><span id="line-1037"></span><span class="hs-comment">-- | An 'IdInfo' for an Id, such as 'aBSENT_ERROR_ID', that</span><span>
</span><span id="line-1038"></span><span class="hs-comment">-- throws an (imprecise) exception after being supplied one value arg for every</span><span>
</span><span id="line-1039"></span><span class="hs-comment">-- argument 'Demand' in the list. The demands end up in the demand signature.</span><span>
</span><span id="line-1040"></span><span class="hs-comment">--</span><span>
</span><span id="line-1041"></span><span class="hs-comment">-- 1. Sets the demand signature to unleash the given arg dmds 'botDiv'</span><span>
</span><span id="line-1042"></span><span class="hs-comment">-- 2. Sets the arity info so that it matches the length of arg demands</span><span>
</span><span id="line-1043"></span><span class="hs-comment">-- 3. Sets a bottoming CPR sig with the correct arity</span><span>
</span><span id="line-1044"></span><span class="hs-comment">--</span><span>
</span><span id="line-1045"></span><span class="hs-comment">-- It's important that all 3 agree on the arity, which is what this defn ensures.</span><span>
</span><span id="line-1046"></span><span class="annot"><a href="GHC.Core.Make.html#divergingIdInfo"><span class="hs-identifier hs-type">divergingIdInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Demand.html#Demand"><span class="hs-identifier hs-type">Demand</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a></span><span>
</span><span id="line-1047"></span><span id="divergingIdInfo"><span class="annot"><span class="annottext">divergingIdInfo :: [Demand] -&gt; IdInfo
</span><a href="GHC.Core.Make.html#divergingIdInfo"><span class="hs-identifier hs-var hs-var">divergingIdInfo</span></a></span></span><span> </span><span id="local-6989586621681673743"><span class="annot"><span class="annottext">[Demand]
</span><a href="#local-6989586621681673743"><span class="hs-identifier hs-var">arg_dmds</span></a></span></span><span>
</span><span id="line-1048"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdInfo
</span><a href="GHC.Types.Id.Info.html#vanillaIdInfo"><span class="hs-identifier hs-var">vanillaIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IdInfo -&gt; Int -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setArityInfo"><span class="hs-operator hs-var">`setArityInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673746"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-1049"></span><span>                  </span><span class="annot"><span class="annottext">IdInfo -&gt; DmdSig -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setDmdSigInfo"><span class="hs-operator hs-var">`setDmdSigInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">[Demand] -&gt; Divergence -&gt; DmdSig
</span><a href="GHC.Types.Demand.html#mkClosedDmdSig"><span class="hs-identifier hs-var">mkClosedDmdSig</span></a></span><span> </span><span class="annot"><span class="annottext">[Demand]
</span><a href="#local-6989586621681673743"><span class="hs-identifier hs-var">arg_dmds</span></a></span><span> </span><span class="annot"><span class="annottext">Divergence
</span><a href="GHC.Types.Demand.html#botDiv"><span class="hs-identifier hs-var">botDiv</span></a></span><span>
</span><span id="line-1050"></span><span>                  </span><span class="annot"><span class="annottext">IdInfo -&gt; CprSig -&gt; IdInfo
</span><a href="GHC.Types.Id.Info.html#setCprSigInfo"><span class="hs-operator hs-var">`setCprSigInfo`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Cpr -&gt; CprSig
</span><a href="GHC.Types.Cpr.html#mkCprSig"><span class="hs-identifier hs-var">mkCprSig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681673746"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Cpr
</span><a href="GHC.Types.Cpr.html#botCpr"><span class="hs-identifier hs-var">botCpr</span></a></span><span>
</span><span id="line-1051"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1052"></span><span>    </span><span id="local-6989586621681673746"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621681673746"><span class="hs-identifier hs-var hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Demand] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Demand]
</span><a href="#local-6989586621681673743"><span class="hs-identifier hs-var">arg_dmds</span></a></span><span>
</span><span id="line-1053"></span><span>
</span><span id="line-1054"></span><span class="hs-comment">{- Note [Error and friends have an &quot;open-tyvar&quot; forall]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
'error' and 'undefined' have types
        error     :: forall (v :: RuntimeRep) (a :: TYPE v). String -&gt; a
        undefined :: forall (v :: RuntimeRep) (a :: TYPE v). a
Notice the runtime-representation polymorphism. This ensures that
&quot;error&quot; can be instantiated at unboxed as well as boxed types.
This is OK because it never returns, so the return type is irrelevant.


************************************************************************
*                                                                      *
                     iMPOSSIBLE_ERROR_ID
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1070"></span><span>
</span><span id="line-1071"></span><span class="annot"><a href="GHC.Core.Make.html#iMPOSSIBLE_ERROR_ID"><span class="hs-identifier hs-type">iMPOSSIBLE_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#iMPOSSIBLE_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-type">iMPOSSIBLE_CONSTRAINT_ERROR_ID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1072"></span><span id="iMPOSSIBLE_ERROR_ID"><span class="annot"><span class="annottext">iMPOSSIBLE_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#iMPOSSIBLE_ERROR_ID"><span class="hs-identifier hs-var hs-var">iMPOSSIBLE_ERROR_ID</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span>       </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#impossibleErrorName"><span class="hs-identifier hs-var">impossibleErrorName</span></a></span><span>
</span><span id="line-1073"></span><span id="iMPOSSIBLE_CONSTRAINT_ERROR_ID"><span class="annot"><span class="annottext">iMPOSSIBLE_CONSTRAINT_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#iMPOSSIBLE_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-var hs-var">iMPOSSIBLE_CONSTRAINT_ERROR_ID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var">mkRuntimeErrorId</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#impossibleConstraintErrorName"><span class="hs-identifier hs-var">impossibleConstraintErrorName</span></a></span><span>
</span><span id="line-1074"></span><span>
</span><span id="line-1075"></span><span class="annot"><a href="GHC.Core.Make.html#impossibleErrorName"><span class="hs-identifier hs-type">impossibleErrorName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#impossibleConstraintErrorName"><span class="hs-identifier hs-type">impossibleConstraintErrorName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-1076"></span><span id="impossibleErrorName"><span class="annot"><span class="annottext">impossibleErrorName :: Name
</span><a href="GHC.Core.Make.html#impossibleErrorName"><span class="hs-identifier hs-var hs-var">impossibleErrorName</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossibleError&quot;</span></span><span>
</span><span id="line-1077"></span><span>                                </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#impossibleErrorIdKey"><span class="hs-identifier hs-var">impossibleErrorIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#iMPOSSIBLE_ERROR_ID"><span class="hs-identifier hs-var">iMPOSSIBLE_ERROR_ID</span></a></span><span>
</span><span id="line-1078"></span><span id="impossibleConstraintErrorName"><span class="annot"><span class="annottext">impossibleConstraintErrorName :: Name
</span><a href="GHC.Core.Make.html#impossibleConstraintErrorName"><span class="hs-identifier hs-var hs-var">impossibleConstraintErrorName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Core.Make.html#err_nm"><span class="hs-identifier hs-var">err_nm</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossibleConstraintError&quot;</span></span><span>
</span><span id="line-1079"></span><span>                                </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#impossibleConstraintErrorIdKey"><span class="hs-identifier hs-var">impossibleConstraintErrorIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#iMPOSSIBLE_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-var">iMPOSSIBLE_CONSTRAINT_ERROR_ID</span></a></span><span>
</span><span id="line-1080"></span><span>
</span><span id="line-1081"></span><span class="annot"><a href="GHC.Core.Make.html#mkImpossibleExpr"><span class="hs-identifier hs-type">mkImpossibleExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1082"></span><span id="mkImpossibleExpr"><span class="annot"><span class="annottext">mkImpossibleExpr :: Kind -&gt; String -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkImpossibleExpr"><span class="hs-identifier hs-var hs-var">mkImpossibleExpr</span></a></span></span><span> </span><span id="local-6989586621681673757"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673757"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span id="local-6989586621681673758"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673758"><span class="hs-identifier hs-var">str</span></a></span></span><span>
</span><span id="line-1083"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Kind -&gt; String -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkRuntimeErrorApp"><span class="hs-identifier hs-var">mkRuntimeErrorApp</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673759"><span class="hs-identifier hs-var">err_id</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673757"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673758"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1084"></span><span>  </span><span class="hs-keyword">where</span><span>    </span><span class="hs-comment">-- See Note [Type vs Constraint for error ids]</span><span>
</span><span id="line-1085"></span><span>    </span><span id="local-6989586621681673759"><span class="annot"><span class="annottext">err_id :: Id
</span><a href="#local-6989586621681673759"><span class="hs-identifier hs-var hs-var">err_id</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="GHC.Core.Type.html#isConstraintLikeKind"><span class="hs-identifier hs-var">isConstraintLikeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673757"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#iMPOSSIBLE_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-var">iMPOSSIBLE_CONSTRAINT_ERROR_ID</span></a></span><span>
</span><span id="line-1086"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#iMPOSSIBLE_ERROR_ID"><span class="hs-identifier hs-var">iMPOSSIBLE_ERROR_ID</span></a></span><span>
</span><span id="line-1087"></span><span>
</span><span id="line-1088"></span><span class="hs-comment">{- Note [Type vs Constraint for error ids]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We need both
  iMPOSSIBLE_ERROR_ID            :: forall (r::RuntimeRep) (a::TYPE r).       Addr# -&gt; a
  iMPOSSIBLE_CONSTRAINT_ERROR_ID :: forall (r::RuntimeRep) (a::CONSTRAINT r). Addr# -&gt; a

because we don't have polymorphism over TYPE vs CONSTRAINT.  You
might wonder if iMPOSSIBLE_CONSTRAINT_ERROR_ID is ever needed in
practice, but it is: see #22634.  So:

* In Control.Exception.Base we have
      impossibleError           :: forall (a::Type). Addr# -&gt; a
      impossibleConstraintError :: forall (a::Type). Addr# -&gt; a
  This generates the code for `impossibleError`, but because they are wired in
  the interface file definitions are never looked at (indeed, they don't
  even get serialised).

* In this module GHC.Core.Make we define /wired-in/ Ids for
      iMPOSSIBLE_ERROR_ID
      iMPOSSIBLE_CONSTRAINT_ERROR_ID
   with the desired above types (i.e. runtime-rep polymorphic, and returning a
   constraint for the latter.

Much the same plan works for aBSENT_ERROR_ID and aBSENT_CONSTRAINT_ERROR_ID


************************************************************************
*                                                                      *
                     aBSENT_ERROR_ID
*                                                                      *
************************************************************************

Note [aBSENT_ERROR_ID]
~~~~~~~~~~~~~~~~~~~~~~
We use aBSENT_ERROR_ID to build absent fillers for lifted types in workers. E.g.

   f x = (case x of (a,b) -&gt; b) + 1::Int

The demand analyser figures out that only the second component of x is
used, and does a w/w split thus

   f x = case x of (a,b) -&gt; $wf b

   $wf b = let a = absentError &quot;blah&quot;
               x = (a,b)
           in &lt;the original RHS of f&gt;

After some simplification, the (absentError &quot;blah&quot;) thunk normally goes away.
See also Note [Absent fillers] in GHC.Core.Opt.WorkWrap.Utils.

Historical Note
---------------
We used to have exprIsHNF respond True to absentError and *not* mark it as diverging.
Here's the reason for the former. It doesn't apply anymore because we no longer say
that `a` is absent (A). Instead it gets (head strict) demand 1A and we won't
emit the absent error:

#14285 had, roughly

   data T a = MkT a !a
   {-# INLINABLE f #-}
   f x = case x of MkT a b -&gt; g (MkT b a)

It turned out that g didn't use the second component, and hence f doesn't use
the first.  But the stable-unfolding for f looks like
   \x. case x of MkT a b -&gt; g ($WMkT b a)
where $WMkT is the wrapper for MkT that evaluates its arguments.  We
apply the same w/w split to this unfolding (see Note [Worker/wrapper
for INLINABLE functions] in GHC.Core.Opt.WorkWrap) so the template ends up like
   \b. let a = absentError &quot;blah&quot;
           x = MkT a b
        in case x of MkT a b -&gt; g ($WMkT b a)

After doing case-of-known-constructor, and expanding $WMkT we get
   \b -&gt; g (case absentError &quot;blah&quot; of a -&gt; MkT b a)

Yikes!  That bogusly appears to evaluate the absentError!

This is extremely tiresome.  Another way to think of this is that, in
Core, it is an invariant that a strict data constructor, like MkT, must
be applied only to an argument in HNF. So (absentError &quot;blah&quot;) had
better be non-bottom.

So the &quot;solution&quot; is to add a special case for absentError to exprIsHNFlike.
This allows Simplify.rebuildCase, in the Note [Case to let transformation]
branch, to convert the case on absentError into a let. We also make
absentError *not* be diverging, unlike the other error-ids, so that we
can be sure not to remove the case branches before converting the case to
a let.

If, by some bug or bizarre happenstance, we ever call absentError, we should
throw an exception.  This should never happen, of course, but we definitely
can't return anything.  e.g. if somehow we had
    case absentError &quot;foo&quot; of
       Nothing -&gt; ...
       Just x  -&gt; ...
then if we return, the case expression will select a field and continue.
Seg fault city. Better to throw an exception. (Even though we've said
it is in HNF :-)

It might seem a bit surprising that seq on absentError is simply erased

    absentError &quot;foo&quot; `seq` x ==&gt; x

but that should be okay; since there's no pattern match we can't really
be relying on anything from it.
-}</span><span>
</span><span id="line-1195"></span><span>
</span><span id="line-1196"></span><span class="hs-comment">-- We need two absentError Ids:</span><span>
</span><span id="line-1197"></span><span class="hs-comment">--   absentError           :: forall (a :: Type).       Addr# -&gt; a</span><span>
</span><span id="line-1198"></span><span class="hs-comment">--   absentConstraintError :: forall (a :: Constraint). Addr# -&gt; a</span><span>
</span><span id="line-1199"></span><span class="hs-comment">-- We don't have polymorphism over TypeOrConstraint!</span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- mkAbsentErrorApp chooses which one to use, based on the kind</span><span>
</span><span id="line-1201"></span><span class="hs-comment">-- See Note [Type vs Constraint for error ids]</span><span>
</span><span id="line-1202"></span><span>
</span><span id="line-1203"></span><span class="annot"><a href="GHC.Core.Make.html#mkAbsentErrorApp"><span class="hs-identifier hs-type">mkAbsentErrorApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>         </span><span class="hs-comment">-- The type to instantiate 'a'</span><span>
</span><span id="line-1204"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>       </span><span class="hs-comment">-- The string to print</span><span>
</span><span id="line-1205"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1206"></span><span>
</span><span id="line-1207"></span><span id="mkAbsentErrorApp"><span class="annot"><span class="annottext">mkAbsentErrorApp :: Kind -&gt; String -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkAbsentErrorApp"><span class="hs-identifier hs-var hs-var">mkAbsentErrorApp</span></a></span></span><span> </span><span id="local-6989586621681673761"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673761"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span id="local-6989586621681673762"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673762"><span class="hs-identifier hs-var">err_msg</span></a></span></span><span>
</span><span id="line-1208"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr
forall b. Expr b -&gt; [Expr b] -&gt; Expr b
</span><a href="GHC.Core.html#mkApps"><span class="hs-identifier hs-var">mkApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673763"><span class="hs-identifier hs-var">err_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CoreExpr
forall b. Kind -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673761"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621681673764"><span class="hs-identifier hs-var">err_string</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1209"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1210"></span><span>    </span><span id="local-6989586621681673763"><span class="annot"><span class="annottext">err_id :: Id
</span><a href="#local-6989586621681673763"><span class="hs-identifier hs-var hs-var">err_id</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="GHC.Core.Type.html#isConstraintLikeKind"><span class="hs-identifier hs-var">isConstraintLikeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind
Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673761"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_CONSTRAINT_ERROR_ID</span></a></span><span>
</span><span id="line-1211"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_ERROR_ID</span></a></span><span>
</span><span id="line-1212"></span><span>    </span><span id="local-6989586621681673764"><span class="annot"><span class="annottext">err_string :: CoreExpr
</span><a href="#local-6989586621681673764"><span class="hs-identifier hs-var hs-var">err_string</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitString"><span class="hs-identifier hs-var">mkLitString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681673762"><span class="hs-identifier hs-var">err_msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1213"></span><span>
</span><span id="line-1214"></span><span class="annot"><a href="GHC.Core.Make.html#absentErrorName"><span class="hs-identifier hs-type">absentErrorName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#absentConstraintErrorName"><span class="hs-identifier hs-type">absentConstraintErrorName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-1215"></span><span id="absentErrorName"><span class="annot"><span class="annottext">absentErrorName :: Name
</span><a href="GHC.Core.Make.html#absentErrorName"><span class="hs-identifier hs-var hs-var">absentErrorName</span></a></span></span><span>
</span><span id="line-1216"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; FastString -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM_PANIC"><span class="hs-identifier hs-var">gHC_PRIM_PANIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;absentError&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1217"></span><span>      </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#absentErrorIdKey"><span class="hs-identifier hs-var">absentErrorIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_ERROR_ID</span></a></span><span>
</span><span id="line-1218"></span><span>
</span><span id="line-1219"></span><span id="absentConstraintErrorName"><span class="annot"><span class="annottext">absentConstraintErrorName :: Name
</span><a href="GHC.Core.Make.html#absentConstraintErrorName"><span class="hs-identifier hs-var hs-var">absentConstraintErrorName</span></a></span></span><span>   </span><span class="hs-comment">-- See Note [Type vs Constraint for error ids]</span><span>
</span><span id="line-1220"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; FastString -&gt; Unique -&gt; Id -&gt; Name
</span><a href="GHC.Builtin.Types.html#mkWiredInIdName"><span class="hs-identifier hs-var">mkWiredInIdName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#gHC_PRIM_PANIC"><span class="hs-identifier hs-var">gHC_PRIM_PANIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;absentConstraintError&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>      </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#absentConstraintErrorIdKey"><span class="hs-identifier hs-var">absentConstraintErrorIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_CONSTRAINT_ERROR_ID</span></a></span><span>
</span><span id="line-1222"></span><span>
</span><span id="line-1223"></span><span class="annot"><a href="GHC.Core.Make.html#aBSENT_ERROR_ID"><span class="hs-identifier hs-type">aBSENT_ERROR_ID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#aBSENT_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-type">aBSENT_CONSTRAINT_ERROR_ID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1224"></span><span>
</span><span id="line-1225"></span><span id="aBSENT_ERROR_ID"><span class="annot"><span class="annottext">aBSENT_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#aBSENT_ERROR_ID"><span class="hs-identifier hs-var hs-var">aBSENT_ERROR_ID</span></a></span></span><span> </span><span class="hs-comment">-- See Note [aBSENT_ERROR_ID]</span><span>
</span><span id="line-1226"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mk_runtime_error_id"><span class="hs-identifier hs-var">mk_runtime_error_id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#absentErrorName"><span class="hs-identifier hs-var">absentErrorName</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673770"><span class="hs-identifier hs-var">absent_ty</span></a></span><span>
</span><span id="line-1227"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1228"></span><span>   </span><span class="hs-comment">-- absentError :: forall (a :: Type). Addr# -&gt; a</span><span>
</span><span id="line-1229"></span><span>   </span><span id="local-6989586621681673770"><span class="annot"><span class="annottext">absent_ty :: Kind
</span><a href="#local-6989586621681673770"><span class="hs-identifier hs-var hs-var">absent_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1230"></span><span>               </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind -&gt; Kind
Kind -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier hs-var">mkVisFunTyMany</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaTyVar"><span class="hs-identifier hs-var">alphaTyVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1231"></span><span>   </span><span class="hs-comment">-- Not runtime-rep polymorphic. aBSENT_ERROR_ID is only used for</span><span>
</span><span id="line-1232"></span><span>   </span><span class="hs-comment">-- lifted-type things; see Note [Absent fillers] in GHC.Core.Opt.WorkWrap.Utils</span><span>
</span><span id="line-1233"></span><span>
</span><span id="line-1234"></span><span id="aBSENT_CONSTRAINT_ERROR_ID"><span class="annot"><span class="annottext">aBSENT_CONSTRAINT_ERROR_ID :: Id
</span><a href="GHC.Core.Make.html#aBSENT_CONSTRAINT_ERROR_ID"><span class="hs-identifier hs-var hs-var">aBSENT_CONSTRAINT_ERROR_ID</span></a></span></span><span> </span><span class="hs-comment">-- See Note [aBSENT_ERROR_ID]</span><span>
</span><span id="line-1235"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mk_runtime_error_id"><span class="hs-identifier hs-var">mk_runtime_error_id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Core.Make.html#absentConstraintErrorName"><span class="hs-identifier hs-var">absentConstraintErrorName</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673774"><span class="hs-identifier hs-var">absent_ty</span></a></span><span>
</span><span id="line-1236"></span><span>   </span><span class="hs-comment">-- See Note [Type vs Constraint for error ids]</span><span>
</span><span id="line-1237"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1238"></span><span>   </span><span class="hs-comment">-- absentConstraintError :: forall (a :: Constraint). Addr# -&gt; a</span><span>
</span><span id="line-1239"></span><span>   </span><span id="local-6989586621681673774"><span class="annot"><span class="annottext">absent_ty :: Kind
</span><a href="#local-6989586621681673774"><span class="hs-identifier hs-var hs-var">absent_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaConstraintTyVar"><span class="hs-identifier hs-var">alphaConstraintTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1240"></span><span>               </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; FunTyFlag -&gt; Kind -&gt; Kind -&gt; Kind -&gt; Kind
FunTyFlag -&gt; Kind -&gt; Kind -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="GHC.Types.Var.html#visArgConstraintLike"><span class="hs-identifier hs-var">visArgConstraintLike</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span>
</span><span id="line-1241"></span><span>                       </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#alphaConstraintTyVar"><span class="hs-identifier hs-var">alphaConstraintTyVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span>
</span><span id="line-1243"></span><span>
</span><span id="line-1244"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                     mkRuntimeErrorId
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1251"></span><span>
</span><span id="line-1252"></span><span class="annot"><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-type">mkRuntimeErrorId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TypeOrConstraint"><span class="hs-identifier hs-type">TypeOrConstraint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1253"></span><span class="hs-comment">-- Error function</span><span>
</span><span id="line-1254"></span><span class="hs-comment">--   with type:  forall (r:RuntimeRep) (a:TYPE r). Addr# -&gt; a</span><span>
</span><span id="line-1255"></span><span class="hs-comment">--   with arity: 1</span><span>
</span><span id="line-1256"></span><span class="hs-comment">-- which diverges after being given one argument</span><span>
</span><span id="line-1257"></span><span class="hs-comment">-- The Addr# is expected to be the address of</span><span>
</span><span id="line-1258"></span><span class="hs-comment">--   a UTF8-encoded error string</span><span>
</span><span id="line-1259"></span><span id="mkRuntimeErrorId"><span class="annot"><span class="annottext">mkRuntimeErrorId :: TypeOrConstraint -&gt; Name -&gt; Id
</span><a href="GHC.Core.Make.html#mkRuntimeErrorId"><span class="hs-identifier hs-var hs-var">mkRuntimeErrorId</span></a></span></span><span> </span><span id="local-6989586621681673778"><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621681673778"><span class="hs-identifier hs-var">torc</span></a></span></span><span> </span><span id="local-6989586621681673779"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681673779"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mk_runtime_error_id"><span class="hs-identifier hs-var">mk_runtime_error_id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681673779"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Kind
</span><a href="GHC.Core.Make.html#mkRuntimeErrorTy"><span class="hs-identifier hs-var">mkRuntimeErrorTy</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621681673778"><span class="hs-identifier hs-var">torc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1260"></span><span>
</span><span id="line-1261"></span><span>
</span><span id="line-1262"></span><span class="annot"><a href="GHC.Core.Make.html#mk_runtime_error_id"><span class="hs-identifier hs-type">mk_runtime_error_id</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1263"></span><span id="mk_runtime_error_id"><span class="annot"><span class="annottext">mk_runtime_error_id :: Name -&gt; Kind -&gt; Id
</span><a href="GHC.Core.Make.html#mk_runtime_error_id"><span class="hs-identifier hs-var hs-var">mk_runtime_error_id</span></a></span></span><span> </span><span id="local-6989586621681673781"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681673781"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681673782"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673782"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1264"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; IdInfo -&gt; Id
</span><a href="GHC.Types.Id.html#mkVanillaGlobalWithInfo"><span class="hs-identifier hs-var">mkVanillaGlobalWithInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681673781"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673782"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Demand] -&gt; IdInfo
</span><a href="GHC.Core.Make.html#divergingIdInfo"><span class="hs-identifier hs-var">divergingIdInfo</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Demand
</span><a href="GHC.Types.Demand.html#evalDmd"><span class="hs-identifier hs-var">evalDmd</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1265"></span><span>     </span><span class="hs-comment">-- Do *not* mark them as NoCafRefs, because they can indeed have</span><span>
</span><span id="line-1266"></span><span>     </span><span class="hs-comment">-- CAF refs.  For example, pAT_ERROR_ID calls GHC.Err.untangle,</span><span>
</span><span id="line-1267"></span><span>     </span><span class="hs-comment">-- which has some CAFs</span><span>
</span><span id="line-1268"></span><span>     </span><span class="hs-comment">-- In due course we may arrange that these error-y things are</span><span>
</span><span id="line-1269"></span><span>     </span><span class="hs-comment">-- regarded by the GC as permanently live, in which case we</span><span>
</span><span id="line-1270"></span><span>     </span><span class="hs-comment">-- can give them NoCaf info.  As it is, any function that calls</span><span>
</span><span id="line-1271"></span><span>     </span><span class="hs-comment">-- any pc_bottoming_Id will itself have CafRefs, which bloats</span><span>
</span><span id="line-1272"></span><span>     </span><span class="hs-comment">-- SRTs.</span><span>
</span><span id="line-1273"></span><span>
</span><span id="line-1274"></span><span class="annot"><a href="GHC.Core.Make.html#mkRuntimeErrorTy"><span class="hs-identifier hs-type">mkRuntimeErrorTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TypeOrConstraint"><span class="hs-identifier hs-type">TypeOrConstraint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1275"></span><span class="hs-comment">-- forall (rr :: RuntimeRep) (a :: rr). Addr# -&gt; a</span><span>
</span><span id="line-1276"></span><span class="hs-comment">--   See Note [Error and friends have an &quot;open-tyvar&quot; forall]</span><span>
</span><span id="line-1277"></span><span id="mkRuntimeErrorTy"><span class="annot"><span class="annottext">mkRuntimeErrorTy :: TypeOrConstraint -&gt; Kind
</span><a href="GHC.Core.Make.html#mkRuntimeErrorTy"><span class="hs-identifier hs-var hs-var">mkRuntimeErrorTy</span></a></span></span><span> </span><span id="local-6989586621681673784"><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621681673784"><span class="hs-identifier hs-var">torc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1TyVar"><span class="hs-identifier hs-var">runtimeRep1TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673786"><span class="hs-identifier hs-var">tyvar</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1278"></span><span>                        </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Kind -&gt; Kind -&gt; Kind -&gt; Kind
Kind -&gt; Kind -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#mkFunctionType"><span class="hs-identifier hs-var">mkFunctionType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673786"><span class="hs-identifier hs-var">tyvar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1279"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1280"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681673786"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681673786"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Id]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind] -&gt; [Id]
</span><a href="GHC.Builtin.Types.Prim.html#mkTemplateTyVars"><span class="hs-identifier hs-var">mkTemplateTyVars</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681673789"><span class="hs-identifier hs-var">kind</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1281"></span><span>    </span><span id="local-6989586621681673789"><span class="annot"><span class="annottext">kind :: Kind
</span><a href="#local-6989586621681673789"><span class="hs-identifier hs-var hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621681673784"><span class="hs-identifier hs-var">torc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1282"></span><span>              </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#mkTYPEapp"><span class="hs-identifier hs-var">mkTYPEapp</span></a></span><span>       </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1Ty"><span class="hs-identifier hs-var">runtimeRep1Ty</span></a></span><span>
</span><span id="line-1283"></span><span>              </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="GHC.Core.Type.html#mkCONSTRAINTapp"><span class="hs-identifier hs-var">mkCONSTRAINTapp</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Builtin.Types.Prim.html#runtimeRep1Ty"><span class="hs-identifier hs-var">runtimeRep1Ty</span></a></span><span>
</span><span id="line-1284"></span><span>
</span><span id="line-1285"></span></pre></body></html>