<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TupleSections    #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">{-
(c) The GRASP/AQUA Project, Glasgow University, 1992-2012

Note [Unarisation]
~~~~~~~~~~~~~~~~~~
The idea of this pass is to translate away *all* unboxed-tuple and unboxed-sum
binders. So for example:

  f (x :: (# Int, Bool #)) = f x + f (# 1, True #)

  ==&gt;

  f (x1 :: Int) (x2 :: Bool) = f x1 x2 + f 1 True

It is important that we do this at the STG level and NOT at the Core level
because it would be very hard to make this pass Core-type-preserving. In this
example the type of 'f' changes, for example.

STG fed to the code generators *must* be unarised because the code generators do
not support unboxed tuple and unboxed sum binders natively.

In more detail: (see next note for unboxed sums)

Suppose that a variable x : (# t1, t2 #).

  * At the binding site for x, make up fresh vars  x1:t1, x2:t2

  * Extend the UnariseEnv   x :-&gt; MultiVal [x1,x2]

  * Replace the binding with a curried binding for x1,x2

       Lambda:   \x.e                ==&gt;   \x1 x2. e
       Case alt: MkT a b x c d -&gt; e  ==&gt;   MkT a b x1 x2 c d -&gt; e

  * Replace argument occurrences with a sequence of args via a lookup in
    UnariseEnv

       f a b x c d   ==&gt;   f a b x1 x2 c d

  * Replace tail-call occurrences with an unboxed tuple via a lookup in
    UnariseEnv

       x  ==&gt;  (# x1, x2 #)

    So, for example

       f x = x    ==&gt;   f x1 x2 = (# x1, x2 #)

  * We /always/ eliminate a case expression when

       - It scrutinises an unboxed tuple or unboxed sum

       - The scrutinee is a variable (or when it is an explicit tuple, but the
         simplifier eliminates those)

    The case alternative (there can be only one) can be one of these two
    things:

      - An unboxed tuple pattern. e.g.

          case v of x { (# x1, x2, x3 #) -&gt; ... }

        Scrutinee has to be in form `(# t1, t2, t3 #)` so we just extend the
        environment with

          x :-&gt; MultiVal [t1,t2,t3]
          x1 :-&gt; UnaryVal t1, x2 :-&gt; UnaryVal t2, x3 :-&gt; UnaryVal t3

      - A DEFAULT alternative. Just the same, without the bindings for x1,x2,x3

By the end of this pass, we only have unboxed tuples in return positions.
Unboxed sums are completely eliminated, see next note.

Note [Translating unboxed sums to unboxed tuples]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Unarise also eliminates unboxed sum binders, and translates unboxed sums in
return positions to unboxed tuples. We want to overlap fields of a sum when
translating it to a tuple to have efficient memory layout. When translating a
sum pattern to a tuple pattern, we need to translate it so that binders of sum
alternatives will be mapped to right arguments after the term translation. So
translation of sum DataCon applications to tuple DataCon applications and
translation of sum patterns to tuple patterns need to be in sync.

These translations work like this. Suppose we have

  (# x1 | | ... #) :: (# t1 | t2 | ... #)

remember that t1, t2 ... can be sums and tuples too. So we first generate
layouts of those. Then we &quot;merge&quot; layouts of each alternative, which gives us a
sum layout with best overlapping possible.

Layout of a flat type 'ty1' is just [ty1].
Layout of a tuple is just concatenation of layouts of its fields.

For layout of a sum type,

  - We first get layouts of all alternatives.
  - We sort these layouts based on their &quot;slot types&quot;.
  - We merge all the alternatives.

For example, say we have (# (# Int#, Char #) | (# Int#, Int# #) | Int# #)

  - Layouts of alternatives: [ [Word, LiftedPtr], [Word, Word], [Word] ]
  - Sorted: [ [LiftedPtr, Word], [Word, Word], [Word] ]
  - Merge all alternatives together: [ LiftedPtr, Word, Word ]

We add a slot for the tag to the first position. So our tuple type is

  (# Tag#, Any, Word#, Word# #)
  (we use Any for pointer slots)

Now, any term of this sum type needs to generate a tuple of this type instead.
The translation works by simply putting arguments to first slots that they fit
in. Suppose we had

  (# (# 42#, 'c' #) | | #)

42# fits in Word#, 'c' fits in Any, so we generate this application:

  (# 1#, 'c', 42#, rubbish #)

Another example using the same type: (# | (# 2#, 3# #) | #). 2# fits in Word#,
3# fits in Word #, so we get:

  (# 2#, rubbish, 2#, 3# #).


Note [Don't merge lifted and unlifted slots]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When merging slots, one might be tempted to collapse lifted and unlifted
pointers. However, as seen in #19645, this is wrong. Imagine that you have
the program:

  test :: (# Char | ByteArray# #) -&gt; ByteArray#
  test (# c | #) = doSomething c
  test (# | ba #) = ba

Collapsing the Char and ByteArray# slots would produce STG like:

  test :: forall {t}. (# t | GHC.Prim.ByteArray# #) -&gt; GHC.Prim.ByteArray#
    = {} \r [ (tag :: Int#) (slot0 :: (Any :: Type)) ]
          case tag of tag'
            1# -&gt; doSomething slot0
            2# -&gt; slot0;

Note how `slot0` has a lifted type, despite being bound to an unlifted
ByteArray# in the 2# alternative. This liftedness would cause the code generator to
attempt to enter it upon returning. As unlifted objects do not have entry code,
this causes a runtime crash.

For this reason, Unarise treats unlifted and lifted things as distinct slot
types, despite both being GC pointers. This approach is a slight pessimisation
(since we need to pass more arguments) but appears to be the simplest way to
avoid #19645. Other alternatives considered include:

 a. Giving unlifted objects &quot;trivial&quot; entry code. However, we ultimately
    concluded that the value of the &quot;unlifted things are never entered&quot; invariant
    outweighed the simplicity of this approach.

 b. Annotating occurrences with calling convention information instead of
    relying on the binder's type. This seemed like a very complicated
    way to fix what is ultimately a corner-case.


Note [Types in StgConApp]
~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we have this unboxed sum term:

  (# 123 | #)

What will be the unboxed tuple representation? We can't tell without knowing the
type of this term. For example, these are all valid tuples for this:

  (# 1#, 123 #)          -- when type is (# Int | String #)
  (# 1#, 123, rubbish #) -- when type is (# Int | Float# #)
  (# 1#, 123, rubbish, rubbish #)
                         -- when type is (# Int | (# Int, Int, Int #) #)

So we pass type arguments of the DataCon's TyCon in StgConApp to decide what
layout to use. Note that unlifted values can't be let-bound, so we don't need
types in StgRhsCon.

Note [Casting slot arguments]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider this function which selects between Int32# and Int64# from a unboxed sum.

    foo ::  (# Int32# | Int64#  #) -&gt; FD
    foo x = case x of
        (# x1 | #) -&gt; F x1
        (# | x2 #) -&gt; D x2

Naturally we would expect x1 to have a PrimRep of Int32Rep and x2 of DoubleRep.
However we used to generate this (bogus) code after Unarise giving rise to #22208:

    M.foo :: (# GHC.Prim.Int32# | GHC.Prim.Int64# #) -&gt; M.FD
    [GblId, Arity=1, Unf=OtherCon []] =
        {} \r [sum_tag sum_field]
            case sum_tag of tag_gsc {
              __DEFAULT -&gt; M.F [sum_field];
              2# -&gt; M.D [sum_field];
            };

Where sum_field is used both as Int32# and Int64# depending on the branch
because they share the same SlotTy.
This usually works out since we put all int's in the same sort of register.
So even if the reps where wrong (x :: bits32) = (y :: bits64) would produce
correct code in the most cases.
However there are cases where this goes wrong, causing lint errors,in the case of #22208
compiler panics or in some cases incorrect results in the C backend.
For now our solution is to construct proper casts between the PrimRep of the slot and
the variables we want to store in, or read out of these slots.

This means when we have a sum (# Int32# | Int64# #) if we want to store a Int32
we convert it to a Int64 on construction of the tuple value, and convert it back
to a Int32 once when want to use the field. On most backends these coversions should
be no-ops at runtime so this seems reasonable.

Conversion for values coming out of a strict field happen in mapSumIdBinders. While
conversion during the construction of sums happen inside mkUbxSum.

------------- A full example of casting during sum construction ----------------

To compile a constructor application of a unboxed sum of type (# Int32# | Int64# )
in an expression like  `let sum = (# x | #)` we will call mkUbxSum to determine
which binders we have to replace sum with at use sites during unarise.
See also Note [Translating unboxed sums to unboxed tuples].

Int32# and Int64# in this case will share the same slot in the unboxed sum. This means
the sum after unarise will be represented by two binders. One for the tag and one for
the field. The later having Int64Rep.
However our input for the field is of Int32Rep. So in order to soundly construct
`(# x | #) :: (# Int32# | Int64# )` we must upcast `x` to Int64#.
To do this mkUbxSum will produce an expression with a hole for constructor application
to go into. That is the call to mkUbxSum and it's result will look something like:

  &gt;&gt;&gt; mkUbxSum (#|#) [Int32#, Int64#] (x::Int32#) us (x')
  ([1#::Int#, x'::Int64#], \rhs -&gt; case int32ToInt# x of x' -&gt; rhs )

We will use the returned arguments to construct an application to an unboxed tuple:

  &gt;&gt;&gt; mkTuple [tag::Int#, x'::Int64#]
  (# tag, x' #)

Which we will then use as the rhs to pass into the casting wrapper to
construct an expression that casts `x` to the right type before constructing the
tuple

  &gt;&gt;&gt; (\rhs -&gt; case int32ToInt# x of x' -&gt; rhs ) (# tag, x' #)
  case int32ToInt# x of x' -&gt; (# #) 1# x'

Which results in the this definition for `sum` after all is said and done:

  let sum = case int32ToInt# x of { x' -&gt; (# #) 1# x' }

Not that the renaming is not optional. Cmm requires binders of different uniques
to have at least different types. See Note [CorePrep Overview]: 6. Clone all local Ids

------------- A full example of casting during sum matching --------------------

When matching on an unboxed sum constructor we start out with
something like this the pre-unarise:

    f :: (# Int32 | Int64# ) -&gt; ...
    f sum = case sum of
        (# x |#) -&gt; alt_rhs
        ...

We unarise the function arguments and get:

    f sum_tag sum_slot1 = case sum_tag of
        1# -&gt; ???

Now we need to match up the original alternative binders with the sum slots passed
to the function. This is done by mapSumIdBinders which we we call for our
example alternative like this:

    &gt;&gt;&gt; mapSumIdBinders [x] [sum_slot1] alt_rhs env
    (env', alt_rhs')

mapSumIdBinders first matches up the list of binders with the slots passed to
the function which is trivial in this case. Then we check if the slot and the
variable residing inside it agree on their Rep. If alternative binders and
the function arguments agree in their slot reps we we just extend the environment
with a mapping from `x` to `sum_slot1` and we return the rhs as is.

If the reps of the sum_slots do not agree with alternative binders they represent
then we need to wrap the whole RHS in nested cases which cast the sum_slot&lt;n&gt;
variables to the correct rep. Here `x` is of Int32Rep while `sum_slot1` will be
of Int64Rep. This means instead of retuning the original alt_rhs we will return:

  &gt;&gt;&gt; mapSumIdBinders [x] [sum_slot1] alt_rhs env
  ( env'[x=x']
  , case int64ToInt32# (sum_slot1 :: Int64#) of
      (x' :: Int32#) -&gt; alt_rhs
  )

We then run unarise on alt_rhs within that expression, which will replace the first occurence
of `x` with sum_slot_arg_1 giving us post-unarise:

    f sum_tag sum_slot1 =
      case sum_tag of
        1# -&gt; case int64ToInt32# sum_slot1 of
          x' -&gt; ... x' ...
        ...

Note [UnariseEnv]
~~~~~~~~~~~~~~~~~~
At any variable occurrence 'v',
* If the UnariseEnv has a binding for 'v', the binding says what 'v' is bound to
* If not, 'v' stands just for itself.

Most variables are unaffected by unarisation, and (for efficiency) we don't put
them in the UnariseEnv at all.  But NB: when we go under a binding for 'v' we must
remember to delete 'v' from the UnariseEnv, lest occurrences of 'v' see the outer
binding for the variable (#21396).


Note [UnariseEnv can map to literals]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
To avoid redundant case expressions when unarising unboxed sums, UnariseEnv
needs to map variables to literals too. Suppose we have this Core:

  f (# x | #)

  ==&gt; (CorePrep)

  case (# x | #) of y {
    _ -&gt; f y
  }

  ==&gt; (MultiVal)

  case (# 1#, x #) of [x1, x2] {
    _ -&gt; f x1 x2
  }

To eliminate this case expression we need to map x1 to 1# in UnariseEnv:

  x1 :-&gt; UnaryVal 1#, x2 :-&gt; UnaryVal x

so that `f x1 x2` becomes `f 1# x`.

Note [Unarisation and arity]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Because of unarisation, the arity that will be recorded in the generated info
table for an Id may be larger than the idArity. Instead we record what we call
the RepArity, which is the Arity taking into account any expanded arguments, and
corresponds to the number of (possibly-void) *registers* arguments will arrive
in.

Note [Post-unarisation invariants]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
STG programs after unarisation have these invariants:

 1. No unboxed sums at all.

 2. No unboxed tuple binders. Tuples only appear in return position.

 3. Binders and literals always have zero (for void arguments) or one PrimRep.

 4. DataCon applications (StgRhsCon and StgConApp) don't have void arguments.
    This means that it's safe to wrap `StgArg`s of DataCon applications with
    `GHC.StgToCmm.Env.NonVoid`, for example.

 5. Alt binders (binders in patterns) are always non-void.
-}</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Stg.Unarise</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#unarise"><span class="hs-identifier">unarise</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-377"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span>
</span><span id="line-378"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-379"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-380"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier">FastString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier">mkFastString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier">fsLit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-382"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-383"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Make.html"><span class="hs-identifier">GHC.Core.Make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#aBSENT_SUM_FIELD_ERROR_ID"><span class="hs-identifier">aBSENT_SUM_FIELD_ERROR_ID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html"><span class="hs-identifier">GHC.Types.Id.Make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Make.html#voidPrimId"><span class="hs-identifier">voidPrimId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#voidArgId"><span class="hs-identifier">voidArgId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html"><span class="hs-identifier">GHC.Utils.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Monad.html#mapAccumLM"><span class="hs-identifier">mapAccumLM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-387"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-388"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html"><span class="hs-identifier">GHC.Utils.Panic.Plain</span></a></span><span>
</span><span id="line-389"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html"><span class="hs-identifier">GHC.Types.RepType</span></a></span><span>
</span><span id="line-390"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html"><span class="hs-identifier">GHC.Stg.Syntax</span></a></span><span>
</span><span id="line-391"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Stg.Utils.html"><span class="hs-identifier">GHC.Stg.Utils</span></a></span><span>
</span><span id="line-392"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-393"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.Types.Prim.html#intPrimTy"><span class="hs-identifier">intPrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-395"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html"><span class="hs-identifier">GHC.Types.Unique.Supply</span></a></span><span>
</span><span id="line-396"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span>
</span><span id="line-397"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-398"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Bifunctor.html#/Data.Bifunctor.html"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Bifunctor.html#second/Data.Bifunctor.html#second"><span class="hs-identifier">second</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.List.NonEmpty.html#/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#NonEmpty/GHC.Base.html#NonEmpty"><span class="hs-identifier">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Maybe.html#/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Maybe.html#mapMaybe/Data.Maybe.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.6.7/src/Data.IntMap.html#/Data.IntMap.html"><span class="hs-identifier">Data.IntMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-404"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html"><span class="hs-identifier">GHC.Builtin.PrimOps</span></a></span><span>
</span><span id="line-405"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.Casts.html"><span class="hs-identifier">GHC.Builtin.PrimOps.Casts</span></a></span><span>
</span><span id="line-406"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.List.html#/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapAccumL/Data.Traversable.html#mapAccumL"><span class="hs-identifier">mapAccumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- import GHC.Utils.Trace</span><span>
</span><span id="line-409"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- | A mapping from binders to the Ids they were expanded/renamed to.</span><span>
</span><span id="line-412"></span><span class="hs-comment">--</span><span>
</span><span id="line-413"></span><span class="hs-comment">--   x :-&gt; MultiVal [a,b,c] in rho</span><span>
</span><span id="line-414"></span><span class="hs-comment">--</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- iff  x's typePrimRep is not a singleton, or equivalently</span><span>
</span><span id="line-416"></span><span class="hs-comment">--      x's type is an unboxed tuple, sum or void.</span><span>
</span><span id="line-417"></span><span class="hs-comment">--</span><span>
</span><span id="line-418"></span><span class="hs-comment">--    x :-&gt; UnaryVal x'</span><span>
</span><span id="line-419"></span><span class="hs-comment">--</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- iff x's RepType is UnaryRep or equivalently</span><span>
</span><span id="line-421"></span><span class="hs-comment">--     x's type is not unboxed tuple, sum or void.</span><span>
</span><span id="line-422"></span><span class="hs-comment">--</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- So</span><span>
</span><span id="line-424"></span><span class="hs-comment">--     x :-&gt; MultiVal [a] in rho</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- means x is represented by singleton tuple.</span><span>
</span><span id="line-426"></span><span class="hs-comment">--</span><span>
</span><span id="line-427"></span><span class="hs-comment">--     x :-&gt; MultiVal [] in rho</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- means x is void.</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- INVARIANT: OutStgArgs in the range only have NvUnaryTypes</span><span>
</span><span id="line-431"></span><span class="hs-comment">--            (i.e. no unboxed tuples, sums or voids)</span><span>
</span><span id="line-432"></span><span class="hs-comment">--</span><span>
</span><span id="line-433"></span><span class="hs-keyword">newtype</span><span> </span><span id="UnariseEnv"><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-var">UnariseEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UnariseEnv"><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-var">UnariseEnv</span></a></span></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ue_rho"><span class="annot"><span class="annottext">UnariseEnv -&gt; VarEnv UnariseVal
</span><a href="GHC.Stg.Unarise.html#ue_rho"><span class="hs-identifier hs-var hs-var">ue_rho</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseVal"><span class="hs-identifier hs-type">UnariseVal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="annot"><a href="GHC.Stg.Unarise.html#initUnariseEnv"><span class="hs-identifier hs-type">initUnariseEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseVal"><span class="hs-identifier hs-type">UnariseVal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-436"></span><span id="initUnariseEnv"><span class="annot"><span class="annottext">initUnariseEnv :: VarEnv UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#initUnariseEnv"><span class="hs-identifier hs-var hs-var">initUnariseEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-var">UnariseEnv</span></a></span><span>
</span><span id="line-437"></span><span class="hs-keyword">data</span><span> </span><span id="UnariseVal"><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseVal"><span class="hs-identifier hs-var">UnariseVal</span></a></span></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MultiVal"><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- MultiVal to tuple. Can be empty list (void).</span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnaryVal"><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-var">UnaryVal</span></a></span></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span>   </span><span class="hs-comment">-- See Note [Renaming during unarisation].</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseVal"><span class="hs-identifier hs-type">UnariseVal</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621682096991"><span class="annot"><span class="annottext">ppr :: UnariseVal -&gt; SDoc
</span><a href="#local-6989586621682096991"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-type">MultiVal</span></a></span><span> </span><span id="local-6989586621682096993"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682096993"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MultiVal&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682096993"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-type">UnaryVal</span></a></span><span> </span><span id="local-6989586621682096996"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682096996"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UnaryVal&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682096996"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">-- | Extend the environment, checking the UnariseEnv invariant.</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- The id is mapped to one or more things.</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- See Note [UnariseEnv]</span><span>
</span><span id="line-448"></span><span class="annot"><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-type">extendRho</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseVal"><span class="hs-identifier hs-type">UnariseVal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-449"></span><span id="extendRho"><span class="annot"><span class="annottext">extendRho :: UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var hs-var">extendRho</span></a></span></span><span> </span><span id="local-6989586621682096998"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682096998"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682096999"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682096999"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-type">MultiVal</span></a></span><span> </span><span id="local-6989586621682097000"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097000"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UnariseEnv -&gt; UnariseEnv
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StgArg -&gt; Bool) -&gt; [StgArg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Types.RepType.html#isNvUnaryType"><span class="hs-identifier hs-var">isNvUnaryType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (StgArg -&gt; Type) -&gt; StgArg -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097000"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682096998"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#ue_rho"><span class="hs-identifier hs-var">ue_rho</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-type">extendVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#ue_rho"><span class="hs-identifier hs-var">ue_rho</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682096998"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682096999"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-type">MultiVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682097000"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-452"></span><span class="annot"><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span id="local-6989586621682097007"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097007"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682097008"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097008"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-type">UnaryVal</span></a></span><span> </span><span id="local-6989586621682097009"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097009"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UnariseEnv -&gt; UnariseEnv
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Types.RepType.html#isNvUnaryType"><span class="hs-identifier hs-var">isNvUnaryType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097009"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097007"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#ue_rho"><span class="hs-identifier hs-var">ue_rho</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-type">extendVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#ue_rho"><span class="hs-identifier hs-var">ue_rho</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682097007"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682097008"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-type">UnaryVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682097009"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- Properly shadow things from an outer scope.</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- See Note [UnariseEnv]</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- The id stands for itself so we don't record a mapping.</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- See Note [UnariseEnv]</span><span>
</span><span id="line-460"></span><span class="annot"><a href="GHC.Stg.Unarise.html#extendRhoWithoutValue"><span class="hs-identifier hs-type">extendRhoWithoutValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-461"></span><span id="extendRhoWithoutValue"><span class="annot"><span class="annottext">extendRhoWithoutValue :: UnariseEnv -&gt; Id -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRhoWithoutValue"><span class="hs-identifier hs-var hs-var">extendRhoWithoutValue</span></a></span></span><span> </span><span id="local-6989586621682097011"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097011"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682097012"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097012"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097011"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#ue_rho"><span class="hs-identifier hs-var">ue_rho</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#delVarEnv"><span class="hs-identifier hs-type">delVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#ue_rho"><span class="hs-identifier hs-var">ue_rho</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682097011"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682097012"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="annot"><a href="GHC.Stg.Unarise.html#lookupRho"><span class="hs-identifier hs-type">lookupRho</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseVal"><span class="hs-identifier hs-type">UnariseVal</span></a></span><span>
</span><span id="line-464"></span><span id="lookupRho"><span class="annot"><span class="annottext">lookupRho :: UnariseEnv -&gt; Id -&gt; Maybe UnariseVal
</span><a href="GHC.Stg.Unarise.html#lookupRho"><span class="hs-identifier hs-var hs-var">lookupRho</span></a></span></span><span> </span><span id="local-6989586621682097015"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097015"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682097016"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097016"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv UnariseVal -&gt; Id -&gt; Maybe UnariseVal
forall a. VarEnv a -&gt; Id -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; VarEnv UnariseVal
</span><a href="GHC.Stg.Unarise.html#ue_rho"><span class="hs-identifier hs-var">ue_rho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097015"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097016"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unarise"><span class="hs-identifier hs-type">unarise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTopBinding"><span class="hs-identifier hs-type">StgTopBinding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTopBinding"><span class="hs-identifier hs-type">StgTopBinding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-469"></span><span id="unarise"><span class="annot"><span class="annottext">unarise :: UniqSupply -&gt; [StgTopBinding] -&gt; [StgTopBinding]
</span><a href="GHC.Stg.Unarise.html#unarise"><span class="hs-identifier hs-var hs-var">unarise</span></a></span></span><span> </span><span id="local-6989586621682097018"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097018"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621682097019"><span class="annot"><span class="annottext">[StgTopBinding]
</span><a href="#local-6989586621682097019"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; UniqSM [StgTopBinding] -&gt; [StgTopBinding]
forall a. UniqSupply -&gt; UniqSM a -&gt; a
</span><a href="GHC.Types.Unique.Supply.html#initUs_"><span class="hs-identifier hs-var">initUs_</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097018"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StgTopBinding -&gt; UniqSM StgTopBinding)
-&gt; [StgTopBinding] -&gt; UniqSM [StgTopBinding]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; StgTopBinding -&gt; UniqSM StgTopBinding
</span><a href="GHC.Stg.Unarise.html#unariseTopBinding"><span class="hs-identifier hs-var">unariseTopBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarEnv UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#initUnariseEnv"><span class="hs-identifier hs-var">initUnariseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv UnariseVal
forall a. VarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgTopBinding]
</span><a href="#local-6989586621682097019"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseTopBinding"><span class="hs-identifier hs-type">unariseTopBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTopBinding"><span class="hs-identifier hs-type">StgTopBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTopBinding"><span class="hs-identifier hs-type">StgTopBinding</span></a></span><span>
</span><span id="line-472"></span><span id="unariseTopBinding"><span class="annot"><span class="annottext">unariseTopBinding :: UnariseEnv -&gt; StgTopBinding -&gt; UniqSM StgTopBinding
</span><a href="GHC.Stg.Unarise.html#unariseTopBinding"><span class="hs-identifier hs-var hs-var">unariseTopBinding</span></a></span></span><span> </span><span id="local-6989586621682097024"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097024"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTopLifted"><span class="hs-identifier hs-type">StgTopLifted</span></a></span><span> </span><span id="local-6989586621682097026"><span class="annot"><span class="annottext">GenStgBinding 'Vanilla
</span><a href="#local-6989586621682097026"><span class="hs-identifier hs-var">bind</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'Vanilla -&gt; StgTopBinding
forall (pass :: StgPass).
GenStgBinding pass -&gt; GenStgTopBinding pass
</span><a href="GHC.Stg.Syntax.html#StgTopLifted"><span class="hs-identifier hs-var">StgTopLifted</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgBinding 'Vanilla -&gt; StgTopBinding)
-&gt; UniqSM (GenStgBinding 'Vanilla) -&gt; UniqSM StgTopBinding
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; GenStgBinding 'Vanilla -&gt; UniqSM (GenStgBinding 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseBinding"><span class="hs-identifier hs-var">unariseBinding</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097024"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'Vanilla
</span><a href="#local-6989586621682097026"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-474"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseTopBinding"><span class="hs-identifier hs-var">unariseTopBinding</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682097029"><span class="annot"><span class="annottext">bind :: StgTopBinding
</span><a href="#local-6989586621682097029"><span class="hs-identifier hs-var">bind</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTopStringLit"><span class="hs-identifier hs-type">StgTopStringLit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StgTopBinding -&gt; UniqSM StgTopBinding
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">StgTopBinding
</span><a href="#local-6989586621682097029"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseBinding"><span class="hs-identifier hs-type">unariseBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgBinding"><span class="hs-identifier hs-type">StgBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgBinding"><span class="hs-identifier hs-type">StgBinding</span></a></span><span>
</span><span id="line-477"></span><span id="unariseBinding"><span class="annot"><span class="annottext">unariseBinding :: UnariseEnv
-&gt; GenStgBinding 'Vanilla -&gt; UniqSM (GenStgBinding 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseBinding"><span class="hs-identifier hs-var hs-var">unariseBinding</span></a></span></span><span> </span><span id="local-6989586621682097032"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097032"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgNonRec"><span class="hs-identifier hs-type">StgNonRec</span></a></span><span> </span><span id="local-6989586621682097034"><span class="annot"><span class="annottext">BinderP 'Vanilla
</span><a href="#local-6989586621682097034"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682097035"><span class="annot"><span class="annottext">GenStgRhs 'Vanilla
</span><a href="#local-6989586621682097035"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinderP 'Vanilla -&gt; GenStgRhs 'Vanilla -&gt; GenStgBinding 'Vanilla
forall (pass :: StgPass).
BinderP pass -&gt; GenStgRhs pass -&gt; GenStgBinding pass
</span><a href="GHC.Stg.Syntax.html#StgNonRec"><span class="hs-identifier hs-var">StgNonRec</span></a></span><span> </span><span class="annot"><span class="annottext">BinderP 'Vanilla
</span><a href="#local-6989586621682097034"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgRhs 'Vanilla -&gt; GenStgBinding 'Vanilla)
-&gt; UniqSM (GenStgRhs 'Vanilla) -&gt; UniqSM (GenStgBinding 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgRhs 'Vanilla -&gt; UniqSM (GenStgRhs 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseRhs"><span class="hs-identifier hs-var">unariseRhs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097032"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'Vanilla
</span><a href="#local-6989586621682097035"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-479"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseBinding"><span class="hs-identifier hs-var">unariseBinding</span></a></span><span> </span><span id="local-6989586621682097037"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097037"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRec"><span class="hs-identifier hs-type">StgRec</span></a></span><span> </span><span id="local-6989586621682097039"><span class="annot"><span class="annottext">[(BinderP 'Vanilla, GenStgRhs 'Vanilla)]
</span><a href="#local-6989586621682097039"><span class="hs-identifier hs-var">xrhss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Id, GenStgRhs 'Vanilla)] -&gt; GenStgBinding 'Vanilla
[(BinderP 'Vanilla, GenStgRhs 'Vanilla)] -&gt; GenStgBinding 'Vanilla
forall (pass :: StgPass).
[(BinderP pass, GenStgRhs pass)] -&gt; GenStgBinding pass
</span><a href="GHC.Stg.Syntax.html#StgRec"><span class="hs-identifier hs-var">StgRec</span></a></span><span> </span><span class="annot"><span class="annottext">([(Id, GenStgRhs 'Vanilla)] -&gt; GenStgBinding 'Vanilla)
-&gt; UniqSM [(Id, GenStgRhs 'Vanilla)]
-&gt; UniqSM (GenStgBinding 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((Id, GenStgRhs 'Vanilla) -&gt; UniqSM (Id, GenStgRhs 'Vanilla))
-&gt; [(Id, GenStgRhs 'Vanilla)] -&gt; UniqSM [(Id, GenStgRhs 'Vanilla)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682097040"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097040"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097041"><span class="annot"><span class="annottext">GenStgRhs 'Vanilla
</span><a href="#local-6989586621682097041"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097040"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GenStgRhs 'Vanilla -&gt; (Id, GenStgRhs 'Vanilla))
-&gt; UniqSM (GenStgRhs 'Vanilla) -&gt; UniqSM (Id, GenStgRhs 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgRhs 'Vanilla -&gt; UniqSM (GenStgRhs 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseRhs"><span class="hs-identifier hs-var">unariseRhs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097037"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgRhs 'Vanilla
</span><a href="#local-6989586621682097041"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Id, GenStgRhs 'Vanilla)]
[(BinderP 'Vanilla, GenStgRhs 'Vanilla)]
</span><a href="#local-6989586621682097039"><span class="hs-identifier hs-var">xrhss</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseRhs"><span class="hs-identifier hs-type">unariseRhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRhs"><span class="hs-identifier hs-type">StgRhs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRhs"><span class="hs-identifier hs-type">StgRhs</span></a></span><span>
</span><span id="line-483"></span><span id="unariseRhs"><span class="annot"><span class="annottext">unariseRhs :: UnariseEnv -&gt; GenStgRhs 'Vanilla -&gt; UniqSM (GenStgRhs 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseRhs"><span class="hs-identifier hs-var hs-var">unariseRhs</span></a></span></span><span> </span><span id="local-6989586621682097043"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097043"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRhsClosure"><span class="hs-identifier hs-type">StgRhsClosure</span></a></span><span> </span><span id="local-6989586621682097045"><span class="annot"><span class="annottext">XRhsClosure 'Vanilla
</span><a href="#local-6989586621682097045"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span id="local-6989586621682097046"><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621682097046"><span class="hs-identifier hs-var">ccs</span></a></span></span><span> </span><span id="local-6989586621682097047"><span class="annot"><span class="annottext">UpdateFlag
</span><a href="#local-6989586621682097047"><span class="hs-identifier hs-var">update_flag</span></a></span></span><span> </span><span id="local-6989586621682097048"><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><a href="#local-6989586621682097048"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097049"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097049"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097050"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097050"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097051"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097051"><span class="hs-identifier hs-var">args1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; [Id] -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseFunArgBinders"><span class="hs-identifier hs-var">unariseFunArgBinders</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097043"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097048"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-485"></span><span>       </span><span id="local-6989586621682097053"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097053"><span class="hs-identifier hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097050"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097049"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-486"></span><span>       </span><span class="annot"><span class="annottext">GenStgRhs 'Vanilla -&gt; UniqSM (GenStgRhs 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XRhsClosure 'Vanilla
-&gt; CostCentreStack
-&gt; UpdateFlag
-&gt; [BinderP 'Vanilla]
-&gt; GenStgExpr 'Vanilla
-&gt; GenStgRhs 'Vanilla
forall (pass :: StgPass).
XRhsClosure pass
-&gt; CostCentreStack
-&gt; UpdateFlag
-&gt; [BinderP pass]
-&gt; GenStgExpr pass
-&gt; GenStgRhs pass
</span><a href="GHC.Stg.Syntax.html#StgRhsClosure"><span class="hs-identifier hs-var">StgRhsClosure</span></a></span><span> </span><span class="annot"><span class="annottext">XRhsClosure 'Vanilla
</span><a href="#local-6989586621682097045"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621682097046"><span class="hs-identifier hs-var">ccs</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateFlag
</span><a href="#local-6989586621682097047"><span class="hs-identifier hs-var">update_flag</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097051"><span class="hs-identifier hs-var">args1</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097053"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseRhs"><span class="hs-identifier hs-var">unariseRhs</span></a></span><span> </span><span id="local-6989586621682097055"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097055"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgRhsCon"><span class="hs-identifier hs-type">StgRhsCon</span></a></span><span> </span><span id="local-6989586621682097057"><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621682097057"><span class="hs-identifier hs-var">ccs</span></a></span></span><span> </span><span id="local-6989586621682097058"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097058"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621682097059"><span class="annot"><span class="annottext">ConstructorNumber
</span><a href="#local-6989586621682097059"><span class="hs-identifier hs-var">mu</span></a></span></span><span> </span><span id="local-6989586621682097060"><span class="annot"><span class="annottext">[StgTickish]
</span><a href="#local-6989586621682097060"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621682097061"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097061"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (GenStgRhs 'Vanilla -&gt; UniqSM (GenStgRhs 'Vanilla))
-&gt; GenStgRhs 'Vanilla
-&gt; UniqSM (GenStgRhs 'Vanilla)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedTupleDataCon"><span class="hs-identifier hs-var">isUnboxedTupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097058"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedSumDataCon"><span class="hs-identifier hs-var">isUnboxedSumDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097058"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><span class="annottext">GenStgRhs 'Vanilla -&gt; UniqSM (GenStgRhs 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CostCentreStack
-&gt; DataCon
-&gt; ConstructorNumber
-&gt; [StgTickish]
-&gt; [StgArg]
-&gt; GenStgRhs 'Vanilla
forall (pass :: StgPass).
CostCentreStack
-&gt; DataCon
-&gt; ConstructorNumber
-&gt; [StgTickish]
-&gt; [StgArg]
-&gt; GenStgRhs pass
</span><a href="GHC.Stg.Syntax.html#StgRhsCon"><span class="hs-identifier hs-var">StgRhsCon</span></a></span><span> </span><span class="annot"><span class="annottext">CostCentreStack
</span><a href="#local-6989586621682097057"><span class="hs-identifier hs-var">ccs</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097058"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorNumber
</span><a href="#local-6989586621682097059"><span class="hs-identifier hs-var">mu</span></a></span><span> </span><span class="annot"><span class="annottext">[StgTickish]
</span><a href="#local-6989586621682097060"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; [StgArg] -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseConArgs"><span class="hs-identifier hs-var">unariseConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097055"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097061"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-type">unariseExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span id="unariseExpr"><span class="annot"><span class="annottext">unariseExpr :: UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var hs-var">unariseExpr</span></a></span></span><span> </span><span id="local-6989586621682097068"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097068"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097069"><span class="annot"><span class="annottext">e :: GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097069"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgApp"><span class="hs-identifier hs-type">StgApp</span></a></span><span> </span><span id="local-6989586621682097071"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097071"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; Maybe UnariseVal
</span><a href="GHC.Stg.Unarise.html#lookupRho"><span class="hs-identifier hs-var">lookupRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097068"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097071"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-498"></span><span>      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-type">MultiVal</span></a></span><span> </span><span id="local-6989586621682097072"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097072"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Including empty tuples</span><span>
</span><span id="line-499"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#mkTuple"><span class="hs-identifier hs-var">mkTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097072"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-type">UnaryVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-type">StgVarArg</span></a></span><span> </span><span id="local-6989586621682097075"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097075"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; [StgArg] -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass). Id -&gt; [StgArg] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgApp"><span class="hs-identifier hs-var">StgApp</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097075"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-type">UnaryVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-type">StgLitArg</span></a></span><span> </span><span id="local-6989586621682097077"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097077"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass). Literal -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgLit"><span class="hs-identifier hs-var">StgLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097077"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>      </span><span class="annot"><span class="annottext">Maybe UnariseVal
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-505"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097069"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span id="local-6989586621682097079"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097079"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097080"><span class="annot"><span class="annottext">e :: GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097080"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgApp"><span class="hs-identifier hs-type">StgApp</span></a></span><span> </span><span id="local-6989586621682097081"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097081"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682097082"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097082"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; [StgArg] -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass). Id -&gt; [StgArg] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgApp"><span class="hs-identifier hs-var">StgApp</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097083"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; [StgArg] -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseFunArgs"><span class="hs-identifier hs-var">unariseFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097079"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097082"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-510"></span><span>    </span><span id="local-6989586621682097083"><span class="annot"><span class="annottext">f' :: Id
</span><a href="#local-6989586621682097083"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; Maybe UnariseVal
</span><a href="GHC.Stg.Unarise.html#lookupRho"><span class="hs-identifier hs-var">lookupRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097079"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-511"></span><span>           </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-type">UnaryVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-type">StgVarArg</span></a></span><span> </span><span id="local-6989586621682097085"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097085"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097085"><span class="hs-identifier hs-var">f'</span></a></span><span>
</span><span id="line-512"></span><span>           </span><span class="annot"><span class="annottext">Maybe UnariseVal
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097081"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-513"></span><span>           </span><span id="local-6989586621682097086"><span class="annot"><span class="annottext">Maybe UnariseVal
</span><a href="#local-6989586621682097086"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Id
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unariseExpr - app2&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StgPprOpts -&gt; GenStgExpr 'Vanilla -&gt; SDoc
forall (pass :: StgPass).
OutputablePass pass =&gt;
StgPprOpts -&gt; GenStgExpr pass -&gt; SDoc
</span><a href="GHC.Stg.Syntax.html#pprStgExpr"><span class="hs-identifier hs-var">pprStgExpr</span></a></span><span> </span><span class="annot"><span class="annottext">StgPprOpts
</span><a href="GHC.Stg.Syntax.html#panicStgPprOpts"><span class="hs-identifier hs-var">panicStgPprOpts</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097080"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UnariseVal -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UnariseVal
</span><a href="#local-6989586621682097086"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>               </span><span class="hs-comment">-- Can't happen because 'args' is non-empty, and</span><span>
</span><span id="line-515"></span><span>               </span><span class="hs-comment">-- a tuple or sum cannot be applied to anything</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLit"><span class="hs-identifier hs-type">StgLit</span></a></span><span> </span><span id="local-6989586621682097091"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097091"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass). Literal -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgLit"><span class="hs-identifier hs-var">StgLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097091"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span id="local-6989586621682097092"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097092"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgConApp"><span class="hs-identifier hs-type">StgConApp</span></a></span><span> </span><span id="local-6989586621682097094"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097094"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span id="local-6989586621682097095"><span class="annot"><span class="annottext">ConstructorNumber
</span><a href="#local-6989586621682097095"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682097096"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097096"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097097"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097097"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedSumDataCon"><span class="hs-identifier hs-var">isUnboxedSumDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097094"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedTupleDataCon"><span class="hs-identifier hs-var">isUnboxedTupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097094"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-523"></span><span>      </span><span id="local-6989586621682097098"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097098"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UniqSM UniqSupply
forall (m :: * -&gt; *). MonadUnique m =&gt; m UniqSupply
</span><a href="GHC.Types.Unique.Supply.html#getUniqueSupplyM"><span class="hs-identifier hs-var">getUniqueSupplyM</span></a></span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; UniqSupply
-&gt; DataCon
-&gt; [StgArg]
-&gt; [Type]
-&gt; ([StgArg], Maybe (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla))
</span><a href="GHC.Stg.Unarise.html#unariseUbxSumOrTupleArgs"><span class="hs-identifier hs-var">unariseUbxSumOrTupleArgs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097092"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097098"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097094"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097096"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097097"><span class="hs-identifier hs-var">ty_args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-525"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682097101"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097101"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682097102"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097102"><span class="hs-identifier hs-var">cast_wrapper</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla))
-&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097102"><span class="hs-identifier hs-var">cast_wrapper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#mkTuple"><span class="hs-identifier hs-var">mkTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097101"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682097103"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097103"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla))
-&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#mkTuple"><span class="hs-identifier hs-var">mkTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097103"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-530"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097104"><span class="annot"><span class="annottext">args' :: [StgArg]
</span><a href="#local-6989586621682097104"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; [StgArg] -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseConArgs"><span class="hs-identifier hs-var">unariseConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097092"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097096"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-531"></span><span>      </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla))
-&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon
-&gt; ConstructorNumber -&gt; [StgArg] -&gt; [Type] -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
DataCon
-&gt; ConstructorNumber -&gt; [StgArg] -&gt; [Type] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgConApp"><span class="hs-identifier hs-var">StgConApp</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097094"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorNumber
</span><a href="#local-6989586621682097095"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097104"><span class="hs-identifier hs-var">args'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StgArg -&gt; Type) -&gt; [StgArg] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097104"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span id="local-6989586621682097105"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097105"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgOpApp"><span class="hs-identifier hs-type">StgOpApp</span></a></span><span> </span><span id="local-6989586621682097107"><span class="annot"><span class="annottext">StgOp
</span><a href="#local-6989586621682097107"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682097108"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097108"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097109"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097109"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StgOp -&gt; [StgArg] -&gt; Type -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
StgOp -&gt; [StgArg] -&gt; Type -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgOpApp"><span class="hs-identifier hs-var">StgOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">StgOp
</span><a href="#local-6989586621682097107"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; [StgArg] -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseFunArgs"><span class="hs-identifier hs-var">unariseFunArgs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097105"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097108"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097109"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span id="local-6989586621682097110"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgCase"><span class="hs-identifier hs-type">StgCase</span></a></span><span> </span><span id="local-6989586621682097112"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097112"><span class="hs-identifier hs-var">scrut</span></a></span></span><span> </span><span id="local-6989586621682097113"><span class="annot"><span class="annottext">BinderP 'Vanilla
</span><a href="#local-6989586621682097113"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682097114"><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097114"><span class="hs-identifier hs-var">alt_ty</span></a></span></span><span> </span><span id="local-6989586621682097115"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097115"><span class="hs-identifier hs-var">alts</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-comment">-- tuple/sum binders in the scrutinee can always be eliminated</span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgApp"><span class="hs-identifier hs-type">StgApp</span></a></span><span> </span><span id="local-6989586621682097116"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097116"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097112"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-539"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-type">MultiVal</span></a></span><span> </span><span id="local-6989586621682097117"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097117"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; Maybe UnariseVal
</span><a href="GHC.Stg.Unarise.html#lookupRho"><span class="hs-identifier hs-var">lookupRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097116"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; [StgArg]
-&gt; Id
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#elimCase"><span class="hs-identifier hs-var">elimCase</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097117"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097113"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097114"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097115"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-comment">-- Handle strict lets for tuples and sums:</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-comment">--   case (# a,b #) of r -&gt; rhs</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-comment">-- and analogously for sums</span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgConApp"><span class="hs-identifier hs-type">StgConApp</span></a></span><span> </span><span id="local-6989586621682097119"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097119"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span id="local-6989586621682097120"><span class="annot"><span class="annottext">ConstructorNumber
</span><a href="#local-6989586621682097120"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span id="local-6989586621682097121"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097121"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097122"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097122"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097112"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedSumDataCon"><span class="hs-identifier hs-var">isUnboxedSumDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097119"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedTupleDataCon"><span class="hs-identifier hs-var">isUnboxedTupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097119"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-548"></span><span>    </span><span id="local-6989586621682097123"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097123"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UniqSM UniqSupply
forall (m :: * -&gt; *). MonadUnique m =&gt; m UniqSupply
</span><a href="GHC.Types.Unique.Supply.html#getUniqueSupplyM"><span class="hs-identifier hs-var">getUniqueSupplyM</span></a></span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; UniqSupply
-&gt; DataCon
-&gt; [StgArg]
-&gt; [Type]
-&gt; ([StgArg], Maybe (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla))
</span><a href="GHC.Stg.Unarise.html#unariseUbxSumOrTupleArgs"><span class="hs-identifier hs-var">unariseUbxSumOrTupleArgs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097123"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097119"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097121"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097122"><span class="hs-identifier hs-var">ty_args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-550"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682097124"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097124"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682097125"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097125"><span class="hs-identifier hs-var">wrapper</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097125"><span class="hs-identifier hs-var">wrapper</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; UniqSM (GenStgExpr 'Vanilla) -&gt; UniqSM (GenStgExpr 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; [StgArg]
-&gt; Id
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#elimCase"><span class="hs-identifier hs-var">elimCase</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097124"><span class="hs-identifier hs-var">args'</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097113"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097114"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097115"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-551"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682097126"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097126"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; [StgArg]
-&gt; Id
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#elimCase"><span class="hs-identifier hs-var">elimCase</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097126"><span class="hs-identifier hs-var">args'</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097113"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097114"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097115"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-comment">-- See (3) of Note [Rubbish literals] in GHC.Types.Literal</span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLit"><span class="hs-identifier hs-type">StgLit</span></a></span><span> </span><span id="local-6989586621682097127"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097127"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097112"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682097128"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097128"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Maybe [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseLiteral_maybe"><span class="hs-identifier hs-var">unariseLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097127"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; [StgArg]
-&gt; Id
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#elimCase"><span class="hs-identifier hs-var">elimCase</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097128"><span class="hs-identifier hs-var">args'</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097113"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097114"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097115"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-comment">-- general case</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682097130"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097130"><span class="hs-identifier hs-var">scrut'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097112"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-561"></span><span>       </span><span id="local-6989586621682097131"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097131"><span class="hs-identifier hs-var">alts'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; AltType
-&gt; Id
-&gt; [GenStgAlt 'Vanilla]
-&gt; UniqSM [GenStgAlt 'Vanilla]
</span><a href="GHC.Stg.Unarise.html#unariseAlts"><span class="hs-identifier hs-var">unariseAlts</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097110"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097114"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097113"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097115"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-562"></span><span>       </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
-&gt; BinderP 'Vanilla
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
GenStgExpr pass
-&gt; BinderP pass -&gt; AltType -&gt; [GenStgAlt pass] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgCase"><span class="hs-identifier hs-var">StgCase</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097130"><span class="hs-identifier hs-var">scrut'</span></a></span><span> </span><span class="annot"><span class="annottext">BinderP 'Vanilla
</span><a href="#local-6989586621682097113"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097114"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097131"><span class="hs-identifier hs-var">alts'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>                       </span><span class="hs-comment">-- bndr may have a unboxed sum/tuple type but it will be</span><span>
</span><span id="line-564"></span><span>                       </span><span class="hs-comment">-- dead after unarise (checked in GHC.Stg.Lint)</span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span id="local-6989586621682097133"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097133"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLet"><span class="hs-identifier hs-type">StgLet</span></a></span><span> </span><span id="local-6989586621682097135"><span class="annot"><span class="annottext">XLet 'Vanilla
</span><a href="#local-6989586621682097135"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span id="local-6989586621682097136"><span class="annot"><span class="annottext">GenStgBinding 'Vanilla
</span><a href="#local-6989586621682097136"><span class="hs-identifier hs-var">bind</span></a></span></span><span> </span><span id="local-6989586621682097137"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097137"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XLet 'Vanilla
-&gt; GenStgBinding 'Vanilla
-&gt; GenStgExpr 'Vanilla
-&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
XLet pass
-&gt; GenStgBinding pass -&gt; GenStgExpr pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgLet"><span class="hs-identifier hs-var">StgLet</span></a></span><span> </span><span class="annot"><span class="annottext">XLet 'Vanilla
</span><a href="#local-6989586621682097135"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgBinding 'Vanilla
 -&gt; GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; UniqSM (GenStgBinding 'Vanilla)
-&gt; UniqSM (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; GenStgBinding 'Vanilla -&gt; UniqSM (GenStgBinding 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseBinding"><span class="hs-identifier hs-var">unariseBinding</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097133"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'Vanilla
</span><a href="#local-6989586621682097136"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSM (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; UniqSM (GenStgExpr 'Vanilla) -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a b. UniqSM (a -&gt; b) -&gt; UniqSM a -&gt; UniqSM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%2A%3E/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097133"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097137"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span id="local-6989586621682097138"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097138"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLetNoEscape"><span class="hs-identifier hs-type">StgLetNoEscape</span></a></span><span> </span><span id="local-6989586621682097140"><span class="annot"><span class="annottext">XLetNoEscape 'Vanilla
</span><a href="#local-6989586621682097140"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span id="local-6989586621682097141"><span class="annot"><span class="annottext">GenStgBinding 'Vanilla
</span><a href="#local-6989586621682097141"><span class="hs-identifier hs-var">bind</span></a></span></span><span> </span><span id="local-6989586621682097142"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097142"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XLetNoEscape 'Vanilla
-&gt; GenStgBinding 'Vanilla
-&gt; GenStgExpr 'Vanilla
-&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
XLetNoEscape pass
-&gt; GenStgBinding pass -&gt; GenStgExpr pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgLetNoEscape"><span class="hs-identifier hs-var">StgLetNoEscape</span></a></span><span> </span><span class="annot"><span class="annottext">XLetNoEscape 'Vanilla
</span><a href="#local-6989586621682097140"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgBinding 'Vanilla
 -&gt; GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; UniqSM (GenStgBinding 'Vanilla)
-&gt; UniqSM (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; GenStgBinding 'Vanilla -&gt; UniqSM (GenStgBinding 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseBinding"><span class="hs-identifier hs-var">unariseBinding</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097138"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgBinding 'Vanilla
</span><a href="#local-6989586621682097141"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSM (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; UniqSM (GenStgExpr 'Vanilla) -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a b. UniqSM (a -&gt; b) -&gt; UniqSM a -&gt; UniqSM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%3C%2A%3E/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097138"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097142"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span id="local-6989586621682097143"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097143"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgTick"><span class="hs-identifier hs-type">StgTick</span></a></span><span> </span><span id="local-6989586621682097145"><span class="annot"><span class="annottext">StgTickish
</span><a href="#local-6989586621682097145"><span class="hs-identifier hs-var">tick</span></a></span></span><span> </span><span id="local-6989586621682097146"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097146"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StgTickish -&gt; GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
StgTickish -&gt; GenStgExpr pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgTick"><span class="hs-identifier hs-var">StgTick</span></a></span><span> </span><span class="annot"><span class="annottext">StgTickish
</span><a href="#local-6989586621682097145"><span class="hs-identifier hs-var">tick</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; UniqSM (GenStgExpr 'Vanilla) -&gt; UniqSM (GenStgExpr 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097143"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097146"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="hs-comment">-- Doesn't return void args.</span><span>
</span><span id="line-576"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseUbxSumOrTupleArgs"><span class="hs-identifier hs-type">unariseUbxSumOrTupleArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#InStgArg"><span class="hs-identifier hs-type">InStgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-577"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span>           </span><span class="hs-comment">-- Arguments representing the unboxed sum</span><span>
</span><span id="line-578"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Transformation to apply to the arguments, to bring them</span><span>
</span><span id="line-579"></span><span>                                                    </span><span class="hs-comment">-- into the right Rep</span><span>
</span><span id="line-580"></span><span id="unariseUbxSumOrTupleArgs"><span class="annot"><span class="annottext">unariseUbxSumOrTupleArgs :: UnariseEnv
-&gt; UniqSupply
-&gt; DataCon
-&gt; [StgArg]
-&gt; [Type]
-&gt; ([StgArg], Maybe (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla))
</span><a href="GHC.Stg.Unarise.html#unariseUbxSumOrTupleArgs"><span class="hs-identifier hs-var hs-var">unariseUbxSumOrTupleArgs</span></a></span></span><span> </span><span id="local-6989586621682097148"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097148"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097149"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097149"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621682097150"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097150"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span id="local-6989586621682097151"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097151"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097152"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097152"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedTupleDataCon"><span class="hs-identifier hs-var">isUnboxedTupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097150"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; [StgArg] -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseConArgs"><span class="hs-identifier hs-var">unariseConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097148"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097151"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isUnboxedSumDataCon"><span class="hs-identifier hs-var">isUnboxedSumDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097150"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097153"><span class="annot"><span class="annottext">args1 :: [StgArg]
</span><a href="#local-6989586621682097153"><span class="hs-identifier hs-var hs-var">args1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [StgArg] -&gt; [StgArg]
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; Bool
forall a. [a] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097151"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; [StgArg] -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseConArgs"><span class="hs-identifier hs-var">unariseConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097148"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097151"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097155"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097155"><span class="hs-identifier hs-var">args2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097156"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097156"><span class="hs-identifier hs-var">cast_wrapper</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt;
DataCon
-&gt; [Type]
-&gt; [StgArg]
-&gt; UniqSupply
-&gt; ([StgArg], GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
DataCon
-&gt; [Type]
-&gt; [StgArg]
-&gt; UniqSupply
-&gt; ([StgArg], GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#mkUbxSum"><span class="hs-identifier hs-var">mkUbxSum</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097150"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097152"><span class="hs-identifier hs-var">ty_args</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097153"><span class="hs-identifier hs-var">args1</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097149"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-587"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097155"><span class="hs-identifier hs-var">args2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; Maybe (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097156"><span class="hs-identifier hs-var">cast_wrapper</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ([StgArg], Maybe (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla))
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unariseUbxSumOrTupleArgs: Constructor not a unboxed sum or tuple&quot;</span></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-comment">-- Returns @Nothing@ if the given literal is already unary (exactly</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- one PrimRep).  Doesn't return void args.</span><span>
</span><span id="line-594"></span><span class="hs-comment">--</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- This needs to exist because rubbish literals can have any representation.</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- See also Note [Rubbish literals] in GHC.Types.Literal.</span><span>
</span><span id="line-597"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseLiteral_maybe"><span class="hs-identifier hs-type">unariseLiteral_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span id="unariseLiteral_maybe"><span class="annot"><span class="annottext">unariseLiteral_maybe :: Literal -&gt; Maybe [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseLiteral_maybe"><span class="hs-identifier hs-var hs-var">unariseLiteral_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitRubbish"><span class="hs-identifier hs-type">LitRubbish</span></a></span><span> </span><span id="local-6989586621682097160"><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621682097160"><span class="hs-identifier hs-var">torc</span></a></span></span><span> </span><span id="local-6989586621682097161"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097161"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682097162"><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682097162"><span class="hs-identifier hs-var">prep</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682097163"><span class="hs-identifier hs-var">preps</span></a></span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimRep -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isVoidRep"><span class="hs-identifier hs-var">isVoidRep</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682097162"><span class="hs-identifier hs-var">prep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [StgArg]
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>   </span><span class="hs-comment">-- Single, non-void PrimRep. Nothing to do!</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-comment">-- Multiple reps, possibly with VoidRep. Eliminate via elimCase</span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StgArg] -&gt; Maybe [StgArg]
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-var">StgLitArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Type -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="#local-6989586621682097160"><span class="hs-identifier hs-var">torc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimRep -&gt; Type
</span><a href="GHC.Types.RepType.html#primRepToRuntimeRep"><span class="hs-identifier hs-var">primRepToRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682097166"><span class="hs-identifier hs-var">prep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682097166"><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682097166"><span class="hs-identifier hs-var">prep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682097163"><span class="hs-identifier hs-var">preps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimRep -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isVoidRep"><span class="hs-identifier hs-var">isVoidRep</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682097166"><span class="hs-identifier hs-var">prep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-607"></span><span>    </span><span id="local-6989586621682097163"><span class="annot"><span class="annottext">preps :: [PrimRep]
</span><a href="#local-6989586621682097163"><span class="hs-identifier hs-var hs-var">preps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; SDoc -&gt; Type -&gt; [PrimRep]
SDoc -&gt; Type -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#runtimeRepPrimRep"><span class="hs-identifier hs-var">runtimeRepPrimRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unariseLiteral_maybe&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097161"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseLiteral_maybe"><span class="hs-identifier hs-var">unariseLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [StgArg]
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="annot"><a href="GHC.Stg.Unarise.html#elimCase"><span class="hs-identifier hs-type">elimCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-614"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- non-void args</span><span>
</span><span id="line-615"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#InId"><span class="hs-identifier hs-type">InId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#AltType"><span class="hs-identifier hs-type">AltType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#InStgAlt"><span class="hs-identifier hs-type">InStgAlt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgExpr"><span class="hs-identifier hs-type">OutStgExpr</span></a></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span id="elimCase"><span class="annot"><span class="annottext">elimCase :: UnariseEnv
-&gt; [StgArg]
-&gt; Id
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#elimCase"><span class="hs-identifier hs-var hs-var">elimCase</span></a></span></span><span> </span><span id="local-6989586621682097171"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097171"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097172"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097172"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097173"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097173"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#MultiValAlt"><span class="hs-identifier hs-type">MultiValAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-618"></span><span>                                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682097178"><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><a href="#local-6989586621682097178"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span>
</span><span id="line-619"></span><span>                                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682097180"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097180"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097181"><span class="annot"><span class="annottext">rho1 :: UnariseEnv
</span><a href="#local-6989586621682097181"><span class="hs-identifier hs-var hs-var">rho1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097171"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097173"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097172"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621682097182"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097182"><span class="hs-identifier hs-var">rho2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097183"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097183"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-622"></span><span>           </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-623"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedTupleBndr"><span class="hs-identifier hs-var">isUnboxedTupleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097173"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-624"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [StgArg] -&gt; UnariseEnv -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#mapTupleIdBinders"><span class="hs-identifier hs-var">mapTupleIdBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097178"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097172"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097181"><span class="hs-identifier hs-var">rho1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097180"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-626"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedSumBndr"><span class="hs-identifier hs-var">isUnboxedSumBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097173"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
 -&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla))
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-627"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><a href="#local-6989586621682097178"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-628"></span><span>                </span><span class="hs-comment">-- Sum with a void-type binder?</span><span>
</span><span id="line-629"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097181"><span class="hs-identifier hs-var">rho1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097180"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>                </span><span class="hs-special">[</span><span id="local-6989586621682097187"><span class="annot"><span class="annottext">BinderP 'Vanilla
</span><a href="#local-6989586621682097187"><span class="hs-identifier hs-var">alt_bndr</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id
-&gt; [StgArg]
-&gt; GenStgExpr 'Vanilla
-&gt; UnariseEnv
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#mapSumIdBinders"><span class="hs-identifier hs-var">mapSumIdBinders</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097187"><span class="hs-identifier hs-var">alt_bndr</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097172"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097180"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097181"><span class="hs-identifier hs-var">rho1</span></a></span><span>
</span><span id="line-631"></span><span>                </span><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mapSumIdBinders&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097178"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097172"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>       </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097182"><span class="hs-identifier hs-var">rho2</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097183"><span class="hs-identifier hs-var">rhs'</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="annot"><a href="GHC.Stg.Unarise.html#elimCase"><span class="hs-identifier hs-var">elimCase</span></a></span><span> </span><span id="local-6989586621682097189"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097189"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097190"><span class="annot"><span class="annottext">args :: [StgArg]
</span><a href="#local-6989586621682097190"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682097191"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097191"><span class="hs-identifier hs-var">tag_arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682097192"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097192"><span class="hs-identifier hs-var">real_args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097193"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097193"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#MultiValAlt"><span class="hs-identifier hs-type">MultiValAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097194"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097194"><span class="hs-identifier hs-var">alts</span></a></span></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedSumBndr"><span class="hs-identifier hs-var">isUnboxedSumBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097193"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682097195"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097195"><span class="hs-identifier hs-var">tag_bndr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Type -&gt; UniqSM Id
</span><a href="GHC.Stg.Unarise.html#mkId"><span class="hs-identifier hs-var">mkId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tag&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Stg.Unarise.html#tagTy"><span class="hs-identifier hs-var">tagTy</span></a></span><span>
</span><span id="line-638"></span><span>          </span><span class="hs-comment">-- this won't be used but we need a binder anyway</span><span>
</span><span id="line-639"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097198"><span class="annot"><span class="annottext">rho1 :: UnariseEnv
</span><a href="#local-6989586621682097198"><span class="hs-identifier hs-var hs-var">rho1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097189"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097193"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097190"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>           </span><span id="local-6989586621682097199"><span class="annot"><span class="annottext">scrut' :: GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097199"><span class="hs-identifier hs-var hs-var">scrut'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097191"><span class="hs-identifier hs-var">tag_arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-641"></span><span>                      </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-type">StgVarArg</span></a></span><span> </span><span id="local-6989586621682097200"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097200"><span class="hs-identifier hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; [StgArg] -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass). Id -&gt; [StgArg] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgApp"><span class="hs-identifier hs-var">StgApp</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097200"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-642"></span><span>                      </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-type">StgLitArg</span></a></span><span> </span><span id="local-6989586621682097201"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097201"><span class="hs-identifier hs-var">l</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass). Literal -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgLit"><span class="hs-identifier hs-var">StgLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097201"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span>       </span><span id="local-6989586621682097202"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097202"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; [StgArg] -&gt; [GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
</span><a href="GHC.Stg.Unarise.html#unariseSumAlts"><span class="hs-identifier hs-var">unariseSumAlts</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097198"><span class="hs-identifier hs-var">rho1</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097192"><span class="hs-identifier hs-var">real_args</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097194"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-645"></span><span>       </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
-&gt; BinderP 'Vanilla
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
GenStgExpr pass
-&gt; BinderP pass -&gt; AltType -&gt; [GenStgAlt pass] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgCase"><span class="hs-identifier hs-var">StgCase</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097199"><span class="hs-identifier hs-var">scrut'</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097195"><span class="hs-identifier hs-var">tag_bndr</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="GHC.Stg.Unarise.html#tagAltTy"><span class="hs-identifier hs-var">tagAltTy</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097202"><span class="hs-identifier hs-var">alts'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span class="annot"><a href="GHC.Stg.Unarise.html#elimCase"><span class="hs-identifier hs-var">elimCase</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682097205"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097205"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097206"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097206"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682097207"><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097207"><span class="hs-identifier hs-var">alt_ty</span></a></span></span><span> </span><span id="local-6989586621682097208"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097208"><span class="hs-identifier hs-var">alts</span></a></span></span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; UniqSM (GenStgExpr 'Vanilla)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;elimCase - unhandled case&quot;</span></span><span>
</span><span id="line-649"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097205"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097206"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AltType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097207"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; SDoc
forall (pass :: StgPass).
OutputablePass pass =&gt;
[GenStgAlt pass] -&gt; SDoc
</span><a href="GHC.Stg.Unarise.html#pprPanicAlts"><span class="hs-identifier hs-var">pprPanicAlts</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097208"><span class="hs-identifier hs-var">alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseAlts"><span class="hs-identifier hs-type">unariseAlts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#AltType"><span class="hs-identifier hs-type">AltType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#InId"><span class="hs-identifier hs-type">InId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-654"></span><span id="unariseAlts"><span class="annot"><span class="annottext">unariseAlts :: UnariseEnv
-&gt; AltType
-&gt; Id
-&gt; [GenStgAlt 'Vanilla]
-&gt; UniqSM [GenStgAlt 'Vanilla]
</span><a href="GHC.Stg.Unarise.html#unariseAlts"><span class="hs-identifier hs-var hs-var">unariseAlts</span></a></span></span><span> </span><span id="local-6989586621682097211"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097211"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#MultiValAlt"><span class="hs-identifier hs-type">MultiValAlt</span></a></span><span> </span><span id="local-6989586621682097212"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097212"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097213"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097213"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span>
</span><span id="line-655"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-656"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682097215"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097215"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedTupleBndr"><span class="hs-identifier hs-var">isUnboxedTupleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097213"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097216"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097216"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097217"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097217"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseConArgBinder"><span class="hs-identifier hs-var">unariseConArgBinder</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097211"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097213"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-659"></span><span>       </span><span class="hs-glyph">!</span><span id="local-6989586621682097219"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097219"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097216"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097215"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-660"></span><span>       </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon
-&gt; [BinderP 'Vanilla] -&gt; GenStgExpr 'Vanilla -&gt; GenStgAlt 'Vanilla
forall (pass :: StgPass).
AltCon -&gt; [BinderP pass] -&gt; GenStgExpr pass -&gt; GenStgAlt pass
</span><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-var">GenStgAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097212"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097217"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097219"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseAlts"><span class="hs-identifier hs-var">unariseAlts</span></a></span><span> </span><span id="local-6989586621682097223"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097223"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#MultiValAlt"><span class="hs-identifier hs-type">MultiValAlt</span></a></span><span> </span><span id="local-6989586621682097224"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097224"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097225"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097225"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-type">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-663"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682097226"><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><a href="#local-6989586621682097226"><span class="hs-identifier hs-var">ys</span></a></span></span><span>
</span><span id="line-664"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682097227"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097227"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedTupleBndr"><span class="hs-identifier hs-var">isUnboxedTupleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097225"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097228"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097228"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097229"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097229"><span class="hs-identifier hs-var">ys1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; [Id] -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseConArgBinders"><span class="hs-identifier hs-var">unariseConArgBinders</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097223"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097226"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-667"></span><span>       </span><span class="annot"><span class="annottext">Bool -&gt; UniqSM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097229"><span class="hs-identifier hs-var">ys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Int -&gt; Bool
forall a. [a] -&gt; Int -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthIs"><span class="hs-operator hs-var">`lengthIs`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097224"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097233"><span class="annot"><span class="annottext">rho'' :: UnariseEnv
</span><a href="#local-6989586621682097233"><span class="hs-identifier hs-var hs-var">rho''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097228"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097225"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; StgArg) -&gt; [Id] -&gt; [StgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097229"><span class="hs-identifier hs-var">ys1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>       </span><span class="hs-glyph">!</span><span id="local-6989586621682097234"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097234"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097233"><span class="hs-identifier hs-var">rho''</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097227"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-670"></span><span>       </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon
-&gt; [BinderP 'Vanilla] -&gt; GenStgExpr 'Vanilla -&gt; GenStgAlt 'Vanilla
forall (pass :: StgPass).
AltCon -&gt; [BinderP pass] -&gt; GenStgExpr pass -&gt; GenStgAlt pass
</span><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-var">GenStgAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097224"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097229"><span class="hs-identifier hs-var">ys1</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097234"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseAlts"><span class="hs-identifier hs-var">unariseAlts</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#MultiValAlt"><span class="hs-identifier hs-type">MultiValAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097235"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097235"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682097236"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097236"><span class="hs-identifier hs-var">alts</span></a></span></span><span>
</span><span id="line-673"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedTupleBndr"><span class="hs-identifier hs-var">isUnboxedTupleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097235"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-674"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; UniqSM [GenStgAlt 'Vanilla]
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unariseExpr: strange multi val alts&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; SDoc
forall (pass :: StgPass).
OutputablePass pass =&gt;
[GenStgAlt pass] -&gt; SDoc
</span><a href="GHC.Stg.Unarise.html#pprPanicAlts"><span class="hs-identifier hs-var">pprPanicAlts</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097236"><span class="hs-identifier hs-var">alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- In this case we don't need to scrutinize the tag bit</span><span>
</span><span id="line-677"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseAlts"><span class="hs-identifier hs-var">unariseAlts</span></a></span><span> </span><span id="local-6989586621682097237"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097237"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#MultiValAlt"><span class="hs-identifier hs-type">MultiValAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097238"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097238"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span>
</span><span id="line-678"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-679"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682097239"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097239"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-680"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedSumBndr"><span class="hs-identifier hs-var">isUnboxedSumBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097238"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-681"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097240"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097240"><span class="hs-identifier hs-var">rho_sum_bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097241"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097241"><span class="hs-identifier hs-var">sum_bndrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseConArgBinder"><span class="hs-identifier hs-var">unariseConArgBinder</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097237"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097238"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-682"></span><span>       </span><span id="local-6989586621682097242"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097242"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097240"><span class="hs-identifier hs-var">rho_sum_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097239"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-683"></span><span>       </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon
-&gt; [BinderP 'Vanilla] -&gt; GenStgExpr 'Vanilla -&gt; GenStgAlt 'Vanilla
forall (pass :: StgPass).
AltCon -&gt; [BinderP pass] -&gt; GenStgExpr pass -&gt; GenStgAlt pass
</span><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-var">GenStgAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097241"><span class="hs-identifier hs-var">sum_bndrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097241"><span class="hs-identifier hs-var">sum_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097242"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseAlts"><span class="hs-identifier hs-var">unariseAlts</span></a></span><span> </span><span id="local-6989586621682097244"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097244"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#MultiValAlt"><span class="hs-identifier hs-type">MultiValAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097245"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097245"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682097246"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097246"><span class="hs-identifier hs-var">alts</span></a></span></span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedSumBndr"><span class="hs-identifier hs-var">isUnboxedSumBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097245"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-687"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097247"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097247"><span class="hs-identifier hs-var">rho_sum_bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097248"><span class="annot"><span class="annottext">scrt_bndrs :: [Id]
</span><a href="#local-6989586621682097248"><span class="hs-identifier hs-var">scrt_bndrs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682097249"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097249"><span class="hs-identifier hs-var">tag_bndr</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682097250"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097250"><span class="hs-identifier hs-var">real_bndrs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseConArgBinder"><span class="hs-identifier hs-var">unariseConArgBinder</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097244"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097245"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-688"></span><span>       </span><span id="local-6989586621682097251"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097251"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
-&gt; [StgArg] -&gt; [GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
</span><a href="GHC.Stg.Unarise.html#unariseSumAlts"><span class="hs-identifier hs-var">unariseSumAlts</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097247"><span class="hs-identifier hs-var">rho_sum_bndrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; StgArg) -&gt; [Id] -&gt; [StgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097250"><span class="hs-identifier hs-var">real_bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097246"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-689"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097252"><span class="annot"><span class="annottext">inner_case :: GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097252"><span class="hs-identifier hs-var hs-var">inner_case</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
-&gt; BinderP 'Vanilla
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
GenStgExpr pass
-&gt; BinderP pass -&gt; AltType -&gt; [GenStgAlt pass] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgCase"><span class="hs-identifier hs-var">StgCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; [StgArg] -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass). Id -&gt; [StgArg] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgApp"><span class="hs-identifier hs-var">StgApp</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097249"><span class="hs-identifier hs-var">tag_bndr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097249"><span class="hs-identifier hs-var">tag_bndr</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="GHC.Stg.Unarise.html#tagAltTy"><span class="hs-identifier hs-var">tagAltTy</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097251"><span class="hs-identifier hs-var">alts'</span></a></span><span>
</span><span id="line-690"></span><span>       </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">alt_con :: AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097248"><span class="hs-identifier hs-var">scrt_bndrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_bndrs :: [BinderP 'Vanilla]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097248"><span class="hs-identifier hs-var">scrt_bndrs</span></a></span><span>
</span><span id="line-692"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_rhs :: GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097252"><span class="hs-identifier hs-var">inner_case</span></a></span><span>
</span><span id="line-693"></span><span>                        </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseAlts"><span class="hs-identifier hs-var">unariseAlts</span></a></span><span> </span><span id="local-6989586621682097253"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097253"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="annot"><span class="annottext">AltType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682097254"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097254"><span class="hs-identifier hs-var">alts</span></a></span></span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla))
-&gt; [GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682097255"><span class="annot"><span class="annottext">GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097255"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseAlt"><span class="hs-identifier hs-var">unariseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097253"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097255"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097254"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-697"></span><span>
</span><span id="line-698"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseAlt"><span class="hs-identifier hs-type">unariseAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span>
</span><span id="line-699"></span><span id="unariseAlt"><span class="annot"><span class="annottext">unariseAlt :: UnariseEnv -&gt; GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseAlt"><span class="hs-identifier hs-var hs-var">unariseAlt</span></a></span></span><span> </span><span id="local-6989586621682097257"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097257"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097258"><span class="annot"><span class="annottext">alt :: GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097258"><span class="hs-identifier hs-var">alt</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">AltCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682097259"><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><a href="#local-6989586621682097259"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682097260"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097260"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-700"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097261"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097261"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097262"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097262"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; [Id] -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseConArgBinders"><span class="hs-identifier hs-var">unariseConArgBinders</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097257"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
</span><a href="#local-6989586621682097259"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-701"></span><span>       </span><span class="hs-glyph">!</span><span id="local-6989586621682097263"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097263"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097261"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097260"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-702"></span><span>       </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla))
-&gt; GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097258"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682097262"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682097263"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="hs-comment">-- | Make alternatives that match on the tag of a sum</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- (i.e. generate LitAlts for the tag)</span><span>
</span><span id="line-708"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseSumAlts"><span class="hs-identifier hs-type">unariseSumAlts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-709"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- sum components _excluding_ the tag bit.</span><span>
</span><span id="line-710"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- original alternative with sum LHS</span><span>
</span><span id="line-711"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-712"></span><span id="unariseSumAlts"><span class="annot"><span class="annottext">unariseSumAlts :: UnariseEnv
-&gt; [StgArg] -&gt; [GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
</span><a href="GHC.Stg.Unarise.html#unariseSumAlts"><span class="hs-identifier hs-var hs-var">unariseSumAlts</span></a></span></span><span> </span><span id="local-6989586621682097265"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097265"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682097266"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097266"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097267"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097267"><span class="hs-identifier hs-var">alts</span></a></span></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682097268"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097268"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla))
-&gt; [GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv
-&gt; [StgArg] -&gt; GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseSumAlt"><span class="hs-identifier hs-var">unariseSumAlt</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097265"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097266"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097267"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-714"></span><span>       </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; UniqSM [GenStgAlt 'Vanilla]
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; [GenStgAlt 'Vanilla]
</span><a href="GHC.Stg.Unarise.html#mkDefaultLitAlt"><span class="hs-identifier hs-var">mkDefaultLitAlt</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097268"><span class="hs-identifier hs-var">alts'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseSumAlt"><span class="hs-identifier hs-type">unariseSumAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-717"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- sum components _excluding_ the tag bit.</span><span>
</span><span id="line-718"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span>   </span><span class="hs-comment">-- original alternative with sum LHS</span><span>
</span><span id="line-719"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span>
</span><span id="line-720"></span><span id="unariseSumAlt"><span class="annot"><span class="annottext">unariseSumAlt :: UnariseEnv
-&gt; [StgArg] -&gt; GenStgAlt 'Vanilla -&gt; UniqSM (GenStgAlt 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseSumAlt"><span class="hs-identifier hs-var hs-var">unariseSumAlt</span></a></span></span><span> </span><span id="local-6989586621682097271"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097271"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682097272"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097272"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon
-&gt; [BinderP 'Vanilla] -&gt; GenStgExpr 'Vanilla -&gt; GenStgAlt 'Vanilla
forall (pass :: StgPass).
AltCon -&gt; [BinderP pass] -&gt; GenStgExpr pass -&gt; GenStgAlt pass
</span><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-var">GenStgAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; GenStgAlt 'Vanilla)
-&gt; UniqSM (GenStgExpr 'Vanilla) -&gt; UniqSM (GenStgAlt 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097271"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097272"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseSumAlt"><span class="hs-identifier hs-var">unariseSumAlt</span></a></span><span> </span><span id="local-6989586621682097273"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097273"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097274"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097274"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097275"><span class="annot"><span class="annottext">alt :: GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097275"><span class="hs-identifier hs-var">alt</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-type">DataAlt</span></a></span><span> </span><span id="local-6989586621682097276"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097276"><span class="hs-identifier hs-var">sumCon</span></a></span></span><span>
</span><span id="line-724"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682097277"><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><a href="#local-6989586621682097277"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-725"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682097278"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097278"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-726"></span><span>                                </span><span class="hs-special">}</span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097279"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097279"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097280"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097280"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><a href="#local-6989586621682097277"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-729"></span><span>              </span><span class="hs-special">[</span><span id="local-6989586621682097281"><span class="annot"><span class="annottext">BinderP 'Vanilla
</span><a href="#local-6989586621682097281"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id
-&gt; [StgArg]
-&gt; GenStgExpr 'Vanilla
-&gt; UnariseEnv
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#mapSumIdBinders"><span class="hs-identifier hs-var">mapSumIdBinders</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097281"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097274"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097278"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097273"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-730"></span><span>              </span><span class="hs-comment">-- Sums must have one binder</span><span>
</span><span id="line-731"></span><span>              </span><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unariseSumAlt2&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097274"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla -&gt; SDoc
forall (pass :: StgPass).
OutputablePass pass =&gt;
GenStgAlt pass -&gt; SDoc
</span><a href="GHC.Stg.Unarise.html#pprPanicAlt"><span class="hs-identifier hs-var">pprPanicAlt</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097275"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097283"><span class="annot"><span class="annottext">lit_case :: AltCon
</span><a href="#local-6989586621682097283"><span class="hs-identifier hs-var hs-var">lit_case</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; AltCon
</span><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Int
</span><a href="GHC.Core.DataCon.html#dataConTag"><span class="hs-identifier hs-var">dataConTag</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097276"><span class="hs-identifier hs-var">sumCon</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>       </span><span class="annot"><span class="annottext">AltCon
-&gt; [BinderP 'Vanilla] -&gt; GenStgExpr 'Vanilla -&gt; GenStgAlt 'Vanilla
forall (pass :: StgPass).
AltCon -&gt; [BinderP pass] -&gt; GenStgExpr pass -&gt; GenStgAlt pass
</span><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-var">GenStgAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682097283"><span class="hs-identifier hs-var">lit_case</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
[BinderP 'Vanilla]
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; GenStgAlt 'Vanilla)
-&gt; UniqSM (GenStgExpr 'Vanilla) -&gt; UniqSM (GenStgAlt 'Vanilla)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; GenStgExpr 'Vanilla -&gt; UniqSM (GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#unariseExpr"><span class="hs-identifier hs-var">unariseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097279"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097280"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseSumAlt"><span class="hs-identifier hs-var">unariseSumAlt</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682097288"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097288"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621682097289"><span class="annot"><span class="annottext">GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097289"><span class="hs-identifier hs-var">alt</span></a></span></span><span>
</span><span id="line-736"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; UniqSM (GenStgAlt 'Vanilla)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unariseSumAlt3&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097288"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla -&gt; SDoc
forall (pass :: StgPass).
OutputablePass pass =&gt;
GenStgAlt pass -&gt; SDoc
</span><a href="GHC.Stg.Unarise.html#pprPanicAlt"><span class="hs-identifier hs-var">pprPanicAlt</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097289"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- Mapping binders when matching und a unboxed sum/tuple</span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mapTupleIdBinders"><span class="hs-identifier hs-type">mapTupleIdBinders</span></a></span><span>
</span><span id="line-742"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#InId"><span class="hs-identifier hs-type">InId</span></a></span><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- Un-processed binders of a tuple alternative.</span><span>
</span><span id="line-743"></span><span>                  </span><span class="hs-comment">-- Can have void binders.</span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Arguments that form the tuple (after unarisation).</span><span>
</span><span id="line-745"></span><span>                  </span><span class="hs-comment">-- Can't have void args.</span><span>
</span><span id="line-746"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-747"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-748"></span><span id="mapTupleIdBinders"><span class="annot"><span class="annottext">mapTupleIdBinders :: [Id] -&gt; [StgArg] -&gt; UnariseEnv -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#mapTupleIdBinders"><span class="hs-identifier hs-var hs-var">mapTupleIdBinders</span></a></span></span><span> </span><span id="local-6989586621682097290"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097290"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621682097291"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097291"><span class="hs-identifier hs-var">args0</span></a></span></span><span> </span><span id="local-6989586621682097292"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097292"><span class="hs-identifier hs-var">rho0</span></a></span></span><span>
</span><span id="line-749"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UnariseEnv -&gt; UnariseEnv
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StgArg -&gt; Bool) -&gt; [StgArg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#any/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Types.RepType.html#isZeroBitTy"><span class="hs-identifier hs-var">isZeroBitTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (StgArg -&gt; Type) -&gt; StgArg -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097291"><span class="hs-identifier hs-var">args0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnariseEnv -&gt; UnariseEnv) -&gt; UnariseEnv -&gt; UnariseEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-750"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-751"></span><span>      </span><span class="annot"><a href="#local-6989586621682097295"><span class="hs-identifier hs-type">ids_unarised</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-752"></span><span>      </span><span id="local-6989586621682097295"><span class="annot"><span class="annottext">ids_unarised :: [(Id, [PrimRep])]
</span><a href="#local-6989586621682097295"><span class="hs-identifier hs-var hs-var">ids_unarised</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; (Id, [PrimRep])) -&gt; [Id] -&gt; [(Id, [PrimRep])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682097296"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097296"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097296"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; [PrimRep]
Type -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097296"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097290"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-753"></span><span>
</span><span id="line-754"></span><span>      </span><span class="annot"><a href="#local-6989586621682097299"><span class="hs-identifier hs-type">map_ids</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-755"></span><span>      </span><span id="local-6989586621682097299"><span class="annot"><span class="annottext">map_ids :: UnariseEnv -&gt; [(Id, [PrimRep])] -&gt; [StgArg] -&gt; UnariseEnv
</span><a href="#local-6989586621682097299"><span class="hs-identifier hs-var hs-var">map_ids</span></a></span></span><span> </span><span id="local-6989586621682097300"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097300"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097300"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-756"></span><span>      </span><span class="annot"><a href="#local-6989586621682097299"><span class="hs-identifier hs-var">map_ids</span></a></span><span> </span><span id="local-6989586621682097301"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097301"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682097302"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097302"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097303"><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682097303"><span class="hs-identifier hs-var">x_reps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682097304"><span class="annot"><span class="annottext">[(Id, [PrimRep])]
</span><a href="#local-6989586621682097304"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097305"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097305"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-757"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-758"></span><span>          </span><span id="local-6989586621682097306"><span class="annot"><span class="annottext">x_arity :: Int
</span><a href="#local-6989586621682097306"><span class="hs-identifier hs-var hs-var">x_arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PrimRep] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682097303"><span class="hs-identifier hs-var">x_reps</span></a></span><span>
</span><span id="line-759"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682097307"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097307"><span class="hs-identifier hs-var">x_args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097308"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097308"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-760"></span><span>            </span><span class="annot"><span class="annottext">Bool
-&gt; (Int -&gt; [StgArg] -&gt; ([StgArg], [StgArg]))
-&gt; Int
-&gt; [StgArg]
-&gt; ([StgArg], [StgArg])
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097305"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg] -&gt; Int -&gt; Bool
forall a. [a] -&gt; Int -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthAtLeast"><span class="hs-operator hs-var">`lengthAtLeast`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097306"><span class="hs-identifier hs-var">x_arity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; [StgArg] -&gt; ([StgArg], [StgArg])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base-4.18.3.0/src/GHC.List.html#splitAt/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097306"><span class="hs-identifier hs-var">x_arity</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097305"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span>          </span><span id="local-6989586621682097311"><span class="annot"><span class="annottext">rho' :: UnariseEnv
</span><a href="#local-6989586621682097311"><span class="hs-identifier hs-var hs-var">rho'</span></a></span></span><span>
</span><span id="line-764"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097306"><span class="hs-identifier hs-var">x_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-765"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv)
-&gt; UnariseEnv
-&gt; Id
-&gt; UnariseVal
-&gt; UnariseEnv
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097307"><span class="hs-identifier hs-var">x_args</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg] -&gt; Int -&gt; Bool
forall a. [a] -&gt; Int -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthIs"><span class="hs-operator hs-var">`lengthIs`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>              </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097301"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097302"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StgArg -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-var">UnaryVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; StgArg
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.List.html#head/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097307"><span class="hs-identifier hs-var">x_args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-768"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097301"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097302"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097307"><span class="hs-identifier hs-var">x_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-770"></span><span>          </span><span class="annot"><span class="annottext">UnariseEnv -&gt; [(Id, [PrimRep])] -&gt; [StgArg] -&gt; UnariseEnv
</span><a href="#local-6989586621682097299"><span class="hs-identifier hs-var">map_ids</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097311"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Id, [PrimRep])]
</span><a href="#local-6989586621682097304"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097308"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-771"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-772"></span><span>      </span><span class="annot"><span class="annottext">UnariseEnv -&gt; [(Id, [PrimRep])] -&gt; [StgArg] -&gt; UnariseEnv
</span><a href="#local-6989586621682097299"><span class="hs-identifier hs-var">map_ids</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097292"><span class="hs-identifier hs-var">rho0</span></a></span><span> </span><span class="annot"><span class="annottext">[(Id, [PrimRep])]
</span><a href="#local-6989586621682097295"><span class="hs-identifier hs-var">ids_unarised</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097291"><span class="hs-identifier hs-var">args0</span></a></span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mapSumIdBinders"><span class="hs-identifier hs-type">mapSumIdBinders</span></a></span><span>
</span><span id="line-775"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#InId"><span class="hs-identifier hs-type">InId</span></a></span><span>        </span><span class="hs-comment">-- Binder (in the case alternative).</span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Arguments that form the sum (NOT including the tag).</span><span>
</span><span id="line-777"></span><span>                 </span><span class="hs-comment">-- Can't have void args.</span><span>
</span><span id="line-778"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#InStgExpr"><span class="hs-identifier hs-type">InStgExpr</span></a></span><span>
</span><span id="line-779"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span>
</span><span id="line-780"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgExpr"><span class="hs-identifier hs-type">OutStgExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span id="mapSumIdBinders"><span class="annot"><span class="annottext">mapSumIdBinders :: Id
-&gt; [StgArg]
-&gt; GenStgExpr 'Vanilla
-&gt; UnariseEnv
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#mapSumIdBinders"><span class="hs-identifier hs-var hs-var">mapSumIdBinders</span></a></span></span><span> </span><span id="local-6989586621682097314"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097314"><span class="hs-identifier hs-var">alt_bndr</span></a></span></span><span> </span><span id="local-6989586621682097315"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097315"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682097316"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097316"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621682097317"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097317"><span class="hs-identifier hs-var">rho0</span></a></span></span><span>
</span><span id="line-783"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StgArg -&gt; Bool) -&gt; [StgArg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#any/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Types.RepType.html#isZeroBitTy"><span class="hs-identifier hs-var">isZeroBitTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (StgArg -&gt; Type) -&gt; StgArg -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097315"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
 -&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla))
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-784"></span><span>    </span><span id="local-6989586621682097318"><span class="annot"><span class="annottext">[UniqSupply]
</span><a href="#local-6989586621682097318"><span class="hs-identifier hs-var">uss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; [UniqSupply]
</span><a href="GHC.Types.Unique.Supply.html#listSplitUniqSupply"><span class="hs-identifier hs-var">listSplitUniqSupply</span></a></span><span> </span><span class="annot"><span class="annottext">(UniqSupply -&gt; [UniqSupply])
-&gt; UniqSM UniqSupply -&gt; UniqSM [UniqSupply]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSM UniqSupply
forall (m :: * -&gt; *). MonadUnique m =&gt; m UniqSupply
</span><a href="GHC.Types.Unique.Supply.html#getUniqueSupplyM"><span class="hs-identifier hs-var">getUniqueSupplyM</span></a></span><span>
</span><span id="line-785"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-786"></span><span>      </span><span id="local-6989586621682097320"><span class="annot"><span class="annottext">fld_reps :: [PrimRep]
</span><a href="#local-6989586621682097320"><span class="hs-identifier hs-var hs-var">fld_reps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; [PrimRep]
Type -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097314"><span class="hs-identifier hs-var">alt_bndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span>      </span><span class="hs-comment">-- Slots representing the whole sum</span><span>
</span><span id="line-789"></span><span>      </span><span id="local-6989586621682097321"><span class="annot"><span class="annottext">arg_slots :: [SlotTy]
</span><a href="#local-6989586621682097321"><span class="hs-identifier hs-var hs-var">arg_slots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrimRep -&gt; SlotTy) -&gt; [PrimRep] -&gt; [SlotTy]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; SlotTy
</span><a href="GHC.Types.RepType.html#primRepSlot"><span class="hs-identifier hs-var">primRepSlot</span></a></span><span> </span><span class="annot"><span class="annottext">([PrimRep] -&gt; [SlotTy]) -&gt; [PrimRep] -&gt; [SlotTy]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(StgArg -&gt; [PrimRep]) -&gt; [StgArg] -&gt; [PrimRep]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; [PrimRep]
Type -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [PrimRep]) -&gt; (StgArg -&gt; Type) -&gt; StgArg -&gt; [PrimRep]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097315"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-790"></span><span>      </span><span class="hs-comment">-- The slots representing the field of the sum we bind.</span><span>
</span><span id="line-791"></span><span>      </span><span id="local-6989586621682097324"><span class="annot"><span class="annottext">id_slots :: [SlotTy]
</span><a href="#local-6989586621682097324"><span class="hs-identifier hs-var hs-var">id_slots</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrimRep -&gt; SlotTy) -&gt; [PrimRep] -&gt; [SlotTy]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; SlotTy
</span><a href="GHC.Types.RepType.html#primRepSlot"><span class="hs-identifier hs-var">primRepSlot</span></a></span><span> </span><span class="annot"><span class="annottext">([PrimRep] -&gt; [SlotTy]) -&gt; [PrimRep] -&gt; [SlotTy]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682097320"><span class="hs-identifier hs-var">fld_reps</span></a></span><span>
</span><span id="line-792"></span><span>      </span><span id="local-6989586621682097325"><span class="annot"><span class="annottext">layout1 :: [Int]
</span><a href="#local-6989586621682097325"><span class="hs-identifier hs-var hs-var">layout1</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SlotTy] -&gt; [SlotTy] -&gt; [Int]
(() :: Constraint) =&gt; [SlotTy] -&gt; [SlotTy] -&gt; [Int]
</span><a href="GHC.Types.RepType.html#layoutUbxSum"><span class="hs-identifier hs-var">layoutUbxSum</span></a></span><span> </span><span class="annot"><span class="annottext">[SlotTy]
</span><a href="#local-6989586621682097321"><span class="hs-identifier hs-var">arg_slots</span></a></span><span> </span><span class="annot"><span class="annottext">[SlotTy]
</span><a href="#local-6989586621682097324"><span class="hs-identifier hs-var">id_slots</span></a></span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span>      </span><span class="hs-comment">-- See Note [Casting slot arguments]</span><span>
</span><span id="line-795"></span><span>      </span><span class="hs-comment">-- Most of the code here is just to make sure our binders are of the</span><span>
</span><span id="line-796"></span><span>      </span><span class="hs-comment">-- right type.</span><span>
</span><span id="line-797"></span><span>      </span><span class="hs-comment">-- Select only the args which contain parts of the current field.</span><span>
</span><span id="line-798"></span><span>      </span><span id="local-6989586621682097327"><span class="annot"><span class="annottext">id_arg_exprs :: [StgArg]
</span><a href="#local-6989586621682097327"><span class="hs-identifier hs-var hs-var">id_arg_exprs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097315"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg] -&gt; Int -&gt; StgArg
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.List.html#%21%21/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097329"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682097329"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097329"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682097325"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-799"></span><span>      </span><span id="local-6989586621682097330"><span class="annot"><span class="annottext">id_vars :: [Id]
</span><a href="#local-6989586621682097330"><span class="hs-identifier hs-var hs-var">id_vars</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097331"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-type">StgVarArg</span></a></span><span> </span><span id="local-6989586621682097331"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097331"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097327"><span class="hs-identifier hs-var">id_arg_exprs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-800"></span><span>      </span><span class="hs-comment">-- Output types for the field binders based on their rep</span><span>
</span><span id="line-801"></span><span>      </span><span id="local-6989586621682097332"><span class="annot"><span class="annottext">id_tys :: [Type]
</span><a href="#local-6989586621682097332"><span class="hs-identifier hs-var hs-var">id_tys</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrimRep -&gt; Type) -&gt; [PrimRep] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; Type
</span><a href="GHC.Types.RepType.html#primRepToType"><span class="hs-identifier hs-var">primRepToType</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682097320"><span class="hs-identifier hs-var">fld_reps</span></a></span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span>      </span><span id="local-6989586621682097334"><span class="annot"><span class="annottext">typed_id_arg_input :: [(Id, Type, UniqSupply)]
</span><a href="#local-6989586621682097334"><span class="hs-identifier hs-var hs-var">typed_id_arg_input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [(Id, Type, UniqSupply)] -&gt; [(Id, Type, UniqSupply)]
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [Type] -&gt; Bool
forall a b. [a] -&gt; [b] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#equalLength"><span class="hs-identifier hs-var">equalLength</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097330"><span class="hs-identifier hs-var">id_vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097332"><span class="hs-identifier hs-var">id_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Id, Type, UniqSupply)] -&gt; [(Id, Type, UniqSupply)])
-&gt; [(Id, Type, UniqSupply)] -&gt; [(Id, Type, UniqSupply)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-804"></span><span>                           </span><span class="annot"><span class="annottext">[Id] -&gt; [Type] -&gt; [UniqSupply] -&gt; [(Id, Type, UniqSupply)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#zip3/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097330"><span class="hs-identifier hs-var">id_vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097332"><span class="hs-identifier hs-var">id_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[UniqSupply]
</span><a href="#local-6989586621682097318"><span class="hs-identifier hs-var">uss</span></a></span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span>      </span><span class="annot"><a href="#local-6989586621682097337"><span class="hs-identifier hs-type">mkCastInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>      </span><span id="local-6989586621682097337"><span class="annot"><span class="annottext">mkCastInput :: (Id, Type, UniqSupply) -&gt; ([(PrimOp, Type, Unique)], Id, Id)
</span><a href="#local-6989586621682097337"><span class="hs-identifier hs-var hs-var">mkCastInput</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097338"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097338"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097339"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097339"><span class="hs-identifier hs-var">tar_type</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097340"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097340"><span class="hs-identifier hs-var">bndr_us</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-808"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097341"><span class="annot"><span class="annottext">[PrimOp]
</span><a href="#local-6989586621682097341"><span class="hs-identifier hs-var">ops</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097342"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097342"><span class="hs-identifier hs-var">types</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type)] -&gt; ([PrimOp], [Type])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../base-4.18.3.0/src/GHC.List.html#unzip/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(PrimOp, Type)] -&gt; ([PrimOp], [Type]))
-&gt; [(PrimOp, Type)] -&gt; ([PrimOp], [Type])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; PrimRep -&gt; [(PrimOp, Type)]
</span><a href="GHC.Builtin.PrimOps.Casts.html#getCasts"><span class="hs-identifier hs-var">getCasts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; PrimRep
Type -&gt; PrimRep
</span><a href="GHC.Types.RepType.html#typePrimRep1"><span class="hs-identifier hs-var">typePrimRep1</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; PrimRep) -&gt; Type -&gt; PrimRep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097338"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; PrimRep
Type -&gt; PrimRep
</span><a href="GHC.Types.RepType.html#typePrimRep1"><span class="hs-identifier hs-var">typePrimRep1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097339"><span class="hs-identifier hs-var">tar_type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>            </span><span id="local-6989586621682097346"><span class="annot"><span class="annottext">cst_opts :: [(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097346"><span class="hs-identifier hs-var hs-var">cst_opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PrimOp] -&gt; [Type] -&gt; [Unique] -&gt; [(PrimOp, Type, Unique)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#zip3/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimOp]
</span><a href="#local-6989586621682097341"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097342"><span class="hs-identifier hs-var">types</span></a></span><span> </span><span class="annot"><span class="annottext">([Unique] -&gt; [(PrimOp, Type, Unique)])
-&gt; [Unique] -&gt; [(PrimOp, Type, Unique)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; [Unique]
</span><a href="GHC.Types.Unique.Supply.html#uniqsFromSupply"><span class="hs-identifier hs-var">uniqsFromSupply</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097340"><span class="hs-identifier hs-var">bndr_us</span></a></span><span>
</span><span id="line-810"></span><span>            </span><span id="local-6989586621682097348"><span class="annot"><span class="annottext">out_id :: Id
</span><a href="#local-6989586621682097348"><span class="hs-identifier hs-var hs-var">out_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097346"><span class="hs-identifier hs-var">cst_opts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-811"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097338"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-812"></span><span>              </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682097349"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097349"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097350"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682097350"><span class="hs-identifier hs-var">uq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)] -&gt; (PrimOp, Type, Unique)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.List.html#last/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097346"><span class="hs-identifier hs-var">cst_opts</span></a></span><span>
</span><span id="line-813"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Id
</span><a href="GHC.Stg.Unarise.html#mkCastVar"><span class="hs-identifier hs-var">mkCastVar</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682097350"><span class="hs-identifier hs-var">uq</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097349"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-814"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097346"><span class="hs-identifier hs-var">cst_opts</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097338"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097348"><span class="hs-identifier hs-var">out_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span>      </span><span id="local-6989586621682097353"><span class="annot"><span class="annottext">cast_inputs :: [([(PrimOp, Type, Unique)], Id, Id)]
</span><a href="#local-6989586621682097353"><span class="hs-identifier hs-var hs-var">cast_inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Id, Type, UniqSupply) -&gt; ([(PrimOp, Type, Unique)], Id, Id))
-&gt; [(Id, Type, UniqSupply)] -&gt; [([(PrimOp, Type, Unique)], Id, Id)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Id, Type, UniqSupply) -&gt; ([(PrimOp, Type, Unique)], Id, Id)
</span><a href="#local-6989586621682097337"><span class="hs-identifier hs-var">mkCastInput</span></a></span><span> </span><span class="annot"><span class="annottext">[(Id, Type, UniqSupply)]
</span><a href="#local-6989586621682097334"><span class="hs-identifier hs-var">typed_id_arg_input</span></a></span><span>
</span><span id="line-817"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682097354"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097354"><span class="hs-identifier hs-var">rhs_with_casts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097355"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097355"><span class="hs-identifier hs-var">typed_ids</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
 -&gt; ([(PrimOp, Type, Unique)], Id, Id)
 -&gt; (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla, Id))
-&gt; (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; [([(PrimOp, Type, Unique)], Id, Id)]
-&gt; (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla, [Id])
forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapAccumL/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; ([(PrimOp, Type, Unique)], Id, Id)
-&gt; (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla, Id)
forall {c} {b}.
(GenStgExpr 'Vanilla -&gt; c)
-&gt; ([(PrimOp, Type, Unique)], Id, b)
-&gt; (GenStgExpr 'Vanilla -&gt; c, b)
</span><a href="#local-6989586621682097356"><span class="hs-identifier hs-var">cast_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682097357"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097357"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097357"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([(PrimOp, Type, Unique)], Id, Id)]
</span><a href="#local-6989586621682097353"><span class="hs-identifier hs-var">cast_inputs</span></a></span><span>
</span><span id="line-818"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-819"></span><span>          </span><span id="local-6989586621682097356"><span class="annot"><span class="annottext">cast_arg :: (GenStgExpr 'Vanilla -&gt; c)
-&gt; ([(PrimOp, Type, Unique)], Id, b)
-&gt; (GenStgExpr 'Vanilla -&gt; c, b)
</span><a href="#local-6989586621682097356"><span class="hs-identifier hs-var hs-var">cast_arg</span></a></span></span><span> </span><span id="local-6989586621682097358"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; c
</span><a href="#local-6989586621682097358"><span class="hs-identifier hs-var">rhs_in</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097359"><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097359"><span class="hs-identifier hs-var">cast_ops</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097360"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097360"><span class="hs-identifier hs-var">in_id</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097361"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682097361"><span class="hs-identifier hs-var">out_id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-820"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097362"><span class="annot"><span class="annottext">rhs_out :: GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097362"><span class="hs-identifier hs-var hs-var">rhs_out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
-&gt; StgArg -&gt; GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#castArgRename"><span class="hs-identifier hs-var">castArgRename</span></a></span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097359"><span class="hs-identifier hs-var">cast_ops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097360"><span class="hs-identifier hs-var">in_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; c
</span><a href="#local-6989586621682097358"><span class="hs-identifier hs-var">rhs_in</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; c)
-&gt; (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; GenStgExpr 'Vanilla
-&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097362"><span class="hs-identifier hs-var">rhs_out</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682097361"><span class="hs-identifier hs-var">out_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>
</span><span id="line-823"></span><span>      </span><span id="local-6989586621682097364"><span class="annot"><span class="annottext">typed_id_args :: [StgArg]
</span><a href="#local-6989586621682097364"><span class="hs-identifier hs-var hs-var">typed_id_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; StgArg) -&gt; [Id] -&gt; [StgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097355"><span class="hs-identifier hs-var">typed_ids</span></a></span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span>      </span><span class="hs-comment">-- pprTrace &quot;mapSumIdBinders&quot;</span><span>
</span><span id="line-826"></span><span>      </span><span class="hs-comment">--           (text &quot;id_tys&quot; &lt;+&gt; ppr id_tys $$</span><span>
</span><span id="line-827"></span><span>      </span><span class="hs-comment">--           text &quot;id_args&quot; &lt;+&gt; ppr id_arg_exprs $$</span><span>
</span><span id="line-828"></span><span>      </span><span class="hs-comment">--           text &quot;rhs&quot; &lt;+&gt; ppr rhs $$</span><span>
</span><span id="line-829"></span><span>      </span><span class="hs-comment">--           text &quot;rhs_with_casts&quot; &lt;+&gt; ppr rhs_with_casts</span><span>
</span><span id="line-830"></span><span>      </span><span class="hs-comment">--           ) $</span><span>
</span><span id="line-831"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isMultiValBndr"><span class="hs-identifier hs-var">isMultiValBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097314"><span class="hs-identifier hs-var">alt_bndr</span></a></span><span>
</span><span id="line-832"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097317"><span class="hs-identifier hs-var">rho0</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097314"><span class="hs-identifier hs-var">alt_bndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097364"><span class="hs-identifier hs-var">typed_id_args</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097354"><span class="hs-identifier hs-var">rhs_with_casts</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097316"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097364"><span class="hs-identifier hs-var">typed_id_args</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg] -&gt; Int -&gt; Bool
forall a. [a] -&gt; Int -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthIs"><span class="hs-operator hs-var">`lengthIs`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
 -&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla))
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-834"></span><span>            </span><span class="annot"><span class="annottext">(UnariseEnv, GenStgExpr 'Vanilla)
-&gt; UniqSM (UnariseEnv, GenStgExpr 'Vanilla)
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097317"><span class="hs-identifier hs-var">rho0</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097314"><span class="hs-identifier hs-var">alt_bndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StgArg -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-var">UnaryVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; StgArg
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.List.html#head/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097364"><span class="hs-identifier hs-var">typed_id_args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097354"><span class="hs-identifier hs-var">rhs_with_casts</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097316"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span class="hs-comment">-- Convert the argument to the given type, and wrap the conversion</span><span>
</span><span id="line-837"></span><span class="hs-comment">-- around the given expression. Use the given Id as a name for the</span><span>
</span><span id="line-838"></span><span class="hs-comment">-- converted value.</span><span>
</span><span id="line-839"></span><span class="annot"><a href="GHC.Stg.Unarise.html#castArgRename"><span class="hs-identifier hs-type">castArgRename</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span>
</span><span id="line-840"></span><span id="castArgRename"><span class="annot"><span class="annottext">castArgRename :: [(PrimOp, Type, Unique)]
-&gt; StgArg -&gt; GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#castArgRename"><span class="hs-identifier hs-var hs-var">castArgRename</span></a></span></span><span> </span><span id="local-6989586621682097366"><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097366"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621682097367"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097367"><span class="hs-identifier hs-var">in_arg</span></a></span></span><span> </span><span id="local-6989586621682097368"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097368"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-841"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097366"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-842"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097368"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-843"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682097369"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682097369"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097370"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097370"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097371"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682097371"><span class="hs-identifier hs-var">uq</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682097372"><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097372"><span class="hs-identifier hs-var">rest_ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-844"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097373"><span class="annot"><span class="annottext">out_id' :: Id
</span><a href="#local-6989586621682097373"><span class="hs-identifier hs-var hs-var">out_id'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Id
</span><a href="GHC.Stg.Unarise.html#mkCastVar"><span class="hs-identifier hs-var">mkCastVar</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682097371"><span class="hs-identifier hs-var">uq</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097370"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-comment">-- out_name `setIdUnique` uq `setIdType` ty</span><span>
</span><span id="line-845"></span><span>          </span><span id="local-6989586621682097374"><span class="annot"><span class="annottext">sub_cast :: GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097374"><span class="hs-identifier hs-var hs-var">sub_cast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
-&gt; StgArg -&gt; GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#castArgRename"><span class="hs-identifier hs-var">castArgRename</span></a></span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097372"><span class="hs-identifier hs-var">rest_ops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097373"><span class="hs-identifier hs-var">out_id'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">StgArg
-&gt; PrimOp
-&gt; Id
-&gt; Type
-&gt; GenStgExpr 'Vanilla
-&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#mkCast"><span class="hs-identifier hs-var">mkCast</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097367"><span class="hs-identifier hs-var">in_arg</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682097369"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097373"><span class="hs-identifier hs-var">out_id'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097370"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097374"><span class="hs-identifier hs-var">sub_cast</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097368"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-847"></span><span>
</span><span id="line-848"></span><span class="hs-comment">-- Construct a case binder used when casting sums, of a given type and unique.</span><span>
</span><span id="line-849"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkCastVar"><span class="hs-identifier hs-type">mkCastVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-850"></span><span id="mkCastVar"><span class="annot"><span class="annottext">mkCastVar :: Unique -&gt; Type -&gt; Id
</span><a href="GHC.Stg.Unarise.html#mkCastVar"><span class="hs-identifier hs-var hs-var">mkCastVar</span></a></span></span><span> </span><span id="local-6989586621682097376"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682097376"><span class="hs-identifier hs-var">uq</span></a></span></span><span> </span><span id="local-6989586621682097377"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097377"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Unique -&gt; Type -&gt; Type -&gt; Id
</span><a href="GHC.Types.Id.html#mkSysLocal"><span class="hs-identifier hs-var">mkSysLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cst_sum&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682097376"><span class="hs-identifier hs-var">uq</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097377"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkCast"><span class="hs-identifier hs-type">mkCast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#OutId"><span class="hs-identifier hs-type">OutId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span>
</span><span id="line-853"></span><span id="mkCast"><span class="annot"><span class="annottext">mkCast :: StgArg
-&gt; PrimOp
-&gt; Id
-&gt; Type
-&gt; GenStgExpr 'Vanilla
-&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#mkCast"><span class="hs-identifier hs-var hs-var">mkCast</span></a></span></span><span> </span><span id="local-6989586621682097381"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097381"><span class="hs-identifier hs-var">arg_in</span></a></span></span><span> </span><span id="local-6989586621682097382"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682097382"><span class="hs-identifier hs-var">cast_op</span></a></span></span><span> </span><span id="local-6989586621682097383"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097383"><span class="hs-identifier hs-var">out_id</span></a></span></span><span> </span><span id="local-6989586621682097384"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097384"><span class="hs-identifier hs-var">out_ty</span></a></span></span><span> </span><span id="local-6989586621682097385"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097385"><span class="hs-identifier hs-var">in_rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-854"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682097386"><span class="annot"><span class="annottext">r2 :: PrimRep
</span><a href="#local-6989586621682097386"><span class="hs-identifier hs-var hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; PrimRep
Type -&gt; PrimRep
</span><a href="GHC.Types.RepType.html#typePrimRep1"><span class="hs-identifier hs-var">typePrimRep1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097384"><span class="hs-identifier hs-var">out_ty</span></a></span><span>
</span><span id="line-855"></span><span>      </span><span id="local-6989586621682097387"><span class="annot"><span class="annottext">scrut :: GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097387"><span class="hs-identifier hs-var hs-var">scrut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StgOp -&gt; [StgArg] -&gt; Type -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
StgOp -&gt; [StgArg] -&gt; Type -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgOpApp"><span class="hs-identifier hs-var">StgOpApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; StgOp
</span><a href="GHC.Stg.Syntax.html#StgPrimOp"><span class="hs-identifier hs-var">StgPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682097382"><span class="hs-identifier hs-var">cast_op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097381"><span class="hs-identifier hs-var">arg_in</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097384"><span class="hs-identifier hs-var">out_ty</span></a></span><span>
</span><span id="line-856"></span><span>      </span><span id="local-6989586621682097389"><span class="annot"><span class="annottext">alt :: GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097389"><span class="hs-identifier hs-var hs-var">alt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">alt_con :: AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_bndrs :: [BinderP 'Vanilla]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_rhs :: GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097385"><span class="hs-identifier hs-var">in_rhs</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-857"></span><span>      </span><span id="local-6989586621682097390"><span class="annot"><span class="annottext">alt_ty :: AltType
</span><a href="#local-6989586621682097390"><span class="hs-identifier hs-var hs-var">alt_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; AltType
</span><a href="GHC.Stg.Syntax.html#PrimAlt"><span class="hs-identifier hs-var">PrimAlt</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682097386"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-858"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
-&gt; BinderP 'Vanilla
-&gt; AltType
-&gt; [GenStgAlt 'Vanilla]
-&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
GenStgExpr pass
-&gt; BinderP pass -&gt; AltType -&gt; [GenStgAlt pass] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgCase"><span class="hs-identifier hs-var">StgCase</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097387"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">Id
BinderP 'Vanilla
</span><a href="#local-6989586621682097383"><span class="hs-identifier hs-var">out_id</span></a></span><span> </span><span class="annot"><span class="annottext">AltType
</span><a href="#local-6989586621682097390"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097389"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="hs-comment">-- | Build a unboxed sum term from arguments of an alternative.</span><span>
</span><span id="line-861"></span><span class="hs-comment">--</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- Example, for (# x | #) :: (# (# #) | Int #) we call</span><span>
</span><span id="line-863"></span><span class="hs-comment">--</span><span>
</span><span id="line-864"></span><span class="hs-comment">--   mkUbxSum (# _ | #) [ (# #), Int ] [ voidPrimId ]</span><span>
</span><span id="line-865"></span><span class="hs-comment">--</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- which returns</span><span>
</span><span id="line-867"></span><span class="hs-comment">--</span><span>
</span><span id="line-868"></span><span class="hs-comment">--   [ 1#, rubbish ]</span><span>
</span><span id="line-869"></span><span class="hs-comment">--</span><span>
</span><span id="line-870"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkUbxSum"><span class="hs-identifier hs-type">mkUbxSum</span></a></span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span>
</span><span id="line-872"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span>      </span><span class="hs-comment">-- Sum data con</span><span>
</span><span id="line-873"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- Type arguments of the sum data con</span><span>
</span><span id="line-874"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Actual arguments of the alternative.</span><span>
</span><span id="line-875"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span>
</span><span id="line-876"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Final tuple arguments</span><span>
</span><span id="line-877"></span><span>     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- We might need to cast the args first</span><span>
</span><span id="line-878"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span id="mkUbxSum"><span class="annot"><span class="annottext">mkUbxSum :: (() :: Constraint) =&gt;
DataCon
-&gt; [Type]
-&gt; [StgArg]
-&gt; UniqSupply
-&gt; ([StgArg], GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
</span><a href="GHC.Stg.Unarise.html#mkUbxSum"><span class="hs-identifier hs-var hs-var">mkUbxSum</span></a></span></span><span> </span><span id="local-6989586621682097421"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097421"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span id="local-6989586621682097422"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097422"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span> </span><span id="local-6989586621682097423"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097423"><span class="hs-identifier hs-var">args0</span></a></span></span><span> </span><span id="local-6989586621682097424"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097424"><span class="hs-identifier hs-var">us</span></a></span></span><span>
</span><span id="line-880"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-881"></span><span>      </span><span class="annot"><span class="annottext">SlotTy
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#%3A%7C/GHC.Base.html#%3A%7C"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621682097426"><span class="annot"><span class="annottext">[SlotTy]
</span><a href="#local-6989586621682097426"><span class="hs-identifier hs-var">sum_slots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[PrimRep]] -&gt; NonEmpty SlotTy
</span><a href="GHC.Types.RepType.html#ubxSumRepType"><span class="hs-identifier hs-var">ubxSumRepType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; [PrimRep]) -&gt; [Type] -&gt; [[PrimRep]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; [PrimRep]
Type -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097422"><span class="hs-identifier hs-var">ty_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span>      </span><span class="hs-comment">-- drop tag slot</span><span>
</span><span id="line-883"></span><span>      </span><span id="local-6989586621682097428"><span class="annot"><span class="annottext">field_slots :: [SlotTy]
</span><a href="#local-6989586621682097428"><span class="hs-identifier hs-var hs-var">field_slots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StgArg -&gt; Maybe SlotTy) -&gt; [StgArg] -&gt; [SlotTy]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/Data.Maybe.html#mapMaybe/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Maybe SlotTy
</span><a href="GHC.Types.RepType.html#typeSlotTy"><span class="hs-identifier hs-var">typeSlotTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe SlotTy)
-&gt; (StgArg -&gt; Type) -&gt; StgArg -&gt; Maybe SlotTy
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097423"><span class="hs-identifier hs-var">args0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-884"></span><span>      </span><span id="local-6989586621682097430"><span class="annot"><span class="annottext">tag :: Int
</span><a href="#local-6989586621682097430"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Int
</span><a href="GHC.Core.DataCon.html#dataConTag"><span class="hs-identifier hs-var">dataConTag</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682097421"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-885"></span><span>      </span><span id="local-6989586621682097431"><span class="annot"><span class="annottext">layout' :: [Int]
</span><a href="#local-6989586621682097431"><span class="hs-identifier hs-var hs-var">layout'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SlotTy] -&gt; [SlotTy] -&gt; [Int]
(() :: Constraint) =&gt; [SlotTy] -&gt; [SlotTy] -&gt; [Int]
</span><a href="GHC.Types.RepType.html#layoutUbxSum"><span class="hs-identifier hs-var">layoutUbxSum</span></a></span><span> </span><span class="annot"><span class="annottext">[SlotTy]
</span><a href="#local-6989586621682097426"><span class="hs-identifier hs-var">sum_slots</span></a></span><span> </span><span class="annot"><span class="annottext">[SlotTy]
</span><a href="#local-6989586621682097428"><span class="hs-identifier hs-var">field_slots</span></a></span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span>      </span><span id="local-6989586621682097432"><span class="annot"><span class="annottext">tag_arg :: StgArg
</span><a href="#local-6989586621682097432"><span class="hs-identifier hs-var hs-var">tag_arg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-var">StgLitArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097430"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>      </span><span id="local-6989586621682097433"><span class="annot"><span class="annottext">arg_idxs :: IntMap StgArg
</span><a href="#local-6989586621682097433"><span class="hs-identifier hs-var hs-var">arg_idxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, StgArg)] -&gt; IntMap StgArg
forall a. [(Int, a)] -&gt; IntMap a
</span><a href="../../containers-0.6.7/src/Data.IntMap.Internal.html#fromList/Data.IntMap.Internal.html#fromList"><span class="hs-identifier hs-var">IM.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [Int] -&gt; [StgArg] -&gt; [(Int, StgArg)]
forall a b. (() :: Constraint) =&gt; String -&gt; [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="GHC.Utils.Misc.html#zipEqual"><span class="hs-identifier hs-var">zipEqual</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkUbxSum&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621682097431"><span class="hs-identifier hs-var">layout'</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097423"><span class="hs-identifier hs-var">args0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682097436"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097436"><span class="hs-identifier hs-var">_idx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097437"><span class="annot"><span class="annottext">IntMap StgArg
</span><a href="#local-6989586621682097437"><span class="hs-identifier hs-var">_idx_map</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097438"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097438"><span class="hs-identifier hs-var">_us</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097439"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097439"><span class="hs-identifier hs-var">wrapper</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621682097440"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097440"><span class="hs-identifier hs-var">slot_args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ((Int, IntMap StgArg, UniqSupply,
     GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
    [StgArg])
-&gt; ((Int, IntMap StgArg, UniqSupply,
     GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
    [StgArg])
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap StgArg -&gt; Int
forall a. IntMap a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap StgArg
</span><a href="#local-6989586621682097433"><span class="hs-identifier hs-var">arg_idxs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">[SlotTy] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[SlotTy]
</span><a href="#local-6989586621682097426"><span class="hs-identifier hs-var">sum_slots</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, IntMap StgArg, UniqSupply,
   GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
  [StgArg])
 -&gt; ((Int, IntMap StgArg, UniqSupply,
      GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
     [StgArg]))
-&gt; ((Int, IntMap StgArg, UniqSupply,
     GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
    [StgArg])
-&gt; ((Int, IntMap StgArg, UniqSupply,
     GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
    [StgArg])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-892"></span><span>          </span><span class="annot"><span class="annottext">((Int, IntMap StgArg, UniqSupply,
  GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
 -&gt; SlotTy
 -&gt; ((Int, IntMap StgArg, UniqSupply,
      GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
     StgArg))
-&gt; (Int, IntMap StgArg, UniqSupply,
    GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; [SlotTy]
-&gt; ((Int, IntMap StgArg, UniqSupply,
     GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
    [StgArg])
forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapAccumL/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, IntMap StgArg, UniqSupply,
 GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; SlotTy
-&gt; ((Int, IntMap StgArg, UniqSupply,
     GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
    StgArg)
</span><a href="#local-6989586621682097442"><span class="hs-identifier hs-var">mkTupArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IntMap StgArg
</span><a href="#local-6989586621682097433"><span class="hs-identifier hs-var">arg_idxs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097424"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
forall a. a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#id/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SlotTy]
</span><a href="#local-6989586621682097426"><span class="hs-identifier hs-var">sum_slots</span></a></span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span>      </span><span class="annot"><a href="#local-6989586621682097442"><span class="hs-identifier hs-type">mkTupArg</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.6.7/src/Data.IntMap.Internal.html#IntMap/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IM.IntMap</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html#SlotTy"><span class="hs-identifier hs-type">SlotTy</span></a></span><span>
</span><span id="line-896"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><a href="../../containers-0.6.7/src/Data.IntMap.Internal.html#IntMap/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IM.IntMap</span></a></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-897"></span><span>      </span><span id="local-6989586621682097442"><span class="annot"><span class="annottext">mkTupArg :: (Int, IntMap StgArg, UniqSupply,
 GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; SlotTy
-&gt; ((Int, IntMap StgArg, UniqSupply,
     GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla),
    StgArg)
</span><a href="#local-6989586621682097442"><span class="hs-identifier hs-var hs-var">mkTupArg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097444"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097444"><span class="hs-identifier hs-var">arg_idx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097445"><span class="annot"><span class="annottext">IntMap StgArg
</span><a href="#local-6989586621682097445"><span class="hs-identifier hs-var">arg_map</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097446"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097446"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097447"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097447"><span class="hs-identifier hs-var">wrapper</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682097448"><span class="annot"><span class="annottext">SlotTy
</span><a href="#local-6989586621682097448"><span class="hs-identifier hs-var">slot</span></a></span></span><span>
</span><span id="line-898"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682097449"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097449"><span class="hs-identifier hs-var">stg_arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap StgArg -&gt; Maybe StgArg
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><a href="../../containers-0.6.7/src/Data.IntMap.Internal.html#lookup/Data.IntMap.Internal.html#lookup"><span class="hs-identifier hs-var">IM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097444"><span class="hs-identifier hs-var">arg_idx</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap StgArg
</span><a href="#local-6989586621682097445"><span class="hs-identifier hs-var">arg_map</span></a></span><span>
</span><span id="line-899"></span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UniqSupply
-&gt; SlotTy
-&gt; StgArg
-&gt; Maybe
     (StgArg, UniqSupply, GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
</span><a href="#local-6989586621682097451"><span class="hs-identifier hs-var">castArg</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097446"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="#local-6989586621682097448"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097449"><span class="hs-identifier hs-var">stg_arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-900"></span><span>              </span><span class="hs-comment">-- Slot and arg type missmatched, do a cast</span><span>
</span><span id="line-901"></span><span>              </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097452"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097452"><span class="hs-identifier hs-var">casted_arg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097453"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097453"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097454"><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097454"><span class="hs-identifier hs-var">wrapper'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-902"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097444"><span class="hs-identifier hs-var">arg_idx</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap StgArg
</span><a href="#local-6989586621682097445"><span class="hs-identifier hs-var">arg_map</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097453"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097447"><span class="hs-identifier hs-var">wrapper</span></a></span><span> </span><span class="annot"><span class="annottext">(GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; (GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; GenStgExpr 'Vanilla
-&gt; GenStgExpr 'Vanilla
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097454"><span class="hs-identifier hs-var">wrapper'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097452"><span class="hs-identifier hs-var">casted_arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>              </span><span class="hs-comment">-- Use the arg as-is</span><span>
</span><span id="line-905"></span><span>              </span><span class="annot"><span class="annottext">Maybe
  (StgArg, UniqSupply, GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-906"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097444"><span class="hs-identifier hs-var">arg_idx</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap StgArg
</span><a href="#local-6989586621682097445"><span class="hs-identifier hs-var">arg_map</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097446"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097447"><span class="hs-identifier hs-var">wrapper</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097449"><span class="hs-identifier hs-var">stg_arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-908"></span><span>         </span><span class="hs-comment">-- Garbage slot, fill with rubbish</span><span>
</span><span id="line-909"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-910"></span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097444"><span class="hs-identifier hs-var">arg_idx</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap StgArg
</span><a href="#local-6989586621682097445"><span class="hs-identifier hs-var">arg_map</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097446"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097447"><span class="hs-identifier hs-var">wrapper</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-911"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotTy -&gt; StgArg
</span><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-var">ubxSumRubbishArg</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="#local-6989586621682097448"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span>      </span><span class="annot"><a href="#local-6989586621682097451"><span class="hs-identifier hs-type">castArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html#SlotTy"><span class="hs-identifier hs-type">SlotTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>      </span><span id="local-6989586621682097451"><span class="annot"><span class="annottext">castArg :: UniqSupply
-&gt; SlotTy
-&gt; StgArg
-&gt; Maybe
     (StgArg, UniqSupply, GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
</span><a href="#local-6989586621682097451"><span class="hs-identifier hs-var hs-var">castArg</span></a></span></span><span> </span><span id="local-6989586621682097457"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097457"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621682097458"><span class="annot"><span class="annottext">SlotTy
</span><a href="#local-6989586621682097458"><span class="hs-identifier hs-var">slot_ty</span></a></span></span><span> </span><span id="local-6989586621682097459"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097459"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-915"></span><span>        </span><span class="hs-comment">-- Cast the argument to the type of the slot if required</span><span>
</span><span id="line-916"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SlotTy -&gt; PrimRep
</span><a href="GHC.Types.RepType.html#slotPrimRep"><span class="hs-identifier hs-var">slotPrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="#local-6989586621682097458"><span class="hs-identifier hs-var">slot_ty</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; PrimRep -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; PrimRep
Type -&gt; PrimRep
</span><a href="GHC.Types.RepType.html#typePrimRep1"><span class="hs-identifier hs-var">typePrimRep1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097459"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682097462"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097462"><span class="hs-identifier hs-var">out_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; Type
</span><a href="GHC.Types.RepType.html#primRepToType"><span class="hs-identifier hs-var">primRepToType</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimRep -&gt; Type) -&gt; PrimRep -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy -&gt; PrimRep
</span><a href="GHC.Types.RepType.html#slotPrimRep"><span class="hs-identifier hs-var">slotPrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="#local-6989586621682097458"><span class="hs-identifier hs-var">slot_ty</span></a></span><span>
</span><span id="line-918"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097463"><span class="annot"><span class="annottext">[PrimOp]
</span><a href="#local-6989586621682097463"><span class="hs-identifier hs-var">ops</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097464"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097464"><span class="hs-identifier hs-var">types</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type)] -&gt; ([PrimOp], [Type])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../base-4.18.3.0/src/GHC.List.html#unzip/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(PrimOp, Type)] -&gt; ([PrimOp], [Type]))
-&gt; [(PrimOp, Type)] -&gt; ([PrimOp], [Type])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; PrimRep -&gt; [(PrimOp, Type)]
</span><a href="GHC.Builtin.PrimOps.Casts.html#getCasts"><span class="hs-identifier hs-var">getCasts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; PrimRep
Type -&gt; PrimRep
</span><a href="GHC.Types.RepType.html#typePrimRep1"><span class="hs-identifier hs-var">typePrimRep1</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; PrimRep) -&gt; Type -&gt; PrimRep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097459"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimRep -&gt; [(PrimOp, Type)]) -&gt; PrimRep -&gt; [(PrimOp, Type)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; PrimRep
Type -&gt; PrimRep
</span><a href="GHC.Types.RepType.html#typePrimRep1"><span class="hs-identifier hs-var">typePrimRep1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097462"><span class="hs-identifier hs-var">out_ty</span></a></span><span>
</span><span id="line-919"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([PrimOp] -&gt; Bool) -&gt; [PrimOp] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimOp] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">([PrimOp] -&gt; Bool) -&gt; [PrimOp] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimOp]
</span><a href="#local-6989586621682097463"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-920"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097466"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097466"><span class="hs-identifier hs-var">us1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097467"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097467"><span class="hs-identifier hs-var">us2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (UniqSupply, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#splitUniqSupply"><span class="hs-identifier hs-var">splitUniqSupply</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097457"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-921"></span><span>              </span><span id="local-6989586621682097469"><span class="annot"><span class="annottext">cast_uqs :: [Unique]
</span><a href="#local-6989586621682097469"><span class="hs-identifier hs-var hs-var">cast_uqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; [Unique]
</span><a href="GHC.Types.Unique.Supply.html#uniqsFromSupply"><span class="hs-identifier hs-var">uniqsFromSupply</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097466"><span class="hs-identifier hs-var">us1</span></a></span><span>
</span><span id="line-922"></span><span>              </span><span id="local-6989586621682097470"><span class="annot"><span class="annottext">cast_opts :: [(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097470"><span class="hs-identifier hs-var hs-var">cast_opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PrimOp] -&gt; [Type] -&gt; [Unique] -&gt; [(PrimOp, Type, Unique)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#zip3/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimOp]
</span><a href="#local-6989586621682097463"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097464"><span class="hs-identifier hs-var">types</span></a></span><span> </span><span class="annot"><span class="annottext">[Unique]
</span><a href="#local-6989586621682097469"><span class="hs-identifier hs-var">cast_uqs</span></a></span><span>
</span><span id="line-923"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621682097471"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682097471"><span class="hs-identifier hs-var">_op</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097472"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097472"><span class="hs-identifier hs-var">out_ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682097473"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682097473"><span class="hs-identifier hs-var">out_uq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)] -&gt; (PrimOp, Type, Unique)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.List.html#last/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097470"><span class="hs-identifier hs-var">cast_opts</span></a></span><span>
</span><span id="line-924"></span><span>              </span><span id="local-6989586621682097474"><span class="annot"><span class="annottext">casts :: GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097474"><span class="hs-identifier hs-var hs-var">casts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
-&gt; StgArg -&gt; GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#castArgRename"><span class="hs-identifier hs-var">castArgRename</span></a></span><span> </span><span class="annot"><span class="annottext">[(PrimOp, Type, Unique)]
</span><a href="#local-6989586621682097470"><span class="hs-identifier hs-var">cast_opts</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097459"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span>
</span><span id="line-925"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(StgArg, UniqSupply, GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
-&gt; Maybe
     (StgArg, UniqSupply, GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Id
</span><a href="GHC.Stg.Unarise.html#mkCastVar"><span class="hs-identifier hs-var">mkCastVar</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682097473"><span class="hs-identifier hs-var">out_uq</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097472"><span class="hs-identifier hs-var">out_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621682097467"><span class="hs-identifier hs-var">us2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097474"><span class="hs-identifier hs-var">casts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>        </span><span class="hs-comment">-- No need for casting</span><span>
</span><span id="line-927"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe
  (StgArg, UniqSupply, GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span>      </span><span id="local-6989586621682097475"><span class="annot"><span class="annottext">tup_args :: [StgArg]
</span><a href="#local-6989586621682097475"><span class="hs-identifier hs-var hs-var">tup_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097432"><span class="hs-identifier hs-var">tag_arg</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; [StgArg] -&gt; [StgArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097440"><span class="hs-identifier hs-var">slot_args</span></a></span><span>
</span><span id="line-930"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-931"></span><span>      </span><span class="hs-comment">-- pprTrace &quot;mkUbxSum&quot; (</span><span>
</span><span id="line-932"></span><span>      </span><span class="hs-comment">--   text &quot;ty_args (slots)&quot; &lt;+&gt; ppr ty_args $$</span><span>
</span><span id="line-933"></span><span>      </span><span class="hs-comment">--   text &quot;args0&quot; &lt;+&gt; ppr args0 $$</span><span>
</span><span id="line-934"></span><span>      </span><span class="hs-comment">--   text &quot;wrapper&quot; &lt;+&gt;</span><span>
</span><span id="line-935"></span><span>      </span><span class="hs-comment">--       (ppr $ wrapper $ StgLit $ LitChar '_'))</span><span>
</span><span id="line-936"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097475"><span class="hs-identifier hs-var">tup_args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla -&gt; GenStgExpr 'Vanilla
</span><a href="#local-6989586621682097439"><span class="hs-identifier hs-var">wrapper</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span class="hs-comment">-- | Return a rubbish value for the given slot type.</span><span>
</span><span id="line-940"></span><span class="hs-comment">--</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- We use the following rubbish values:</span><span>
</span><span id="line-942"></span><span class="hs-comment">--    * Literals: 0 or 0.0</span><span>
</span><span id="line-943"></span><span class="hs-comment">--    * Pointers: `ghc-prim:GHC.Prim.Panic.absentSumFieldError`</span><span>
</span><span id="line-944"></span><span class="hs-comment">--</span><span>
</span><span id="line-945"></span><span class="hs-comment">-- See Note [aBSENT_SUM_FIELD_ERROR_ID] in &quot;GHC.Core.Make&quot;</span><span>
</span><span id="line-946"></span><span class="hs-comment">--</span><span>
</span><span id="line-947"></span><span class="annot"><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-type">ubxSumRubbishArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html#SlotTy"><span class="hs-identifier hs-type">SlotTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span>
</span><span id="line-948"></span><span id="ubxSumRubbishArg"><span class="annot"><span class="annottext">ubxSumRubbishArg :: SlotTy -&gt; StgArg
</span><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-var hs-var">ubxSumRubbishArg</span></a></span></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="GHC.Types.RepType.html#PtrLiftedSlot"><span class="hs-identifier hs-var">PtrLiftedSlot</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_SUM_FIELD_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_SUM_FIELD_ERROR_ID</span></a></span><span>
</span><span id="line-949"></span><span class="annot"><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-var">ubxSumRubbishArg</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="GHC.Types.RepType.html#PtrUnliftedSlot"><span class="hs-identifier hs-var">PtrUnliftedSlot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#aBSENT_SUM_FIELD_ERROR_ID"><span class="hs-identifier hs-var">aBSENT_SUM_FIELD_ERROR_ID</span></a></span><span>
</span><span id="line-950"></span><span class="annot"><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-var">ubxSumRubbishArg</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="GHC.Types.RepType.html#WordSlot"><span class="hs-identifier hs-var">WordSlot</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-var">StgLitArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-951"></span><span class="annot"><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-var">ubxSumRubbishArg</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="GHC.Types.RepType.html#Word64Slot"><span class="hs-identifier hs-var">Word64Slot</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-var">StgLitArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span class="annot"><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-var">ubxSumRubbishArg</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="GHC.Types.RepType.html#FloatSlot"><span class="hs-identifier hs-var">FloatSlot</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-var">StgLitArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span class="annot"><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-var">ubxSumRubbishArg</span></a></span><span> </span><span class="annot"><span class="annottext">SlotTy
</span><a href="GHC.Types.RepType.html#DoubleSlot"><span class="hs-identifier hs-var">DoubleSlot</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-var">StgLitArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span class="annot"><a href="GHC.Stg.Unarise.html#ubxSumRubbishArg"><span class="hs-identifier hs-var">ubxSumRubbishArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.RepType.html#VecSlot"><span class="hs-identifier hs-type">VecSlot</span></a></span><span> </span><span id="local-6989586621682097487"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097487"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682097488"><span class="annot"><span class="annottext">PrimElemRep
</span><a href="#local-6989586621682097488"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-var">StgLitArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Type -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097490"><span class="hs-identifier hs-var">vec_rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682097490"><span class="annot"><span class="annottext">vec_rep :: Type
</span><a href="#local-6989586621682097490"><span class="hs-identifier hs-var hs-var">vec_rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; Type
</span><a href="GHC.Types.RepType.html#primRepToRuntimeRep"><span class="hs-identifier hs-var">primRepToRuntimeRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; PrimElemRep -&gt; PrimRep
</span><a href="GHC.Core.TyCon.html#VecRep"><span class="hs-identifier hs-var">VecRep</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682097487"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PrimElemRep
</span><a href="#local-6989586621682097488"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>
</span><span id="line-957"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span class="hs-comment">{-
Note [Unarisation of Void binders and arguments]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For arguments (StgArg) and binders (Id) we have two kind of unarisation:

  - When unarising function arg binders and arguments, we don't want to remove
    void binders and arguments. For example,

      f :: (# (# #), (# #) #) -&gt; Void# -&gt; RealWorld# -&gt; ...
      f x y z = &lt;body&gt;

    Here after unarise we should still get a function with arity 3. Similarly
    in the call site we shouldn't remove void arguments:

      f (# (# #), (# #) #) void# rw

    When unarising &lt;body&gt;, we extend the environment with these binders:

      x :-&gt; MultiVal [], y :-&gt; MultiVal [], z :-&gt; MultiVal []

    Because their rep types are `MultiRep []` (aka. void). This means that when
    we see `x` in a function argument position, we actually replace it with a
    void argument. When we see it in a DataCon argument position, we just get
    rid of it, because DataCon applications in STG are always saturated.

  - When unarising case alternative binders we remove void binders, but we
    still update the environment the same way, because those binders may be
    used in the RHS. Example:

      case x of y {
        (# x1, x2, x3 #) -&gt; &lt;RHS&gt;
      }

    We know that y can't be void, because we don't scrutinize voids, so x will
    be unarised to some number of arguments, and those arguments will have at
    least one non-void thing. So in the rho we will have something like:

      x :-&gt; MultiVal [xu1, xu2]

    Now, after we eliminate void binders in the pattern, we get exactly the same
    number of binders, and extend rho again with these:

      x1 :-&gt; UnaryVal xu1
      x2 :-&gt; MultiVal [] -- x2 is void
      x3 :-&gt; UnaryVal xu2

    Now when we see x2 in a function argument position or in return position, we
    generate void#. In constructor argument position, we just remove it.

So in short, when we have a void id,

  - We keep it if it's a lambda argument binder or
                       in argument position of an application.

  - We remove it if it's a DataCon field binder or
                         in argument position of a DataCon application.
-}</span><span>
</span><span id="line-1016"></span><span>
</span><span id="line-1017"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseArgBinder"><span class="hs-identifier hs-type">unariseArgBinder</span></a></span><span>
</span><span id="line-1018"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- data con arg?</span><span>
</span><span id="line-1019"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span id="unariseArgBinder"><span class="annot"><span class="annottext">unariseArgBinder :: Bool -&gt; UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseArgBinder"><span class="hs-identifier hs-var hs-var">unariseArgBinder</span></a></span></span><span> </span><span id="local-6989586621682097493"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682097493"><span class="hs-identifier hs-var">is_con_arg</span></a></span></span><span> </span><span id="local-6989586621682097494"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097494"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097495"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1021"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; [PrimRep]
Type -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1022"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1023"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682097493"><span class="hs-identifier hs-var">is_con_arg</span></a></span><span>
</span><span id="line-1024"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UnariseEnv, [Id]) -&gt; UniqSM (UnariseEnv, [Id])
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097494"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1025"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-comment">-- fun arg, do not remove void binders</span><span>
</span><span id="line-1026"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UnariseEnv, [Id]) -&gt; UniqSM (UnariseEnv, [Id])
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097494"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#voidArgId"><span class="hs-identifier hs-var">voidArgId</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span>
</span><span id="line-1028"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682097496"><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682097496"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1029"></span><span>      </span><span class="hs-comment">-- Arg represented as single variable, but original type may still be an</span><span>
</span><span id="line-1030"></span><span>      </span><span class="hs-comment">-- unboxed sum/tuple, e.g. (# Void# | Void# #).</span><span>
</span><span id="line-1031"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1032"></span><span>      </span><span class="hs-comment">-- While not unarising the binder in this case does not break any programs</span><span>
</span><span id="line-1033"></span><span>      </span><span class="hs-comment">-- (because it unarises to a single variable), it triggers StgLint as we</span><span>
</span><span id="line-1034"></span><span>      </span><span class="hs-comment">-- break the post-unarisation invariant that says unboxed tuple/sum</span><span>
</span><span id="line-1035"></span><span>      </span><span class="hs-comment">-- binders should vanish. See Note [Post-unarisation invariants].</span><span>
</span><span id="line-1036"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnboxedSumType"><span class="hs-identifier hs-var">isUnboxedSumType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier hs-var">isUnboxedTupleType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1037"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682097499"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097499"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Type -&gt; UniqSM Id
</span><a href="GHC.Stg.Unarise.html#mkId"><span class="hs-identifier hs-var">mkId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;us&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimRep -&gt; Type
</span><a href="GHC.Types.RepType.html#primRepToType"><span class="hs-identifier hs-var">primRepToType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682097496"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1038"></span><span>            </span><span class="annot"><span class="annottext">(UnariseEnv, [Id]) -&gt; UniqSM (UnariseEnv, [Id])
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097494"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097499"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097499"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1040"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UnariseEnv, [Id]) -&gt; UniqSM (UnariseEnv, [Id])
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRhoWithoutValue"><span class="hs-identifier hs-var">extendRhoWithoutValue</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097494"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span>
</span><span id="line-1042"></span><span>    </span><span id="local-6989586621682097500"><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682097500"><span class="hs-identifier hs-var">reps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1043"></span><span>      </span><span id="local-6989586621682097501"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097501"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; [Type] -&gt; UniqSM [Id]
</span><a href="GHC.Stg.Unarise.html#mkIds"><span class="hs-identifier hs-var">mkIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;us&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PrimRep -&gt; Type) -&gt; [PrimRep] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; Type
</span><a href="GHC.Types.RepType.html#primRepToType"><span class="hs-identifier hs-var">primRepToType</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682097500"><span class="hs-identifier hs-var">reps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>      </span><span class="annot"><span class="annottext">(UnariseEnv, [Id]) -&gt; UniqSM (UnariseEnv, [Id])
forall a. a -&gt; UniqSM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UnariseVal -&gt; UnariseEnv
</span><a href="GHC.Stg.Unarise.html#extendRho"><span class="hs-identifier hs-var">extendRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097494"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097495"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; UnariseVal
</span><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-var">MultiVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; StgArg) -&gt; [Id] -&gt; [StgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097501"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097501"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1045"></span><span>
</span><span id="line-1046"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span class="annot"><span class="hs-comment">-- | MultiVal a function argument. Never returns an empty list.</span></span><span>
</span><span id="line-1049"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseFunArg"><span class="hs-identifier hs-type">unariseFunArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1050"></span><span id="unariseFunArg"><span class="annot"><span class="annottext">unariseFunArg :: UnariseEnv -&gt; StgArg -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseFunArg"><span class="hs-identifier hs-var hs-var">unariseFunArg</span></a></span></span><span> </span><span id="local-6989586621682097504"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097504"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-type">StgVarArg</span></a></span><span> </span><span id="local-6989586621682097505"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097505"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1051"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; Maybe UnariseVal
</span><a href="GHC.Stg.Unarise.html#lookupRho"><span class="hs-identifier hs-var">lookupRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097504"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097505"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1052"></span><span>    </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-type">MultiVal</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StgArg
</span><a href="GHC.Stg.Unarise.html#voidArg"><span class="hs-identifier hs-var">voidArg</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- NB: do not remove void args</span><span>
</span><span id="line-1053"></span><span>    </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-type">MultiVal</span></a></span><span> </span><span id="local-6989586621682097507"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097507"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097507"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1054"></span><span>    </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-type">UnaryVal</span></a></span><span> </span><span id="local-6989586621682097508"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097508"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097508"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1055"></span><span>    </span><span class="annot"><span class="annottext">Maybe UnariseVal
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097505"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1056"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseFunArg"><span class="hs-identifier hs-var">unariseFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682097509"><span class="annot"><span class="annottext">arg :: StgArg
</span><a href="#local-6989586621682097509"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-type">StgLitArg</span></a></span><span> </span><span id="local-6989586621682097510"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097510"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Maybe [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseLiteral_maybe"><span class="hs-identifier hs-var">unariseLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097510"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1057"></span><span>  </span><span class="hs-comment">-- forgetting to unariseLiteral_maybe here caused #23914</span><span>
</span><span id="line-1058"></span><span>  </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StgArg
</span><a href="GHC.Stg.Unarise.html#voidArg"><span class="hs-identifier hs-var">voidArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1059"></span><span>  </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682097511"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097511"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097511"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1060"></span><span>  </span><span class="annot"><span class="annottext">Maybe [StgArg]
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097509"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1061"></span><span>
</span><span id="line-1062"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseFunArgs"><span class="hs-identifier hs-type">unariseFunArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1063"></span><span id="unariseFunArgs"><span class="annot"><span class="annottext">unariseFunArgs :: UnariseEnv -&gt; [StgArg] -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseFunArgs"><span class="hs-identifier hs-var hs-var">unariseFunArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StgArg -&gt; [StgArg]) -&gt; [StgArg] -&gt; [StgArg]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">((StgArg -&gt; [StgArg]) -&gt; [StgArg] -&gt; [StgArg])
-&gt; (UnariseEnv -&gt; StgArg -&gt; [StgArg])
-&gt; UnariseEnv
-&gt; [StgArg]
-&gt; [StgArg]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; StgArg -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseFunArg"><span class="hs-identifier hs-var">unariseFunArg</span></a></span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseFunArgBinders"><span class="hs-identifier hs-type">unariseFunArgBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1066"></span><span id="unariseFunArgBinders"><span class="annot"><span class="annottext">unariseFunArgBinders :: UnariseEnv -&gt; [Id] -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseFunArgBinders"><span class="hs-identifier hs-var hs-var">unariseFunArgBinders</span></a></span></span><span> </span><span id="local-6989586621682097512"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097512"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097513"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097513"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[Id]] -&gt; [Id]) -&gt; (UnariseEnv, [[Id]]) -&gt; (UnariseEnv, [Id])
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../base-4.18.3.0/src/Data.Bifunctor.html#second/Data.Bifunctor.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">[[Id]] -&gt; [Id]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concat/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">((UnariseEnv, [[Id]]) -&gt; (UnariseEnv, [Id]))
-&gt; UniqSM (UnariseEnv, [[Id]]) -&gt; UniqSM (UnariseEnv, [Id])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id]))
-&gt; UnariseEnv -&gt; [Id] -&gt; UniqSM (UnariseEnv, [[Id]])
forall (m :: * -&gt; *) (t :: * -&gt; *) acc x y.
(Monad m, Traversable t) =&gt;
(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; t x -&gt; m (acc, t y)
</span><a href="GHC.Utils.Monad.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseFunArgBinder"><span class="hs-identifier hs-var">unariseFunArgBinder</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097512"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097513"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span class="hs-comment">-- Result list of binders is never empty</span><span>
</span><span id="line-1069"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseFunArgBinder"><span class="hs-identifier hs-type">unariseFunArgBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span id="unariseFunArgBinder"><span class="annot"><span class="annottext">unariseFunArgBinder :: UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseFunArgBinder"><span class="hs-identifier hs-var hs-var">unariseFunArgBinder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseArgBinder"><span class="hs-identifier hs-var">unariseArgBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1071"></span><span>
</span><span id="line-1072"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1073"></span><span>
</span><span id="line-1074"></span><span class="annot"><span class="hs-comment">-- | MultiVal a DataCon argument. Returns an empty list when argument is void.</span></span><span>
</span><span id="line-1075"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseConArg"><span class="hs-identifier hs-type">unariseConArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#InStgArg"><span class="hs-identifier hs-type">InStgArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1076"></span><span id="unariseConArg"><span class="annot"><span class="annottext">unariseConArg :: UnariseEnv -&gt; StgArg -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseConArg"><span class="hs-identifier hs-var hs-var">unariseConArg</span></a></span></span><span> </span><span id="local-6989586621682097517"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097517"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-type">StgVarArg</span></a></span><span> </span><span id="local-6989586621682097518"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097518"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1077"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; Maybe UnariseVal
</span><a href="GHC.Stg.Unarise.html#lookupRho"><span class="hs-identifier hs-var">lookupRho</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097517"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097518"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1078"></span><span>    </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnaryVal"><span class="hs-identifier hs-type">UnaryVal</span></a></span><span> </span><span id="local-6989586621682097519"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097519"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097519"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1079"></span><span>    </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#MultiVal"><span class="hs-identifier hs-type">MultiVal</span></a></span><span> </span><span id="local-6989586621682097520"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097520"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097520"><span class="hs-keyword hs-var">as</span></a></span><span>      </span><span class="hs-comment">-- 'as' can be empty</span><span>
</span><span id="line-1080"></span><span>    </span><span class="annot"><span class="annottext">Maybe UnariseVal
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1081"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Types.RepType.html#isZeroBitTy"><span class="hs-identifier hs-var">isZeroBitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097518"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- e.g. C realWorld#</span><span>
</span><span id="line-1082"></span><span>                                     </span><span class="hs-comment">-- Here realWorld# is not in the envt, but</span><span>
</span><span id="line-1083"></span><span>                                     </span><span class="hs-comment">-- is a void, and so should be eliminated</span><span>
</span><span id="line-1084"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097518"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1085"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseConArg"><span class="hs-identifier hs-var">unariseConArg</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682097521"><span class="annot"><span class="annottext">arg :: StgArg
</span><a href="#local-6989586621682097521"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-type">StgLitArg</span></a></span><span> </span><span id="local-6989586621682097522"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097522"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1086"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682097523"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097523"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Maybe [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseLiteral_maybe"><span class="hs-identifier hs-var">unariseLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097522"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1087"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097523"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1088"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1089"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [StgArg] -&gt; [StgArg]
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Bool
Type -&gt; Bool
</span><a href="GHC.Types.RepType.html#isZeroBitTy"><span class="hs-identifier hs-var">isZeroBitTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Type
</span><a href="GHC.Types.Literal.html#literalType"><span class="hs-identifier hs-var">literalType</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682097522"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- We have no non-rubbish void literals</span><span>
</span><span id="line-1090"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621682097521"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1091"></span><span>
</span><span id="line-1092"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseConArgs"><span class="hs-identifier hs-type">unariseConArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#InStgArg"><span class="hs-identifier hs-type">InStgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#OutStgArg"><span class="hs-identifier hs-type">OutStgArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1093"></span><span id="unariseConArgs"><span class="annot"><span class="annottext">unariseConArgs :: UnariseEnv -&gt; [StgArg] -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseConArgs"><span class="hs-identifier hs-var hs-var">unariseConArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StgArg -&gt; [StgArg]) -&gt; [StgArg] -&gt; [StgArg]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">((StgArg -&gt; [StgArg]) -&gt; [StgArg] -&gt; [StgArg])
-&gt; (UnariseEnv -&gt; StgArg -&gt; [StgArg])
-&gt; UnariseEnv
-&gt; [StgArg]
-&gt; [StgArg]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; StgArg -&gt; [StgArg]
</span><a href="GHC.Stg.Unarise.html#unariseConArg"><span class="hs-identifier hs-var">unariseConArg</span></a></span><span>
</span><span id="line-1094"></span><span>
</span><span id="line-1095"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseConArgBinders"><span class="hs-identifier hs-type">unariseConArgBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1096"></span><span id="unariseConArgBinders"><span class="annot"><span class="annottext">unariseConArgBinders :: UnariseEnv -&gt; [Id] -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseConArgBinders"><span class="hs-identifier hs-var hs-var">unariseConArgBinders</span></a></span></span><span> </span><span id="local-6989586621682097525"><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097525"><span class="hs-identifier hs-var">rho</span></a></span></span><span> </span><span id="local-6989586621682097526"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097526"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[Id]] -&gt; [Id]) -&gt; (UnariseEnv, [[Id]]) -&gt; (UnariseEnv, [Id])
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../base-4.18.3.0/src/Data.Bifunctor.html#second/Data.Bifunctor.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">[[Id]] -&gt; [Id]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concat/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">((UnariseEnv, [[Id]]) -&gt; (UnariseEnv, [Id]))
-&gt; UniqSM (UnariseEnv, [[Id]]) -&gt; UniqSM (UnariseEnv, [Id])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id]))
-&gt; UnariseEnv -&gt; [Id] -&gt; UniqSM (UnariseEnv, [[Id]])
forall (m :: * -&gt; *) (t :: * -&gt; *) acc x y.
(Monad m, Traversable t) =&gt;
(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; t x -&gt; m (acc, t y)
</span><a href="GHC.Utils.Monad.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseConArgBinder"><span class="hs-identifier hs-var">unariseConArgBinder</span></a></span><span> </span><span class="annot"><span class="annottext">UnariseEnv
</span><a href="#local-6989586621682097525"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621682097526"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1097"></span><span>
</span><span id="line-1098"></span><span class="hs-comment">-- Different from `unariseFunArgBinder`: result list of binders may be empty.</span><span>
</span><span id="line-1099"></span><span class="hs-comment">-- See DataCon applications case in Note [Post-unarisation invariants].</span><span>
</span><span id="line-1100"></span><span class="annot"><a href="GHC.Stg.Unarise.html#unariseConArgBinder"><span class="hs-identifier hs-type">unariseConArgBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Unarise.html#UnariseEnv"><span class="hs-identifier hs-type">UnariseEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span id="unariseConArgBinder"><span class="annot"><span class="annottext">unariseConArgBinder :: UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseConArgBinder"><span class="hs-identifier hs-var hs-var">unariseConArgBinder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UnariseEnv -&gt; Id -&gt; UniqSM (UnariseEnv, [Id])
</span><a href="GHC.Stg.Unarise.html#unariseArgBinder"><span class="hs-identifier hs-var">unariseArgBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1102"></span><span>
</span><span id="line-1103"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1104"></span><span>
</span><span id="line-1105"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkIds"><span class="hs-identifier hs-type">mkIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.RepType.html#UnaryType"><span class="hs-identifier hs-type">UnaryType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1106"></span><span id="mkIds"><span class="annot"><span class="annottext">mkIds :: FastString -&gt; [Type] -&gt; UniqSM [Id]
</span><a href="GHC.Stg.Unarise.html#mkIds"><span class="hs-identifier hs-var hs-var">mkIds</span></a></span></span><span> </span><span id="local-6989586621682097528"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682097528"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621682097529"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097529"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; [Type] -&gt; UniqSM [Id]
forall (m :: * -&gt; *).
MonadUnique m =&gt;
FastString -&gt; [Type] -&gt; m [Id]
</span><a href="GHC.Stg.Utils.html#mkUnarisedIds"><span class="hs-identifier hs-var">mkUnarisedIds</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682097528"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682097529"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1107"></span><span>
</span><span id="line-1108"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkId"><span class="hs-identifier hs-type">mkId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html#UnaryType"><span class="hs-identifier hs-type">UnaryType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1109"></span><span id="mkId"><span class="annot"><span class="annottext">mkId :: FastString -&gt; Type -&gt; UniqSM Id
</span><a href="GHC.Stg.Unarise.html#mkId"><span class="hs-identifier hs-var hs-var">mkId</span></a></span></span><span> </span><span id="local-6989586621682097531"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682097531"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682097532"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097532"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Type -&gt; UniqSM Id
forall (m :: * -&gt; *). MonadUnique m =&gt; FastString -&gt; Type -&gt; m Id
</span><a href="GHC.Stg.Utils.html#mkUnarisedId"><span class="hs-identifier hs-var">mkUnarisedId</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682097531"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682097532"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1110"></span><span>
</span><span id="line-1111"></span><span class="annot"><a href="GHC.Stg.Unarise.html#isMultiValBndr"><span class="hs-identifier hs-type">isMultiValBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1112"></span><span id="isMultiValBndr"><span class="annot"><span class="annottext">isMultiValBndr :: Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isMultiValBndr"><span class="hs-identifier hs-var hs-var">isMultiValBndr</span></a></span></span><span> </span><span id="local-6989586621682097534"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097534"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-1113"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PrimRep
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; [PrimRep]
Type -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682097534"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1114"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1115"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1116"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1117"></span><span>
</span><span id="line-1118"></span><span class="annot"><a href="GHC.Stg.Unarise.html#isUnboxedSumBndr"><span class="hs-identifier hs-type">isUnboxedSumBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1119"></span><span id="isUnboxedSumBndr"><span class="annot"><span class="annottext">isUnboxedSumBndr :: Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedSumBndr"><span class="hs-identifier hs-var hs-var">isUnboxedSumBndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnboxedSumType"><span class="hs-identifier hs-var">isUnboxedSumType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (Id -&gt; Type) -&gt; Id -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span>
</span><span id="line-1120"></span><span>
</span><span id="line-1121"></span><span class="annot"><a href="GHC.Stg.Unarise.html#isUnboxedTupleBndr"><span class="hs-identifier hs-type">isUnboxedTupleBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1122"></span><span id="isUnboxedTupleBndr"><span class="annot"><span class="annottext">isUnboxedTupleBndr :: Id -&gt; Bool
</span><a href="GHC.Stg.Unarise.html#isUnboxedTupleBndr"><span class="hs-identifier hs-var hs-var">isUnboxedTupleBndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier hs-var">isUnboxedTupleType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (Id -&gt; Type) -&gt; Id -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span>
</span><span id="line-1123"></span><span>
</span><span id="line-1124"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkTuple"><span class="hs-identifier hs-type">mkTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgExpr"><span class="hs-identifier hs-type">StgExpr</span></a></span><span>
</span><span id="line-1125"></span><span id="mkTuple"><span class="annot"><span class="annottext">mkTuple :: [StgArg] -&gt; GenStgExpr 'Vanilla
</span><a href="GHC.Stg.Unarise.html#mkTuple"><span class="hs-identifier hs-var hs-var">mkTuple</span></a></span></span><span> </span><span id="local-6989586621682097535"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097535"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon
-&gt; ConstructorNumber -&gt; [StgArg] -&gt; [Type] -&gt; GenStgExpr 'Vanilla
forall (pass :: StgPass).
DataCon
-&gt; ConstructorNumber -&gt; [StgArg] -&gt; [Type] -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#StgConApp"><span class="hs-identifier hs-var">StgConApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Boxity -&gt; Int -&gt; DataCon
</span><a href="GHC.Builtin.Types.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Boxity
</span><a href="Language.Haskell.Syntax.Basic.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[StgArg] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097535"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstructorNumber
</span><a href="GHC.Stg.Syntax.html#NoNumber"><span class="hs-identifier hs-var">NoNumber</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097535"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StgArg -&gt; Type) -&gt; [StgArg] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; Type
</span><a href="GHC.Stg.Syntax.html#stgArgType"><span class="hs-identifier hs-var">stgArgType</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621682097535"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1126"></span><span>
</span><span id="line-1127"></span><span class="annot"><a href="GHC.Stg.Unarise.html#tagAltTy"><span class="hs-identifier hs-type">tagAltTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#AltType"><span class="hs-identifier hs-type">AltType</span></a></span><span>
</span><span id="line-1128"></span><span id="tagAltTy"><span class="annot"><span class="annottext">tagAltTy :: AltType
</span><a href="GHC.Stg.Unarise.html#tagAltTy"><span class="hs-identifier hs-var hs-var">tagAltTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; AltType
</span><a href="GHC.Stg.Syntax.html#PrimAlt"><span class="hs-identifier hs-var">PrimAlt</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep
</span><a href="GHC.Core.TyCon.html#IntRep"><span class="hs-identifier hs-var">IntRep</span></a></span><span>
</span><span id="line-1129"></span><span>
</span><span id="line-1130"></span><span class="annot"><a href="GHC.Stg.Unarise.html#tagTy"><span class="hs-identifier hs-type">tagTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1131"></span><span id="tagTy"><span class="annot"><span class="annottext">tagTy :: Type
</span><a href="GHC.Stg.Unarise.html#tagTy"><span class="hs-identifier hs-var hs-var">tagTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a></span><span>
</span><span id="line-1132"></span><span>
</span><span id="line-1133"></span><span class="annot"><a href="GHC.Stg.Unarise.html#voidArg"><span class="hs-identifier hs-type">voidArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span>
</span><span id="line-1134"></span><span id="voidArg"><span class="annot"><span class="annottext">voidArg :: StgArg
</span><a href="GHC.Stg.Unarise.html#voidArg"><span class="hs-identifier hs-var hs-var">voidArg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; StgArg
</span><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-var">StgVarArg</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Types.Id.Make.html#voidPrimId"><span class="hs-identifier hs-var">voidPrimId</span></a></span><span>
</span><span id="line-1135"></span><span>
</span><span id="line-1136"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkDefaultLitAlt"><span class="hs-identifier hs-type">mkDefaultLitAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgAlt"><span class="hs-identifier hs-type">StgAlt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1137"></span><span class="hs-comment">-- We have an exhauseive list of literal alternatives</span><span>
</span><span id="line-1138"></span><span class="hs-comment">--    1# -&gt; e1</span><span>
</span><span id="line-1139"></span><span class="hs-comment">--    2# -&gt; e2</span><span>
</span><span id="line-1140"></span><span class="hs-comment">-- Since they are exhaustive, we can replace one with DEFAULT, to avoid</span><span>
</span><span id="line-1141"></span><span class="hs-comment">-- generating a final test. Remember, the DEFAULT comes first if it exists.</span><span>
</span><span id="line-1142"></span><span id="mkDefaultLitAlt"><span class="annot"><span class="annottext">mkDefaultLitAlt :: [GenStgAlt 'Vanilla] -&gt; [GenStgAlt 'Vanilla]
</span><a href="GHC.Stg.Unarise.html#mkDefaultLitAlt"><span class="hs-identifier hs-var hs-var">mkDefaultLitAlt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; [GenStgAlt 'Vanilla]
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;elimUbxSumExpr.mkDefaultAlt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty alts&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkDefaultLitAlt"><span class="hs-identifier hs-var">mkDefaultLitAlt</span></a></span><span> </span><span id="local-6989586621682097538"><span class="annot"><span class="annottext">alts :: [GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097538"><span class="hs-identifier hs-var">alts</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">[BinderP 'Vanilla]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">GenStgExpr 'Vanilla
</span><span class="hs-identifier">_</span></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097538"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-1144"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkDefaultLitAlt"><span class="hs-identifier hs-var">mkDefaultLitAlt</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682097539"><span class="annot"><span class="annottext">alt :: GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097539"><span class="hs-identifier hs-var">alt</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-type">LitAlt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682097540"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097540"><span class="hs-identifier hs-var">alts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla
</span><a href="#local-6989586621682097539"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-type">DEFAULT</span></a></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">GenStgAlt 'Vanilla -&gt; [GenStgAlt 'Vanilla] -&gt; [GenStgAlt 'Vanilla]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097540"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-1145"></span><span class="annot"><a href="GHC.Stg.Unarise.html#mkDefaultLitAlt"><span class="hs-identifier hs-var">mkDefaultLitAlt</span></a></span><span> </span><span id="local-6989586621682097541"><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097541"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; [GenStgAlt 'Vanilla]
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkDefaultLitAlt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Not a lit alt:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla] -&gt; SDoc
forall (pass :: StgPass).
OutputablePass pass =&gt;
[GenStgAlt pass] -&gt; SDoc
</span><a href="GHC.Stg.Unarise.html#pprPanicAlts"><span class="hs-identifier hs-var">pprPanicAlts</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt 'Vanilla]
</span><a href="#local-6989586621682097541"><span class="hs-identifier hs-var">alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>
</span><span id="line-1147"></span><span id="local-6989586621682096658"><span class="annot"><a href="GHC.Stg.Unarise.html#pprPanicAlts"><span class="hs-identifier hs-type">pprPanicAlts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#OutputablePass"><span class="hs-identifier hs-type">OutputablePass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682096658"><span class="hs-identifier hs-type">pass</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682096658"><span class="hs-identifier hs-type">pass</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span><span>
</span><span id="line-1148"></span><span id="pprPanicAlts"><span class="annot"><span class="annottext">pprPanicAlts :: forall (pass :: StgPass).
OutputablePass pass =&gt;
[GenStgAlt pass] -&gt; SDoc
</span><a href="GHC.Stg.Unarise.html#pprPanicAlts"><span class="hs-identifier hs-var hs-var">pprPanicAlts</span></a></span></span><span> </span><span id="local-6989586621682097547"><span class="annot"><span class="annottext">[GenStgAlt pass]
</span><a href="#local-6989586621682097547"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GenStgAlt pass -&gt; SDoc) -&gt; [GenStgAlt pass] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgAlt pass -&gt; SDoc
forall (pass :: StgPass).
OutputablePass pass =&gt;
GenStgAlt pass -&gt; SDoc
</span><a href="GHC.Stg.Unarise.html#pprPanicAlt"><span class="hs-identifier hs-var">pprPanicAlt</span></a></span><span> </span><span class="annot"><span class="annottext">[GenStgAlt pass]
</span><a href="#local-6989586621682097547"><span class="hs-identifier hs-var">alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1149"></span><span>
</span><span id="line-1150"></span><span id="local-6989586621682096666"><span class="annot"><a href="GHC.Stg.Unarise.html#pprPanicAlt"><span class="hs-identifier hs-type">pprPanicAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#OutputablePass"><span class="hs-identifier hs-type">OutputablePass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682096666"><span class="hs-identifier hs-type">pass</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682096666"><span class="hs-identifier hs-type">pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span><span>
</span><span id="line-1151"></span><span id="pprPanicAlt"><span class="annot"><span class="annottext">pprPanicAlt :: forall (pass :: StgPass).
OutputablePass pass =&gt;
GenStgAlt pass -&gt; SDoc
</span><a href="GHC.Stg.Unarise.html#pprPanicAlt"><span class="hs-identifier hs-var hs-var">pprPanicAlt</span></a></span></span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#GenStgAlt"><span class="hs-identifier hs-type">GenStgAlt</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">alt_con :: forall (pass :: StgPass). GenStgAlt pass -&gt; AltCon
</span><a href="GHC.Stg.Syntax.html#alt_con"><span class="hs-identifier hs-var">alt_con</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682097559"><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682097559"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">alt_bndrs :: forall (pass :: StgPass). GenStgAlt pass -&gt; [BinderP pass]
</span><a href="GHC.Stg.Syntax.html#alt_bndrs"><span class="hs-identifier hs-var">alt_bndrs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682097560"><span class="annot"><span class="annottext">[BinderP pass]
</span><a href="#local-6989586621682097560"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">alt_rhs :: forall (pass :: StgPass). GenStgAlt pass -&gt; GenStgExpr pass
</span><a href="GHC.Stg.Syntax.html#alt_rhs"><span class="hs-identifier hs-var">alt_rhs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682097561"><span class="annot"><span class="annottext">GenStgExpr pass
</span><a href="#local-6989586621682097561"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AltCon, [BinderP pass], SDoc) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682097559"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[BinderP pass]
</span><a href="#local-6989586621682097560"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">StgPprOpts -&gt; GenStgExpr pass -&gt; SDoc
forall (pass :: StgPass).
OutputablePass pass =&gt;
StgPprOpts -&gt; GenStgExpr pass -&gt; SDoc
</span><a href="GHC.Stg.Syntax.html#pprStgExpr"><span class="hs-identifier hs-var">pprStgExpr</span></a></span><span> </span><span class="annot"><span class="annottext">StgPprOpts
</span><a href="GHC.Stg.Syntax.html#panicStgPprOpts"><span class="hs-identifier hs-var">panicStgPprOpts</span></a></span><span> </span><span class="annot"><span class="annottext">GenStgExpr pass
</span><a href="#local-6989586621682097561"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span></pre></body></html>