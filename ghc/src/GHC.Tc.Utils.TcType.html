<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-- | Types used in the typechecker</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- This module provides the Type interface for front-end parts of the</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- compiler.  These parts</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- * treat &quot;source types&quot; as opaque:</span><span>
</span><span id="line-18"></span><span class="hs-comment">--         newtypes, and predicates are meaningful.</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- * look through usage types</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Tc.Utils.TcType</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-comment">-- Types</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier">TcType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier">TcSigmaType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTypeFRR"><span class="hs-identifier">TcTypeFRR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaTypeFRR"><span class="hs-identifier">TcSigmaTypeFRR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier">TcRhoType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTauType"><span class="hs-identifier">TcTauType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcPredType"><span class="hs-identifier">TcPredType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcThetaType"><span class="hs-identifier">TcThetaType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier">TcTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarSet"><span class="hs-identifier">TcTyVarSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcDTyVarSet"><span class="hs-identifier">TcDTyVarSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyCoVarSet"><span class="hs-identifier">TcTyCoVarSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcDTyCoVarSet"><span class="hs-identifier">TcDTyCoVarSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcKind"><span class="hs-identifier">TcKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcCoVar"><span class="hs-identifier">TcCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyCoVar"><span class="hs-identifier">TcTyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarBinder"><span class="hs-identifier">TcTyVarBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcInvisTVBinder"><span class="hs-identifier">TcInvisTVBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcReqTVBinder"><span class="hs-identifier">TcReqTVBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyCon"><span class="hs-identifier">TcTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MonoTcTyCon"><span class="hs-identifier">MonoTcTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PolyTcTyCon"><span class="hs-identifier">PolyTcTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyConBinder"><span class="hs-identifier">TcTyConBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KnotTied"><span class="hs-identifier">KnotTied</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier">ExpType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#InferResult"><span class="hs-identifier">InferResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpTypeFRR"><span class="hs-identifier">ExpTypeFRR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpSigmaType"><span class="hs-identifier">ExpSigmaType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpSigmaTypeFRR"><span class="hs-identifier">ExpSigmaTypeFRR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpRhoType"><span class="hs-identifier">ExpRhoType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkCheckExpType"><span class="hs-identifier">mkCheckExpType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SyntaxOpType"><span class="hs-identifier">SyntaxOpType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#synKnownType"><span class="hs-identifier">synKnownType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkSynFunTys"><span class="hs-identifier">mkSynFunTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">-- TcLevel</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier">TcLevel</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#topTcLevel"><span class="hs-identifier">topTcLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pushTcLevel"><span class="hs-identifier">pushTcLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTopTcLevel"><span class="hs-identifier">isTopTcLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#strictlyDeeperThan"><span class="hs-identifier">strictlyDeeperThan</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#deeperThanOrSame"><span class="hs-identifier">deeperThanOrSame</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#sameDepthAs"><span class="hs-identifier">sameDepthAs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTypeLevel"><span class="hs-identifier">tcTypeLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyVarLevel"><span class="hs-identifier">tcTyVarLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#maxTcLevel"><span class="hs-identifier">maxTcLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-comment">-- MetaDetails</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarDetails"><span class="hs-identifier">TcTyVarDetails</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pprTcTyVarDetails"><span class="hs-identifier">pprTcTyVarDetails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#vanillaSkolemTvUnk"><span class="hs-identifier">vanillaSkolemTvUnk</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaDetails"><span class="hs-identifier">MetaDetails</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Flexi"><span class="hs-identifier">Flexi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Indirect"><span class="hs-identifier">Indirect</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaInfo"><span class="hs-identifier">MetaInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#skolemSkolInfo"><span class="hs-identifier">skolemSkolInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isImmutableTyVar"><span class="hs-identifier">isImmutableTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier">isSkolemTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isMetaTyVar"><span class="hs-identifier">isMetaTyVar</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isMetaTyVarTy"><span class="hs-identifier">isMetaTyVarTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier">isTyVarTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcIsTcTyVar"><span class="hs-identifier">tcIsTcTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyVarTyVar"><span class="hs-identifier">isTyVarTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isOverlappableTyVar"><span class="hs-identifier">isOverlappableTyVar</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyConableTyVar"><span class="hs-identifier">isTyConableTyVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier">ConcreteTvOrigin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar_maybe"><span class="hs-identifier">isConcreteTyVar_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar"><span class="hs-identifier">isConcreteTyVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy"><span class="hs-identifier">isConcreteTyVarTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy_maybe"><span class="hs-identifier">isConcreteTyVarTy_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isAmbiguousTyVar"><span class="hs-identifier">isAmbiguousTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isCycleBreakerTyVar"><span class="hs-identifier">isCycleBreakerTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#metaTyVarRef"><span class="hs-identifier">metaTyVarRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#metaTyVarInfo"><span class="hs-identifier">metaTyVarInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFlexi"><span class="hs-identifier">isFlexi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isIndirect"><span class="hs-identifier">isIndirect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRuntimeUnkSkol"><span class="hs-identifier">isRuntimeUnkSkol</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#metaTyVarTcLevel"><span class="hs-identifier">metaTyVarTcLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#setMetaTyVarTcLevel"><span class="hs-identifier">setMetaTyVarTcLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#metaTyVarTcLevel_maybe"><span class="hs-identifier">metaTyVarTcLevel_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTouchableMetaTyVar"><span class="hs-identifier">isTouchableMetaTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isPromotableMetaTyVar"><span class="hs-identifier">isPromotableMetaTyVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#findDupTyVarTvs"><span class="hs-identifier">findDupTyVarTvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkTyVarNamePairs"><span class="hs-identifier">mkTyVarNamePairs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">-- Builders</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkInfSigmaTy"><span class="hs-identifier">mkInfSigmaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkSpecSigmaTy"><span class="hs-identifier">mkSpecSigmaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkSigmaTy"><span class="hs-identifier">mkSigmaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier">mkPhiTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcMkPhiTy"><span class="hs-identifier">tcMkPhiTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcMkDFunSigmaTy"><span class="hs-identifier">tcMkDFunSigmaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcMkDFunPhiTy"><span class="hs-identifier">tcMkDFunPhiTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-comment">-- Splitters</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#getTyVar"><span class="hs-identifier">getTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier">getTyVar_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#getCastedTyVar_maybe"><span class="hs-identifier">getCastedTyVar_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinder_maybe"><span class="hs-identifier">tcSplitForAllTyVarBinder_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVars"><span class="hs-identifier">tcSplitForAllTyVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTyVars"><span class="hs-identifier">tcSplitForAllInvisTyVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitSomeForAllTyVars"><span class="hs-identifier">tcSplitSomeForAllTyVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllReqTVBinders"><span class="hs-identifier">tcSplitForAllReqTVBinders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTVBinders"><span class="hs-identifier">tcSplitForAllInvisTVBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTys"><span class="hs-identifier">tcSplitPiTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTy_maybe"><span class="hs-identifier">tcSplitPiTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinders"><span class="hs-identifier">tcSplitForAllTyVarBinders</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPhiTy"><span class="hs-identifier">tcSplitPhiTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPredFunTy_maybe"><span class="hs-identifier">tcSplitPredFunTy_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier">tcSplitFunTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier">tcSplitFunTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcFunArgTy"><span class="hs-identifier">tcFunArgTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcFunResultTy"><span class="hs-identifier">tcFunResultTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcFunResultTyN"><span class="hs-identifier">tcFunResultTyN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTysN"><span class="hs-identifier">tcSplitFunTysN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp"><span class="hs-identifier">tcSplitTyConApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier">tcSplitTyConApp_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon"><span class="hs-identifier">tcTyConAppTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon_maybe"><span class="hs-identifier">tcTyConAppTyCon_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppArgs"><span class="hs-identifier">tcTyConAppArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier">tcSplitAppTy_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy"><span class="hs-identifier">tcSplitAppTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTys"><span class="hs-identifier">tcSplitAppTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcSplitAppTyNoView_maybe"><span class="hs-identifier">tcSplitAppTyNoView_maybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitSigmaTy"><span class="hs-identifier">tcSplitSigmaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitNestedSigmaTys"><span class="hs-identifier">tcSplitNestedSigmaTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">-- Predicates.</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-comment">-- Again, newtypes are opaque</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isSigmaTy"><span class="hs-identifier">isSigmaTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRhoTy"><span class="hs-identifier">isRhoTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRhoExpTy"><span class="hs-identifier">isRhoExpTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier">isOverloadedTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFloatingPrimTy"><span class="hs-identifier">isFloatingPrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isDoubleTy"><span class="hs-identifier">isDoubleTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFloatTy"><span class="hs-identifier">isFloatTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isIntTy"><span class="hs-identifier">isIntTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isWordTy"><span class="hs-identifier">isWordTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier">isStringTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isIntegerTy"><span class="hs-identifier">isIntegerTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isNaturalTy"><span class="hs-identifier">isNaturalTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isBoolTy"><span class="hs-identifier">isBoolTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isUnitTy"><span class="hs-identifier">isUnitTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isCharTy"><span class="hs-identifier">isCharTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier">isTauTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#isTauTyCon"><span class="hs-identifier">isTauTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier">tcIsTyVarTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#isPredTy"><span class="hs-identifier">isPredTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyVarClassPred"><span class="hs-identifier">isTyVarClassPred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#checkValidClsArgs"><span class="hs-identifier">checkValidClsArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#hasTyVarHead"><span class="hs-identifier">hasTyVarHead</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRigidTy"><span class="hs-identifier">isRigidTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">-- Re-exported from GHC.Core.TyCo.Compare</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-comment">-- mainly just for back-compat reasons</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-identifier">eqType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqTypes"><span class="hs-identifier">eqTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#nonDetCmpType"><span class="hs-identifier">nonDetCmpType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#nonDetCmpTypes"><span class="hs-identifier">nonDetCmpTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqTypeX"><span class="hs-identifier">eqTypeX</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#pickyEqType"><span class="hs-identifier">pickyEqType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#tcEqType"><span class="hs-identifier">tcEqType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#tcEqKind"><span class="hs-identifier">tcEqKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#tcEqTypeNoKindCheck"><span class="hs-identifier">tcEqTypeNoKindCheck</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#tcEqTypeVis"><span class="hs-identifier">tcEqTypeVis</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#tcEqTyConApps"><span class="hs-identifier">tcEqTyConApps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqForAllVis"><span class="hs-identifier">eqForAllVis</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqVarBndrs"><span class="hs-identifier">eqVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">-- Misc type manipulators</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#deNoteType"><span class="hs-identifier">deNoteType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="GHC.Core.FVs.html#orphNamesOfType"><span class="hs-identifier">orphNamesOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.FVs.html#orphNamesOfCo"><span class="hs-identifier">orphNamesOfCo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="GHC.Core.FVs.html#orphNamesOfTypes"><span class="hs-identifier">orphNamesOfTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.FVs.html#orphNamesOfCoCon"><span class="hs-identifier">orphNamesOfCoCon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier">getDFunTyKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#evVarPred"><span class="hs-identifier">evVarPred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ambigTkvsOfTy"><span class="hs-identifier">ambigTkvsOfTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-comment">-- Predicate types</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkMinimalBySCs"><span class="hs-identifier">mkMinimalBySCs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#transSuperClasses"><span class="hs-identifier">transSuperClasses</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pickCapturedPreds"><span class="hs-identifier">pickCapturedPreds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#immSuperClasses"><span class="hs-identifier">immSuperClasses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#boxEqPred"><span class="hs-identifier">boxEqPred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isImprovementPred"><span class="hs-identifier">isImprovementPred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Finding type instances</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyFamInsts"><span class="hs-identifier">tcTyFamInsts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVis"><span class="hs-identifier">tcTyFamInstsAndVis</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyFamInstsAndVis"><span class="hs-identifier">tcTyConAppTyFamInstsAndVis</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyFamFree"><span class="hs-identifier">isTyFamFree</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Finding &quot;exact&quot; (non-dead) type variables</span></span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#exactTyCoVarsOfType"><span class="hs-identifier">exactTyCoVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#exactTyCoVarsOfTypes"><span class="hs-identifier">exactTyCoVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#anyRewritableTyVar"><span class="hs-identifier">anyRewritableTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#anyRewritableTyFamApp"><span class="hs-identifier">anyRewritableTyFamApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-comment">-- Foreign import and export</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier">IllegalForeignTypeReason</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier">TypeCannotBeMarshaledReason</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIArgumentTy"><span class="hs-identifier">isFFIArgumentTy</span></a></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: DynFlags -&gt; Safety -&gt; Type -&gt; Bool</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIImportResultTy"><span class="hs-identifier">isFFIImportResultTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: DynFlags -&gt; Type -&gt; Bool</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIExportResultTy"><span class="hs-identifier">isFFIExportResultTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: Type -&gt; Bool</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIExternalTy"><span class="hs-identifier">isFFIExternalTy</span></a></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: Type -&gt; Bool</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIDynTy"><span class="hs-identifier">isFFIDynTy</span></a></span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Type -&gt; Type -&gt; Bool</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIPrimArgumentTy"><span class="hs-identifier">isFFIPrimArgumentTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: DynFlags -&gt; Type -&gt; Bool</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIPrimResultTy"><span class="hs-identifier">isFFIPrimResultTy</span></a></span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- :: DynFlags -&gt; Type -&gt; Bool</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFILabelTy"><span class="hs-identifier">isFFILabelTy</span></a></span><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- :: Type -&gt; Bool</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFunPtrTy"><span class="hs-identifier">isFunPtrTy</span></a></span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Type -&gt; Bool</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitIOType_maybe"><span class="hs-identifier">tcSplitIOType_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: Type -&gt; Maybe Type</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">-- Patersons sizes</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier">PatersonSize</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSizeFailure"><span class="hs-identifier">PatersonSizeFailure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ltPatersonSize"><span class="hs-identifier">ltPatersonSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeZero"><span class="hs-identifier">pSizeZero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeOne"><span class="hs-identifier">pSizeOne</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeType"><span class="hs-identifier">pSizeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier">pSizeTypeX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypes"><span class="hs-identifier">pSizeTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeClassPred"><span class="hs-identifier">pSizeClassPred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeClassPredX"><span class="hs-identifier">pSizeClassPredX</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTyConApp"><span class="hs-identifier">pSizeTyConApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#noMoreTyVars"><span class="hs-identifier">noMoreTyVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#allDistinctTyVars"><span class="hs-identifier">allDistinctTyVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeSize"><span class="hs-identifier">TypeSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#sizeType"><span class="hs-identifier">sizeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#sizeTypes"><span class="hs-identifier">sizeTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier">scopedSort</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTerminatingClass"><span class="hs-identifier">isTerminatingClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isStuckTypeFamily"><span class="hs-identifier">isStuckTypeFamily</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">-- Reexported from Kind</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier">Kind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier">liftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier">constraintKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier">isLiftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedTypeKind"><span class="hs-identifier">isUnliftedTypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier">isTYPEorCONSTRAINT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- Reexported from Type</span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier">PredType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier">ThetaType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#PiTyBinder"><span class="hs-identifier">PiTyBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyFlag"><span class="hs-identifier">ForAllTyFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#FunTyFlag"><span class="hs-identifier">FunTyFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkForAllTy"><span class="hs-identifier">mkForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkForAllTys"><span class="hs-identifier">mkForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier">mkInvisForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTys"><span class="hs-identifier">mkTyCoInvForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#mkSpecForAllTys"><span class="hs-identifier">mkSpecForAllTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyCoInvForAllTy"><span class="hs-identifier">mkTyCoInvForAllTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTy"><span class="hs-identifier">mkInfForAllTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkInfForAllTys"><span class="hs-identifier">mkInfForAllTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTy"><span class="hs-identifier">mkVisFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTyMany"><span class="hs-identifier">mkVisFunTyMany</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkVisFunTysMany"><span class="hs-identifier">mkVisFunTysMany</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkScaledFunTys"><span class="hs-identifier">mkScaledFunTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTy"><span class="hs-identifier">mkInvisFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTys"><span class="hs-identifier">mkInvisFunTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier">mkTyConApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier">mkAppTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier">mkAppTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCon.html#mkTyConTy"><span class="hs-identifier">mkTyConTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier">mkTyVarTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier">mkTyVarTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyCoVarTy"><span class="hs-identifier">mkTyCoVarTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyCoVarTys"><span class="hs-identifier">mkTyCoVarTys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="GHC.Core.Predicate.html#isClassPred"><span class="hs-identifier">isClassPred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#isEqPrimPred"><span class="hs-identifier">isEqPrimPred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#isIPLikePred"><span class="hs-identifier">isIPLikePred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#isEqPred"><span class="hs-identifier">isEqPred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#isEqPredClass"><span class="hs-identifier">isEqPredClass</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><a href="GHC.Core.Predicate.html#mkClassPred"><span class="hs-identifier">mkClassPred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitQuantPredTy"><span class="hs-identifier">tcSplitQuantPredTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitDFunTy"><span class="hs-identifier">tcSplitDFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitDFunHead"><span class="hs-identifier">tcSplitDFunHead</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitMethodTy"><span class="hs-identifier">tcSplitMethodTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#isRuntimeRepVar"><span class="hs-identifier">isRuntimeRepVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isFixedRuntimeRepKind"><span class="hs-identifier">isFixedRuntimeRepKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><a href="GHC.Types.Var.html#isVisiblePiTyBinder"><span class="hs-identifier">isVisiblePiTyBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isInvisiblePiTyBinder"><span class="hs-identifier">isInvisiblePiTyBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-comment">-- Type substitutions</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier">Subst</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- Representation visible to a few friends</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier">TvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptySubst"><span class="hs-identifier">emptySubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier">mkEmptySubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier">zipTvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier">mkTvSubstPrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#notElemSubst"><span class="hs-identifier">notElemSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#unionSubst"><span class="hs-identifier">unionSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTvSubstEnv"><span class="hs-identifier">getTvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getSubstInScope"><span class="hs-identifier">getSubstInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendSubstInScope"><span class="hs-identifier">extendSubstInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendSubstInScopeList"><span class="hs-identifier">extendSubstInScopeList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendSubstInScopeSet"><span class="hs-identifier">extendSubstInScopeSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstAndInScope"><span class="hs-identifier">extendTvSubstAndInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier">Type.lookupTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier">Type.extendTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndr"><span class="hs-identifier">Type.substTyVarBndr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier">Type.extendTvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isInScope"><span class="hs-identifier">isInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkSubst"><span class="hs-identifier">mkSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier">mkTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier">zipTyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipCoEnv"><span class="hs-identifier">zipCoEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier">Type.substTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier">substTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTys"><span class="hs-identifier">substScaledTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWith"><span class="hs-identifier">substTyWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithCoVars"><span class="hs-identifier">substTyWithCoVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyAddInScope"><span class="hs-identifier">substTyAddInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier">substTyUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysUnchecked"><span class="hs-identifier">substTysUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTyUnchecked"><span class="hs-identifier">substScaledTyUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substThetaUnchecked"><span class="hs-identifier">substThetaUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithUnchecked"><span class="hs-identifier">substTyWithUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier">substCoUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoWithUnchecked"><span class="hs-identifier">substCoWithUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTheta"><span class="hs-identifier">substTheta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier">isUnliftedType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#isUnboxedTupleType"><span class="hs-identifier">isUnboxedTupleType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#isPrimitiveType"><span class="hs-identifier">isPrimitiveType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier">coreView</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier">tyCoVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier">tyCoVarsOfTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKinds"><span class="hs-identifier">closeOverKinds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier">tyCoFVsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier">tyCoFVsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeDSet"><span class="hs-identifier">tyCoVarsOfTypeDSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesDSet"><span class="hs-identifier">tyCoVarsOfTypesDSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsDSet"><span class="hs-identifier">closeOverKindsDSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier">tyCoVarsOfTypeList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesList"><span class="hs-identifier">tyCoVarsOfTypesList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier">noFreeVarsOfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-comment">--------------------------------</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprKind"><span class="hs-identifier">pprKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprParendKind"><span class="hs-identifier">pprParendKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprSigmaType"><span class="hs-identifier">pprSigmaType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprType"><span class="hs-identifier">pprType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprParendType"><span class="hs-identifier">pprParendType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprTypeApp"><span class="hs-identifier">pprTypeApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprTheta"><span class="hs-identifier">pprTheta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprParendTheta"><span class="hs-identifier">pprParendTheta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprThetaArrowTy"><span class="hs-identifier">pprThetaArrowTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprClassPred"><span class="hs-identifier">pprClassPred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprTCvBndr"><span class="hs-identifier">pprTCvBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprTCvBndrs"><span class="hs-identifier">pprTCvBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-comment">-- argument visibility</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConVisibilities"><span class="hs-identifier">tcTyConVisibilities</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isNextTyConArgVisible"><span class="hs-identifier">isNextTyConArgVisible</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isNextArgVisible"><span class="hs-identifier">isNextArgVisible</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- friends:</span><span>
</span><span id="line-215"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-218"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html"><span class="hs-identifier">GHC.Core.TyCo.Subst</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier">mkTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithCoVars"><span class="hs-identifier">substTyWithCoVars</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html"><span class="hs-identifier">GHC.Core.TyCo.Compare</span></a></span><span>
</span><span id="line-220"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html"><span class="hs-identifier">GHC.Core.TyCo.FVs</span></a></span><span>
</span><span id="line-221"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html"><span class="hs-identifier">GHC.Core.TyCo.Ppr</span></a></span><span>
</span><span id="line-222"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Class.html"><span class="hs-identifier">GHC.Core.Class</span></a></span><span>
</span><span id="line-223"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-224"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html"><span class="hs-identifier">GHC.Types.ForeignCall</span></a></span><span>
</span><span id="line-225"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span>
</span><span id="line-226"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span>
</span><span id="line-227"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Type</span></span><span>
</span><span id="line-228"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html"><span class="hs-identifier">GHC.Core.Predicate</span></a></span><span>
</span><span id="line-229"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html"><span class="hs-identifier">GHC.Types.RepType</span></a></span><span>
</span><span id="line-230"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html"><span class="hs-identifier">GHC.Tc.Types.Origin</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#SkolemInfo"><span class="hs-identifier">SkolemInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#unkSkol"><span class="hs-identifier">unkSkol</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#FixedRuntimeRepOrigin"><span class="hs-identifier">FixedRuntimeRepOrigin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#FixedRuntimeRepContext"><span class="hs-identifier">FixedRuntimeRepContext</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- others:</span><span>
</span><span id="line-237"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-238"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FVs.html"><span class="hs-identifier">GHC.Core.FVs</span></a></span><span>
</span><span id="line-239"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Name</span></span><span>
</span><span id="line-240"></span><span>            </span><span class="hs-comment">-- We use this to make dictionaries for type literals.</span><span>
</span><span id="line-241"></span><span>            </span><span class="hs-comment">-- Perhaps there's a better way to do this?</span><span>
</span><span id="line-242"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html"><span class="hs-identifier">GHC.Types.Name.Set</span></a></span><span>
</span><span id="line-243"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-244"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#coercibleClass"><span class="hs-identifier">coercibleClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#eqClass"><span class="hs-identifier">eqClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#heqClass"><span class="hs-identifier">heqClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#unitTyCon"><span class="hs-identifier">unitTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#unitTyConKey"><span class="hs-identifier">unitTyConKey</span></a></span><span>
</span><span id="line-245"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#listTyCon"><span class="hs-identifier">listTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#constraintKind"><span class="hs-identifier">constraintKind</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-247"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-248"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>
</span><span id="line-249"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html"><span class="hs-identifier">GHC.Data.List.SetOps</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html#getNth"><span class="hs-identifier">getNth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html#findDupsEq"><span class="hs-identifier">findDupsEq</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-251"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-252"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html"><span class="hs-identifier">GHC.Utils.Panic.Plain</span></a></span><span>
</span><span id="line-253"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier">Validity'</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html"><span class="hs-identifier">GHC.Utils.Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Unique.html#anyOfUnique"><span class="hs-identifier">anyOfUnique</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../ghc-boot-9.6.7/src/GHC.LanguageExtensions.html#/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC.LanguageExtensions</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LangExt</span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.IORef.html#/Data.IORef.html"><span class="hs-identifier">Data.IORef</span></a></span><span>
</span><span id="line-258"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.List.NonEmpty.html#/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#NonEmpty/GHC.Base.html#NonEmpty"><span class="hs-identifier">NonEmpty</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.List.html#/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.OldList.html#partition/Data.OldList.html#partition"><span class="hs-identifier">partition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.OldList.html#nub/Data.OldList.html#nub"><span class="hs-identifier">nub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.OldList.html#%5C%5C/Data.OldList.html#%5C%5C"><span class="hs-operator">(\\)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Generics.html#/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Generics.html#Generic/GHC.Generics.html#Generic"><span class="hs-identifier">Generic</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
              Types
*                                                                      *
************************************************************************

The type checker divides the generic Type world into the
following more structured beasts:

sigma ::= forall tyvars. phi
        -- A sigma type is a qualified type
        --
        -- Note that even if 'tyvars' is empty, theta
        -- may not be: e.g.   (?x::Int) =&gt; Int

        -- Note that 'sigma' is in prenex form:
        -- all the foralls are at the front.
        -- A 'phi' type has no foralls to the right of
        -- an arrow

phi :: theta =&gt; rho

rho ::= sigma -&gt; rho
     |  tau

-- A 'tau' type has no quantification anywhere
-- Note that the args of a type constructor must be taus
tau ::= tyvar
     |  tycon tau_1 .. tau_n
     |  tau_1 tau_2
     |  tau_1 -&gt; tau_2

-- In all cases, a (saturated) type synonym application is legal,
-- provided it expands to the required form.

Note [TcTyVars and TyVars in the typechecker]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The typechecker uses a lot of type variables with special properties,
notably being a unification variable with a mutable reference.  These
use the 'TcTyVar' variant of Var.Var.

Note, though, that a /bound/ type variable can (and probably should)
be a TyVar.  E.g
    forall a. a -&gt; a
Here 'a' is really just a deBruijn-number; it certainly does not have
a significant TcLevel (as every TcTyVar does).  So a forall-bound type
variable should be TyVars; and hence a TyVar can appear free in a TcType.

The type checker and constraint solver can also encounter /free/ type
variables that use the 'TyVar' variant of Var.Var, for a couple of
reasons:

  - When typechecking a class decl, say
       class C (a :: k) where
          foo :: T a -&gt; Int
    We have first kind-check the header; fix k and (a:k) to be
    TyVars, bring 'k' and 'a' into scope, and kind check the
    signature for 'foo'.  In doing so we call solveEqualities to
    solve any kind equalities in foo's signature.  So the solver
    may see free occurrences of 'k'.

    See calls to tcExtendTyVarEnv for other places that ordinary
    TyVars are bought into scope, and hence may show up in the types
    and kinds generated by GHC.Tc.Gen.HsType.

  - The pattern-match overlap checker calls the constraint solver,
    long after TcTyVars have been zonked away

It's convenient to simply treat these TyVars as skolem constants,
which of course they are.  We give them a level number of &quot;outermost&quot;,
so they behave as global constants.  Specifically:

* Var.tcTyVarDetails succeeds on a TyVar, returning
  vanillaSkolemTv, as well as on a TcTyVar.

* tcIsTcTyVar returns True for both TyVar and TcTyVar variants
  of Var.Var.  The &quot;tc&quot; prefix means &quot;a type variable that can be
  encountered by the typechecker&quot;.

This is a bit of a change from an earlier era when we remorselessly
insisted on real TcTyVars in the type checker.  But that seems
unnecessary (for skolems, TyVars are fine) and it's now very hard
to guarantee, with the advent of kind equalities.

Note [Coercion variables in free variable lists]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
There are several places in the GHC codebase where functions like
tyCoVarsOfType, tyCoVarsOfCt, et al. are used to compute the free type
variables of a type. The &quot;Co&quot; part of these functions' names shouldn't be
dismissed, as it is entirely possible that they will include coercion variables
in addition to type variables! As a result, there are some places in GHC.Tc.Utils.TcType
where we must take care to check that a variable is a _type_ variable (using
isTyVar) before calling tcTyVarDetails--a partial function that is not defined
for coercion variables--on the variable. Failing to do so led to
GHC #12785.
-}</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- See Note [TcTyVars and TyVars in the typechecker]</span><span>
</span><span id="line-362"></span><span class="hs-keyword">type</span><span> </span><span id="TcCoVar"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcCoVar"><span class="hs-identifier hs-var">TcCoVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span>    </span><span class="hs-comment">-- Used only during type inference</span><span>
</span><span id="line-363"></span><span class="hs-keyword">type</span><span> </span><span id="TcType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-var">TcType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>      </span><span class="hs-comment">-- A TcType can have mutable type variables</span><span>
</span><span id="line-364"></span><span class="hs-keyword">type</span><span> </span><span id="TcTyCoVar"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyCoVar"><span class="hs-identifier hs-var">TcTyCoVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>    </span><span class="hs-comment">-- Either a TcTyVar or a CoVar</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | A type which has a syntactically fixed RuntimeRep as per</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- Note [Fixed RuntimeRep] in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-368"></span><span class="hs-keyword">type</span><span> </span><span id="TcTypeFRR"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTypeFRR"><span class="hs-identifier hs-var">TcTypeFRR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-comment">-- TODO: consider making this a newtype.</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-keyword">type</span><span> </span><span id="TcTyVarBinder"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarBinder"><span class="hs-identifier hs-var">TcTyVarBinder</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a></span><span>
</span><span id="line-372"></span><span class="hs-keyword">type</span><span> </span><span id="TcInvisTVBinder"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcInvisTVBinder"><span class="hs-identifier hs-var">TcInvisTVBinder</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#InvisTVBinder"><span class="hs-identifier hs-type">InvisTVBinder</span></a></span><span>
</span><span id="line-373"></span><span class="hs-keyword">type</span><span> </span><span id="TcReqTVBinder"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcReqTVBinder"><span class="hs-identifier hs-var">TcReqTVBinder</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ReqTVBinder"><span class="hs-identifier hs-type">ReqTVBinder</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- See Note [TcTyCon, MonoTcTyCon, and PolyTcTyCon]</span><span>
</span><span id="line-376"></span><span class="hs-keyword">type</span><span> </span><span id="TcTyCon"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyCon"><span class="hs-identifier hs-var">TcTyCon</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-377"></span><span class="hs-keyword">type</span><span> </span><span id="MonoTcTyCon"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MonoTcTyCon"><span class="hs-identifier hs-var">MonoTcTyCon</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyCon"><span class="hs-identifier hs-type">TcTyCon</span></a></span><span>
</span><span id="line-378"></span><span class="hs-keyword">type</span><span> </span><span id="PolyTcTyCon"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PolyTcTyCon"><span class="hs-identifier hs-var">PolyTcTyCon</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyCon"><span class="hs-identifier hs-type">TcTyCon</span></a></span><span>
</span><span id="line-379"></span><span class="hs-keyword">type</span><span> </span><span id="TcTyConBinder"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyConBinder"><span class="hs-identifier hs-var">TcTyConBinder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a></span><span> </span><span class="hs-comment">-- With skolem TcTyVars</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- These types do not have boxy type variables in them</span><span>
</span><span id="line-382"></span><span class="hs-keyword">type</span><span> </span><span id="TcPredType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcPredType"><span class="hs-identifier hs-var">TcPredType</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span>
</span><span id="line-383"></span><span class="hs-keyword">type</span><span> </span><span id="TcThetaType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcThetaType"><span class="hs-identifier hs-var">TcThetaType</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span>
</span><span id="line-384"></span><span class="hs-keyword">type</span><span> </span><span id="TcSigmaType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-var">TcSigmaType</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | A 'TcSigmaTypeFRR' is a 'TcSigmaType' which has a syntactically</span><span>
</span><span id="line-387"></span><span class="hs-comment">--  fixed 'RuntimeRep' in the sense of Note [Fixed RuntimeRep]</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-389"></span><span class="hs-comment">--</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- In particular, this means that:</span><span>
</span><span id="line-391"></span><span class="hs-comment">--</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- - 'GHC.Types.RepType.typePrimRep' does not panic,</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- - 'GHC.Core.typeLevity_maybe' does not return 'Nothing'.</span><span>
</span><span id="line-394"></span><span class="hs-comment">--</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- This property is important in functions such as 'matchExpectedFunTys', where</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- we want to provide argument types which have a known runtime representation.</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- See Note [Return arguments with a fixed RuntimeRep.</span><span>
</span><span id="line-398"></span><span class="hs-keyword">type</span><span> </span><span id="TcSigmaTypeFRR"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaTypeFRR"><span class="hs-identifier hs-var">TcSigmaTypeFRR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-comment">-- TODO: consider making this a newtype.</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-keyword">type</span><span> </span><span id="TcRhoType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-var">TcRhoType</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span>  </span><span class="hs-comment">-- Note [TcRhoType]</span><span>
</span><span id="line-402"></span><span class="hs-keyword">type</span><span> </span><span id="TcTauType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTauType"><span class="hs-identifier hs-var">TcTauType</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span>
</span><span id="line-403"></span><span class="hs-keyword">type</span><span> </span><span id="TcKind"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcKind"><span class="hs-identifier hs-var">TcKind</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-404"></span><span class="hs-keyword">type</span><span> </span><span id="TcTyVarSet"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarSet"><span class="hs-identifier hs-var">TcTyVarSet</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a></span><span>
</span><span id="line-405"></span><span class="hs-keyword">type</span><span> </span><span id="TcTyCoVarSet"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyCoVarSet"><span class="hs-identifier hs-var">TcTyCoVarSet</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-406"></span><span class="hs-keyword">type</span><span> </span><span id="TcDTyVarSet"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcDTyVarSet"><span class="hs-identifier hs-var">TcDTyVarSet</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DTyVarSet"><span class="hs-identifier hs-type">DTyVarSet</span></a></span><span>
</span><span id="line-407"></span><span class="hs-keyword">type</span><span> </span><span id="TcDTyCoVarSet"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcDTyCoVarSet"><span class="hs-identifier hs-var">TcDTyCoVarSet</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DTyCoVarSet"><span class="hs-identifier hs-type">DTyCoVarSet</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">{- Note [TcTyCon, MonoTcTyCon, and PolyTcTyCon]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
See Note [How TcTyCons work] in GHC.Tc.TyCl

Invariants:

* TcTyCon: a TyCon built with the TcTyCon constructor

* TcTyConBinder: a TyConBinder with a TcTyVar inside (not a TyVar)

* TcTyCons contain TcTyVars

* MonoTcTyCon:
  - Flag tcTyConIsPoly = False

  - tyConScopedTyVars is important; maps a Name to a TyVarTv unification variable
    The order is important: Specified then Required variables.   E.g. in
        data T a (b :: k) = ...
    the order will be [k, a, b].

    NB: There are no Inferred binders in tyConScopedTyVars; 'a' may
    also be poly-kinded, but that kind variable will be added by
    generaliseTcTyCon, in the passage to a PolyTcTyCon.

  - tyConBinders are irrelevant; we just use tcTyConScopedTyVars
    Well not /quite/ irrelevant: its length gives the number of Required binders,
    and so allows up to distinguish between the Specified and Required elements of
    tyConScopedTyVars.

* PolyTcTyCon:
  - Flag tcTyConIsPoly = True; this is used only to short-cut zonking

  - tyConBinders are still TcTyConBinders, but they are /skolem/ TcTyVars,
    with fixed kinds, and accurate skolem info: no unification variables here

    tyConBinders includes the Inferred binders if any

    tyConBinders uses the Names from the original, renamed program.

  - tcTyConScopedTyVars is irrelevant: just use (binderVars tyConBinders)
    All the types have been swizzled back to use the original Names
    See Note [tyConBinders and lexical scoping] in GHC.Core.TyCon

-}</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          ExpType: an &quot;expected type&quot; in the type checker
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | An expected type to check against during type-checking.</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- See Note [ExpType] in &quot;GHC.Tc.Utils.TcMType&quot;, where you'll also find manipulators.</span><span>
</span><span id="line-462"></span><span class="hs-keyword">data</span><span> </span><span id="ExpType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-var">ExpType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Check"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Check"><span class="hs-identifier hs-var">Check</span></a></span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span>
</span><span id="line-463"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Infer"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Infer"><span class="hs-identifier hs-var">Infer</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#InferResult"><span class="hs-identifier hs-type">InferResult</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-keyword">data</span><span> </span><span id="InferResult"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#InferResult"><span class="hs-identifier hs-var">InferResult</span></a></span></span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="IR"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IR"><span class="hs-identifier hs-var">IR</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="ir_uniq"><span class="annot"><span class="annottext">InferResult -&gt; Unique
</span><a href="GHC.Tc.Utils.TcType.html#ir_uniq"><span class="hs-identifier hs-var hs-var">ir_uniq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-467"></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ This 'Unique' is for debugging only</span></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="ir_lvl"><span class="annot"><span class="annottext">InferResult -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#ir_lvl"><span class="hs-identifier hs-var hs-var">ir_lvl</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-470"></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ See Note [TcLevel of ExpType] in GHC.Tc.Utils.TcMType</span></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="ir_frr"><span class="annot"><span class="annottext">InferResult -&gt; Maybe FixedRuntimeRepContext
</span><a href="GHC.Tc.Utils.TcType.html#ir_frr"><span class="hs-identifier hs-var hs-var">ir_frr</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#FixedRuntimeRepContext"><span class="hs-identifier hs-type">FixedRuntimeRepContext</span></a></span><span>
</span><span id="line-473"></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ See Note [FixedRuntimeRep context in ExpType] in GHC.Tc.Utils.TcMType</span></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="ir_ref"><span class="annot"><span class="annottext">InferResult -&gt; IORef (Maybe Type)
</span><a href="GHC.Tc.Utils.TcType.html#ir_ref"><span class="hs-identifier hs-var hs-var">ir_ref</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.IORef.html#IORef/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-476"></span><span>         </span><span class="hs-comment">-- ^ The type that fills in this hole should be a @Type@,</span><span>
</span><span id="line-477"></span><span>         </span><span class="hs-comment">-- that is, its kind should be @TYPE rr@ for some @rr :: RuntimeRep@.</span><span>
</span><span id="line-478"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-479"></span><span>         </span><span class="hs-comment">-- Additionally, if the 'ir_frr' field is @Just frr_orig@ then</span><span>
</span><span id="line-480"></span><span>         </span><span class="hs-comment">-- @rr@ must be concrete, in the sense of Note [Concrete types]</span><span>
</span><span id="line-481"></span><span>         </span><span class="hs-comment">-- in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-keyword">type</span><span> </span><span id="ExpSigmaType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpSigmaType"><span class="hs-identifier hs-var">ExpSigmaType</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">-- | An 'ExpType' which has a fixed RuntimeRep.</span><span>
</span><span id="line-486"></span><span class="hs-comment">--</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- For a 'Check' 'ExpType', the stored 'TcType' must have</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- a fixed RuntimeRep. For an 'Infer' 'ExpType', the 'ir_frr'</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- field must be of the form @Just frr_orig@.</span><span>
</span><span id="line-490"></span><span class="hs-keyword">type</span><span> </span><span id="ExpTypeFRR"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpTypeFRR"><span class="hs-identifier hs-var">ExpTypeFRR</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">-- | Like 'TcSigmaTypeFRR', but for an expected type.</span><span>
</span><span id="line-493"></span><span class="hs-comment">--</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- See 'ExpTypeFRR'.</span><span>
</span><span id="line-495"></span><span class="hs-keyword">type</span><span> </span><span id="ExpSigmaTypeFRR"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpSigmaTypeFRR"><span class="hs-identifier hs-var">ExpSigmaTypeFRR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpTypeFRR"><span class="hs-identifier hs-type">ExpTypeFRR</span></a></span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-comment">-- TODO: consider making this a newtype.</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-keyword">type</span><span> </span><span id="ExpRhoType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpRhoType"><span class="hs-identifier hs-var">ExpRhoType</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>  </span><span id="local-6989586621681683018"><span class="annot"><span class="annottext">ppr :: ExpType -&gt; SDoc
</span><a href="#local-6989586621681683018"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span> </span><span id="local-6989586621681683020"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683020"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Check&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683020"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Infer"><span class="hs-identifier hs-type">Infer</span></a></span><span> </span><span id="local-6989586621681683024"><span class="annot"><span class="annottext">InferResult
</span><a href="#local-6989586621681683024"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InferResult -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">InferResult
</span><a href="#local-6989586621681683024"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#InferResult"><span class="hs-identifier hs-type">InferResult</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-505"></span><span>  </span><span id="local-6989586621681683039"><span class="annot"><span class="annottext">ppr :: InferResult -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IR"><span class="hs-identifier hs-type">IR</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ir_uniq :: InferResult -&gt; Unique
</span><a href="GHC.Tc.Utils.TcType.html#ir_uniq"><span class="hs-identifier hs-var">ir_uniq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683040"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681683040"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ir_lvl :: InferResult -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#ir_lvl"><span class="hs-identifier hs-var">ir_lvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683041"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683041"><span class="hs-identifier hs-var">lvl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ir_frr :: InferResult -&gt; Maybe FixedRuntimeRepContext
</span><a href="GHC.Tc.Utils.TcType.html#ir_frr"><span class="hs-identifier hs-var">ir_frr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683042"><span class="annot"><span class="annottext">Maybe FixedRuntimeRepContext
</span><a href="#local-6989586621681683042"><span class="hs-identifier hs-var">mb_frr</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Infer&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681683043"><span class="hs-identifier hs-var">mb_frr_text</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681683040"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683041"><span class="hs-identifier hs-var">lvl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-508"></span><span>      </span><span id="local-6989586621681683043"><span class="annot"><span class="annottext">mb_frr_text :: SDoc
</span><a href="#local-6989586621681683043"><span class="hs-identifier hs-var hs-var">mb_frr_text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FixedRuntimeRepContext
</span><a href="#local-6989586621681683042"><span class="hs-identifier hs-var">mb_frr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-509"></span><span>        </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepContext
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FRR&quot;</span></span><span>
</span><span id="line-510"></span><span>        </span><span class="annot"><span class="annottext">Maybe FixedRuntimeRepContext
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="annot"><span class="hs-comment">-- | Make an 'ExpType' suitable for checking.</span></span><span>
</span><span id="line-513"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkCheckExpType"><span class="hs-identifier hs-type">mkCheckExpType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a></span><span>
</span><span id="line-514"></span><span id="mkCheckExpType"><span class="annot"><span class="annottext">mkCheckExpType :: Type -&gt; ExpType
</span><a href="GHC.Tc.Utils.TcType.html#mkCheckExpType"><span class="hs-identifier hs-var hs-var">mkCheckExpType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ExpType
</span><a href="GHC.Tc.Utils.TcType.html#Check"><span class="hs-identifier hs-var">Check</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          SyntaxOpType
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="hs-comment">-- | What to expect for an argument to a rebindable-syntax operator.</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- Quite like 'Type', but allows for holes to be filled in by tcSyntaxOp.</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- The callback called from tcSyntaxOp gets a list of types; the meaning</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- of these types is determined by a left-to-right depth-first traversal</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- of the 'SyntaxOpType' tree. So if you pass in</span><span>
</span><span id="line-528"></span><span class="hs-comment">--</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- &gt; SynAny `SynFun` (SynList `SynFun` SynType Int) `SynFun` SynAny</span><span>
</span><span id="line-530"></span><span class="hs-comment">--</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- you'll get three types back: one for the first 'SynAny', the /element/</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- type of the list, and one for the last 'SynAny'. You don't get anything</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- for the 'SynType', because you've said positively that it should be an</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- Int, and so it shall be.</span><span>
</span><span id="line-535"></span><span class="hs-comment">--</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- You'll also get three multiplicities back: one for each function arrow. See</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- also Note [Linear types] in Multiplicity.</span><span>
</span><span id="line-538"></span><span class="hs-comment">--</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- This is defined here to avoid defining it in &quot;GHC.Tc.Gen.Expr&quot; boot file.</span><span>
</span><span id="line-540"></span><span class="hs-keyword">data</span><span> </span><span id="SyntaxOpType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SyntaxOpType"><span class="hs-identifier hs-var">SyntaxOpType</span></a></span></span><span>
</span><span id="line-541"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="SynAny"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SynAny"><span class="hs-identifier hs-var">SynAny</span></a></span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Any type</span></span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SynRho"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SynRho"><span class="hs-identifier hs-var">SynRho</span></a></span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ A rho type, skolemised or instantiated as appropriate</span></span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SynList"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SynList"><span class="hs-identifier hs-var">SynList</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ A list type. You get back the element type of the list</span></span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SynFun"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SynFun"><span class="hs-identifier hs-var">SynFun</span></a></span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SyntaxOpType"><span class="hs-identifier hs-type">SyntaxOpType</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SyntaxOpType"><span class="hs-identifier hs-type">SyntaxOpType</span></a></span><span>
</span><span id="line-545"></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ A function.</span></span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SynType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SynType"><span class="hs-identifier hs-var">SynType</span></a></span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ A known type.</span></span><span>
</span><span id="line-547"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SynFun"><span class="hs-operator hs-type">`SynFun`</span></a></span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="annot"><span class="hs-comment">-- | Like 'SynType' but accepts a regular TcType</span></span><span>
</span><span id="line-550"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#synKnownType"><span class="hs-identifier hs-type">synKnownType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SyntaxOpType"><span class="hs-identifier hs-type">SyntaxOpType</span></a></span><span>
</span><span id="line-551"></span><span id="synKnownType"><span class="annot"><span class="annottext">synKnownType :: Type -&gt; SyntaxOpType
</span><a href="GHC.Tc.Utils.TcType.html#synKnownType"><span class="hs-identifier hs-var hs-var">synKnownType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpType -&gt; SyntaxOpType
</span><a href="GHC.Tc.Utils.TcType.html#SynType"><span class="hs-identifier hs-var">SynType</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpType -&gt; SyntaxOpType)
-&gt; (Type -&gt; ExpType) -&gt; Type -&gt; SyntaxOpType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ExpType
</span><a href="GHC.Tc.Utils.TcType.html#mkCheckExpType"><span class="hs-identifier hs-var">mkCheckExpType</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="annot"><span class="hs-comment">-- | Like 'mkFunTys' but for 'SyntaxOpType'</span></span><span>
</span><span id="line-554"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkSynFunTys"><span class="hs-identifier hs-type">mkSynFunTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SyntaxOpType"><span class="hs-identifier hs-type">SyntaxOpType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SyntaxOpType"><span class="hs-identifier hs-type">SyntaxOpType</span></a></span><span>
</span><span id="line-555"></span><span id="mkSynFunTys"><span class="annot"><span class="annottext">mkSynFunTys :: [SyntaxOpType] -&gt; ExpType -&gt; SyntaxOpType
</span><a href="GHC.Tc.Utils.TcType.html#mkSynFunTys"><span class="hs-identifier hs-var hs-var">mkSynFunTys</span></a></span></span><span> </span><span id="local-6989586621681683052"><span class="annot"><span class="annottext">[SyntaxOpType]
</span><a href="#local-6989586621681683052"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span id="local-6989586621681683053"><span class="annot"><span class="annottext">ExpType
</span><a href="#local-6989586621681683053"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SyntaxOpType -&gt; SyntaxOpType -&gt; SyntaxOpType)
-&gt; SyntaxOpType -&gt; [SyntaxOpType] -&gt; SyntaxOpType
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxOpType -&gt; SyntaxOpType -&gt; SyntaxOpType
</span><a href="GHC.Tc.Utils.TcType.html#SynFun"><span class="hs-identifier hs-var">SynFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpType -&gt; SyntaxOpType
</span><a href="GHC.Tc.Utils.TcType.html#SynType"><span class="hs-identifier hs-var">SynType</span></a></span><span> </span><span class="annot"><span class="annottext">ExpType
</span><a href="#local-6989586621681683053"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SyntaxOpType]
</span><a href="#local-6989586621681683052"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span class="hs-comment">{-
Note [TcRhoType]
~~~~~~~~~~~~~~~~
A TcRhoType has no foralls or contexts at the top
  NO     forall a. a -&gt;  Int
  NO     Eq a =&gt; a -&gt; a
  YES    a -&gt; a
  YES    (forall a. a-&gt;a) -&gt; Int
  YES    Int -&gt; forall a. a -&gt; Int


************************************************************************
*                                                                      *
        TyVarDetails, MetaDetails, MetaInfo
*                                                                      *
************************************************************************

TyVarDetails gives extra info about type variables, used during type
checking.  It's attached to mutable type variables only.
It's knot-tied back to &quot;GHC.Types.Var&quot;.  There is no reason in principle
why &quot;GHC.Types.Var&quot; shouldn't actually have the definition, but it &quot;belongs&quot; here.

Note [TyVars and TcTyVars during type checking]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The Var type has constructors TyVar and TcTyVar.  They are used
as follows:

* TcTyVar: used /only/ during type checking.  Should never appear
  afterwards.  May contain a mutable field, in the MetaTv case.

* TyVar: is never seen by the constraint solver, except locally
  inside a type like (forall a. [a] -&gt;[a]), where 'a' is a TyVar.
  We instantiate these with TcTyVars before exposing the type
  to the constraint solver.

I have swithered about the latter invariant, excluding TyVars from the
constraint solver.  It's not strictly essential, and indeed
(historically but still there) Var.tcTyVarDetails returns
vanillaSkolemTv for a TyVar.

But ultimately I want to separate Type from TcType, and in that case
we would need to enforce the separation.

Note [Keeping SkolemInfo inside a SkolemTv]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A SkolemTv contains a SkolemInfo, which describes the binding side of that
TcTyVar.  This is very convenient to a consumer of a SkolemTv, but it is
a bit awkward for the /producer/.  Why? Because sometimes we can't produce
the SkolemInfo until we have the TcTyVars!

Example: in `GHC.Tc.Utils.Unify.tcTopSkolemise` we create SkolemTvs whose
`SkolemInfo` is `SigSkol`, whose arguments in turn mention the newly-created
SkolemTvs.  So we a RecrusiveDo idiom, like this:

  rec { (wrap, tv_prs, given, rho_ty) &lt;- skolemise skol_info expected_ty
      ; skol_info &lt;- mkSkolemInfo (SigSkol ctxt expected_ty tv_prs) }

Note that the `skol_info` can't be created until we have the `tv_prs` returned
by `skolemise`. Note also that `skolemise` had better be lazy in `skol_info`.

All uses of this idiom should be flagged with a reference to this Note.
-}</span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-comment">-- A TyVarDetails is inside a TyVar</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- See Note [TyVars and TcTyVars during type checking]</span><span>
</span><span id="line-623"></span><span class="hs-keyword">data</span><span> </span><span id="TcTyVarDetails"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarDetails"><span class="hs-identifier hs-var">TcTyVarDetails</span></a></span></span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="SkolemTv"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-var">SkolemTv</span></a></span></span><span>      </span><span class="hs-comment">-- A skolem</span><span>
</span><span id="line-625"></span><span>       </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a></span><span> </span><span class="hs-comment">-- See Note [Keeping SkolemInfo inside a SkolemTv]</span><span>
</span><span id="line-626"></span><span>       </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>    </span><span class="hs-comment">-- Level of the implication that binds it</span><span>
</span><span id="line-627"></span><span>                  </span><span class="hs-comment">-- See GHC.Tc.Utils.Unify Note [Deeper level on the left] for</span><span>
</span><span id="line-628"></span><span>                  </span><span class="hs-comment">--     how this level number is used</span><span>
</span><span id="line-629"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>       </span><span class="hs-comment">-- True &lt;=&gt; this skolem type variable can be overlapped</span><span>
</span><span id="line-630"></span><span>                  </span><span class="hs-comment">--          when looking up instances</span><span>
</span><span id="line-631"></span><span>                  </span><span class="hs-comment">-- See Note [Binding when looking up instances] in GHC.Core.InstEnv</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RuntimeUnk"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#RuntimeUnk"><span class="hs-identifier hs-var">RuntimeUnk</span></a></span></span><span>    </span><span class="hs-comment">-- Stands for an as-yet-unknown type in the GHCi</span><span>
</span><span id="line-634"></span><span>                  </span><span class="hs-comment">-- interactive context</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MetaTv"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-var">MetaTv</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="mtv_info"><span class="annot"><span class="annottext">TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var hs-var">mtv_info</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaInfo"><span class="hs-identifier hs-type">MetaInfo</span></a></span><span>
</span><span id="line-637"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="mtv_ref"><span class="annot"><span class="annottext">TcTyVarDetails -&gt; IORef MetaDetails
</span><a href="GHC.Tc.Utils.TcType.html#mtv_ref"><span class="hs-identifier hs-var hs-var">mtv_ref</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.IORef.html#IORef/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaDetails"><span class="hs-identifier hs-type">MetaDetails</span></a></span><span>
</span><span id="line-638"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="mtv_tclvl"><span class="annot"><span class="annottext">TcTyVarDetails -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#mtv_tclvl"><span class="hs-identifier hs-var hs-var">mtv_tclvl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-comment">-- See Note [TcLevel invariants]</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#vanillaSkolemTvUnk"><span class="hs-identifier hs-type">vanillaSkolemTvUnk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Stack.Types.html#HasCallStack/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarDetails"><span class="hs-identifier hs-type">TcTyVarDetails</span></a></span><span>
</span><span id="line-641"></span><span id="vanillaSkolemTvUnk"><span class="annot"><span class="annottext">vanillaSkolemTvUnk :: HasCallStack =&gt; TcTyVarDetails
</span><a href="GHC.Tc.Utils.TcType.html#vanillaSkolemTvUnk"><span class="hs-identifier hs-var hs-var">vanillaSkolemTvUnk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SkolemInfo -&gt; TcLevel -&gt; Bool -&gt; TcTyVarDetails
</span><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-var">SkolemTv</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfo
HasCallStack =&gt; SkolemInfo
</span><a href="GHC.Tc.Types.Origin.html#unkSkol"><span class="hs-identifier hs-var">unkSkol</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#topTcLevel"><span class="hs-identifier hs-var">topTcLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarDetails"><span class="hs-identifier hs-type">TcTyVarDetails</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-644"></span><span>  </span><span id="local-6989586621681683066"><span class="annot"><span class="annottext">ppr :: TcTyVarDetails -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcTyVarDetails -&gt; SDoc
</span><a href="GHC.Tc.Utils.TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-var">pprTcTyVarDetails</span></a></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-type">pprTcTyVarDetails</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcTyVarDetails"><span class="hs-identifier hs-type">TcTyVarDetails</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-647"></span><span class="hs-comment">-- For debugging</span><span>
</span><span id="line-648"></span><span id="pprTcTyVarDetails"><span class="annot"><span class="annottext">pprTcTyVarDetails :: TcTyVarDetails -&gt; SDoc
</span><a href="GHC.Tc.Utils.TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-var hs-var">pprTcTyVarDetails</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#RuntimeUnk"><span class="hs-identifier hs-type">RuntimeUnk</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rt&quot;</span></span><span>
</span><span id="line-649"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-var">pprTcTyVarDetails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-type">SkolemTv</span></a></span><span> </span><span id="local-6989586621681683067"><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621681683067"><span class="hs-identifier hs-var">_sk</span></a></span></span><span> </span><span id="local-6989586621681683068"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683068"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ssk&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683068"><span class="hs-identifier hs-var">lvl</span></a></span><span>
</span><span id="line-650"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-var">pprTcTyVarDetails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-type">SkolemTv</span></a></span><span> </span><span id="local-6989586621681683070"><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621681683070"><span class="hs-identifier hs-var">_sk</span></a></span></span><span> </span><span id="local-6989586621681683071"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683071"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sk&quot;</span></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683071"><span class="hs-identifier hs-var">lvl</span></a></span><span>
</span><span id="line-651"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-var">pprTcTyVarDetails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_info :: TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var">mtv_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683072"><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683072"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mtv_tclvl :: TcTyVarDetails -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#mtv_tclvl"><span class="hs-identifier hs-var">mtv_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683073"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683073"><span class="hs-identifier hs-var">tclvl</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaInfo -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683072"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683073"><span class="hs-identifier hs-var">tclvl</span></a></span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span class="hs-comment">-----------------------------</span><span>
</span><span id="line-655"></span><span class="hs-keyword">data</span><span> </span><span id="MetaDetails"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaDetails"><span class="hs-identifier hs-var">MetaDetails</span></a></span></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Flexi"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Flexi"><span class="hs-identifier hs-var">Flexi</span></a></span></span><span>  </span><span class="hs-comment">-- Flexi type variables unify to become Indirects</span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Indirect"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Indirect"><span class="hs-identifier hs-var">Indirect</span></a></span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="hs-comment">-- | What restrictions are on this metavariable around unification?</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- These are checked in GHC.Tc.Utils.Unify.startSolvingByUnification.</span><span>
</span><span id="line-661"></span><span class="hs-keyword">data</span><span> </span><span id="MetaInfo"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaInfo"><span class="hs-identifier hs-var">MetaInfo</span></a></span></span><span>
</span><span id="line-662"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="TauTv"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TauTv"><span class="hs-identifier hs-var">TauTv</span></a></span></span><span>         </span><span class="hs-comment">-- ^ This MetaTv is an ordinary unification variable</span><span>
</span><span id="line-663"></span><span>                   </span><span class="hs-comment">-- A TauTv is always filled in with a tau-type, which</span><span>
</span><span id="line-664"></span><span>                   </span><span class="hs-comment">-- never contains any ForAlls.</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="TyVarTv"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TyVarTv"><span class="hs-identifier hs-var">TyVarTv</span></a></span></span><span>       </span><span class="hs-comment">-- ^ A variant of TauTv, except that it should not be</span><span>
</span><span id="line-667"></span><span>                   </span><span class="hs-comment">--   unified with a type, only with a type variable</span><span>
</span><span id="line-668"></span><span>                   </span><span class="hs-comment">-- See Note [TyVarTv] in GHC.Tc.Utils.TcMType</span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="RuntimeUnkTv"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#RuntimeUnkTv"><span class="hs-identifier hs-var">RuntimeUnkTv</span></a></span></span><span>  </span><span class="hs-comment">-- ^ A unification variable used in the GHCi debugger.</span><span>
</span><span id="line-671"></span><span>                   </span><span class="hs-comment">-- It /is/ allowed to unify with a polytype, unlike TauTv</span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="CycleBreakerTv"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#CycleBreakerTv"><span class="hs-identifier hs-var">CycleBreakerTv</span></a></span></span><span>  </span><span class="hs-comment">-- Used to fix occurs-check problems in Givens</span><span>
</span><span id="line-674"></span><span>                     </span><span class="hs-comment">-- See Note [Type equality cycles] in</span><span>
</span><span id="line-675"></span><span>                     </span><span class="hs-comment">-- GHC.Tc.Solver.Canonical</span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="ConcreteTv"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTv"><span class="hs-identifier hs-var">ConcreteTv</span></a></span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span>
</span><span id="line-678"></span><span>        </span><span class="hs-comment">-- ^ A unification variable that can only be unified</span><span>
</span><span id="line-679"></span><span>        </span><span class="hs-comment">-- with a concrete type, in the sense of</span><span>
</span><span id="line-680"></span><span>        </span><span class="hs-comment">-- Note [Concrete types] in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-comment">-- See Note [ConcreteTv] in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-682"></span><span>        </span><span class="hs-comment">-- See also Note [The Concrete mechanism] in GHC.Tc.Utils.Concrete</span><span>
</span><span id="line-683"></span><span>        </span><span class="hs-comment">-- for an overview of how this works in context.</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaDetails"><span class="hs-identifier hs-type">MetaDetails</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-686"></span><span>  </span><span id="local-6989586621681683085"><span class="annot"><span class="annottext">ppr :: MetaDetails -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaDetails
</span><a href="GHC.Tc.Utils.TcType.html#Flexi"><span class="hs-identifier hs-var">Flexi</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Flexi&quot;</span></span><span>
</span><span id="line-687"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Indirect"><span class="hs-identifier hs-type">Indirect</span></a></span><span> </span><span id="local-6989586621681683086"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683086"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Indirect&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683086"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaInfo"><span class="hs-identifier hs-type">MetaInfo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-690"></span><span>  </span><span id="local-6989586621681683094"><span class="annot"><span class="annottext">ppr :: MetaInfo -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#TauTv"><span class="hs-identifier hs-var">TauTv</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tau&quot;</span></span><span>
</span><span id="line-691"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#TyVarTv"><span class="hs-identifier hs-var">TyVarTv</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tyv&quot;</span></span><span>
</span><span id="line-692"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#RuntimeUnkTv"><span class="hs-identifier hs-var">RuntimeUnkTv</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rutv&quot;</span></span><span>
</span><span id="line-693"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#CycleBreakerTv"><span class="hs-identifier hs-var">CycleBreakerTv</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cbv&quot;</span></span><span>
</span><span id="line-694"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTv"><span class="hs-identifier hs-type">ConcreteTv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;conc&quot;</span></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-comment">-- | What caused us to create a 'ConcreteTv' metavariable?</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- See Note [ConcreteTv] in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-698"></span><span class="hs-keyword">data</span><span> </span><span id="ConcreteTvOrigin"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-var">ConcreteTvOrigin</span></a></span></span><span>
</span><span id="line-699"></span><span>   </span><span class="hs-comment">-- | A 'ConcreteTv' used to enforce the representation-polymorphism invariants.</span><span>
</span><span id="line-700"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-701"></span><span>   </span><span class="hs-comment">-- See 'FixedRuntimeRepOrigin' for more information.</span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ConcreteFRR"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteFRR"><span class="hs-identifier hs-var">ConcreteFRR</span></a></span></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#FixedRuntimeRepOrigin"><span class="hs-identifier hs-type">FixedRuntimeRepOrigin</span></a></span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                Untouchable type variables
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="hs-keyword">newtype</span><span> </span><span id="TcLevel"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-var">TcLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TcLevel"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-var">TcLevel</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span id="local-6989586621681683098"><span id="local-6989586621681683102"><span class="annot"><span class="annottext">TcLevel -&gt; TcLevel -&gt; Bool
(TcLevel -&gt; TcLevel -&gt; Bool)
-&gt; (TcLevel -&gt; TcLevel -&gt; Bool) -&gt; Eq TcLevel
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: TcLevel -&gt; TcLevel -&gt; Bool
== :: TcLevel -&gt; TcLevel -&gt; Bool
$c/= :: TcLevel -&gt; TcLevel -&gt; Bool
/= :: TcLevel -&gt; TcLevel -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683110"><span id="local-6989586621681683114"><span id="local-6989586621681683118"><span id="local-6989586621681683122"><span id="local-6989586621681683126"><span id="local-6989586621681683130"><span id="local-6989586621681683134"><span class="annot"><span class="annottext">Eq TcLevel
Eq TcLevel =&gt;
(TcLevel -&gt; TcLevel -&gt; Ordering)
-&gt; (TcLevel -&gt; TcLevel -&gt; Bool)
-&gt; (TcLevel -&gt; TcLevel -&gt; Bool)
-&gt; (TcLevel -&gt; TcLevel -&gt; Bool)
-&gt; (TcLevel -&gt; TcLevel -&gt; Bool)
-&gt; (TcLevel -&gt; TcLevel -&gt; TcLevel)
-&gt; (TcLevel -&gt; TcLevel -&gt; TcLevel)
-&gt; Ord TcLevel
TcLevel -&gt; TcLevel -&gt; Bool
TcLevel -&gt; TcLevel -&gt; Ordering
TcLevel -&gt; TcLevel -&gt; TcLevel
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: TcLevel -&gt; TcLevel -&gt; Ordering
compare :: TcLevel -&gt; TcLevel -&gt; Ordering
$c&lt; :: TcLevel -&gt; TcLevel -&gt; Bool
&lt; :: TcLevel -&gt; TcLevel -&gt; Bool
$c&lt;= :: TcLevel -&gt; TcLevel -&gt; Bool
&lt;= :: TcLevel -&gt; TcLevel -&gt; Bool
$c&gt; :: TcLevel -&gt; TcLevel -&gt; Bool
&gt; :: TcLevel -&gt; TcLevel -&gt; Bool
$c&gt;= :: TcLevel -&gt; TcLevel -&gt; Bool
&gt;= :: TcLevel -&gt; TcLevel -&gt; Bool
$cmax :: TcLevel -&gt; TcLevel -&gt; TcLevel
max :: TcLevel -&gt; TcLevel -&gt; TcLevel
$cmin :: TcLevel -&gt; TcLevel -&gt; TcLevel
min :: TcLevel -&gt; TcLevel -&gt; TcLevel
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-comment">-- See Note [TcLevel invariants] for what this Int is</span><span>
</span><span id="line-712"></span><span>  </span><span class="hs-comment">-- See also Note [TcLevel assignment]</span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span class="hs-comment">{-
Note [TcLevel invariants]
~~~~~~~~~~~~~~~~~~~~~~~~~
* Each unification variable (MetaTv)
  and skolem (SkolemTv)
  and each Implication
  has a level number (of type TcLevel)

* INVARIANTS.  In a tree of Implications,

    (ImplicInv) The level number (ic_tclvl) of an Implication is
                STRICTLY GREATER THAN that of its parent

    (SkolInv)   The level number of the skolems (ic_skols) of an
                Implication is equal to the level of the implication
                itself (ic_tclvl)

    (GivenInv)  The level number of a unification variable appearing
                in the 'ic_given' of an implication I should be
                STRICTLY LESS THAN the ic_tclvl of I
                See Note [GivenInv]

    (WantedInv) The level number of a unification variable appearing
                in the 'ic_wanted' of an implication I should be
                LESS THAN OR EQUAL TO the ic_tclvl of I
                See Note [WantedInv]

The level of a MetaTyVar also governs its untouchability.  See
Note [Unification preconditions] in GHC.Tc.Utils.Unify.

Note [TcLevel assignment]
~~~~~~~~~~~~~~~~~~~~~~~~~
We arrange the TcLevels like this

   0   Top level
   1   First-level implication constraints
   2   Second-level implication constraints
   ...etc...

Note [GivenInv]
~~~~~~~~~~~~~~~
Invariant (GivenInv) is not essential, but it is easy to guarantee, and
it is a useful extra piece of structure.  It ensures that the Givens of
an implication don't change because of unifications /at the same level/
caused by Wanteds.  (Wanteds can also cause unifications at an outer
level, but that will iterate the entire implication; see GHC.Tc.Solver.Monad
Note [The Unification Level Flag].)

Givens can certainly contain meta-tyvars from /outer/ levels.  E.g.
   data T a where
     MkT :: Eq a =&gt; a -&gt; MkT a

   f x = case x of MkT y -&gt; y &amp;&amp; True

Then we'll infer (x :: T alpha[1]).  The Givens from the implication
arising from the pattern match will look like this:

   forall[2] . Eq alpha[1] =&gt; (alpha[1] ~ Bool)

But if we unify alpha (which in this case we will), we'll iterate
the entire implication via Note [The Unification Level Flag] in
GHC.Tc.Solver.Monad.  That isn't true of unifications at the /ambient/
level.

It would be entirely possible to weaken (GivenInv), to LESS THAN OR
EQUAL TO, but we'd need to think carefully about
  - kick-out for Givens
  - GHC.Tc.Solver.Monad.isOuterTyVar
But in fact (GivenInv) is automatically true, so we're adhering to
it for now.  See #18929.

* If a tyvar tv has level n, then the levels of all variables free
  in tv's kind are &lt;= n. Consequence: if tv is untouchable, so are
  all variables in tv's kind.

Note [WantedInv]
~~~~~~~~~~~~~~~~
Why is WantedInv important?  Consider this implication, where
the constraint (C alpha[3]) disobeys WantedInv:

   forall[2] a. blah =&gt; (C alpha[3])
                        (forall[3] b. alpha[3] ~ b)

We can unify alpha:=b in the inner implication, because 'alpha' is
touchable; but then 'b' has escaped its scope into the outer implication.
-}</span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#maxTcLevel"><span class="hs-identifier hs-type">maxTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-802"></span><span id="maxTcLevel"><span class="annot"><span class="annottext">maxTcLevel :: TcLevel -&gt; TcLevel -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#maxTcLevel"><span class="hs-identifier hs-var hs-var">maxTcLevel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683139"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683139"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683140"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683140"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-var">TcLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683139"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`max`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683140"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#topTcLevel"><span class="hs-identifier hs-type">topTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-805"></span><span class="hs-comment">-- See Note [TcLevel assignment]</span><span>
</span><span id="line-806"></span><span id="topTcLevel"><span class="annot"><span class="annottext">topTcLevel :: TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#topTcLevel"><span class="hs-identifier hs-var hs-var">topTcLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-var">TcLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-comment">-- 0 = outermost level</span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTopTcLevel"><span class="hs-identifier hs-type">isTopTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-809"></span><span id="isTopTcLevel"><span class="annot"><span class="annottext">isTopTcLevel :: TcLevel -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTopTcLevel"><span class="hs-identifier hs-var hs-var">isTopTcLevel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-810"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTopTcLevel"><span class="hs-identifier hs-var">isTopTcLevel</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pushTcLevel"><span class="hs-identifier hs-type">pushTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-813"></span><span class="hs-comment">-- See Note [TcLevel assignment]</span><span>
</span><span id="line-814"></span><span id="pushTcLevel"><span class="annot"><span class="annottext">pushTcLevel :: TcLevel -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#pushTcLevel"><span class="hs-identifier hs-var hs-var">pushTcLevel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683142"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683142"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-var">TcLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683142"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#strictlyDeeperThan"><span class="hs-identifier hs-type">strictlyDeeperThan</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-817"></span><span id="strictlyDeeperThan"><span class="annot"><span class="annottext">strictlyDeeperThan :: TcLevel -&gt; TcLevel -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#strictlyDeeperThan"><span class="hs-identifier hs-var hs-var">strictlyDeeperThan</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683144"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683144"><span class="hs-identifier hs-var">tv_tclvl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683145"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683145"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683144"><span class="hs-identifier hs-var">tv_tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683145"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#deeperThanOrSame"><span class="hs-identifier hs-type">deeperThanOrSame</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-821"></span><span id="deeperThanOrSame"><span class="annot"><span class="annottext">deeperThanOrSame :: TcLevel -&gt; TcLevel -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#deeperThanOrSame"><span class="hs-identifier hs-var hs-var">deeperThanOrSame</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683147"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683147"><span class="hs-identifier hs-var">tv_tclvl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683148"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683148"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683147"><span class="hs-identifier hs-var">tv_tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683148"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#sameDepthAs"><span class="hs-identifier hs-type">sameDepthAs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-825"></span><span id="sameDepthAs"><span class="annot"><span class="annottext">sameDepthAs :: TcLevel -&gt; TcLevel -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#sameDepthAs"><span class="hs-identifier hs-var hs-var">sameDepthAs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683149"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683149"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683150"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683150"><span class="hs-identifier hs-var">tv_tclvl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-826"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683149"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683150"><span class="hs-identifier hs-var">tv_tclvl</span></a></span><span>   </span><span class="hs-comment">-- NB: invariant ctxt_tclvl &gt;= tv_tclvl</span><span>
</span><span id="line-827"></span><span>                             </span><span class="hs-comment">--     So &lt;= would be equivalent</span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#checkTcLevelInvariant"><span class="hs-identifier hs-type">checkTcLevelInvariant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-830"></span><span class="hs-comment">-- Checks (WantedInv) from Note [TcLevel invariants]</span><span>
</span><span id="line-831"></span><span id="checkTcLevelInvariant"><span class="annot"><span class="annottext">checkTcLevelInvariant :: TcLevel -&gt; TcLevel -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#checkTcLevelInvariant"><span class="hs-identifier hs-var hs-var">checkTcLevelInvariant</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683152"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683152"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683153"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683153"><span class="hs-identifier hs-var">tv_tclvl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683152"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683153"><span class="hs-identifier hs-var">tv_tclvl</span></a></span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span class="hs-comment">-- Returns topTcLevel for non-TcTyVars</span><span>
</span><span id="line-835"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyVarLevel"><span class="hs-identifier hs-type">tcTyVarLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-836"></span><span id="tcTyVarLevel"><span class="annot"><span class="annottext">tcTyVarLevel :: TyVar -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#tcTyVarLevel"><span class="hs-identifier hs-var hs-var">tcTyVarLevel</span></a></span></span><span> </span><span id="local-6989586621681683154"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683154"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683154"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-838"></span><span>          </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_tclvl :: TcTyVarDetails -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#mtv_tclvl"><span class="hs-identifier hs-var">mtv_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683156"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683156"><span class="hs-identifier hs-var">tv_lvl</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683156"><span class="hs-identifier hs-var">tv_lvl</span></a></span><span>
</span><span id="line-839"></span><span>          </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-type">SkolemTv</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683157"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683157"><span class="hs-identifier hs-var">tv_lvl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683157"><span class="hs-identifier hs-var">tv_lvl</span></a></span><span>
</span><span id="line-840"></span><span>          </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><a href="GHC.Tc.Utils.TcType.html#RuntimeUnk"><span class="hs-identifier hs-var">RuntimeUnk</span></a></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#topTcLevel"><span class="hs-identifier hs-var">topTcLevel</span></a></span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTypeLevel"><span class="hs-identifier hs-type">tcTypeLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-844"></span><span class="hs-comment">-- Max level of any free var of the type</span><span>
</span><span id="line-845"></span><span id="tcTypeLevel"><span class="annot"><span class="annottext">tcTypeLevel :: Type -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#tcTypeLevel"><span class="hs-identifier hs-var hs-var">tcTypeLevel</span></a></span></span><span> </span><span id="local-6989586621681683158"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683158"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-846"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; TcLevel -&gt; TcLevel) -&gt; TcLevel -&gt; DVarSet -&gt; TcLevel
forall a. (TyVar -&gt; a -&gt; a) -&gt; a -&gt; DVarSet -&gt; a
</span><a href="GHC.Types.Var.Set.html#nonDetStrictFoldDVarSet"><span class="hs-identifier hs-var">nonDetStrictFoldDVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcLevel -&gt; TcLevel
</span><a href="#local-6989586621681683160"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#topTcLevel"><span class="hs-identifier hs-var">topTcLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; DVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeDSet"><span class="hs-identifier hs-var">tyCoVarsOfTypeDSet</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683158"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-847"></span><span>    </span><span class="hs-comment">-- It's safe to use a non-deterministic fold because `maxTcLevel` is</span><span>
</span><span id="line-848"></span><span>    </span><span class="hs-comment">-- commutative.</span><span>
</span><span id="line-849"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-850"></span><span>    </span><span id="local-6989586621681683160"><span class="annot"><span class="annottext">add :: TyVar -&gt; TcLevel -&gt; TcLevel
</span><a href="#local-6989586621681683160"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621681683161"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683161"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681683162"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683162"><span class="hs-identifier hs-var">lvl</span></a></span></span><span>
</span><span id="line-851"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTcTyVar"><span class="hs-identifier hs-var">isTcTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683161"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683162"><span class="hs-identifier hs-var">lvl</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; TcLevel -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#maxTcLevel"><span class="hs-operator hs-var">`maxTcLevel`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#tcTyVarLevel"><span class="hs-identifier hs-var">tcTyVarLevel</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683161"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-852"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683162"><span class="hs-identifier hs-var">lvl</span></a></span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-855"></span><span>  </span><span id="local-6989586621681683167"><span class="annot"><span class="annottext">ppr :: TcLevel -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span id="local-6989586621681683168"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683168"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683168"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
    Finding type family instances
*                                                                      *
************************************************************************
-}</span></span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-comment">-- | Finds outermost type-family applications occurring in a type,</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- after expanding synonyms.  In the list (F, tys) that is returned</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- we guarantee that tys matches F's arity.  For example, given</span><span>
</span><span id="line-867"></span><span class="hs-comment">--    type family F a :: * -&gt; *    (arity 1)</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- calling tcTyFamInsts on (Maybe (F Int Bool) will return</span><span>
</span><span id="line-869"></span><span class="hs-comment">--     (F, [Int]), not (F, [Int,Bool])</span><span>
</span><span id="line-870"></span><span class="hs-comment">--</span><span>
</span><span id="line-871"></span><span class="hs-comment">-- This is important for its use in deciding termination of type</span><span>
</span><span id="line-872"></span><span class="hs-comment">-- instances (see #11581).  E.g.</span><span>
</span><span id="line-873"></span><span class="hs-comment">--    type instance G [Int] = ...(F Int \&lt;big type&gt;)...</span><span>
</span><span id="line-874"></span><span class="hs-comment">-- we don't need to take \&lt;big type&gt; into account when asking if</span><span>
</span><span id="line-875"></span><span class="hs-comment">-- the calls on the RHS are smaller than the LHS</span><span>
</span><span id="line-876"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyFamInsts"><span class="hs-identifier hs-type">tcTyFamInsts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-877"></span><span id="tcTyFamInsts"><span class="annot"><span class="annottext">tcTyFamInsts :: Type -&gt; [(TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyFamInsts"><span class="hs-identifier hs-var hs-var">tcTyFamInsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Bool, TyCon, [Type]) -&gt; (TyCon, [Type]))
-&gt; [(Bool, TyCon, [Type])] -&gt; [(TyCon, [Type])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681683169"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683169"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683170"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683170"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683169"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683170"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Bool, TyCon, [Type])] -&gt; [(TyCon, [Type])])
-&gt; (Type -&gt; [(Bool, TyCon, [Type])]) -&gt; Type -&gt; [(TyCon, [Type])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVis"><span class="hs-identifier hs-var">tcTyFamInstsAndVis</span></a></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="hs-comment">-- | Like 'tcTyFamInsts', except that the output records whether the</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- type family and its arguments occur as an /invisible/ argument in</span><span>
</span><span id="line-881"></span><span class="hs-comment">-- some type application. This information is useful because it helps GHC know</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- when to turn on @-fprint-explicit-kinds@ during error reporting so that</span><span>
</span><span id="line-883"></span><span class="hs-comment">-- users can actually see the type family being mentioned.</span><span>
</span><span id="line-884"></span><span class="hs-comment">--</span><span>
</span><span id="line-885"></span><span class="hs-comment">-- As an example, consider:</span><span>
</span><span id="line-886"></span><span class="hs-comment">--</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-888"></span><span class="hs-comment">-- class C a</span><span>
</span><span id="line-889"></span><span class="hs-comment">-- data T (a :: k)</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- type family F a :: k</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- instance C (T @(F Int) (F Bool))</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-893"></span><span class="hs-comment">--</span><span>
</span><span id="line-894"></span><span class="hs-comment">-- There are two occurrences of the type family `F` in that `C` instance, so</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- @'tcTyFamInstsAndVis' (C (T \@(F Int) (F Bool)))@ will return:</span><span>
</span><span id="line-896"></span><span class="hs-comment">--</span><span>
</span><span id="line-897"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-898"></span><span class="hs-comment">-- [ ('True',  F, [Int])</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- , ('False', F, [Bool]) ]</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-901"></span><span class="hs-comment">--</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- @F Int@ is paired with 'True' since it appears as an /invisible/ argument</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- to @C@, whereas @F Bool@ is paired with 'False' since it appears an a</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- /visible/ argument to @C@.</span><span>
</span><span id="line-905"></span><span class="hs-comment">--</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- See also @Note [Kind arguments in error messages]@ in &quot;GHC.Tc.Errors&quot;.</span><span>
</span><span id="line-907"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVis"><span class="hs-identifier hs-type">tcTyFamInstsAndVis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-908"></span><span id="tcTyFamInstsAndVis"><span class="annot"><span class="annottext">tcTyFamInstsAndVis :: Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVis"><span class="hs-identifier hs-var hs-var">tcTyFamInstsAndVis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVisX"><span class="hs-identifier hs-var">tcTyFamInstsAndVisX</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVisX"><span class="hs-identifier hs-type">tcTyFamInstsAndVisX</span></a></span><span>
</span><span id="line-911"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Is this an invisible argument to some type application?</span></span><span>
</span><span id="line-912"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-913"></span><span id="tcTyFamInstsAndVisX"><span class="annot"><span class="annottext">tcTyFamInstsAndVisX :: Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVisX"><span class="hs-identifier hs-var hs-var">tcTyFamInstsAndVisX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-914"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-915"></span><span>    </span><span id="local-6989586621681683172"><span class="annot"><span class="annottext">go :: Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681683174"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683174"><span class="hs-identifier hs-var">is_invis_arg</span></a></span></span><span> </span><span id="local-6989586621681683175"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683175"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-916"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683176"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683176"><span class="hs-identifier hs-var">exp_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683175"><span class="hs-identifier hs-var">ty</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683174"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683176"><span class="hs-identifier hs-var">exp_ty</span></a></span><span>
</span><span id="line-917"></span><span>    </span><span class="annot"><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-918"></span><span>    </span><span class="annot"><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683178"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683178"><span class="hs-identifier hs-var">is_invis_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681683180"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683180"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681683181"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683181"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683180"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-920"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683178"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683180"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Type]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#take/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Int
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683180"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683181"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-921"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-922"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TyCon -&gt; [Type] -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyFamInstsAndVisX"><span class="hs-identifier hs-var">tcTyConAppTyFamInstsAndVisX</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683178"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683180"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683181"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-923"></span><span>    </span><span class="annot"><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-924"></span><span>    </span><span class="annot"><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683187"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683187"><span class="hs-identifier hs-var">is_invis_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621681683189"><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621681683189"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621681683190"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683190"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683187"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyBinder -&gt; Type
forall argf. VarBndr TyVar argf -&gt; Type
</span><a href="GHC.Types.Var.html#binderType"><span class="hs-identifier hs-var">binderType</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621681683189"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>                                         </span><span class="annot"><span class="annottext">[(Bool, TyCon, [Type])]
-&gt; [(Bool, TyCon, [Type])] -&gt; [(Bool, TyCon, [Type])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683187"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683190"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-926"></span><span>    </span><span class="annot"><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683192"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683192"><span class="hs-identifier hs-var">is_invis_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683194"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683194"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681683195"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683195"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621681683196"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683196"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683192"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683194"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-927"></span><span>                                         </span><span class="annot"><span class="annottext">[(Bool, TyCon, [Type])]
-&gt; [(Bool, TyCon, [Type])] -&gt; [(Bool, TyCon, [Type])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683192"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683195"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-928"></span><span>                                         </span><span class="annot"><span class="annottext">[(Bool, TyCon, [Type])]
-&gt; [(Bool, TyCon, [Type])] -&gt; [(Bool, TyCon, [Type])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683192"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683196"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-929"></span><span>    </span><span class="annot"><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683197"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683197"><span class="hs-identifier hs-var">is_invis_arg</span></a></span></span><span> </span><span id="local-6989586621681683198"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621681683198"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span>
</span><span id="line-930"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683200"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683200"><span class="hs-identifier hs-var">ty_head</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683201"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683201"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [Type])
</span><a href="GHC.Core.Type.html#splitAppTys"><span class="hs-identifier hs-var">splitAppTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683198"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-931"></span><span>          </span><span id="local-6989586621681683203"><span class="annot"><span class="annottext">ty_arg_flags :: [ForAllTyFlag]
</span><a href="#local-6989586621681683203"><span class="hs-identifier hs-var hs-var">ty_arg_flags</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [ForAllTyFlag]
</span><a href="GHC.Core.Type.html#appTyForAllTyFlags"><span class="hs-identifier hs-var">appTyForAllTyFlags</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683200"><span class="hs-identifier hs-var">ty_head</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683201"><span class="hs-identifier hs-var">ty_args</span></a></span><span>
</span><span id="line-932"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683197"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683200"><span class="hs-identifier hs-var">ty_head</span></a></span><span>
</span><span id="line-933"></span><span>         </span><span class="annot"><span class="annottext">[(Bool, TyCon, [Type])]
-&gt; [(Bool, TyCon, [Type])] -&gt; [(Bool, TyCon, [Type])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Bool, TyCon, [Type])]] -&gt; [(Bool, TyCon, [Type])]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concat/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ForAllTyFlag -&gt; Type -&gt; [(Bool, TyCon, [Type])])
-&gt; [ForAllTyFlag] -&gt; [Type] -&gt; [[(Bool, TyCon, [Type])]]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#zipWith/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681683207"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621681683207"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleForAllTyFlag"><span class="hs-identifier hs-var">isInvisibleForAllTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621681683207"><span class="hs-identifier hs-var">flag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>                            </span><span class="annot"><span class="annottext">[ForAllTyFlag]
</span><a href="#local-6989586621681683203"><span class="hs-identifier hs-var">ty_arg_flags</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683201"><span class="hs-identifier hs-var">ty_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-935"></span><span>    </span><span class="annot"><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683209"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683209"><span class="hs-identifier hs-var">is_invis_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621681683211"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683211"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683209"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683211"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-936"></span><span>    </span><span class="annot"><a href="#local-6989586621681683172"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- don't count tyfams in coercions,</span><span>
</span><span id="line-937"></span><span>                                            </span><span class="hs-comment">-- as they never get normalized,</span><span>
</span><span id="line-938"></span><span>                                            </span><span class="hs-comment">-- anyway</span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="hs-comment">-- | In an application of a 'TyCon' to some arguments, find the outermost</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- occurrences of type family applications within the arguments. This function</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- will not consider the 'TyCon' itself when checking for type family</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- applications.</span><span>
</span><span id="line-944"></span><span class="hs-comment">--</span><span>
</span><span id="line-945"></span><span class="hs-comment">-- See 'tcTyFamInstsAndVis' for more details on how this works (as this</span><span>
</span><span id="line-946"></span><span class="hs-comment">-- function is called inside of 'tcTyFamInstsAndVis').</span><span>
</span><span id="line-947"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyFamInstsAndVis"><span class="hs-identifier hs-type">tcTyConAppTyFamInstsAndVis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-948"></span><span id="tcTyConAppTyFamInstsAndVis"><span class="annot"><span class="annottext">tcTyConAppTyFamInstsAndVis :: TyCon -&gt; [Type] -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyFamInstsAndVis"><span class="hs-identifier hs-var hs-var">tcTyConAppTyFamInstsAndVis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TyCon -&gt; [Type] -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyFamInstsAndVisX"><span class="hs-identifier hs-var">tcTyConAppTyFamInstsAndVisX</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-949"></span><span>
</span><span id="line-950"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyFamInstsAndVisX"><span class="hs-identifier hs-type">tcTyConAppTyFamInstsAndVisX</span></a></span><span>
</span><span id="line-951"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Is this an invisible argument to some type application?</span></span><span>
</span><span id="line-952"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-953"></span><span id="tcTyConAppTyFamInstsAndVisX"><span class="annot"><span class="annottext">tcTyConAppTyFamInstsAndVisX :: Bool -&gt; TyCon -&gt; [Type] -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyFamInstsAndVisX"><span class="hs-identifier hs-var hs-var">tcTyConAppTyFamInstsAndVisX</span></a></span></span><span> </span><span id="local-6989586621681683213"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683213"><span class="hs-identifier hs-var">is_invis_arg</span></a></span></span><span> </span><span id="local-6989586621681683214"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683214"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681683215"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683215"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-954"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683216"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683216"><span class="hs-identifier hs-var">invis_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683217"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683217"><span class="hs-identifier hs-var">vis_tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; ([Type], [Type])
</span><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-var">partitionInvisibleTypes</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683214"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683215"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-955"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[[(Bool, TyCon, [Type])]] -&gt; [(Bool, TyCon, [Type])]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concat/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[(Bool, TyCon, [Type])]] -&gt; [(Bool, TyCon, [Type])])
-&gt; [[(Bool, TyCon, [Type])]] -&gt; [(Bool, TyCon, [Type])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [(Bool, TyCon, [Type])])
-&gt; [Type] -&gt; [[(Bool, TyCon, [Type])]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVisX"><span class="hs-identifier hs-var">tcTyFamInstsAndVisX</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683216"><span class="hs-identifier hs-var">invis_tys</span></a></span><span>
</span><span id="line-956"></span><span>           </span><span class="annot"><span class="annottext">[[(Bool, TyCon, [Type])]]
-&gt; [[(Bool, TyCon, [Type])]] -&gt; [[(Bool, TyCon, [Type])]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [(Bool, TyCon, [Type])])
-&gt; [Type] -&gt; [[(Bool, TyCon, [Type])]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; [(Bool, TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyFamInstsAndVisX"><span class="hs-identifier hs-var">tcTyFamInstsAndVisX</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683213"><span class="hs-identifier hs-var">is_invis_arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683217"><span class="hs-identifier hs-var">vis_tys</span></a></span><span>
</span><span id="line-957"></span><span>
</span><span id="line-958"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyFamFree"><span class="hs-identifier hs-type">isTyFamFree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-959"></span><span class="annot"><span class="hs-comment">-- ^ Check that a type does not contain any type family applications.</span></span><span>
</span><span id="line-960"></span><span id="isTyFamFree"><span class="annot"><span class="annottext">isTyFamFree :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTyFamFree"><span class="hs-identifier hs-var hs-var">isTyFamFree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(TyCon, [Type])] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">([(TyCon, [Type])] -&gt; Bool)
-&gt; (Type -&gt; [(TyCon, [Type])]) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [(TyCon, [Type])]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyFamInsts"><span class="hs-identifier hs-var">tcTyFamInsts</span></a></span><span>
</span><span id="line-961"></span><span>
</span><span id="line-962"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#any_rewritable"><span class="hs-identifier hs-type">any_rewritable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a></span><span>   </span><span class="hs-comment">-- Ambient role</span><span>
</span><span id="line-963"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- check tyvar</span><span>
</span><span id="line-964"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- check type family</span><span>
</span><span id="line-965"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>                      </span><span class="hs-comment">-- expand type synonym?</span><span>
</span><span id="line-966"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-967"></span><span class="hs-comment">-- Checks every tyvar and tyconapp (not including FunTys) within a type,</span><span>
</span><span id="line-968"></span><span class="hs-comment">-- ORing the results of the predicates above together</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- Do not look inside casts and coercions</span><span>
</span><span id="line-970"></span><span class="hs-comment">-- See Note [anyRewritableTyVar must be role-aware]</span><span>
</span><span id="line-971"></span><span class="hs-comment">--</span><span>
</span><span id="line-972"></span><span class="hs-comment">-- This looks like it should use foldTyCo, but that function is</span><span>
</span><span id="line-973"></span><span class="hs-comment">-- role-agnostic, and this one must be role-aware. We could make</span><span>
</span><span id="line-974"></span><span class="hs-comment">-- foldTyCon role-aware, but that may slow down more common usages.</span><span>
</span><span id="line-975"></span><span class="hs-comment">--</span><span>
</span><span id="line-976"></span><span class="hs-comment">-- See Note [Rewritable] in GHC.Tc.Solver.InertSet for a specification for this function.</span><span>
</span><span id="line-977"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#any_rewritable"><span class="hs-pragma hs-type">any_rewritable</span></a></span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- this allows specialization of predicates</span><span>
</span><span id="line-978"></span><span id="any_rewritable"><span class="annot"><span class="annottext">any_rewritable :: EqRel
-&gt; (EqRel -&gt; TyVar -&gt; Bool)
-&gt; (EqRel -&gt; TyCon -&gt; [Type] -&gt; Bool)
-&gt; (TyCon -&gt; Bool)
-&gt; Type
-&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#any_rewritable"><span class="hs-identifier hs-var hs-var">any_rewritable</span></a></span></span><span> </span><span id="local-6989586621681683221"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683221"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621681683222"><span class="annot"><span class="annottext">EqRel -&gt; TyVar -&gt; Bool
</span><a href="#local-6989586621681683222"><span class="hs-identifier hs-var">tv_pred</span></a></span></span><span> </span><span id="local-6989586621681683223"><span class="annot"><span class="annottext">EqRel -&gt; TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621681683223"><span class="hs-identifier hs-var">tc_pred</span></a></span></span><span> </span><span id="local-6989586621681683224"><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="#local-6989586621681683224"><span class="hs-identifier hs-var">should_expand</span></a></span></span><span>
</span><span id="line-979"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683221"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-980"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-981"></span><span>    </span><span id="local-6989586621681683227"><span class="annot"><span class="annottext">go_tv :: EqRel -&gt; VarSet -&gt; TyVar -&gt; Bool
</span><a href="#local-6989586621681683227"><span class="hs-identifier hs-var hs-var">go_tv</span></a></span></span><span> </span><span id="local-6989586621681683228"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683228"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span id="local-6989586621681683229"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683229"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span id="local-6989586621681683230"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683230"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683230"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683229"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-982"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; TyVar -&gt; Bool
</span><a href="#local-6989586621681683222"><span class="hs-identifier hs-var">tv_pred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683228"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683230"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-983"></span><span>
</span><span id="line-984"></span><span>    </span><span id="local-6989586621681683225"><span class="annot"><span class="annottext">go :: EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681683232"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683232"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span id="local-6989586621681683233"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683233"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span id="local-6989586621681683234"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621681683234"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681683235"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683235"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681683236"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683236"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeSynonymTyCon"><span class="hs-identifier hs-var">isTypeSynonymTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683235"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-986"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="#local-6989586621681683224"><span class="hs-identifier hs-var">should_expand</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683235"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-987"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683238"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683238"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683234"><span class="hs-identifier hs-var">ty</span></a></span><span>   </span><span class="hs-comment">-- should always match</span><span>
</span><span id="line-988"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683232"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683233"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683238"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-989"></span><span>
</span><span id="line-990"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621681683223"><span class="hs-identifier hs-var">tc_pred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683232"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683235"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683236"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-991"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-994"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621681683239"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683232"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683233"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683235"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683236"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-995"></span><span>
</span><span id="line-996"></span><span>    </span><span class="annot"><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683240"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683240"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span id="local-6989586621681683241"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683241"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621681683242"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683242"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; TyVar -&gt; Bool
</span><a href="#local-6989586621681683227"><span class="hs-identifier hs-var">go_tv</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683240"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683241"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683242"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-997"></span><span>    </span><span class="annot"><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-998"></span><span>    </span><span class="annot"><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683243"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683243"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span id="local-6989586621681683244"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683244"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621681683245"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683245"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681683246"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683246"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683243"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683244"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683245"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683244"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683246"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-999"></span><span>    </span><span class="annot"><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683249"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683249"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span id="local-6989586621681683250"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683250"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683251"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683251"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681683252"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683252"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681683253"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683253"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683250"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683254"><span class="hs-identifier hs-var">arg_rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683250"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683255"><span class="hs-identifier hs-var">res_rep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-1000"></span><span>                                     </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683249"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683250"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683252"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683249"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683250"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683253"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683250"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683251"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1001"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681683254"><span class="annot"><span class="annottext">arg_rep :: Type
</span><a href="#local-6989586621681683254"><span class="hs-identifier hs-var hs-var">arg_rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683252"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-comment">-- forgetting these causes #17024</span><span>
</span><span id="line-1002"></span><span>            </span><span id="local-6989586621681683255"><span class="annot"><span class="annottext">res_rep :: Type
</span><a href="#local-6989586621681683255"><span class="hs-identifier hs-var hs-var">res_rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683253"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1003"></span><span>    </span><span class="annot"><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683257"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683257"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span id="local-6989586621681683258"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683258"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621681683259"><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621681683259"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681683260"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683260"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683257"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683258"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TyVar -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder -&gt; TyVar
forall tv argf. VarBndr tv argf -&gt; tv
</span><a href="GHC.Types.Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621681683259"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683260"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1004"></span><span>    </span><span class="annot"><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681683263"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683263"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span id="local-6989586621681683264"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683264"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621681683265"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683265"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683263"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683264"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683265"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1005"></span><span>    </span><span class="annot"><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">VarSet
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span>    </span><span id="local-6989586621681683239"><span class="annot"><span class="annottext">go_tc :: EqRel -&gt; VarSet -&gt; TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621681683239"><span class="hs-identifier hs-var hs-var">go_tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span>  </span><span id="local-6989586621681683266"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683266"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621681683267"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683267"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#any/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683266"><span class="hs-identifier hs-var">bvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683267"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1008"></span><span>    </span><span class="annot"><a href="#local-6989586621681683239"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a></span><span> </span><span id="local-6989586621681683270"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683270"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span id="local-6989586621681683271"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683271"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681683272"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683272"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Role, Type) -&gt; Bool) -&gt; [(Role, Type)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#any/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; (Role, Type) -&gt; Bool
</span><a href="#local-6989586621681683273"><span class="hs-identifier hs-var">go_arg</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683270"><span class="hs-identifier hs-var">bvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1009"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Role]
</span><a href="GHC.Core.Coercion.html#tyConRoleListRepresentational"><span class="hs-identifier hs-var">tyConRoleListRepresentational</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683271"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Role] -&gt; [Type] -&gt; [(Role, Type)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#zip/GHC.List.html#zip"><span class="hs-operator hs-var">`zip`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683272"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span>    </span><span id="local-6989586621681683273"><span class="annot"><span class="annottext">go_arg :: VarSet -&gt; (Role, Type) -&gt; Bool
</span><a href="#local-6989586621681683273"><span class="hs-identifier hs-var hs-var">go_arg</span></a></span></span><span> </span><span id="local-6989586621681683275"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683275"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span class="hs-special">,</span><span>          </span><span id="local-6989586621681683277"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683277"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span>  </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683275"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683277"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1012"></span><span>    </span><span class="annot"><a href="#local-6989586621681683273"><span class="hs-identifier hs-var">go_arg</span></a></span><span> </span><span id="local-6989586621681683278"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683278"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Representational"><span class="hs-identifier hs-var">Representational</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683280"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683280"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; VarSet -&gt; Type -&gt; Bool
</span><a href="#local-6989586621681683225"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683278"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683280"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1013"></span><span>    </span><span class="annot"><a href="#local-6989586621681683273"><span class="hs-identifier hs-var">go_arg</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a></span><span class="hs-special">,</span><span>          </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- We never rewrite with phantoms</span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#anyRewritableTyVar"><span class="hs-identifier hs-type">anyRewritableTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a></span><span>    </span><span class="hs-comment">-- Ambient role</span><span>
</span><span id="line-1016"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- check tyvar</span><span>
</span><span id="line-1017"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1018"></span><span class="hs-comment">-- See Note [Rewritable] in GHC.Tc.Solver.InertSet for a specification for this function.</span><span>
</span><span id="line-1019"></span><span id="anyRewritableTyVar"><span class="annot"><span class="annottext">anyRewritableTyVar :: EqRel -&gt; (EqRel -&gt; TyVar -&gt; Bool) -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#anyRewritableTyVar"><span class="hs-identifier hs-var hs-var">anyRewritableTyVar</span></a></span></span><span> </span><span id="local-6989586621681683282"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683282"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621681683283"><span class="annot"><span class="annottext">EqRel -&gt; TyVar -&gt; Bool
</span><a href="#local-6989586621681683283"><span class="hs-identifier hs-var">pred</span></a></span></span><span>
</span><span id="line-1020"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel
-&gt; (EqRel -&gt; TyVar -&gt; Bool)
-&gt; (EqRel -&gt; TyCon -&gt; [Type] -&gt; Bool)
-&gt; (TyCon -&gt; Bool)
-&gt; Type
-&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#any_rewritable"><span class="hs-identifier hs-var">any_rewritable</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683282"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; TyVar -&gt; Bool
</span><a href="#local-6989586621681683283"><span class="hs-identifier hs-var">pred</span></a></span><span>
</span><span id="line-1021"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">EqRel
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- no special check for tyconapps</span><span>
</span><span id="line-1022"></span><span>                         </span><span class="hs-comment">-- (this False is ORed with other results, so it</span><span>
</span><span id="line-1023"></span><span>                         </span><span class="hs-comment">--  really means &quot;do nothing special&quot;; the arguments</span><span>
</span><span id="line-1024"></span><span>                         </span><span class="hs-comment">--   are still inspected)</span><span>
</span><span id="line-1025"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- don't expand synonyms</span><span>
</span><span id="line-1026"></span><span>    </span><span class="hs-comment">-- NB: No need to expand synonyms, because we can find</span><span>
</span><span id="line-1027"></span><span>    </span><span class="hs-comment">-- all free variables of a synonym by looking at its</span><span>
</span><span id="line-1028"></span><span>    </span><span class="hs-comment">-- arguments</span><span>
</span><span id="line-1029"></span><span>
</span><span id="line-1030"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#anyRewritableTyFamApp"><span class="hs-identifier hs-type">anyRewritableTyFamApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a></span><span>   </span><span class="hs-comment">-- Ambient role</span><span>
</span><span id="line-1031"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- check tyconapp</span><span>
</span><span id="line-1032"></span><span>                          </span><span class="hs-comment">-- should return True only for type family applications</span><span>
</span><span id="line-1033"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1034"></span><span>  </span><span class="hs-comment">-- always ignores casts &amp; coercions</span><span>
</span><span id="line-1035"></span><span class="hs-comment">-- See Note [Rewritable] in GHC.Tc.Solver.InertSet for a specification for this function.</span><span>
</span><span id="line-1036"></span><span id="anyRewritableTyFamApp"><span class="annot"><span class="annottext">anyRewritableTyFamApp :: EqRel -&gt; (EqRel -&gt; TyCon -&gt; [Type] -&gt; Bool) -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#anyRewritableTyFamApp"><span class="hs-identifier hs-var hs-var">anyRewritableTyFamApp</span></a></span></span><span> </span><span id="local-6989586621681683284"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683284"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621681683285"><span class="annot"><span class="annottext">EqRel -&gt; TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621681683285"><span class="hs-identifier hs-var">check_tyconapp</span></a></span></span><span>
</span><span id="line-1037"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EqRel
-&gt; (EqRel -&gt; TyVar -&gt; Bool)
-&gt; (EqRel -&gt; TyCon -&gt; [Type] -&gt; Bool)
-&gt; (TyCon -&gt; Bool)
-&gt; Type
-&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#any_rewritable"><span class="hs-identifier hs-var">any_rewritable</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683284"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">EqRel
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EqRel -&gt; TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621681683285"><span class="hs-identifier hs-var">check_tyconapp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (TyCon -&gt; Bool) -&gt; TyCon -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isFamFreeTyCon"><span class="hs-identifier hs-var">isFamFreeTyCon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span class="hs-comment">{- Note [anyRewritableTyVar must be role-aware]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
anyRewritableTyVar is used during kick-out from the inert set,
to decide if, given a new equality (a ~ ty), we should kick out
a constraint C.  Rather than gather free variables and see if 'a'
is among them, we instead pass in a predicate; this is just efficiency.

Moreover, consider
  work item:   [G] a ~R f b
  inert item:  [G] b ~R f a
We use anyRewritableTyVar to decide whether to kick out the inert item,
on the grounds that the work item might rewrite it. Well, 'a' is certainly
free in [G] b ~R f a.  But because the role of a type variable ('f' in
this case) is nominal, the work item can't actually rewrite the inert item.
Moreover, if we were to kick out the inert item the exact same situation
would re-occur and we end up with an infinite loop in which each kicks
out the other (#14363).

-}</span><span>
</span><span id="line-1058"></span><span>
</span><span id="line-1059"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          The &quot;exact&quot; free variables of a type
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span class="hs-comment">{- Note [Silly type synonym]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
  type T a = Int
What are the free tyvars of (T x)?  Empty, of course!

exactTyCoVarsOfType is used by the type checker to figure out exactly
which type variables are mentioned in a type.  It only matters
occasionally -- see the calls to exactTyCoVarsOfType.

We place this function here in GHC.Tc.Utils.TcType, not in GHC.Core.TyCo.FVs,
because we want to &quot;see&quot; coreView (efficiency issue only).
-}</span><span>
</span><span id="line-1078"></span><span>
</span><span id="line-1079"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#exactTyCoVarsOfType"><span class="hs-identifier hs-type">exactTyCoVarsOfType</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-1080"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#exactTyCoVarsOfTypes"><span class="hs-identifier hs-type">exactTyCoVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-1081"></span><span class="hs-comment">-- Find the free type variables (of any kind)</span><span>
</span><span id="line-1082"></span><span class="hs-comment">-- but *expand* type synonyms.  See Note [Silly type synonym] above.</span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span id="exactTyCoVarsOfType"><span class="annot"><span class="annottext">exactTyCoVarsOfType :: Type -&gt; VarSet
</span><a href="GHC.Tc.Utils.TcType.html#exactTyCoVarsOfType"><span class="hs-identifier hs-var hs-var">exactTyCoVarsOfType</span></a></span></span><span>  </span><span id="local-6989586621681683288"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683288"><span class="hs-identifier hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Tc.Utils.TcType.html#exact_ty"><span class="hs-identifier hs-var">exact_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683288"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span id="exactTyCoVarsOfTypes"><span class="annot"><span class="annottext">exactTyCoVarsOfTypes :: [Type] -&gt; VarSet
</span><a href="GHC.Tc.Utils.TcType.html#exactTyCoVarsOfTypes"><span class="hs-identifier hs-var hs-var">exactTyCoVarsOfTypes</span></a></span></span><span> </span><span id="local-6989586621681683291"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683291"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Endo VarSet
</span><a href="GHC.Tc.Utils.TcType.html#exact_tys"><span class="hs-identifier hs-var">exact_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683291"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1086"></span><span>
</span><span id="line-1087"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#exact_ty"><span class="hs-identifier hs-type">exact_ty</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Semigroup.Internal.html#Endo/Data.Semigroup.Internal.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-1088"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#exact_tys"><span class="hs-identifier hs-type">exact_tys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Semigroup.Internal.html#Endo/Data.Semigroup.Internal.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-1089"></span><span class="hs-special">(</span><span id="exact_ty"><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Tc.Utils.TcType.html#exact_ty"><span class="hs-identifier hs-var">exact_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="exact_tys"><span class="annot"><span class="annottext">[Type] -&gt; Endo VarSet
</span><a href="GHC.Tc.Utils.TcType.html#exact_tys"><span class="hs-identifier hs-var">exact_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KindCoercion -&gt; Endo VarSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[KindCoercion] -&gt; Endo VarSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
-&gt; VarSet
-&gt; (Type -&gt; Endo VarSet, [Type] -&gt; Endo VarSet,
    KindCoercion -&gt; Endo VarSet, [KindCoercion] -&gt; Endo VarSet)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env
-&gt; (Type -&gt; a, [Type] -&gt; a, KindCoercion -&gt; a, [KindCoercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Tc.Utils.TcType.html#exactTcvFolder"><span class="hs-identifier hs-var">exactTcvFolder</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#exactTcvFolder"><span class="hs-identifier hs-type">exactTcvFolder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Semigroup.Internal.html#Endo/Data.Semigroup.Internal.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1092"></span><span id="exactTcvFolder"><span class="annot"><span class="annottext">exactTcvFolder :: TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Tc.Utils.TcType.html#exactTcvFolder"><span class="hs-identifier hs-var hs-var">exactTcvFolder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Core.TyCo.FVs.html#deepTcvFolder"><span class="hs-identifier hs-var">deepTcvFolder</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#tcf_view"><span class="hs-identifier hs-var">tcf_view</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-type">coreView</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1093"></span><span>                 </span><span class="hs-comment">-- This is the key line</span><span>
</span><span id="line-1094"></span><span>
</span><span id="line-1095"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Predicates
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1102"></span><span>
</span><span id="line-1103"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcIsTcTyVar"><span class="hs-identifier hs-type">tcIsTcTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1104"></span><span class="hs-comment">-- See Note [TcTyVars and TyVars in the typechecker]</span><span>
</span><span id="line-1105"></span><span id="tcIsTcTyVar"><span class="annot"><span class="annottext">tcIsTcTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#tcIsTcTyVar"><span class="hs-identifier hs-var hs-var">tcIsTcTyVar</span></a></span></span><span> </span><span id="local-6989586621681683299"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683299"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683299"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isPromotableMetaTyVar"><span class="hs-identifier hs-type">isPromotableMetaTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1108"></span><span class="hs-comment">-- True is this is a meta-tyvar that can be</span><span>
</span><span id="line-1109"></span><span class="hs-comment">-- promoted to an outer level</span><span>
</span><span id="line-1110"></span><span id="isPromotableMetaTyVar"><span class="annot"><span class="annottext">isPromotableMetaTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isPromotableMetaTyVar"><span class="hs-identifier hs-var hs-var">isPromotableMetaTyVar</span></a></span></span><span> </span><span id="local-6989586621681683301"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683301"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1111"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683301"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-comment">-- See Note [Coercion variables in free variable lists]</span><span>
</span><span id="line-1112"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_info :: TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var">mtv_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683302"><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683302"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683301"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1113"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaInfo -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTouchableInfo"><span class="hs-identifier hs-var">isTouchableInfo</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683302"><span class="hs-identifier hs-var">info</span></a></span><span>   </span><span class="hs-comment">-- Can't promote cycle breakers</span><span>
</span><span id="line-1114"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1115"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1116"></span><span>
</span><span id="line-1117"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTouchableMetaTyVar"><span class="hs-identifier hs-type">isTouchableMetaTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1118"></span><span id="isTouchableMetaTyVar"><span class="annot"><span class="annottext">isTouchableMetaTyVar :: TcLevel -&gt; TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTouchableMetaTyVar"><span class="hs-identifier hs-var hs-var">isTouchableMetaTyVar</span></a></span></span><span> </span><span id="local-6989586621681683304"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683304"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span></span><span> </span><span id="local-6989586621681683305"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683305"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683305"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-comment">-- See Note [Coercion variables in free variable lists]</span><span>
</span><span id="line-1120"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_tclvl :: TcTyVarDetails -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#mtv_tclvl"><span class="hs-identifier hs-var">mtv_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683306"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683306"><span class="hs-identifier hs-var">tv_tclvl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mtv_info :: TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var">mtv_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683307"><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683307"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683305"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1121"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaInfo -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTouchableInfo"><span class="hs-identifier hs-var">isTouchableInfo</span></a></span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683307"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1122"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcLevel -&gt; TcLevel -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#checkTcLevelInvariant"><span class="hs-identifier hs-var">checkTcLevelInvariant</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683304"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683306"><span class="hs-identifier hs-var">tv_tclvl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683305"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683306"><span class="hs-identifier hs-var">tv_tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683304"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1124"></span><span>    </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683306"><span class="hs-identifier hs-var">tv_tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; TcLevel -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#sameDepthAs"><span class="hs-operator hs-var">`sameDepthAs`</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683304"><span class="hs-identifier hs-var">ctxt_tclvl</span></a></span><span>
</span><span id="line-1125"></span><span>
</span><span id="line-1126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1127"></span><span>
</span><span id="line-1128"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isImmutableTyVar"><span class="hs-identifier hs-type">isImmutableTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1129"></span><span id="isImmutableTyVar"><span class="annot"><span class="annottext">isImmutableTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isImmutableTyVar"><span class="hs-identifier hs-var hs-var">isImmutableTyVar</span></a></span></span><span> </span><span id="local-6989586621681683310"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683310"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683310"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1130"></span><span>
</span><span id="line-1131"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyConableTyVar"><span class="hs-identifier hs-type">isTyConableTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier hs-type">isSkolemTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isOverlappableTyVar"><span class="hs-identifier hs-type">isOverlappableTyVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1132"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isMetaTyVar"><span class="hs-identifier hs-type">isMetaTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isAmbiguousTyVar"><span class="hs-identifier hs-type">isAmbiguousTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isCycleBreakerTyVar"><span class="hs-identifier hs-type">isCycleBreakerTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1133"></span><span>
</span><span id="line-1134"></span><span id="isTyConableTyVar"><span class="annot"><span class="annottext">isTyConableTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTyConableTyVar"><span class="hs-identifier hs-var hs-var">isTyConableTyVar</span></a></span></span><span> </span><span id="local-6989586621681683311"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683311"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1135"></span><span>        </span><span class="hs-comment">-- True of a meta-type variable that can be filled in</span><span>
</span><span id="line-1136"></span><span>        </span><span class="hs-comment">-- with a type constructor application; in particular,</span><span>
</span><span id="line-1137"></span><span>        </span><span class="hs-comment">-- not a TyVarTv</span><span>
</span><span id="line-1138"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683311"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-comment">-- See Note [Coercion variables in free variable lists]</span><span>
</span><span id="line-1139"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683311"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1140"></span><span>        </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_info :: TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var">mtv_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#TyVarTv"><span class="hs-identifier hs-var">TyVarTv</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1141"></span><span>        </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1142"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1143"></span><span>
</span><span id="line-1144"></span><span id="isSkolemTyVar"><span class="annot"><span class="annottext">isSkolemTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var hs-var">isSkolemTyVar</span></a></span></span><span> </span><span id="local-6989586621681683312"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683312"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1145"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#tcIsTcTyVar"><span class="hs-identifier hs-var">tcIsTcTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683312"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683312"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1146"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683312"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1147"></span><span>        </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1148"></span><span>        </span><span id="local-6989586621681683313"><span class="annot"><span class="annottext">TcTyVarDetails
</span><a href="#local-6989586621681683313"><span class="hs-identifier hs-var">_other</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1149"></span><span>
</span><span id="line-1150"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#skolemSkolInfo"><span class="hs-identifier hs-type">skolemSkolInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#SkolemInfo"><span class="hs-identifier hs-type">SkolemInfo</span></a></span><span>
</span><span id="line-1151"></span><span id="skolemSkolInfo"><span class="annot"><span class="annottext">skolemSkolInfo :: TyVar -&gt; SkolemInfo
</span><a href="GHC.Tc.Utils.TcType.html#skolemSkolInfo"><span class="hs-identifier hs-var hs-var">skolemSkolInfo</span></a></span></span><span> </span><span id="local-6989586621681683314"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683314"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1152"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SkolemInfo -&gt; SkolemInfo
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSkolemTyVar"><span class="hs-identifier hs-var">isSkolemTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683314"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SkolemInfo -&gt; SkolemInfo) -&gt; SkolemInfo -&gt; SkolemInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1153"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683314"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1154"></span><span>      </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-type">SkolemTv</span></a></span><span> </span><span id="local-6989586621681683316"><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621681683316"><span class="hs-identifier hs-var">skol_info</span></a></span></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621681683316"><span class="hs-identifier hs-var">skol_info</span></a></span><span>
</span><span id="line-1155"></span><span>      </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><a href="GHC.Tc.Utils.TcType.html#RuntimeUnk"><span class="hs-identifier hs-var">RuntimeUnk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SkolemInfo
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RuntimeUnk&quot;</span></span><span>
</span><span id="line-1156"></span><span>      </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SkolemInfo
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;skolemSkolInfo&quot;</span></span><span>
</span><span id="line-1157"></span><span>
</span><span id="line-1158"></span><span>
</span><span id="line-1159"></span><span id="isOverlappableTyVar"><span class="annot"><span class="annottext">isOverlappableTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isOverlappableTyVar"><span class="hs-identifier hs-var hs-var">isOverlappableTyVar</span></a></span></span><span> </span><span id="local-6989586621681683318"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683318"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683318"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-comment">-- See Note [Coercion variables in free variable lists]</span><span>
</span><span id="line-1161"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683318"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1162"></span><span>        </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SkolemTv"><span class="hs-identifier hs-type">SkolemTv</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683319"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683319"><span class="hs-identifier hs-var">overlappable</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683319"><span class="hs-identifier hs-var">overlappable</span></a></span><span>
</span><span id="line-1163"></span><span>        </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1164"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1165"></span><span>
</span><span id="line-1166"></span><span id="isMetaTyVar"><span class="annot"><span class="annottext">isMetaTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isMetaTyVar"><span class="hs-identifier hs-var hs-var">isMetaTyVar</span></a></span></span><span> </span><span id="local-6989586621681683320"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683320"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1167"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683320"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-comment">-- See Note [Coercion variables in free variable lists]</span><span>
</span><span id="line-1168"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683320"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1169"></span><span>        </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1170"></span><span>        </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1171"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1172"></span><span>
</span><span id="line-1173"></span><span class="hs-comment">-- isAmbiguousTyVar is used only when reporting type errors</span><span>
</span><span id="line-1174"></span><span class="hs-comment">-- It picks out variables that are unbound, namely meta</span><span>
</span><span id="line-1175"></span><span class="hs-comment">-- type variables and the RuntimeUnk variables created by</span><span>
</span><span id="line-1176"></span><span class="hs-comment">-- GHC.Runtime.Heap.Inspect.zonkRTTIType.  These are &quot;ambiguous&quot; in</span><span>
</span><span id="line-1177"></span><span class="hs-comment">-- the sense that they stand for an as-yet-unknown type</span><span>
</span><span id="line-1178"></span><span id="isAmbiguousTyVar"><span class="annot"><span class="annottext">isAmbiguousTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isAmbiguousTyVar"><span class="hs-identifier hs-var hs-var">isAmbiguousTyVar</span></a></span></span><span> </span><span id="local-6989586621681683321"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683321"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1179"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683321"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-comment">-- See Note [Coercion variables in free variable lists]</span><span>
</span><span id="line-1180"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683321"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1181"></span><span>        </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1182"></span><span>        </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#RuntimeUnk"><span class="hs-identifier hs-type">RuntimeUnk</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1183"></span><span>        </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1184"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1185"></span><span>
</span><span id="line-1186"></span><span id="isCycleBreakerTyVar"><span class="annot"><span class="annottext">isCycleBreakerTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isCycleBreakerTyVar"><span class="hs-identifier hs-var hs-var">isCycleBreakerTyVar</span></a></span></span><span> </span><span id="local-6989586621681683322"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683322"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1187"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683322"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-comment">-- See Note [Coercion variables in free variable lists]</span><span>
</span><span id="line-1188"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_info :: TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var">mtv_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#CycleBreakerTv"><span class="hs-identifier hs-var">CycleBreakerTv</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683322"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1189"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1190"></span><span>
</span><span id="line-1191"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1192"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1193"></span><span>
</span><span id="line-1194"></span><span class="hs-comment">-- | Is this type variable a concrete type variable, i.e.</span><span>
</span><span id="line-1195"></span><span class="hs-comment">-- it is a metavariable with 'ConcreteTv' 'MetaInfo'?</span><span>
</span><span id="line-1196"></span><span class="hs-comment">--</span><span>
</span><span id="line-1197"></span><span class="hs-comment">-- Returns the 'ConcreteTvOrigin' stored in the type variable</span><span>
</span><span id="line-1198"></span><span class="hs-comment">-- if so, or 'Nothing' otherwise.</span><span>
</span><span id="line-1199"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar_maybe"><span class="hs-identifier hs-type">isConcreteTyVar_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span>
</span><span id="line-1200"></span><span id="isConcreteTyVar_maybe"><span class="annot"><span class="annottext">isConcreteTyVar_maybe :: TyVar -&gt; Maybe ConcreteTvOrigin
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar_maybe"><span class="hs-identifier hs-var hs-var">isConcreteTyVar_maybe</span></a></span></span><span> </span><span id="local-6989586621681683323"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683323"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1201"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTcTyVar"><span class="hs-identifier hs-var">isTcTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683323"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1202"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_info :: TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var">mtv_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTv"><span class="hs-identifier hs-type">ConcreteTv</span></a></span><span> </span><span id="local-6989586621681683324"><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621681683324"><span class="hs-identifier hs-var">conc_orig</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683323"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1203"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin -&gt; Maybe ConcreteTvOrigin
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621681683324"><span class="hs-identifier hs-var">conc_orig</span></a></span><span>
</span><span id="line-1204"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1205"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ConcreteTvOrigin
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1206"></span><span>
</span><span id="line-1207"></span><span class="hs-comment">-- | Is this type variable a concrete type variable, i.e.</span><span>
</span><span id="line-1208"></span><span class="hs-comment">-- it is a metavariable with 'ConcreteTv' 'MetaInfo'?</span><span>
</span><span id="line-1209"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar"><span class="hs-identifier hs-type">isConcreteTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1210"></span><span id="isConcreteTyVar"><span class="annot"><span class="annottext">isConcreteTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar"><span class="hs-identifier hs-var hs-var">isConcreteTyVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ConcreteTvOrigin -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Maybe.html#isJust/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ConcreteTvOrigin -&gt; Bool)
-&gt; (TyVar -&gt; Maybe ConcreteTvOrigin) -&gt; TyVar -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Maybe ConcreteTvOrigin
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar_maybe"><span class="hs-identifier hs-var">isConcreteTyVar_maybe</span></a></span><span>
</span><span id="line-1211"></span><span>
</span><span id="line-1212"></span><span class="hs-comment">-- | Is this type concrete type variable, i.e.</span><span>
</span><span id="line-1213"></span><span class="hs-comment">-- a metavariable with 'ConcreteTv' 'MetaInfo'?</span><span>
</span><span id="line-1214"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy"><span class="hs-identifier hs-type">isConcreteTyVarTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1215"></span><span id="isConcreteTyVarTy"><span class="annot"><span class="annottext">isConcreteTyVarTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy"><span class="hs-identifier hs-var hs-var">isConcreteTyVarTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, ConcreteTvOrigin) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Maybe.html#isJust/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (TyVar, ConcreteTvOrigin) -&gt; Bool)
-&gt; (Type -&gt; Maybe (TyVar, ConcreteTvOrigin)) -&gt; Type -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (TyVar, ConcreteTvOrigin)
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy_maybe"><span class="hs-identifier hs-var">isConcreteTyVarTy_maybe</span></a></span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span class="hs-comment">-- | Is this type a concrete type variable? If so, return</span><span>
</span><span id="line-1218"></span><span class="hs-comment">-- the associated 'TcTyVar' and 'ConcreteTvOrigin'.</span><span>
</span><span id="line-1219"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy_maybe"><span class="hs-identifier hs-type">isConcreteTyVarTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1220"></span><span id="isConcreteTyVarTy_maybe"><span class="annot"><span class="annottext">isConcreteTyVarTy_maybe :: Type -&gt; Maybe (TyVar, ConcreteTvOrigin)
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy_maybe"><span class="hs-identifier hs-var hs-var">isConcreteTyVarTy_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621681683326"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683326"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683326"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ConcreteTvOrigin -&gt; (TyVar, ConcreteTvOrigin))
-&gt; Maybe ConcreteTvOrigin -&gt; Maybe (TyVar, ConcreteTvOrigin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Maybe ConcreteTvOrigin
</span><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVar_maybe"><span class="hs-identifier hs-var">isConcreteTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683326"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1221"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isConcreteTyVarTy_maybe"><span class="hs-identifier hs-var">isConcreteTyVarTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TyVar, ConcreteTvOrigin)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1222"></span><span>
</span><span id="line-1223"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isMetaTyVarTy"><span class="hs-identifier hs-type">isMetaTyVarTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1224"></span><span id="isMetaTyVarTy"><span class="annot"><span class="annottext">isMetaTyVarTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isMetaTyVarTy"><span class="hs-identifier hs-var hs-var">isMetaTyVarTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621681683328"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683328"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isMetaTyVar"><span class="hs-identifier hs-var">isMetaTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683328"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1225"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isMetaTyVarTy"><span class="hs-identifier hs-var">isMetaTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#metaTyVarInfo"><span class="hs-identifier hs-type">metaTyVarInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaInfo"><span class="hs-identifier hs-type">MetaInfo</span></a></span><span>
</span><span id="line-1228"></span><span id="metaTyVarInfo"><span class="annot"><span class="annottext">metaTyVarInfo :: TyVar -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#metaTyVarInfo"><span class="hs-identifier hs-var hs-var">metaTyVarInfo</span></a></span></span><span> </span><span id="local-6989586621681683329"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683329"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1229"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683329"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1230"></span><span>      </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_info :: TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var">mtv_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683330"><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683330"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683330"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-1231"></span><span>      </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; MetaInfo
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;metaTyVarInfo&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683329"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1232"></span><span>
</span><span id="line-1233"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTouchableInfo"><span class="hs-identifier hs-type">isTouchableInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaInfo"><span class="hs-identifier hs-type">MetaInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1234"></span><span id="isTouchableInfo"><span class="annot"><span class="annottext">isTouchableInfo :: MetaInfo -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTouchableInfo"><span class="hs-identifier hs-var hs-var">isTouchableInfo</span></a></span></span><span> </span><span id="local-6989586621681683332"><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683332"><span class="hs-identifier hs-var">info</span></a></span></span><span>
</span><span id="line-1235"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#CycleBreakerTv"><span class="hs-identifier hs-var">CycleBreakerTv</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="#local-6989586621681683332"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1236"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1237"></span><span>
</span><span id="line-1238"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#metaTyVarTcLevel"><span class="hs-identifier hs-type">metaTyVarTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-1239"></span><span id="metaTyVarTcLevel"><span class="annot"><span class="annottext">metaTyVarTcLevel :: TyVar -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#metaTyVarTcLevel"><span class="hs-identifier hs-var hs-var">metaTyVarTcLevel</span></a></span></span><span> </span><span id="local-6989586621681683333"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683333"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1240"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683333"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1241"></span><span>      </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_tclvl :: TcTyVarDetails -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#mtv_tclvl"><span class="hs-identifier hs-var">mtv_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683334"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683334"><span class="hs-identifier hs-var">tclvl</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683334"><span class="hs-identifier hs-var">tclvl</span></a></span><span>
</span><span id="line-1242"></span><span>      </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcLevel
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;metaTyVarTcLevel&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683333"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1243"></span><span>
</span><span id="line-1244"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#metaTyVarTcLevel_maybe"><span class="hs-identifier hs-type">metaTyVarTcLevel_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span>
</span><span id="line-1245"></span><span id="metaTyVarTcLevel_maybe"><span class="annot"><span class="annottext">metaTyVarTcLevel_maybe :: TyVar -&gt; Maybe TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#metaTyVarTcLevel_maybe"><span class="hs-identifier hs-var hs-var">metaTyVarTcLevel_maybe</span></a></span></span><span> </span><span id="local-6989586621681683335"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683335"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1246"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683335"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1247"></span><span>      </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_tclvl :: TcTyVarDetails -&gt; TcLevel
</span><a href="GHC.Tc.Utils.TcType.html#mtv_tclvl"><span class="hs-identifier hs-var">mtv_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683336"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683336"><span class="hs-identifier hs-var">tclvl</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcLevel -&gt; Maybe TcLevel
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683336"><span class="hs-identifier hs-var">tclvl</span></a></span><span>
</span><span id="line-1248"></span><span>      </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TcLevel
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1249"></span><span>
</span><span id="line-1250"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#metaTyVarRef"><span class="hs-identifier hs-type">metaTyVarRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.IORef.html#IORef/GHC.IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaDetails"><span class="hs-identifier hs-type">MetaDetails</span></a></span><span>
</span><span id="line-1251"></span><span id="metaTyVarRef"><span class="annot"><span class="annottext">metaTyVarRef :: TyVar -&gt; IORef MetaDetails
</span><a href="GHC.Tc.Utils.TcType.html#metaTyVarRef"><span class="hs-identifier hs-var hs-var">metaTyVarRef</span></a></span></span><span> </span><span id="local-6989586621681683337"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683337"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1252"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683337"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1253"></span><span>        </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_ref :: TcTyVarDetails -&gt; IORef MetaDetails
</span><a href="GHC.Tc.Utils.TcType.html#mtv_ref"><span class="hs-identifier hs-var">mtv_ref</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683338"><span class="annot"><span class="annottext">IORef MetaDetails
</span><a href="#local-6989586621681683338"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IORef MetaDetails
</span><a href="#local-6989586621681683338"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-1254"></span><span>        </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; IORef MetaDetails
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;metaTyVarRef&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683337"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>
</span><span id="line-1256"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#setMetaTyVarTcLevel"><span class="hs-identifier hs-type">setMetaTyVarTcLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcLevel"><span class="hs-identifier hs-type">TcLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span>
</span><span id="line-1257"></span><span id="setMetaTyVarTcLevel"><span class="annot"><span class="annottext">setMetaTyVarTcLevel :: TyVar -&gt; TcLevel -&gt; TyVar
</span><a href="GHC.Tc.Utils.TcType.html#setMetaTyVarTcLevel"><span class="hs-identifier hs-var hs-var">setMetaTyVarTcLevel</span></a></span></span><span> </span><span id="local-6989586621681683339"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683339"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681683340"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681683340"><span class="hs-identifier hs-var">tclvl</span></a></span></span><span>
</span><span id="line-1258"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683339"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1259"></span><span>      </span><span id="local-6989586621681683341"><span class="annot"><span class="annottext">details :: TcTyVarDetails
</span><a href="#local-6989586621681683341"><span class="hs-identifier hs-var">details</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails -&gt; TyVar
</span><a href="GHC.Types.Var.html#setTcTyVarDetails"><span class="hs-identifier hs-var">setTcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683339"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcTyVarDetails
</span><a href="#local-6989586621681683341"><span class="hs-identifier hs-var">details</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mtv_tclvl"><span class="hs-identifier hs-var">mtv_tclvl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681683340"><span class="hs-identifier hs-type">tclvl</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1260"></span><span>      </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TyVar
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;metaTyVarTcLevel&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683339"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1261"></span><span>
</span><span id="line-1262"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyVarTyVar"><span class="hs-identifier hs-type">isTyVarTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1263"></span><span id="isTyVarTyVar"><span class="annot"><span class="annottext">isTyVarTyVar :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTyVarTyVar"><span class="hs-identifier hs-var hs-var">isTyVarTyVar</span></a></span></span><span> </span><span id="local-6989586621681683343"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683343"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-1264"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683343"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1265"></span><span>        </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mtv_info :: TcTyVarDetails -&gt; MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#mtv_info"><span class="hs-identifier hs-var">mtv_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaInfo
</span><a href="GHC.Tc.Utils.TcType.html#TyVarTv"><span class="hs-identifier hs-var">TyVarTv</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1266"></span><span>        </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1267"></span><span>
</span><span id="line-1268"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFlexi"><span class="hs-identifier hs-type">isFlexi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isIndirect"><span class="hs-identifier hs-type">isIndirect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#MetaDetails"><span class="hs-identifier hs-type">MetaDetails</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1269"></span><span id="isFlexi"><span class="annot"><span class="annottext">isFlexi :: MetaDetails -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isFlexi"><span class="hs-identifier hs-var hs-var">isFlexi</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaDetails
</span><a href="GHC.Tc.Utils.TcType.html#Flexi"><span class="hs-identifier hs-var">Flexi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1270"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFlexi"><span class="hs-identifier hs-var">isFlexi</span></a></span><span> </span><span class="annot"><span class="annottext">MetaDetails
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1271"></span><span>
</span><span id="line-1272"></span><span id="isIndirect"><span class="annot"><span class="annottext">isIndirect :: MetaDetails -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isIndirect"><span class="hs-identifier hs-var hs-var">isIndirect</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Indirect"><span class="hs-identifier hs-type">Indirect</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1273"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isIndirect"><span class="hs-identifier hs-var">isIndirect</span></a></span><span> </span><span class="annot"><span class="annottext">MetaDetails
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1274"></span><span>
</span><span id="line-1275"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRuntimeUnkSkol"><span class="hs-identifier hs-type">isRuntimeUnkSkol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1276"></span><span class="hs-comment">-- Called only in GHC.Tc.Errors; see Note [Runtime skolems] there</span><span>
</span><span id="line-1277"></span><span id="isRuntimeUnkSkol"><span class="annot"><span class="annottext">isRuntimeUnkSkol :: TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRuntimeUnkSkol"><span class="hs-identifier hs-var hs-var">isRuntimeUnkSkol</span></a></span></span><span> </span><span id="local-6989586621681683344"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683344"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-1278"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TcTyVarDetails
</span><a href="GHC.Tc.Utils.TcType.html#RuntimeUnk"><span class="hs-identifier hs-var">RuntimeUnk</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; TcTyVarDetails
</span><a href="GHC.Types.Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683344"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1279"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1280"></span><span>
</span><span id="line-1281"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkTyVarNamePairs"><span class="hs-identifier hs-type">mkTyVarNamePairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- Just pair each TyVar with its own name</span><span>
</span><span id="line-1283"></span><span id="mkTyVarNamePairs"><span class="annot"><span class="annottext">mkTyVarNamePairs :: [TyVar] -&gt; [(Name, TyVar)]
</span><a href="GHC.Tc.Utils.TcType.html#mkTyVarNamePairs"><span class="hs-identifier hs-var hs-var">mkTyVarNamePairs</span></a></span></span><span> </span><span id="local-6989586621681683345"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683345"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Name
</span><a href="GHC.Types.Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683347"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683347"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681683347"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683347"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683345"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1284"></span><span>
</span><span id="line-1285"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#findDupTyVarTvs"><span class="hs-identifier hs-type">findDupTyVarTvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1286"></span><span class="hs-comment">-- If we have [...(x1,tv)...(x2,tv)...]</span><span>
</span><span id="line-1287"></span><span class="hs-comment">-- return (x1,x2) in the result list</span><span>
</span><span id="line-1288"></span><span id="findDupTyVarTvs"><span class="annot"><span class="annottext">findDupTyVarTvs :: [(Name, TyVar)] -&gt; [(Name, Name)]
</span><a href="GHC.Tc.Utils.TcType.html#findDupTyVarTvs"><span class="hs-identifier hs-var hs-var">findDupTyVarTvs</span></a></span></span><span> </span><span id="local-6989586621681683348"><span class="annot"><span class="annottext">[(Name, TyVar)]
</span><a href="#local-6989586621681683348"><span class="hs-identifier hs-var">prs</span></a></span></span><span>
</span><span id="line-1289"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Name, TyVar) -&gt; [(Name, Name)])
-&gt; [NonEmpty (Name, TyVar)] -&gt; [(Name, Name)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Name, TyVar) -&gt; [(Name, Name)]
forall {b} {b}. NonEmpty (b, b) -&gt; [(b, b)]
</span><a href="#local-6989586621681683350"><span class="hs-identifier hs-var">mk_result_prs</span></a></span><span> </span><span class="annot"><span class="annottext">([NonEmpty (Name, TyVar)] -&gt; [(Name, Name)])
-&gt; [NonEmpty (Name, TyVar)] -&gt; [(Name, Name)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1290"></span><span>    </span><span class="annot"><span class="annottext">((Name, TyVar) -&gt; (Name, TyVar) -&gt; Bool)
-&gt; [(Name, TyVar)] -&gt; [NonEmpty (Name, TyVar)]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [NonEmpty a]
</span><a href="GHC.Data.List.SetOps.html#findDupsEq"><span class="hs-identifier hs-var">findDupsEq</span></a></span><span> </span><span class="annot"><span class="annottext">(Name, TyVar) -&gt; (Name, TyVar) -&gt; Bool
forall {a} {a} {a}. Eq a =&gt; (a, a) -&gt; (a, a) -&gt; Bool
</span><a href="#local-6989586621681683351"><span class="hs-identifier hs-var">eq_snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, TyVar)]
</span><a href="#local-6989586621681683348"><span class="hs-identifier hs-var">prs</span></a></span><span>
</span><span id="line-1291"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1292"></span><span>    </span><span id="local-6989586621681683351"><span class="annot"><span class="annottext">eq_snd :: (a, a) -&gt; (a, a) -&gt; Bool
</span><a href="#local-6989586621681683351"><span class="hs-identifier hs-var hs-var">eq_snd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681683354"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683354"><span class="hs-identifier hs-var">tv1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681683355"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683355"><span class="hs-identifier hs-var">tv2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683354"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683355"><span class="hs-identifier hs-var">tv2</span></a></span><span>
</span><span id="line-1293"></span><span>    </span><span id="local-6989586621681683350"><span class="annot"><span class="annottext">mk_result_prs :: NonEmpty (b, b) -&gt; [(b, b)]
</span><a href="#local-6989586621681683350"><span class="hs-identifier hs-var hs-var">mk_result_prs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681683356"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681683356"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#%3A%7C/GHC.Base.html#%3A%7C"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621681683358"><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621681683358"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((b, b) -&gt; (b, b)) -&gt; [(b, b)] -&gt; [(b, b)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681683359"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681683359"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681683356"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681683359"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621681683358"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1294"></span><span>
</span><span id="line-1295"></span><span class="hs-comment">-- | Returns the (kind, type) variables in a type that are</span><span>
</span><span id="line-1296"></span><span class="hs-comment">-- as-yet-unknown: metavariables and RuntimeUnks</span><span>
</span><span id="line-1297"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ambigTkvsOfTy"><span class="hs-identifier hs-type">ambigTkvsOfTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1298"></span><span id="ambigTkvsOfTy"><span class="annot"><span class="annottext">ambigTkvsOfTy :: Type -&gt; ([TyVar], [TyVar])
</span><a href="GHC.Tc.Utils.TcType.html#ambigTkvsOfTy"><span class="hs-identifier hs-var hs-var">ambigTkvsOfTy</span></a></span></span><span> </span><span id="local-6989586621681683360"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683360"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1299"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Bool) -&gt; [TyVar] -&gt; ([TyVar], [TyVar])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base-4.18.3.0/src/Data.OldList.html#partition/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683361"><span class="hs-identifier hs-var">dep_tkv_set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683362"><span class="hs-identifier hs-var">ambig_tkvs</span></a></span><span>
</span><span id="line-1300"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1301"></span><span>    </span><span id="local-6989586621681683363"><span class="annot"><span class="annottext">tkvs :: [TyVar]
</span><a href="#local-6989586621681683363"><span class="hs-identifier hs-var hs-var">tkvs</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [TyVar]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683360"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1302"></span><span>    </span><span id="local-6989586621681683362"><span class="annot"><span class="annottext">ambig_tkvs :: [TyVar]
</span><a href="#local-6989586621681683362"><span class="hs-identifier hs-var hs-var">ambig_tkvs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Bool) -&gt; [TyVar] -&gt; [TyVar]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isAmbiguousTyVar"><span class="hs-identifier hs-var">isAmbiguousTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683363"><span class="hs-identifier hs-var">tkvs</span></a></span><span>
</span><span id="line-1303"></span><span>    </span><span id="local-6989586621681683361"><span class="annot"><span class="annottext">dep_tkv_set :: VarSet
</span><a href="#local-6989586621681683361"><span class="hs-identifier hs-var hs-var">dep_tkv_set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVar -&gt; Type) -&gt; [TyVar] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683363"><span class="hs-identifier hs-var">tkvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1304"></span><span>
</span><span id="line-1305"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
   Tau, sigma and rho
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1312"></span><span>
</span><span id="line-1313"></span><span class="hs-comment">-- | Make a sigma ty where all type variables are 'Inferred'. That is,</span><span>
</span><span id="line-1314"></span><span class="hs-comment">-- they cannot be used with visible type application.</span><span>
</span><span id="line-1315"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkInfSigmaTy"><span class="hs-identifier hs-type">mkInfSigmaTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1316"></span><span id="mkInfSigmaTy"><span class="annot"><span class="annottext">mkInfSigmaTy :: (() :: Constraint) =&gt; [TyVar] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#mkInfSigmaTy"><span class="hs-identifier hs-var hs-var">mkInfSigmaTy</span></a></span></span><span> </span><span id="local-6989586621681683370"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683370"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span id="local-6989586621681683371"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683371"><span class="hs-identifier hs-var">theta</span></a></span></span><span> </span><span id="local-6989586621681683372"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683372"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ForAllTyBinder] -&gt; [Type] -&gt; Type -&gt; Type
(() :: Constraint) =&gt; [ForAllTyBinder] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#mkSigmaTy"><span class="hs-identifier hs-var">mkSigmaTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; [TyVar] -&gt; [ForAllTyBinder]
forall vis. vis -&gt; [TyVar] -&gt; [VarBndr TyVar vis]
</span><a href="GHC.Types.Var.html#mkForAllTyBinders"><span class="hs-identifier hs-var">mkForAllTyBinders</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="GHC.Types.Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683370"><span class="hs-identifier hs-var">tyvars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683371"><span class="hs-identifier hs-var">theta</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683372"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1317"></span><span>
</span><span id="line-1318"></span><span class="hs-comment">-- | Make a sigma ty where all type variables are &quot;specified&quot;. That is,</span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- they can be used with visible type application</span><span>
</span><span id="line-1320"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-type">mkSpecSigmaTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1321"></span><span id="mkSpecSigmaTy"><span class="annot"><span class="annottext">mkSpecSigmaTy :: (() :: Constraint) =&gt; [TyVar] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var hs-var">mkSpecSigmaTy</span></a></span></span><span> </span><span id="local-6989586621681683376"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683376"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span id="local-6989586621681683377"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683377"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span id="local-6989586621681683378"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683378"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ForAllTyBinder] -&gt; [Type] -&gt; Type -&gt; Type
(() :: Constraint) =&gt; [ForAllTyBinder] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#mkSigmaTy"><span class="hs-identifier hs-var">mkSigmaTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; [TyVar] -&gt; [ForAllTyBinder]
forall vis. vis -&gt; [TyVar] -&gt; [VarBndr TyVar vis]
</span><a href="GHC.Types.Var.html#mkForAllTyBinders"><span class="hs-identifier hs-var">mkForAllTyBinders</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="GHC.Types.Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683376"><span class="hs-identifier hs-var">tyvars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683377"><span class="hs-identifier hs-var">preds</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683378"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1322"></span><span>
</span><span id="line-1323"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkSigmaTy"><span class="hs-identifier hs-type">mkSigmaTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyBinder"><span class="hs-identifier hs-type">ForAllTyBinder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1324"></span><span class="hs-comment">-- Result is TypeLike</span><span>
</span><span id="line-1325"></span><span id="mkSigmaTy"><span class="annot"><span class="annottext">mkSigmaTy :: (() :: Constraint) =&gt; [ForAllTyBinder] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#mkSigmaTy"><span class="hs-identifier hs-var hs-var">mkSigmaTy</span></a></span></span><span> </span><span id="local-6989586621681683382"><span class="annot"><span class="annottext">[ForAllTyBinder]
</span><a href="#local-6989586621681683382"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span id="local-6989586621681683383"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683383"><span class="hs-identifier hs-var">theta</span></a></span></span><span> </span><span id="local-6989586621681683384"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683384"><span class="hs-identifier hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ForAllTyBinder] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[ForAllTyBinder]
</span><a href="#local-6989586621681683382"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; Type
(() :: Constraint) =&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier hs-var">mkPhiTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683383"><span class="hs-identifier hs-var">theta</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683384"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1326"></span><span>
</span><span id="line-1327"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcMkDFunSigmaTy"><span class="hs-identifier hs-type">tcMkDFunSigmaTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1328"></span><span id="tcMkDFunSigmaTy"><span class="annot"><span class="annottext">tcMkDFunSigmaTy :: [TyVar] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#tcMkDFunSigmaTy"><span class="hs-identifier hs-var hs-var">tcMkDFunSigmaTy</span></a></span></span><span> </span><span id="local-6989586621681683385"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683385"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681683386"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683386"><span class="hs-identifier hs-var">theta</span></a></span></span><span> </span><span id="local-6989586621681683387"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683387"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-1329"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ForAllTyBinder] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; [TyVar] -&gt; [ForAllTyBinder]
forall vis. vis -&gt; [TyVar] -&gt; [VarBndr TyVar vis]
</span><a href="GHC.Types.Var.html#mkForAllTyBinders"><span class="hs-identifier hs-var">mkForAllTyBinders</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="GHC.Types.Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683385"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1330"></span><span>   </span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; Type
(() :: Constraint) =&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#tcMkDFunPhiTy"><span class="hs-identifier hs-var">tcMkDFunPhiTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683386"><span class="hs-identifier hs-var">theta</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683387"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-1331"></span><span>
</span><span id="line-1332"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier hs-type">mkPhiTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1333"></span><span class="hs-comment">-- Result type is TypeLike</span><span>
</span><span id="line-1334"></span><span id="mkPhiTy"><span class="annot"><span class="annottext">mkPhiTy :: (() :: Constraint) =&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier hs-var hs-var">mkPhiTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; Type
(() :: Constraint) =&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTys"><span class="hs-identifier hs-var">mkInvisFunTys</span></a></span><span>
</span><span id="line-1335"></span><span>
</span><span id="line-1336"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcMkPhiTy"><span class="hs-identifier hs-type">tcMkPhiTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1337"></span><span class="hs-comment">-- Like mkPhiTy, but with no assertion checks; it is called</span><span>
</span><span id="line-1338"></span><span class="hs-comment">-- by the type checker and the result kind may not be zonked yet</span><span>
</span><span id="line-1339"></span><span class="hs-comment">-- But the result kind is TypeLike</span><span>
</span><span id="line-1340"></span><span id="tcMkPhiTy"><span class="annot"><span class="annottext">tcMkPhiTy :: (() :: Constraint) =&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#tcMkPhiTy"><span class="hs-identifier hs-var hs-var">tcMkPhiTy</span></a></span></span><span> </span><span id="local-6989586621681683392"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683392"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621681683393"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683393"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#tcMkInvisFunTy"><span class="hs-identifier hs-var">tcMkInvisFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#TypeLike"><span class="hs-identifier hs-var">TypeLike</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683393"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683392"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1341"></span><span>
</span><span id="line-1342"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcMkDFunPhiTy"><span class="hs-identifier hs-type">tcMkDFunPhiTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1343"></span><span class="hs-comment">-- Just like tcMkPhiTy, but result type is ConstraintLike</span><span>
</span><span id="line-1344"></span><span id="tcMkDFunPhiTy"><span class="annot"><span class="annottext">tcMkDFunPhiTy :: (() :: Constraint) =&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#tcMkDFunPhiTy"><span class="hs-identifier hs-var hs-var">tcMkDFunPhiTy</span></a></span></span><span> </span><span id="local-6989586621681683398"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683398"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span id="local-6989586621681683399"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683399"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeOrConstraint -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#tcMkInvisFunTy"><span class="hs-identifier hs-var">tcMkInvisFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrConstraint
</span><a href="GHC.Types.Basic.html#ConstraintLike"><span class="hs-identifier hs-var">ConstraintLike</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683399"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683398"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-1345"></span><span>
</span><span id="line-1346"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-1347"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-type">getDFunTyKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-comment">-- Get some string from a type, to be used to</span><span>
</span><span id="line-1348"></span><span>                                </span><span class="hs-comment">-- construct a dictionary function name</span><span>
</span><span id="line-1349"></span><span id="getDFunTyKey"><span class="annot"><span class="annottext">getDFunTyKey :: Type -&gt; OccName
</span><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var hs-var">getDFunTyKey</span></a></span></span><span> </span><span id="local-6989586621681683401"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683401"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683402"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683402"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683401"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; OccName
</span><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683402"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1350"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621681683403"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683403"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; OccName
forall a. NamedThing a =&gt; a -&gt; OccName
</span><a href="GHC.Types.Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683403"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1351"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681683405"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683405"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; OccName
forall a. NamedThing a =&gt; a -&gt; OccName
</span><a href="GHC.Types.Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683405"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1352"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621681683406"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621681683406"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; OccName
</span><a href="GHC.Tc.Utils.TcType.html#getDFunTyLitKey"><span class="hs-identifier hs-var">getDFunTyLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621681683406"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1353"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621681683408"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683408"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; OccName
</span><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683408"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-1354"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683410"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683410"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; OccName
forall a. NamedThing a =&gt; a -&gt; OccName
</span><a href="GHC.Types.Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag -&gt; TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyFlagTyCon"><span class="hs-identifier hs-var">funTyFlagTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683410"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1355"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683412"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683412"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; OccName
</span><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683412"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1356"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621681683413"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683413"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; OccName
</span><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683413"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1357"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyKey"><span class="hs-identifier hs-var">getDFunTyKey</span></a></span><span> </span><span id="local-6989586621681683414"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621681683414"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; OccName
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getDFunTyKey&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683414"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1358"></span><span>
</span><span id="line-1359"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyLitKey"><span class="hs-identifier hs-type">getDFunTyLitKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span>
</span><span id="line-1360"></span><span id="getDFunTyLitKey"><span class="annot"><span class="annottext">getDFunTyLitKey :: TyLit -&gt; OccName
</span><a href="GHC.Tc.Utils.TcType.html#getDFunTyLitKey"><span class="hs-identifier hs-var hs-var">getDFunTyLitKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-type">NumTyLit</span></a></span><span> </span><span id="local-6989586621681683416"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681683416"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; String -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier hs-var">Name.varName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../base-4.18.3.0/src/GHC.Show.html#show/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681683416"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1361"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyLitKey"><span class="hs-identifier hs-var">getDFunTyLitKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-type">StrTyLit</span></a></span><span> </span><span id="local-6989586621681683421"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681683421"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; String -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier hs-var">Name.varName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../base-4.18.3.0/src/GHC.Show.html#show/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681683421"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- hm</span><span>
</span><span id="line-1362"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#getDFunTyLitKey"><span class="hs-identifier hs-var">getDFunTyLitKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CharTyLit"><span class="hs-identifier hs-type">CharTyLit</span></a></span><span> </span><span id="local-6989586621681683423"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681683423"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; String -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier hs-var">Name.varName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../base-4.18.3.0/src/GHC.Show.html#show/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681683423"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1363"></span><span>
</span><span id="line-1364"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
   Expanding and splitting
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1371"></span><span>
</span><span id="line-1372"></span><span class="hs-comment">-- | Splits a forall type into a list of 'PiTyVarBinder's and the inner type.</span><span>
</span><span id="line-1373"></span><span class="hs-comment">-- Always succeeds, even if it returns an empty list.</span><span>
</span><span id="line-1374"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTys"><span class="hs-identifier hs-type">tcSplitPiTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#PiTyVarBinder"><span class="hs-identifier hs-type">PiTyVarBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1375"></span><span id="tcSplitPiTys"><span class="annot"><span class="annottext">tcSplitPiTys :: Type -&gt; ([PiTyVarBinder], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTys"><span class="hs-identifier hs-var hs-var">tcSplitPiTys</span></a></span></span><span> </span><span id="local-6989586621681683424"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683424"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1376"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ([PiTyVarBinder], Type) -&gt; ([PiTyVarBinder], Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PiTyVarBinder -&gt; Bool) -&gt; [PiTyVarBinder] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">PiTyVarBinder -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyBinder"><span class="hs-identifier hs-var">isTyBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([PiTyVarBinder], Type) -&gt; [PiTyVarBinder]
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([PiTyVarBinder], Type)
</span><a href="#local-6989586621681683428"><span class="hs-identifier hs-var">sty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- No CoVar binders here</span><span>
</span><span id="line-1377"></span><span>    </span><span class="annot"><span class="annottext">([PiTyVarBinder], Type)
</span><a href="#local-6989586621681683428"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-1378"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681683428"><span class="annot"><span class="annottext">sty :: ([PiTyVarBinder], Type)
</span><a href="#local-6989586621681683428"><span class="hs-identifier hs-var hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([PiTyVarBinder], Type)
</span><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683424"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1379"></span><span>
</span><span id="line-1380"></span><span class="annot"><span class="hs-comment">-- | Splits a type into a PiTyVarBinder and a body, if possible.</span></span><span>
</span><span id="line-1381"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTy_maybe"><span class="hs-identifier hs-type">tcSplitPiTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#PiTyVarBinder"><span class="hs-identifier hs-type">PiTyVarBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1382"></span><span id="tcSplitPiTy_maybe"><span class="annot"><span class="annottext">tcSplitPiTy_maybe :: Type -&gt; Maybe (PiTyVarBinder, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTy_maybe"><span class="hs-identifier hs-var hs-var">tcSplitPiTy_maybe</span></a></span></span><span> </span><span id="local-6989586621681683430"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683430"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1383"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe (PiTyVarBinder, Type) -&gt; Maybe (PiTyVarBinder, Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (PiTyVarBinder, Type) -&gt; Bool
forall {b}. Maybe (PiTyVarBinder, b) -&gt; Bool
</span><a href="#local-6989586621681683431"><span class="hs-identifier hs-var">isMaybeTyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (PiTyVarBinder, Type)
</span><a href="#local-6989586621681683432"><span class="hs-identifier hs-var">sty</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- No CoVar binders here</span><span>
</span><span id="line-1384"></span><span>    </span><span class="annot"><span class="annottext">Maybe (PiTyVarBinder, Type)
</span><a href="#local-6989586621681683432"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-1385"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1386"></span><span>    </span><span id="local-6989586621681683432"><span class="annot"><span class="annottext">sty :: Maybe (PiTyVarBinder, Type)
</span><a href="#local-6989586621681683432"><span class="hs-identifier hs-var hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (PiTyVarBinder, Type)
</span><a href="GHC.Core.Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var">splitPiTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683430"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1387"></span><span>    </span><span id="local-6989586621681683431"><span class="annot"><span class="annottext">isMaybeTyBinder :: Maybe (PiTyVarBinder, b) -&gt; Bool
</span><a href="#local-6989586621681683431"><span class="hs-identifier hs-var hs-var">isMaybeTyBinder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683434"><span class="annot"><span class="annottext">PiTyVarBinder
</span><a href="#local-6989586621681683434"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PiTyVarBinder -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyBinder"><span class="hs-identifier hs-var">isTyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">PiTyVarBinder
</span><a href="#local-6989586621681683434"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1388"></span><span>    </span><span class="annot"><a href="#local-6989586621681683431"><span class="hs-identifier hs-var">isMaybeTyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (PiTyVarBinder, b)
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1389"></span><span>
</span><span id="line-1390"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinder_maybe"><span class="hs-identifier hs-type">tcSplitForAllTyVarBinder_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1391"></span><span id="tcSplitForAllTyVarBinder_maybe"><span class="annot"><span class="annottext">tcSplitForAllTyVarBinder_maybe :: Type -&gt; Maybe (ForAllTyBinder, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinder_maybe"><span class="hs-identifier hs-var hs-var">tcSplitForAllTyVarBinder_maybe</span></a></span></span><span> </span><span id="local-6989586621681683435"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683435"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683436"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683436"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683435"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (ForAllTyBinder, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinder_maybe"><span class="hs-identifier hs-var">tcSplitForAllTyVarBinder_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683436"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1392"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinder_maybe"><span class="hs-identifier hs-var">tcSplitForAllTyVarBinder_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621681683437"><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621681683437"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681683438"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683438"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ((ForAllTyBinder, Type) -&gt; Maybe (ForAllTyBinder, Type))
-&gt; (ForAllTyBinder, Type)
-&gt; Maybe (ForAllTyBinder, Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyBinder -&gt; Bool
forall vis. VarBndr TyVar vis -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVarBinder"><span class="hs-identifier hs-var">isTyVarBinder</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621681683437"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ForAllTyBinder, Type) -&gt; Maybe (ForAllTyBinder, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621681683437"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683438"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinder_maybe"><span class="hs-identifier hs-var">tcSplitForAllTyVarBinder_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ForAllTyBinder, Type)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1394"></span><span>
</span><span id="line-1395"></span><span class="hs-comment">-- | Like 'tcSplitPiTys', but splits off only named binders,</span><span>
</span><span id="line-1396"></span><span class="hs-comment">-- returning just the tyvars.</span><span>
</span><span id="line-1397"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVars"><span class="hs-identifier hs-type">tcSplitForAllTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1398"></span><span id="tcSplitForAllTyVars"><span class="annot"><span class="annottext">tcSplitForAllTyVars :: Type -&gt; ([TyVar], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVars"><span class="hs-identifier hs-var hs-var">tcSplitForAllTyVars</span></a></span></span><span> </span><span id="local-6989586621681683440"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683440"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1399"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ([TyVar], Type) -&gt; ([TyVar], Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVar -&gt; Bool) -&gt; [TyVar] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([TyVar], Type) -&gt; [TyVar]
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([TyVar], Type)
</span><a href="#local-6989586621681683441"><span class="hs-identifier hs-var">sty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TyVar], Type)
</span><a href="#local-6989586621681683441"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-1400"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681683441"><span class="annot"><span class="annottext">sty :: ([TyVar], Type)
</span><a href="#local-6989586621681683441"><span class="hs-identifier hs-var hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], Type)
</span><a href="GHC.Core.Type.html#splitForAllTyCoVars"><span class="hs-identifier hs-var">splitForAllTyCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683440"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1401"></span><span>
</span><span id="line-1402"></span><span class="hs-comment">-- | Like 'tcSplitForAllTyVars', but only splits 'ForAllTy's with 'Invisible'</span><span>
</span><span id="line-1403"></span><span class="hs-comment">-- type variable binders.</span><span>
</span><span id="line-1404"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTyVars"><span class="hs-identifier hs-type">tcSplitForAllInvisTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1405"></span><span id="tcSplitForAllInvisTyVars"><span class="annot"><span class="annottext">tcSplitForAllInvisTyVars :: Type -&gt; ([TyVar], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTyVars"><span class="hs-identifier hs-var hs-var">tcSplitForAllInvisTyVars</span></a></span></span><span> </span><span id="local-6989586621681683444"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683444"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ForAllTyFlag -&gt; Bool) -&gt; Type -&gt; ([TyVar], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitSomeForAllTyVars"><span class="hs-identifier hs-var">tcSplitSomeForAllTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleForAllTyFlag"><span class="hs-identifier hs-var">isInvisibleForAllTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683444"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1406"></span><span>
</span><span id="line-1407"></span><span class="hs-comment">-- | Like 'tcSplitForAllTyVars', but only splits a 'ForAllTy' if @argf_pred argf@</span><span>
</span><span id="line-1408"></span><span class="hs-comment">-- is 'True', where @argf@ is the visibility of the @ForAllTy@'s binder and</span><span>
</span><span id="line-1409"></span><span class="hs-comment">-- @argf_pred@ is a predicate over visibilities provided as an argument to this</span><span>
</span><span id="line-1410"></span><span class="hs-comment">-- function.</span><span>
</span><span id="line-1411"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitSomeForAllTyVars"><span class="hs-identifier hs-type">tcSplitSomeForAllTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyFlag"><span class="hs-identifier hs-type">ForAllTyFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1412"></span><span id="tcSplitSomeForAllTyVars"><span class="annot"><span class="annottext">tcSplitSomeForAllTyVars :: (ForAllTyFlag -&gt; Bool) -&gt; Type -&gt; ([TyVar], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitSomeForAllTyVars"><span class="hs-identifier hs-var hs-var">tcSplitSomeForAllTyVars</span></a></span></span><span> </span><span id="local-6989586621681683445"><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="#local-6989586621681683445"><span class="hs-identifier hs-var">argf_pred</span></a></span></span><span> </span><span id="local-6989586621681683446"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683446"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1413"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621681683447"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683446"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683446"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1415"></span><span>    </span><span id="local-6989586621681683447"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621681683447"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621681683449"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683449"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681683450"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621681683450"><span class="hs-identifier hs-var">argf</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681683451"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683451"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681683452"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683452"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>
</span><span id="line-1416"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag -&gt; Bool
</span><a href="#local-6989586621681683445"><span class="hs-identifier hs-var">argf_pred</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621681683450"><span class="hs-identifier hs-var">argf</span></a></span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621681683447"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683451"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683451"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683449"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">TyVar -&gt; [TyVar] -&gt; [TyVar]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683452"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1417"></span><span>    </span><span class="annot"><a href="#local-6989586621681683447"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621681683453"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683453"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span id="local-6989586621681683454"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683454"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681683455"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683455"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683456"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683456"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683454"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [TyVar] -&gt; ([TyVar], Type)
</span><a href="#local-6989586621681683447"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683453"><span class="hs-identifier hs-var">orig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683456"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683455"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1418"></span><span>    </span><span class="annot"><a href="#local-6989586621681683447"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621681683457"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683457"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                            </span><span id="local-6989586621681683458"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683458"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar]
forall a. [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#reverse/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683458"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683457"><span class="hs-identifier hs-var">orig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1419"></span><span>
</span><span id="line-1420"></span><span class="hs-comment">-- | Like 'tcSplitForAllTyVars', but only splits 'ForAllTy's with 'Required' type</span><span>
</span><span id="line-1421"></span><span class="hs-comment">-- variable binders. All split tyvars are annotated with '()'.</span><span>
</span><span id="line-1422"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllReqTVBinders"><span class="hs-identifier hs-type">tcSplitForAllReqTVBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcReqTVBinder"><span class="hs-identifier hs-type">TcReqTVBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1423"></span><span id="tcSplitForAllReqTVBinders"><span class="annot"><span class="annottext">tcSplitForAllReqTVBinders :: Type -&gt; ([TcReqTVBinder], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllReqTVBinders"><span class="hs-identifier hs-var hs-var">tcSplitForAllReqTVBinders</span></a></span></span><span> </span><span id="local-6989586621681683461"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683461"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ([TcReqTVBinder], Type) -&gt; ([TcReqTVBinder], Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TcReqTVBinder -&gt; Bool) -&gt; [TcReqTVBinder] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">TcReqTVBinder -&gt; Bool
forall vis. VarBndr TyVar vis -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVarBinder"><span class="hs-identifier hs-var">isTyVarBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([TcReqTVBinder], Type) -&gt; [TcReqTVBinder]
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([TcReqTVBinder], Type)
</span><a href="#local-6989586621681683462"><span class="hs-identifier hs-var">sty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TcReqTVBinder], Type)
</span><a href="#local-6989586621681683462"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-1424"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681683462"><span class="annot"><span class="annottext">sty :: ([TcReqTVBinder], Type)
</span><a href="#local-6989586621681683462"><span class="hs-identifier hs-var hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TcReqTVBinder], Type)
</span><a href="GHC.Core.Type.html#splitForAllReqTyBinders"><span class="hs-identifier hs-var">splitForAllReqTyBinders</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683461"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1425"></span><span>
</span><span id="line-1426"></span><span class="hs-comment">-- | Like 'tcSplitForAllTyVars', but only splits 'ForAllTy's with 'Invisible' type</span><span>
</span><span id="line-1427"></span><span class="hs-comment">-- variable binders. All split tyvars are annotated with their 'Specificity'.</span><span>
</span><span id="line-1428"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTVBinders"><span class="hs-identifier hs-type">tcSplitForAllInvisTVBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcInvisTVBinder"><span class="hs-identifier hs-type">TcInvisTVBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1429"></span><span id="tcSplitForAllInvisTVBinders"><span class="annot"><span class="annottext">tcSplitForAllInvisTVBinders :: Type -&gt; ([TcInvisTVBinder], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTVBinders"><span class="hs-identifier hs-var hs-var">tcSplitForAllInvisTVBinders</span></a></span></span><span> </span><span id="local-6989586621681683465"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683465"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ([TcInvisTVBinder], Type) -&gt; ([TcInvisTVBinder], Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TcInvisTVBinder -&gt; Bool) -&gt; [TcInvisTVBinder] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">(TyVar -&gt; Bool)
-&gt; (TcInvisTVBinder -&gt; TyVar) -&gt; TcInvisTVBinder -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TcInvisTVBinder -&gt; TyVar
forall tv argf. VarBndr tv argf -&gt; tv
</span><a href="GHC.Types.Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([TcInvisTVBinder], Type) -&gt; [TcInvisTVBinder]
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([TcInvisTVBinder], Type)
</span><a href="#local-6989586621681683466"><span class="hs-identifier hs-var">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TcInvisTVBinder], Type)
</span><a href="#local-6989586621681683466"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-1430"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681683466"><span class="annot"><span class="annottext">sty :: ([TcInvisTVBinder], Type)
</span><a href="#local-6989586621681683466"><span class="hs-identifier hs-var hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TcInvisTVBinder], Type)
</span><a href="GHC.Core.Type.html#splitForAllInvisTyBinders"><span class="hs-identifier hs-var">splitForAllInvisTyBinders</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683465"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1431"></span><span>
</span><span id="line-1432"></span><span class="annot"><span class="hs-comment">-- | Like 'tcSplitForAllTyVars', but splits off only named binders.</span></span><span>
</span><span id="line-1433"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinders"><span class="hs-identifier hs-type">tcSplitForAllTyVarBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1434"></span><span id="tcSplitForAllTyVarBinders"><span class="annot"><span class="annottext">tcSplitForAllTyVarBinders :: Type -&gt; ([ForAllTyBinder], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllTyVarBinders"><span class="hs-identifier hs-var hs-var">tcSplitForAllTyVarBinders</span></a></span></span><span> </span><span id="local-6989586621681683468"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683468"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ([ForAllTyBinder], Type) -&gt; ([ForAllTyBinder], Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ForAllTyBinder -&gt; Bool) -&gt; [ForAllTyBinder] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder -&gt; Bool
forall vis. VarBndr TyVar vis -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVarBinder"><span class="hs-identifier hs-var">isTyVarBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([ForAllTyBinder], Type) -&gt; [ForAllTyBinder]
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([ForAllTyBinder], Type)
</span><a href="#local-6989586621681683469"><span class="hs-identifier hs-var">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ForAllTyBinder], Type)
</span><a href="#local-6989586621681683469"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-1435"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681683469"><span class="annot"><span class="annottext">sty :: ([ForAllTyBinder], Type)
</span><a href="#local-6989586621681683469"><span class="hs-identifier hs-var hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([ForAllTyBinder], Type)
</span><a href="GHC.Core.Type.html#splitForAllForAllTyBinders"><span class="hs-identifier hs-var">splitForAllForAllTyBinders</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683468"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1436"></span><span>
</span><span id="line-1437"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPredFunTy_maybe"><span class="hs-identifier hs-type">tcSplitPredFunTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1438"></span><span class="hs-comment">-- Split off the first predicate argument from a type</span><span>
</span><span id="line-1439"></span><span id="tcSplitPredFunTy_maybe"><span class="annot"><span class="annottext">tcSplitPredFunTy_maybe :: Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPredFunTy_maybe"><span class="hs-identifier hs-var hs-var">tcSplitPredFunTy_maybe</span></a></span></span><span> </span><span id="local-6989586621681683471"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683471"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1440"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683472"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683472"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683471"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPredFunTy_maybe"><span class="hs-identifier hs-var">tcSplitPredFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683472"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1441"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPredFunTy_maybe"><span class="hs-identifier hs-var">tcSplitPredFunTy_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683473"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683473"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683475"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683475"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683477"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683477"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1442"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleFunArg"><span class="hs-identifier hs-var">isInvisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683473"><span class="hs-identifier hs-var">af</span></a></span><span>
</span><span id="line-1443"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; Maybe (Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683475"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683477"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1444"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPredFunTy_maybe"><span class="hs-identifier hs-var">tcSplitPredFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-1445"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Type, Type)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1446"></span><span>
</span><span id="line-1447"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitPhiTy"><span class="hs-identifier hs-type">tcSplitPhiTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1448"></span><span id="tcSplitPhiTy"><span class="annot"><span class="annottext">tcSplitPhiTy :: Type -&gt; ([Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPhiTy"><span class="hs-identifier hs-var hs-var">tcSplitPhiTy</span></a></span></span><span> </span><span id="local-6989586621681683479"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683479"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1449"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; ([Type], Type)
</span><a href="#local-6989586621681683480"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683479"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1450"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1451"></span><span>    </span><span id="local-6989586621681683480"><span class="annot"><span class="annottext">split :: Type -&gt; [Type] -&gt; ([Type], Type)
</span><a href="#local-6989586621681683480"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621681683481"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683481"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681683482"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683482"><span class="hs-identifier hs-var">ts</span></a></span></span><span>
</span><span id="line-1452"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPredFunTy_maybe"><span class="hs-identifier hs-var">tcSplitPredFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683481"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1453"></span><span>          </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683483"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683483"><span class="hs-identifier hs-var">pred</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683484"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683484"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; ([Type], Type)
</span><a href="#local-6989586621681683480"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683484"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683483"><span class="hs-identifier hs-var">pred</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683482"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1454"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Type, Type)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; [Type]
forall a. [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#reverse/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683482"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683481"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1455"></span><span>
</span><span id="line-1456"></span><span class="hs-comment">-- | Split a sigma type into its parts. This only splits /invisible/ type</span><span>
</span><span id="line-1457"></span><span class="hs-comment">-- variable binders, as these are the only forms of binder that the typechecker</span><span>
</span><span id="line-1458"></span><span class="hs-comment">-- will implicitly instantiate.</span><span>
</span><span id="line-1459"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitSigmaTy"><span class="hs-identifier hs-type">tcSplitSigmaTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1460"></span><span id="tcSplitSigmaTy"><span class="annot"><span class="annottext">tcSplitSigmaTy :: Type -&gt; ([TyVar], [Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitSigmaTy"><span class="hs-identifier hs-var hs-var">tcSplitSigmaTy</span></a></span></span><span> </span><span id="local-6989586621681683485"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683485"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTyVars"><span class="hs-identifier hs-var">tcSplitForAllInvisTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683485"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1461"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621681683486"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683486"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683487"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683487"><span class="hs-identifier hs-var">rho</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPhiTy"><span class="hs-identifier hs-var">tcSplitPhiTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683487"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1462"></span><span>                                        </span><span class="hs-special">(</span><span id="local-6989586621681683488"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683488"><span class="hs-identifier hs-var">theta</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683489"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683489"><span class="hs-identifier hs-var">tau</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683486"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683488"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683489"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1463"></span><span>
</span><span id="line-1464"></span><span class="hs-comment">-- | Split a sigma type into its parts, going underneath as many arrows</span><span>
</span><span id="line-1465"></span><span class="hs-comment">-- and foralls as possible. See Note [tcSplitNestedSigmaTys]</span><span>
</span><span id="line-1466"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitNestedSigmaTys"><span class="hs-identifier hs-type">tcSplitNestedSigmaTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- See Note [tcSplitNestedSigmaTys]</span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- NB: This is basically a pure version of deeplyInstantiate (from Unify) that</span><span>
</span><span id="line-1469"></span><span class="hs-comment">--     doesn't compute an HsWrapper.</span><span>
</span><span id="line-1470"></span><span id="tcSplitNestedSigmaTys"><span class="annot"><span class="annottext">tcSplitNestedSigmaTys :: Type -&gt; ([TyVar], [Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitNestedSigmaTys"><span class="hs-identifier hs-var hs-var">tcSplitNestedSigmaTys</span></a></span></span><span> </span><span id="local-6989586621681683490"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683490"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1471"></span><span>    </span><span class="hs-comment">-- If there's a forall, split it apart and try splitting the rho type</span><span>
</span><span id="line-1472"></span><span>    </span><span class="hs-comment">-- underneath it.</span><span>
</span><span id="line-1473"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683491"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681683491"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683492"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683492"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([Scaled Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-var">tcSplitFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683490"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1474"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683493"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683493"><span class="hs-identifier hs-var">tvs1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683494"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683494"><span class="hs-identifier hs-var">theta1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683495"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683495"><span class="hs-identifier hs-var">rho1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], [Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitSigmaTy"><span class="hs-identifier hs-var">tcSplitSigmaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683492"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-1475"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683493"><span class="hs-identifier hs-var">tvs1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683494"><span class="hs-identifier hs-var">theta1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1476"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683497"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683497"><span class="hs-identifier hs-var">tvs2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683498"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683498"><span class="hs-identifier hs-var">theta2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683499"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683499"><span class="hs-identifier hs-var">rho2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], [Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitNestedSigmaTys"><span class="hs-identifier hs-var">tcSplitNestedSigmaTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683495"><span class="hs-identifier hs-var">rho1</span></a></span><span>
</span><span id="line-1477"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683493"><span class="hs-identifier hs-var">tvs1</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar] -&gt; [TyVar]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683497"><span class="hs-identifier hs-var">tvs2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683494"><span class="hs-identifier hs-var">theta1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683498"><span class="hs-identifier hs-var">theta2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Type
(() :: Constraint) =&gt; [Scaled Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkScaledFunTys"><span class="hs-identifier hs-var">mkScaledFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681683491"><span class="hs-identifier hs-var">arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683499"><span class="hs-identifier hs-var">rho2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1478"></span><span>
</span><span id="line-1479"></span><span>    </span><span class="hs-comment">-- If there's no forall, we're done.</span><span>
</span><span id="line-1480"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683490"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1481"></span><span>
</span><span id="line-1482"></span><span class="hs-comment">{- Note [tcSplitNestedSigmaTys]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tcSplitNestedSigmaTys splits out all the /nested/ foralls and constraints,
including under function arrows.  E.g. given this type synonym:
  type Traversal s t a b = forall f. Applicative f =&gt; (a -&gt; f b) -&gt; s -&gt; f t

then
  tcSplitNestedSigmaTys (forall s t a b. C s t a b =&gt; Int -&gt; Traversal s t a b)

will return
  ( [s,t,a,b,f]
  , [C s t a b, Applicative f]
  , Int -&gt; (a -&gt; f b) -&gt; s -&gt; f t)@.

This function is used in these places:
* Improving error messages in GHC.Tc.Gen.Head.addFunResCtxt
* Validity checking for default methods: GHC.Tc.TyCl.checkValidClass
* A couple of calls in the GHCi debugger: GHC.Runtime.Heap.Inspect

In other words, just in validity checking and error messages; hence
no wrappers or evidence generation.

Notice that tcSplitNestedSigmaTys even looks under function arrows;
doing so is the Right Thing even with simple subsumption, not just
with deep subsumption.
-}</span><span>
</span><span id="line-1508"></span><span>
</span><span id="line-1509"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1510"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon"><span class="hs-identifier hs-type">tcTyConAppTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1511"></span><span id="tcTyConAppTyCon"><span class="annot"><span class="annottext">tcTyConAppTyCon :: Type -&gt; TyCon
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon"><span class="hs-identifier hs-var hs-var">tcTyConAppTyCon</span></a></span></span><span> </span><span id="local-6989586621681683500"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683500"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1512"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon_maybe"><span class="hs-identifier hs-var">tcTyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683500"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1513"></span><span>      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683501"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683501"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683501"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1514"></span><span>      </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TyCon
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcTyConAppTyCon&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprType"><span class="hs-identifier hs-var">pprType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683500"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1515"></span><span>
</span><span id="line-1516"></span><span class="annot"><span class="hs-comment">-- | Like 'tcRepSplitTyConApp_maybe', but only returns the 'TyCon'.</span></span><span>
</span><span id="line-1517"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon_maybe"><span class="hs-identifier hs-type">tcTyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1518"></span><span id="tcTyConAppTyCon_maybe"><span class="annot"><span class="annottext">tcTyConAppTyCon_maybe :: Type -&gt; Maybe TyCon
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon_maybe"><span class="hs-identifier hs-var hs-var">tcTyConAppTyCon_maybe</span></a></span></span><span> </span><span id="local-6989586621681683502"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683502"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683503"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683503"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683502"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon_maybe"><span class="hs-identifier hs-var">tcTyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683503"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1519"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon_maybe"><span class="hs-identifier hs-var">tcTyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681683504"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683504"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683504"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1520"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon_maybe"><span class="hs-identifier hs-var">tcTyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683505"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683505"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag -&gt; TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyFlagTyCon"><span class="hs-identifier hs-var">funTyFlagTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683505"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1521"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppTyCon_maybe"><span class="hs-identifier hs-var">tcTyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1522"></span><span>
</span><span id="line-1523"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConAppArgs"><span class="hs-identifier hs-type">tcTyConAppArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1524"></span><span id="tcTyConAppArgs"><span class="annot"><span class="annottext">tcTyConAppArgs :: Type -&gt; [Type]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConAppArgs"><span class="hs-identifier hs-var hs-var">tcTyConAppArgs</span></a></span></span><span> </span><span id="local-6989586621681683506"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683506"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683506"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1525"></span><span>                        </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683507"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683507"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683507"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1526"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; [Type]
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcTyConAppArgs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprType"><span class="hs-identifier hs-var">pprType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683506"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1527"></span><span>
</span><span id="line-1528"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1529"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-type">tcSplitFunTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1530"></span><span id="tcSplitFunTys"><span class="annot"><span class="annottext">tcSplitFunTys :: Type -&gt; ([Scaled Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-var hs-var">tcSplitFunTys</span></a></span></span><span> </span><span id="local-6989586621681683508"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683508"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Scaled Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-var">tcSplitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683508"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1531"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (Scaled Type, Type)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683508"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1532"></span><span>                        </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683509"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681683509"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683510"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683510"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681683509"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Scaled Type -&gt; [Scaled Type] -&gt; [Scaled Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681683511"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683512"><span class="hs-identifier hs-var">res'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1533"></span><span>                                       </span><span class="hs-keyword">where</span><span>
</span><span id="line-1534"></span><span>                                          </span><span class="hs-special">(</span><span id="local-6989586621681683511"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681683511"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683512"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683512"><span class="hs-identifier hs-var">res'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([Scaled Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-var">tcSplitFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683510"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1535"></span><span>
</span><span id="line-1536"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-type">tcSplitFunTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1537"></span><span class="hs-comment">-- Only splits function (-&gt;) and (-=&gt;), not (=&gt;) or (==&gt;)</span><span>
</span><span id="line-1538"></span><span id="tcSplitFunTy_maybe"><span class="annot"><span class="annottext">tcSplitFunTy_maybe :: Type -&gt; Maybe (Scaled Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-var hs-var">tcSplitFunTy_maybe</span></a></span></span><span> </span><span id="local-6989586621681683513"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683513"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1539"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683514"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683514"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683513"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Scaled Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-var">tcSplitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683514"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1540"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-var">tcSplitFunTy_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683515"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683515"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683517"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683517"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683518"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683518"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683519"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683519"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1541"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isVisibleFunArg"><span class="hs-identifier hs-var">isVisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683515"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scaled Type, Type) -&gt; Maybe (Scaled Type, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Scaled Type
forall a. Type -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683517"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683518"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683519"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1542"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-var">tcSplitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Scaled Type, Type)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1543"></span><span>        </span><span class="hs-comment">-- Note the isVisibleFunArg guard</span><span>
</span><span id="line-1544"></span><span>        </span><span class="hs-comment">-- Consider     (?x::Int) =&gt; Bool</span><span>
</span><span id="line-1545"></span><span>        </span><span class="hs-comment">-- We don't want to treat this as a function type!</span><span>
</span><span id="line-1546"></span><span>        </span><span class="hs-comment">-- A concrete example is test tc230:</span><span>
</span><span id="line-1547"></span><span>        </span><span class="hs-comment">--      f :: () -&gt; (?p :: ()) =&gt; () -&gt; ()</span><span>
</span><span id="line-1548"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1549"></span><span>        </span><span class="hs-comment">--      g = f () ()</span><span>
</span><span id="line-1550"></span><span>
</span><span id="line-1551"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTysN"><span class="hs-identifier hs-type">tcSplitFunTysN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span>                      </span><span class="hs-comment">-- n: Number of desired args</span><span>
</span><span id="line-1552"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span>
</span><span id="line-1553"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Either.html#Either/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span>               </span><span class="hs-comment">-- Number of missing arrows</span><span>
</span><span id="line-1554"></span><span>                        </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-comment">-- Arg types (always N types)</span><span>
</span><span id="line-1555"></span><span>                         </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- The rest of the type</span><span>
</span><span id="line-1556"></span><span class="hs-comment">-- ^ Split off exactly the specified number argument types</span><span>
</span><span id="line-1557"></span><span class="hs-comment">-- Returns</span><span>
</span><span id="line-1558"></span><span class="hs-comment">--  (Left m) if there are 'm' missing arrows in the type</span><span>
</span><span id="line-1559"></span><span class="hs-comment">--  (Right (tys,res)) if the type looks like t1 -&gt; ... -&gt; tn -&gt; res</span><span>
</span><span id="line-1560"></span><span id="tcSplitFunTysN"><span class="annot"><span class="annottext">tcSplitFunTysN :: Int -&gt; Type -&gt; Either Int ([Scaled Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTysN"><span class="hs-identifier hs-var hs-var">tcSplitFunTysN</span></a></span></span><span> </span><span id="local-6989586621681683523"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683523"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681683524"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683524"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1561"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683523"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1562"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Scaled Type], Type) -&gt; Either Int ([Scaled Type], Type)
forall a b. b -&gt; Either a b
</span><a href="../../base-4.18.3.0/src/Data.Either.html#Right/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683524"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1563"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683525"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681683525"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683526"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683526"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Scaled Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-var">tcSplitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683524"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1564"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Either Int ([Scaled Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTysN"><span class="hs-identifier hs-var">tcSplitFunTysN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683523"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683526"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1565"></span><span>     </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Either.html#Left/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621681683527"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683527"><span class="hs-identifier hs-var">m</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Either Int ([Scaled Type], Type)
forall a b. a -&gt; Either a b
</span><a href="../../base-4.18.3.0/src/Data.Either.html#Left/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683527"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1566"></span><span>     </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Either.html#Right/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683528"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681683528"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683529"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683529"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Scaled Type], Type) -&gt; Either Int ([Scaled Type], Type)
forall a b. b -&gt; Either a b
</span><a href="../../base-4.18.3.0/src/Data.Either.html#Right/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681683525"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Scaled Type -&gt; [Scaled Type] -&gt; [Scaled Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681683528"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683529"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1567"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1568"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Either Int ([Scaled Type], Type)
forall a b. a -&gt; Either a b
</span><a href="../../base-4.18.3.0/src/Data.Either.html#Left/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683523"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1569"></span><span>
</span><span id="line-1570"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy"><span class="hs-identifier hs-type">tcSplitFunTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1571"></span><span id="tcSplitFunTy"><span class="annot"><span class="annottext">tcSplitFunTy :: Type -&gt; (Scaled Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy"><span class="hs-identifier hs-var hs-var">tcSplitFunTy</span></a></span></span><span>  </span><span id="local-6989586621681683531"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683531"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (Scaled Type, Type) -&gt; (Scaled Type, Type)
forall a. HasCallStack =&gt; String -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcSplitFunTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Maybe (Scaled Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-var">tcSplitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683531"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1572"></span><span>
</span><span id="line-1573"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcFunArgTy"><span class="hs-identifier hs-type">tcFunArgTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1574"></span><span id="tcFunArgTy"><span class="annot"><span class="annottext">tcFunArgTy :: Type -&gt; Scaled Type
</span><a href="GHC.Tc.Utils.TcType.html#tcFunArgTy"><span class="hs-identifier hs-var hs-var">tcFunArgTy</span></a></span></span><span> </span><span id="local-6989586621681683533"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683533"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scaled Type, Type) -&gt; Scaled Type
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; (Scaled Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy"><span class="hs-identifier hs-var">tcSplitFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683533"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1575"></span><span>
</span><span id="line-1576"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcFunResultTy"><span class="hs-identifier hs-type">tcFunResultTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1577"></span><span id="tcFunResultTy"><span class="annot"><span class="annottext">tcFunResultTy :: Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#tcFunResultTy"><span class="hs-identifier hs-var hs-var">tcFunResultTy</span></a></span></span><span> </span><span id="local-6989586621681683534"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683534"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scaled Type, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#snd/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; (Scaled Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy"><span class="hs-identifier hs-var">tcSplitFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683534"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1578"></span><span>
</span><span id="line-1579"></span><span class="annot"><span class="hs-comment">-- | Strips off n *visible* arguments and returns the resulting type</span></span><span>
</span><span id="line-1580"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcFunResultTyN"><span class="hs-identifier hs-type">tcFunResultTyN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1581"></span><span id="tcFunResultTyN"><span class="annot"><span class="annottext">tcFunResultTyN :: (() :: Constraint) =&gt; Int -&gt; Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#tcFunResultTyN"><span class="hs-identifier hs-var hs-var">tcFunResultTyN</span></a></span></span><span> </span><span id="local-6989586621681683542"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683542"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681683543"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683543"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1582"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Data.Either.html#Right/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Scaled Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683544"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683544"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Either Int ([Scaled Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTysN"><span class="hs-identifier hs-var">tcSplitFunTysN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683542"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683543"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1583"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683544"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-1584"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1585"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Type
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcFunResultTyN&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683542"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683543"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1586"></span><span>
</span><span id="line-1587"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1588"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-type">tcSplitAppTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1589"></span><span id="tcSplitAppTy_maybe"><span class="annot"><span class="annottext">tcSplitAppTy_maybe :: Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var hs-var">tcSplitAppTy_maybe</span></a></span></span><span> </span><span id="local-6989586621681683545"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683545"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683546"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683546"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683545"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683546"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1590"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span id="local-6989586621681683547"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683547"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Core.Type.html#tcSplitAppTyNoView_maybe"><span class="hs-identifier hs-var">tcSplitAppTyNoView_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683547"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1591"></span><span>
</span><span id="line-1592"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy"><span class="hs-identifier hs-type">tcSplitAppTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1593"></span><span id="tcSplitAppTy"><span class="annot"><span class="annottext">tcSplitAppTy :: Type -&gt; (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy"><span class="hs-identifier hs-var hs-var">tcSplitAppTy</span></a></span></span><span> </span><span id="local-6989586621681683548"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683548"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683548"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1594"></span><span>                    </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683549"><span class="annot"><span class="annottext">(Type, Type)
</span><a href="#local-6989586621681683549"><span class="hs-identifier hs-var">stuff</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Type, Type)
</span><a href="#local-6989586621681683549"><span class="hs-identifier hs-var">stuff</span></a></span><span>
</span><span id="line-1595"></span><span>                    </span><span class="annot"><span class="annottext">Maybe (Type, Type)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (Type, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcSplitAppTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprType"><span class="hs-identifier hs-var">pprType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683548"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1596"></span><span>
</span><span id="line-1597"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTys"><span class="hs-identifier hs-type">tcSplitAppTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1598"></span><span id="tcSplitAppTys"><span class="annot"><span class="annottext">tcSplitAppTys :: Type -&gt; (Type, [Type])
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTys"><span class="hs-identifier hs-var hs-var">tcSplitAppTys</span></a></span></span><span> </span><span id="local-6989586621681683550"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683550"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1599"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621681683551"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683550"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1600"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1601"></span><span>    </span><span id="local-6989586621681683551"><span class="annot"><span class="annottext">go :: Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621681683551"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681683552"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683552"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681683553"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683553"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683552"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1602"></span><span>                   </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683554"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683554"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683555"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683555"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621681683551"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683554"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683555"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683553"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1603"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (Type, Type)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683552"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683553"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1604"></span><span>
</span><span id="line-1605"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1606"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier hs-type">tcIsTyVarTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1607"></span><span id="tcIsTyVarTy"><span class="annot"><span class="annottext">tcIsTyVarTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier hs-var hs-var">tcIsTyVarTy</span></a></span></span><span> </span><span id="local-6989586621681683556"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683556"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683557"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683557"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683556"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier hs-var">tcIsTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683557"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1608"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier hs-var">tcIsTyVarTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621681683558"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683558"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier hs-var">tcIsTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683558"><span class="hs-identifier hs-var">ty</span></a></span><span>  </span><span class="hs-comment">-- look through casts, as</span><span>
</span><span id="line-1609"></span><span>                                            </span><span class="hs-comment">-- this is only used for</span><span>
</span><span id="line-1610"></span><span>                                            </span><span class="hs-comment">-- e.g., FlexibleContexts</span><span>
</span><span id="line-1611"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier hs-var">tcIsTyVarTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1612"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier hs-var">tcIsTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1613"></span><span>
</span><span id="line-1614"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-1615"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitQuantPredTy"><span class="hs-identifier hs-type">tcSplitQuantPredTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1616"></span><span class="hs-comment">-- Split up the type of a quantified predicate</span><span>
</span><span id="line-1617"></span><span class="hs-comment">--    forall tys, theta =&gt; head</span><span>
</span><span id="line-1618"></span><span class="hs-comment">-- NB splitFunTys, not tcSplitFunTys;</span><span>
</span><span id="line-1619"></span><span class="hs-comment">-- the latter specifically stops at PredTy arguments,</span><span>
</span><span id="line-1620"></span><span class="hs-comment">-- and we don't want to do that here</span><span>
</span><span id="line-1621"></span><span id="tcSplitQuantPredTy"><span class="annot"><span class="annottext">tcSplitQuantPredTy :: Type -&gt; ([TyVar], [Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitQuantPredTy"><span class="hs-identifier hs-var hs-var">tcSplitQuantPredTy</span></a></span></span><span> </span><span id="local-6989586621681683559"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683559"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1622"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTyVars"><span class="hs-identifier hs-var">tcSplitForAllInvisTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683559"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683560"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683560"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683561"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683561"><span class="hs-identifier hs-var">rho</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1623"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([Scaled Type], Type)
</span><a href="GHC.Core.Type.html#splitFunTys"><span class="hs-identifier hs-var">splitFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683561"><span class="hs-identifier hs-var">rho</span></a></span><span>             </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683563"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681683563"><span class="hs-identifier hs-var">theta</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683564"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683564"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1624"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683560"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Scaled Type -&gt; Type) -&gt; [Scaled Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; Type
forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681683563"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683564"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-1625"></span><span>
</span><span id="line-1626"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitDFunTy"><span class="hs-identifier hs-type">tcSplitDFunTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1627"></span><span class="hs-comment">-- Split the type of a dictionary function</span><span>
</span><span id="line-1628"></span><span id="tcSplitDFunTy"><span class="annot"><span class="annottext">tcSplitDFunTy :: Type -&gt; ([TyVar], [Type], Class, [Type])
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitDFunTy"><span class="hs-identifier hs-var hs-var">tcSplitDFunTy</span></a></span></span><span> </span><span id="local-6989586621681683566"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683566"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1629"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], [Type], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitQuantPredTy"><span class="hs-identifier hs-var">tcSplitQuantPredTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683566"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683567"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683567"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683568"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683568"><span class="hs-identifier hs-var">theta</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683569"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683569"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1630"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Class, [Type])
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitDFunHead"><span class="hs-identifier hs-var">tcSplitDFunHead</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683569"><span class="hs-identifier hs-var">head</span></a></span><span>  </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683570"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683570"><span class="hs-identifier hs-var">clas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683571"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683571"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1631"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683567"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683568"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683570"><span class="hs-identifier hs-var">clas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683571"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-1632"></span><span>
</span><span id="line-1633"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitDFunHead"><span class="hs-identifier hs-type">tcSplitDFunHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1634"></span><span id="tcSplitDFunHead"><span class="annot"><span class="annottext">tcSplitDFunHead :: Type -&gt; (Class, [Type])
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitDFunHead"><span class="hs-identifier hs-var hs-var">tcSplitDFunHead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; (Class, [Type])
Type -&gt; (Class, [Type])
</span><a href="GHC.Core.Predicate.html#getClassPredTys"><span class="hs-identifier hs-var">getClassPredTys</span></a></span><span>
</span><span id="line-1635"></span><span>
</span><span id="line-1636"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitMethodTy"><span class="hs-identifier hs-type">tcSplitMethodTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1637"></span><span class="hs-comment">-- A class method (selector) always has a type like</span><span>
</span><span id="line-1638"></span><span class="hs-comment">--   forall as. C as =&gt; blah</span><span>
</span><span id="line-1639"></span><span class="hs-comment">-- So if the class looks like</span><span>
</span><span id="line-1640"></span><span class="hs-comment">--   class C a where</span><span>
</span><span id="line-1641"></span><span class="hs-comment">--     op :: forall b. (Eq a, Ix b) =&gt; a -&gt; b</span><span>
</span><span id="line-1642"></span><span class="hs-comment">-- the class method type looks like</span><span>
</span><span id="line-1643"></span><span class="hs-comment">--  op :: forall a. C a =&gt; forall b. (Eq a, Ix b) =&gt; a -&gt; b</span><span>
</span><span id="line-1644"></span><span class="hs-comment">--</span><span>
</span><span id="line-1645"></span><span class="hs-comment">-- tcSplitMethodTy just peels off the outer forall and</span><span>
</span><span id="line-1646"></span><span class="hs-comment">-- that first predicate</span><span>
</span><span id="line-1647"></span><span id="tcSplitMethodTy"><span class="annot"><span class="annottext">tcSplitMethodTy :: Type -&gt; ([TyVar], Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitMethodTy"><span class="hs-identifier hs-var hs-var">tcSplitMethodTy</span></a></span></span><span> </span><span id="local-6989586621681683573"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683573"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1648"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683574"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683574"><span class="hs-identifier hs-var">sel_tyvars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683575"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683575"><span class="hs-identifier hs-var">sel_rho</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([TyVar], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitForAllInvisTyVars"><span class="hs-identifier hs-var">tcSplitForAllInvisTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683573"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1649"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683576"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683576"><span class="hs-identifier hs-var">first_pred</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683577"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683577"><span class="hs-identifier hs-var">local_meth_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPredFunTy_maybe"><span class="hs-identifier hs-var">tcSplitPredFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683575"><span class="hs-identifier hs-var">sel_rho</span></a></span><span>
</span><span id="line-1650"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683574"><span class="hs-identifier hs-var">sel_tyvars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683576"><span class="hs-identifier hs-var">first_pred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683577"><span class="hs-identifier hs-var">local_meth_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1651"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1652"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; ([TyVar], Type, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcSplitMethodTy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683573"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1653"></span><span>
</span><span id="line-1654"></span><span>
</span><span id="line-1655"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                       Predicate types
*                                                                      *
************************************************************************

Deconstructors and tests on predicate types

Note [Kind polymorphic type classes]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    class C f where...   -- C :: forall k. k -&gt; Constraint
    g :: forall (f::*). C f =&gt; f -&gt; f

Here the (C f) in the signature is really (C * f), and we
don't want to complain that the * isn't a type variable!
-}</span></span><span>
</span><span id="line-1671"></span><span>
</span><span id="line-1672"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyVarClassPred"><span class="hs-identifier hs-type">isTyVarClassPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1673"></span><span id="isTyVarClassPred"><span class="annot"><span class="annottext">isTyVarClassPred :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTyVarClassPred"><span class="hs-identifier hs-var hs-var">isTyVarClassPred</span></a></span></span><span> </span><span id="local-6989586621681683578"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683578"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Class, [Type])
</span><a href="GHC.Core.Predicate.html#getClassPredTys_maybe"><span class="hs-identifier hs-var">getClassPredTys_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683578"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1674"></span><span>    </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683580"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683580"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683580"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1675"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Class, [Type])
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1676"></span><span>
</span><span id="line-1677"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-1678"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#checkValidClsArgs"><span class="hs-identifier hs-type">checkValidClsArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1679"></span><span class="hs-comment">-- If the Bool is True (flexible contexts), return True (i.e. ok)</span><span>
</span><span id="line-1680"></span><span class="hs-comment">-- Otherwise, check that the type (not kind) args are all headed by a tyvar</span><span>
</span><span id="line-1681"></span><span class="hs-comment">--   E.g. (Eq a) accepted, (Eq (f a)) accepted, but (Eq Int) rejected</span><span>
</span><span id="line-1682"></span><span class="hs-comment">-- This function is here in GHC.Tc.Utils.TcType, rather than in GHC.Tc.Validity,</span><span>
</span><span id="line-1683"></span><span class="hs-comment">-- because it is called from GHC.Tc.Solver, which itself is imported by GHC.Tc.Validity</span><span>
</span><span id="line-1684"></span><span id="checkValidClsArgs"><span class="annot"><span class="annottext">checkValidClsArgs :: Bool -&gt; Class -&gt; [Type] -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#checkValidClsArgs"><span class="hs-identifier hs-var hs-var">checkValidClsArgs</span></a></span></span><span> </span><span id="local-6989586621681683582"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683582"><span class="hs-identifier hs-var">flexible_contexts</span></a></span></span><span> </span><span id="local-6989586621681683583"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683583"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621681683584"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683584"><span class="hs-identifier hs-var">kts</span></a></span></span><span>
</span><span id="line-1685"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683582"><span class="hs-identifier hs-var">flexible_contexts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1686"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#hasTyVarHead"><span class="hs-identifier hs-var">hasTyVarHead</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683585"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1687"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1688"></span><span>    </span><span id="local-6989586621681683585"><span class="annot"><span class="annottext">tys :: [Type]
</span><a href="#local-6989586621681683585"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; TyCon
</span><a href="GHC.Core.Class.html#classTyCon"><span class="hs-identifier hs-var">classTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683583"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683584"><span class="hs-identifier hs-var">kts</span></a></span><span>
</span><span id="line-1689"></span><span>
</span><span id="line-1690"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#hasTyVarHead"><span class="hs-identifier hs-type">hasTyVarHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1691"></span><span class="hs-comment">-- Returns true of (a t1 .. tn), where 'a' is a type variable</span><span>
</span><span id="line-1692"></span><span id="hasTyVarHead"><span class="annot"><span class="annottext">hasTyVarHead :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#hasTyVarHead"><span class="hs-identifier hs-var hs-var">hasTyVarHead</span></a></span></span><span> </span><span id="local-6989586621681683588"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683588"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                 </span><span class="hs-comment">-- Haskell 98 allows predicates of form</span><span>
</span><span id="line-1693"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#tcIsTyVarTy"><span class="hs-identifier hs-var">tcIsTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683588"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>       </span><span class="hs-comment">--      C (a ty1 .. tyn)</span><span>
</span><span id="line-1694"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                   </span><span class="hs-comment">-- where a is a type variable</span><span>
</span><span id="line-1695"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683588"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1696"></span><span>       </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683589"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683589"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#hasTyVarHead"><span class="hs-identifier hs-var">hasTyVarHead</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683589"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1697"></span><span>       </span><span class="annot"><span class="annottext">Maybe (Type, Type)
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1698"></span><span>
</span><span id="line-1699"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#evVarPred"><span class="hs-identifier hs-type">evVarPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span>
</span><span id="line-1700"></span><span id="evVarPred"><span class="annot"><span class="annottext">evVarPred :: TyVar -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#evVarPred"><span class="hs-identifier hs-var hs-var">evVarPred</span></a></span></span><span> </span><span id="local-6989586621681683591"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683591"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683591"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-1701"></span><span>  </span><span class="hs-comment">-- Historical note: I used to have an ASSERT here,</span><span>
</span><span id="line-1702"></span><span>  </span><span class="hs-comment">-- checking (isEvVarType (varType var)).  But with something like</span><span>
</span><span id="line-1703"></span><span>  </span><span class="hs-comment">--   f :: c =&gt; _ -&gt; _</span><span>
</span><span id="line-1704"></span><span>  </span><span class="hs-comment">-- we end up with (c :: kappa), and (kappa ~ Constraint).  Until</span><span>
</span><span id="line-1705"></span><span>  </span><span class="hs-comment">-- we solve and zonk (which there is no particular reason to do for</span><span>
</span><span id="line-1706"></span><span>  </span><span class="hs-comment">-- partial signatures, (isEvVarType kappa) will return False. But</span><span>
</span><span id="line-1707"></span><span>  </span><span class="hs-comment">-- nothing is wrong.  So I just removed the ASSERT.</span><span>
</span><span id="line-1708"></span><span>
</span><span id="line-1709"></span><span class="hs-comment">---------------------------</span><span>
</span><span id="line-1710"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#boxEqPred"><span class="hs-identifier hs-type">boxEqPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1711"></span><span class="hs-comment">-- Given (t1 ~# t2) or (t1 ~R# t2) return the boxed version</span><span>
</span><span id="line-1712"></span><span class="hs-comment">--       (t1 ~ t2)  or (t1 `Coercible` t2)</span><span>
</span><span id="line-1713"></span><span id="boxEqPred"><span class="annot"><span class="annottext">boxEqPred :: EqRel -&gt; Type -&gt; Type -&gt; Maybe (Class, [Type])
</span><a href="GHC.Tc.Utils.TcType.html#boxEqPred"><span class="hs-identifier hs-var hs-var">boxEqPred</span></a></span></span><span> </span><span id="local-6989586621681683593"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683593"><span class="hs-identifier hs-var">eq_rel</span></a></span></span><span> </span><span id="local-6989586621681683594"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683594"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621681683595"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683595"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-1714"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683593"><span class="hs-identifier hs-var">eq_rel</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1715"></span><span>      </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683596"><span class="hs-identifier hs-var">homo_kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Class, [Type]) -&gt; Maybe (Class, [Type])
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class
</span><a href="GHC.Builtin.Types.html#eqClass"><span class="hs-identifier hs-var">eqClass</span></a></span><span class="hs-special">,</span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683597"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683594"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683595"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1716"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Class, [Type]) -&gt; Maybe (Class, [Type])
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class
</span><a href="GHC.Builtin.Types.html#heqClass"><span class="hs-identifier hs-var">heqClass</span></a></span><span class="hs-special">,</span><span>       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683597"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683598"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683594"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683595"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1717"></span><span>      </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681683596"><span class="hs-identifier hs-var">homo_kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Class, [Type]) -&gt; Maybe (Class, [Type])
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class
</span><a href="GHC.Builtin.Types.html#coercibleClass"><span class="hs-identifier hs-var">coercibleClass</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683597"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683594"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683595"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1718"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Class, [Type])
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-comment">-- Sigh: we do not have heterogeneous Coercible</span><span>
</span><span id="line-1719"></span><span>                                    </span><span class="hs-comment">--       so we can't abstract over it</span><span>
</span><span id="line-1720"></span><span>                                    </span><span class="hs-comment">-- Nothing fundamental: we could add it</span><span>
</span><span id="line-1721"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1722"></span><span>   </span><span id="local-6989586621681683597"><span class="annot"><span class="annottext">k1 :: Type
</span><a href="#local-6989586621681683597"><span class="hs-identifier hs-var hs-var">k1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683594"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1723"></span><span>   </span><span id="local-6989586621681683598"><span class="annot"><span class="annottext">k2 :: Type
</span><a href="#local-6989586621681683598"><span class="hs-identifier hs-var hs-var">k2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Type
Type -&gt; Type
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683595"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1724"></span><span>   </span><span id="local-6989586621681683596"><span class="annot"><span class="annottext">homo_kind :: Bool
</span><a href="#local-6989586621681683596"><span class="hs-identifier hs-var hs-var">homo_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683597"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#tcEqType"><span class="hs-operator hs-var">`tcEqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683598"><span class="hs-identifier hs-var">k2</span></a></span><span>
</span><span id="line-1725"></span><span>
</span><span id="line-1726"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pickCapturedPreds"><span class="hs-identifier hs-type">pickCapturedPreds</span></a></span><span>
</span><span id="line-1727"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a></span><span>           </span><span class="hs-comment">-- Quantifying over these</span><span>
</span><span id="line-1728"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcThetaType"><span class="hs-identifier hs-type">TcThetaType</span></a></span><span>        </span><span class="hs-comment">-- Proposed constraints to quantify</span><span>
</span><span id="line-1729"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcThetaType"><span class="hs-identifier hs-type">TcThetaType</span></a></span><span>        </span><span class="hs-comment">-- A subset that we can actually quantify</span><span>
</span><span id="line-1730"></span><span class="hs-comment">-- A simpler version of pickQuantifiablePreds, used to winnow down</span><span>
</span><span id="line-1731"></span><span class="hs-comment">-- the inferred constraints of a group of bindings, into those for</span><span>
</span><span id="line-1732"></span><span class="hs-comment">-- one particular identifier</span><span>
</span><span id="line-1733"></span><span id="pickCapturedPreds"><span class="annot"><span class="annottext">pickCapturedPreds :: VarSet -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Tc.Utils.TcType.html#pickCapturedPreds"><span class="hs-identifier hs-var hs-var">pickCapturedPreds</span></a></span></span><span> </span><span id="local-6989586621681683600"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683600"><span class="hs-identifier hs-var">qtvs</span></a></span></span><span> </span><span id="local-6989586621681683601"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683601"><span class="hs-identifier hs-var">theta</span></a></span></span><span>
</span><span id="line-1734"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; [Type]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621681683602"><span class="hs-identifier hs-var">captured</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683601"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-1735"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1736"></span><span>    </span><span id="local-6989586621681683602"><span class="annot"><span class="annottext">captured :: Type -&gt; Bool
</span><a href="#local-6989586621681683602"><span class="hs-identifier hs-var hs-var">captured</span></a></span></span><span> </span><span id="local-6989586621681683603"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683603"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Predicate.html#isIPLikePred"><span class="hs-identifier hs-var">isIPLikePred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683603"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683603"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#intersectsVarSet"><span class="hs-operator hs-var">`intersectsVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683600"><span class="hs-identifier hs-var">qtvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1737"></span><span>
</span><span id="line-1738"></span><span>
</span><span id="line-1739"></span><span class="hs-comment">-- Superclasses</span><span>
</span><span id="line-1740"></span><span>
</span><span id="line-1741"></span><span class="hs-keyword">type</span><span> </span><span id="PredWithSCs"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PredWithSCs"><span class="hs-identifier hs-var">PredWithSCs</span></a></span></span><span> </span><span id="local-6989586621681683605"><span class="annot"><a href="#local-6989586621681683605"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681683605"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1742"></span><span>
</span><span id="line-1743"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#mkMinimalBySCs"><span class="hs-identifier hs-type">mkMinimalBySCs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681682444"><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1744"></span><span class="hs-comment">-- Remove predicates that</span><span>
</span><span id="line-1745"></span><span class="hs-comment">--</span><span>
</span><span id="line-1746"></span><span class="hs-comment">--   - are the same as another predicate</span><span>
</span><span id="line-1747"></span><span class="hs-comment">--</span><span>
</span><span id="line-1748"></span><span class="hs-comment">--   - can be deduced from another by superclasses,</span><span>
</span><span id="line-1749"></span><span class="hs-comment">--</span><span>
</span><span id="line-1750"></span><span class="hs-comment">--   - are a reflexive equality (e.g  * ~ *)</span><span>
</span><span id="line-1751"></span><span class="hs-comment">--     (see Note [Remove redundant provided dicts] in GHC.Tc.TyCl.PatSyn)</span><span>
</span><span id="line-1752"></span><span class="hs-comment">--</span><span>
</span><span id="line-1753"></span><span class="hs-comment">-- The result is a subset of the input.</span><span>
</span><span id="line-1754"></span><span class="hs-comment">-- The 'a' is just paired up with the PredType;</span><span>
</span><span id="line-1755"></span><span class="hs-comment">--   typically it might be a dictionary Id</span><span>
</span><span id="line-1756"></span><span id="mkMinimalBySCs"><span class="annot"><span class="annottext">mkMinimalBySCs :: forall a. (a -&gt; Type) -&gt; [a] -&gt; [a]
</span><a href="GHC.Tc.Utils.TcType.html#mkMinimalBySCs"><span class="hs-identifier hs-var hs-var">mkMinimalBySCs</span></a></span></span><span> </span><span id="local-6989586621681683609"><span class="annot"><span class="annottext">a -&gt; Type
</span><a href="#local-6989586621681683609"><span class="hs-identifier hs-var">get_pred</span></a></span></span><span> </span><span id="local-6989586621681683610"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681683610"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a] -&gt; [PredWithSCs a] -&gt; [a]
</span><a href="#local-6989586621681683611"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683612"><span class="hs-identifier hs-var">preds_with_scs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1757"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1758"></span><span>   </span><span class="annot"><a href="#local-6989586621681683612"><span class="hs-identifier hs-type">preds_with_scs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PredWithSCs"><span class="hs-identifier hs-type">PredWithSCs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1759"></span><span>   </span><span id="local-6989586621681683612"><span class="annot"><span class="annottext">preds_with_scs :: [PredWithSCs a]
</span><a href="#local-6989586621681683612"><span class="hs-identifier hs-var hs-var">preds_with_scs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683613"><span class="hs-identifier hs-var">pred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type]
</span><a href="#local-6989586621681683614"><span class="hs-identifier hs-var">implicants</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683613"><span class="hs-identifier hs-var">pred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683615"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1760"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681683615"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683615"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681683610"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1761"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681683613"><span class="annot"><span class="annottext">pred :: Type
</span><a href="#local-6989586621681683613"><span class="hs-identifier hs-var hs-var">pred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Type
</span><a href="#local-6989586621681683609"><span class="hs-identifier hs-var">get_pred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1762"></span><span>
</span><span id="line-1763"></span><span>   </span><span class="annot"><a href="#local-6989586621681683611"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PredWithSCs"><span class="hs-identifier hs-type">PredWithSCs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Work list</span><span>
</span><span id="line-1764"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PredWithSCs"><span class="hs-identifier hs-type">PredWithSCs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Accumulating result</span><span>
</span><span id="line-1765"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1766"></span><span>   </span><span id="local-6989586621681683611"><span class="annot"><span class="annottext">go :: [PredWithSCs a] -&gt; [PredWithSCs a] -&gt; [a]
</span><a href="#local-6989586621681683611"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681683616"><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683616"><span class="hs-identifier hs-var">min_preds</span></a></span></span><span>
</span><span id="line-1767"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#reverse/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PredWithSCs a -&gt; a) -&gt; [PredWithSCs a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PredWithSCs a -&gt; a
forall a b c. (a, b, c) -&gt; c
</span><a href="GHC.Utils.Misc.html#thdOf3"><span class="hs-identifier hs-var">thdOf3</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683616"><span class="hs-identifier hs-var">min_preds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1768"></span><span>       </span><span class="hs-comment">-- The 'reverse' isn't strictly necessary, but it</span><span>
</span><span id="line-1769"></span><span>       </span><span class="hs-comment">-- means that the results are returned in the same</span><span>
</span><span id="line-1770"></span><span>       </span><span class="hs-comment">-- order as the input, which is generally saner</span><span>
</span><span id="line-1771"></span><span>   </span><span class="annot"><a href="#local-6989586621681683611"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683618"><span class="annot"><span class="annottext">work_item :: PredWithSCs a
</span><a href="#local-6989586621681683618"><span class="hs-identifier hs-var">work_item</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621681683619"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683619"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681683620"><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683620"><span class="hs-identifier hs-var">work_list</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681683621"><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683621"><span class="hs-identifier hs-var">min_preds</span></a></span></span><span>
</span><span id="line-1772"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683623"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683623"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681683624"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683624"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pred
</span><a href="GHC.Core.Predicate.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683619"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1773"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683623"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#tcEqType"><span class="hs-operator hs-var">`tcEqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683624"><span class="hs-identifier hs-var">t2</span></a></span><span>   </span><span class="hs-comment">-- See GHC.Tc.TyCl.PatSyn</span><span>
</span><span id="line-1774"></span><span>                          </span><span class="hs-comment">-- Note [Remove redundant provided dicts]</span><span>
</span><span id="line-1775"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a] -&gt; [PredWithSCs a] -&gt; [a]
</span><a href="#local-6989586621681683611"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683620"><span class="hs-identifier hs-var">work_list</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683621"><span class="hs-identifier hs-var">min_preds</span></a></span><span>
</span><span id="line-1776"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683619"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [PredWithSCs a] -&gt; Bool
</span><a href="#local-6989586621681683626"><span class="hs-operator hs-var">`in_cloud`</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683620"><span class="hs-identifier hs-var">work_list</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683619"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [PredWithSCs a] -&gt; Bool
</span><a href="#local-6989586621681683626"><span class="hs-operator hs-var">`in_cloud`</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683621"><span class="hs-identifier hs-var">min_preds</span></a></span><span>
</span><span id="line-1777"></span><span>       </span><span class="hs-comment">-- Why look at work-list too?  Suppose work_item is Eq a,</span><span>
</span><span id="line-1778"></span><span>       </span><span class="hs-comment">-- and work-list contains Ord a</span><span>
</span><span id="line-1779"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a] -&gt; [PredWithSCs a] -&gt; [a]
</span><a href="#local-6989586621681683611"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683620"><span class="hs-identifier hs-var">work_list</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683621"><span class="hs-identifier hs-var">min_preds</span></a></span><span>
</span><span id="line-1780"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1781"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a] -&gt; [PredWithSCs a] -&gt; [a]
</span><a href="#local-6989586621681683611"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683620"><span class="hs-identifier hs-var">work_list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PredWithSCs a
</span><a href="#local-6989586621681683618"><span class="hs-identifier hs-var">work_item</span></a></span><span> </span><span class="annot"><span class="annottext">PredWithSCs a -&gt; [PredWithSCs a] -&gt; [PredWithSCs a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683621"><span class="hs-identifier hs-var">min_preds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1782"></span><span>
</span><span id="line-1783"></span><span>   </span><span class="annot"><a href="#local-6989586621681683626"><span class="hs-identifier hs-type">in_cloud</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PredWithSCs"><span class="hs-identifier hs-type">PredWithSCs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681682444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1784"></span><span>   </span><span id="local-6989586621681683626"><span class="annot"><span class="annottext">in_cloud :: Type -&gt; [PredWithSCs a] -&gt; Bool
</span><a href="#local-6989586621681683626"><span class="hs-identifier hs-var hs-var">in_cloud</span></a></span></span><span> </span><span id="local-6989586621681683627"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683627"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681683628"><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683628"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#or/Data.Foldable.html#or"><span class="hs-identifier hs-var">or</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683627"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#tcEqType"><span class="hs-operator hs-var">`tcEqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683630"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683631"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683631"><span class="hs-identifier hs-var">scs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PredWithSCs a]
</span><a href="#local-6989586621681683628"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683630"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683630"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683631"><span class="hs-identifier hs-var">scs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1785"></span><span>
</span><span id="line-1786"></span><span>   </span><span id="local-6989586621681683614"><span class="annot"><span class="annottext">implicants :: Type -&gt; [Type]
</span><a href="#local-6989586621681683614"><span class="hs-identifier hs-var hs-var">implicants</span></a></span></span><span> </span><span id="local-6989586621681683632"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683632"><span class="hs-identifier hs-var">pred</span></a></span></span><span>
</span><span id="line-1787"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683632"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type]
</span><a href="#local-6989586621681683633"><span class="hs-identifier hs-var">eq_extras</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683632"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type]
</span><a href="GHC.Tc.Utils.TcType.html#transSuperClasses"><span class="hs-identifier hs-var">transSuperClasses</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683632"><span class="hs-identifier hs-var">pred</span></a></span><span>
</span><span id="line-1788"></span><span>
</span><span id="line-1789"></span><span>   </span><span class="hs-comment">-- Combine (a ~ b) and (b ~ a); no need to have both in one context</span><span>
</span><span id="line-1790"></span><span>   </span><span class="hs-comment">-- These can arise when dealing with partial type signatures (e.g. T14715)</span><span>
</span><span id="line-1791"></span><span>   </span><span id="local-6989586621681683633"><span class="annot"><span class="annottext">eq_extras :: Type -&gt; [Type]
</span><a href="#local-6989586621681683633"><span class="hs-identifier hs-var hs-var">eq_extras</span></a></span></span><span> </span><span id="local-6989586621681683636"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683636"><span class="hs-identifier hs-var">pred</span></a></span></span><span>
</span><span id="line-1792"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pred
</span><a href="GHC.Core.Predicate.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683636"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1793"></span><span>         </span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span id="local-6989586621681683637"><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683637"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681683638"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683638"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681683639"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683639"><span class="hs-identifier hs-var">t2</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Coercion.html#mkPrimEqPredRole"><span class="hs-identifier hs-var">mkPrimEqPredRole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EqRel -&gt; Role
</span><a href="GHC.Core.Predicate.html#eqRelRole"><span class="hs-identifier hs-var">eqRelRole</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="#local-6989586621681683637"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683639"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683638"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1794"></span><span>         </span><span class="annot"><a href="GHC.Core.Predicate.html#ClassPred"><span class="hs-identifier hs-type">ClassPred</span></a></span><span> </span><span id="local-6989586621681683643"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683643"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681683644"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683644"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683645"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683645"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683646"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683646"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683647"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683647"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1795"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683643"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Class -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#heqTyConKey"><span class="hs-identifier hs-var">heqTyConKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Class -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Predicate.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683643"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683645"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683644"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683647"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683646"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1796"></span><span>         </span><span class="annot"><a href="GHC.Core.Predicate.html#ClassPred"><span class="hs-identifier hs-type">ClassPred</span></a></span><span> </span><span id="local-6989586621681683650"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683650"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681683651"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683651"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683652"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683652"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683653"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683653"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1797"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683650"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Class -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#eqTyConKey"><span class="hs-identifier hs-var">eqTyConKey</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Class -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Predicate.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683650"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683651"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683653"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683652"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1798"></span><span>         </span><span class="annot"><span class="annottext">Pred
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1799"></span><span>
</span><span id="line-1800"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#transSuperClasses"><span class="hs-identifier hs-type">transSuperClasses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1801"></span><span class="hs-comment">-- (transSuperClasses p) returns (p's superclasses) not including p</span><span>
</span><span id="line-1802"></span><span class="hs-comment">-- Stop if you encounter the same class again</span><span>
</span><span id="line-1803"></span><span class="hs-comment">-- See Note [Expanding superclasses]</span><span>
</span><span id="line-1804"></span><span id="transSuperClasses"><span class="annot"><span class="annottext">transSuperClasses :: Type -&gt; [Type]
</span><a href="GHC.Tc.Utils.TcType.html#transSuperClasses"><span class="hs-identifier hs-var hs-var">transSuperClasses</span></a></span></span><span> </span><span id="local-6989586621681683655"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683655"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-1805"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSet -&gt; Type -&gt; [Type]
</span><a href="#local-6989586621681683656"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683655"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1806"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1807"></span><span>    </span><span class="annot"><a href="#local-6989586621681683656"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1808"></span><span>    </span><span id="local-6989586621681683656"><span class="annot"><span class="annottext">go :: NameSet -&gt; Type -&gt; [Type]
</span><a href="#local-6989586621681683656"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681683658"><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621681683658"><span class="hs-identifier hs-var">rec_clss</span></a></span></span><span> </span><span id="local-6989586621681683659"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683659"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-1809"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#ClassPred"><span class="hs-identifier hs-type">ClassPred</span></a></span><span> </span><span id="local-6989586621681683660"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683660"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621681683661"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683661"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pred
</span><a href="GHC.Core.Predicate.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683659"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1810"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681683662"><span class="annot"><span class="annottext">cls_nm :: Name
</span><a href="#local-6989586621681683662"><span class="hs-identifier hs-var hs-var">cls_nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; Name
</span><a href="GHC.Core.Class.html#className"><span class="hs-identifier hs-var">className</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683660"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-1811"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681683662"><span class="hs-identifier hs-var">cls_nm</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameSet -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621681683658"><span class="hs-identifier hs-var">rec_clss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1812"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681683665"><span class="annot"><span class="annottext">rec_clss' :: NameSet
</span><a href="#local-6989586621681683665"><span class="hs-identifier hs-var hs-var">rec_clss'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Class -&gt; Bool
</span><a href="GHC.Core.Predicate.html#isCTupleClass"><span class="hs-identifier hs-var">isCTupleClass</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683660"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621681683658"><span class="hs-identifier hs-var">rec_clss</span></a></span><span>
</span><span id="line-1813"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621681683658"><span class="hs-identifier hs-var">rec_clss</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet -&gt; Name -&gt; NameSet
</span><a href="GHC.Types.Name.Set.html#extendNameSet"><span class="hs-operator hs-var">`extendNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681683662"><span class="hs-identifier hs-var">cls_nm</span></a></span><span>
</span><span id="line-1814"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683668"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681683669"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683669"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Class -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Tc.Utils.TcType.html#immSuperClasses"><span class="hs-identifier hs-var">immSuperClasses</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683660"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683661"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1815"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683668"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683668"><span class="hs-identifier hs-var">p'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683669"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">NameSet -&gt; Type -&gt; [Type]
</span><a href="#local-6989586621681683656"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NameSet
</span><a href="#local-6989586621681683665"><span class="hs-identifier hs-var">rec_clss'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683669"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1816"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1817"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1818"></span><span>
</span><span id="line-1819"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#immSuperClasses"><span class="hs-identifier hs-type">immSuperClasses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1820"></span><span id="immSuperClasses"><span class="annot"><span class="annottext">immSuperClasses :: Class -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Tc.Utils.TcType.html#immSuperClasses"><span class="hs-identifier hs-var hs-var">immSuperClasses</span></a></span></span><span> </span><span id="local-6989586621681683670"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683670"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621681683671"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683671"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-1821"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Subst -&gt; [Type] -&gt; [Type]
Subst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTheta"><span class="hs-identifier hs-var">substTheta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [Type] -&gt; Subst
(() :: Constraint) =&gt; [TyVar] -&gt; [Type] -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683672"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683671"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683673"><span class="hs-identifier hs-var">sc_theta</span></a></span><span>
</span><span id="line-1822"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1823"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681683672"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683672"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681683673"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683673"><span class="hs-identifier hs-var">sc_theta</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[ClassOpItem]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; ([TyVar], [Type], [TyVar], [ClassOpItem])
</span><a href="GHC.Core.Class.html#classBigSig"><span class="hs-identifier hs-var">classBigSig</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683670"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-1824"></span><span>
</span><span id="line-1825"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isImprovementPred"><span class="hs-identifier hs-type">isImprovementPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1826"></span><span class="hs-comment">-- Either it's an equality, or has some functional dependency</span><span>
</span><span id="line-1827"></span><span id="isImprovementPred"><span class="annot"><span class="annottext">isImprovementPred :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isImprovementPred"><span class="hs-identifier hs-var hs-var">isImprovementPred</span></a></span></span><span> </span><span id="local-6989586621681683675"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683675"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1828"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pred
</span><a href="GHC.Core.Predicate.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683675"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1829"></span><span>      </span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a></span><span> </span><span id="local-6989586621681683676"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683676"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681683677"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683677"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683676"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#tcEqType"><span class="hs-operator hs-var">`tcEqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683677"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1830"></span><span>      </span><span class="annot"><a href="GHC.Core.Predicate.html#EqPred"><span class="hs-identifier hs-type">EqPred</span></a></span><span> </span><span class="annot"><span class="annottext">EqRel
</span><a href="GHC.Core.Predicate.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1831"></span><span>      </span><span class="annot"><a href="GHC.Core.Predicate.html#ClassPred"><span class="hs-identifier hs-type">ClassPred</span></a></span><span> </span><span id="local-6989586621681683678"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683678"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Class -&gt; Bool
</span><a href="GHC.Core.Class.html#classHasFds"><span class="hs-identifier hs-var">classHasFds</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683678"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-1832"></span><span>      </span><span class="annot"><a href="GHC.Core.Predicate.html#IrredPred"><span class="hs-identifier hs-type">IrredPred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- Might have equalities after reduction?</span><span>
</span><span id="line-1833"></span><span>      </span><span class="annot"><a href="GHC.Core.Predicate.html#ForAllPred"><span class="hs-identifier hs-type">ForAllPred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1834"></span><span>
</span><span id="line-1835"></span><span class="hs-comment">{- Note [Expanding superclasses]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When we expand superclasses, we use the following algorithm:

transSuperClasses( C tys ) returns the transitive superclasses
                           of (C tys), not including C itself

For example
  class C a b =&gt; D a b
  class D b a =&gt; C a b

Then
  transSuperClasses( Ord ty )  = [Eq ty]
  transSuperClasses( C ta tb ) = [D tb ta, C tb ta]

Notice that in the recursive-superclass case we include C again at
the end of the chain.  One could exclude C in this case, but
the code is more awkward and there seems no good reason to do so.
(However C.f. GHC.Tc.Solver.Canonical.mk_strict_superclasses, which /does/
appear to do so.)

The algorithm is expand( so_far, pred ):

 1. If pred is not a class constraint, return empty set
       Otherwise pred = C ts
 2. If C is in so_far, return empty set (breaks loops)
 3. Find the immediate superclasses constraints of (C ts)
 4. For each such sc_pred, return (sc_pred : expand( so_far+C, D ss )

Notice that

 * With normal Haskell-98 classes, the loop-detector will never bite,
   so we'll get all the superclasses.

 * We need the loop-breaker in case we have UndecidableSuperClasses on

 * Since there is only a finite number of distinct classes, expansion
   must terminate.

 * The loop breaking is a bit conservative. Notably, a tuple class
   could contain many times without threatening termination:
      (Eq a, (Ord a, Ix a))
   And this is try of any class that we can statically guarantee
   as non-recursive (in some sense).  For now, we just make a special
   case for tuples.  Something better would be cool.

See also GHC.Tc.TyCl.Utils.checkClassCycles.

************************************************************************
*                                                                      *
      Classifying types
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1889"></span><span>
</span><span id="line-1890"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isSigmaTy"><span class="hs-identifier hs-type">isSigmaTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1891"></span><span class="hs-comment">-- isSigmaTy returns true of any qualified type.  It doesn't</span><span>
</span><span id="line-1892"></span><span class="annot"><span class="hs-comment">-- *necessarily* have any foralls.  E.g</span></span><span>
</span><span id="line-1893"></span><span class="hs-comment">--        f :: (?x::Int) =&gt; Int -&gt; Int</span><span>
</span><span id="line-1894"></span><span id="isSigmaTy"><span class="annot"><span class="annottext">isSigmaTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSigmaTy"><span class="hs-identifier hs-var hs-var">isSigmaTy</span></a></span></span><span> </span><span id="local-6989586621681683682"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683682"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683683"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683683"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683682"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isSigmaTy"><span class="hs-identifier hs-var">isSigmaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683683"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1895"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isSigmaTy"><span class="hs-identifier hs-var">isSigmaTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1896"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isSigmaTy"><span class="hs-identifier hs-var">isSigmaTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683684"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683684"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleFunArg"><span class="hs-identifier hs-var">isInvisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683684"><span class="hs-identifier hs-var">af</span></a></span><span>
</span><span id="line-1897"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isSigmaTy"><span class="hs-identifier hs-var">isSigmaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1898"></span><span>
</span><span id="line-1899"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRhoTy"><span class="hs-identifier hs-type">isRhoTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>   </span><span class="hs-comment">-- True of TcRhoTypes; see Note [TcRhoType]</span><span>
</span><span id="line-1900"></span><span id="isRhoTy"><span class="annot"><span class="annottext">isRhoTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRhoTy"><span class="hs-identifier hs-var hs-var">isRhoTy</span></a></span></span><span> </span><span id="local-6989586621681683685"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683685"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683686"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683686"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683685"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRhoTy"><span class="hs-identifier hs-var">isRhoTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683686"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1901"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRhoTy"><span class="hs-identifier hs-var">isRhoTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1902"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRhoTy"><span class="hs-identifier hs-var">isRhoTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683687"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683687"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isVisibleFunArg"><span class="hs-identifier hs-var">isVisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683687"><span class="hs-identifier hs-var">af</span></a></span><span>
</span><span id="line-1903"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRhoTy"><span class="hs-identifier hs-var">isRhoTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span class="annot"><span class="hs-comment">-- | Like 'isRhoTy', but also says 'True' for 'Infer' types</span></span><span>
</span><span id="line-1906"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRhoExpTy"><span class="hs-identifier hs-type">isRhoExpTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpType"><span class="hs-identifier hs-type">ExpType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1907"></span><span id="isRhoExpTy"><span class="annot"><span class="annottext">isRhoExpTy :: ExpType -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRhoExpTy"><span class="hs-identifier hs-var hs-var">isRhoExpTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span> </span><span id="local-6989586621681683688"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683688"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRhoTy"><span class="hs-identifier hs-var">isRhoTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683688"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1908"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRhoExpTy"><span class="hs-identifier hs-var">isRhoExpTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#Infer"><span class="hs-identifier hs-type">Infer</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1909"></span><span>
</span><span id="line-1910"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier hs-type">isOverloadedTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1911"></span><span class="hs-comment">-- Yes for a type of a function that might require evidence-passing</span><span>
</span><span id="line-1912"></span><span class="hs-comment">-- Used only by bindLocalMethods</span><span>
</span><span id="line-1913"></span><span id="isOverloadedTy"><span class="annot"><span class="annottext">isOverloadedTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier hs-var hs-var">isOverloadedTy</span></a></span></span><span> </span><span id="local-6989586621681683689"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683689"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683690"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683690"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683689"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier hs-var">isOverloadedTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683690"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1914"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier hs-var">isOverloadedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621681683691"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683691"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier hs-var">isOverloadedTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683691"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1915"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier hs-var">isOverloadedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_af :: Type -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#ft_af"><span class="hs-identifier hs-var">ft_af</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683692"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683692"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; Bool
</span><a href="GHC.Types.Var.html#isInvisibleFunArg"><span class="hs-identifier hs-var">isInvisibleFunArg</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621681683692"><span class="hs-identifier hs-var">af</span></a></span><span>
</span><span id="line-1916"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier hs-var">isOverloadedTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1917"></span><span>
</span><span id="line-1918"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFloatTy"><span class="hs-identifier hs-type">isFloatTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isDoubleTy"><span class="hs-identifier hs-type">isDoubleTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1919"></span><span>    </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFloatPrimTy"><span class="hs-identifier hs-type">isFloatPrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isDoublePrimTy"><span class="hs-identifier hs-type">isDoublePrimTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1920"></span><span>    </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isIntegerTy"><span class="hs-identifier hs-type">isIntegerTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isNaturalTy"><span class="hs-identifier hs-type">isNaturalTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1921"></span><span>    </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isIntTy"><span class="hs-identifier hs-type">isIntTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isWordTy"><span class="hs-identifier hs-type">isWordTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isBoolTy"><span class="hs-identifier hs-type">isBoolTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1922"></span><span>    </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isUnitTy"><span class="hs-identifier hs-type">isUnitTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isCharTy"><span class="hs-identifier hs-type">isCharTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1923"></span><span id="isFloatTy"><span class="annot"><span class="annottext">isFloatTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isFloatTy"><span class="hs-identifier hs-var hs-var">isFloatTy</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#floatTyConKey"><span class="hs-identifier hs-var">floatTyConKey</span></a></span><span>
</span><span id="line-1924"></span><span id="isDoubleTy"><span class="annot"><span class="annottext">isDoubleTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isDoubleTy"><span class="hs-identifier hs-var hs-var">isDoubleTy</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#doubleTyConKey"><span class="hs-identifier hs-var">doubleTyConKey</span></a></span><span>
</span><span id="line-1925"></span><span id="isFloatPrimTy"><span class="annot"><span class="annottext">isFloatPrimTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isFloatPrimTy"><span class="hs-identifier hs-var hs-var">isFloatPrimTy</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#floatPrimTyConKey"><span class="hs-identifier hs-var">floatPrimTyConKey</span></a></span><span>
</span><span id="line-1926"></span><span id="isDoublePrimTy"><span class="annot"><span class="annottext">isDoublePrimTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isDoublePrimTy"><span class="hs-identifier hs-var hs-var">isDoublePrimTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#doublePrimTyConKey"><span class="hs-identifier hs-var">doublePrimTyConKey</span></a></span><span>
</span><span id="line-1927"></span><span id="isIntegerTy"><span class="annot"><span class="annottext">isIntegerTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isIntegerTy"><span class="hs-identifier hs-var hs-var">isIntegerTy</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#integerTyConKey"><span class="hs-identifier hs-var">integerTyConKey</span></a></span><span>
</span><span id="line-1928"></span><span id="isNaturalTy"><span class="annot"><span class="annottext">isNaturalTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isNaturalTy"><span class="hs-identifier hs-var hs-var">isNaturalTy</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#naturalTyConKey"><span class="hs-identifier hs-var">naturalTyConKey</span></a></span><span>
</span><span id="line-1929"></span><span id="isIntTy"><span class="annot"><span class="annottext">isIntTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isIntTy"><span class="hs-identifier hs-var hs-var">isIntTy</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#intTyConKey"><span class="hs-identifier hs-var">intTyConKey</span></a></span><span>
</span><span id="line-1930"></span><span id="isWordTy"><span class="annot"><span class="annottext">isWordTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isWordTy"><span class="hs-identifier hs-var hs-var">isWordTy</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#wordTyConKey"><span class="hs-identifier hs-var">wordTyConKey</span></a></span><span>
</span><span id="line-1931"></span><span id="isBoolTy"><span class="annot"><span class="annottext">isBoolTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isBoolTy"><span class="hs-identifier hs-var hs-var">isBoolTy</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#boolTyConKey"><span class="hs-identifier hs-var">boolTyConKey</span></a></span><span>
</span><span id="line-1932"></span><span id="isUnitTy"><span class="annot"><span class="annottext">isUnitTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isUnitTy"><span class="hs-identifier hs-var hs-var">isUnitTy</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Types.html#unitTyConKey"><span class="hs-identifier hs-var">unitTyConKey</span></a></span><span>
</span><span id="line-1933"></span><span id="isCharTy"><span class="annot"><span class="annottext">isCharTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isCharTy"><span class="hs-identifier hs-var hs-var">isCharTy</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var">is_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#charTyConKey"><span class="hs-identifier hs-var">charTyConKey</span></a></span><span>
</span><span id="line-1934"></span><span>
</span><span id="line-1935"></span><span class="hs-comment">-- | Check whether the type is of the form @Any :: k@,</span><span>
</span><span id="line-1936"></span><span class="hs-comment">-- returning the kind @k@.</span><span>
</span><span id="line-1937"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#anyTy_maybe"><span class="hs-identifier hs-type">anyTy_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-1938"></span><span id="anyTy_maybe"><span class="annot"><span class="annottext">anyTy_maybe :: Type -&gt; Maybe Type
</span><a href="GHC.Tc.Utils.TcType.html#anyTy_maybe"><span class="hs-identifier hs-var hs-var">anyTy_maybe</span></a></span></span><span> </span><span id="local-6989586621681683707"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683707"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1939"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683708"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683708"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681683709"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683709"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683707"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1940"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
forall a. Uniquable a =&gt; a -&gt; Unique
</span><a href="GHC.Types.Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683708"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#anyTyConKey"><span class="hs-identifier hs-var">anyTyConKey</span></a></span><span>
</span><span id="line-1941"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683709"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1942"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1943"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1944"></span><span>
</span><span id="line-1945"></span><span class="hs-comment">-- | Is the type inhabited by machine floating-point numbers?</span><span>
</span><span id="line-1946"></span><span class="hs-comment">--</span><span>
</span><span id="line-1947"></span><span class="hs-comment">-- Used to check that we don't use floating-point literal patterns</span><span>
</span><span id="line-1948"></span><span class="hs-comment">-- in Core.</span><span>
</span><span id="line-1949"></span><span class="hs-comment">--</span><span>
</span><span id="line-1950"></span><span class="hs-comment">-- See #9238 and Note [Rules for floating-point comparisons]</span><span>
</span><span id="line-1951"></span><span class="hs-comment">-- in GHC.Core.Opt.ConstantFold.</span><span>
</span><span id="line-1952"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFloatingPrimTy"><span class="hs-identifier hs-type">isFloatingPrimTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1953"></span><span id="isFloatingPrimTy"><span class="annot"><span class="annottext">isFloatingPrimTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isFloatingPrimTy"><span class="hs-identifier hs-var hs-var">isFloatingPrimTy</span></a></span></span><span> </span><span id="local-6989586621681683713"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683713"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isFloatPrimTy"><span class="hs-identifier hs-var">isFloatPrimTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683713"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isDoublePrimTy"><span class="hs-identifier hs-var">isDoublePrimTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683713"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1954"></span><span>
</span><span id="line-1955"></span><span class="annot"><span class="hs-comment">-- | Is a type 'String'?</span></span><span>
</span><span id="line-1956"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier hs-type">isStringTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1957"></span><span id="isStringTy"><span class="annot"><span class="annottext">isStringTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier hs-var hs-var">isStringTy</span></a></span></span><span> </span><span id="local-6989586621681683714"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683714"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1958"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683714"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1959"></span><span>      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683715"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683715"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681683716"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683716"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683715"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#listTyCon"><span class="hs-identifier hs-var">listTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isCharTy"><span class="hs-identifier hs-var">isCharTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683716"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1960"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1961"></span><span>
</span><span id="line-1962"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-type">is_tc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1963"></span><span class="hs-comment">-- Newtypes are opaque to this</span><span>
</span><span id="line-1964"></span><span id="is_tc"><span class="annot"><span class="annottext">is_tc :: Unique -&gt; Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#is_tc"><span class="hs-identifier hs-var hs-var">is_tc</span></a></span></span><span> </span><span id="local-6989586621681683717"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681683717"><span class="hs-identifier hs-var">uniq</span></a></span></span><span> </span><span id="local-6989586621681683718"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683718"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683718"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1965"></span><span>                        </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683719"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683719"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681683717"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique
forall a. Uniquable a =&gt; a -&gt; Unique
</span><a href="GHC.Types.Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683719"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1966"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1967"></span><span>
</span><span id="line-1968"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isRigidTy"><span class="hs-identifier hs-type">isRigidTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1969"></span><span id="isRigidTy"><span class="annot"><span class="annottext">isRigidTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isRigidTy"><span class="hs-identifier hs-var hs-var">isRigidTy</span></a></span></span><span> </span><span id="local-6989586621681683720"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683720"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1970"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683721"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683721"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683720"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Role -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isGenerativeTyCon"><span class="hs-identifier hs-var">isGenerativeTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683721"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span>
</span><span id="line-1971"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683720"><span class="hs-identifier hs-var">ty</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1972"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isForAllTy"><span class="hs-identifier hs-var">isForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683720"><span class="hs-identifier hs-var">ty</span></a></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1973"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1974"></span><span>
</span><span id="line-1975"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
   Misc
*                                                                      *
************************************************************************

Note [Visible type application]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
GHC implements a generalisation of the algorithm described in the
&quot;Visible Type Application&quot; paper (available from
http://www.cis.upenn.edu/~sweirich/publications.html). A key part
of that algorithm is to distinguish user-specified variables from inferred
variables. For example, the following should typecheck:

  f :: forall a b. a -&gt; b -&gt; b
  f = const id

  g = const id

  x = f @Int @Bool 5 False
  y = g 5 @Bool False

The idea is that we wish to allow visible type application when we are
instantiating a specified, fixed variable. In practice, specified, fixed
variables are either written in a type signature (or
annotation), OR are imported from another module. (We could do better here,
for example by doing SCC analysis on parts of a module and considering any
type from outside one's SCC to be fully specified, but this is very confusing to
users. The simple rule above is much more straightforward and predictable.)

So, both of f's quantified variables are specified and may be instantiated.
But g has no type signature, so only id's variable is specified (because id
is imported). We write the type of g as forall {a}. a -&gt; forall b. b -&gt; b.
Note that the a is in braces, meaning it cannot be instantiated with
visible type application.

Tracking specified vs. inferred variables is done conveniently by a field
in PiTyVarBinder.

-}</span><span>
</span><span id="line-2016"></span><span>
</span><span id="line-2017"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#deNoteType"><span class="hs-identifier hs-type">deNoteType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2018"></span><span class="hs-comment">-- Remove all *outermost* type synonyms and other notes</span><span>
</span><span id="line-2019"></span><span id="deNoteType"><span class="annot"><span class="annottext">deNoteType :: Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#deNoteType"><span class="hs-identifier hs-var hs-var">deNoteType</span></a></span></span><span> </span><span id="local-6989586621681683724"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683724"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683725"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683725"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683724"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="GHC.Tc.Utils.TcType.html#deNoteType"><span class="hs-identifier hs-var">deNoteType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683725"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2020"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#deNoteType"><span class="hs-identifier hs-var">deNoteType</span></a></span><span> </span><span id="local-6989586621681683726"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683726"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683726"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2021"></span><span>
</span><span id="line-2022"></span><span class="hs-comment">{-
Find the free tycons and classes of a type.  This is used in the front
end of the compiler.
-}</span><span>
</span><span id="line-2026"></span><span>
</span><span id="line-2027"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
   External types
*                                                                      *
************************************************************************

The compiler's foreign function interface supports the passing of a
restricted set of types as arguments and results (the restricting factor
being the )
-}</span><span>
</span><span id="line-2038"></span><span>
</span><span id="line-2039"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitIOType_maybe"><span class="hs-identifier hs-type">tcSplitIOType_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2040"></span><span class="hs-comment">-- (tcSplitIOType_maybe t) returns Just (IO,t',co)</span><span>
</span><span id="line-2041"></span><span class="hs-comment">--              if co : t ~ IO t'</span><span>
</span><span id="line-2042"></span><span class="hs-comment">--              returns Nothing otherwise</span><span>
</span><span id="line-2043"></span><span id="tcSplitIOType_maybe"><span class="annot"><span class="annottext">tcSplitIOType_maybe :: Type -&gt; Maybe (TyCon, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitIOType_maybe"><span class="hs-identifier hs-var hs-var">tcSplitIOType_maybe</span></a></span></span><span> </span><span id="local-6989586621681683727"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683727"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2044"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683727"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2045"></span><span>        </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683728"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683728"><span class="hs-identifier hs-var">io_tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681683729"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683729"><span class="hs-identifier hs-var">io_res_ty</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2046"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683728"><span class="hs-identifier hs-var">io_tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#ioTyConKey"><span class="hs-identifier hs-var">ioTyConKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2047"></span><span>            </span><span class="annot"><span class="annottext">(TyCon, Type) -&gt; Maybe (TyCon, Type)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683728"><span class="hs-identifier hs-var">io_tycon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683729"><span class="hs-identifier hs-var">io_res_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2048"></span><span>        </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2049"></span><span>            </span><span class="annot"><span class="annottext">Maybe (TyCon, Type)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2050"></span><span>
</span><span id="line-2051"></span><span class="annot"><span class="hs-comment">-- | Reason why a type in an FFI signature is invalid</span></span><span>
</span><span id="line-2052"></span><span class="hs-keyword">data</span><span> </span><span id="IllegalForeignTypeReason"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-var">IllegalForeignTypeReason</span></a></span></span><span>
</span><span id="line-2053"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TypeCannotBeMarshaled"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaled"><span class="hs-identifier hs-var">TypeCannotBeMarshaled</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2054"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ForeignDynNotPtr"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ForeignDynNotPtr"><span class="hs-identifier hs-var">ForeignDynNotPtr</span></a></span></span><span>
</span><span id="line-2055"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Expected type</span></span><span>
</span><span id="line-2056"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Actual type</span></span><span>
</span><span id="line-2057"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SafeHaskellMustBeInIO"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#SafeHaskellMustBeInIO"><span class="hs-identifier hs-var">SafeHaskellMustBeInIO</span></a></span></span><span>
</span><span id="line-2058"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IOResultExpected"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IOResultExpected"><span class="hs-identifier hs-var">IOResultExpected</span></a></span></span><span>
</span><span id="line-2059"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnexpectedNestedForall"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#UnexpectedNestedForall"><span class="hs-identifier hs-var">UnexpectedNestedForall</span></a></span></span><span>
</span><span id="line-2060"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LinearTypesNotAllowed"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#LinearTypesNotAllowed"><span class="hs-identifier hs-var">LinearTypesNotAllowed</span></a></span></span><span>
</span><span id="line-2061"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OneArgExpected"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#OneArgExpected"><span class="hs-identifier hs-var">OneArgExpected</span></a></span></span><span>
</span><span id="line-2062"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtLeastOneArgExpected"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#AtLeastOneArgExpected"><span class="hs-identifier hs-var">AtLeastOneArgExpected</span></a></span></span><span>
</span><span id="line-2063"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681683740"><span id="local-6989586621681683742"><span class="annot"><span class="annottext">(forall x.
 IllegalForeignTypeReason -&gt; Rep IllegalForeignTypeReason x)
-&gt; (forall x.
    Rep IllegalForeignTypeReason x -&gt; IllegalForeignTypeReason)
-&gt; Generic IllegalForeignTypeReason
forall x.
Rep IllegalForeignTypeReason x -&gt; IllegalForeignTypeReason
forall x.
IllegalForeignTypeReason -&gt; Rep IllegalForeignTypeReason x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x.
IllegalForeignTypeReason -&gt; Rep IllegalForeignTypeReason x
from :: forall x.
IllegalForeignTypeReason -&gt; Rep IllegalForeignTypeReason x
$cto :: forall x.
Rep IllegalForeignTypeReason x -&gt; IllegalForeignTypeReason
to :: forall x.
Rep IllegalForeignTypeReason x -&gt; IllegalForeignTypeReason
</span><a href="../../base-4.18.3.0/src/GHC.Generics.html#Generic/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span>
</span><span id="line-2064"></span><span>
</span><span id="line-2065"></span><span class="annot"><span class="hs-comment">-- | Reason why a type cannot be marshalled through the FFI.</span></span><span>
</span><span id="line-2066"></span><span class="hs-keyword">data</span><span> </span><span id="TypeCannotBeMarshaledReason"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-var">TypeCannotBeMarshaledReason</span></a></span></span><span>
</span><span id="line-2067"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="NotADataType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#NotADataType"><span class="hs-identifier hs-var">NotADataType</span></a></span></span><span>
</span><span id="line-2068"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NewtypeDataConNotInScope"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#NewtypeDataConNotInScope"><span class="hs-identifier hs-var">NewtypeDataConNotInScope</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2069"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnliftedFFITypesNeeded"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#UnliftedFFITypesNeeded"><span class="hs-identifier hs-var">UnliftedFFITypesNeeded</span></a></span></span><span>
</span><span id="line-2070"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NotABoxedMarshalableTyCon"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#NotABoxedMarshalableTyCon"><span class="hs-identifier hs-var">NotABoxedMarshalableTyCon</span></a></span></span><span>
</span><span id="line-2071"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ForeignLabelNotAPtr"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ForeignLabelNotAPtr"><span class="hs-identifier hs-var">ForeignLabelNotAPtr</span></a></span></span><span>
</span><span id="line-2072"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NotSimpleUnliftedType"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#NotSimpleUnliftedType"><span class="hs-identifier hs-var">NotSimpleUnliftedType</span></a></span></span><span>
</span><span id="line-2073"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NotBoxedKindAny"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#NotBoxedKindAny"><span class="hs-identifier hs-var">NotBoxedKindAny</span></a></span></span><span>
</span><span id="line-2074"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681683753"><span id="local-6989586621681683755"><span class="annot"><span class="annottext">(forall x.
 TypeCannotBeMarshaledReason -&gt; Rep TypeCannotBeMarshaledReason x)
-&gt; (forall x.
    Rep TypeCannotBeMarshaledReason x -&gt; TypeCannotBeMarshaledReason)
-&gt; Generic TypeCannotBeMarshaledReason
forall x.
Rep TypeCannotBeMarshaledReason x -&gt; TypeCannotBeMarshaledReason
forall x.
TypeCannotBeMarshaledReason -&gt; Rep TypeCannotBeMarshaledReason x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x.
TypeCannotBeMarshaledReason -&gt; Rep TypeCannotBeMarshaledReason x
from :: forall x.
TypeCannotBeMarshaledReason -&gt; Rep TypeCannotBeMarshaledReason x
$cto :: forall x.
Rep TypeCannotBeMarshaledReason x -&gt; TypeCannotBeMarshaledReason
to :: forall x.
Rep TypeCannotBeMarshaledReason x -&gt; TypeCannotBeMarshaledReason
</span><a href="../../base-4.18.3.0/src/GHC.Generics.html#Generic/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span>
</span><span id="line-2075"></span><span>
</span><span id="line-2076"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIArgumentTy"><span class="hs-identifier hs-type">isFFIArgumentTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html#Safety"><span class="hs-identifier hs-type">Safety</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2077"></span><span class="hs-comment">-- Checks for valid argument type for a 'foreign import'</span><span>
</span><span id="line-2078"></span><span id="isFFIArgumentTy"><span class="annot"><span class="annottext">isFFIArgumentTy :: DynFlags -&gt; Safety -&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#isFFIArgumentTy"><span class="hs-identifier hs-var hs-var">isFFIArgumentTy</span></a></span></span><span> </span><span id="local-6989586621681683757"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683757"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681683758"><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621681683758"><span class="hs-identifier hs-var">safety</span></a></span></span><span> </span><span id="local-6989586621681683759"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683759"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2079"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-var">checkRepTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags
-&gt; Safety -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalOutgoingTyCon"><span class="hs-identifier hs-var">legalOutgoingTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683757"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621681683758"><span class="hs-identifier hs-var">safety</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683759"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2080"></span><span>
</span><span id="line-2081"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIExternalTy"><span class="hs-identifier hs-type">isFFIExternalTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2082"></span><span class="hs-comment">-- Types that are allowed as arguments of a 'foreign export'</span><span>
</span><span id="line-2083"></span><span id="isFFIExternalTy"><span class="annot"><span class="annottext">isFFIExternalTy :: Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#isFFIExternalTy"><span class="hs-identifier hs-var hs-var">isFFIExternalTy</span></a></span></span><span> </span><span id="local-6989586621681683762"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683762"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-var">checkRepTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFEArgTyCon"><span class="hs-identifier hs-var">legalFEArgTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683762"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2084"></span><span>
</span><span id="line-2085"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIImportResultTy"><span class="hs-identifier hs-type">isFFIImportResultTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2086"></span><span id="isFFIImportResultTy"><span class="annot"><span class="annottext">isFFIImportResultTy :: DynFlags -&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#isFFIImportResultTy"><span class="hs-identifier hs-var hs-var">isFFIImportResultTy</span></a></span></span><span> </span><span id="local-6989586621681683764"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683764"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681683765"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683765"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2087"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-var">checkRepTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFIResultTyCon"><span class="hs-identifier hs-var">legalFIResultTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683764"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683765"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2088"></span><span>
</span><span id="line-2089"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIExportResultTy"><span class="hs-identifier hs-type">isFFIExportResultTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2090"></span><span id="isFFIExportResultTy"><span class="annot"><span class="annottext">isFFIExportResultTy :: Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#isFFIExportResultTy"><span class="hs-identifier hs-var hs-var">isFFIExportResultTy</span></a></span></span><span> </span><span id="local-6989586621681683767"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683767"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-var">checkRepTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFEResultTyCon"><span class="hs-identifier hs-var">legalFEResultTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683767"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2091"></span><span>
</span><span id="line-2092"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIDynTy"><span class="hs-identifier hs-type">isFFIDynTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2093"></span><span class="hs-comment">-- The type in a foreign import dynamic must be Ptr, FunPtr, or a newtype of</span><span>
</span><span id="line-2094"></span><span class="hs-comment">-- either, and the wrapped function type must be equal to the given type.</span><span>
</span><span id="line-2095"></span><span class="hs-comment">-- We assume that all types have been run through normaliseFfiType, so we don't</span><span>
</span><span id="line-2096"></span><span class="hs-comment">-- need to worry about expanding newtypes here.</span><span>
</span><span id="line-2097"></span><span id="isFFIDynTy"><span class="annot"><span class="annottext">isFFIDynTy :: Type -&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#isFFIDynTy"><span class="hs-identifier hs-var hs-var">isFFIDynTy</span></a></span></span><span> </span><span id="local-6989586621681683769"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683769"><span class="hs-identifier hs-var">expected</span></a></span></span><span> </span><span id="local-6989586621681683770"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683770"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2098"></span><span>    </span><span class="hs-comment">-- Note [Foreign import dynamic]</span><span>
</span><span id="line-2099"></span><span>    </span><span class="hs-comment">-- In the example below, expected would be 'CInt -&gt; IO ()', while ty would</span><span>
</span><span id="line-2100"></span><span>    </span><span class="hs-comment">-- be 'FunPtr (CDouble -&gt; IO ())'.</span><span>
</span><span id="line-2101"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683771"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683771"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681683772"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683772"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683770"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Unique] -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; [Unique] -&gt; Bool
</span><a href="GHC.Utils.Unique.html#anyOfUnique"><span class="hs-identifier hs-var">anyOfUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683771"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#ptrTyConKey"><span class="hs-identifier hs-var">ptrTyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#funPtrTyConKey"><span class="hs-identifier hs-var">funPtrTyConKey</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-identifier hs-var">eqType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683772"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683769"><span class="hs-identifier hs-var">expected</span></a></span><span>
</span><span id="line-2104"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' IllegalForeignTypeReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2105"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2106"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IllegalForeignTypeReason -&gt; Validity' IllegalForeignTypeReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#ForeignDynNotPtr"><span class="hs-identifier hs-var">ForeignDynNotPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683769"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683770"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2107"></span><span>
</span><span id="line-2108"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFILabelTy"><span class="hs-identifier hs-type">isFFILabelTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2109"></span><span class="hs-comment">-- The type of a foreign label must be Ptr, FunPtr, or a newtype of either.</span><span>
</span><span id="line-2110"></span><span id="isFFILabelTy"><span class="annot"><span class="annottext">isFFILabelTy :: Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#isFFILabelTy"><span class="hs-identifier hs-var hs-var">isFFILabelTy</span></a></span></span><span> </span><span id="local-6989586621681683777"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683777"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-var">checkRepTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Validity' TypeCannotBeMarshaledReason
forall {a}.
Uniquable a =&gt;
a -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="#local-6989586621681683778"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683777"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2111"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2112"></span><span>    </span><span id="local-6989586621681683778"><span class="annot"><span class="annottext">ok :: a -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="#local-6989586621681683778"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span id="local-6989586621681683782"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683782"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683782"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#funPtrTyConKey"><span class="hs-identifier hs-var">funPtrTyConKey</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681683782"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#ptrTyConKey"><span class="hs-identifier hs-var">ptrTyConKey</span></a></span><span>
</span><span id="line-2113"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' TypeCannotBeMarshaledReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2114"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2115"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
-&gt; Validity' TypeCannotBeMarshaledReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#ForeignLabelNotAPtr"><span class="hs-identifier hs-var">ForeignLabelNotAPtr</span></a></span><span>
</span><span id="line-2116"></span><span>
</span><span id="line-2117"></span><span class="hs-comment">-- | Check validity for a type of the form @Any :: k@.</span><span>
</span><span id="line-2118"></span><span class="hs-comment">--</span><span>
</span><span id="line-2119"></span><span class="hs-comment">-- This function returns:</span><span>
</span><span id="line-2120"></span><span class="hs-comment">--</span><span>
</span><span id="line-2121"></span><span class="hs-comment">--  - @Just IsValid@ for @Any :: Type@ and @Any :: UnliftedType@,</span><span>
</span><span id="line-2122"></span><span class="hs-comment">--  - @Just (NotValid ..)@ for @Any :: k@ if @k@ is not a kind of boxed types,</span><span>
</span><span id="line-2123"></span><span class="hs-comment">--  - @Nothing@ if the type is not @Any@.</span><span>
</span><span id="line-2124"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#checkAnyTy"><span class="hs-identifier hs-type">checkAnyTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2125"></span><span id="checkAnyTy"><span class="annot"><span class="annottext">checkAnyTy :: Type -&gt; Maybe (Validity' IllegalForeignTypeReason)
</span><a href="GHC.Tc.Utils.TcType.html#checkAnyTy"><span class="hs-identifier hs-var hs-var">checkAnyTy</span></a></span></span><span> </span><span id="local-6989586621681683784"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683784"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683785"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683785"><span class="hs-identifier hs-var">ki</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Tc.Utils.TcType.html#anyTy_maybe"><span class="hs-identifier hs-var">anyTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683784"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2127"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' IllegalForeignTypeReason
-&gt; Maybe (Validity' IllegalForeignTypeReason)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Validity' IllegalForeignTypeReason
 -&gt; Maybe (Validity' IllegalForeignTypeReason))
-&gt; Validity' IllegalForeignTypeReason
-&gt; Maybe (Validity' IllegalForeignTypeReason)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2128"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Levity -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Maybe.html#isJust/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Levity -&gt; Bool) -&gt; Maybe Levity -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Levity
</span><a href="GHC.Core.Type.html#kindBoxedRepLevity_maybe"><span class="hs-identifier hs-var">kindBoxedRepLevity_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683785"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-2129"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Validity' IllegalForeignTypeReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2130"></span><span>      </span><span class="hs-comment">-- NB: don't allow things like @Any :: TYPE IntRep@, as per #21305.</span><span>
</span><span id="line-2131"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IllegalForeignTypeReason -&gt; Validity' IllegalForeignTypeReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TypeCannotBeMarshaledReason -&gt; IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaled"><span class="hs-identifier hs-var">TypeCannotBeMarshaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683784"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#NotBoxedKindAny"><span class="hs-identifier hs-var">NotBoxedKindAny</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2132"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2133"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Validity' IllegalForeignTypeReason)
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2134"></span><span>
</span><span id="line-2135"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIPrimArgumentTy"><span class="hs-identifier hs-type">isFFIPrimArgumentTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2136"></span><span class="hs-comment">-- Checks for valid argument type for a 'foreign import prim'</span><span>
</span><span id="line-2137"></span><span class="hs-comment">-- Currently they must all be simple unlifted types, or Any (at kind Type or UnliftedType),</span><span>
</span><span id="line-2138"></span><span class="hs-comment">-- which can be used to pass the address to a Haskell object on the heap to</span><span>
</span><span id="line-2139"></span><span class="hs-comment">-- the foreign function.</span><span>
</span><span id="line-2140"></span><span id="isFFIPrimArgumentTy"><span class="annot"><span class="annottext">isFFIPrimArgumentTy :: DynFlags -&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#isFFIPrimArgumentTy"><span class="hs-identifier hs-var hs-var">isFFIPrimArgumentTy</span></a></span></span><span> </span><span id="local-6989586621681683787"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683787"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681683788"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683788"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2141"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683789"><span class="annot"><span class="annottext">Validity' IllegalForeignTypeReason
</span><a href="#local-6989586621681683789"><span class="hs-identifier hs-var">validity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Validity' IllegalForeignTypeReason)
</span><a href="GHC.Tc.Utils.TcType.html#checkAnyTy"><span class="hs-identifier hs-var">checkAnyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683788"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2142"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' IllegalForeignTypeReason
</span><a href="#local-6989586621681683789"><span class="hs-identifier hs-var">validity</span></a></span><span>
</span><span id="line-2143"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2144"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-var">checkRepTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFIPrimArgTyCon"><span class="hs-identifier hs-var">legalFIPrimArgTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683787"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683788"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2145"></span><span>
</span><span id="line-2146"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFFIPrimResultTy"><span class="hs-identifier hs-type">isFFIPrimResultTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2147"></span><span class="hs-comment">-- Checks for valid result type for a 'foreign import prim' Currently</span><span>
</span><span id="line-2148"></span><span class="hs-comment">-- it must be an unlifted type, including unboxed tuples, unboxed</span><span>
</span><span id="line-2149"></span><span class="hs-comment">-- sums, or the well-known type Any (at kind Type or UnliftedType).</span><span>
</span><span id="line-2150"></span><span id="isFFIPrimResultTy"><span class="annot"><span class="annottext">isFFIPrimResultTy :: DynFlags -&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#isFFIPrimResultTy"><span class="hs-identifier hs-var hs-var">isFFIPrimResultTy</span></a></span></span><span> </span><span id="local-6989586621681683791"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683791"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681683792"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683792"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683793"><span class="annot"><span class="annottext">Validity' IllegalForeignTypeReason
</span><a href="#local-6989586621681683793"><span class="hs-identifier hs-var">validity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Validity' IllegalForeignTypeReason)
</span><a href="GHC.Tc.Utils.TcType.html#checkAnyTy"><span class="hs-identifier hs-var">checkAnyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683792"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2152"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' IllegalForeignTypeReason
</span><a href="#local-6989586621681683793"><span class="hs-identifier hs-var">validity</span></a></span><span>
</span><span id="line-2153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2154"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-var">checkRepTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFIPrimResultTyCon"><span class="hs-identifier hs-var">legalFIPrimResultTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683791"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683792"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2155"></span><span>
</span><span id="line-2156"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFunPtrTy"><span class="hs-identifier hs-type">isFunPtrTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2157"></span><span id="isFunPtrTy"><span class="annot"><span class="annottext">isFunPtrTy :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isFunPtrTy"><span class="hs-identifier hs-var hs-var">isFunPtrTy</span></a></span></span><span> </span><span id="local-6989586621681683795"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683795"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2158"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683796"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683796"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683795"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2159"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683796"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#funPtrTyConKey"><span class="hs-identifier hs-var">funPtrTyConKey</span></a></span><span>
</span><span id="line-2160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2161"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2162"></span><span>
</span><span id="line-2163"></span><span class="hs-comment">-- normaliseFfiType gets run before checkRepTyCon, so we don't</span><span>
</span><span id="line-2164"></span><span class="hs-comment">-- need to worry about looking through newtypes or type functions</span><span>
</span><span id="line-2165"></span><span class="hs-comment">-- here; that's already been taken care of.</span><span>
</span><span id="line-2166"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-type">checkRepTyCon</span></a></span><span>
</span><span id="line-2167"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2168"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-2169"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#IllegalForeignTypeReason"><span class="hs-identifier hs-type">IllegalForeignTypeReason</span></a></span><span>
</span><span id="line-2170"></span><span id="checkRepTyCon"><span class="annot"><span class="annottext">checkRepTyCon :: (TyCon -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; Type -&gt; Validity' IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#checkRepTyCon"><span class="hs-identifier hs-var hs-var">checkRepTyCon</span></a></span></span><span> </span><span id="local-6989586621681683797"><span class="annot"><span class="annottext">TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="#local-6989586621681683797"><span class="hs-identifier hs-var">check_tc</span></a></span></span><span> </span><span id="local-6989586621681683798"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683798"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2171"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TypeCannotBeMarshaledReason -&gt; IllegalForeignTypeReason)
-&gt; Validity' TypeCannotBeMarshaledReason
-&gt; Validity' IllegalForeignTypeReason
forall a b. (a -&gt; b) -&gt; Validity' a -&gt; Validity' b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TypeCannotBeMarshaledReason -&gt; IllegalForeignTypeReason
</span><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaled"><span class="hs-identifier hs-var">TypeCannotBeMarshaled</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683798"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Validity' TypeCannotBeMarshaledReason
 -&gt; Validity' IllegalForeignTypeReason)
-&gt; Validity' TypeCannotBeMarshaledReason
-&gt; Validity' IllegalForeignTypeReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683798"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2172"></span><span>      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683799"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683799"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681683800"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683800"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2173"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683799"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
-&gt; Validity' TypeCannotBeMarshaledReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; TypeCannotBeMarshaledReason
forall {t :: * -&gt; *} {a}.
Foldable t =&gt;
TyCon -&gt; t a -&gt; TypeCannotBeMarshaledReason
</span><a href="#local-6989586621681683802"><span class="hs-identifier hs-var">mk_nt_reason</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683799"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683800"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2174"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="#local-6989586621681683797"><span class="hs-identifier hs-var">check_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683799"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2175"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
-&gt; Validity' TypeCannotBeMarshaledReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#NotADataType"><span class="hs-identifier hs-var">NotADataType</span></a></span><span>
</span><span id="line-2176"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2177"></span><span>    </span><span id="local-6989586621681683802"><span class="annot"><span class="annottext">mk_nt_reason :: TyCon -&gt; t a -&gt; TypeCannotBeMarshaledReason
</span><a href="#local-6989586621681683802"><span class="hs-identifier hs-var hs-var">mk_nt_reason</span></a></span></span><span> </span><span id="local-6989586621681683805"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683805"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681683806"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621681683806"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2178"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t a -&gt; Bool
forall a. t a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621681683806"><span class="hs-identifier hs-var">tys</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon -&gt; TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#NewtypeDataConNotInScope"><span class="hs-identifier hs-var">NewtypeDataConNotInScope</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2179"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon -&gt; TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#NewtypeDataConNotInScope"><span class="hs-identifier hs-var">NewtypeDataConNotInScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Maybe TyCon
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683805"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2180"></span><span>
</span><span id="line-2181"></span><span class="hs-comment">{-
Note [Foreign import dynamic]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A dynamic stub must be of the form 'FunPtr ft -&gt; ft' where ft is any foreign
type.  Similarly, a wrapper stub must be of the form 'ft -&gt; IO (FunPtr ft)'.

We use isFFIDynTy to check whether a signature is well-formed. For example,
given a (illegal) declaration like:

foreign import ccall &quot;dynamic&quot;
  foo :: FunPtr (CDouble -&gt; IO ()) -&gt; CInt -&gt; IO ()

isFFIDynTy will compare the 'FunPtr' type 'CDouble -&gt; IO ()' with the curried
result type 'CInt -&gt; IO ()', and return False, as they are not equal.


----------------------------------------------
These chaps do the work; they are not exported
----------------------------------------------
-}</span><span>
</span><span id="line-2201"></span><span>
</span><span id="line-2202"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#legalFEArgTyCon"><span class="hs-identifier hs-type">legalFEArgTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2203"></span><span id="legalFEArgTyCon"><span class="annot"><span class="annottext">legalFEArgTyCon :: TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFEArgTyCon"><span class="hs-identifier hs-var hs-var">legalFEArgTyCon</span></a></span></span><span> </span><span id="local-6989586621681683807"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683807"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2204"></span><span>  </span><span class="hs-comment">-- It's illegal to make foreign exports that take unboxed</span><span>
</span><span id="line-2205"></span><span>  </span><span class="hs-comment">-- arguments.  The RTS API currently can't invoke such things.  --SDM 7/2000</span><span>
</span><span id="line-2206"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#boxedMarshalableTyCon"><span class="hs-identifier hs-var">boxedMarshalableTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683807"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2207"></span><span>
</span><span id="line-2208"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#legalFIResultTyCon"><span class="hs-identifier hs-type">legalFIResultTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2209"></span><span id="legalFIResultTyCon"><span class="annot"><span class="annottext">legalFIResultTyCon :: DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFIResultTyCon"><span class="hs-identifier hs-var hs-var">legalFIResultTyCon</span></a></span></span><span> </span><span id="local-6989586621681683809"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683809"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681683810"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683810"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2210"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683810"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#unitTyCon"><span class="hs-identifier hs-var">unitTyCon</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' TypeCannotBeMarshaledReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2211"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#marshalableTyCon"><span class="hs-identifier hs-var">marshalableTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683809"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683810"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2212"></span><span>
</span><span id="line-2213"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#legalFEResultTyCon"><span class="hs-identifier hs-type">legalFEResultTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2214"></span><span id="legalFEResultTyCon"><span class="annot"><span class="annottext">legalFEResultTyCon :: TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFEResultTyCon"><span class="hs-identifier hs-var hs-var">legalFEResultTyCon</span></a></span></span><span> </span><span id="local-6989586621681683812"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683812"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2215"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683812"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="GHC.Builtin.Types.html#unitTyCon"><span class="hs-identifier hs-var">unitTyCon</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' TypeCannotBeMarshaledReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2216"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#boxedMarshalableTyCon"><span class="hs-identifier hs-var">boxedMarshalableTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683812"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2217"></span><span>
</span><span id="line-2218"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#legalOutgoingTyCon"><span class="hs-identifier hs-type">legalOutgoingTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html#Safety"><span class="hs-identifier hs-type">Safety</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2219"></span><span class="hs-comment">-- Checks validity of types going from Haskell -&gt; external world</span><span>
</span><span id="line-2220"></span><span id="legalOutgoingTyCon"><span class="annot"><span class="annottext">legalOutgoingTyCon :: DynFlags
-&gt; Safety -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalOutgoingTyCon"><span class="hs-identifier hs-var hs-var">legalOutgoingTyCon</span></a></span></span><span> </span><span id="local-6989586621681683813"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683813"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683814"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683814"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2221"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#marshalableTyCon"><span class="hs-identifier hs-var">marshalableTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683813"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683814"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2222"></span><span>
</span><span id="line-2223"></span><span class="hs-comment">-- Check for marshalability of a primitive type.</span><span>
</span><span id="line-2224"></span><span class="hs-comment">-- We exclude lifted types such as RealWorld and TYPE.</span><span>
</span><span id="line-2225"></span><span class="hs-comment">-- They can technically appear in types, e.g.</span><span>
</span><span id="line-2226"></span><span class="hs-comment">-- f :: RealWorld -&gt; TYPE LiftedRep -&gt; RealWorld</span><span>
</span><span id="line-2227"></span><span class="hs-comment">-- f x _ = x</span><span>
</span><span id="line-2228"></span><span class="hs-comment">-- but there are no values of type RealWorld or TYPE LiftedRep,</span><span>
</span><span id="line-2229"></span><span class="hs-comment">-- so it doesn't make sense to use them in FFI.</span><span>
</span><span id="line-2230"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#marshalablePrimTyCon"><span class="hs-identifier hs-type">marshalablePrimTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2231"></span><span id="marshalablePrimTyCon"><span class="annot"><span class="annottext">marshalablePrimTyCon :: TyCon -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#marshalablePrimTyCon"><span class="hs-identifier hs-var hs-var">marshalablePrimTyCon</span></a></span></span><span> </span><span id="local-6989586621681683816"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683816"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isPrimTyCon"><span class="hs-identifier hs-var">isPrimTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683816"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier hs-var">isLiftedTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConResKind"><span class="hs-identifier hs-var">tyConResKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683816"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2232"></span><span>
</span><span id="line-2233"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#marshalableTyCon"><span class="hs-identifier hs-type">marshalableTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2234"></span><span id="marshalableTyCon"><span class="annot"><span class="annottext">marshalableTyCon :: DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#marshalableTyCon"><span class="hs-identifier hs-var hs-var">marshalableTyCon</span></a></span></span><span> </span><span id="local-6989586621681683819"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683819"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681683820"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683820"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2235"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#marshalablePrimTyCon"><span class="hs-identifier hs-var">marshalablePrimTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683820"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2236"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PrimRep] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; TyCon -&gt; [PrimRep]
TyCon -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#tyConPrimRep"><span class="hs-identifier hs-var">tyConPrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683820"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Note [Marshalling void]</span><span>
</span><span id="line-2237"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#validIfUnliftedFFITypes"><span class="hs-identifier hs-var">validIfUnliftedFFITypes</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683819"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-2238"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2239"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#boxedMarshalableTyCon"><span class="hs-identifier hs-var">boxedMarshalableTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683820"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2240"></span><span>
</span><span id="line-2241"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#boxedMarshalableTyCon"><span class="hs-identifier hs-type">boxedMarshalableTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2242"></span><span id="boxedMarshalableTyCon"><span class="annot"><span class="annottext">boxedMarshalableTyCon :: TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#boxedMarshalableTyCon"><span class="hs-identifier hs-var hs-var">boxedMarshalableTyCon</span></a></span></span><span> </span><span id="local-6989586621681683823"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683823"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2243"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Unique] -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; [Unique] -&gt; Bool
</span><a href="GHC.Utils.Unique.html#anyOfUnique"><span class="hs-identifier hs-var">anyOfUnique</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683823"><span class="hs-identifier hs-var">tc</span></a></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#intTyConKey"><span class="hs-identifier hs-var">intTyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#int8TyConKey"><span class="hs-identifier hs-var">int8TyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#int16TyConKey"><span class="hs-identifier hs-var">int16TyConKey</span></a></span><span>
</span><span id="line-2244"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#int32TyConKey"><span class="hs-identifier hs-var">int32TyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#int64TyConKey"><span class="hs-identifier hs-var">int64TyConKey</span></a></span><span>
</span><span id="line-2245"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#wordTyConKey"><span class="hs-identifier hs-var">wordTyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#word8TyConKey"><span class="hs-identifier hs-var">word8TyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#word16TyConKey"><span class="hs-identifier hs-var">word16TyConKey</span></a></span><span>
</span><span id="line-2246"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#word32TyConKey"><span class="hs-identifier hs-var">word32TyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#word64TyConKey"><span class="hs-identifier hs-var">word64TyConKey</span></a></span><span>
</span><span id="line-2247"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#floatTyConKey"><span class="hs-identifier hs-var">floatTyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#doubleTyConKey"><span class="hs-identifier hs-var">doubleTyConKey</span></a></span><span>
</span><span id="line-2248"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#ptrTyConKey"><span class="hs-identifier hs-var">ptrTyConKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#funPtrTyConKey"><span class="hs-identifier hs-var">funPtrTyConKey</span></a></span><span>
</span><span id="line-2249"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#charTyConKey"><span class="hs-identifier hs-var">charTyConKey</span></a></span><span>
</span><span id="line-2250"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#stablePtrTyConKey"><span class="hs-identifier hs-var">stablePtrTyConKey</span></a></span><span>
</span><span id="line-2251"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#boolTyConKey"><span class="hs-identifier hs-var">boolTyConKey</span></a></span><span>
</span><span id="line-2252"></span><span>                         </span><span class="hs-special">]</span><span>
</span><span id="line-2253"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validity' TypeCannotBeMarshaledReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2254"></span><span>
</span><span id="line-2255"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
-&gt; Validity' TypeCannotBeMarshaledReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#NotABoxedMarshalableTyCon"><span class="hs-identifier hs-var">NotABoxedMarshalableTyCon</span></a></span><span>
</span><span id="line-2256"></span><span>
</span><span id="line-2257"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#legalFIPrimArgTyCon"><span class="hs-identifier hs-type">legalFIPrimArgTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2258"></span><span class="hs-comment">-- Check args of 'foreign import prim', only allow simple unlifted types.</span><span>
</span><span id="line-2259"></span><span id="legalFIPrimArgTyCon"><span class="annot"><span class="annottext">legalFIPrimArgTyCon :: DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFIPrimArgTyCon"><span class="hs-identifier hs-var hs-var">legalFIPrimArgTyCon</span></a></span></span><span> </span><span id="local-6989586621681683833"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683833"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681683834"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683834"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2260"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#marshalablePrimTyCon"><span class="hs-identifier hs-var">marshalablePrimTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683834"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2261"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#validIfUnliftedFFITypes"><span class="hs-identifier hs-var">validIfUnliftedFFITypes</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683833"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-2262"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2263"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
-&gt; Validity' TypeCannotBeMarshaledReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#NotSimpleUnliftedType"><span class="hs-identifier hs-var">NotSimpleUnliftedType</span></a></span><span>
</span><span id="line-2264"></span><span>
</span><span id="line-2265"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#legalFIPrimResultTyCon"><span class="hs-identifier hs-type">legalFIPrimResultTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2266"></span><span class="hs-comment">-- Check result type of 'foreign import prim'. Allow simple unlifted</span><span>
</span><span id="line-2267"></span><span class="hs-comment">-- types and also unboxed tuple and sum result types.</span><span>
</span><span id="line-2268"></span><span id="legalFIPrimResultTyCon"><span class="annot"><span class="annottext">legalFIPrimResultTyCon :: DynFlags -&gt; TyCon -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#legalFIPrimResultTyCon"><span class="hs-identifier hs-var hs-var">legalFIPrimResultTyCon</span></a></span></span><span> </span><span id="local-6989586621681683835"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683835"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681683836"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683836"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2269"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#marshalablePrimTyCon"><span class="hs-identifier hs-var">marshalablePrimTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683836"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2270"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PrimRep] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; TyCon -&gt; [PrimRep]
TyCon -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#tyConPrimRep"><span class="hs-identifier hs-var">tyConPrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683836"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Note [Marshalling void]</span><span>
</span><span id="line-2271"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#validIfUnliftedFFITypes"><span class="hs-identifier hs-var">validIfUnliftedFFITypes</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683835"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-2272"></span><span>
</span><span id="line-2273"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683836"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isUnboxedSumTyCon"><span class="hs-identifier hs-var">isUnboxedSumTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683836"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2274"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#validIfUnliftedFFITypes"><span class="hs-identifier hs-var">validIfUnliftedFFITypes</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683835"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-2275"></span><span>
</span><span id="line-2276"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2277"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
-&gt; Validity' TypeCannotBeMarshaledReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeCannotBeMarshaledReason
 -&gt; Validity' TypeCannotBeMarshaledReason)
-&gt; TypeCannotBeMarshaledReason
-&gt; Validity' TypeCannotBeMarshaledReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#NotSimpleUnliftedType"><span class="hs-identifier hs-var">NotSimpleUnliftedType</span></a></span><span>
</span><span id="line-2278"></span><span>
</span><span id="line-2279"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#validIfUnliftedFFITypes"><span class="hs-identifier hs-type">validIfUnliftedFFITypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#Validity%27"><span class="hs-identifier hs-type">Validity'</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeCannotBeMarshaledReason"><span class="hs-identifier hs-type">TypeCannotBeMarshaledReason</span></a></span><span>
</span><span id="line-2280"></span><span id="validIfUnliftedFFITypes"><span class="annot"><span class="annottext">validIfUnliftedFFITypes :: DynFlags -&gt; Validity' TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#validIfUnliftedFFITypes"><span class="hs-identifier hs-var hs-var">validIfUnliftedFFITypes</span></a></span></span><span> </span><span id="local-6989586621681683839"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683839"><span class="hs-identifier hs-var">dflags</span></a></span></span><span>
</span><span id="line-2281"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#xopt"><span class="hs-identifier hs-var">xopt</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.UnliftedFFITypes</span></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681683839"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Validity' TypeCannotBeMarshaledReason
forall a. Validity' a
</span><a href="GHC.Utils.Error.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span>
</span><span id="line-2282"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
-&gt; Validity' TypeCannotBeMarshaledReason
forall a. a -&gt; Validity' a
</span><a href="GHC.Utils.Error.html#NotValid"><span class="hs-identifier hs-var">NotValid</span></a></span><span> </span><span class="annot"><span class="annottext">TypeCannotBeMarshaledReason
</span><a href="GHC.Tc.Utils.TcType.html#UnliftedFFITypesNeeded"><span class="hs-identifier hs-var">UnliftedFFITypesNeeded</span></a></span><span>
</span><span id="line-2283"></span><span>
</span><span id="line-2284"></span><span class="hs-comment">{-
Note [Marshalling void]
~~~~~~~~~~~~~~~~~~~~~~~
We don't treat State# (whose PrimRep is VoidRep) as marshalable.
In turn that means you can't write
        foreign import foo :: Int -&gt; State# RealWorld

Reason: the back end falls over with panic &quot;primRepHint:VoidRep&quot;;
        and there is no compelling reason to permit it
-}</span><span>
</span><span id="line-2294"></span><span>
</span><span id="line-2295"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Visiblities
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2302"></span><span>
</span><span id="line-2303"></span><span class="hs-comment">-- | For every arg a tycon can take, the returned list says True if the argument</span><span>
</span><span id="line-2304"></span><span class="hs-comment">-- is taken visibly, and False otherwise. Ends with an infinite tail of Trues to</span><span>
</span><span id="line-2305"></span><span class="hs-comment">-- allow for oversaturation.</span><span>
</span><span id="line-2306"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcTyConVisibilities"><span class="hs-identifier hs-type">tcTyConVisibilities</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span>
</span><span id="line-2307"></span><span id="tcTyConVisibilities"><span class="annot"><span class="annottext">tcTyConVisibilities :: TyCon -&gt; [Bool]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConVisibilities"><span class="hs-identifier hs-var hs-var">tcTyConVisibilities</span></a></span></span><span> </span><span id="local-6989586621681683842"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683842"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681683843"><span class="hs-identifier hs-var">tc_binder_viss</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681683844"><span class="hs-identifier hs-var">tc_return_kind_viss</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#repeat/GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2308"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2309"></span><span>    </span><span id="local-6989586621681683843"><span class="annot"><span class="annottext">tc_binder_viss :: [Bool]
</span><a href="#local-6989586621681683843"><span class="hs-identifier hs-var hs-var">tc_binder_viss</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBndr TyVar TyConBndrVis -&gt; Bool)
-&gt; [VarBndr TyVar TyConBndrVis] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">VarBndr TyVar TyConBndrVis -&gt; Bool
forall tv. VarBndr tv TyConBndrVis -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isVisibleTyConBinder"><span class="hs-identifier hs-var">isVisibleTyConBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [VarBndr TyVar TyConBndrVis]
</span><a href="GHC.Core.TyCon.html#tyConBinders"><span class="hs-identifier hs-var">tyConBinders</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683842"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2310"></span><span>    </span><span id="local-6989586621681683844"><span class="annot"><span class="annottext">tc_return_kind_viss :: [Bool]
</span><a href="#local-6989586621681683844"><span class="hs-identifier hs-var hs-var">tc_return_kind_viss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PiTyVarBinder -&gt; Bool) -&gt; [PiTyVarBinder] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PiTyVarBinder -&gt; Bool
</span><a href="GHC.Types.Var.html#isVisiblePiTyBinder"><span class="hs-identifier hs-var">isVisiblePiTyBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([PiTyVarBinder], Type) -&gt; [PiTyVarBinder]
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(([PiTyVarBinder], Type) -&gt; [PiTyVarBinder])
-&gt; ([PiTyVarBinder], Type) -&gt; [PiTyVarBinder]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([PiTyVarBinder], Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTys"><span class="hs-identifier hs-var">tcSplitPiTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConResKind"><span class="hs-identifier hs-var">tyConResKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683842"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2311"></span><span>
</span><span id="line-2312"></span><span class="annot"><span class="hs-comment">-- | If the tycon is applied to the types, is the next argument visible?</span></span><span>
</span><span id="line-2313"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isNextTyConArgVisible"><span class="hs-identifier hs-type">isNextTyConArgVisible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2314"></span><span id="isNextTyConArgVisible"><span class="annot"><span class="annottext">isNextTyConArgVisible :: TyCon -&gt; [Type] -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isNextTyConArgVisible"><span class="hs-identifier hs-var hs-var">isNextTyConArgVisible</span></a></span></span><span> </span><span id="local-6989586621681683848"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683848"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681683849"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683849"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2315"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Bool]
</span><a href="GHC.Tc.Utils.TcType.html#tcTyConVisibilities"><span class="hs-identifier hs-var">tcTyConVisibilities</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683848"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Int -&gt; Bool
forall a. Outputable a =&gt; [a] -&gt; Int -&gt; a
</span><a href="GHC.Data.List.SetOps.html#getNth"><span class="hs-operator hs-var">`getNth`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#length/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683849"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2316"></span><span>
</span><span id="line-2317"></span><span class="annot"><span class="hs-comment">-- | Should this type be applied to a visible argument?</span></span><span>
</span><span id="line-2318"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isNextArgVisible"><span class="hs-identifier hs-type">isNextArgVisible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2319"></span><span id="isNextArgVisible"><span class="annot"><span class="annottext">isNextArgVisible :: Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isNextArgVisible"><span class="hs-identifier hs-var hs-var">isNextArgVisible</span></a></span></span><span> </span><span id="local-6989586621681683851"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683851"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-2320"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683852"><span class="annot"><span class="annottext">PiTyVarBinder
</span><a href="#local-6989586621681683852"><span class="hs-identifier hs-var">bndr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (PiTyVarBinder, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitPiTy_maybe"><span class="hs-identifier hs-var">tcSplitPiTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683851"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PiTyVarBinder -&gt; Bool
</span><a href="GHC.Types.Var.html#isVisiblePiTyBinder"><span class="hs-identifier hs-var">isVisiblePiTyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">PiTyVarBinder
</span><a href="#local-6989586621681683852"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-2321"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2322"></span><span>    </span><span class="hs-comment">-- this second case might happen if, say, we have an unzonked TauTv.</span><span>
</span><span id="line-2323"></span><span>    </span><span class="hs-comment">-- But TauTvs can't range over types that take invisible arguments</span><span>
</span><span id="line-2324"></span><span>
</span><span id="line-2325"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                     Paterson sizes
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2332"></span><span>
</span><span id="line-2333"></span><span class="hs-comment">{- Note [The PatersonSize of a type]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The PatersonSize of type is something we can compare, with `ltPatersonSize`,
to determine if the Paterson conditions are satisfied for an instance
declaration.  See Note [Paterson conditions] in GHC.Tc.Validity.

There are some wrinkles

(PS1) Once we get into an implicit parameter or equality we
      can't get back to a class constraint, so it's safe
      to say &quot;size 0&quot;.  See #4200.

      We do this with isTerminatingClass

Note [Invisible arguments and termination]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When checking the &#8203;Paterson conditions for termination an instance
declaration, we check for the number of &quot;constructors and variables&quot;
in the instance head and constraints. Question: Do we look at

 * All the arguments, visible or invisible?
 * Just the visible arguments?

I think both will ensure termination, provided we are consistent.
Currently we are /not/ consistent, which is really a bug.  It's
described in #15177, which contains a number of examples.
The suspicious bits are the calls to filterOutInvisibleTypes.
See also #11833.

Note [Stuck type families]
~~~~~~~~~~~~~~~~~~~~~~~~~~
A type-family application generally has infinite size (PS_TyFam);
see (PC3) in Note [Paterson conditions] in GHC.Tc.Validity.

But a couple of built-in type families have no axioms, and can never
expand into anything else.  They are:

* (TypeError &quot;stuff&quot;).  E.g. consider

     type family F a where
       F Int  = Bool
       F Bool = Char
       F _    = TypeError &quot;Bad&quot;

  We don't want to complain about possible non-termination of F, in
  GHC.Tc.Validity.checkFamInstRhs.  cf indexed-types/should_fail/T13271

* (Any @k).

For now we treat them as being size zero, but (#22696) I think we should
actually treat them as big (like any other ype family) because we don't
want to abstract over them in e.g. validDerivPred.

The type-family termination test, in GHC.Tc.Validity.checkFamInstRhs, already
has a separate call to isStuckTypeFamily, so the `F` above will still be accepted.
-}</span><span>
</span><span id="line-2389"></span><span>
</span><span id="line-2390"></span><span>
</span><span id="line-2391"></span><span class="hs-comment">-- | Why was the LHS 'PatersonSize' not strictly smaller than the RHS 'PatersonSize'?</span><span>
</span><span id="line-2392"></span><span class="hs-comment">--</span><span>
</span><span id="line-2393"></span><span class="hs-comment">-- See Note [Paterson conditions] in GHC.Tc.Validity.</span><span>
</span><span id="line-2394"></span><span class="hs-keyword">data</span><span> </span><span id="PatersonSizeFailure"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSizeFailure"><span class="hs-identifier hs-var">PatersonSizeFailure</span></a></span></span><span>
</span><span id="line-2395"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Either side contains a type family.</span></span><span>
</span><span id="line-2396"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PSF_TyFam"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PSF_TyFam"><span class="hs-identifier hs-var">PSF_TyFam</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-2397"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The size of the LHS is not strictly less than the size of the RHS.</span></span><span>
</span><span id="line-2398"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PSF_Size"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PSF_Size"><span class="hs-identifier hs-var">PSF_Size</span></a></span></span><span>
</span><span id="line-2399"></span><span>  </span><span class="annot"><span class="hs-comment">-- | These type variables appear more often in the LHS than in the RHS.</span></span><span>
</span><span id="line-2400"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PSF_TyVar"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PSF_TyVar"><span class="hs-identifier hs-var">PSF_TyVar</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^  no duplicates in this list</span></span><span>
</span><span id="line-2401"></span><span>
</span><span id="line-2402"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-2403"></span><span>
</span><span id="line-2404"></span><span class="hs-comment">-- | The Paterson size of a given type, in the sense of</span><span>
</span><span id="line-2405"></span><span class="hs-comment">-- Note [Paterson conditions] in GHC.Tc.Validity</span><span>
</span><span id="line-2406"></span><span class="hs-comment">--</span><span>
</span><span id="line-2407"></span><span class="hs-comment">--   - after expanding synonyms,</span><span>
</span><span id="line-2408"></span><span class="hs-comment">--   - ignoring coercions (as they are not user written).</span><span>
</span><span id="line-2409"></span><span class="hs-keyword">data</span><span> </span><span id="PatersonSize"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-var">PatersonSize</span></a></span></span><span>
</span><span id="line-2410"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The type mentions a type family, so the size could be anything.</span></span><span>
</span><span id="line-2411"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PS_TyFam"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_TyFam"><span class="hs-identifier hs-var">PS_TyFam</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-2412"></span><span>
</span><span id="line-2413"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The type does not mention a type family.</span></span><span>
</span><span id="line-2414"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PS_Vanilla"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-var">PS_Vanilla</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="ps_tvs"><span class="annot"><span class="annottext">PatersonSize -&gt; [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var hs-var">ps_tvs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ free tyvars, including repetitions;</span></span><span>
</span><span id="line-2415"></span><span>               </span><span class="hs-special">,</span><span> </span><span id="ps_size"><span class="annot"><span class="annottext">PatersonSize -&gt; Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var hs-var">ps_size</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ number of type constructors and variables</span></span><span>
</span><span id="line-2416"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-2417"></span><span>  </span><span class="hs-comment">-- ToDo: ignore invisible arguments?  See Note [Invisible arguments and termination]</span><span>
</span><span id="line-2418"></span><span>
</span><span id="line-2419"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2420"></span><span>  </span><span id="local-6989586621681683879"><span class="annot"><span class="annottext">ppr :: PatersonSize -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_TyFam"><span class="hs-identifier hs-type">PS_TyFam</span></a></span><span> </span><span id="local-6989586621681683880"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683880"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PS_TyFam&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683880"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2421"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: PatersonSize -&gt; [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683881"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683881"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: PatersonSize -&gt; Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683882"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683882"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2422"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PS_Vanilla&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ps_tvs =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683881"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span>
</span><span id="line-2423"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ps_size =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall doc. IsLine doc =&gt; Int -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683882"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2424"></span><span>
</span><span id="line-2425"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeZero"><span class="hs-identifier hs-type">pSizeZero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeOne"><span class="hs-identifier hs-type">pSizeOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2426"></span><span id="pSizeZero"><span class="annot"><span class="annottext">pSizeZero :: PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeZero"><span class="hs-identifier hs-var hs-var">pSizeZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2427"></span><span id="pSizeOne"><span class="annot"><span class="annottext">pSizeOne :: PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeOne"><span class="hs-identifier hs-var hs-var">pSizeOne</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2428"></span><span>
</span><span id="line-2429"></span><span class="hs-comment">-- | @ltPatersonSize ps1 ps2@ returns:</span><span>
</span><span id="line-2430"></span><span class="hs-comment">--</span><span>
</span><span id="line-2431"></span><span class="hs-comment">--  - @Nothing@ iff @ps1@ is definitely strictly smaller than @ps2@,</span><span>
</span><span id="line-2432"></span><span class="hs-comment">--  - @Just ps_fail@ otherwise; @ps_fail@ says what went wrong.</span><span>
</span><span id="line-2433"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ltPatersonSize"><span class="hs-identifier hs-type">ltPatersonSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2434"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2435"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSizeFailure"><span class="hs-identifier hs-type">PatersonSizeFailure</span></a></span><span>
</span><span id="line-2436"></span><span id="ltPatersonSize"><span class="annot"><span class="annottext">ltPatersonSize :: PatersonSize -&gt; PatersonSize -&gt; Maybe PatersonSizeFailure
</span><a href="GHC.Tc.Utils.TcType.html#ltPatersonSize"><span class="hs-identifier hs-var hs-var">ltPatersonSize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: PatersonSize -&gt; [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683885"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683885"><span class="hs-identifier hs-var">tvs1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: PatersonSize -&gt; Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683886"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683886"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2437"></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: PatersonSize -&gt; [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683887"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683887"><span class="hs-identifier hs-var">tvs2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: PatersonSize -&gt; Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683888"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683888"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2438"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683886"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683888"><span class="hs-identifier hs-var">s2</span></a></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSizeFailure -&gt; Maybe PatersonSizeFailure
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSizeFailure
</span><a href="GHC.Tc.Utils.TcType.html#PSF_Size"><span class="hs-identifier hs-var">PSF_Size</span></a></span><span>
</span><span id="line-2439"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681683889"><span class="annot"><span class="annottext">bad_tvs :: [TyVar]
</span><a href="#local-6989586621681683889"><span class="hs-identifier hs-var">bad_tvs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar] -&gt; [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#noMoreTyVars"><span class="hs-identifier hs-var">noMoreTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683885"><span class="hs-identifier hs-var">tvs1</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683887"><span class="hs-identifier hs-var">tvs2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSizeFailure -&gt; Maybe PatersonSizeFailure
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; PatersonSizeFailure
</span><a href="GHC.Tc.Utils.TcType.html#PSF_TyVar"><span class="hs-identifier hs-var">PSF_TyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683889"><span class="hs-identifier hs-var">bad_tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2440"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PatersonSizeFailure
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-comment">-- OK!</span><span>
</span><span id="line-2441"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ltPatersonSize"><span class="hs-identifier hs-var">ltPatersonSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_TyFam"><span class="hs-identifier hs-type">PS_TyFam</span></a></span><span> </span><span id="local-6989586621681683890"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683890"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSizeFailure -&gt; Maybe PatersonSizeFailure
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; PatersonSizeFailure
</span><a href="GHC.Tc.Utils.TcType.html#PSF_TyFam"><span class="hs-identifier hs-var">PSF_TyFam</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683890"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2442"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ltPatersonSize"><span class="hs-identifier hs-var">ltPatersonSize</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_TyFam"><span class="hs-identifier hs-type">PS_TyFam</span></a></span><span> </span><span id="local-6989586621681683891"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683891"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSizeFailure -&gt; Maybe PatersonSizeFailure
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; PatersonSizeFailure
</span><a href="GHC.Tc.Utils.TcType.html#PSF_TyFam"><span class="hs-identifier hs-var">PSF_TyFam</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683891"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2443"></span><span>  </span><span class="hs-comment">-- NB: this last equation is never taken when checking instances, because</span><span>
</span><span id="line-2444"></span><span>  </span><span class="hs-comment">-- type families are disallowed in instance heads.</span><span>
</span><span id="line-2445"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-2446"></span><span>  </span><span class="hs-comment">-- However, this function is also used in the logic for solving superclass</span><span>
</span><span id="line-2447"></span><span>  </span><span class="hs-comment">-- constraints (see Note [Solving superclass constraints] in GHC.Tc.TyCl.Instance),</span><span>
</span><span id="line-2448"></span><span>  </span><span class="hs-comment">-- in which case we might well hit this case (see e.g. T23171).</span><span>
</span><span id="line-2449"></span><span>
</span><span id="line-2450"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#noMoreTyVars"><span class="hs-identifier hs-type">noMoreTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Free vars (with repetitions) of the constraint C</span><span>
</span><span id="line-2451"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Free vars (with repetitions) of the head H</span><span>
</span><span id="line-2452"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- TyVars that appear more often in C than H;</span><span>
</span><span id="line-2453"></span><span>                         </span><span class="hs-comment">--   no repetitions in this list</span><span>
</span><span id="line-2454"></span><span id="noMoreTyVars"><span class="annot"><span class="annottext">noMoreTyVars :: [TyVar] -&gt; [TyVar] -&gt; [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#noMoreTyVars"><span class="hs-identifier hs-var hs-var">noMoreTyVars</span></a></span></span><span> </span><span id="local-6989586621681683892"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683892"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681683893"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683893"><span class="hs-identifier hs-var">head_tvs</span></a></span></span><span>
</span><span id="line-2455"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/Data.OldList.html#nub/Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683892"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar] -&gt; [TyVar]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/Data.OldList.html#%5C%5C/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683893"><span class="hs-identifier hs-var">head_tvs</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- The (\\) is list difference; e.g.</span><span>
</span><span id="line-2456"></span><span>                           </span><span class="hs-comment">--   [a,b,a,a] \\ [a,a] = [b,a]</span><span>
</span><span id="line-2457"></span><span>                           </span><span class="hs-comment">-- So we are counting repetitions</span><span>
</span><span id="line-2458"></span><span>
</span><span id="line-2459"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-identifier hs-type">addPSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2460"></span><span id="addPSize"><span class="annot"><span class="annottext">addPSize :: PatersonSize -&gt; PatersonSize -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-identifier hs-var hs-var">addPSize</span></a></span></span><span> </span><span id="local-6989586621681683895"><span class="annot"><span class="annottext">ps1 :: PatersonSize
</span><a href="#local-6989586621681683895"><span class="hs-identifier hs-var">ps1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_TyFam"><span class="hs-identifier hs-type">PS_TyFam</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="#local-6989586621681683895"><span class="hs-identifier hs-var">ps1</span></a></span><span>
</span><span id="line-2461"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-identifier hs-var">addPSize</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683896"><span class="annot"><span class="annottext">ps2 :: PatersonSize
</span><a href="#local-6989586621681683896"><span class="hs-identifier hs-var">ps2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_TyFam"><span class="hs-identifier hs-type">PS_TyFam</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="#local-6989586621681683896"><span class="hs-identifier hs-var">ps2</span></a></span><span>
</span><span id="line-2462"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-identifier hs-var">addPSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: PatersonSize -&gt; [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683897"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683897"><span class="hs-identifier hs-var">tvs1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: PatersonSize -&gt; Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683898"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683898"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2463"></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: PatersonSize -&gt; [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683899"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683899"><span class="hs-identifier hs-var">tvs2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: PatersonSize -&gt; Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683900"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683900"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2464"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683897"><span class="hs-identifier hs-var">tvs1</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar] -&gt; [TyVar]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621681683899"><span class="hs-identifier hs-var">tvs2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683898"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.3.0/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683900"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2465"></span><span>    </span><span class="hs-comment">-- (++) is not very performant, but the types</span><span>
</span><span id="line-2466"></span><span>    </span><span class="hs-comment">-- are user-written and never large</span><span>
</span><span id="line-2467"></span><span>
</span><span id="line-2468"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeType"><span class="hs-identifier hs-type">pSizeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2469"></span><span id="pSizeType"><span class="annot"><span class="annottext">pSizeType :: Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeType"><span class="hs-identifier hs-var hs-var">pSizeType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-2470"></span><span>
</span><span id="line-2471"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypes"><span class="hs-identifier hs-type">pSizeTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2472"></span><span id="pSizeTypes"><span class="annot"><span class="annottext">pSizeTypes :: [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypes"><span class="hs-identifier hs-var hs-var">pSizeTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; PatersonSize -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypesX"><span class="hs-identifier hs-var">pSizeTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeZero"><span class="hs-identifier hs-var">pSizeZero</span></a></span><span>
</span><span id="line-2473"></span><span>
</span><span id="line-2474"></span><span class="hs-comment">-- Paterson size of a type, retaining repetitions, and expanding synonyms</span><span>
</span><span id="line-2475"></span><span class="hs-comment">-- This ignores coercions, as coercions aren't user-written</span><span>
</span><span id="line-2476"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-type">pSizeTypeX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2477"></span><span id="pSizeTypeX"><span class="annot"><span class="annottext">pSizeTypeX :: VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var hs-var">pSizeTypeX</span></a></span></span><span> </span><span id="local-6989586621681683902"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683902"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span id="local-6989586621681683903"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683903"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683904"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683904"><span class="hs-identifier hs-var">exp_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683903"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683902"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683904"><span class="hs-identifier hs-var">exp_ty</span></a></span><span>
</span><span id="line-2478"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span id="local-6989586621681683905"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683905"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621681683906"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683906"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2479"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683906"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683905"><span class="hs-identifier hs-var">bvs</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeOne"><span class="hs-identifier hs-var">pSizeOne</span></a></span><span>
</span><span id="line-2480"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_tvs :: [TyVar]
</span><a href="GHC.Tc.Utils.TcType.html#ps_tvs"><span class="hs-identifier hs-var">ps_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683906"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ps_size :: Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2481"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeOne"><span class="hs-identifier hs-var">pSizeOne</span></a></span><span>
</span><span id="line-2482"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span id="local-6989586621681683907"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683907"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681683908"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683908"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681683909"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683909"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TyCon -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTyConAppX"><span class="hs-identifier hs-var">pSizeTyConAppX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683907"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683908"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683909"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2483"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span id="local-6989586621681683911"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683911"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621681683912"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683912"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681683913"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683913"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683911"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683912"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSize -&gt; PatersonSize -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-operator hs-var">`addPSize`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683911"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683913"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2484"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span id="local-6989586621681683914"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683914"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681683915"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683915"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681683916"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683916"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681683917"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683917"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683914"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683915"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSize -&gt; PatersonSize -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-operator hs-var">`addPSize`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683914"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683916"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSize -&gt; PatersonSize -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-operator hs-var">`addPSize`</span></a></span><span>
</span><span id="line-2485"></span><span>                                           </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683914"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683917"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-2486"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span id="local-6989586621681683918"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683918"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621681683919"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683919"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681683920"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683920"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683918"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVar -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683919"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PatersonSize -&gt; PatersonSize -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-operator hs-var">`addPSize`</span></a></span><span>
</span><span id="line-2487"></span><span>                                           </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683918"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TyVar -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683919"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683920"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2488"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span id="local-6989586621681683921"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683921"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621681683922"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683922"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683921"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683922"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2489"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeOne"><span class="hs-identifier hs-var">pSizeOne</span></a></span><span>
</span><span id="line-2490"></span><span>
</span><span id="line-2491"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTypesX"><span class="hs-identifier hs-type">pSizeTypesX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2492"></span><span id="pSizeTypesX"><span class="annot"><span class="annottext">pSizeTypesX :: VarSet -&gt; PatersonSize -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypesX"><span class="hs-identifier hs-var hs-var">pSizeTypesX</span></a></span></span><span> </span><span id="local-6989586621681683923"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683923"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span id="local-6989586621681683924"><span class="annot"><span class="annottext">PatersonSize
</span><a href="#local-6989586621681683924"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621681683925"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683925"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; PatersonSize -&gt; PatersonSize)
-&gt; PatersonSize -&gt; [Type] -&gt; PatersonSize
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatersonSize -&gt; PatersonSize -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-identifier hs-var">addPSize</span></a></span><span> </span><span class="annot"><span class="annottext">(PatersonSize -&gt; PatersonSize -&gt; PatersonSize)
-&gt; (Type -&gt; PatersonSize) -&gt; Type -&gt; PatersonSize -&gt; PatersonSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypeX"><span class="hs-identifier hs-var">pSizeTypeX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683923"><span class="hs-identifier hs-var">bvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="#local-6989586621681683924"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683925"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2493"></span><span>
</span><span id="line-2494"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTyConApp"><span class="hs-identifier hs-type">pSizeTyConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2495"></span><span id="pSizeTyConApp"><span class="annot"><span class="annottext">pSizeTyConApp :: TyCon -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTyConApp"><span class="hs-identifier hs-var hs-var">pSizeTyConApp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TyCon -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTyConAppX"><span class="hs-identifier hs-var">pSizeTyConAppX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-2496"></span><span>
</span><span id="line-2497"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTyConAppX"><span class="hs-identifier hs-type">pSizeTyConAppX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2498"></span><span class="hs-comment">-- Open question: do we count all args, or just the visible ones?</span><span>
</span><span id="line-2499"></span><span class="hs-comment">-- See Note [Invisible arguments and termination]</span><span>
</span><span id="line-2500"></span><span id="pSizeTyConAppX"><span class="annot"><span class="annottext">pSizeTyConAppX :: VarSet -&gt; TyCon -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTyConAppX"><span class="hs-identifier hs-var hs-var">pSizeTyConAppX</span></a></span></span><span> </span><span id="local-6989586621681683926"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683926"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span id="local-6989586621681683927"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683927"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681683928"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683928"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2501"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683927"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTyFamApp"><span class="hs-identifier hs-var">pSizeTyFamApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683927"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2502"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; PatersonSize -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypesX"><span class="hs-identifier hs-var">pSizeTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683926"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeOne"><span class="hs-identifier hs-var">pSizeOne</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683928"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2503"></span><span>
</span><span id="line-2504"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeTyFamApp"><span class="hs-identifier hs-type">pSizeTyFamApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2505"></span><span class="hs-comment">-- See Note [Stuck type families]</span><span>
</span><span id="line-2506"></span><span id="pSizeTyFamApp"><span class="annot"><span class="annottext">pSizeTyFamApp :: TyCon -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTyFamApp"><span class="hs-identifier hs-var hs-var">pSizeTyFamApp</span></a></span></span><span> </span><span id="local-6989586621681683930"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683930"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2507"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isStuckTypeFamily"><span class="hs-identifier hs-var">isStuckTypeFamily</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683930"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeZero"><span class="hs-identifier hs-var">pSizeZero</span></a></span><span>
</span><span id="line-2508"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#PS_TyFam"><span class="hs-identifier hs-var">PS_TyFam</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683930"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2509"></span><span>
</span><span id="line-2510"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeClassPred"><span class="hs-identifier hs-type">pSizeClassPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2511"></span><span id="pSizeClassPred"><span class="annot"><span class="annottext">pSizeClassPred :: Class -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeClassPred"><span class="hs-identifier hs-var hs-var">pSizeClassPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Class -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeClassPredX"><span class="hs-identifier hs-var">pSizeClassPredX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-2512"></span><span>
</span><span id="line-2513"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#pSizeClassPredX"><span class="hs-identifier hs-type">pSizeClassPredX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span>
</span><span id="line-2514"></span><span id="pSizeClassPredX"><span class="annot"><span class="annottext">pSizeClassPredX :: VarSet -&gt; Class -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeClassPredX"><span class="hs-identifier hs-var hs-var">pSizeClassPredX</span></a></span></span><span> </span><span id="local-6989586621681683931"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683931"><span class="hs-identifier hs-var">bvs</span></a></span></span><span> </span><span id="local-6989586621681683932"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683932"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621681683933"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683933"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2515"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Class -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTerminatingClass"><span class="hs-identifier hs-var">isTerminatingClass</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683932"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="hs-comment">-- See (PS1) in Note [The PatersonSize of a type]</span><span>
</span><span id="line-2516"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeZero"><span class="hs-identifier hs-var">pSizeZero</span></a></span><span>
</span><span id="line-2517"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-2518"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; PatersonSize -&gt; [Type] -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeTypesX"><span class="hs-identifier hs-var">pSizeTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683931"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeOne"><span class="hs-identifier hs-var">pSizeOne</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; PatersonSize) -&gt; [Type] -&gt; PatersonSize
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2519"></span><span>    </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; TyCon
</span><a href="GHC.Core.Class.html#classTyCon"><span class="hs-identifier hs-var">classTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683932"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683933"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2520"></span><span>    </span><span class="hs-comment">-- filterOutInvisibleTypes Yuk!  See Note [Invisible arguments and termination]</span><span>
</span><span id="line-2521"></span><span>
</span><span id="line-2522"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isStuckTypeFamily"><span class="hs-identifier hs-type">isStuckTypeFamily</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2523"></span><span class="hs-comment">-- See Note [Stuck type families]</span><span>
</span><span id="line-2524"></span><span id="isStuckTypeFamily"><span class="annot"><span class="annottext">isStuckTypeFamily :: TyCon -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isStuckTypeFamily"><span class="hs-identifier hs-var hs-var">isStuckTypeFamily</span></a></span></span><span> </span><span id="local-6989586621681683934"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683934"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-2525"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683934"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#errorMessageTypeErrorFamKey"><span class="hs-identifier hs-var">errorMessageTypeErrorFamKey</span></a></span><span>
</span><span id="line-2526"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681683934"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#anyTyConKey"><span class="hs-identifier hs-var">anyTyConKey</span></a></span><span>
</span><span id="line-2527"></span><span>
</span><span id="line-2528"></span><span class="hs-comment">-- | When this says &quot;True&quot;, ignore this class constraint during</span><span>
</span><span id="line-2529"></span><span class="hs-comment">-- a termination check</span><span>
</span><span id="line-2530"></span><span class="hs-comment">-- See (PS1) in Note [The PatersonSize of a type]</span><span>
</span><span id="line-2531"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTerminatingClass"><span class="hs-identifier hs-type">isTerminatingClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Class.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2532"></span><span id="isTerminatingClass"><span class="annot"><span class="annottext">isTerminatingClass :: Class -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTerminatingClass"><span class="hs-identifier hs-var hs-var">isTerminatingClass</span></a></span></span><span> </span><span id="local-6989586621681683936"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683936"><span class="hs-identifier hs-var">cls</span></a></span></span><span>
</span><span id="line-2533"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; Bool
</span><a href="GHC.Core.Predicate.html#isIPClass"><span class="hs-identifier hs-var">isIPClass</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683936"><span class="hs-identifier hs-var">cls</span></a></span><span>    </span><span class="hs-comment">-- Implicit parameter constraints always terminate because</span><span>
</span><span id="line-2534"></span><span>                     </span><span class="hs-comment">-- there are no instances for them --- they are only solved</span><span>
</span><span id="line-2535"></span><span>                     </span><span class="hs-comment">-- by &quot;local instances&quot; in expressions</span><span>
</span><span id="line-2536"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Class -&gt; Bool
</span><a href="GHC.Core.Predicate.html#isEqPredClass"><span class="hs-identifier hs-var">isEqPredClass</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683936"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-2537"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683936"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Class -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#typeableClassKey"><span class="hs-identifier hs-var">typeableClassKey</span></a></span><span>
</span><span id="line-2538"></span><span>            </span><span class="hs-comment">-- Typeable constraints are bigger than they appear due</span><span>
</span><span id="line-2539"></span><span>            </span><span class="hs-comment">-- to kind polymorphism, but we can never get instance divergence this way</span><span>
</span><span id="line-2540"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621681683936"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Class -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#coercibleTyConKey"><span class="hs-identifier hs-var">coercibleTyConKey</span></a></span><span>
</span><span id="line-2541"></span><span>
</span><span id="line-2542"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#allDistinctTyVars"><span class="hs-identifier hs-type">allDistinctTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2543"></span><span class="hs-comment">-- (allDistinctTyVars tvs tys) returns True if tys are</span><span>
</span><span id="line-2544"></span><span class="hs-comment">-- a) all tyvars</span><span>
</span><span id="line-2545"></span><span class="hs-comment">-- b) all distinct</span><span>
</span><span id="line-2546"></span><span class="hs-comment">-- c) disjoint from tvs</span><span>
</span><span id="line-2547"></span><span id="allDistinctTyVars"><span class="annot"><span class="annottext">allDistinctTyVars :: VarSet -&gt; [Type] -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#allDistinctTyVars"><span class="hs-identifier hs-var hs-var">allDistinctTyVars</span></a></span></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2548"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#allDistinctTyVars"><span class="hs-identifier hs-var">allDistinctTyVars</span></a></span><span> </span><span id="local-6989586621681683940"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683940"><span class="hs-identifier hs-var">tkvs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681683941"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683941"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681683942"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683942"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2549"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyVar
</span><a href="GHC.Core.Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683941"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2550"></span><span>      </span><span class="annot"><span class="annottext">Maybe TyVar
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2551"></span><span>      </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681683943"><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683943"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683943"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683940"><span class="hs-identifier hs-var">tkvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2552"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; [Type] -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#allDistinctTyVars"><span class="hs-identifier hs-var">allDistinctTyVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681683940"><span class="hs-identifier hs-var">tkvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TyVar -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TyVar
</span><a href="#local-6989586621681683943"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683942"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2553"></span><span>
</span><span id="line-2554"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-2555"></span><span class="hs-keyword">type</span><span> </span><span id="TypeSize"><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeSize"><span class="hs-identifier hs-var">TypeSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#IntWithInf"><span class="hs-identifier hs-type">IntWithInf</span></a></span><span>
</span><span id="line-2556"></span><span>
</span><span id="line-2557"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#sizeType"><span class="hs-identifier hs-type">sizeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeSize"><span class="hs-identifier hs-type">TypeSize</span></a></span><span>
</span><span id="line-2558"></span><span class="hs-comment">-- Size of a type: the number of variables and constructors</span><span>
</span><span id="line-2559"></span><span id="sizeType"><span class="annot"><span class="annottext">sizeType :: Type -&gt; TypeSize
</span><a href="GHC.Tc.Utils.TcType.html#sizeType"><span class="hs-identifier hs-var hs-var">sizeType</span></a></span></span><span> </span><span id="local-6989586621681683945"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683945"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize -&gt; TypeSize
</span><a href="GHC.Tc.Utils.TcType.html#toTypeSize"><span class="hs-identifier hs-var">toTypeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeType"><span class="hs-identifier hs-var">pSizeType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681683945"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2560"></span><span>
</span><span id="line-2561"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#sizeTypes"><span class="hs-identifier hs-type">sizeTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeSize"><span class="hs-identifier hs-type">TypeSize</span></a></span><span>
</span><span id="line-2562"></span><span id="sizeTypes"><span class="annot"><span class="annottext">sizeTypes :: [Type] -&gt; TypeSize
</span><a href="GHC.Tc.Utils.TcType.html#sizeTypes"><span class="hs-identifier hs-var hs-var">sizeTypes</span></a></span></span><span> </span><span id="local-6989586621681683947"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683947"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatersonSize -&gt; TypeSize
</span><a href="GHC.Tc.Utils.TcType.html#toTypeSize"><span class="hs-identifier hs-var">toTypeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; PatersonSize -&gt; PatersonSize)
-&gt; PatersonSize -&gt; [Type] -&gt; PatersonSize
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatersonSize -&gt; PatersonSize -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#addPSize"><span class="hs-identifier hs-var">addPSize</span></a></span><span> </span><span class="annot"><span class="annottext">(PatersonSize -&gt; PatersonSize -&gt; PatersonSize)
-&gt; (Type -&gt; PatersonSize) -&gt; Type -&gt; PatersonSize -&gt; PatersonSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeType"><span class="hs-identifier hs-var">pSizeType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PatersonSize
</span><a href="GHC.Tc.Utils.TcType.html#pSizeZero"><span class="hs-identifier hs-var">pSizeZero</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681683947"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2563"></span><span>
</span><span id="line-2564"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#toTypeSize"><span class="hs-identifier hs-type">toTypeSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PatersonSize"><span class="hs-identifier hs-type">PatersonSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TypeSize"><span class="hs-identifier hs-type">TypeSize</span></a></span><span>
</span><span id="line-2565"></span><span id="toTypeSize"><span class="annot"><span class="annottext">toTypeSize :: PatersonSize -&gt; TypeSize
</span><a href="GHC.Tc.Utils.TcType.html#toTypeSize"><span class="hs-identifier hs-var hs-var">toTypeSize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_TyFam"><span class="hs-identifier hs-type">PS_TyFam</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">TypeSize
</span><a href="GHC.Types.Basic.html#infinity"><span class="hs-identifier hs-var">infinity</span></a></span><span>
</span><span id="line-2566"></span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#toTypeSize"><span class="hs-identifier hs-var">toTypeSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#PS_Vanilla"><span class="hs-identifier hs-type">PS_Vanilla</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ps_size :: PatersonSize -&gt; Int
</span><a href="GHC.Tc.Utils.TcType.html#ps_size"><span class="hs-identifier hs-var">ps_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681683949"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683949"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; TypeSize
</span><a href="GHC.Types.Basic.html#mkIntWithInf"><span class="hs-identifier hs-var">mkIntWithInf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681683949"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-2567"></span></pre></body></html>