<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Code generator utilities; mostly monadic</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- (c) The University of Glasgow 2004-2006</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.StgToCmm.TagCheck</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#emitTagAssertion"><span class="hs-identifier">emitTagAssertion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#emitArgTagCheck"><span class="hs-identifier">emitArgTagCheck</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkArg"><span class="hs-identifier">checkArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier">whenCheckTags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkArgStatic"><span class="hs-identifier">checkArgStatic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkFunctionArgTags"><span class="hs-identifier">checkFunctionArgTags</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkConArgsStatic"><span class="hs-identifier">checkConArgsStatic</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkConArgsDyn"><span class="hs-identifier">checkConArgsDyn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;ClosureTypes.h&quot;
</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Env.html"><span class="hs-identifier">GHC.StgToCmm.Env</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html"><span class="hs-identifier">GHC.StgToCmm.Monad</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Utils.html"><span class="hs-identifier">GHC.StgToCmm.Utils</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.html"><span class="hs-identifier">GHC.Cmm</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html"><span class="hs-identifier">GHC.Cmm.BlockId</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Graph.html"><span class="hs-identifier">GHC.Cmm.Graph</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CmmGraph</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Types.html"><span class="hs-identifier">GHC.StgToCmm.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier">pprPanic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html"><span class="hs-identifier">GHC.Utils.Panic.Plain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier">panic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html"><span class="hs-identifier">GHC.Stg.Syntax</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Closure.html"><span class="hs-identifier">GHC.StgToCmm.Closure</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html"><span class="hs-identifier">GHC.Cmm.Switch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Switch.html#mkSwitchTargets"><span class="hs-identifier">mkSwitchTargets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Info.html"><span class="hs-identifier">GHC.Cmm.Info</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Info.html#cmmGetClosureType"><span class="hs-identifier">cmmGetClosureType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html"><span class="hs-identifier">GHC.Types.RepType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.RepType.html#dataConRuntimeRepStrictness"><span class="hs-identifier">dataConRuntimeRepStrictness</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier">mkFastString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.6.7/src/Data.Map.html#/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><span class="hs-comment">-- | Check all arguments marked as cbv for the presence of a tag *at runtime*.</span></span><span>
</span><span id="line-47"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkFunctionArgTags"><span class="hs-identifier hs-type">checkFunctionArgTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span id="checkFunctionArgTags"><span class="annot"><span class="annottext">checkFunctionArgTags :: SDoc -&gt; Id -&gt; [Id] -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#checkFunctionArgTags"><span class="hs-identifier hs-var hs-var">checkFunctionArgTags</span></a></span></span><span> </span><span id="local-6989586621681900242"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900242"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621681900243"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900243"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681900244"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681900244"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FCode () -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier hs-var">whenCheckTags</span></a></span><span> </span><span class="annot"><span class="annottext">(FCode () -&gt; FCode ()) -&gt; FCode () -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="annottext">FCode () -&gt; Maybe [CbvMark] -&gt; ([CbvMark] -&gt; FCode ()) -&gt; FCode ()
forall b a. b -&gt; Maybe a -&gt; (a -&gt; b) -&gt; b
</span><a href="GHC.Utils.Misc.html#onJust"><span class="hs-identifier hs-var">onJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; FCode ()
forall a. a -&gt; FCode a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Maybe [CbvMark]
</span><a href="GHC.Types.Id.html#idCbvMarks_maybe"><span class="hs-identifier hs-var">idCbvMarks_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900243"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([CbvMark] -&gt; FCode ()) -&gt; FCode ())
-&gt; ([CbvMark] -&gt; FCode ()) -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681900247"><span class="annot"><span class="annottext">[CbvMark]
</span><a href="#local-6989586621681900247"><span class="hs-identifier hs-var">marks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-comment">-- Only check args marked as strict, and only lifted ones.</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681900248"><span class="annot"><span class="annottext">cbv_args :: [Id]
</span><a href="#local-6989586621681900248"><span class="hs-identifier hs-var hs-var">cbv_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Bool) -&gt; [Id] -&gt; [Id]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isBoxedType"><span class="hs-identifier hs-var">isBoxedType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (Id -&gt; Type) -&gt; Id -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Id] -&gt; [Id]) -&gt; [Id] -&gt; [Id]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Id] -&gt; [Id]
forall a. [Bool] -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#filterByList"><span class="hs-identifier hs-var">filterByList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CbvMark -&gt; Bool) -&gt; [CbvMark] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">CbvMark -&gt; Bool
</span><a href="GHC.Types.Basic.html#isMarkedCbv"><span class="hs-identifier hs-var">isMarkedCbv</span></a></span><span> </span><span class="annot"><span class="annottext">[CbvMark]
</span><a href="#local-6989586621681900247"><span class="hs-identifier hs-var">marks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681900244"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-comment">-- Get their (cmm) address</span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621681900254"><span class="annot"><span class="annottext">[CgIdInfo]
</span><a href="#local-6989586621681900254"><span class="hs-identifier hs-var">arg_infos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; FCode CgIdInfo) -&gt; [Id] -&gt; FCode [CgIdInfo]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; FCode CgIdInfo
</span><a href="GHC.StgToCmm.Env.html#getCgIdInfo"><span class="hs-identifier hs-var">getCgIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681900248"><span class="hs-identifier hs-var">cbv_args</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681900257"><span class="annot"><span class="annottext">arg_cmms :: [CmmExpr]
</span><a href="#local-6989586621681900257"><span class="hs-identifier hs-var hs-var">arg_cmms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CgIdInfo -&gt; CmmExpr) -&gt; [CgIdInfo] -&gt; [CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">CgIdInfo -&gt; CmmExpr
</span><a href="GHC.StgToCmm.Env.html#idInfoToAmode"><span class="hs-identifier hs-var">idInfoToAmode</span></a></span><span> </span><span class="annot"><span class="annottext">[CgIdInfo]
</span><a href="#local-6989586621681900254"><span class="hs-identifier hs-var">arg_infos</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="annottext">((CmmExpr, Id) -&gt; FCode ()) -&gt; [(CmmExpr, Id)] -&gt; FCode ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.18.3.0/src/Data.Foldable.html#mapM_/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681900260"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900260"><span class="hs-identifier hs-var">cmm</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681900261"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900261"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; CmmExpr -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#emitTagAssertion"><span class="hs-identifier hs-var">emitTagAssertion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; String
forall a. Outputable a =&gt; a -&gt; String
</span><a href="GHC.Utils.Outputable.html#showPprUnsafe"><span class="hs-identifier hs-var">showPprUnsafe</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; String) -&gt; SDoc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900242"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900261"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900260"><span class="hs-identifier hs-var">cmm</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmExpr] -&gt; [Id] -&gt; [(CmmExpr, Id)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#zip/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621681900257"><span class="hs-identifier hs-var">arg_cmms</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681900248"><span class="hs-identifier hs-var">cbv_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><span class="hs-comment">-- | Check all required-tagged arguments of a constructor are tagged *at compile time*.</span></span><span>
</span><span id="line-58"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkConArgsStatic"><span class="hs-identifier hs-type">checkConArgsStatic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span id="checkConArgsStatic"><span class="annot"><span class="annottext">checkConArgsStatic :: SDoc -&gt; DataCon -&gt; [StgArg] -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#checkConArgsStatic"><span class="hs-identifier hs-var hs-var">checkConArgsStatic</span></a></span></span><span> </span><span id="local-6989586621681900265"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900265"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621681900266"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681900266"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681900267"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621681900267"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FCode () -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier hs-var">whenCheckTags</span></a></span><span> </span><span class="annot"><span class="annottext">(FCode () -&gt; FCode ()) -&gt; FCode () -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681900268"><span class="annot"><span class="annottext">marks :: [StrictnessMark]
</span><a href="#local-6989586621681900268"><span class="hs-identifier hs-var hs-var">marks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; DataCon -&gt; [StrictnessMark]
DataCon -&gt; [StrictnessMark]
</span><a href="GHC.Types.RepType.html#dataConRuntimeRepStrictness"><span class="hs-identifier hs-var">dataConRuntimeRepStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681900266"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="annottext">(StrictnessMark -&gt; StgArg -&gt; FCode ())
-&gt; [StrictnessMark] -&gt; [StgArg] -&gt; FCode ()
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="../../base-4.18.3.0/src/Control.Monad.html#zipWithM_/Control.Monad.html#zipWithM_"><span class="hs-identifier hs-var">zipWithM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; StrictnessMark -&gt; StgArg -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#checkArgStatic"><span class="hs-identifier hs-var">checkArgStatic</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900265"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StrictnessMark]
</span><a href="#local-6989586621681900268"><span class="hs-identifier hs-var">marks</span></a></span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621681900267"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Check all required arguments of a constructor are tagged.</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- Possible by emitting checks at runtime.</span><span>
</span><span id="line-65"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkConArgsDyn"><span class="hs-identifier hs-type">checkConArgsDyn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span id="checkConArgsDyn"><span class="annot"><span class="annottext">checkConArgsDyn :: SDoc -&gt; DataCon -&gt; [StgArg] -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#checkConArgsDyn"><span class="hs-identifier hs-var hs-var">checkConArgsDyn</span></a></span></span><span> </span><span id="local-6989586621681900270"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900270"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621681900271"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681900271"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681900272"><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621681900272"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FCode () -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier hs-var">whenCheckTags</span></a></span><span> </span><span class="annot"><span class="annottext">(FCode () -&gt; FCode ()) -&gt; FCode () -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681900273"><span class="annot"><span class="annottext">marks :: [StrictnessMark]
</span><a href="#local-6989586621681900273"><span class="hs-identifier hs-var hs-var">marks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; DataCon -&gt; [StrictnessMark]
DataCon -&gt; [StrictnessMark]
</span><a href="GHC.Types.RepType.html#dataConRuntimeRepStrictness"><span class="hs-identifier hs-var">dataConRuntimeRepStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681900271"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="annottext">(CbvMark -&gt; StgArg -&gt; FCode ())
-&gt; [CbvMark] -&gt; [StgArg] -&gt; FCode ()
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="../../base-4.18.3.0/src/Control.Monad.html#zipWithM_/Control.Monad.html#zipWithM_"><span class="hs-identifier hs-var">zipWithM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; CbvMark -&gt; StgArg -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#checkArg"><span class="hs-identifier hs-var">checkArg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900270"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StrictnessMark -&gt; CbvMark) -&gt; [StrictnessMark] -&gt; [CbvMark]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">StrictnessMark -&gt; CbvMark
</span><a href="GHC.Core.DataCon.html#cbvFromStrictMark"><span class="hs-identifier hs-var">cbvFromStrictMark</span></a></span><span> </span><span class="annot"><span class="annottext">[StrictnessMark]
</span><a href="#local-6989586621681900273"><span class="hs-identifier hs-var">marks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgArg]
</span><a href="#local-6989586621681900272"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier hs-type">whenCheckTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span id="whenCheckTags"><span class="annot"><span class="annottext">whenCheckTags :: FCode () -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier hs-var hs-var">whenCheckTags</span></a></span></span><span> </span><span id="local-6989586621681900275"><span class="annot"><span class="annottext">FCode ()
</span><a href="#local-6989586621681900275"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621681900276"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681900276"><span class="hs-identifier hs-var">check_tags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StgToCmmConfig -&gt; Bool
</span><a href="GHC.StgToCmm.Config.html#stgToCmmDoTagCheck"><span class="hs-identifier hs-var">stgToCmmDoTagCheck</span></a></span><span> </span><span class="annot"><span class="annottext">(StgToCmmConfig -&gt; Bool) -&gt; FCode StgToCmmConfig -&gt; FCode Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FCode StgToCmmConfig
</span><a href="GHC.StgToCmm.Monad.html#getStgToCmmConfig"><span class="hs-identifier hs-var">getStgToCmmConfig</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; FCode () -&gt; FCode ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681900276"><span class="hs-identifier hs-var">check_tags</span></a></span><span> </span><span class="annot"><span class="annottext">FCode ()
</span><a href="#local-6989586621681900275"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Call barf if we failed to predict a tag correctly.</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- This is immensely useful when debugging issues in tag inference</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- as it will result in a program abort when we encounter an invalid</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- call/heap object, rather than leaving it be and segfaulting arbitrary</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- or producing invalid results.</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- We check if either:</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- * A tag is present</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- * Or the object is a PAP (for which zero is the proper tag)</span><span>
</span><span id="line-83"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#emitTagAssertion"><span class="hs-identifier hs-type">emitTagAssertion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span id="emitTagAssertion"><span class="annot"><span class="annottext">emitTagAssertion :: String -&gt; CmmExpr -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#emitTagAssertion"><span class="hs-identifier hs-var hs-var">emitTagAssertion</span></a></span></span><span> </span><span id="local-6989586621681900281"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681900281"><span class="hs-identifier hs-var">onWhat</span></a></span></span><span> </span><span id="local-6989586621681900282"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900282"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681900283"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681900283"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FCode Platform
</span><a href="GHC.StgToCmm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681900285"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900285"><span class="hs-identifier hs-var">lret</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FCode BlockId
forall (m :: * -&gt; *). MonadUnique m =&gt; m BlockId
</span><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-var">newBlockId</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681900287"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900287"><span class="hs-identifier hs-var">lno_tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FCode BlockId
forall (m :: * -&gt; *). MonadUnique m =&gt; m BlockId
</span><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-var">newBlockId</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681900288"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900288"><span class="hs-identifier hs-var">lbarf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FCode BlockId
forall (m :: * -&gt; *). MonadUnique m =&gt; m BlockId
</span><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-var">newBlockId</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-comment">-- Check for presence of any tag.</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">CmmAGraph -&gt; FCode ()
</span><a href="GHC.StgToCmm.Monad.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmAGraph -&gt; FCode ()) -&gt; CmmAGraph -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; BlockId -&gt; BlockId -&gt; Maybe Bool -&gt; CmmAGraph
</span><a href="GHC.Cmm.Graph.html#mkCbranch"><span class="hs-identifier hs-var">mkCbranch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.Cmm.Utils.html#cmmIsTagged"><span class="hs-identifier hs-var">cmmIsTagged</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681900283"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900282"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>                     </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900285"><span class="hs-identifier hs-var">lret</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900287"><span class="hs-identifier hs-var">lno_tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">-- If there is no tag check if we are dealing with a PAP</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; FCode ()
</span><a href="GHC.StgToCmm.Monad.html#emitLabel"><span class="hs-identifier hs-var">emitLabel</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900287"><span class="hs-identifier hs-var">lno_tag</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; FCode ()
</span><a href="GHC.StgToCmm.Monad.html#emitComment"><span class="hs-identifier hs-var">emitComment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;closereTypeCheck&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; BlockId -&gt; BlockId -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#needsArgTag"><span class="hs-identifier hs-var">needsArgTag</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900282"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900288"><span class="hs-identifier hs-var">lbarf</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900285"><span class="hs-identifier hs-var">lret</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; FCode ()
</span><a href="GHC.StgToCmm.Monad.html#emitLabel"><span class="hs-identifier hs-var">emitLabel</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900288"><span class="hs-identifier hs-var">lbarf</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; FCode ()
</span><a href="GHC.StgToCmm.Utils.html#emitBarf"><span class="hs-identifier hs-var">emitBarf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Tag inference failed on:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681900281"><span class="hs-identifier hs-var">onWhat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; FCode ()
</span><a href="GHC.StgToCmm.Monad.html#emitLabel"><span class="hs-identifier hs-var">emitLabel</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900285"><span class="hs-identifier hs-var">lret</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Jump to the first block if the argument closure is subject</span><span>
</span><span id="line-103"></span><span class="hs-comment">--   to tagging requirements. Otherwise jump to the 2nd one.</span><span>
</span><span id="line-104"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#needsArgTag"><span class="hs-identifier hs-type">needsArgTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span id="needsArgTag"><span class="annot"><span class="annottext">needsArgTag :: CmmExpr -&gt; BlockId -&gt; BlockId -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#needsArgTag"><span class="hs-identifier hs-var hs-var">needsArgTag</span></a></span></span><span> </span><span id="local-6989586621681900296"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900296"><span class="hs-identifier hs-var">closure</span></a></span></span><span> </span><span id="local-6989586621681900297"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900297"><span class="hs-identifier hs-var">fail</span></a></span></span><span> </span><span id="local-6989586621681900298"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900298"><span class="hs-identifier hs-var">lpass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621681900299"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621681900299"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FCode Profile
</span><a href="GHC.StgToCmm.Monad.html#getProfile"><span class="hs-identifier hs-var">getProfile</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621681900301"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681900301"><span class="hs-identifier hs-var">align_check</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StgToCmmConfig -&gt; Bool
</span><a href="GHC.StgToCmm.Config.html#stgToCmmAlignCheck"><span class="hs-identifier hs-var">stgToCmmAlignCheck</span></a></span><span> </span><span class="annot"><span class="annottext">(StgToCmmConfig -&gt; Bool) -&gt; FCode StgToCmmConfig -&gt; FCode Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.3.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FCode StgToCmmConfig
</span><a href="GHC.StgToCmm.Monad.html#getStgToCmmConfig"><span class="hs-identifier hs-var">getStgToCmmConfig</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681900303"><span class="annot"><span class="annottext">clo_ty_e :: CmmExpr
</span><a href="#local-6989586621681900303"><span class="hs-identifier hs-var hs-var">clo_ty_e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Profile -&gt; Bool -&gt; CmmExpr -&gt; CmmExpr
</span><a href="GHC.Cmm.Info.html#cmmGetClosureType"><span class="hs-identifier hs-var">cmmGetClosureType</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621681900299"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681900301"><span class="hs-identifier hs-var">align_check</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900296"><span class="hs-identifier hs-var">closure</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-comment">-- The ENTER macro doesn't evaluate FUN/PAP/BCO objects. So we</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-comment">-- have to accept them not being tagged. See #21193</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">-- See Note [TagInfo of functions]</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681900304"><span class="annot"><span class="annottext">targets :: SwitchTargets
</span><a href="#local-6989586621681900304"><span class="hs-identifier hs-var hs-var">targets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (Integer, Integer)
-&gt; Maybe BlockId
-&gt; Map Integer BlockId
-&gt; SwitchTargets
</span><a href="GHC.Cmm.Switch.html#mkSwitchTargets"><span class="hs-identifier hs-var">mkSwitchTargets</span></a></span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">INVALID_OBJECT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">N_CLOSURE_TYPES</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId -&gt; Maybe BlockId
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900297"><span class="hs-identifier hs-var">fail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Integer, BlockId)] -&gt; Map Integer BlockId
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../containers-0.6.7/src/Data.Map.Internal.html#fromList/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">PAP</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">BCO</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">FUN</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">FUN_1_0</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">FUN_0_1</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">FUN_2_0</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">FUN_1_1</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">FUN_0_2</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">FUN_STATIC</span><span class="hs-special">,</span><span class="hs-identifier">lpass</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>                    </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">CmmAGraph -&gt; FCode ()
</span><a href="GHC.StgToCmm.Monad.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmAGraph -&gt; FCode ()) -&gt; CmmAGraph -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; SwitchTargets -&gt; CmmAGraph
</span><a href="GHC.Cmm.Graph.html#mkSwitch"><span class="hs-identifier hs-var">mkSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900303"><span class="hs-identifier hs-var">clo_ty_e</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621681900304"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="annottext">CmmAGraph -&gt; FCode ()
</span><a href="GHC.StgToCmm.Monad.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmAGraph -&gt; FCode ()) -&gt; CmmAGraph -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; CmmAGraph
</span><a href="GHC.Cmm.Graph.html#mkBranch"><span class="hs-identifier hs-var">mkBranch</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621681900298"><span class="hs-identifier hs-var">lpass</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#emitArgTagCheck"><span class="hs-identifier hs-type">emitArgTagCheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Basic.html#CbvMark"><span class="hs-identifier hs-type">CbvMark</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span id="emitArgTagCheck"><span class="annot"><span class="annottext">emitArgTagCheck :: SDoc -&gt; [CbvMark] -&gt; [Id] -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#emitArgTagCheck"><span class="hs-identifier hs-var hs-var">emitArgTagCheck</span></a></span></span><span> </span><span id="local-6989586621681900308"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900308"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621681900309"><span class="annot"><span class="annottext">[CbvMark]
</span><a href="#local-6989586621681900309"><span class="hs-identifier hs-var">marks</span></a></span></span><span> </span><span id="local-6989586621681900310"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681900310"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FCode () -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier hs-var">whenCheckTags</span></a></span><span> </span><span class="annot"><span class="annottext">(FCode () -&gt; FCode ()) -&gt; FCode () -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621681900311"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681900311"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FCode Module
</span><a href="GHC.StgToCmm.Monad.html#getModuleName"><span class="hs-identifier hs-var">getModuleName</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681900313"><span class="annot"><span class="annottext">cbv_args :: [Id]
</span><a href="#local-6989586621681900313"><span class="hs-identifier hs-var hs-var">cbv_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; Bool) -&gt; [Id] -&gt; [Id]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.3.0/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isBoxedType"><span class="hs-identifier hs-var">isBoxedType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; (Id -&gt; Type) -&gt; Id -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Id] -&gt; [Id]) -&gt; [Id] -&gt; [Id]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Id] -&gt; [Id]
forall a. [Bool] -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#filterByList"><span class="hs-identifier hs-var">filterByList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CbvMark -&gt; Bool) -&gt; [CbvMark] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">CbvMark -&gt; Bool
</span><a href="GHC.Types.Basic.html#isMarkedCbv"><span class="hs-identifier hs-var">isMarkedCbv</span></a></span><span> </span><span class="annot"><span class="annottext">[CbvMark]
</span><a href="#local-6989586621681900309"><span class="hs-identifier hs-var">marks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681900310"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621681900314"><span class="annot"><span class="annottext">[CgIdInfo]
</span><a href="#local-6989586621681900314"><span class="hs-identifier hs-var">arg_infos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; FCode CgIdInfo) -&gt; [Id] -&gt; FCode [CgIdInfo]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.3.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; FCode CgIdInfo
</span><a href="GHC.StgToCmm.Env.html#getCgIdInfo"><span class="hs-identifier hs-var">getCgIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681900313"><span class="hs-identifier hs-var">cbv_args</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681900315"><span class="annot"><span class="annottext">arg_cmms :: [CmmExpr]
</span><a href="#local-6989586621681900315"><span class="hs-identifier hs-var hs-var">arg_cmms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CgIdInfo -&gt; CmmExpr) -&gt; [CgIdInfo] -&gt; [CmmExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">CgIdInfo -&gt; CmmExpr
</span><a href="GHC.StgToCmm.Env.html#idInfoToAmode"><span class="hs-identifier hs-var">idInfoToAmode</span></a></span><span> </span><span class="annot"><span class="annottext">[CgIdInfo]
</span><a href="#local-6989586621681900314"><span class="hs-identifier hs-var">arg_infos</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span id="local-6989586621681900316"><span class="annot"><span class="annottext">mk_msg :: Id -&gt; String
</span><a href="#local-6989586621681900316"><span class="hs-identifier hs-var hs-var">mk_msg</span></a></span></span><span> </span><span id="local-6989586621681900317"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900317"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; String
forall a. Outputable a =&gt; a -&gt; String
</span><a href="GHC.Utils.Outputable.html#showPprUnsafe"><span class="hs-identifier hs-var">showPprUnsafe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Untagged arg:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681900311"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900308"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900317"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; CmmExpr -&gt; FCode ())
-&gt; [String] -&gt; [CmmExpr] -&gt; FCode ()
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="../../base-4.18.3.0/src/Control.Monad.html#zipWithM_/Control.Monad.html#zipWithM_"><span class="hs-identifier hs-var">zipWithM_</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; CmmExpr -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#emitTagAssertion"><span class="hs-identifier hs-var">emitTagAssertion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; String) -&gt; [Id] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; String
</span><a href="#local-6989586621681900316"><span class="hs-identifier hs-var">mk_msg</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681900310"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621681900315"><span class="hs-identifier hs-var">arg_cmms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#taggedCgInfo"><span class="hs-identifier hs-type">taggedCgInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#CgIdInfo"><span class="hs-identifier hs-type">CgIdInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-142"></span><span id="taggedCgInfo"><span class="annot"><span class="annottext">taggedCgInfo :: CgIdInfo -&gt; Bool
</span><a href="GHC.StgToCmm.TagCheck.html#taggedCgInfo"><span class="hs-identifier hs-var hs-var">taggedCgInfo</span></a></span></span><span> </span><span id="local-6989586621681900322"><span class="annot"><span class="annottext">CgIdInfo
</span><a href="#local-6989586621681900322"><span class="hs-identifier hs-var">cg_info</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LambdaFormInfo
</span><a href="#local-6989586621681900323"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><a href="GHC.StgToCmm.Types.html#LFCon"><span class="hs-identifier hs-type">LFCon</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><a href="GHC.StgToCmm.Types.html#LFReEntrant"><span class="hs-identifier hs-type">LFReEntrant</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><a href="GHC.StgToCmm.Types.html#LFUnlifted"><span class="hs-identifier hs-type">LFUnlifted</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-147"></span><span>      </span><span class="annot"><a href="GHC.StgToCmm.Types.html#LFThunk"><span class="hs-identifier hs-type">LFThunk</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><a href="GHC.StgToCmm.Types.html#LFUnknown"><span class="hs-identifier hs-type">LFUnknown</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><span class="annottext">LambdaFormInfo
</span><a href="GHC.StgToCmm.Types.html#LFLetNoEscape"><span class="hs-identifier hs-var">LFLetNoEscape</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Let no escape binding passed to top level con&quot;</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621681900323"><span class="annot"><span class="annottext">lf :: LambdaFormInfo
</span><a href="#local-6989586621681900323"><span class="hs-identifier hs-var hs-var">lf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CgIdInfo -&gt; LambdaFormInfo
</span><a href="GHC.StgToCmm.Monad.html#cg_lf"><span class="hs-identifier hs-var">cg_lf</span></a></span><span> </span><span class="annot"><span class="annottext">CgIdInfo
</span><a href="#local-6989586621681900322"><span class="hs-identifier hs-var">cg_info</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- Check that one argument is properly tagged.</span><span>
</span><span id="line-154"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkArg"><span class="hs-identifier hs-type">checkArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#CbvMark"><span class="hs-identifier hs-type">CbvMark</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span id="checkArg"><span class="annot"><span class="annottext">checkArg :: SDoc -&gt; CbvMark -&gt; StgArg -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#checkArg"><span class="hs-identifier hs-var hs-var">checkArg</span></a></span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CbvMark
</span><a href="GHC.Types.Basic.html#NotMarkedCbv"><span class="hs-identifier hs-var">NotMarkedCbv</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; FCode ()
forall a. a -&gt; FCode a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkArg"><span class="hs-identifier hs-var">checkArg</span></a></span><span> </span><span id="local-6989586621681900332"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900332"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="annot"><span class="annottext">CbvMark
</span><a href="GHC.Types.Basic.html#MarkedCbv"><span class="hs-identifier hs-var">MarkedCbv</span></a></span><span> </span><span id="local-6989586621681900334"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621681900334"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FCode () -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier hs-var">whenCheckTags</span></a></span><span> </span><span class="annot"><span class="annottext">(FCode () -&gt; FCode ()) -&gt; FCode () -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621681900334"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-type">StgLitArg</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; FCode ()
forall a. a -&gt; FCode a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-type">StgVarArg</span></a></span><span> </span><span id="local-6989586621681900337"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900337"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>      </span><span id="local-6989586621681900338"><span class="annot"><span class="annottext">CgIdInfo
</span><a href="#local-6989586621681900338"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; FCode CgIdInfo
</span><a href="GHC.StgToCmm.Env.html#getCgIdInfo"><span class="hs-identifier hs-var">getCgIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900337"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CgIdInfo -&gt; Bool
</span><a href="GHC.StgToCmm.TagCheck.html#taggedCgInfo"><span class="hs-identifier hs-var">taggedCgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">CgIdInfo
</span><a href="#local-6989586621681900338"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; FCode ()
forall a. a -&gt; FCode a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CgIdInfo -&gt; CgLoc
</span><a href="GHC.StgToCmm.Monad.html#cg_loc"><span class="hs-identifier hs-var">cg_loc</span></a></span><span> </span><span class="annot"><span class="annottext">CgIdInfo
</span><a href="#local-6989586621681900338"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><a href="GHC.StgToCmm.Closure.html#CmmLoc"><span class="hs-identifier hs-type">CmmLoc</span></a></span><span> </span><span id="local-6989586621681900341"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900341"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; CmmExpr -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#emitTagAssertion"><span class="hs-identifier hs-var">emitTagAssertion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; String
forall a. Outputable a =&gt; a -&gt; String
</span><a href="GHC.Utils.Outputable.html#showPprUnsafe"><span class="hs-identifier hs-var">showPprUnsafe</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; String) -&gt; SDoc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900332"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621681900334"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621681900341"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><a href="GHC.StgToCmm.Closure.html#LneLoc"><span class="hs-identifier hs-type">LneLoc</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; FCode ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LNE-arg&quot;</span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- Check that argument is properly tagged.</span><span>
</span><span id="line-168"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkArgStatic"><span class="hs-identifier hs-type">checkArgStatic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#StrictnessMark"><span class="hs-identifier hs-type">StrictnessMark</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Monad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span id="checkArgStatic"><span class="annot"><span class="annottext">checkArgStatic :: SDoc -&gt; StrictnessMark -&gt; StgArg -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#checkArgStatic"><span class="hs-identifier hs-var hs-var">checkArgStatic</span></a></span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">StrictnessMark
</span><a href="GHC.Core.DataCon.html#NotMarkedStrict"><span class="hs-identifier hs-var">NotMarkedStrict</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; FCode ()
forall a. a -&gt; FCode a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span class="annot"><a href="GHC.StgToCmm.TagCheck.html#checkArgStatic"><span class="hs-identifier hs-var">checkArgStatic</span></a></span><span> </span><span id="local-6989586621681900344"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900344"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictnessMark
</span><a href="GHC.Core.DataCon.html#MarkedStrict"><span class="hs-identifier hs-var">MarkedStrict</span></a></span><span> </span><span id="local-6989586621681900346"><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621681900346"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FCode () -&gt; FCode ()
</span><a href="GHC.StgToCmm.TagCheck.html#whenCheckTags"><span class="hs-identifier hs-var">whenCheckTags</span></a></span><span> </span><span class="annot"><span class="annottext">(FCode () -&gt; FCode ()) -&gt; FCode () -&gt; FCode ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621681900346"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgLitArg"><span class="hs-identifier hs-type">StgLitArg</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; FCode ()
forall a. a -&gt; FCode a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="GHC.Stg.Syntax.html#StgVarArg"><span class="hs-identifier hs-type">StgVarArg</span></a></span><span> </span><span id="local-6989586621681900347"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900347"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621681900348"><span class="annot"><span class="annottext">CgIdInfo
</span><a href="#local-6989586621681900348"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; FCode CgIdInfo
</span><a href="GHC.StgToCmm.Env.html#getCgIdInfo"><span class="hs-identifier hs-var">getCgIdInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681900347"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CgIdInfo -&gt; Bool
</span><a href="GHC.StgToCmm.TagCheck.html#taggedCgInfo"><span class="hs-identifier hs-var">taggedCgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">CgIdInfo
</span><a href="#local-6989586621681900348"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; FCode ()
forall a. a -&gt; FCode a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; FCode ()
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arg not tagged as expected&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681900344"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">StgArg
</span><a href="#local-6989586621681900346"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span></pre></body></html>