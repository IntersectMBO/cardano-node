<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621681750067"><span id="local-6989586621681750068"></span></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-unused-binds -fno-warn-missing-signatures #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LINE 43 &quot;compiler/GHC/Parser/Lexer.x&quot; #-}</span><span>
</span><span id="line-43"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-44"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-45"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-46"></span><span class="hs-pragma">{-# LANGUAGE UnboxedTuples #-}</span><span>
</span><span id="line-47"></span><span class="hs-pragma">{-# LANGUAGE UnboxedSums #-}</span><span>
</span><span id="line-48"></span><span class="hs-pragma">{-# LANGUAGE UnliftedNewtypes #-}</span><span>
</span><span id="line-49"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-pragma">{-# OPTIONS_GHC -funbox-strict-fields #-}</span><span>
</span><span id="line-53"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Parser.Lexer</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-56"></span><span>   </span><span class="hs-identifier">Token</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lexer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lexerDbg</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>   </span><span class="hs-identifier">ParserOpts</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkParserOpts</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>   </span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">initParserState</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">initPragState</span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>   </span><span class="hs-identifier">P</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ParseResult</span><span class="hs-special">(</span><span class="hs-identifier">POk</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PFailed</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>   </span><span class="hs-identifier">allocateComments</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">allocatePriorComments</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">allocateFinalComments</span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>   </span><span class="hs-identifier">MonadP</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>   </span><span class="hs-identifier">getRealSrcLoc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">getPState</span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>   </span><span class="hs-identifier">failMsgP</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">failLocMsgP</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">srcParseFail</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>   </span><span class="hs-identifier">getPsErrorMessages</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">getPsMessages</span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>   </span><span class="hs-identifier">popContext</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pushModuleContext</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">setLastToken</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">setSrcLoc</span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>   </span><span class="hs-identifier">activeContext</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">nextIsEOF</span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>   </span><span class="hs-identifier">getLexState</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">popLexState</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pushLexState</span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>   </span><span class="hs-identifier">ExtBits</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>   </span><span class="hs-identifier">xtest</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xunset</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xset</span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>   </span><span class="hs-identifier">disableHaddock</span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>   </span><span class="hs-identifier">lexTokenStream</span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>   </span><span class="hs-identifier">mkParensEpAnn</span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>   </span><span class="hs-identifier">getCommentsFor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">getPriorCommentsFor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">getFinalCommentsFor</span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>   </span><span class="hs-identifier">getEofPos</span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>   </span><span class="hs-identifier">commentToAnnotation</span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>   </span><span class="hs-identifier">HdkComment</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>   </span><span class="hs-identifier">warnopt</span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>   </span><span class="hs-identifier">adjustChar</span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>   </span><span class="hs-identifier">addPsMessage</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Prelude</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">GHC.Data.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Strict</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- base</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stripPrefix</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isInfixOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">partition</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.NonEmpty</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">NonEmpty</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List.NonEmpty</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">NE</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Debug.Trace</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">trace</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Data.EnumSet</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">EnumSet</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- ghc-boot</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">GHC.LanguageExtensions</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LangExt</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- bytestring</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ByteString</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- containers</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Map</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- compiler</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Utils.Error</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Utils.Outputable</span><span>
</span><span id="line-111"></span><span id="alex_tab_size"><span class="hs-keyword">import</span><span> </span></span><span class="hs-identifier">GHC.Utils.Panic</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Data.StringBuffer</span><span>
</span><span id="line-113"></span><span id="alex_base"><span class="hs-keyword">import</span><span> </span></span><span class="hs-identifier">GHC.Data.FastString</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Types.Error</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Types.Unique.FM</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Data.Maybe</span><span>
</span><span id="line-117"></span><span id="alex_table"><span class="hs-keyword">import</span><span> </span></span><span class="hs-identifier">GHC.Data.OrdList</span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Utils.Misc</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">readSignificandExponentPair</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">readHexSignificandExponentPair</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Types.SrcLoc</span><span>
</span><span id="line-121"></span><span id="alex_check"><span class="hs-keyword">import</span><span> </span></span><span class="hs-identifier">GHC.Types.SourceText</span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Types.Basic</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">InlineSpec</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">RuleMatchInfo</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Hs.Doc</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="alex_deflt"><span class="hs-keyword">import</span><span> </span></span><span class="hs-identifier">GHC.Parser.CharClass</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Parser.Annotation</span><span>
</span><span id="line-128"></span><span id="alex_accept"><span class="hs-keyword">import</span><span> </span></span><span class="hs-identifier">GHC.Driver.Flags</span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Parser.Errors.Basic</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Parser.Errors.Types</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Parser.Errors.Ppr</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 603
</span><span class="hs-cpp">#include &quot;ghcconfig.h&quot;
</span><span class="hs-cpp">#elif defined(__GLASGOW_HASKELL__)
</span><span class="hs-cpp">#include &quot;config.h&quot;
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 503
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Array</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Array</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 503
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Array.Base</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsafeAt</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Exts</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GlaExts</span><span class="hs-cpp">
#endif
</span><span class="hs-identifier">alex_tab_size</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-149"></span><span class="hs-identifier">alex_tab_size</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><span id="line-150"></span><span class="hs-identifier">alex_base</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAddr</span><span>
</span><span id="line-151"></span><span class="hs-identifier">alex_base</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexA#</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-string">&quot;\x01\x00\x00\x00\x7b\x00\x00\x00\x84\x00\x00\x00\xa0\x00\x00\x00\xbc\x00\x00\x00\xc5\x00\x00\x00\xce\x00\x00\x00\xf7\x00\x00\x00\x05\x01\x00\x00\x2f\x01\x00\x00\x4b\x01\x00\x00\x86\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x85\xff\xff\xff\x00\x00\x00\x00\x03\x02\x00\x00\xd7\xff\xff\xff\xc3\x00\x00\x00\x7d\x02\x00\x00\x8b\xff\xff\xff\xd7\x02\x00\x00\x00\x00\x00\x00\x17\x03\x00\x00\x91\x03\x00\x00\xcb\x03\x00\x00\x25\x04\x00\x00\x9f\x04\x00\x00\x64\x01\x00\x00\xfc\x00\x00\x00\x15\x05\x00\x00\xdc\xff\xff\xff\x2e\x05\x00\x00\x92\xff\xff\xff\x00\x00\x00\x00\xe3\xff\xff\xff\x94\xff\xff\xff\x61\x00\x00\x00\x00\x00\x00\x00\x85\x01\x00\x00\xa4\x05\x00\x00\x39\x01\x00\x00\xe4\x05\x00\x00\x62\x06\x00\x00\x81\x00\x00\x00\x82\x00\x00\x00\x6a\x01\x00\x00\x08\x00\x00\x00\x09\x00\x00\x00\xe0\x06\x00\x00\xe1\x01\x00\x00\x56\x07\x00\x00\xa0\x01\x00\x00\x96\x07\x00\x00\x14\x08\x00\x00\x92\x08\x00\x00\x0c\x09\x00\x00\x86\x09\x00\x00\x00\x0a\x00\x00\x7a\x0a\x00\x00\x28\x01\x00\x00\xf4\x0a\x00\x00\x6e\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe7\xff\xff\xff\xe8\x0b\x00\x00\x62\x0c\x00\x00\x1f\x02\x00\x00\xf4\xff\xff\xff\x0c\x00\x00\x00\x00\x00\x00\x00\x0d\x00\x00\x00\x00\x00\x00\x00\xa6\xff\xff\xff\xbc\x0c\x00\x00\xb8\xff\xff\xff\xb3\xff\xff\xff\xae\xff\xff\xff\xbb\xff\xff\xff\x13\x00\x00\x00\x00\x00\x00\x00\x71\x00\x00\x00\xb5\xff\xff\xff\xb1\xff\xff\xff\x6c\x03\x00\x00\x5b\x02\x00\x00\x8a\x05\x00\x00\x7a\x04\x00\x00\x36\x07\x00\x00\x6e\x02\x00\x00\x14\x0d\x00\x00\x4c\x07\x00\x00\x1d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf7\x02\x00\x00\x00\x00\x00\x00\x16\x00\x00\x00\x00\x00\x00\x00\x21\x04\x00\x00\xf0\x00\x00\x00\x49\x01\x00\x00\x51\x0d\x00\x00\x79\x0d\x00\x00\xbc\x0d\x00\x00\xe4\x0d\x00\x00\x56\x00\x00\x00\x27\x0e\x00\x00\x4f\x0e\x00\x00\x89\x00\x00\x00\x8a\x00\x00\x00\x8b\x00\x00\x00\x8c\x00\x00\x00\x8d\x00\x00\x00\x8e\x00\x00\x00\x8f\x00\x00\x00\x6d\x00\x00\x00\x05\x02\x00\x00\x00\x00\x00\x00\xec\x00\x00\x00\x8f\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x79\x00\x00\x00\x00\x00\x00\x00\x7a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x7c\x00\x00\x00\x7d\x00\x00\x00\x7e\x00\x00\x00\x7f\x00\x00\x00\xf6\x04\x00\x00\xdc\x0e\x00\x00\x08\x03\x00\x00\x1d\x0f\x00\x00\x90\x04\x00\x00\x47\x0b\x00\x00\x5e\x0f\x00\x00\x0a\x05\x00\x00\x9f\x0f\x00\x00\x76\x03\x00\x00\xe0\x0f\x00\x00\x45\x05\x00\x00\xc1\x0b\x00\x00\x21\x10\x00\x00\x95\x05\x00\x00\x2b\x04\x00\x00\x4f\x05\x00\x00\x55\x0a\x00\x00\xbe\x06\x00\x00\x3d\x0c\x00\x00\xc5\x05\x00\x00\x73\x08\x00\x00\x3a\x06\x00\x00\xea\x08\x00\x00\xd1\x06\x00\x00\x65\x10\x00\x00\xa6\x10\x00\x00\x67\x09\x00\x00\x2f\x05\x00\x00\xbf\x00\x00\x00\xba\x00\x00\x00\x33\x0d\x00\x00\xbf\x10\x00\x00\x08\x11\x00\x00\x49\x11\x00\x00\xe1\x09\x00\x00\xd2\x0a\x00\x00\x79\x02\x00\x00\xc4\x00\x00\x00\x62\x11\x00\x00\x83\x11\x00\x00\xc6\x11\x00\x00\xfb\x11\x00\x00\x41\x12\x00\x00\x64\x12\x00\x00\x87\x12\x00\x00\x80\x00\x00\x00\x90\x00\x00\x00\x9b\x00\x00\x00\x9c\x00\x00\x00\xa1\x00\x00\x00\xa9\x00\x00\x00\xc7\x12\x00\x00\x41\x13\x00\x00\xbb\x13\x00\x00\x35\x14\x00\x00\xaf\x14\x00\x00\x29\x15\x00\x00\xa3\x15\x00\x00\x1d\x16\x00\x00\x97\x16\x00\x00\x11\x17\x00\x00\x4b\x17\x00\x00\xc5\x17\x00\x00\x3f\x18\x00\x00\xb9\x18\x00\x00\x42\x00\x00\x00\x67\x00\x00\x00\x47\x00\x00\x00\x6a\x00\x00\x00\x33\x19\x00\x00\xad\x19\x00\x00\x27\x1a\x00\x00\xa1\x1a\x00\x00\x1b\x1b\x00\x00\x95\x1b\x00\x00\x0f\x1c\x00\x00\x89\x1c\x00\x00\x03\x1d\x00\x00\x00\x00\x00\x00\xab\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x7d\x1d\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x00\x00\x00\xfb\x1d\x00\x00\x75\x1e\x00\x00\x00\x00\x00\x00\xcf\x1e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f\x1f\x00\x00\x00\x00\x00\x00\x8b\x1f\x00\x00\x23\x01\x00\x00\xb7\x00\x00\x00\x00\x00\x00\x00\x07\x20\x00\x00\x00\x00\x00\x00\x83\x20\x00\x00\x00\x00\x00\x00\xff\x20\x00\x00\x00\x00\x00\x00\x70\x00\x00\x00\x00\x00\x00\x00\x59\x21\x00\x00&quot;#</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-identifier">alex_table</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAddr</span><span>
</span><span id="line-155"></span><span class="hs-identifier">alex_table</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexA#</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-string">&quot;\x00\x00\x0d\x00\xc2\x00\x44\x00\x12\x00\xb9\x00\x7a\x00\x63\x00\x16\x00\x21\x00\x79\x00\x3f\x00\x7a\x00\x7a\x00\x7a\x00\x22\x00\x24\x00\x26\x00\xff\xff\xff\xff\x3c\x00\x48\x00\x49\x00\x4b\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x56\x00\x5f\x00\xff\xff\x7a\x00\xb9\x00\x7c\x00\xe7\x00\xb9\x00\xb9\x00\xb9\x00\x7d\x00\xe9\x00\xe4\x00\xb9\x00\xb9\x00\xe1\x00\xb8\x00\xb9\x00\xb9\x00\xb6\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb7\x00\xe0\x00\xb9\x00\xb9\x00\xb9\x00\x20\x00\xb9\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\x19\x00\xb9\x00\xe2\x00\xb9\x00\xc5\x00\xdf\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x11\x00\xee\x00\xdd\x00\xb9\x00\x7a\x00\x65\x00\x60\x00\x6e\x00\x79\x00\x61\x00\x7a\x00\x7a\x00\x7a\x00\x7a\x00\x65\x00\xff\xff\xff\xff\x79\x00\x6e\x00\x7a\x00\x7a\x00\x7a\x00\x4a\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x3c\x00\x46\x00\x7e\x00\x80\x00\x54\x00\x82\x00\x83\x00\x84\x00\x85\x00\xbc\x00\x7a\x00\x7a\x00\x65\x00\x41\x00\x6d\x00\x79\x00\x42\x00\x7a\x00\x7a\x00\x7a\x00\x76\x00\x6b\x00\xd1\x00\x6d\x00\x31\x00\xbf\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\xbd\x00\xbf\x00\x7a\x00\x7a\x00\x65\x00\xd3\x00\xc0\x00\x79\x00\x42\x00\x7a\x00\x7a\x00\x7a\x00\x7a\x00\x65\x00\xc1\x00\x6d\x00\x79\x00\x42\x00\x7a\x00\x7a\x00\x7a\x00\x7a\x00\x65\x00\xd0\x00\xd2\x00\x79\x00\x78\x00\x7a\x00\x7a\x00\x7a\x00\x7a\x00\x55\x00\x26\x00\xd3\x00\xe8\x00\x4c\x00\x88\x00\xf4\x00\x14\x00\x7a\x00\x13\x00\x0f\x00\xd3\x00\x6d\x00\xab\x00\xab\x00\xfc\x00\x0f\x00\x7a\x00\xab\x00\xab\x00\x7a\x00\x6d\x00\x00\x00\xb3\x00\xb3\x00\x77\x00\x7a\x00\x7a\x00\x7a\x00\xff\xff\x6d\x00\x7a\x00\x65\x00\x00\x00\x77\x00\x79\x00\x1d\x00\x7a\x00\x7a\x00\x7a\x00\x00\x00\x1d\x00\x1d\x00\x1d\x00\x1d\x00\x2e\x00\x64\x00\x7a\x00\x00\x00\x2f\x00\xff\xff\x2e\x00\x2e\x00\x2e\x00\x00\x00\x72\x00\x00\x00\x00\x00\x7a\x00\x00\x00\xac\x00\x72\x00\x43\x00\x1d\x00\x00\x00\xac\x00\x1f\x00\x00\x00\x0f\x00\x00\x00\xb4\x00\x6d\x00\x2e\x00\x00\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x00\x00\x2d\x00\x00\x00\x7a\x00\x65\x00\x00\x00\x43\x00\x79\x00\xef\x00\x7a\x00\x7a\x00\x7a\x00\x00\x00\x29\x00\x0f\x00\x43\x00\x40\x00\x00\x00\x00\x00\x29\x00\x29\x00\x29\x00\x0f\x00\xf4\x00\x77\x00\x00\x00\x3d\x00\x0f\x00\x0f\x00\x72\x00\x7a\x00\x7a\x00\x65\x00\x0f\x00\xff\xff\x79\x00\x00\x00\x7a\x00\x7a\x00\x7a\x00\x29\x00\x00\x00\x2a\x00\x6d\x00\x00\x00\x00\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x00\x00\x00\x00\x7a\x00\x72\x00\x71\x00\x23\x00\x2e\x00\x00\x00\x00\x00\x77\x00\x71\x00\xff\xff\x2e\x00\x2e\x00\x2e\x00\x25\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x2c\x00\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f\x00\xc3\x00\xc4\x00\x00\x00\x2e\x00\x7a\x00\x65\x00\x00\x00\x00\x00\x79\x00\x3f\x00\x7a\x00\x7a\x00\x7a\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x00\x00\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f\x00\x34\x00\x7a\x00\x71\x00\x00\x00\xf5\x00\x77\x00\x34\x00\x34\x00\x34\x00\xe5\x00\xe4\x00\x00\x00\x00\x00\xe1\x00\x6d\x00\x00\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x00\x00\x34\x00\xe0\x00\x35\x00\x1c\x00\x00\x00\x71\x00\x77\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xe3\x00\x00\x00\xe2\x00\x27\x00\xc4\x00\xdf\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xde\x00\x00\x00\xdd\x00\x3a\x00\x3a\x00\x3a\x00\x00\x00\x39\x00\x00\x00\x3a\x00\x00\x00\x00\x00\x39\x00\x39\x00\x39\x00\x39\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x39\x00\x7a\x00\xf4\x00\x00\x00\x00\x00\x10\x00\x0f\x00\x7a\x00\x7a\x00\x7a\x00\x00\x00\x00\x00\x0f\x00\x00\x00\x00\x00\x00\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x00\x00\x00\x00\x7a\x00\x32\x00\x00\x00\x47\x00\x00\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3a\x00\x0f\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x38\x00\x38\x00\x38\x00\x0f\x00\x37\x00\x00\x00\x38\x00\x00\x00\x00\x00\x37\x00\x37\x00\x37\x00\x37\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8c\x00\x37\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x00\x00\xb3\x00\xb3\x00\x00\x00\x00\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\xb4\x00\x00\x00\x00\x00\xb9\x00\x38\x00\x00\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x1b\x00\x1b\x00\x1b\x00\x00\x00\x17\x00\x00\x00\x1b\x00\x00\x00\x00\x00\x17\x00\x17\x00\x17\x00\x17\x00\x00\x00\x00\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\x00\x00\x17\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x00\x00\x00\x00\xb9\x00\x16\x00\xb9\x00\x62\x00\x00\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1b\x00\x00\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x18\x00\x18\x00\x18\x00\x00\x00\x00\x00\x00\x00\x18\x00\x00\x00\x00\x00\x00\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x00\x00\xa6\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1a\x00\x00\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x57\x00\x18\x00\xf3\x00\x00\x00\x00\x00\x00\x00\xa6\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18\x00\x00\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\xf1\x00\x00\x00\x00\x00\xf3\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf9\x00\x7b\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xfb\x00\xf3\x00\xf3\x00\xf3\x00\xf7\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x00\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x18\x00\x66\x00\x00\x00\x00\x00\x00\x00\xf1\x00\x00\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\x1b\x00\x1b\x00\x1b\x00\x00\x00\x00\x00\x00\x00\x1b\x00\x00\x00\x00\x00\x00\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x90\x00\x00\x00\x90\x00\x00\x00\xa6\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x5a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa6\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1b\x00\x00\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1b\x00\x1d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1d\x00\x1d\x00\x1d\x00\x1d\x00\x00\x00\x00\x00\x00\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\x8e\x00\xec\x00\x00\x00\xb9\x00\x00\x00\x00\x00\x1d\x00\x00\x00\x00\x00\x1f\x00\x00\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x00\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\x1e\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x66\x00\x00\x00\x00\x00\xb9\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\x00\x00\xb9\x00\x62\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x97\x00\x00\x00\x97\x00\x00\x00\x1c\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x95\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xec\x00\xaa\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\x29\x00\xb9\x00\x00\x00\xb9\x00\x81\x00\x9e\x00\x29\x00\x29\x00\x29\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x7f\x00\x00\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x59\x00\x29\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\xa6\x00\x00\x00\x00\x00\x00\x00\x00\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x28\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x57\x00\x2a\x00\x2a\x00\x00\x00\x00\x00\x00\x00\xa6\x00\x9d\x00\x00\x00\x9d\x00\x00\x00\x9e\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x9c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x27\x00\x2a\x00\x2a\x00\x2b\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x00\x00\x2a\x00\x2a\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x2a\x00\x2a\x00\x2b\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x2a\x00\x3b\x00\x3b\x00\x3b\x00\x00\x00\x31\x00\x00\x00\x3b\x00\x00\x00\x00\x00\x3d\x00\x31\x00\x31\x00\x31\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa4\x00\x00\x00\xa4\x00\x00\x00\x31\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x00\x00\x00\x00\x00\x00\xa0\x00\x00\x00\x00\x00\x00\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3b\x00\x00\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x34\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x34\x00\x34\x00\x34\x00\x00\x00\x00\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x34\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa2\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x33\x00\x00\x00\xa2\x00\x00\x00\x00\x00\x00\x00\x5b\x00\x00\x00\x35\x00\x35\x00\x35\x00\x35\x00\xa2\x00\x35\x00\x35\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x5e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa2\x00\x00\x00\x00\x00\x00\x00\x32\x00\x35\x00\x35\x00\x36\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x00\x00\x35\x00\x35\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x35\x00\x35\x00\x36\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x35\x00\x38\x00\x38\x00\x38\x00\x81\x00\x37\x00\x00\x00\x38\x00\x00\x00\x00\x00\x37\x00\x37\x00\x37\x00\x37\x00\x00\x00\x00\x00\x00\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x37\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa5\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x00\x00\x00\x00\x00\x00\x00\x00\x38\x00\x00\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x00\x00\x17\x00\x00\x00\x38\x00\x00\x00\x00\x00\x17\x00\x17\x00\x17\x00\x17\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\xa3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x00\x00\x00\x00\x00\x00\xa5\x00\x00\x00\x00\x00\x00\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x00\x00\x00\x00\x00\x00\x00\x00\x38\x00\x00\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x38\x00\x3a\x00\x3a\x00\x3a\x00\x87\x00\x39\x00\x00\x00\x3a\x00\x00\x00\x00\x00\x39\x00\x39\x00\x39\x00\x39\x00\x00\x00\x00\x00\x00\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\xa9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x39\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xaa\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3a\x00\x00\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x8b\x00\x17\x00\x00\x00\x3a\x00\x00\x00\x00\x00\x17\x00\x17\x00\x17\x00\x17\x00\x00\x00\x00\x00\x00\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb2\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3a\x00\x00\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3a\x00\x3b\x00\x3b\x00\x3b\x00\x00\x00\x00\x00\x00\x00\x3b\x00\x00\x00\x5c\x00\xff\xff\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\xa1\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa2\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3b\x00\x00\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3b\x00\x3e\x00\x3e\x00\x3e\x00\x00\x00\x3d\x00\x00\x00\x3e\x00\x00\x00\x00\x00\x3d\x00\x3d\x00\x3d\x00\x3d\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\xb1\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x00\x00\x00\x00\x00\x00\xb2\x00\x00\x00\x00\x00\x00\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3e\x00\x00\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x00\x00\x00\x00\x00\x00\x3e\x00\x00\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3e\x00\x00\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x3e\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x9f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa2\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xa1\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa2\x00\x44\x00\x44\x00\x44\x00\x44\x00\xc9\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\xca\x00\xd4\x00\x00\x00\xbb\x00\x45\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\xc9\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\xbb\x00\x00\x00\xbb\x00\xbb\x00\xbb\x00\xbb\x00\x00\x00\x00\x00\x00\x00\xbb\x00\xbb\x00\x00\x00\xbb\x00\xbb\x00\xbb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xba\x00\x00\x00\xbb\x00\xbb\x00\xbb\x00\xbb\x00\xbb\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\x00\x00\xbb\x00\x00\x00\xbb\x00\xd4\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd5\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd6\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x7f\x00\xbb\x00\x00\x00\xbb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x5d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x89\x00\x00\x00\x00\x00\xa2\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x5c\x00\x00\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x68\x00\xb9\x00\x5b\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xa2\x00\xa2\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\x6a\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x5e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa2\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xb9\x00\x00\x00\x6a\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x67\x00\x30\x00\x00\x00\x30\x00\x30\x00\x30\x00\x30\x00\x00\x00\x00\x00\x00\x00\x30\x00\x30\x00\x30\x00\x6c\x00\x30\x00\x30\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x30\x00\xb9\x00\x30\x00\x30\x00\x30\x00\x30\x00\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x30\x00\x00\x00\x30\x00\x30\x00\x30\x00\x30\x00\x00\x00\x00\x00\x00\x00\x30\x00\x30\x00\x00\x00\x6c\x00\x30\x00\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x30\x00\x00\x00\x30\x00\x00\x00\x00\x00\x00\x00\x30\x00\x00\x00\x30\x00\x30\x00\x30\x00\x30\x00\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x30\x00\x00\x00\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x30\x00\x00\x00\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x68\x00\xff\xff\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x6f\x00\xff\xff\xff\xff\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x30\x00\xff\xff\x30\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x6f\x00\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\xff\xff\x00\x00\xff\xff\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\xfd\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x92\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x94\x00\x00\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x92\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x92\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x91\x00\x00\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x92\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x92\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x94\x00\x00\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x92\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x99\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9b\x00\x00\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x99\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x99\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x98\x00\x00\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x99\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x99\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9b\x00\x00\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x96\x00\x86\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x99\x00\x00\x00\x93\x00\x00\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x92\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x91\x00\x00\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x92\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x00\x00\x00\x00\x89\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x5c\x00\x00\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xac\x00\x00\x00\x00\x00\xa2\x00\xa8\x00\x00\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\xa7\x00\x00\x00\xaa\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x5e\x00\x00\x00\x00\x00\xac\x00\x00\x00\x00\x00\xa2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8a\x00\x00\x00\x00\x00\xaa\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9a\x00\xa8\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x99\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x98\x00\x00\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x99\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x00\x00\x00\x00\x8d\x00\x00\x00\x00\x00\x00\x00\x00\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x58\x00\x00\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8d\x00\xa6\x00\xb0\x00\x00\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\xaf\x00\x00\x00\x58\x00\x00\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\xb5\x00\x00\x00\x00\x00\x00\x00\x00\x00\x5a\x00\x00\x00\x00\x00\x00\x00\xb4\x00\x00\x00\xa6\x00\xa6\x00\x00\x00\xb7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x5a\x00\x00\x00\x00\x00\xb4\x00\x00\x00\xb7\x00\xa6\x00\xb7\x00\xb7\x00\xb7\x00\xb7\x00\x00\x00\x00\x00\x00\x00\xb7\x00\xb7\x00\xb2\x00\xb7\x00\xb7\x00\xb7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb0\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xb7\x00\x00\x00\xb7\x00\xb7\x00\xb7\x00\xb7\x00\xb7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb7\x00\x00\x00\xb7\x00\xb9\x00\xb9\x00\x00\x00\x69\x00\xb9\x00\xb9\x00\xae\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xad\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb7\x00\x00\x00\xb7\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xa0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xba\x00\x00\x00\x00\x00\xb9\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\xba\x00\x00\x00\xba\x00\xba\x00\xba\x00\xba\x00\xbb\x00\x00\x00\x00\x00\xba\x00\xba\x00\x00\x00\xba\x00\xba\x00\xba\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xba\x00\xb9\x00\xba\x00\xba\x00\xba\x00\xba\x00\xba\x00\x00\x00\x00\x00\x00\x00\xbb\x00\x00\x00\xbb\x00\xbb\x00\xbb\x00\xbb\x00\x00\x00\x00\x00\x00\x00\xbb\x00\xbb\x00\x00\x00\xbb\x00\xbb\x00\xbb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xba\x00\xbb\x00\xba\x00\xbb\x00\xbb\x00\xbb\x00\xbb\x00\xbb\x00\xc2\x00\xc2\x00\xc2\x00\x00\x00\x00\x00\x00\x00\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xba\x00\x00\x00\xba\x00\xbb\x00\x00\x00\xbb\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbc\x00\x00\x00\x00\x00\x00\x00\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x4d\x00\x00\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\x00\x00\x00\x00\xbb\x00\x00\x00\xbb\x00\x00\x00\x00\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc2\x00\x00\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc2\x00\xc3\x00\xc3\x00\xc3\x00\x00\x00\x00\x00\x00\x00\xc3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcc\x00\x00\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc3\x00\x00\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc3\x00\xc4\x00\xc4\x00\xc4\x00\x00\x00\x00\x00\x00\x00\xc4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc4\x00\x00\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\xc4\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc5\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc7\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc7\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x58\x00\x00\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\xc9\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x45\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\xc9\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x00\x00\x00\x00\xa4\x00\x00\x00\xa4\x00\x00\x00\x00\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\xc6\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\x44\x00\xca\x00\xca\x00\xca\x00\x00\x00\x00\x00\x00\x00\xca\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0\x00\x00\x00\x00\x00\x00\x00\xca\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x4d\x00\x00\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\x00\x00\x00\x00\x00\x00\x00\x00\xca\x00\x00\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xca\x00\xcb\x00\xcb\x00\xcb\x00\x00\x00\x00\x00\x00\x00\xcb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcc\x00\x00\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\x00\x00\xcb\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcb\x00\x00\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\xcb\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xce\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcf\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xdb\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xd8\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xdc\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xda\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xd7\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd9\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x00\x00\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xcd\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x00\x00\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xd4\x00\xeb\x00\xeb\x00\xeb\x00\xb9\x00\x00\x00\x00\x00\xeb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xea\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xeb\x00\x00\x00\xe6\x00\xb9\x00\xb9\x00\x00\x00\x15\x00\xb9\x00\xb9\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xeb\x00\x00\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xeb\x00\xeb\x00\xeb\x00\x00\x00\x00\x00\x00\x00\xeb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xeb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\x00\x00\x00\x00\x00\x00\x00\x00\xeb\x00\x00\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xeb\x00\xec\x00\xec\x00\xec\x00\x00\x00\x00\x00\x00\x00\xec\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xec\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xec\x00\x00\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xec\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\xed\x00\xb9\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xf1\x00\xf1\x00\xf1\x00\x00\x00\x00\x00\x00\x00\xf1\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x0c\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf1\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\x00\x00\x00\x00\xff\x00\x00\x00\xb9\x00\x00\x00\x00\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf1\x00\x00\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\xf1\x00\x00\x00\xf0\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\xf2\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\xf6\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\xf8\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xf3\x00\x00\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xf3\x00\xb9\x00\xfa\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\xfe\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb9\x00\x00\x00\xb9\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;#</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-identifier">alex_check</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAddr</span><span>
</span><span id="line-159"></span><span class="hs-identifier">alex_check</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexA#</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-string">&quot;\xff\xff\x7c\x00\x01\x00\x02\x00\x2d\x00\x04\x00\x05\x00\x06\x00\x7d\x00\x2d\x00\x09\x00\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x7d\x00\x2d\x00\x7d\x00\x0a\x00\x0a\x00\x2d\x00\x21\x00\x0a\x00\x0a\x00\x72\x00\x61\x00\x67\x00\x6d\x00\x61\x00\x0a\x00\x69\x00\x6e\x00\x0a\x00\x20\x00\x21\x00\x22\x00\x23\x00\x24\x00\x25\x00\x26\x00\x27\x00\x28\x00\x29\x00\x2a\x00\x2b\x00\x2c\x00\x2d\x00\x2e\x00\x2f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x3a\x00\x3b\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x5b\x00\x5c\x00\x5d\x00\x5e\x00\x5f\x00\x60\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x7b\x00\x7c\x00\x7d\x00\x7e\x00\x05\x00\x06\x00\x65\x00\x2d\x00\x09\x00\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x05\x00\x06\x00\x0a\x00\x0a\x00\x09\x00\x2d\x00\x0b\x00\x0c\x00\x0d\x00\x21\x00\x0a\x00\x0a\x00\x0a\x00\x0a\x00\x0a\x00\x0a\x00\x0a\x00\x2d\x00\x20\x00\x23\x00\x23\x00\x23\x00\x23\x00\x23\x00\x23\x00\x23\x00\x23\x00\x20\x00\x05\x00\x06\x00\x65\x00\x2d\x00\x09\x00\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x2d\x00\x2d\x00\x69\x00\x2d\x00\x23\x00\x23\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x23\x00\x23\x00\x20\x00\x05\x00\x06\x00\x23\x00\x23\x00\x09\x00\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x05\x00\x06\x00\x23\x00\x2d\x00\x09\x00\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x05\x00\x06\x00\x6e\x00\x6c\x00\x09\x00\x2d\x00\x0b\x00\x0c\x00\x0d\x00\x20\x00\x6c\x00\x7d\x00\x23\x00\x23\x00\x70\x00\x23\x00\x20\x00\x2d\x00\x20\x00\x23\x00\x24\x00\x23\x00\x2d\x00\x30\x00\x31\x00\x7c\x00\x2a\x00\x20\x00\x30\x00\x31\x00\x05\x00\x2d\x00\xff\xff\x30\x00\x31\x00\x7b\x00\x0b\x00\x0c\x00\x0d\x00\x0a\x00\x2d\x00\x05\x00\x06\x00\xff\xff\x7b\x00\x09\x00\x05\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x05\x00\x06\x00\x20\x00\xff\xff\x09\x00\x0a\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\x24\x00\xff\xff\xff\xff\x20\x00\xff\xff\x5f\x00\x2a\x00\x7b\x00\x20\x00\xff\xff\x5f\x00\x23\x00\xff\xff\x5e\x00\xff\xff\x5f\x00\x2d\x00\x20\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x2d\x00\xff\xff\x05\x00\x06\x00\xff\xff\x7b\x00\x09\x00\x7c\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\x05\x00\x7c\x00\x7b\x00\x7c\x00\xff\xff\xff\xff\x0b\x00\x0c\x00\x0d\x00\x24\x00\x20\x00\x7b\x00\xff\xff\x23\x00\x24\x00\x2a\x00\x5e\x00\x20\x00\x05\x00\x06\x00\x2a\x00\x0a\x00\x09\x00\xff\xff\x0b\x00\x0c\x00\x0d\x00\x20\x00\xff\xff\x22\x00\x2d\x00\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x20\x00\x7c\x00\x24\x00\x23\x00\x05\x00\xff\xff\xff\xff\x7b\x00\x2a\x00\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x2d\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7b\x00\x5e\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5e\x00\x01\x00\x02\x00\xff\xff\x20\x00\x05\x00\x06\x00\xff\xff\xff\xff\x09\x00\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x7c\x00\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\x05\x00\x20\x00\x5e\x00\xff\xff\x23\x00\x7b\x00\x0b\x00\x0c\x00\x0d\x00\x28\x00\x29\x00\xff\xff\xff\xff\x2c\x00\x2d\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x20\x00\x3b\x00\x22\x00\x5f\x00\xff\xff\x7c\x00\x7b\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x5b\x00\xff\xff\x5d\x00\x5f\x00\x5f\x00\x60\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x7b\x00\xff\xff\x7d\x00\x01\x00\x02\x00\x03\x00\xff\xff\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\x05\x00\x20\x00\xff\xff\xff\xff\x23\x00\x24\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\xff\xff\x2a\x00\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x20\x00\x5f\x00\xff\xff\x23\x00\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\x5e\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\x7c\x00\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\x20\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x30\x00\x31\x00\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x5f\x00\xff\xff\xff\xff\x04\x00\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x01\x00\x02\x00\x03\x00\xff\xff\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x5c\x00\xff\xff\x5e\x00\xff\xff\x20\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x7c\x00\x7d\x00\x7e\x00\x5f\x00\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x45\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x5f\x00\x01\x00\x02\x00\xff\xff\xff\xff\xff\xff\x65\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x01\x00\x02\x00\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\xff\xff\x7c\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x5f\x00\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2b\x00\xff\xff\x2d\x00\xff\xff\x45\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x5f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x65\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x05\x00\xff\xff\xff\xff\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x02\x00\xff\xff\x04\x00\xff\xff\xff\xff\x20\x00\xff\xff\xff\xff\x23\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\x5f\x00\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\xff\xff\x3a\x00\x5f\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\x2b\x00\xff\xff\x2d\x00\xff\xff\x5f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x5c\x00\xff\xff\x5e\x00\x5f\x00\x5f\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x05\x00\x7c\x00\xff\xff\x7e\x00\x23\x00\x5f\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x20\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x45\x00\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x01\x00\x02\x00\x03\x00\x04\x00\x5f\x00\x06\x00\x07\x00\xff\xff\xff\xff\xff\xff\x65\x00\x2b\x00\xff\xff\x2d\x00\xff\xff\x5f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\x20\x00\x21\x00\x22\x00\x23\x00\x24\x00\x25\x00\x26\x00\x27\x00\x28\x00\x29\x00\x2a\x00\x2b\x00\x2c\x00\x2d\x00\x2e\x00\x2f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x3a\x00\x3b\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x5b\x00\x5c\x00\x5d\x00\x5e\x00\x5f\x00\x60\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x7b\x00\x7c\x00\x7d\x00\x7e\x00\x01\x00\x02\x00\x03\x00\x04\x00\xff\xff\x06\x00\x07\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\x21\x00\x22\x00\x23\x00\x24\x00\x25\x00\x26\x00\x27\x00\x28\x00\x29\x00\x2a\x00\x2b\x00\x2c\x00\x2d\x00\x2e\x00\x2f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x3a\x00\x3b\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x5b\x00\x5c\x00\x5d\x00\x5e\x00\x5f\x00\x60\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x7b\x00\x7c\x00\x7d\x00\x7e\x00\x01\x00\x02\x00\x03\x00\xff\xff\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\x2b\x00\xff\xff\x2d\x00\xff\xff\x20\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x05\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x0b\x00\x0c\x00\x0d\x00\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\xff\xff\xff\xff\xff\xff\xff\xff\x45\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x45\x00\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x01\x00\x02\x00\x03\x00\x04\x00\x65\x00\x06\x00\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x65\x00\xff\xff\xff\xff\xff\xff\x5f\x00\x20\x00\x21\x00\x22\x00\x23\x00\x24\x00\x25\x00\x26\x00\x27\x00\x28\x00\x29\x00\x2a\x00\x2b\x00\x2c\x00\x2d\x00\x2e\x00\x2f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x3a\x00\x3b\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x5b\x00\x5c\x00\x5d\x00\x5e\x00\x5f\x00\x60\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x7b\x00\x7c\x00\x7d\x00\x7e\x00\x01\x00\x02\x00\x03\x00\x04\x00\xff\xff\x06\x00\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\x21\x00\x22\x00\x23\x00\x24\x00\x25\x00\x26\x00\x27\x00\x28\x00\x29\x00\x2a\x00\x2b\x00\x2c\x00\x2d\x00\x2e\x00\x2f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x3a\x00\x3b\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x5b\x00\x5c\x00\x5d\x00\x5e\x00\x5f\x00\x60\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x7b\x00\x7c\x00\x7d\x00\x7e\x00\x01\x00\x02\x00\x03\x00\x23\x00\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\x23\x00\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\x23\x00\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\x2e\x00\x0a\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x45\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x5f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x65\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\x05\x00\xff\xff\x07\x00\xff\xff\xff\xff\x0a\x00\x0b\x00\x0c\x00\x0d\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x45\x00\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x5f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x65\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\x01\x00\x02\x00\xff\xff\x04\x00\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\x5c\x00\xff\xff\x5e\x00\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x23\x00\x7c\x00\xff\xff\x7e\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x04\x00\x23\x00\xff\xff\xff\xff\x45\x00\xff\xff\x0a\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\x21\x00\x5f\x00\x23\x00\x24\x00\x25\x00\x26\x00\x45\x00\x65\x00\xff\xff\x2a\x00\x2b\x00\x04\x00\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\x0a\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x5f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x65\x00\xff\xff\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\xff\xff\x5e\x00\xff\xff\xff\xff\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x04\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x0a\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\xff\xff\x5e\x00\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\x04\x00\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\x0a\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\x3a\x00\x7e\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\xff\xff\x5e\x00\xff\xff\xff\xff\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x04\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x0a\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\xff\xff\x5e\x00\xff\xff\xff\xff\xff\xff\xff\xff\x20\x00\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\x04\x00\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\x0a\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\x3a\x00\x7e\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\xff\xff\x5e\x00\xff\xff\xff\xff\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\xff\xff\x5e\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\xff\xff\x7c\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x50\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x70\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x50\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x70\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x50\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x70\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x50\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x70\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x50\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x70\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x50\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x23\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x70\x00\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x50\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x70\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x42\x00\xff\xff\xff\xff\x45\x00\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\x4f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x58\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\xff\xff\x62\x00\xff\xff\xff\xff\x65\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\x6f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2e\x00\x78\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x50\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x70\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\x45\x00\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\xff\xff\xff\xff\x42\x00\xff\xff\x65\x00\x45\x00\xff\xff\x04\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x4f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x58\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\xff\xff\x62\x00\xff\xff\x21\x00\x65\x00\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\x6f\x00\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x78\x00\xff\xff\xff\xff\xff\xff\x04\x00\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\x5c\x00\xff\xff\x5e\x00\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\x04\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\xff\xff\x5e\x00\x5f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\x04\x00\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\x04\x00\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\x3a\x00\x5e\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\x5c\x00\x3a\x00\x5e\x00\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\x5c\x00\xff\xff\x5e\x00\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\x2b\x00\xff\xff\x2d\x00\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x2e\x00\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\x01\x00\x02\x00\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x23\x00\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\x04\x00\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x21\x00\x22\x00\x23\x00\x24\x00\x25\x00\x26\x00\x27\x00\xff\xff\x29\x00\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\x5c\x00\xff\xff\x5e\x00\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\xff\xff\x7c\x00\xff\xff\x7e\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\x04\x00\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x21\x00\xff\xff\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\x29\x00\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\x5d\x00\x5e\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\xff\xff\x7c\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\xff\xff\x7c\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\xff\xff\x7c\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\xff\xff\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\xff\xff\x7c\x00\x01\x00\x02\x00\x03\x00\xff\xff\xff\xff\xff\xff\x07\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x27\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x31\x00\x32\x00\x33\x00\x34\x00\x35\x00\x36\x00\x37\x00\x38\x00\x39\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x41\x00\x42\x00\x43\x00\x44\x00\x45\x00\x46\x00\x47\x00\x48\x00\x49\x00\x4a\x00\x4b\x00\x4c\x00\x4d\x00\x4e\x00\x4f\x00\x50\x00\x51\x00\x52\x00\x53\x00\x54\x00\x55\x00\x56\x00\x57\x00\x58\x00\x59\x00\x5a\x00\xff\xff\xff\xff\xff\xff\x04\x00\x5f\x00\xff\xff\x61\x00\x62\x00\x63\x00\x64\x00\x65\x00\x66\x00\x67\x00\x68\x00\x69\x00\x6a\x00\x6b\x00\x6c\x00\x6d\x00\x6e\x00\x6f\x00\x70\x00\x71\x00\x72\x00\x73\x00\x74\x00\x75\x00\x76\x00\x77\x00\x78\x00\x79\x00\x7a\x00\x21\x00\x7c\x00\x23\x00\x24\x00\x25\x00\x26\x00\xff\xff\xff\xff\xff\xff\x2a\x00\x2b\x00\xff\xff\x2d\x00\x2e\x00\x2f\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x3a\x00\xff\xff\x3c\x00\x3d\x00\x3e\x00\x3f\x00\x40\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x5c\x00\x5d\x00\x5e\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x7c\x00\xff\xff\x7e\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff&quot;#</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-identifier">alex_deflt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAddr</span><span>
</span><span id="line-163"></span><span class="hs-identifier">alex_deflt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexA#</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-string">&quot;\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\x30\x00\x30\x00\x30\x00\x30\x00\x30\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x48\x00\xff\xff\x4a\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x52\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x30\x00\xff\xff\xff\xff\x75\x00\x75\x00\x74\x00\x70\x00\x74\x00\x70\x00\xff\xff\x74\x00\x70\x00\x70\x00\x73\x00\x72\x00\x73\x00\x74\x00\x75\x00\x30\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff&quot;#</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-identifier">alex_accept</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">listArray</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span class="hs-special">,</span><span> </span><span class="hs-number">255</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">189</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">188</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">187</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">186</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">185</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">184</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">183</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">182</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">181</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">180</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">179</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HaddockBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">178</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">177</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">176</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isNormalComment</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">175</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">174</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">173</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">172</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">171</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">twoWordPrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">170</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">169</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">168</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">167</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">166</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">165</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccSkip</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">164</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">163</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">162</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">161</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">160</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">linePrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">159</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">oneWordPrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">158</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">ignoredPrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">157</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">fileHeaderPrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">156</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">155</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">linePrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">154</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">oneWordPrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">153</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">ignoredPrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">152</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">fileHeaderPrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">151</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">150</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">linePrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">149</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">148</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isNormalComment</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">147</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">linePrags</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">146</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">145</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">notFollowedBySymbol</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">144</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexPrevCharMatches</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccSkip</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">143</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">notFollowedBy</span><span> </span><span class="hs-char">'-'</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">142</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">141</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccSkip</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccSkipPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexPrevCharMatches</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccSkipPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexPrevCharMatches</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccSkipPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexPrevCharMatches</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">140</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexPrevCharMatches</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">followedByDigit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">139</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">138</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">137</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexPrevCharMatches</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccSkip</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">136</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isSmartQuote</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">135</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifCurrentChar</span><span> </span><span class="hs-char">'&#10214;'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-267"></span><span>        </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">UnicodeSyntaxBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">134</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifCurrentChar</span><span> </span><span class="hs-char">'&#10215;'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-269"></span><span>        </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">UnicodeSyntaxBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-270"></span><span>        </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">133</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifCurrentChar</span><span> </span><span class="hs-char">'&#10631;'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-271"></span><span>        </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">UnicodeSyntaxBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-272"></span><span>        </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">132</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifCurrentChar</span><span> </span><span class="hs-char">'&#10632;'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">UnicodeSyntaxBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">131</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isSmartQuote</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">130</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">129</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isSmartQuote</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">128</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEOL</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">127</span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">126</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEOL</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">125</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEOL</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">124</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">123</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEOL</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">122</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">121</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEOL</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">120</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">119</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEOL</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">118</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">117</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEOL</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">116</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEOL</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">115</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">114</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexNotPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HaddockBit</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">113</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HaddockBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">112</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexNotPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HaddockBit</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">111</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">110</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexNotPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HaddockBit</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">109</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">108</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">107</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isNormalComment</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">106</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">105</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isNormalComment</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">104</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccSkip</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">103</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">102</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">101</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negHashLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">100</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negHashLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">99</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">98</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">97</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">96</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">95</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-308"></span><span>                                           </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">BinaryLiteralsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">94</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">93</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negHashLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">92</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negHashLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">91</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negHashLitPred</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-313"></span><span>                                           </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">BinaryLiteralsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">90</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negHashLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">89</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">88</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">87</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-318"></span><span>                                           </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">BinaryLiteralsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">86</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">85</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HexFloatLiteralsBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-321"></span><span>                                           </span><span class="hs-identifier">negLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">84</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HexFloatLiteralsBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-323"></span><span>                                           </span><span class="hs-identifier">negLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">83</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HexFloatLiteralsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">82</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">HexFloatLiteralsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">81</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">80</span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">79</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">78</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">77</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negLitPred</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-352"></span><span>                                           </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">BinaryLiteralsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">76</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">75</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negLitPred</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">74</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">73</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">72</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">BinaryLiteralsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">71</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">70</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">69</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">68</span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">67</span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">66</span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">65</span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">63</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">62</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">61</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">60</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">59</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">58</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">57</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">56</span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">55</span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">54</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">53</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">52</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">51</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">50</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">49</span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">48</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">47</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">46</span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">45</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">44</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">43</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexPrevCharMatches</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">42</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">41</span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">40</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">39</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">RecursiveDoBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">38</span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">37</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">36</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">RecursiveDoBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">35</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">34</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">33</span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">32</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">31</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">30</span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">29</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">28</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">27</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">26</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">25</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">24</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">23</span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">22</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">UnboxedParensBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">21</span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">20</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">UnboxedParensBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">19</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">18</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">OverloadedLabelsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">17</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">OverloadedLabelsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">IpBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">15</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">14</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">13</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ArrowsBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-421"></span><span>        </span><span class="hs-identifier">notFollowedBySymbol</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">QqBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">11</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">QqBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">QqBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">QqBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">QqBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">QqBit</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-identifier">alex_actions</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">array</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span class="hs-special">,</span><span> </span><span class="hs-number">190</span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-number">189</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_16</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">188</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_22</span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">187</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_23</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">186</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_21</span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">185</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_24</span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">184</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_28</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">183</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">182</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_45</span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">181</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_44</span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">180</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_43</span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">179</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_42</span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">178</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_40</span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">177</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_72</span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">176</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_2</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">175</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_40</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">174</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">173</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_36</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">172</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_67</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">171</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_33</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">170</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">169</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_32</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">168</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_31</span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">167</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_30</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">166</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">165</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">164</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_1</span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">163</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">162</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">161</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_27</span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">160</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_26</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">159</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_34</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">158</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_35</span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">157</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_38</span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">156</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_39</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">155</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_26</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">154</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_34</span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">153</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_35</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">152</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_37</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">151</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_39</span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">150</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_26</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">149</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">148</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_2</span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">147</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_26</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">146</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_25</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">145</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_20</span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">144</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_19</span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">143</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_17</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">142</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_78</span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">141</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_78</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">140</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_12</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">139</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_96</span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">138</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_97</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">137</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_11</span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">136</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_9</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">135</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_54</span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">134</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_55</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">133</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_58</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">132</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_59</span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">131</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_9</span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">130</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">129</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_9</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">128</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_8</span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">127</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">126</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_8</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">125</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_7</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">124</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">123</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_7</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">122</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">121</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_7</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">120</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">119</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_7</span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">118</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">117</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_7</span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">116</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_7</span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">115</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_6</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">114</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_5</span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">113</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_41</span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">112</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_5</span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">111</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">110</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_5</span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">109</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_4</span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">108</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_3</span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">107</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_2</span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">106</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_29</span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">105</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_2</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">104</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_1</span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">103</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_117</span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">102</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_116</span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">101</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_115</span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">100</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_114</span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">99</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_113</span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">98</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_112</span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">97</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_111</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">96</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_110</span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">95</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_109</span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">94</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_108</span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">93</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_107</span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">92</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_106</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">91</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_105</span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">90</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_104</span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">89</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_103</span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">88</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_102</span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">87</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_101</span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">86</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_100</span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">85</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_99</span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">84</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_99</span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">83</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_98</span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">82</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_98</span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">81</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_97</span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">80</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_96</span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">79</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_95</span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">78</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_94</span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">77</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_93</span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">76</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_92</span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">75</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_92</span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">74</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_91</span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">73</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_90</span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">72</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_89</span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">71</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_88</span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">70</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_88</span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">69</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_87</span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">68</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">67</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">66</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_85</span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">65</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_84</span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">64</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_83</span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">63</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_82</span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">62</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_113</span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">61</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_82</span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">60</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_112</span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">59</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_82</span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">58</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_81</span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">57</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_80</span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">56</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_79</span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">55</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_79</span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">54</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_78</span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">53</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_78</span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">52</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_78</span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">51</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_78</span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">50</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_78</span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">49</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_78</span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">48</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_77</span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">47</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_77</span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">46</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">45</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">44</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">43</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_19</span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">42</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">41</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">40</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">39</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_75</span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">38</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">37</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">36</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_75</span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">35</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">34</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_76</span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">33</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_74</span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">32</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_74</span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">31</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_73</span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">30</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_72</span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">29</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_71</span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">28</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_70</span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">27</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_69</span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">26</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_68</span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">25</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_67</span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">24</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_66</span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">23</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_65</span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">22</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_64</span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">21</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">20</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_63</span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">19</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_65</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">18</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_62</span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">17</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_61</span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_60</span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">15</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_57</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">14</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">13</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_56</span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">12</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_53</span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">11</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_52</span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">10</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_51</span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">9</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_52</span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">8</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_50</span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">7</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_52</span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_49</span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">5</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_52</span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">4</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_48</span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_47</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_52</span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_46</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-identifier">alex_action_86</span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-pragma">{-# LINE 704 &quot;compiler/GHC/Parser/Lexer.x&quot; #-}</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- Operator whitespace occurrence. See Note [Whitespace-sensitive operator parsing].</span><span>
</span><span id="line-705"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">OpWs</span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">OpWsPrefix</span><span>         </span><span class="hs-comment">-- a !b</span><span>
</span><span id="line-707"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">OpWsSuffix</span><span>         </span><span class="hs-comment">-- a! b</span><span>
</span><span id="line-708"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">OpWsTightInfix</span><span>     </span><span class="hs-comment">-- a!b</span><span>
</span><span id="line-709"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">OpWsLooseInfix</span><span>     </span><span class="hs-comment">-- a ! b</span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><span id="line-711"></span><span>
</span><span id="line-712"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- The token type</span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Token</span><span>
</span><span id="line-716"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITas</span><span>                        </span><span class="hs-comment">-- Haskell keywords</span><span>
</span><span id="line-717"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcase</span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITclass</span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdata</span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdefault</span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITderiving</span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">FastString</span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITelse</span><span>
</span><span id="line-724"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IThiding</span><span>
</span><span id="line-725"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITforeign</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITif</span><span>
</span><span id="line-727"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITimport</span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITin</span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITinfix</span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITinfixl</span><span>
</span><span id="line-731"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITinfixr</span><span>
</span><span id="line-732"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITinstance</span><span>
</span><span id="line-733"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlet</span><span>
</span><span id="line-734"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITmodule</span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITnewtype</span><span>
</span><span id="line-736"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITof</span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITqualified</span><span>
</span><span id="line-738"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITthen</span><span>
</span><span id="line-739"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITtype</span><span>
</span><span id="line-740"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITwhere</span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITforall</span><span>            </span><span class="hs-identifier">IsUnicodeSyntax</span><span> </span><span class="hs-comment">-- GHC extension keywords</span><span>
</span><span id="line-743"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITexport</span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlabel</span><span>
</span><span id="line-745"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdynamic</span><span>
</span><span id="line-746"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITsafe</span><span>
</span><span id="line-747"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITinterruptible</span><span>
</span><span id="line-748"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITunsafe</span><span>
</span><span id="line-749"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITstdcallconv</span><span>
</span><span id="line-750"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITccallconv</span><span>
</span><span id="line-751"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcapiconv</span><span>
</span><span id="line-752"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITprimcallconv</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITjavascriptcallconv</span><span>
</span><span id="line-754"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITmdo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">FastString</span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITfamily</span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITrole</span><span>
</span><span id="line-757"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITgroup</span><span>
</span><span id="line-758"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITby</span><span>
</span><span id="line-759"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITusing</span><span>
</span><span id="line-760"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITpattern</span><span>
</span><span id="line-761"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITstatic</span><span>
</span><span id="line-762"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITstock</span><span>
</span><span id="line-763"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITanyclass</span><span>
</span><span id="line-764"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITvia</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span>  </span><span class="hs-comment">-- Backpack tokens</span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITunit</span><span>
</span><span id="line-768"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITsignature</span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdependency</span><span>
</span><span id="line-770"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITrequires</span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span>  </span><span class="hs-comment">-- Pragmas, see  Note [Pragma source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITinline_prag</span><span>       </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">InlineSpec</span><span> </span><span class="hs-identifier">RuleMatchInfo</span><span>
</span><span id="line-774"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITopaque_prag</span><span>       </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-775"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITspec_prag</span><span>         </span><span class="hs-identifier">SourceText</span><span>                </span><span class="hs-comment">-- SPECIALISE</span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITspec_inline_prag</span><span>  </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">Bool</span><span>    </span><span class="hs-comment">-- SPECIALISE INLINE (or NOINLINE)</span><span>
</span><span id="line-777"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITsource_prag</span><span>       </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-778"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITrules_prag</span><span>        </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-779"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITwarning_prag</span><span>      </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-780"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdeprecated_prag</span><span>   </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-781"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITline_prag</span><span>         </span><span class="hs-identifier">SourceText</span><span>  </span><span class="hs-comment">-- not usually produced, see 'UsePosPragsBit'</span><span>
</span><span id="line-782"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcolumn_prag</span><span>       </span><span class="hs-identifier">SourceText</span><span>  </span><span class="hs-comment">-- not usually produced, see 'UsePosPragsBit'</span><span>
</span><span id="line-783"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITscc_prag</span><span>          </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-784"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITunpack_prag</span><span>       </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-785"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITnounpack_prag</span><span>     </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-786"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITann_prag</span><span>          </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcomplete_prag</span><span>     </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-788"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITclose_prag</span><span>
</span><span id="line-789"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IToptions_prag</span><span> </span><span class="hs-identifier">String</span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITinclude_prag</span><span> </span><span class="hs-identifier">String</span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlanguage_prag</span><span>
</span><span id="line-792"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITminimal_prag</span><span>      </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-793"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IToverlappable_prag</span><span> </span><span class="hs-identifier">SourceText</span><span>  </span><span class="hs-comment">-- instance overlap mode</span><span>
</span><span id="line-794"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IToverlapping_prag</span><span>  </span><span class="hs-identifier">SourceText</span><span>  </span><span class="hs-comment">-- instance overlap mode</span><span>
</span><span id="line-795"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IToverlaps_prag</span><span>     </span><span class="hs-identifier">SourceText</span><span>  </span><span class="hs-comment">-- instance overlap mode</span><span>
</span><span id="line-796"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITincoherent_prag</span><span>   </span><span class="hs-identifier">SourceText</span><span>  </span><span class="hs-comment">-- instance overlap mode</span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITctype</span><span>             </span><span class="hs-identifier">SourceText</span><span>
</span><span id="line-798"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcomment_line_prag</span><span>         </span><span class="hs-comment">-- See Note [Nested comment line pragmas]</span><span>
</span><span id="line-799"></span><span>
</span><span id="line-800"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdotdot</span><span>                    </span><span class="hs-comment">-- reserved symbols</span><span>
</span><span id="line-801"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcolon</span><span>
</span><span id="line-802"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdcolon</span><span>            </span><span class="hs-identifier">IsUnicodeSyntax</span><span>
</span><span id="line-803"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITequal</span><span>
</span><span id="line-804"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlam</span><span>
</span><span id="line-805"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlcase</span><span>
</span><span id="line-806"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlcases</span><span>
</span><span id="line-807"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITvbar</span><span>
</span><span id="line-808"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlarrow</span><span>            </span><span class="hs-identifier">IsUnicodeSyntax</span><span>
</span><span id="line-809"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITrarrow</span><span>            </span><span class="hs-identifier">IsUnicodeSyntax</span><span>
</span><span id="line-810"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdarrow</span><span>            </span><span class="hs-identifier">IsUnicodeSyntax</span><span>
</span><span id="line-811"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlolly</span><span>       </span><span class="hs-comment">-- The (&#8888;) arrow (for LinearTypes)</span><span>
</span><span id="line-812"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITminus</span><span>       </span><span class="hs-comment">-- See Note [Minus tokens]</span><span>
</span><span id="line-813"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITprefixminus</span><span> </span><span class="hs-comment">-- See Note [Minus tokens]</span><span>
</span><span id="line-814"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITbang</span><span>     </span><span class="hs-comment">-- Prefix (!) only, e.g. f !x = rhs</span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITtilde</span><span>    </span><span class="hs-comment">-- Prefix (~) only, e.g. f ~x = rhs</span><span>
</span><span id="line-816"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITat</span><span>       </span><span class="hs-comment">-- Tight infix (@) only, e.g. f x@pat = rhs</span><span>
</span><span id="line-817"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITtypeApp</span><span>  </span><span class="hs-comment">-- Prefix (@) only, e.g. f @t</span><span>
</span><span id="line-818"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITpercent</span><span>  </span><span class="hs-comment">-- Prefix (%) only, e.g. a %1 -&gt; b</span><span>
</span><span id="line-819"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITstar</span><span>              </span><span class="hs-identifier">IsUnicodeSyntax</span><span>
</span><span id="line-820"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdot</span><span>
</span><span id="line-821"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITproj</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-comment">-- Extension: OverloadedRecordDotBit</span><span>
</span><span id="line-822"></span><span>
</span><span id="line-823"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITbiglam</span><span>                    </span><span class="hs-comment">-- GHC-extension symbols</span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITocurly</span><span>                    </span><span class="hs-comment">-- special symbols</span><span>
</span><span id="line-826"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITccurly</span><span>
</span><span id="line-827"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITvocurly</span><span>
</span><span id="line-828"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITvccurly</span><span>
</span><span id="line-829"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITobrack</span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITopabrack</span><span>                  </span><span class="hs-comment">-- [:, for parallel arrays with -XParallelArrays</span><span>
</span><span id="line-831"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcpabrack</span><span>                  </span><span class="hs-comment">-- :], for parallel arrays with -XParallelArrays</span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcbrack</span><span>
</span><span id="line-833"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IToparen</span><span>
</span><span id="line-834"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcparen</span><span>
</span><span id="line-835"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IToubxparen</span><span>
</span><span id="line-836"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcubxparen</span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITsemi</span><span>
</span><span id="line-838"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcomma</span><span>
</span><span id="line-839"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITunderscore</span><span>
</span><span id="line-840"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITbackquote</span><span>
</span><span id="line-841"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITsimpleQuote</span><span>               </span><span class="hs-comment">--  '</span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITvarid</span><span>   </span><span class="hs-identifier">FastString</span><span>        </span><span class="hs-comment">-- identifiers</span><span>
</span><span id="line-844"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITconid</span><span>   </span><span class="hs-identifier">FastString</span><span>
</span><span id="line-845"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITvarsym</span><span>  </span><span class="hs-identifier">FastString</span><span>
</span><span id="line-846"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITconsym</span><span>  </span><span class="hs-identifier">FastString</span><span>
</span><span id="line-847"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITqvarid</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">FastString</span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITqconid</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">FastString</span><span class="hs-special">)</span><span>
</span><span id="line-849"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITqvarsym</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">FastString</span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITqconsym</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">FastString</span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdupipvarid</span><span>   </span><span class="hs-identifier">FastString</span><span>   </span><span class="hs-comment">-- GHC extension: implicit param: ?x</span><span>
</span><span id="line-853"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlabelvarid</span><span> </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">FastString</span><span>   </span><span class="hs-comment">-- Overloaded label: #x</span><span>
</span><span id="line-854"></span><span>                                         </span><span class="hs-comment">-- The SourceText is required because we can</span><span>
</span><span id="line-855"></span><span>                                         </span><span class="hs-comment">-- have a string literal as a label</span><span>
</span><span id="line-856"></span><span>                                         </span><span class="hs-comment">-- Note [Literal source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITchar</span><span>     </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">Char</span><span>       </span><span class="hs-comment">-- Note [Literal source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-859"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITstring</span><span>   </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-comment">-- Note [Literal source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITinteger</span><span>  </span><span class="hs-identifier">IntegralLit</span><span>           </span><span class="hs-comment">-- Note [Literal source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-861"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITrational</span><span> </span><span class="hs-identifier">FractionalLit</span><span>
</span><span id="line-862"></span><span>
</span><span id="line-863"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITprimchar</span><span>   </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">Char</span><span>     </span><span class="hs-comment">-- Note [Literal source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-864"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITprimstring</span><span> </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-comment">-- Note [Literal source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITprimint</span><span>    </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">Integer</span><span>  </span><span class="hs-comment">-- Note [Literal source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-866"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITprimword</span><span>   </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">Integer</span><span>  </span><span class="hs-comment">-- Note [Literal source text] in &quot;GHC.Types.Basic&quot;</span><span>
</span><span id="line-867"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITprimfloat</span><span>  </span><span class="hs-identifier">FractionalLit</span><span>
</span><span id="line-868"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITprimdouble</span><span> </span><span class="hs-identifier">FractionalLit</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span>  </span><span class="hs-comment">-- Template Haskell extension tokens</span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITopenExpQuote</span><span> </span><span class="hs-identifier">HasE</span><span> </span><span class="hs-identifier">IsUnicodeSyntax</span><span> </span><span class="hs-comment">--  [| or [e|</span><span>
</span><span id="line-872"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITopenPatQuote</span><span>                      </span><span class="hs-comment">--  [p|</span><span>
</span><span id="line-873"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITopenDecQuote</span><span>                      </span><span class="hs-comment">--  [d|</span><span>
</span><span id="line-874"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITopenTypQuote</span><span>                      </span><span class="hs-comment">--  [t|</span><span>
</span><span id="line-875"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcloseQuote</span><span> </span><span class="hs-identifier">IsUnicodeSyntax</span><span>        </span><span class="hs-comment">--  |]</span><span>
</span><span id="line-876"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITopenTExpQuote</span><span> </span><span class="hs-identifier">HasE</span><span>                </span><span class="hs-comment">--  [|| or [e||</span><span>
</span><span id="line-877"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcloseTExpQuote</span><span>                    </span><span class="hs-comment">--  ||]</span><span>
</span><span id="line-878"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdollar</span><span>                            </span><span class="hs-comment">--  prefix $</span><span>
</span><span id="line-879"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdollardollar</span><span>                      </span><span class="hs-comment">--  prefix $$</span><span>
</span><span id="line-880"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITtyQuote</span><span>                           </span><span class="hs-comment">--  ''</span><span>
</span><span id="line-881"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITquasiQuote</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">PsSpan</span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span>    </span><span class="hs-comment">-- ITquasiQuote(quoter, quote, loc)</span><span>
</span><span id="line-883"></span><span>    </span><span class="hs-comment">-- represents a quasi-quote of the form</span><span>
</span><span id="line-884"></span><span>    </span><span class="hs-comment">-- [quoter| quote |]</span><span>
</span><span id="line-885"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITqQuasiQuote</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">PsSpan</span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>    </span><span class="hs-comment">-- ITqQuasiQuote(Qual, quoter, quote, loc)</span><span>
</span><span id="line-887"></span><span>    </span><span class="hs-comment">-- represents a qualified quasi-quote of the form</span><span>
</span><span id="line-888"></span><span>    </span><span class="hs-comment">-- [Qual.quoter| quote |]</span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-comment">-- Arrow notation extension</span><span>
</span><span id="line-891"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITproc</span><span>
</span><span id="line-892"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITrec</span><span>
</span><span id="line-893"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IToparenbar</span><span>  </span><span class="hs-identifier">IsUnicodeSyntax</span><span> </span><span class="hs-comment">-- ^ @(|@</span><span>
</span><span id="line-894"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITcparenbar</span><span>  </span><span class="hs-identifier">IsUnicodeSyntax</span><span> </span><span class="hs-comment">-- ^ @|)@</span><span>
</span><span id="line-895"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlarrowtail</span><span> </span><span class="hs-identifier">IsUnicodeSyntax</span><span> </span><span class="hs-comment">-- ^ @-&lt;@</span><span>
</span><span id="line-896"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITrarrowtail</span><span> </span><span class="hs-identifier">IsUnicodeSyntax</span><span> </span><span class="hs-comment">-- ^ @&gt;-@</span><span>
</span><span id="line-897"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITLarrowtail</span><span> </span><span class="hs-identifier">IsUnicodeSyntax</span><span> </span><span class="hs-comment">-- ^ @-&lt;&lt;@</span><span>
</span><span id="line-898"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITRarrowtail</span><span> </span><span class="hs-identifier">IsUnicodeSyntax</span><span> </span><span class="hs-comment">-- ^ @&gt;&gt;-@</span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITunknown</span><span> </span><span class="hs-identifier">String</span><span>             </span><span class="hs-comment">-- ^ Used when the lexer can't make sense of it</span><span>
</span><span id="line-901"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITeof</span><span>                        </span><span class="hs-comment">-- ^ end of file token</span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span>  </span><span class="hs-comment">-- Documentation annotations. See Note [PsSpan in Comments]</span><span>
</span><span id="line-904"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdocComment</span><span>   </span><span class="hs-identifier">HsDocString</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-comment">-- ^ The HsDocString contains more details about what</span><span>
</span><span id="line-905"></span><span>                                      </span><span class="hs-comment">-- this is and how to pretty print it</span><span>
</span><span id="line-906"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITdocOptions</span><span>   </span><span class="hs-identifier">String</span><span>      </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-comment">-- ^ doc options (prune, ignore-exports, etc)</span><span>
</span><span id="line-907"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITlineComment</span><span>  </span><span class="hs-identifier">String</span><span>      </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-comment">-- ^ comment starting by &quot;--&quot;</span><span>
</span><span id="line-908"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ITblockComment</span><span> </span><span class="hs-identifier">String</span><span>      </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-comment">-- ^ comment in {- -}</span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><span id="line-911"></span><span>
</span><span id="line-912"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Outputable</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-913"></span><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="hs-comment">{- Note [PsSpan in Comments]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When using the Api Annotations to exact print a modified AST, managing
the space before a comment is important.  The PsSpan in the comment
token allows this to happen.

We also need to track the space before the end of file. The normal
mechanism of using the previous token does not work, as the ITeof is
synthesised to come at the same location of the last token, and the
normal previous token updating has by then updated the required
location.

We track this using a 2-back location, prev_loc2. This adds extra
processing to every single token, which is a performance hit for
something needed only at the end of the file. This needs
improving. Perhaps a backward scan on eof?
-}</span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span class="hs-comment">{- Note [Minus tokens]
~~~~~~~~~~~~~~~~~~~~~~
A minus sign can be used in prefix form (-x) and infix form (a - b).

When LexicalNegation is on:
  * ITprefixminus  represents the prefix form
  * ITvarsym &quot;-&quot;   represents the infix form
  * ITminus        is not used

When LexicalNegation is off:
  * ITminus        represents all forms
  * ITprefixminus  is not used
  * ITvarsym &quot;-&quot;   is not used
-}</span><span>
</span><span id="line-947"></span><span>
</span><span id="line-948"></span><span class="hs-comment">{- Note [Why not LexicalNegationBit]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
One might wonder why we define NoLexicalNegationBit instead of
LexicalNegationBit. The problem lies in the following line in reservedSymsFM:

    ,(&quot;-&quot;, ITminus, NormalSyntax, xbit NoLexicalNegationBit)

We want to generate ITminus only when LexicalNegation is off. How would one
do it if we had LexicalNegationBit? I (int-index) tried to use bitwise
complement:

    ,(&quot;-&quot;, ITminus, NormalSyntax, complement (xbit LexicalNegationBit))

This did not work, so I opted for NoLexicalNegationBit instead.
-}</span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span class="hs-comment">-- the bitmap provided as the third component indicates whether the</span><span>
</span><span id="line-966"></span><span class="hs-comment">-- corresponding extension keyword is valid under the extension options</span><span>
</span><span id="line-967"></span><span class="hs-comment">-- provided to the compiler; if the extension corresponding to *any* of the</span><span>
</span><span id="line-968"></span><span class="hs-comment">-- bits set in the bitmap is enabled, the keyword is valid (this setup</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- facilitates using a keyword in two different extensions that can be</span><span>
</span><span id="line-970"></span><span class="hs-comment">-- activated independently)</span><span>
</span><span id="line-971"></span><span class="hs-comment">--</span><span>
</span><span id="line-972"></span><span class="hs-identifier">reservedWordsFM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">UniqFM</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Token</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span class="hs-identifier">reservedWordsFM</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">listToUFM</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-974"></span><span>    </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkFastString</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;_&quot;</span><span class="hs-special">,</span><span>              </span><span class="hs-identifier">ITunderscore</span><span class="hs-special">,</span><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-976"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;as&quot;</span><span class="hs-special">,</span><span>             </span><span class="hs-identifier">ITas</span><span class="hs-special">,</span><span>            </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-977"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;case&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITcase</span><span class="hs-special">,</span><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-978"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;cases&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITlcases</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">LambdaCaseBit</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-979"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;class&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITclass</span><span class="hs-special">,</span><span>         </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-980"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;data&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITdata</span><span class="hs-special">,</span><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-981"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;default&quot;</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">ITdefault</span><span class="hs-special">,</span><span>       </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-982"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;deriving&quot;</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier">ITderiving</span><span class="hs-special">,</span><span>      </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-983"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;do&quot;</span><span class="hs-special">,</span><span>             </span><span class="hs-identifier">ITdo</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-special">,</span><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-984"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;else&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITelse</span><span class="hs-special">,</span><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-985"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;hiding&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">IThiding</span><span class="hs-special">,</span><span>        </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-986"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;if&quot;</span><span class="hs-special">,</span><span>             </span><span class="hs-identifier">ITif</span><span class="hs-special">,</span><span>            </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-987"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;import&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITimport</span><span class="hs-special">,</span><span>        </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-988"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;in&quot;</span><span class="hs-special">,</span><span>             </span><span class="hs-identifier">ITin</span><span class="hs-special">,</span><span>            </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-989"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;infix&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITinfix</span><span class="hs-special">,</span><span>         </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-990"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;infixl&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITinfixl</span><span class="hs-special">,</span><span>        </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-991"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;infixr&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITinfixr</span><span class="hs-special">,</span><span>        </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-992"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;instance&quot;</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier">ITinstance</span><span class="hs-special">,</span><span>      </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-993"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;let&quot;</span><span class="hs-special">,</span><span>            </span><span class="hs-identifier">ITlet</span><span class="hs-special">,</span><span>           </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-994"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;module&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITmodule</span><span class="hs-special">,</span><span>        </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-995"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;newtype&quot;</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">ITnewtype</span><span class="hs-special">,</span><span>       </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-996"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;of&quot;</span><span class="hs-special">,</span><span>             </span><span class="hs-identifier">ITof</span><span class="hs-special">,</span><span>            </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-997"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;qualified&quot;</span><span class="hs-special">,</span><span>      </span><span class="hs-identifier">ITqualified</span><span class="hs-special">,</span><span>     </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-998"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;then&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITthen</span><span class="hs-special">,</span><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-999"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;type&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITtype</span><span class="hs-special">,</span><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1000"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;where&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITwhere</span><span class="hs-special">,</span><span>         </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1001"></span><span>
</span><span id="line-1002"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;forall&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITforall</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1003"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;mdo&quot;</span><span class="hs-special">,</span><span>            </span><span class="hs-identifier">ITmdo</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">RecursiveDoBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1004"></span><span>             </span><span class="hs-comment">-- See Note [Lexing type pseudo-keywords]</span><span>
</span><span id="line-1005"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;family&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITfamily</span><span class="hs-special">,</span><span>        </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1006"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;role&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITrole</span><span class="hs-special">,</span><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1007"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;pattern&quot;</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">ITpattern</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">PatternSynonymsBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1008"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;static&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITstatic</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">StaticPointersBit</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1009"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;stock&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITstock</span><span class="hs-special">,</span><span>         </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1010"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;anyclass&quot;</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier">ITanyclass</span><span class="hs-special">,</span><span>      </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1011"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;via&quot;</span><span class="hs-special">,</span><span>            </span><span class="hs-identifier">ITvia</span><span class="hs-special">,</span><span>           </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1012"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;group&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITgroup</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">TransformComprehensionsBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1013"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;by&quot;</span><span class="hs-special">,</span><span>             </span><span class="hs-identifier">ITby</span><span class="hs-special">,</span><span>            </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">TransformComprehensionsBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1014"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;using&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITusing</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">TransformComprehensionsBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1015"></span><span>
</span><span id="line-1016"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;foreign&quot;</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">ITforeign</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1017"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;export&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITexport</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1018"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;label&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITlabel</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1019"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;dynamic&quot;</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">ITdynamic</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1020"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;safe&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITsafe</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span> </span><span class="hs-operator">.|.</span><span>
</span><span id="line-1021"></span><span>                                              </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">SafeHaskellBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1022"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;interruptible&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITinterruptible</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">InterruptibleFfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1023"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;unsafe&quot;</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ITunsafe</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1024"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;stdcall&quot;</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">ITstdcallconv</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1025"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;ccall&quot;</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">ITccallconv</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1026"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;capi&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITcapiconv</span><span class="hs-special">,</span><span>      </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">CApiFfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1027"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;prim&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITprimcallconv</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1028"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;javascript&quot;</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">ITjavascriptcallconv</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">FfiBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1029"></span><span>
</span><span id="line-1030"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;unit&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITunit</span><span class="hs-special">,</span><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1031"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;dependency&quot;</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">ITdependency</span><span class="hs-special">,</span><span>       </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1032"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;signature&quot;</span><span class="hs-special">,</span><span>      </span><span class="hs-identifier">ITsignature</span><span class="hs-special">,</span><span>     </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1033"></span><span>
</span><span id="line-1034"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;rec&quot;</span><span class="hs-special">,</span><span>            </span><span class="hs-identifier">ITrec</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span> </span><span class="hs-operator">.|.</span><span>
</span><span id="line-1035"></span><span>                                              </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">RecursiveDoBit</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1036"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;proc&quot;</span><span class="hs-special">,</span><span>           </span><span class="hs-identifier">ITproc</span><span class="hs-special">,</span><span>          </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1037"></span><span>     </span><span class="hs-special">]</span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span class="hs-comment">{-----------------------------------
Note [Lexing type pseudo-keywords]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

One might think that we wish to treat 'family' and 'role' as regular old
varids whenever -XTypeFamilies and -XRoleAnnotations are off, respectively.
But, there is no need to do so. These pseudo-keywords are not stolen syntax:
they are only used after the keyword 'type' at the top-level, where varids are
not allowed. Furthermore, checks further downstream (GHC.Tc.TyCl) ensure that
type families and role annotations are never declared without their extensions
on. In fact, by unconditionally lexing these pseudo-keywords as special, we
can get better error messages.

Also, note that these are included in the `varid` production in the parser --
a key detail to make all this work.
-------------------------------------}</span><span>
</span><span id="line-1055"></span><span>
</span><span id="line-1056"></span><span class="hs-identifier">reservedSymsFM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">UniqFM</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Token</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">IsUnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span class="hs-special">)</span><span>
</span><span id="line-1057"></span><span class="hs-identifier">reservedSymsFM</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">listToUFM</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-1058"></span><span>    </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span class="hs-identifier">w</span><span class="hs-special">,</span><span class="hs-identifier">y</span><span class="hs-special">,</span><span class="hs-identifier">z</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkFastString</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">w</span><span class="hs-special">,</span><span class="hs-identifier">y</span><span class="hs-special">,</span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1059"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;..&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITdotdot</span><span class="hs-special">,</span><span>                   </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1060"></span><span>        </span><span class="hs-comment">-- (:) is a reserved op, meaning only list cons</span><span>
</span><span id="line-1061"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;:&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITcolon</span><span class="hs-special">,</span><span>                    </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1062"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;::&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITdcolon</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>      </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;=&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITequal</span><span class="hs-special">,</span><span>                    </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1064"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;\\&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITlam</span><span class="hs-special">,</span><span>                      </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1065"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITvbar</span><span class="hs-special">,</span><span>                     </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1066"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&lt;-&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITlarrow</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>      </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1067"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;-&gt;&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITrarrow</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>      </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1068"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;=&gt;&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITdarrow</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>      </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1069"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;-&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITminus</span><span class="hs-special">,</span><span>                    </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">NoLexicalNegationBit</span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span>
</span><span id="line-1071"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;*&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITstar</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">StarIsTypeBit</span><span class="hs-special">)</span><span>
</span><span id="line-1072"></span><span>
</span><span id="line-1073"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;-&lt;&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITlarrowtail</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1074"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&gt;-&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">ITrarrowtail</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1075"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;-&lt;&lt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ITLarrowtail</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&gt;&gt;-&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ITRarrowtail</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1077"></span><span>
</span><span id="line-1078"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#8759;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITdcolon</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1079"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#8658;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITdarrow</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1080"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#8704;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITforall</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#8594;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITrarrow</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1082"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#8592;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITlarrow</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#8888;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITlolly</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span>
</span><span id="line-1086"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#10521;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITlarrowtail</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1087"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#10522;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITrarrowtail</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1088"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#10523;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITLarrowtail</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1089"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#10524;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITRarrowtail</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">ArrowsBit</span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span>       </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-string">&quot;&#9733;&quot;</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">ITstar</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">StarIsTypeBit</span><span class="hs-special">)</span><span>
</span><span id="line-1092"></span><span>
</span><span id="line-1093"></span><span>        </span><span class="hs-comment">-- ToDo: ideally, &#8594; and &#8759; should be &quot;specials&quot;, so that they cannot</span><span>
</span><span id="line-1094"></span><span>        </span><span class="hs-comment">-- form part of a large operator.  This would let us have a better</span><span>
</span><span id="line-1095"></span><span>        </span><span class="hs-comment">-- syntax for kinds: &#593;&#8759;*&#8594;* would be a legal kind signature. (maybe).</span><span>
</span><span id="line-1096"></span><span>       </span><span class="hs-special">]</span><span>
</span><span id="line-1097"></span><span>
</span><span id="line-1098"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1099"></span><span class="hs-comment">-- Lexer actions</span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Action</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>
</span><span id="line-1103"></span><span class="hs-identifier">special</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1104"></span><span class="hs-identifier">special</span><span> </span><span class="hs-identifier">tok</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span>
</span><span id="line-1105"></span><span>
</span><span id="line-1106"></span><span class="hs-identifier">token</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">layout_token</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1107"></span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span class="hs-identifier">layout_token</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout</span><span> </span><span class="hs-operator">&gt;&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1111"></span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1112"></span><span>
</span><span id="line-1113"></span><span class="hs-identifier">qdo_token</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1114"></span><span class="hs-identifier">qdo_token</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1115"></span><span>    </span><span class="hs-identifier">maybe_layout</span><span> </span><span class="hs-identifier">token</span><span>
</span><span id="line-1116"></span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">token</span><span class="hs-special">)</span><span>
</span><span id="line-1117"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1118"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">token</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">fst</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">splitQualName</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-1119"></span><span>
</span><span id="line-1120"></span><span class="hs-identifier">skip_one_varid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1121"></span><span class="hs-identifier">skip_one_varid</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span>
</span><span id="line-1122"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stepOn</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span>
</span><span id="line-1124"></span><span class="hs-identifier">skip_one_varid_src</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1125"></span><span class="hs-identifier">skip_one_varid_src</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span>
</span><span id="line-1126"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stepOn</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span>                        </span><span class="hs-special">(</span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stepOn</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span class="hs-identifier">skip_two_varid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1130"></span><span class="hs-identifier">skip_two_varid</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span>
</span><span id="line-1131"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stepOn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stepOn</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-glyph">-</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1132"></span><span>
</span><span id="line-1133"></span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1134"></span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1135"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1136"></span><span>
</span><span id="line-1137"></span><span class="hs-identifier">begin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1138"></span><span class="hs-identifier">begin</span><span> </span><span class="hs-identifier">code</span><span> </span><span class="hs-identifier">_span</span><span> </span><span class="hs-identifier">_str</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">code</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-1139"></span><span>
</span><span id="line-1140"></span><span class="hs-identifier">pop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1141"></span><span class="hs-identifier">pop</span><span> </span><span class="hs-identifier">_span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1142"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1143"></span><span>     </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- See Note [Nested comment line pragmas]</span><span>
</span><span id="line-1145"></span><span class="hs-identifier">failLinePrag1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1146"></span><span class="hs-identifier">failLinePrag1</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1147"></span><span>  </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">InNestedCommentBit</span><span>
</span><span id="line-1148"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITcomment_line_prag</span><span class="hs-special">)</span><span>
</span><span id="line-1149"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">lexError</span><span> </span><span class="hs-identifier">LexErrorInPragma</span><span>
</span><span id="line-1150"></span><span>
</span><span id="line-1151"></span><span class="hs-comment">-- See Note [Nested comment line pragmas]</span><span>
</span><span id="line-1152"></span><span class="hs-identifier">popLinePrag1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1153"></span><span class="hs-identifier">popLinePrag1</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1154"></span><span>  </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">InNestedCommentBit</span><span>
</span><span id="line-1155"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITcomment_line_prag</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1156"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1157"></span><span>    </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-1158"></span><span>
</span><span id="line-1159"></span><span class="hs-identifier">hopefully_open_brace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1160"></span><span class="hs-identifier">hopefully_open_brace</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-1161"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">relaxed</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">RelaxedLayoutBit</span><span>
</span><span id="line-1162"></span><span>      </span><span class="hs-identifier">ctx</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getContext</span><span>
</span><span id="line-1163"></span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-1164"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcLocCol</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span>
</span><span id="line-1165"></span><span>          </span><span class="hs-identifier">isOK</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">relaxed</span><span> </span><span class="hs-operator">||</span><span>
</span><span id="line-1166"></span><span>                 </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ctx</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1167"></span><span>                 </span><span class="hs-identifier">Layout</span><span> </span><span class="hs-identifier">prev_off</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">prev_off</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">offset</span><span>
</span><span id="line-1168"></span><span>                 </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1169"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isOK</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">pop_and</span><span> </span><span class="hs-identifier">open_brace</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-1170"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-1171"></span><span>                     </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">PsErrMissingBlock</span><span>
</span><span id="line-1172"></span><span>
</span><span id="line-1173"></span><span class="hs-identifier">pop_and</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1174"></span><span class="hs-identifier">pop_and</span><span> </span><span class="hs-identifier">act</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1175"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1176"></span><span>     </span><span class="hs-identifier">act</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-1177"></span><span>
</span><span id="line-1178"></span><span class="hs-comment">-- See Note [Whitespace-sensitive operator parsing]</span><span>
</span><span id="line-1179"></span><span class="hs-identifier">followedByOpeningToken</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">precededByClosingToken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1180"></span><span class="hs-identifier">followedByOpeningToken</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">followedByOpeningToken'</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-1181"></span><span class="hs-identifier">precededByClosingToken</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">precededByClosingToken'</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-1182"></span><span>
</span><span id="line-1183"></span><span class="hs-comment">-- The input is the buffer *after* the token.</span><span>
</span><span id="line-1184"></span><span class="hs-identifier">followedByOpeningToken'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-1185"></span><span class="hs-identifier">followedByOpeningToken'</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-1186"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">atEnd</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-1187"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1188"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">nextChar</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1189"></span><span>        </span><span class="hs-special">(</span><span class="hs-char">'{'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">buf'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">nextCharIsNot</span><span> </span><span class="hs-identifier">buf'</span><span> </span><span class="hs-special">(</span><span class="hs-operator">==</span><span> </span><span class="hs-char">'-'</span><span class="hs-special">)</span><span>
</span><span id="line-1190"></span><span>        </span><span class="hs-special">(</span><span class="hs-char">'('</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1191"></span><span>        </span><span class="hs-special">(</span><span class="hs-char">'['</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1192"></span><span>        </span><span class="hs-special">(</span><span class="hs-char">'\&quot;'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1193"></span><span>        </span><span class="hs-special">(</span><span class="hs-char">'\''</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1194"></span><span>        </span><span class="hs-special">(</span><span class="hs-char">'_'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1195"></span><span>        </span><span class="hs-special">(</span><span class="hs-char">'&#10214;'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1196"></span><span>        </span><span class="hs-special">(</span><span class="hs-char">'&#10631;'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1197"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">isAlphaNum</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-1198"></span><span>
</span><span id="line-1199"></span><span class="hs-comment">-- The input is the buffer *before* the token.</span><span>
</span><span id="line-1200"></span><span class="hs-identifier">precededByClosingToken'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-1201"></span><span class="hs-identifier">precededByClosingToken'</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1202"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">prevChar</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1203"></span><span>    </span><span class="hs-char">'}'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">decodePrevNChars</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-string">&quot;-&quot;</span><span>
</span><span id="line-1204"></span><span>    </span><span class="hs-char">')'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1205"></span><span>    </span><span class="hs-char">']'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1206"></span><span>    </span><span class="hs-char">'\&quot;'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1207"></span><span>    </span><span class="hs-char">'\''</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1208"></span><span>    </span><span class="hs-char">'_'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1209"></span><span>    </span><span class="hs-char">'&#10215;'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1210"></span><span>    </span><span class="hs-char">'&#10632;'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1211"></span><span>    </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">isAlphaNum</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span class="hs-identifier">get_op_ws</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">OpWs</span><span>
</span><span id="line-1214"></span><span class="hs-identifier">get_op_ws</span><span> </span><span class="hs-identifier">buf1</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1215"></span><span>    </span><span class="hs-identifier">mk_op_ws</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">precededByClosingToken'</span><span> </span><span class="hs-identifier">buf1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">followedByOpeningToken'</span><span> </span><span class="hs-identifier">buf2</span><span class="hs-special">)</span><span>
</span><span id="line-1216"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1217"></span><span>    </span><span class="hs-identifier">mk_op_ws</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-identifier">True</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">OpWsPrefix</span><span>
</span><span id="line-1218"></span><span>    </span><span class="hs-identifier">mk_op_ws</span><span> </span><span class="hs-identifier">True</span><span>  </span><span class="hs-identifier">False</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">OpWsSuffix</span><span>
</span><span id="line-1219"></span><span>    </span><span class="hs-identifier">mk_op_ws</span><span> </span><span class="hs-identifier">True</span><span>  </span><span class="hs-identifier">True</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">OpWsTightInfix</span><span>
</span><span id="line-1220"></span><span>    </span><span class="hs-identifier">mk_op_ws</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">OpWsLooseInfix</span><span>
</span><span id="line-1221"></span><span>
</span><span id="line-1222"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">with_op_ws</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1223"></span><span class="hs-identifier">with_op_ws</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">OpWs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1224"></span><span class="hs-identifier">with_op_ws</span><span> </span><span class="hs-identifier">act</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">act</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">get_op_ws</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">buf2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-1225"></span><span>
</span><span id="line-1226"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">nextCharIs</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1227"></span><span class="hs-identifier">nextCharIs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-1228"></span><span class="hs-identifier">nextCharIs</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atEnd</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">currentChar</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>
</span><span id="line-1230"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">nextCharIsNot</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1231"></span><span class="hs-identifier">nextCharIsNot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-1232"></span><span class="hs-identifier">nextCharIsNot</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nextCharIs</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><span id="line-1233"></span><span>
</span><span id="line-1234"></span><span class="hs-identifier">notFollowedBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1235"></span><span class="hs-identifier">notFollowedBy</span><span> </span><span class="hs-identifier">char</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-1236"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nextCharIsNot</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">char</span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span>
</span><span id="line-1238"></span><span class="hs-identifier">notFollowedBySymbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1239"></span><span class="hs-identifier">notFollowedBySymbol</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-1240"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nextCharIsNot</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;!#$%&amp;*+./&lt;=&gt;?@\\^|-~&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>
</span><span id="line-1242"></span><span class="hs-identifier">followedByDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1243"></span><span class="hs-identifier">followedByDigit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-1244"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">afterOptionalSpace</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">nextCharIs</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-char">'0'</span><span class="hs-glyph">..</span><span class="hs-char">'9'</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1245"></span><span>
</span><span id="line-1246"></span><span class="hs-identifier">ifCurrentChar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1247"></span><span class="hs-identifier">ifCurrentChar</span><span> </span><span class="hs-identifier">char</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><span id="line-1248"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nextCharIs</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">char</span><span class="hs-special">)</span><span>
</span><span id="line-1249"></span><span>
</span><span id="line-1250"></span><span class="hs-comment">-- We must reject doc comments as being ordinary comments everywhere.</span><span>
</span><span id="line-1251"></span><span class="hs-comment">-- In some cases the doc comment will be selected as the lexeme due to</span><span>
</span><span id="line-1252"></span><span class="hs-comment">-- maximal munch, but not always, because the nested comment rule is</span><span>
</span><span id="line-1253"></span><span class="hs-comment">-- valid in all states, but the doc-comment rules are only valid in</span><span>
</span><span id="line-1254"></span><span class="hs-comment">-- the non-layout states.</span><span>
</span><span id="line-1255"></span><span class="hs-identifier">isNormalComment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1256"></span><span class="hs-identifier">isNormalComment</span><span> </span><span class="hs-identifier">bits</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-1257"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">HaddockBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">xtest</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">bits</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">notFollowedByDocOrPragma</span><span>
</span><span id="line-1258"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nextCharIsNot</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-operator">==</span><span> </span><span class="hs-char">'#'</span><span class="hs-special">)</span><span>
</span><span id="line-1259"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1260"></span><span>    </span><span class="hs-identifier">notFollowedByDocOrPragma</span><span>
</span><span id="line-1261"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">afterOptionalSpace</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">nextCharIsNot</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;|^*$#&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1262"></span><span>
</span><span id="line-1263"></span><span class="hs-identifier">afterOptionalSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-1264"></span><span class="hs-identifier">afterOptionalSpace</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">p</span><span>
</span><span id="line-1265"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">nextCharIs</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-operator">==</span><span> </span><span class="hs-char">' '</span><span class="hs-special">)</span><span>
</span><span id="line-1266"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">snd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nextChar</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1267"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-1268"></span><span>
</span><span id="line-1269"></span><span class="hs-identifier">atEOL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1270"></span><span class="hs-identifier">atEOL</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">atEnd</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">currentChar</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-char">'\n'</span><span>
</span><span id="line-1271"></span><span>
</span><span id="line-1272"></span><span class="hs-comment">-- Check if we should parse a negative literal (e.g. -123) as a single token.</span><span>
</span><span id="line-1273"></span><span class="hs-identifier">negLitPred</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1274"></span><span class="hs-identifier">negLitPred</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1275"></span><span>    </span><span class="hs-identifier">prefix_minus</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span>
</span><span id="line-1276"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">negative_literals</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexOrPred</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">lexical_negation</span><span class="hs-special">)</span><span>
</span><span id="line-1277"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1278"></span><span>    </span><span class="hs-identifier">negative_literals</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">NegativeLiteralsBit</span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span>    </span><span class="hs-identifier">lexical_negation</span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-1281"></span><span>      </span><span class="hs-comment">-- See Note [Why not LexicalNegationBit]</span><span>
</span><span id="line-1282"></span><span>      </span><span class="hs-identifier">alexNotPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">NoLexicalNegationBit</span><span class="hs-special">)</span><span>
</span><span id="line-1283"></span><span>
</span><span id="line-1284"></span><span>    </span><span class="hs-identifier">prefix_minus</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1285"></span><span>      </span><span class="hs-comment">-- Note [prefix_minus in negLitPred and negHashLitPred]</span><span>
</span><span id="line-1286"></span><span>      </span><span class="hs-identifier">alexNotPred</span><span> </span><span class="hs-identifier">precededByClosingToken</span><span>
</span><span id="line-1287"></span><span>
</span><span id="line-1288"></span><span class="hs-comment">-- Check if we should parse an unboxed negative literal (e.g. -123#) as a single token.</span><span>
</span><span id="line-1289"></span><span class="hs-identifier">negHashLitPred</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1290"></span><span class="hs-identifier">negHashLitPred</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">prefix_minus</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">alexAndPred</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">magic_hash</span><span>
</span><span id="line-1291"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1292"></span><span>    </span><span class="hs-identifier">magic_hash</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">MagicHashBit</span><span>
</span><span id="line-1293"></span><span>    </span><span class="hs-identifier">prefix_minus</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1294"></span><span>      </span><span class="hs-comment">-- Note [prefix_minus in negLitPred and negHashLitPred]</span><span>
</span><span id="line-1295"></span><span>      </span><span class="hs-identifier">alexNotPred</span><span> </span><span class="hs-identifier">precededByClosingToken</span><span>
</span><span id="line-1296"></span><span>
</span><span id="line-1297"></span><span class="hs-comment">{- Note [prefix_minus in negLitPred and negHashLitPred]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We want to parse -1 as a single token, but x-1 as three tokens.
So in negLitPred (and negHashLitPred) we require that we have a prefix
occurrence of the minus sign. See Note [Whitespace-sensitive operator parsing]
for a detailed definition of a prefix occurrence.

The condition for a prefix occurrence of an operator is:

  not precededByClosingToken &amp;&amp; followedByOpeningToken

but we don't check followedByOpeningToken when parsing a negative literal.
It holds simply because we immediately lex a literal after the minus.
-}</span><span>
</span><span id="line-1311"></span><span>
</span><span id="line-1312"></span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ExtBits</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-1313"></span><span class="hs-identifier">ifExtension</span><span> </span><span class="hs-identifier">extBits</span><span> </span><span class="hs-identifier">bits</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">extBits</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">xtest</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">bits</span><span>
</span><span id="line-1314"></span><span>
</span><span id="line-1315"></span><span class="hs-identifier">alexNotPred</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">userState</span><span> </span><span class="hs-identifier">in1</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">in2</span><span>
</span><span id="line-1316"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">userState</span><span> </span><span class="hs-identifier">in1</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">in2</span><span class="hs-special">)</span><span>
</span><span id="line-1317"></span><span>
</span><span id="line-1318"></span><span class="hs-identifier">alexOrPred</span><span> </span><span class="hs-identifier">p1</span><span> </span><span class="hs-identifier">p2</span><span> </span><span class="hs-identifier">userState</span><span> </span><span class="hs-identifier">in1</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">in2</span><span>
</span><span id="line-1319"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">p1</span><span> </span><span class="hs-identifier">userState</span><span> </span><span class="hs-identifier">in1</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">in2</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">p2</span><span> </span><span class="hs-identifier">userState</span><span> </span><span class="hs-identifier">in1</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">in2</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span class="hs-identifier">multiline_doc_comment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1322"></span><span class="hs-identifier">multiline_doc_comment</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;multiline_doc_comment&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-identifier">withLexedDocType</span><span> </span><span class="hs-identifier">worker</span><span>
</span><span id="line-1323"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1324"></span><span>    </span><span class="hs-identifier">worker</span><span> </span><span class="hs-identifier">input</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">start_loc</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">docType</span><span> </span><span class="hs-identifier">checkNextLine</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">start_loc</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1325"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1326"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">start_loc</span><span> </span><span class="hs-identifier">curLine</span><span> </span><span class="hs-identifier">prevLines</span><span> </span><span class="hs-identifier">input</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end_loc</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1327"></span><span>            </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input'</span><span class="hs-special">)</span><span>
</span><span id="line-1328"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">checkNextLine</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">checkIfCommentLine</span><span> </span><span class="hs-identifier">input'</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1329"></span><span>                </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">input</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">next_start</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">next_start</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">locatedLine</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">prevLines</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-comment">-- Start a new line</span><span>
</span><span id="line-1330"></span><span>                </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">endComment</span><span>
</span><span id="line-1331"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">endComment</span><span>
</span><span id="line-1332"></span><span>            </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">start_loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">curLine</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">prevLines</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1333"></span><span>            </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">endComment</span><span>
</span><span id="line-1334"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1335"></span><span>            </span><span class="hs-identifier">lineSpan</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">start_loc</span><span> </span><span class="hs-identifier">end_loc</span><span>
</span><span id="line-1336"></span><span>            </span><span class="hs-identifier">locatedLine</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">lineSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkHsDocStringChunk</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">curLine</span><span class="hs-special">)</span><span>
</span><span id="line-1337"></span><span>            </span><span class="hs-identifier">commentLines</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">NE.reverse</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">locatedLine</span><span> </span><span class="hs-operator">:|</span><span> </span><span class="hs-identifier">prevLines</span><span>
</span><span id="line-1338"></span><span>            </span><span class="hs-identifier">endComment</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">docCommentEnd</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">docType</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">dec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">MultiLineDocString</span><span> </span><span class="hs-identifier">dec</span><span> </span><span class="hs-identifier">commentLines</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">span</span><span>
</span><span id="line-1339"></span><span>
</span><span id="line-1340"></span><span>    </span><span class="hs-comment">-- Check if the next line of input belongs to this doc comment as well.</span><span>
</span><span id="line-1341"></span><span>    </span><span class="hs-comment">-- A doc comment continues onto the next line when the following</span><span>
</span><span id="line-1342"></span><span>    </span><span class="hs-comment">-- conditions are met:</span><span>
</span><span id="line-1343"></span><span>    </span><span class="hs-comment">--   * The line starts with &quot;--&quot;</span><span>
</span><span id="line-1344"></span><span>    </span><span class="hs-comment">--   * The line doesn't start with &quot;---&quot;.</span><span>
</span><span id="line-1345"></span><span>    </span><span class="hs-comment">--   * The line doesn't start with &quot;-- $&quot;, because that would be the</span><span>
</span><span id="line-1346"></span><span>    </span><span class="hs-comment">--     start of a /new/ named haddock chunk (#10398).</span><span>
</span><span id="line-1347"></span><span>    </span><span class="hs-identifier">checkIfCommentLine</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">AlexInput</span><span>
</span><span id="line-1348"></span><span>    </span><span class="hs-identifier">checkIfCommentLine</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">check</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dropNonNewlineSpace</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span>
</span><span id="line-1349"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1350"></span><span>        </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1351"></span><span>          </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1352"></span><span>          </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1353"></span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">after_c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1354"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1355"></span><span>            </span><span class="hs-char">'-'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-1356"></span><span>            </span><span class="hs-char">' '</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">after_c</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1357"></span><span>                     </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'$'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-1358"></span><span>                     </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1359"></span><span>            </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1360"></span><span>
</span><span id="line-1361"></span><span>        </span><span class="hs-identifier">dropNonNewlineSpace</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1362"></span><span>          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input'</span><span class="hs-special">)</span><span>
</span><span id="line-1363"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isSpace</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">dropNonNewlineSpace</span><span> </span><span class="hs-identifier">input'</span><span>
</span><span id="line-1364"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1365"></span><span>          </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1366"></span><span>
</span><span id="line-1367"></span><span class="hs-identifier">lineCommentToken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1368"></span><span class="hs-identifier">lineCommentToken</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1369"></span><span>  </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">RawTokenStreamBit</span><span>
</span><span id="line-1370"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1371"></span><span>         </span><span class="hs-identifier">lt</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLastLocComment</span><span>
</span><span id="line-1372"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITlineComment</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">lt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-1373"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-1374"></span><span>
</span><span id="line-1375"></span><span>
</span><span id="line-1376"></span><span class="hs-comment">{-
  nested comments require traversing by hand, they can't be parsed
  using regular expressions.
-}</span><span>
</span><span id="line-1380"></span><span class="hs-identifier">nested_comment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1381"></span><span class="hs-identifier">nested_comment</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;nested_comment&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1382"></span><span>  </span><span class="hs-identifier">l</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLastLocComment</span><span>
</span><span id="line-1383"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">endComment</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">comment</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">commentEnd</span><span> </span><span class="hs-identifier">lexToken</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ITblockComment</span><span> </span><span class="hs-identifier">comment</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">span</span><span>
</span><span id="line-1384"></span><span>  </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-1385"></span><span>  </span><span class="hs-comment">-- Include decorator in comment</span><span>
</span><span id="line-1386"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">start_decorator</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">reverse</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1387"></span><span>  </span><span class="hs-identifier">nested_comment_logic</span><span> </span><span class="hs-identifier">endComment</span><span> </span><span class="hs-identifier">start_decorator</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-identifier">span</span><span>
</span><span id="line-1388"></span><span>
</span><span id="line-1389"></span><span class="hs-identifier">nested_doc_comment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1390"></span><span class="hs-identifier">nested_doc_comment</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;nested_doc_comment&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-identifier">withLexedDocType</span><span> </span><span class="hs-identifier">worker</span><span>
</span><span id="line-1391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1392"></span><span>    </span><span class="hs-identifier">worker</span><span> </span><span class="hs-identifier">input</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">start_loc</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">docType</span><span> </span><span class="hs-identifier">_checkNextLine</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nested_comment_logic</span><span> </span><span class="hs-identifier">endComment</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">start_loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psSpanEnd</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1394"></span><span>        </span><span class="hs-identifier">endComment</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-identifier">lcomment</span><span>
</span><span id="line-1395"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">docCommentEnd</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">docType</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">NestedDocString</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkHsDocStringChunk</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">dropTrailingDec</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">lcomment</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">span</span><span>
</span><span id="line-1396"></span><span>
</span><span id="line-1397"></span><span>        </span><span class="hs-identifier">dropTrailingDec</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1398"></span><span>        </span><span class="hs-identifier">dropTrailingDec</span><span> </span><span class="hs-string">&quot;-}&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><span id="line-1399"></span><span>        </span><span class="hs-identifier">dropTrailingDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">dropTrailingDec</span><span> </span><span class="hs-identifier">xs</span><span>
</span><span id="line-1400"></span><span>
</span><span id="line-1401"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">nested_comment_logic</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1402"></span><span class="hs-comment">-- | Includes the trailing '-}' decorators</span><span>
</span><span id="line-1403"></span><span class="hs-comment">-- drop the last two elements with the callback if you don't want them to be included</span><span>
</span><span id="line-1404"></span><span class="hs-identifier">nested_comment_logic</span><span>
</span><span id="line-1405"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Located</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Continuation that gets the rest of the input and the lexed comment</span><span>
</span><span id="line-1406"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-comment">-- ^ starting value for accumulator (reversed) - When we want to include a decorator '{-' in the comment</span><span>
</span><span id="line-1407"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexInput</span><span>
</span><span id="line-1408"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsSpan</span><span>
</span><span id="line-1409"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1410"></span><span class="hs-identifier">nested_comment_logic</span><span> </span><span class="hs-identifier">endComment</span><span> </span><span class="hs-identifier">commentAcc</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">commentAcc</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-glyph">::</span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1411"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1412"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">commentAcc</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">input</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end_loc</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1413"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">comment</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">commentAcc</span><span>
</span><span id="line-1414"></span><span>          </span><span class="hs-identifier">cspan</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">end_loc</span><span>
</span><span id="line-1415"></span><span>          </span><span class="hs-identifier">lcomment</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">cspan</span><span> </span><span class="hs-identifier">comment</span><span>
</span><span id="line-1416"></span><span>      </span><span class="hs-identifier">endComment</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-identifier">lcomment</span><span>
</span><span id="line-1417"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">commentAcc</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1418"></span><span>      </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">errBrace</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span>
</span><span id="line-1419"></span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-special">,</span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1420"></span><span>        </span><span class="hs-identifier">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">errBrace</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span>
</span><span id="line-1421"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\125'</span><span class="hs-special">,</span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\125'</span><span class="hs-glyph">:</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><span class="hs-identifier">commentAcc</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-comment">-- '}'</span><span>
</span><span id="line-1422"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><span class="hs-identifier">commentAcc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1423"></span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\123'</span><span class="hs-special">,</span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>  </span><span class="hs-comment">-- '{' char</span><span>
</span><span id="line-1424"></span><span>        </span><span class="hs-identifier">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">errBrace</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span>
</span><span id="line-1425"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-special">,</span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><span class="hs-char">'\123'</span><span class="hs-glyph">:</span><span class="hs-identifier">commentAcc</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-operator">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1426"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\123'</span><span class="hs-glyph">:</span><span class="hs-identifier">commentAcc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1427"></span><span>      </span><span class="hs-comment">-- See Note [Nested comment line pragmas]</span><span>
</span><span id="line-1428"></span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-special">,</span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1429"></span><span>        </span><span class="hs-identifier">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">errBrace</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span>
</span><span id="line-1430"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'#'</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">parsedAcc</span><span class="hs-special">,</span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">parseNestedPragma</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1431"></span><span>                           </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">parsedAcc</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-char">'\n'</span><span class="hs-glyph">:</span><span class="hs-identifier">commentAcc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1432"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-glyph">:</span><span class="hs-identifier">commentAcc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1433"></span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">commentAcc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1434"></span><span>
</span><span id="line-1435"></span><span class="hs-comment">-- See Note [Nested comment line pragmas]</span><span>
</span><span id="line-1436"></span><span class="hs-identifier">parseNestedPragma</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">String</span><span class="hs-special">,</span><span class="hs-identifier">AlexInput</span><span class="hs-special">)</span><span>
</span><span id="line-1437"></span><span class="hs-identifier">parseNestedPragma</span><span> </span><span class="hs-identifier">input</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1438"></span><span>  </span><span class="hs-identifier">origInput</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-1439"></span><span>  </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1440"></span><span>  </span><span class="hs-identifier">setExts</span><span> </span><span class="hs-special">(</span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">InNestedCommentBit</span><span class="hs-special">)</span><span>
</span><span id="line-1441"></span><span>  </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">bol</span><span>
</span><span id="line-1442"></span><span>  </span><span class="hs-identifier">lt</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-1443"></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1444"></span><span>  </span><span class="hs-identifier">setExts</span><span> </span><span class="hs-special">(</span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">complement</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">InNestedCommentBit</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1445"></span><span>  </span><span class="hs-identifier">postInput</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">postBuf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-1446"></span><span>  </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">origInput</span><span>
</span><span id="line-1447"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-identifier">lt</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1448"></span><span>    </span><span class="hs-identifier">ITcomment_line_prag</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1449"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">bytes</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">byteDiff</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">postBuf</span><span>
</span><span id="line-1450"></span><span>          </span><span class="hs-identifier">diff</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">bytes</span><span>
</span><span id="line-1451"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">diff</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">postInput</span><span class="hs-special">)</span><span>
</span><span id="line-1452"></span><span>    </span><span class="hs-identifier">lt'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">panic</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;parseNestedPragma: unexpected token&quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">lt'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1453"></span><span>
</span><span id="line-1454"></span><span class="hs-comment">{-
Note [Nested comment line pragmas]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We used to ignore cpp-preprocessor-generated #line pragmas if they were inside
nested comments.

Now, when parsing a nested comment, if we encounter a line starting with '#' we
call parseNestedPragma, which executes the following:
1. Save the current lexer input (loc, buf) for later
2. Set the current lexer input to the beginning of the line starting with '#'
3. Turn the 'InNestedComment' extension on
4. Push the 'bol' lexer state
5. Lex a token. Due to (2), (3), and (4), this should always lex a single line
   or less and return the ITcomment_line_prag token. This may set source line
   and file location if a #line pragma is successfully parsed
6. Restore lexer input and state to what they were before we did all this
7. Return control to the function parsing a nested comment, informing it of
   what the lexer parsed

Regarding (5) above:
Every exit from the 'bol' lexer state (do_bol, popLinePrag1, failLinePrag1)
checks if the 'InNestedComment' extension is set. If it is, that function will
return control to parseNestedPragma by returning the ITcomment_line_prag token.

See #314 for more background on the bug this fixes.
-}</span><span>
</span><span id="line-1480"></span><span>
</span><span id="line-1481"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">withLexedDocType</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1482"></span><span class="hs-identifier">withLexedDocType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">HsDocStringDecorator</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">HsDocString</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HdkComment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1483"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1484"></span><span class="hs-identifier">withLexedDocType</span><span> </span><span class="hs-identifier">lexDocComment</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1485"></span><span>  </span><span class="hs-identifier">input</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-1486"></span><span>  </span><span class="hs-identifier">l</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLastLocComment</span><span>
</span><span id="line-1487"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">prevChar</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-char">' '</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1488"></span><span>    </span><span class="hs-comment">-- The `Bool` argument to lexDocComment signals whether or not the next</span><span>
</span><span id="line-1489"></span><span>    </span><span class="hs-comment">-- line of input might also belong to this doc comment.</span><span>
</span><span id="line-1490"></span><span>    </span><span class="hs-char">'|'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexDocComment</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkHdkCommentNext</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1491"></span><span>    </span><span class="hs-char">'^'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexDocComment</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkHdkCommentPrev</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1492"></span><span>    </span><span class="hs-char">'$'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">lexDocName</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1493"></span><span>       </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lexToken</span><span> </span><span class="hs-comment">-- eof reached, lex it normally</span><span>
</span><span id="line-1494"></span><span>       </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexDocComment</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkHdkCommentNamed</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1495"></span><span>    </span><span class="hs-char">'*'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexDocSection</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1496"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">panic</span><span> </span><span class="hs-string">&quot;withLexedDocType: Bad doc type&quot;</span><span>
</span><span id="line-1497"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1498"></span><span>    </span><span class="hs-identifier">lexDocSection</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1499"></span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'*'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexDocSection</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-operator">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1500"></span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexDocComment</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkHdkCommentSection</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-1501"></span><span>      </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lexToken</span><span> </span><span class="hs-comment">-- eof reached, lex it normally</span><span>
</span><span id="line-1502"></span><span>
</span><span id="line-1503"></span><span>    </span><span class="hs-identifier">lexDocName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AlexInput</span><span class="hs-special">)</span><span>
</span><span id="line-1504"></span><span>    </span><span class="hs-identifier">lexDocName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><span id="line-1505"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1506"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1507"></span><span>          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input'</span><span class="hs-special">)</span><span>
</span><span id="line-1508"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isSpace</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">acc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">)</span><span>
</span><span id="line-1509"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input'</span><span>
</span><span id="line-1510"></span><span>          </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-1511"></span><span>
</span><span id="line-1512"></span><span class="hs-identifier">mkHdkCommentNext</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkHdkCommentPrev</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HsDocStringDecorator</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">HsDocString</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HdkComment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1513"></span><span class="hs-identifier">mkHdkCommentNext</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">mkDS</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">HdkCommentNext</span><span> </span><span class="hs-identifier">ds</span><span class="hs-special">,</span><span class="hs-identifier">ITdocComment</span><span> </span><span class="hs-identifier">ds</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span>
</span><span id="line-1514"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">ds</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkDS</span><span> </span><span class="hs-identifier">HsDocStringNext</span><span>
</span><span id="line-1515"></span><span class="hs-identifier">mkHdkCommentPrev</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">mkDS</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">HdkCommentPrev</span><span> </span><span class="hs-identifier">ds</span><span class="hs-special">,</span><span class="hs-identifier">ITdocComment</span><span> </span><span class="hs-identifier">ds</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span>
</span><span id="line-1516"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">ds</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkDS</span><span> </span><span class="hs-identifier">HsDocStringPrevious</span><span>
</span><span id="line-1517"></span><span>
</span><span id="line-1518"></span><span class="hs-identifier">mkHdkCommentNamed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HsDocStringDecorator</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">HsDocString</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HdkComment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1519"></span><span class="hs-identifier">mkHdkCommentNamed</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">mkDS</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HdkCommentNamed</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ds</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ITdocComment</span><span> </span><span class="hs-identifier">ds</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span>
</span><span id="line-1520"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">ds</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkDS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HsDocStringNamed</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span>
</span><span id="line-1521"></span><span>
</span><span id="line-1522"></span><span class="hs-identifier">mkHdkCommentSection</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HsDocStringDecorator</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">HsDocString</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HdkComment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1523"></span><span class="hs-identifier">mkHdkCommentSection</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">mkDS</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HdkCommentSection</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">ds</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ITdocComment</span><span> </span><span class="hs-identifier">ds</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span>
</span><span id="line-1524"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">ds</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkDS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HsDocStringGroup</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><span id="line-1525"></span><span>
</span><span id="line-1526"></span><span class="hs-comment">-- RULES pragmas turn on the forall and '.' keywords, and we turn them</span><span>
</span><span id="line-1527"></span><span class="hs-comment">-- off again at the end of the pragma.</span><span>
</span><span id="line-1528"></span><span class="hs-identifier">rulePrag</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1529"></span><span class="hs-identifier">rulePrag</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1530"></span><span>  </span><span class="hs-identifier">setExts</span><span> </span><span class="hs-special">(</span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">InRulePragBit</span><span class="hs-special">)</span><span>
</span><span id="line-1531"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1532"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITrules_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1533"></span><span>
</span><span id="line-1534"></span><span class="hs-comment">-- When 'UsePosPragsBit' is not set, it is expected that we emit a token instead</span><span>
</span><span id="line-1535"></span><span class="hs-comment">-- of updating the position in 'PState'</span><span>
</span><span id="line-1536"></span><span class="hs-identifier">linePrag</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1537"></span><span class="hs-identifier">linePrag</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1538"></span><span>  </span><span class="hs-identifier">usePosPrags</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">UsePosPragsBit</span><span>
</span><span id="line-1539"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">usePosPrags</span><span>
</span><span id="line-1540"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">begin</span><span> </span><span class="hs-identifier">line_prag2</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-1541"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1542"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1543"></span><span>
</span><span id="line-1544"></span><span class="hs-comment">-- When 'UsePosPragsBit' is not set, it is expected that we emit a token instead</span><span>
</span><span id="line-1545"></span><span class="hs-comment">-- of updating the position in 'PState'</span><span>
</span><span id="line-1546"></span><span class="hs-identifier">columnPrag</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1547"></span><span class="hs-identifier">columnPrag</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1548"></span><span>  </span><span class="hs-identifier">usePosPrags</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">UsePosPragsBit</span><span>
</span><span id="line-1549"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1550"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">usePosPrags</span><span>
</span><span id="line-1551"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">begin</span><span> </span><span class="hs-identifier">column_prag</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-1552"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1553"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITcolumn_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1554"></span><span>
</span><span id="line-1555"></span><span class="hs-identifier">endPrag</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1556"></span><span class="hs-identifier">endPrag</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1557"></span><span>  </span><span class="hs-identifier">setExts</span><span> </span><span class="hs-special">(</span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">complement</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">InRulePragBit</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1558"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITclose_prag</span><span class="hs-special">)</span><span>
</span><span id="line-1559"></span><span>
</span><span id="line-1560"></span><span class="hs-comment">-- docCommentEnd</span><span>
</span><span id="line-1561"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-1562"></span><span class="hs-comment">-- This function is quite tricky. We can't just return a new token, we also</span><span>
</span><span id="line-1563"></span><span class="hs-comment">-- need to update the state of the parser. Why? Because the token is longer</span><span>
</span><span id="line-1564"></span><span class="hs-comment">-- than what was lexed by Alex, and the lexToken function doesn't know this, so</span><span>
</span><span id="line-1565"></span><span class="hs-comment">-- it writes the wrong token length to the parser state. This function is</span><span>
</span><span id="line-1566"></span><span class="hs-comment">-- called afterwards, so it can just update the state.</span><span>
</span><span id="line-1567"></span><span>
</span><span id="line-1568"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">commentEnd</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1569"></span><span class="hs-identifier">commentEnd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1570"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexInput</span><span>
</span><span id="line-1571"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">HdkComment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1572"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span>
</span><span id="line-1573"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsSpan</span><span>
</span><span id="line-1574"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1575"></span><span class="hs-identifier">commentEnd</span><span> </span><span class="hs-identifier">cont</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m_hdk_comment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hdk_token</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1576"></span><span>  </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1577"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">nextBuf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-1578"></span><span>      </span><span class="hs-identifier">span'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">loc</span><span>
</span><span id="line-1579"></span><span>      </span><span class="hs-identifier">last_len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">byteDiff</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">nextBuf</span><span>
</span><span id="line-1580"></span><span>  </span><span class="hs-identifier">span</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">setLastToken</span><span> </span><span class="hs-identifier">span'</span><span> </span><span class="hs-identifier">last_len</span><span>
</span><span id="line-1581"></span><span>  </span><span class="hs-identifier">whenIsJust</span><span> </span><span class="hs-identifier">m_hdk_comment</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">hdk_comment</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1582"></span><span>    </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">hdk_comments</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hdk_comments</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">snocOL</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span'</span><span> </span><span class="hs-identifier">hdk_comment</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1583"></span><span>  </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">RawTokenStreamBit</span><span>
</span><span id="line-1584"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span'</span><span> </span><span class="hs-identifier">hdk_token</span><span class="hs-special">)</span><span>
</span><span id="line-1585"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">cont</span><span>
</span><span id="line-1586"></span><span>
</span><span id="line-1587"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">docCommentEnd</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1588"></span><span class="hs-identifier">docCommentEnd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HdkComment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1589"></span><span>                 </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1590"></span><span class="hs-identifier">docCommentEnd</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">hdk_comment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">span</span><span>
</span><span id="line-1591"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">commentEnd</span><span> </span><span class="hs-identifier">lexToken</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">hdk_comment</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">span</span><span>
</span><span id="line-1592"></span><span>
</span><span id="line-1593"></span><span class="hs-identifier">errBrace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-1594"></span><span class="hs-identifier">errBrace</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1595"></span><span>  </span><span class="hs-identifier">failLocMsgP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">realSrcSpanStart</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span>
</span><span id="line-1596"></span><span>              </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span>
</span><span id="line-1597"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsErrLexer</span><span> </span><span class="hs-identifier">LexUnterminatedComment</span><span> </span><span class="hs-identifier">LexErrKind_EOF</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1598"></span><span>
</span><span id="line-1599"></span><span class="hs-identifier">open_brace</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">close_brace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1600"></span><span class="hs-identifier">open_brace</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_str</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1601"></span><span>  </span><span class="hs-identifier">ctx</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getContext</span><span>
</span><span id="line-1602"></span><span>  </span><span class="hs-identifier">setContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NoLayout</span><span class="hs-glyph">:</span><span class="hs-identifier">ctx</span><span class="hs-special">)</span><span>
</span><span id="line-1603"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITocurly</span><span class="hs-special">)</span><span>
</span><span id="line-1604"></span><span class="hs-identifier">close_brace</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_str</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1605"></span><span>  </span><span class="hs-identifier">popContext</span><span>
</span><span id="line-1606"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITccurly</span><span class="hs-special">)</span><span>
</span><span id="line-1607"></span><span>
</span><span id="line-1608"></span><span class="hs-identifier">qvarid</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">qconid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span>
</span><span id="line-1609"></span><span class="hs-identifier">qvarid</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITqvarid</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">splitQualName</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-1610"></span><span class="hs-identifier">qconid</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITqconid</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">splitQualName</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-1611"></span><span>
</span><span id="line-1612"></span><span class="hs-identifier">splitQualName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FastString</span><span class="hs-special">,</span><span class="hs-identifier">FastString</span><span class="hs-special">)</span><span>
</span><span id="line-1613"></span><span class="hs-comment">-- takes a StringBuffer and a length, and returns the module name</span><span>
</span><span id="line-1614"></span><span class="hs-comment">-- and identifier parts of a qualified name.  Splits at the *last* dot,</span><span>
</span><span id="line-1615"></span><span class="hs-comment">-- because of hierarchical module names.</span><span>
</span><span id="line-1616"></span><span class="hs-comment">--</span><span>
</span><span id="line-1617"></span><span class="hs-comment">-- Throws an error if the name is not qualified.</span><span>
</span><span id="line-1618"></span><span class="hs-identifier">splitQualName</span><span> </span><span class="hs-identifier">orig_buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">parens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">orig_buf</span><span> </span><span class="hs-identifier">orig_buf</span><span>
</span><span id="line-1619"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1620"></span><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">dot_buf</span><span>
</span><span id="line-1621"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">orig_buf</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">byteDiff</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-identifier">len</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">done</span><span> </span><span class="hs-identifier">dot_buf</span><span>
</span><span id="line-1622"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-char">'.'</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">found_dot</span><span> </span><span class="hs-identifier">buf'</span><span>
</span><span id="line-1623"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">buf'</span><span> </span><span class="hs-identifier">dot_buf</span><span>
</span><span id="line-1624"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1625"></span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">buf'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nextChar</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-1626"></span><span>
</span><span id="line-1627"></span><span>    </span><span class="hs-comment">-- careful, we might get names like M....</span><span>
</span><span id="line-1628"></span><span>    </span><span class="hs-comment">-- so, if the character after the dot is not upper-case, this is</span><span>
</span><span id="line-1629"></span><span>    </span><span class="hs-comment">-- the end of the qualifier part.</span><span>
</span><span id="line-1630"></span><span>    </span><span class="hs-identifier">found_dot</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-comment">-- buf points after the '.'</span><span>
</span><span id="line-1631"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isUpper</span><span> </span><span class="hs-identifier">c</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">buf'</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-1632"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">done</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-1633"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1634"></span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">buf'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nextChar</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-1635"></span><span>
</span><span id="line-1636"></span><span>    </span><span class="hs-identifier">done</span><span> </span><span class="hs-identifier">dot_buf</span><span>
</span><span id="line-1637"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">qual_size</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;splitQualName got an unqualified named&quot;</span><span>
</span><span id="line-1638"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1639"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-identifier">orig_buf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">qual_size</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1640"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">parens</span><span> </span><span class="hs-comment">-- Prelude.(+)</span><span>
</span><span id="line-1641"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stepOn</span><span> </span><span class="hs-identifier">dot_buf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">qual_size</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><span id="line-1642"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-identifier">dot_buf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">qual_size</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1643"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1644"></span><span>        </span><span class="hs-identifier">qual_size</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">orig_buf</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">byteDiff</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">dot_buf</span><span>
</span><span id="line-1645"></span><span>
</span><span id="line-1646"></span><span class="hs-identifier">varid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1647"></span><span class="hs-identifier">varid</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1648"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">lookupUFM</span><span> </span><span class="hs-identifier">reservedWordsFM</span><span> </span><span class="hs-identifier">fs</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1649"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITcase</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1650"></span><span>      </span><span class="hs-identifier">lastTk</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLastTk</span><span>
</span><span id="line-1651"></span><span>      </span><span class="hs-identifier">keyword</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">lastTk</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1652"></span><span>        </span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ITlam</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1653"></span><span>          </span><span class="hs-identifier">lambdaCase</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">LambdaCaseBit</span><span>
</span><span id="line-1654"></span><span>          </span><span class="hs-identifier">unless</span><span> </span><span class="hs-identifier">lambdaCase</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1655"></span><span>            </span><span class="hs-identifier">pState</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getPState</span><span>
</span><span id="line-1656"></span><span>            </span><span class="hs-identifier">addError</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-identifier">pState</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">PsErrLambdaCase</span><span>
</span><span id="line-1657"></span><span>          </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITlcase</span><span>
</span><span id="line-1658"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITcase</span><span>
</span><span id="line-1659"></span><span>      </span><span class="hs-identifier">maybe_layout</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1660"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1661"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITlcases</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1662"></span><span>      </span><span class="hs-identifier">lastTk</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLastTk</span><span>
</span><span id="line-1663"></span><span>      </span><span class="hs-identifier">lambdaCase</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">LambdaCaseBit</span><span>
</span><span id="line-1664"></span><span>      </span><span class="hs-identifier">token</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">lastTk</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1665"></span><span>        </span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ITlam</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">lambdaCase</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITlcases</span><span>
</span><span id="line-1666"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">ITvarid</span><span> </span><span class="hs-identifier">fs</span><span>
</span><span id="line-1667"></span><span>      </span><span class="hs-identifier">maybe_layout</span><span> </span><span class="hs-identifier">token</span><span>
</span><span id="line-1668"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">token</span><span>
</span><span id="line-1669"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">keyword</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1670"></span><span>      </span><span class="hs-identifier">maybe_layout</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1671"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1672"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">keyword</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1673"></span><span>      </span><span class="hs-identifier">exts</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getExts</span><span>
</span><span id="line-1674"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-1675"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1676"></span><span>          </span><span class="hs-identifier">maybe_layout</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1677"></span><span>          </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1678"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-1679"></span><span>          </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">ITvarid</span><span> </span><span class="hs-identifier">fs</span><span>
</span><span id="line-1680"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1681"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">ITvarid</span><span> </span><span class="hs-identifier">fs</span><span>
</span><span id="line-1682"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1683"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">fs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1684"></span><span>
</span><span id="line-1685"></span><span class="hs-identifier">conid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span>
</span><span id="line-1686"></span><span class="hs-identifier">conid</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITconid</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1687"></span><span>
</span><span id="line-1688"></span><span class="hs-identifier">qvarsym</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">qconsym</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span>
</span><span id="line-1689"></span><span class="hs-identifier">qvarsym</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITqvarsym</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">splitQualName</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-1690"></span><span class="hs-identifier">qconsym</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITqconsym</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">splitQualName</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-1691"></span><span>
</span><span id="line-1692"></span><span class="hs-comment">-- See Note [Whitespace-sensitive operator parsing]</span><span>
</span><span id="line-1693"></span><span class="hs-identifier">varsym</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">OpWs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1694"></span><span class="hs-identifier">varsym</span><span> </span><span class="hs-identifier">opws</span><span class="hs-glyph">@</span><span class="hs-identifier">OpWsPrefix</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sym</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1695"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">warnExtConflict</span><span> </span><span class="hs-identifier">errtok</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1696"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">addPsMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsWarnOperatorWhitespaceExtConflict</span><span> </span><span class="hs-identifier">errtok</span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITvarsym</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1698"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-1699"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;@&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1700"></span><span>         </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITtypeApp</span><span>  </span><span class="hs-comment">-- regardless of TypeApplications for better error messages</span><span>
</span><span id="line-1701"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;%&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1702"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">xtest</span><span> </span><span class="hs-identifier">LinearTypesBit</span><span> </span><span class="hs-identifier">exts</span><span>
</span><span id="line-1703"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITpercent</span><span>
</span><span id="line-1704"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">warnExtConflict</span><span> </span><span class="hs-identifier">OperatorWhitespaceSymbol_PrefixPercent</span><span>
</span><span id="line-1705"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;$&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1706"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">xtest</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span> </span><span class="hs-identifier">exts</span><span>
</span><span id="line-1707"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITdollar</span><span>
</span><span id="line-1708"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">warnExtConflict</span><span> </span><span class="hs-identifier">OperatorWhitespaceSymbol_PrefixDollar</span><span>
</span><span id="line-1709"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;$$&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1710"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">xtest</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span> </span><span class="hs-identifier">exts</span><span>
</span><span id="line-1711"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITdollardollar</span><span>
</span><span id="line-1712"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">warnExtConflict</span><span> </span><span class="hs-identifier">OperatorWhitespaceSymbol_PrefixDollarDollar</span><span>
</span><span id="line-1713"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1714"></span><span>         </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITprefixminus</span><span> </span><span class="hs-comment">-- Only when LexicalNegation is on, otherwise we get ITminus</span><span>
</span><span id="line-1715"></span><span>                              </span><span class="hs-comment">-- and don't hit this code path. See Note [Minus tokens]</span><span>
</span><span id="line-1716"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;.&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">OverloadedRecordDotBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">xtest</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1717"></span><span>         </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITproj</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- e.g. '(.x)'</span><span>
</span><span id="line-1718"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITdot</span><span>
</span><span id="line-1719"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;!&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITbang</span><span>
</span><span id="line-1720"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;~&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITtilde</span><span>
</span><span id="line-1721"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1722"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">warnOperatorWhitespace</span><span> </span><span class="hs-identifier">opws</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-1723"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITvarsym</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1724"></span><span class="hs-identifier">varsym</span><span> </span><span class="hs-identifier">opws</span><span class="hs-glyph">@</span><span class="hs-identifier">OpWsSuffix</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sym</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1725"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;@&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">failMsgP</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">PsErrSuffixAT</span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITdot</span><span>
</span><span id="line-1727"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1728"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">warnOperatorWhitespace</span><span> </span><span class="hs-identifier">opws</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-1729"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITvarsym</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1730"></span><span class="hs-identifier">varsym</span><span> </span><span class="hs-identifier">opws</span><span class="hs-glyph">@</span><span class="hs-identifier">OpWsTightInfix</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sym</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1731"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;@&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITat</span><span>
</span><span id="line-1732"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;.&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">OverloadedRecordDotBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">xtest</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">exts</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITproj</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span>
</span><span id="line-1733"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITdot</span><span>
</span><span id="line-1734"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1735"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">warnOperatorWhitespace</span><span> </span><span class="hs-identifier">opws</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-1736"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITvarsym</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1737"></span><span class="hs-identifier">varsym</span><span> </span><span class="hs-identifier">OpWsLooseInfix</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sym</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1738"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><span id="line-1739"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">ITdot</span><span>
</span><span id="line-1740"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-1741"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">ITvarsym</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-1742"></span><span>
</span><span id="line-1743"></span><span class="hs-identifier">consym</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">OpWs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1744"></span><span class="hs-identifier">consym</span><span> </span><span class="hs-identifier">opws</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sym</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_exts</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1745"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">warnOperatorWhitespace</span><span> </span><span class="hs-identifier">opws</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-1746"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITconsym</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1747"></span><span>
</span><span id="line-1748"></span><span class="hs-identifier">warnOperatorWhitespace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">OpWs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1749"></span><span class="hs-identifier">warnOperatorWhitespace</span><span> </span><span class="hs-identifier">opws</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1750"></span><span>  </span><span class="hs-identifier">whenIsJust</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">check_unusual_opws</span><span> </span><span class="hs-identifier">opws</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">opws'</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1751"></span><span>    </span><span class="hs-identifier">addPsMessage</span><span>
</span><span id="line-1752"></span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span>
</span><span id="line-1753"></span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">PsWarnOperatorWhitespace</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">opws'</span><span class="hs-special">)</span><span>
</span><span id="line-1754"></span><span>
</span><span id="line-1755"></span><span class="hs-comment">-- Check an operator occurrence for unusual whitespace (prefix, suffix, tight infix).</span><span>
</span><span id="line-1756"></span><span class="hs-comment">-- This determines if -Woperator-whitespace is triggered.</span><span>
</span><span id="line-1757"></span><span class="hs-identifier">check_unusual_opws</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">OpWs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">OperatorWhitespaceOccurrence</span><span>
</span><span id="line-1758"></span><span class="hs-identifier">check_unusual_opws</span><span> </span><span class="hs-identifier">opws</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1759"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">opws</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1760"></span><span>    </span><span class="hs-identifier">OpWsPrefix</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">OperatorWhitespaceOccurrence_Prefix</span><span>
</span><span id="line-1761"></span><span>    </span><span class="hs-identifier">OpWsSuffix</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">OperatorWhitespaceOccurrence_Suffix</span><span>
</span><span id="line-1762"></span><span>    </span><span class="hs-identifier">OpWsTightInfix</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">OperatorWhitespaceOccurrence_TightInfix</span><span>
</span><span id="line-1763"></span><span>    </span><span class="hs-identifier">OpWsLooseInfix</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-1764"></span><span>
</span><span id="line-1765"></span><span class="hs-identifier">sym</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1766"></span><span class="hs-identifier">sym</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1767"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">lookupUFM</span><span> </span><span class="hs-identifier">reservedSymsFM</span><span> </span><span class="hs-identifier">fs</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1768"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">keyword</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1769"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1770"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">keyword</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1771"></span><span>      </span><span class="hs-identifier">exts</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getExts</span><span>
</span><span id="line-1772"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-1773"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1774"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-identifier">fs</span><span>
</span><span id="line-1775"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">keyword</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1776"></span><span>      </span><span class="hs-identifier">exts</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getExts</span><span>
</span><span id="line-1777"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">xtest</span><span> </span><span class="hs-identifier">UnicodeSyntaxBit</span><span> </span><span class="hs-identifier">exts</span><span>
</span><span id="line-1778"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1779"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-identifier">fs</span><span>
</span><span id="line-1780"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">keyword</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1781"></span><span>      </span><span class="hs-identifier">exts</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getExts</span><span>
</span><span id="line-1782"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">xtest</span><span> </span><span class="hs-identifier">UnicodeSyntaxBit</span><span> </span><span class="hs-identifier">exts</span><span>
</span><span id="line-1783"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">keyword</span><span>
</span><span id="line-1784"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-identifier">fs</span><span>
</span><span id="line-1785"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1786"></span><span>      </span><span class="hs-identifier">exts</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getExts</span><span>
</span><span id="line-1787"></span><span>      </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-identifier">fs</span><span>
</span><span id="line-1788"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1789"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">fs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToFastString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1790"></span><span>
</span><span id="line-1791"></span><span class="hs-comment">-- Variations on the integral numeric literal.</span><span>
</span><span id="line-1792"></span><span class="hs-identifier">tok_integral</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-1793"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span>
</span><span id="line-1794"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-1795"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1796"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1797"></span><span class="hs-identifier">tok_integral</span><span> </span><span class="hs-identifier">itint</span><span> </span><span class="hs-identifier">transint</span><span> </span><span class="hs-identifier">transbuf</span><span> </span><span class="hs-identifier">translen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">radix</span><span class="hs-special">,</span><span class="hs-identifier">char_to_int</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1798"></span><span>  </span><span class="hs-identifier">numericUnderscores</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">NumericUnderscoresBit</span><span>  </span><span class="hs-comment">-- #14473</span><span>
</span><span id="line-1799"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1800"></span><span>  </span><span class="hs-identifier">when</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">numericUnderscores</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-char">'_'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1801"></span><span>    </span><span class="hs-identifier">pState</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getPState</span><span>
</span><span id="line-1802"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsErrNumUnderscores</span><span> </span><span class="hs-identifier">NumUnderscore_Integral</span><span>
</span><span id="line-1803"></span><span>    </span><span class="hs-identifier">addError</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-identifier">pState</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-1804"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">itint</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span>
</span><span id="line-1805"></span><span>       </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">transint</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">parseUnsignedInteger</span><span>
</span><span id="line-1806"></span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">offsetBytes</span><span> </span><span class="hs-identifier">transbuf</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">subtract</span><span> </span><span class="hs-identifier">translen</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">radix</span><span> </span><span class="hs-identifier">char_to_int</span><span>
</span><span id="line-1807"></span><span>
</span><span id="line-1808"></span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span>
</span><span id="line-1809"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-1810"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1811"></span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_integral</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1812"></span><span>    </span><span class="hs-identifier">st</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">itint</span><span> </span><span class="hs-identifier">st</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">)</span><span>
</span><span id="line-1813"></span><span>    </span><span class="hs-identifier">st</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">itint</span><span> </span><span class="hs-identifier">st</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span>
</span><span id="line-1814"></span><span>    </span><span class="hs-identifier">st</span><span class="hs-glyph">@</span><span class="hs-identifier">NoSourceText</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">itint</span><span> </span><span class="hs-identifier">st</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-1815"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1816"></span><span>    </span><span class="hs-identifier">itint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span>
</span><span id="line-1817"></span><span>    </span><span class="hs-identifier">itint</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">st</span><span> </span><span class="hs-identifier">is_negative</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">val</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITinteger</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">IL</span><span> </span><span class="hs-identifier">st</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">is_negative</span><span> </span><span class="hs-identifier">val</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">val</span><span class="hs-special">)</span><span>
</span><span id="line-1818"></span><span>
</span><span id="line-1819"></span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span>
</span><span id="line-1820"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-1821"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1822"></span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_integral</span><span> </span><span class="hs-identifier">ITprimint</span><span>
</span><span id="line-1823"></span><span>
</span><span id="line-1824"></span><span>
</span><span id="line-1825"></span><span class="hs-identifier">tok_primword</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-1826"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1827"></span><span class="hs-identifier">tok_primword</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_integral</span><span> </span><span class="hs-identifier">ITprimword</span><span> </span><span class="hs-identifier">positive</span><span>
</span><span id="line-1828"></span><span class="hs-identifier">positive</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span>
</span><span id="line-1829"></span><span class="hs-identifier">positive</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">id</span><span>
</span><span id="line-1830"></span><span class="hs-identifier">negative</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">negate</span><span>
</span><span id="line-1831"></span><span class="hs-identifier">decimal</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">octal</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hexadecimal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span>
</span><span id="line-1832"></span><span class="hs-identifier">decimal</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">10</span><span class="hs-special">,</span><span class="hs-identifier">octDecDigit</span><span class="hs-special">)</span><span>
</span><span id="line-1833"></span><span class="hs-identifier">binary</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-identifier">octDecDigit</span><span class="hs-special">)</span><span>
</span><span id="line-1834"></span><span class="hs-identifier">octal</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">8</span><span class="hs-special">,</span><span class="hs-identifier">octDecDigit</span><span class="hs-special">)</span><span>
</span><span id="line-1835"></span><span class="hs-identifier">hexadecimal</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-identifier">hexDigit</span><span class="hs-special">)</span><span>
</span><span id="line-1836"></span><span>
</span><span id="line-1837"></span><span class="hs-comment">-- readSignificandExponentPair can understand negative rationals, exponents, everything.</span><span>
</span><span id="line-1838"></span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1839"></span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1840"></span><span>  </span><span class="hs-identifier">numericUnderscores</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">NumericUnderscoresBit</span><span>  </span><span class="hs-comment">-- #14473</span><span>
</span><span id="line-1841"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-glyph">-</span><span class="hs-identifier">drop</span><span class="hs-special">)</span><span>
</span><span id="line-1842"></span><span>  </span><span class="hs-identifier">when</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">numericUnderscores</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-char">'_'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1843"></span><span>    </span><span class="hs-identifier">pState</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getPState</span><span>
</span><span id="line-1844"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsErrNumUnderscores</span><span> </span><span class="hs-identifier">NumUnderscore_Float</span><span>
</span><span id="line-1845"></span><span>    </span><span class="hs-identifier">addError</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-identifier">pState</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-1846"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1847"></span><span>
</span><span id="line-1848"></span><span class="hs-identifier">tok_float</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tok_primfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tok_primdouble</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span>
</span><span id="line-1849"></span><span class="hs-identifier">tok_float</span><span>        </span><span class="hs-identifier">str</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITrational</span><span>   </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">readFractionalLit</span><span> </span><span class="hs-identifier">str</span><span>
</span><span id="line-1850"></span><span class="hs-identifier">tok_hex_float</span><span>    </span><span class="hs-identifier">str</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITrational</span><span>   </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">readHexFractionalLit</span><span> </span><span class="hs-identifier">str</span><span>
</span><span id="line-1851"></span><span class="hs-identifier">tok_primfloat</span><span>    </span><span class="hs-identifier">str</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITprimfloat</span><span>  </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">readFractionalLit</span><span> </span><span class="hs-identifier">str</span><span>
</span><span id="line-1852"></span><span class="hs-identifier">tok_primdouble</span><span>   </span><span class="hs-identifier">str</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITprimdouble</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">readFractionalLit</span><span> </span><span class="hs-identifier">str</span><span>
</span><span id="line-1853"></span><span>
</span><span id="line-1854"></span><span class="hs-identifier">readFractionalLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">readHexFractionalLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FractionalLit</span><span>
</span><span id="line-1855"></span><span class="hs-identifier">readHexFractionalLit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readFractionalLitX</span><span> </span><span class="hs-identifier">readHexSignificandExponentPair</span><span> </span><span class="hs-identifier">Base2</span><span>
</span><span id="line-1856"></span><span class="hs-identifier">readFractionalLit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readFractionalLitX</span><span> </span><span class="hs-identifier">readSignificandExponentPair</span><span> </span><span class="hs-identifier">Base10</span><span>
</span><span id="line-1857"></span><span>
</span><span id="line-1858"></span><span class="hs-identifier">readFractionalLitX</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1859"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FractionalExponentBase</span><span>
</span><span id="line-1860"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FractionalLit</span><span>
</span><span id="line-1861"></span><span class="hs-identifier">readFractionalLitX</span><span> </span><span class="hs-identifier">readStr</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1862"></span><span>  </span><span class="hs-identifier">mkSourceFractionalLit</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">is_neg</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-1863"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1864"></span><span>    </span><span class="hs-identifier">is_neg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1865"></span><span>                    </span><span class="hs-char">'-'</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-1866"></span><span>                    </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-1867"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readStr</span><span> </span><span class="hs-identifier">str</span><span>
</span><span id="line-1868"></span><span>
</span><span id="line-1869"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1870"></span><span class="hs-comment">-- Layout processing</span><span>
</span><span id="line-1871"></span><span>
</span><span id="line-1872"></span><span class="hs-comment">-- we're at the first token on a line, insert layout tokens if necessary</span><span>
</span><span id="line-1873"></span><span class="hs-identifier">do_bol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1874"></span><span class="hs-identifier">do_bol</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_str</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1875"></span><span>        </span><span class="hs-comment">-- See Note [Nested comment line pragmas]</span><span>
</span><span id="line-1876"></span><span>        </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">InNestedCommentBit</span><span>
</span><span id="line-1877"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITcomment_line_prag</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1878"></span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">pos</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gen_semic</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getOffside</span><span>
</span><span id="line-1879"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">pos</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1880"></span><span>              </span><span class="hs-identifier">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1881"></span><span>                  </span><span class="hs-comment">--trace &quot;layout: inserting '}'&quot; $ do</span><span>
</span><span id="line-1882"></span><span>                  </span><span class="hs-identifier">popContext</span><span>
</span><span id="line-1883"></span><span>                  </span><span class="hs-comment">-- do NOT pop the lex state, we might have a ';' to insert</span><span>
</span><span id="line-1884"></span><span>                  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-1885"></span><span>              </span><span class="hs-identifier">EQ</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">gen_semic</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1886"></span><span>                  </span><span class="hs-comment">--trace &quot;layout: inserting ';'&quot; $ do</span><span>
</span><span id="line-1887"></span><span>                  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1888"></span><span>                  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITsemi</span><span class="hs-special">)</span><span>
</span><span id="line-1889"></span><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1890"></span><span>                  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1891"></span><span>                  </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-1892"></span><span>
</span><span id="line-1893"></span><span class="hs-comment">-- certain keywords put us in the &quot;layout&quot; state, where we might</span><span>
</span><span id="line-1894"></span><span class="hs-comment">-- add an opening curly brace.</span><span>
</span><span id="line-1895"></span><span class="hs-identifier">maybe_layout</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1896"></span><span class="hs-identifier">maybe_layout</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- If the alternative layout rule is enabled then</span><span>
</span><span id="line-1897"></span><span>                    </span><span class="hs-comment">-- we never create an implicit layout context here.</span><span>
</span><span id="line-1898"></span><span>                    </span><span class="hs-comment">-- Layout is handled XXX instead.</span><span>
</span><span id="line-1899"></span><span>                    </span><span class="hs-comment">-- The code for closing implicit contexts, or</span><span>
</span><span id="line-1900"></span><span>                    </span><span class="hs-comment">-- inserting implicit semi-colons, is therefore</span><span>
</span><span id="line-1901"></span><span>                    </span><span class="hs-comment">-- irrelevant as it only applies in an implicit</span><span>
</span><span id="line-1902"></span><span>                    </span><span class="hs-comment">-- context.</span><span>
</span><span id="line-1903"></span><span>                    </span><span class="hs-identifier">alr</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">AlternativeLayoutRuleBit</span><span>
</span><span id="line-1904"></span><span>                    </span><span class="hs-identifier">unless</span><span> </span><span class="hs-identifier">alr</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-1905"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITdo</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout_do</span><span>
</span><span id="line-1906"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITmdo</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout_do</span><span>
</span><span id="line-1907"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">ITof</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout</span><span>
</span><span id="line-1908"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">ITlcase</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout</span><span>
</span><span id="line-1909"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">ITlcases</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout</span><span>
</span><span id="line-1910"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">ITlet</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout</span><span>
</span><span id="line-1911"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">ITwhere</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout</span><span>
</span><span id="line-1912"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">ITrec</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout</span><span>
</span><span id="line-1913"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">ITif</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout_if</span><span>
</span><span id="line-1914"></span><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1915"></span><span>
</span><span id="line-1916"></span><span class="hs-comment">-- Pushing a new implicit layout context.  If the indentation of the</span><span>
</span><span id="line-1917"></span><span class="hs-comment">-- next token is not greater than the previous layout context, then</span><span>
</span><span id="line-1918"></span><span class="hs-comment">-- Haskell 98 says that the new layout context should be empty; that is</span><span>
</span><span id="line-1919"></span><span class="hs-comment">-- the lexer must generate {}.</span><span>
</span><span id="line-1920"></span><span class="hs-comment">--</span><span>
</span><span id="line-1921"></span><span class="hs-comment">-- We are slightly more lenient than this: when the new context is started</span><span>
</span><span id="line-1922"></span><span class="hs-comment">-- by a 'do', then we allow the new context to be at the same indentation as</span><span>
</span><span id="line-1923"></span><span class="hs-comment">-- the previous context.  This is what the 'strict' argument is for.</span><span>
</span><span id="line-1924"></span><span class="hs-identifier">new_layout_context</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1925"></span><span class="hs-identifier">new_layout_context</span><span> </span><span class="hs-identifier">strict</span><span> </span><span class="hs-identifier">gen_semic</span><span> </span><span class="hs-identifier">tok</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1926"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1927"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-1928"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcLocCol</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-1929"></span><span>    </span><span class="hs-identifier">ctx</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getContext</span><span>
</span><span id="line-1930"></span><span>    </span><span class="hs-identifier">nondecreasing</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">NondecreasingIndentationBit</span><span>
</span><span id="line-1931"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">strict'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">strict</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">nondecreasing</span><span>
</span><span id="line-1932"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ctx</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1933"></span><span>        </span><span class="hs-identifier">Layout</span><span> </span><span class="hs-identifier">prev_off</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">|</span><span>
</span><span id="line-1934"></span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">strict'</span><span>     </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">prev_off</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-identifier">offset</span><span>  </span><span class="hs-operator">||</span><span>
</span><span id="line-1935"></span><span>            </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">strict'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">prev_off</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">offset</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1936"></span><span>                </span><span class="hs-comment">-- token is indented to the left of the previous context.</span><span>
</span><span id="line-1937"></span><span>                </span><span class="hs-comment">-- we must generate a {} sequence now.</span><span>
</span><span id="line-1938"></span><span>                </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">layout_left</span><span>
</span><span id="line-1939"></span><span>                </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span>
</span><span id="line-1940"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Layout</span><span> </span><span class="hs-identifier">offset</span><span> </span><span class="hs-identifier">gen_semic</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ctx</span><span class="hs-special">)</span><span>
</span><span id="line-1941"></span><span>                </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span>
</span><span id="line-1942"></span><span>
</span><span id="line-1943"></span><span class="hs-identifier">do_layout_left</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1944"></span><span class="hs-identifier">do_layout_left</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1945"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1946"></span><span>    </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">bol</span><span>  </span><span class="hs-comment">-- we must be at the start of a line</span><span>
</span><span id="line-1947"></span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-1948"></span><span>
</span><span id="line-1949"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1950"></span><span class="hs-comment">-- LINE pragmas</span><span>
</span><span id="line-1951"></span><span>
</span><span id="line-1952"></span><span class="hs-identifier">setLineAndFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1953"></span><span class="hs-identifier">setLineAndFile</span><span> </span><span class="hs-identifier">code</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1954"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- drop trailing quotation mark</span><span>
</span><span id="line-1955"></span><span>      </span><span class="hs-identifier">linenumLen</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">head</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">words</span><span> </span><span class="hs-identifier">src</span><span>
</span><span id="line-1956"></span><span>      </span><span class="hs-identifier">linenum</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">parseUnsignedInteger</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">linenumLen</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-identifier">octDecDigit</span><span>
</span><span id="line-1957"></span><span>      </span><span class="hs-identifier">file</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkFastString</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">drop</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator">/=</span><span> </span><span class="hs-char">'&quot;'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">src</span><span>
</span><span id="line-1958"></span><span>          </span><span class="hs-comment">-- skip everything through first quotation mark to get to the filename</span><span>
</span><span id="line-1959"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\\'</span><span class="hs-glyph">:</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">cs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">cs</span><span>
</span><span id="line-1960"></span><span>              </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">cs</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">cs</span><span>
</span><span id="line-1961"></span><span>              </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1962"></span><span>              </span><span class="hs-comment">-- decode escapes in the filename.  e.g. on Windows</span><span>
</span><span id="line-1963"></span><span>              </span><span class="hs-comment">-- when our filenames have backslashes in, gcc seems to</span><span>
</span><span id="line-1964"></span><span>              </span><span class="hs-comment">-- escape the backslashes.  One symptom of not doing this</span><span>
</span><span id="line-1965"></span><span>              </span><span class="hs-comment">-- is that filenames in error messages look a bit strange:</span><span>
</span><span id="line-1966"></span><span>              </span><span class="hs-comment">--   C:\\foo\bar.hs</span><span>
</span><span id="line-1967"></span><span>              </span><span class="hs-comment">-- only the first backslash is doubled, because we apply</span><span>
</span><span id="line-1968"></span><span>              </span><span class="hs-comment">-- System.FilePath.normalise before printing out</span><span>
</span><span id="line-1969"></span><span>              </span><span class="hs-comment">-- filenames and it does not remove duplicate</span><span>
</span><span id="line-1970"></span><span>              </span><span class="hs-comment">-- backslashes after the drive letter (should it?).</span><span>
</span><span id="line-1971"></span><span>  </span><span class="hs-identifier">resetAlrLastLoc</span><span> </span><span class="hs-identifier">file</span><span>
</span><span id="line-1972"></span><span>  </span><span class="hs-identifier">setSrcLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkRealSrcLoc</span><span> </span><span class="hs-identifier">file</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">linenum</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">srcSpanEndCol</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1973"></span><span>      </span><span class="hs-comment">-- subtract one: the line number refers to the *following* line</span><span>
</span><span id="line-1974"></span><span>  </span><span class="hs-identifier">addSrcFile</span><span> </span><span class="hs-identifier">file</span><span>
</span><span id="line-1975"></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1976"></span><span>  </span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">code</span><span>
</span><span id="line-1977"></span><span>  </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-1978"></span><span>
</span><span id="line-1979"></span><span class="hs-identifier">setColumn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-1980"></span><span class="hs-identifier">setColumn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1981"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">column</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1982"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">reads</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1983"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">column</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">column</span><span>
</span><span id="line-1984"></span><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;setColumn: expected integer&quot;</span><span> </span><span class="hs-comment">-- shouldn't happen</span><span>
</span><span id="line-1985"></span><span>  </span><span class="hs-identifier">setSrcLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkRealSrcLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">srcSpanFile</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">srcSpanEndLine</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span>
</span><span id="line-1986"></span><span>                          </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">column</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1987"></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popLexState</span><span>
</span><span id="line-1988"></span><span>  </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-1989"></span><span>
</span><span id="line-1990"></span><span class="hs-identifier">alrInitialLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span>
</span><span id="line-1991"></span><span class="hs-identifier">alrInitialLoc</span><span> </span><span class="hs-identifier">file</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkRealSrcSpan</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">loc</span><span>
</span><span id="line-1992"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- This is a hack to ensure that the first line in a file</span><span>
</span><span id="line-1993"></span><span>          </span><span class="hs-comment">-- looks like it is after the initial location:</span><span>
</span><span id="line-1994"></span><span>          </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkRealSrcLoc</span><span> </span><span class="hs-identifier">file</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><span id="line-1995"></span><span>
</span><span id="line-1996"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1997"></span><span class="hs-comment">-- Options, includes and language pragmas.</span><span>
</span><span id="line-1998"></span><span>
</span><span id="line-1999"></span><span>
</span><span id="line-2000"></span><span class="hs-identifier">lex_string_prag</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2001"></span><span class="hs-identifier">lex_string_prag</span><span> </span><span class="hs-identifier">mkTok</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lex_string_prag_comment</span><span> </span><span class="hs-identifier">mkTok'</span><span>
</span><span id="line-2002"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2003"></span><span>    </span><span class="hs-identifier">mkTok'</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkTok</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2004"></span><span>
</span><span id="line-2005"></span><span class="hs-identifier">lex_string_prag_comment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2006"></span><span class="hs-identifier">lex_string_prag_comment</span><span> </span><span class="hs-identifier">mkTok</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span>
</span><span id="line-2007"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2008"></span><span>         </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getParsedLoc</span><span>
</span><span id="line-2009"></span><span>         </span><span class="hs-identifier">l</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLastLocComment</span><span>
</span><span id="line-2010"></span><span>         </span><span class="hs-identifier">tok</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-2011"></span><span>         </span><span class="hs-identifier">end</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getParsedLoc</span><span>
</span><span id="line-2012"></span><span>         </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span>
</span><span id="line-2013"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-2014"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isString</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-string">&quot;#-}&quot;</span><span>
</span><span id="line-2015"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-2016"></span><span>                           </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkTok</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span>
</span><span id="line-2017"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2018"></span><span>                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2019"></span><span>                          </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">err</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-2020"></span><span>          </span><span class="hs-identifier">isString</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2021"></span><span>          </span><span class="hs-identifier">isString</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><span id="line-2022"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2023"></span><span>                  </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">i'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">x</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">isString</span><span> </span><span class="hs-identifier">i'</span><span> </span><span class="hs-identifier">xs</span><span>
</span><span id="line-2024"></span><span>                  </span><span class="hs-identifier">_other</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-2025"></span><span>          </span><span class="hs-identifier">err</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">failLocMsgP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">realSrcSpanStart</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2026"></span><span>                                       </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span>
</span><span id="line-2027"></span><span>                                       </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">PsErrLexer</span><span> </span><span class="hs-identifier">LexUnterminatedOptions</span><span> </span><span class="hs-identifier">LexErrKind_EOF</span><span class="hs-special">)</span><span>
</span><span id="line-2028"></span><span>
</span><span id="line-2029"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2030"></span><span class="hs-comment">-- Strings &amp; Chars</span><span>
</span><span id="line-2031"></span><span>
</span><span id="line-2032"></span><span class="hs-comment">-- This stuff is horrible.  I hates it.</span><span>
</span><span id="line-2033"></span><span>
</span><span id="line-2034"></span><span class="hs-identifier">lex_string_tok</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2035"></span><span class="hs-identifier">lex_string_tok</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2036"></span><span>  </span><span class="hs-identifier">lexed</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex_string</span><span>
</span><span id="line-2037"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">bufEnd</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2038"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-2039"></span><span>    </span><span class="hs-identifier">tok</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">lexed</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2040"></span><span>      </span><span class="hs-identifier">LexedPrimString</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITprimstring</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsafeMkByteString</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-2041"></span><span>      </span><span class="hs-identifier">LexedRegularString</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITstring</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkFastString</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-2042"></span><span>    </span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cur</span><span> </span><span class="hs-identifier">bufEnd</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">cur</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-2043"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tok</span><span>
</span><span id="line-2044"></span><span>
</span><span id="line-2045"></span><span>
</span><span id="line-2046"></span><span class="hs-identifier">lex_quoted_label</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2047"></span><span class="hs-identifier">lex_quoted_label</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2048"></span><span>  </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2049"></span><span>  </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex_string_helper</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2050"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">bufEnd</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2051"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-2052"></span><span>    </span><span class="hs-identifier">token</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ITlabelvarid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkFastString</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-2053"></span><span>    </span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stepOn</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cur</span><span> </span><span class="hs-identifier">bufEnd</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">cur</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><span id="line-2054"></span><span>    </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">span</span><span>
</span><span id="line-2055"></span><span>
</span><span id="line-2056"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">token</span><span>
</span><span id="line-2057"></span><span>
</span><span id="line-2058"></span><span>
</span><span id="line-2059"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">LexedString</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LexedRegularString</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">LexedPrimString</span><span> </span><span class="hs-identifier">String</span><span>
</span><span id="line-2060"></span><span>
</span><span id="line-2061"></span><span class="hs-identifier">lex_string</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">LexedString</span><span>
</span><span id="line-2062"></span><span class="hs-identifier">lex_string</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2063"></span><span>  </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2064"></span><span>  </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex_string_helper</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2065"></span><span>  </span><span class="hs-identifier">magicHash</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">MagicHashBit</span><span>
</span><span id="line-2066"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">magicHash</span><span>
</span><span id="line-2067"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2068"></span><span>      </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2069"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2070"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'#'</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2071"></span><span>          </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2072"></span><span>          </span><span class="hs-identifier">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">any</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&gt;</span><span> </span><span class="hs-char">'\xFF'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2073"></span><span>            </span><span class="hs-identifier">pState</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getPState</span><span>
</span><span id="line-2074"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsErrPrimStringInvalidChar</span><span>
</span><span id="line-2075"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">err</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-identifier">pState</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-2076"></span><span>            </span><span class="hs-identifier">addError</span><span> </span><span class="hs-identifier">err</span><span>
</span><span id="line-2077"></span><span>          </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">LexedPrimString</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2078"></span><span>        </span><span class="hs-identifier">_other</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2079"></span><span>          </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">LexedRegularString</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2080"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-2081"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">LexedRegularString</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2082"></span><span>
</span><span id="line-2083"></span><span>
</span><span id="line-2084"></span><span class="hs-identifier">lex_string_helper</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">String</span><span>
</span><span id="line-2085"></span><span class="hs-identifier">lex_string_helper</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2086"></span><span>  </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2087"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2088"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2089"></span><span>
</span><span id="line-2090"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'&quot;'</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2091"></span><span>      </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2092"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-2093"></span><span>
</span><span id="line-2094"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\\'</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-2095"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'&amp;'</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">next</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2096"></span><span>                </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lex_string_helper</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2097"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">next</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\x7f'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">is_space</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2098"></span><span>                           </span><span class="hs-comment">-- is_space only works for &lt;= '\x7f' (#3751, #5425)</span><span>
</span><span id="line-2099"></span><span>                </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lex_stringgap</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2100"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">next</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2101"></span><span>
</span><span id="line-2102"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2103"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2104"></span><span>          </span><span class="hs-char">'\\'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i1</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">c'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex_escape</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lex_string_helper</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c'</span><span class="hs-glyph">:</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2105"></span><span>          </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isAny</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i1</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lex_string_helper</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2106"></span><span>          </span><span class="hs-identifier">_other</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">isDoubleSmartQuote</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2107"></span><span>            </span><span class="hs-comment">-- if the built-up string s contains a smart double quote character, it was</span><span>
</span><span id="line-2108"></span><span>            </span><span class="hs-comment">-- likely the reason why the string literal was not lexed correctly</span><span>
</span><span id="line-2109"></span><span>            </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-comment">-- rewind to the first character in the string literal</span><span>
</span><span id="line-2110"></span><span>                           </span><span class="hs-comment">-- so we can find the smart quote character's location</span><span>
</span><span id="line-2111"></span><span>            </span><span class="hs-identifier">advance_to_smart_quote_character</span><span>
</span><span id="line-2112"></span><span>            </span><span class="hs-identifier">i2</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2113"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i2</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2114"></span><span>              </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">add_nonfatal_smart_quote_error</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2115"></span><span>              </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-comment">-- should never get here</span><span>
</span><span id="line-2116"></span><span>          </span><span class="hs-identifier">_other</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2117"></span><span>
</span><span id="line-2118"></span><span>
</span><span id="line-2119"></span><span class="hs-identifier">lex_stringgap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">String</span><span>
</span><span id="line-2120"></span><span class="hs-identifier">lex_stringgap</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2121"></span><span>  </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2122"></span><span>  </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getCharOrFail</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2123"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2124"></span><span>    </span><span class="hs-char">'\\'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lex_string_helper</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2125"></span><span>    </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\x7f'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">is_space</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lex_stringgap</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2126"></span><span>                           </span><span class="hs-comment">-- is_space only works for &lt;= '\x7f' (#3751, #5425)</span><span>
</span><span id="line-2127"></span><span>    </span><span class="hs-identifier">_other</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2128"></span><span>
</span><span id="line-2129"></span><span>
</span><span id="line-2130"></span><span class="hs-identifier">lex_char_tok</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2131"></span><span class="hs-comment">-- Here we are basically parsing character literals, such as 'x' or '\n'</span><span>
</span><span id="line-2132"></span><span class="hs-comment">-- but we additionally spot 'x and ''T, returning ITsimpleQuote and</span><span>
</span><span id="line-2133"></span><span class="hs-comment">-- ITtyQuote respectively, but WITHOUT CONSUMING the x or T part</span><span>
</span><span id="line-2134"></span><span class="hs-comment">-- (the parser does that).</span><span>
</span><span id="line-2135"></span><span class="hs-comment">-- So we have to do two characters of lookahead: when we see 'x we need to</span><span>
</span><span id="line-2136"></span><span class="hs-comment">-- see if there's a trailing quote</span><span>
</span><span id="line-2137"></span><span class="hs-identifier">lex_char_tok</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>        </span><span class="hs-comment">-- We've seen '</span><span>
</span><span id="line-2138"></span><span>   </span><span class="hs-identifier">i1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>       </span><span class="hs-comment">-- Look ahead to first character</span><span>
</span><span id="line-2139"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">span</span><span>
</span><span id="line-2140"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i1</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2141"></span><span>        </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lit_error</span><span>  </span><span class="hs-identifier">i1</span><span>
</span><span id="line-2142"></span><span>
</span><span id="line-2143"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\''</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i2</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end2</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>       </span><span class="hs-comment">-- We've seen ''</span><span>
</span><span id="line-2144"></span><span>                   </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i2</span><span>
</span><span id="line-2145"></span><span>                   </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">end2</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier">ITtyQuote</span><span class="hs-special">)</span><span>
</span><span id="line-2146"></span><span>
</span><span id="line-2147"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\\'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i2</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end2</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>      </span><span class="hs-comment">-- We've seen 'backslash</span><span>
</span><span id="line-2148"></span><span>                  </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i2</span><span>
</span><span id="line-2149"></span><span>                  </span><span class="hs-identifier">lit_ch</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex_escape</span><span>
</span><span id="line-2150"></span><span>                  </span><span class="hs-identifier">i3</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2151"></span><span>                  </span><span class="hs-identifier">mc</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getCharOrFail</span><span> </span><span class="hs-identifier">i3</span><span> </span><span class="hs-comment">-- Trailing quote</span><span>
</span><span id="line-2152"></span><span>                  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">mc</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-char">'\''</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">finish_char_tok</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">lit_ch</span><span>
</span><span id="line-2153"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-identifier">mc</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">add_smart_quote_error</span><span> </span><span class="hs-identifier">mc</span><span> </span><span class="hs-identifier">end2</span><span>
</span><span id="line-2154"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i3</span><span>
</span><span id="line-2155"></span><span>
</span><span id="line-2156"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i2</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end2</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2157"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isAny</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i1</span><span>
</span><span id="line-2158"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2159"></span><span>
</span><span id="line-2160"></span><span>                </span><span class="hs-comment">-- We've seen 'x, where x is a valid character</span><span>
</span><span id="line-2161"></span><span>                </span><span class="hs-comment">--  (i.e. not newline etc) but not a quote or backslash</span><span>
</span><span id="line-2162"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i2</span><span> </span><span class="hs-keyword">of</span><span>      </span><span class="hs-comment">-- Look ahead one more character</span><span>
</span><span id="line-2163"></span><span>                </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\''</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>   </span><span class="hs-comment">-- We've seen 'x'</span><span>
</span><span id="line-2164"></span><span>                        </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i3</span><span>
</span><span id="line-2165"></span><span>                        </span><span class="hs-identifier">finish_char_tok</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2166"></span><span>                </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">add_smart_quote_error</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">end2</span><span>
</span><span id="line-2167"></span><span>                </span><span class="hs-identifier">_other</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>            </span><span class="hs-comment">-- We've seen 'x not followed by quote</span><span>
</span><span id="line-2168"></span><span>                                        </span><span class="hs-comment">-- (including the possibility of EOF)</span><span>
</span><span id="line-2169"></span><span>                                        </span><span class="hs-comment">-- Just parse the quote only</span><span>
</span><span id="line-2170"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">i1</span><span>
</span><span id="line-2171"></span><span>                        </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ITsimpleQuote</span><span class="hs-special">)</span><span>
</span><span id="line-2172"></span><span>
</span><span id="line-2173"></span><span class="hs-identifier">finish_char_tok</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-2174"></span><span class="hs-identifier">finish_char_tok</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">ch</span><span>  </span><span class="hs-comment">-- We've already seen the closing quote</span><span>
</span><span id="line-2175"></span><span>                        </span><span class="hs-comment">-- Just need to check for trailing #</span><span>
</span><span id="line-2176"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-identifier">magicHash</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">MagicHashBit</span><span>
</span><span id="line-2177"></span><span>        </span><span class="hs-identifier">i</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">bufEnd</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2178"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cur</span><span> </span><span class="hs-identifier">bufEnd</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">cur</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-2179"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">magicHash</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2180"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2181"></span><span>              </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'#'</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">bufEnd'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2182"></span><span>                </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2183"></span><span>                </span><span class="hs-comment">-- Include the trailing # in SourceText</span><span>
</span><span id="line-2184"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">src'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cur</span><span> </span><span class="hs-identifier">bufEnd'</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">cur</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-2185"></span><span>                </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span>
</span><span id="line-2186"></span><span>                          </span><span class="hs-special">(</span><span class="hs-identifier">ITprimchar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ch</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2187"></span><span>              </span><span class="hs-identifier">_other</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2188"></span><span>                </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span>
</span><span id="line-2189"></span><span>                          </span><span class="hs-special">(</span><span class="hs-identifier">ITchar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ch</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2190"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2191"></span><span>              </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITchar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">src</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ch</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2192"></span><span>
</span><span id="line-2193"></span><span class="hs-identifier">isAny</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2194"></span><span class="hs-identifier">isAny</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-char">'\x7f'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isPrint</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2195"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">is_any</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2196"></span><span>
</span><span id="line-2197"></span><span class="hs-identifier">lex_escape</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Char</span><span>
</span><span id="line-2198"></span><span class="hs-identifier">lex_escape</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2199"></span><span>  </span><span class="hs-identifier">i0</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2200"></span><span>  </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getCharOrFail</span><span> </span><span class="hs-identifier">i0</span><span>
</span><span id="line-2201"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2202"></span><span>        </span><span class="hs-char">'a'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\a'</span><span>
</span><span id="line-2203"></span><span>        </span><span class="hs-char">'b'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\b'</span><span>
</span><span id="line-2204"></span><span>        </span><span class="hs-char">'f'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\f'</span><span>
</span><span id="line-2205"></span><span>        </span><span class="hs-char">'n'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\n'</span><span>
</span><span id="line-2206"></span><span>        </span><span class="hs-char">'r'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\r'</span><span>
</span><span id="line-2207"></span><span>        </span><span class="hs-char">'t'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\t'</span><span>
</span><span id="line-2208"></span><span>        </span><span class="hs-char">'v'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\v'</span><span>
</span><span id="line-2209"></span><span>        </span><span class="hs-char">'\\'</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\\'</span><span>
</span><span id="line-2210"></span><span>        </span><span class="hs-char">'&quot;'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\&quot;'</span><span>
</span><span id="line-2211"></span><span>        </span><span class="hs-char">'\''</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-char">'\''</span><span>
</span><span id="line-2212"></span><span>        </span><span class="hs-comment">-- the next two patterns build up a Unicode smart quote error (#21843)</span><span>
</span><span id="line-2213"></span><span>        </span><span class="hs-identifier">smart_double_quote</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isDoubleSmartQuote</span><span> </span><span class="hs-identifier">smart_double_quote</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2214"></span><span>          </span><span class="hs-identifier">add_smart_quote_error</span><span> </span><span class="hs-identifier">smart_double_quote</span><span> </span><span class="hs-identifier">loc</span><span>
</span><span id="line-2215"></span><span>        </span><span class="hs-identifier">smart_single_quote</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-identifier">smart_single_quote</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2216"></span><span>          </span><span class="hs-identifier">add_smart_quote_error</span><span> </span><span class="hs-identifier">smart_single_quote</span><span> </span><span class="hs-identifier">loc</span><span>
</span><span id="line-2217"></span><span>        </span><span class="hs-char">'^'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">i1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2218"></span><span>                    </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getCharOrFail</span><span> </span><span class="hs-identifier">i1</span><span>
</span><span id="line-2219"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-char">'@'</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'_'</span><span>
</span><span id="line-2220"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">chr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ord</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">ord</span><span> </span><span class="hs-char">'@'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2221"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i1</span><span>
</span><span id="line-2222"></span><span>
</span><span id="line-2223"></span><span>        </span><span class="hs-char">'x'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">readNum</span><span> </span><span class="hs-identifier">is_hexdigit</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-identifier">hexDigit</span><span>
</span><span id="line-2224"></span><span>        </span><span class="hs-char">'o'</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">readNum</span><span> </span><span class="hs-identifier">is_octdigit</span><span>  </span><span class="hs-number">8</span><span> </span><span class="hs-identifier">octDecDigit</span><span>
</span><span id="line-2225"></span><span>        </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">is_decdigit</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">readNum2</span><span> </span><span class="hs-identifier">is_decdigit</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-identifier">octDecDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">octDecDigit</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-2226"></span><span>
</span><span id="line-2227"></span><span>        </span><span class="hs-identifier">c1</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-2228"></span><span>           </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2229"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2230"></span><span>            </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i0</span><span>
</span><span id="line-2231"></span><span>            </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c2</span><span class="hs-special">,</span><span class="hs-identifier">i2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2232"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i2</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2233"></span><span>                </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i0</span><span>
</span><span id="line-2234"></span><span>                </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c3</span><span class="hs-special">,</span><span class="hs-identifier">i3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2235"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">c1</span><span class="hs-special">,</span><span class="hs-identifier">c2</span><span class="hs-special">,</span><span class="hs-identifier">c3</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-2236"></span><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">silly_escape_chars</span><span class="hs-special">,</span><span>
</span><span id="line-2237"></span><span>                                     </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">rest</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">stripPrefix</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2238"></span><span>                          </span><span class="hs-special">(</span><span class="hs-identifier">escape_char</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2239"></span><span>                                </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i3</span><span>
</span><span id="line-2240"></span><span>                                </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">escape_char</span><span>
</span><span id="line-2241"></span><span>                          </span><span class="hs-special">(</span><span class="hs-identifier">escape_char</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2242"></span><span>                                </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i2</span><span>
</span><span id="line-2243"></span><span>                                </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">escape_char</span><span>
</span><span id="line-2244"></span><span>                          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i0</span><span>
</span><span id="line-2245"></span><span>
</span><span id="line-2246"></span><span class="hs-identifier">readNum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Char</span><span>
</span><span id="line-2247"></span><span class="hs-identifier">readNum</span><span> </span><span class="hs-identifier">is_digit</span><span> </span><span class="hs-identifier">base</span><span> </span><span class="hs-identifier">conv</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2248"></span><span>  </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2249"></span><span>  </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getCharOrFail</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2250"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">is_digit</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2251"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">readNum2</span><span> </span><span class="hs-identifier">is_digit</span><span> </span><span class="hs-identifier">base</span><span> </span><span class="hs-identifier">conv</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">conv</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><span id="line-2252"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2253"></span><span>
</span><span id="line-2254"></span><span class="hs-identifier">readNum2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Char</span><span>
</span><span id="line-2255"></span><span class="hs-identifier">readNum2</span><span> </span><span class="hs-identifier">is_digit</span><span> </span><span class="hs-identifier">base</span><span> </span><span class="hs-identifier">conv</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2256"></span><span>  </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2257"></span><span>  </span><span class="hs-identifier">read</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">input</span><span>
</span><span id="line-2258"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">read</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2259"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2260"></span><span>            </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">input'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">is_digit</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2261"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">i'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">i</span><span class="hs-operator">*</span><span class="hs-identifier">base</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">conv</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2262"></span><span>               </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">i'</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">0x10ffff</span><span>
</span><span id="line-2263"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">input</span><span> </span><span class="hs-operator">&gt;&gt;</span><span> </span><span class="hs-identifier">lexError</span><span> </span><span class="hs-identifier">LexNumEscapeRange</span><span>
</span><span id="line-2264"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">read</span><span> </span><span class="hs-identifier">i'</span><span> </span><span class="hs-identifier">input'</span><span>
</span><span id="line-2265"></span><span>            </span><span class="hs-identifier">_other</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2266"></span><span>              </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">input</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">chr</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-2267"></span><span>
</span><span id="line-2268"></span><span>
</span><span id="line-2269"></span><span class="hs-identifier">silly_escape_chars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Char</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2270"></span><span class="hs-identifier">silly_escape_chars</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-2271"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;NUL&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\NUL'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2272"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;SOH&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\SOH'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2273"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;STX&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\STX'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2274"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;ETX&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\ETX'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2275"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;EOT&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\EOT'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2276"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;ENQ&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\ENQ'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2277"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;ACK&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\ACK'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2278"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;BEL&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\BEL'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2279"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;BS&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\BS'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2280"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;HT&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\HT'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2281"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;LF&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\LF'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2282"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;VT&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\VT'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2283"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;FF&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\FF'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2284"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;CR&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\CR'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2285"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;SO&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\SO'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2286"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;SI&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\SI'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2287"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;DLE&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\DLE'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2288"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;DC1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\DC1'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2289"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;DC2&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\DC2'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2290"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;DC3&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\DC3'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2291"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;DC4&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\DC4'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2292"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;NAK&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\NAK'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2293"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;SYN&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\SYN'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2294"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;ETB&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\ETB'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2295"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;CAN&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\CAN'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2296"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;EM&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\EM'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2297"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;SUB&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\SUB'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2298"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;ESC&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\ESC'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2299"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;FS&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\FS'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2300"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;GS&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\GS'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2301"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;RS&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\RS'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2302"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;US&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\US'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2303"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;SP&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\SP'</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2304"></span><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;DEL&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-char">'\DEL'</span><span class="hs-special">)</span><span>
</span><span id="line-2305"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2306"></span><span>
</span><span id="line-2307"></span><span class="hs-comment">-- before calling lit_error, ensure that the current input is pointing to</span><span>
</span><span id="line-2308"></span><span class="hs-comment">-- the position of the error in the buffer.  This is so that we can report</span><span>
</span><span id="line-2309"></span><span class="hs-comment">-- a correct location to the user, but also so we can detect UTF-8 decoding</span><span>
</span><span id="line-2310"></span><span class="hs-comment">-- errors if they occur.</span><span>
</span><span id="line-2311"></span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-2312"></span><span class="hs-identifier">lit_error</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lexError</span><span> </span><span class="hs-identifier">LexStringCharLit</span><span>
</span><span id="line-2313"></span><span>
</span><span id="line-2314"></span><span class="hs-identifier">getCharOrFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Char</span><span>
</span><span id="line-2315"></span><span class="hs-identifier">getCharOrFail</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-2316"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2317"></span><span>        </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexError</span><span> </span><span class="hs-identifier">LexStringCharLitEOF</span><span>
</span><span id="line-2318"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2319"></span><span>
</span><span id="line-2320"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2321"></span><span class="hs-comment">-- QuasiQuote</span><span>
</span><span id="line-2322"></span><span>
</span><span id="line-2323"></span><span class="hs-identifier">lex_qquasiquote_tok</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2324"></span><span class="hs-identifier">lex_qquasiquote_tok</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2325"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">qual</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">quoter</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitQualName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">stepOn</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-2326"></span><span>  </span><span class="hs-identifier">quoteStart</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getParsedLoc</span><span>
</span><span id="line-2327"></span><span>  </span><span class="hs-identifier">quote</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex_quasiquote</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">quoteStart</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><span id="line-2328"></span><span>  </span><span class="hs-identifier">end</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getParsedLoc</span><span>
</span><span id="line-2329"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span>
</span><span id="line-2330"></span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">ITqQuasiQuote</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">qual</span><span class="hs-special">,</span><span>
</span><span id="line-2331"></span><span>                           </span><span class="hs-identifier">quoter</span><span class="hs-special">,</span><span>
</span><span id="line-2332"></span><span>                           </span><span class="hs-identifier">mkFastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">quote</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2333"></span><span>                           </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">quoteStart</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2334"></span><span>
</span><span id="line-2335"></span><span class="hs-identifier">lex_quasiquote_tok</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2336"></span><span class="hs-identifier">lex_quasiquote_tok</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2337"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">quoter</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2338"></span><span>                </span><span class="hs-comment">-- 'tail' drops the initial '[',</span><span>
</span><span id="line-2339"></span><span>                </span><span class="hs-comment">-- while the -1 drops the trailing '|'</span><span>
</span><span id="line-2340"></span><span>  </span><span class="hs-identifier">quoteStart</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getParsedLoc</span><span>
</span><span id="line-2341"></span><span>  </span><span class="hs-identifier">quote</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex_quasiquote</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">quoteStart</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><span id="line-2342"></span><span>  </span><span class="hs-identifier">end</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getParsedLoc</span><span>
</span><span id="line-2343"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span>
</span><span id="line-2344"></span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">ITquasiQuote</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkFastString</span><span> </span><span class="hs-identifier">quoter</span><span class="hs-special">,</span><span>
</span><span id="line-2345"></span><span>                          </span><span class="hs-identifier">mkFastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">quote</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2346"></span><span>                          </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">quoteStart</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2347"></span><span>
</span><span id="line-2348"></span><span class="hs-identifier">lex_quasiquote</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">String</span><span>
</span><span id="line-2349"></span><span class="hs-identifier">lex_quasiquote</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2350"></span><span>  </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2351"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2352"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">quasiquote_error</span><span> </span><span class="hs-identifier">start</span><span>
</span><span id="line-2353"></span><span>
</span><span id="line-2354"></span><span>    </span><span class="hs-comment">-- NB: The string &quot;|]&quot; terminates the quasiquote,</span><span>
</span><span id="line-2355"></span><span>    </span><span class="hs-comment">-- with absolutely no escaping. See the extensive</span><span>
</span><span id="line-2356"></span><span>    </span><span class="hs-comment">-- discussion on #5348 for why there is no</span><span>
</span><span id="line-2357"></span><span>    </span><span class="hs-comment">-- escape handling.</span><span>
</span><span id="line-2358"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">'|'</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-2359"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-char">']'</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-2360"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2361"></span><span>
</span><span id="line-2362"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2363"></span><span>         </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">lex_quasiquote</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-2364"></span><span>
</span><span id="line-2365"></span><span class="hs-identifier">quasiquote_error</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-2366"></span><span class="hs-identifier">quasiquote_error</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2367"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2368"></span><span>  </span><span class="hs-identifier">reportLexError</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-2369"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsErrLexer</span><span> </span><span class="hs-identifier">LexUnterminatedQQ</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2370"></span><span>
</span><span id="line-2371"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2372"></span><span class="hs-comment">-- Unicode Smart Quote detection (#21843)</span><span>
</span><span id="line-2373"></span><span>
</span><span id="line-2374"></span><span class="hs-identifier">isDoubleSmartQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2375"></span><span class="hs-identifier">isDoubleSmartQuote</span><span> </span><span class="hs-char">'&#8220;'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2376"></span><span class="hs-identifier">isDoubleSmartQuote</span><span> </span><span class="hs-char">'&#8221;'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2377"></span><span class="hs-identifier">isDoubleSmartQuote</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-2378"></span><span>
</span><span id="line-2379"></span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2380"></span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-char">'&#8216;'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2381"></span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-char">'&#8217;'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2382"></span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-2383"></span><span>
</span><span id="line-2384"></span><span class="hs-identifier">isSmartQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-2385"></span><span class="hs-identifier">isSmartQuote</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">prevChar</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-char">' '</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">isDoubleSmartQuote</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2386"></span><span>
</span><span id="line-2387"></span><span class="hs-identifier">smart_quote_error_message</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">MsgEnvelope</span><span> </span><span class="hs-identifier">PsMessage</span><span>
</span><span id="line-2388"></span><span class="hs-identifier">smart_quote_error_message</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2389"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">correct_char</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">correct_char_name</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2390"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isSingleSmartQuote</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\''</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;Single Quote&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-char">'&quot;'</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;Quotation Mark&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-2391"></span><span>      </span><span class="hs-identifier">err</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-2392"></span><span>              </span><span class="hs-identifier">PsErrUnicodeCharLooksLike</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">correct_char</span><span> </span><span class="hs-identifier">correct_char_name</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-2393"></span><span>    </span><span class="hs-identifier">err</span><span>
</span><span id="line-2394"></span><span>
</span><span id="line-2395"></span><span class="hs-identifier">smart_quote_error</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2396"></span><span class="hs-identifier">smart_quote_error</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2397"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">currentChar</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-2398"></span><span>  </span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">smart_quote_error_message</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2399"></span><span>
</span><span id="line-2400"></span><span class="hs-identifier">add_smart_quote_error</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-2401"></span><span class="hs-identifier">add_smart_quote_error</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">smart_quote_error_message</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span>
</span><span id="line-2402"></span><span>
</span><span id="line-2403"></span><span class="hs-identifier">add_nonfatal_smart_quote_error</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2404"></span><span class="hs-identifier">add_nonfatal_smart_quote_error</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">addError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">smart_quote_error_message</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span>
</span><span id="line-2405"></span><span>
</span><span id="line-2406"></span><span class="hs-identifier">advance_to_smart_quote_character</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2407"></span><span class="hs-identifier">advance_to_smart_quote_character</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2408"></span><span>  </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2409"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2410"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isDoubleSmartQuote</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2411"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">i2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">i2</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">advance_to_smart_quote_character</span><span>
</span><span id="line-2412"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- should never get here</span><span>
</span><span id="line-2413"></span><span>
</span><span id="line-2414"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2415"></span><span class="hs-comment">-- Warnings</span><span>
</span><span id="line-2416"></span><span>
</span><span id="line-2417"></span><span class="hs-identifier">warnTab</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2418"></span><span class="hs-identifier">warnTab</span><span> </span><span class="hs-identifier">srcspan</span><span> </span><span class="hs-identifier">_buf</span><span> </span><span class="hs-identifier">_len</span><span> </span><span class="hs-identifier">_buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2419"></span><span>    </span><span class="hs-identifier">addTabWarning</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">srcspan</span><span class="hs-special">)</span><span>
</span><span id="line-2420"></span><span>    </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-2421"></span><span>
</span><span id="line-2422"></span><span class="hs-identifier">warnThen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsMessage</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-2423"></span><span class="hs-identifier">warnThen</span><span> </span><span class="hs-identifier">warning</span><span> </span><span class="hs-identifier">action</span><span> </span><span class="hs-identifier">srcspan</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2424"></span><span>    </span><span class="hs-identifier">addPsMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">srcspan</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">warning</span><span>
</span><span id="line-2425"></span><span>    </span><span class="hs-identifier">action</span><span> </span><span class="hs-identifier">srcspan</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-2426"></span><span>
</span><span id="line-2427"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2428"></span><span class="hs-comment">-- The Parse Monad</span><span>
</span><span id="line-2429"></span><span>
</span><span id="line-2430"></span><span class="hs-comment">-- | Do we want to generate ';' layout tokens? In some cases we just want to</span><span>
</span><span id="line-2431"></span><span class="hs-comment">-- generate '}', e.g. in MultiWayIf we don't need ';'s because '|' separates</span><span>
</span><span id="line-2432"></span><span class="hs-comment">-- alternatives (unlike a `case` expression where we need ';' to as a separator</span><span>
</span><span id="line-2433"></span><span class="hs-comment">-- between alternatives).</span><span>
</span><span id="line-2434"></span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">GenSemic</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2435"></span><span>
</span><span id="line-2436"></span><span class="hs-identifier">generateSemic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dontGenerateSemic</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">GenSemic</span><span>
</span><span id="line-2437"></span><span class="hs-identifier">generateSemic</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2438"></span><span class="hs-identifier">dontGenerateSemic</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-2439"></span><span>
</span><span id="line-2440"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">LayoutContext</span><span>
</span><span id="line-2441"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">NoLayout</span><span>
</span><span id="line-2442"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Layout</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">GenSemic</span><span>
</span><span id="line-2443"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><span id="line-2444"></span><span>
</span><span id="line-2445"></span><span class="hs-comment">-- | The result of running a parser.</span><span>
</span><span id="line-2446"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-identifier">ParseResult</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PR</span><span> </span><span class="hs-special">(#</span><span> </span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">PState</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-2447"></span><span>
</span><span id="line-2448"></span><span class="hs-comment">-- | The parser has consumed a (possibly empty) prefix of the input and produced</span><span>
</span><span id="line-2449"></span><span class="hs-comment">-- a result. Use 'getPsMessages' to check for accumulated warnings and non-fatal</span><span>
</span><span id="line-2450"></span><span class="hs-comment">-- errors.</span><span>
</span><span id="line-2451"></span><span class="hs-comment">--</span><span>
</span><span id="line-2452"></span><span class="hs-comment">-- The carried parsing state can be used to resume parsing.</span><span>
</span><span id="line-2453"></span><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PState</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ParseResult</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-2454"></span><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PR</span><span> </span><span class="hs-special">(#</span><span> </span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-2455"></span><span>
</span><span id="line-2456"></span><span class="hs-comment">-- | The parser has consumed a (possibly empty) prefix of the input and failed.</span><span>
</span><span id="line-2457"></span><span class="hs-comment">--</span><span>
</span><span id="line-2458"></span><span class="hs-comment">-- The carried parsing state can be used to resume parsing. It is the state</span><span>
</span><span id="line-2459"></span><span class="hs-comment">-- right before failure, including the fatal parse error. 'getPsMessages' and</span><span>
</span><span id="line-2460"></span><span class="hs-comment">-- 'getPsErrorMessages' must return a non-empty bag of errors.</span><span>
</span><span id="line-2461"></span><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">PFailed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PState</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ParseResult</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-2462"></span><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">PFailed</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PR</span><span> </span><span class="hs-special">(#</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-2463"></span><span>
</span><span id="line-2464"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="hs-pragma">POk</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">PFailed</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2465"></span><span>
</span><span id="line-2466"></span><span class="hs-comment">-- | Test whether a 'WarningFlag' is set</span><span>
</span><span id="line-2467"></span><span class="hs-identifier">warnopt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">WarningFlag</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ParserOpts</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2468"></span><span class="hs-identifier">warnopt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">EnumSet.member</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pWarningFlags</span><span> </span><span class="hs-identifier">options</span><span>
</span><span id="line-2469"></span><span>
</span><span id="line-2470"></span><span class="hs-comment">-- | Parser options.</span><span>
</span><span id="line-2471"></span><span class="hs-comment">--</span><span>
</span><span id="line-2472"></span><span class="hs-comment">-- See 'mkParserOpts' to construct this.</span><span>
</span><span id="line-2473"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">ParserOpts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ParserOpts</span><span>
</span><span id="line-2474"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">ExtsBitmap</span><span> </span><span class="hs-comment">-- ^ bitmap of permitted extensions</span><span>
</span><span id="line-2475"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pDiagOpts</span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">DiagOpts</span><span>
</span><span id="line-2476"></span><span>    </span><span class="hs-comment">-- ^ Options to construct diagnostic messages.</span><span>
</span><span id="line-2477"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pSupportedExts</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">String</span><span class="hs-special">]</span><span>
</span><span id="line-2478"></span><span>    </span><span class="hs-comment">-- ^ supported extensions (only used for suggestions in error messages)</span><span>
</span><span id="line-2479"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-2480"></span><span>
</span><span id="line-2481"></span><span class="hs-identifier">pWarningFlags</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ParserOpts</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">EnumSet</span><span> </span><span class="hs-identifier">WarningFlag</span><span>
</span><span id="line-2482"></span><span class="hs-identifier">pWarningFlags</span><span> </span><span class="hs-identifier">opts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">diag_warning_flags</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pDiagOpts</span><span> </span><span class="hs-identifier">opts</span><span class="hs-special">)</span><span>
</span><span id="line-2483"></span><span>
</span><span id="line-2484"></span><span class="hs-comment">-- | Haddock comment as produced by the lexer. These are accumulated in 'PState'</span><span>
</span><span id="line-2485"></span><span class="hs-comment">-- and then processed in &quot;GHC.Parser.PostProcess.Haddock&quot;. The location of the</span><span>
</span><span id="line-2486"></span><span class="hs-comment">-- 'HsDocString's spans over the contents of the docstring - i.e. it does not</span><span>
</span><span id="line-2487"></span><span class="hs-comment">-- include the decorator (&quot;-- |&quot;, &quot;{-|&quot; etc.)</span><span>
</span><span id="line-2488"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">HdkComment</span><span>
</span><span id="line-2489"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">HdkCommentNext</span><span> </span><span class="hs-identifier">HsDocString</span><span>
</span><span id="line-2490"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">HdkCommentPrev</span><span> </span><span class="hs-identifier">HsDocString</span><span>
</span><span id="line-2491"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">HdkCommentNamed</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-identifier">HsDocString</span><span>
</span><span id="line-2492"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">HdkCommentSection</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-identifier">HsDocString</span><span>
</span><span id="line-2493"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><span id="line-2494"></span><span>
</span><span id="line-2495"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">PState</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-2496"></span><span>        </span><span class="hs-identifier">buffer</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">StringBuffer</span><span class="hs-special">,</span><span>
</span><span id="line-2497"></span><span>        </span><span class="hs-identifier">options</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ParserOpts</span><span class="hs-special">,</span><span>
</span><span id="line-2498"></span><span>        </span><span class="hs-identifier">warnings</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Messages</span><span> </span><span class="hs-identifier">PsMessage</span><span class="hs-special">,</span><span>
</span><span id="line-2499"></span><span>        </span><span class="hs-identifier">errors</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Messages</span><span> </span><span class="hs-identifier">PsMessage</span><span class="hs-special">,</span><span>
</span><span id="line-2500"></span><span>        </span><span class="hs-identifier">tab_first</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- pos of first tab warning in the file</span><span>
</span><span id="line-2501"></span><span>        </span><span class="hs-identifier">tab_count</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Word</span><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- number of tab warnings in the file</span><span>
</span><span id="line-2502"></span><span>        </span><span class="hs-identifier">last_tk</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- last non-comment token</span><span>
</span><span id="line-2503"></span><span>        </span><span class="hs-identifier">prev_loc</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- pos of previous token, including comments,</span><span>
</span><span id="line-2504"></span><span>        </span><span class="hs-identifier">prev_loc2</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- pos of two back token, including comments,</span><span>
</span><span id="line-2505"></span><span>                                   </span><span class="hs-comment">-- see Note [PsSpan in Comments]</span><span>
</span><span id="line-2506"></span><span>        </span><span class="hs-identifier">last_loc</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- pos of current token</span><span>
</span><span id="line-2507"></span><span>        </span><span class="hs-identifier">last_len</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- len of current token</span><span>
</span><span id="line-2508"></span><span>        </span><span class="hs-identifier">loc</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsLoc</span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- current loc (end of prev token + 1)</span><span>
</span><span id="line-2509"></span><span>        </span><span class="hs-identifier">context</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LayoutContext</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-2510"></span><span>        </span><span class="hs-identifier">lex_state</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Int</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-2511"></span><span>        </span><span class="hs-identifier">srcfiles</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">FastString</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-2512"></span><span>        </span><span class="hs-comment">-- Used in the alternative layout rule:</span><span>
</span><span id="line-2513"></span><span>        </span><span class="hs-comment">-- These tokens are the next ones to be sent out. They are</span><span>
</span><span id="line-2514"></span><span>        </span><span class="hs-comment">-- just blindly emitted, without the rule looking at them again:</span><span>
</span><span id="line-2515"></span><span>        </span><span class="hs-identifier">alr_pending_implicit_tokens</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-2516"></span><span>        </span><span class="hs-comment">-- This is the next token to be considered or, if it is Nothing,</span><span>
</span><span id="line-2517"></span><span>        </span><span class="hs-comment">-- we need to get the next token from the input stream:</span><span>
</span><span id="line-2518"></span><span>        </span><span class="hs-identifier">alr_next_token</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2519"></span><span>        </span><span class="hs-comment">-- This is what we consider to be the location of the last token</span><span>
</span><span id="line-2520"></span><span>        </span><span class="hs-comment">-- emitted:</span><span>
</span><span id="line-2521"></span><span>        </span><span class="hs-identifier">alr_last_loc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span class="hs-special">,</span><span>
</span><span id="line-2522"></span><span>        </span><span class="hs-comment">-- The stack of layout contexts:</span><span>
</span><span id="line-2523"></span><span>        </span><span class="hs-identifier">alr_context</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">ALRContext</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-2524"></span><span>        </span><span class="hs-comment">-- Are we expecting a '{'? If it's Just, then the ALRLayout tells</span><span>
</span><span id="line-2525"></span><span>        </span><span class="hs-comment">-- us what sort of layout the '{' will open:</span><span>
</span><span id="line-2526"></span><span>        </span><span class="hs-identifier">alr_expecting_ocurly</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">ALRLayout</span><span class="hs-special">,</span><span>
</span><span id="line-2527"></span><span>        </span><span class="hs-comment">-- Have we just had the '}' for a let block? If so, than an 'in'</span><span>
</span><span id="line-2528"></span><span>        </span><span class="hs-comment">-- token doesn't need to close anything:</span><span>
</span><span id="line-2529"></span><span>        </span><span class="hs-identifier">alr_justClosedExplicitLetBlock</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">,</span><span>
</span><span id="line-2530"></span><span>
</span><span id="line-2531"></span><span>        </span><span class="hs-comment">-- The next three are used to implement Annotations giving the</span><span>
</span><span id="line-2532"></span><span>        </span><span class="hs-comment">-- locations of 'noise' tokens in the source, so that users of</span><span>
</span><span id="line-2533"></span><span>        </span><span class="hs-comment">-- the GHC API can do source to source conversions.</span><span>
</span><span id="line-2534"></span><span>        </span><span class="hs-comment">-- See Note [exact print annotations] in GHC.Parser.Annotation</span><span>
</span><span id="line-2535"></span><span>        </span><span class="hs-identifier">eof_pos</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.Pair</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- pos, gap to prior token</span><span>
</span><span id="line-2536"></span><span>        </span><span class="hs-identifier">header_comments</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-2537"></span><span>        </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-2538"></span><span>
</span><span id="line-2539"></span><span>        </span><span class="hs-comment">-- Haddock comments accumulated in ascending order of their location</span><span>
</span><span id="line-2540"></span><span>        </span><span class="hs-comment">-- (BufPos). We use OrdList to get O(1) snoc.</span><span>
</span><span id="line-2541"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-2542"></span><span>        </span><span class="hs-comment">-- See Note [Adding Haddock comments to the syntax tree] in GHC.Parser.PostProcess.Haddock</span><span>
</span><span id="line-2543"></span><span>        </span><span class="hs-identifier">hdk_comments</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">OrdList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">HdkComment</span><span class="hs-special">)</span><span>
</span><span id="line-2544"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-2545"></span><span>        </span><span class="hs-comment">-- last_loc and last_len are used when generating error messages,</span><span>
</span><span id="line-2546"></span><span>        </span><span class="hs-comment">-- and in pushCurrentContext only.  Sigh, if only Happy passed the</span><span>
</span><span id="line-2547"></span><span>        </span><span class="hs-comment">-- current token to happyError, we could at least get rid of last_len.</span><span>
</span><span id="line-2548"></span><span>        </span><span class="hs-comment">-- Getting rid of last_loc would require finding another way to</span><span>
</span><span id="line-2549"></span><span>        </span><span class="hs-comment">-- implement pushCurrentContext (which is only called from one place).</span><span>
</span><span id="line-2550"></span><span>
</span><span id="line-2551"></span><span>        </span><span class="hs-comment">-- AZ question: setLastToken which sets last_loc and last_len</span><span>
</span><span id="line-2552"></span><span>        </span><span class="hs-comment">-- is called when processing AlexToken, immediately prior to</span><span>
</span><span id="line-2553"></span><span>        </span><span class="hs-comment">-- calling the action in the token.  So from the perspective</span><span>
</span><span id="line-2554"></span><span>        </span><span class="hs-comment">-- of the action, it is the *current* token.  Do I understand</span><span>
</span><span id="line-2555"></span><span>        </span><span class="hs-comment">-- correctly?</span><span>
</span><span id="line-2556"></span><span>
</span><span id="line-2557"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">ALRContext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ALRNoLayout</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-comment">{- does it contain commas? -}</span><span>
</span><span id="line-2558"></span><span>                              </span><span class="hs-identifier">Bool</span><span class="hs-comment">{- is it a 'let' block? -}</span><span>
</span><span id="line-2559"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-2560"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ALRLayoutLet</span><span>
</span><span id="line-2561"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ALRLayoutWhere</span><span>
</span><span id="line-2562"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ALRLayoutOf</span><span>
</span><span id="line-2563"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ALRLayoutDo</span><span>
</span><span id="line-2564"></span><span>
</span><span id="line-2565"></span><span class="hs-comment">-- | The parsing monad, isomorphic to @StateT PState Maybe@.</span><span>
</span><span id="line-2566"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">unP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PState</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ParseResult</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2567"></span><span>
</span><span id="line-2568"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2569"></span><span>  </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftM</span><span>
</span><span id="line-2570"></span><span>
</span><span id="line-2571"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2572"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">returnP</span><span>
</span><span id="line-2573"></span><span>  </span><span class="hs-special">(</span><span class="hs-operator">&lt;*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ap</span><span>
</span><span id="line-2574"></span><span>
</span><span id="line-2575"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2576"></span><span>  </span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">thenP</span><span>
</span><span id="line-2577"></span><span>
</span><span id="line-2578"></span><span class="hs-identifier">returnP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-2579"></span><span class="hs-identifier">returnP</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-2580"></span><span>
</span><span id="line-2581"></span><span class="hs-identifier">thenP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-2582"></span><span class="hs-special">(</span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">thenP</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2583"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2584"></span><span>                </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s1</span><span> </span><span class="hs-identifier">a</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s1</span><span>
</span><span id="line-2585"></span><span>                </span><span class="hs-identifier">PFailed</span><span> </span><span class="hs-identifier">s1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PFailed</span><span> </span><span class="hs-identifier">s1</span><span>
</span><span id="line-2586"></span><span>
</span><span id="line-2587"></span><span class="hs-identifier">failMsgP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">MsgEnvelope</span><span> </span><span class="hs-identifier">PsMessage</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-2588"></span><span class="hs-identifier">failMsgP</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2589"></span><span>  </span><span class="hs-identifier">pState</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getPState</span><span>
</span><span id="line-2590"></span><span>  </span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-identifier">pState</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2591"></span><span>
</span><span id="line-2592"></span><span class="hs-identifier">failLocMsgP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">MsgEnvelope</span><span> </span><span class="hs-identifier">PsMessage</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-2593"></span><span class="hs-identifier">failLocMsgP</span><span> </span><span class="hs-identifier">loc1</span><span> </span><span class="hs-identifier">loc2</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2594"></span><span>  </span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkRealSrcSpan</span><span> </span><span class="hs-identifier">loc1</span><span> </span><span class="hs-identifier">loc2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2595"></span><span>
</span><span id="line-2596"></span><span class="hs-identifier">getPState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">PState</span><span>
</span><span id="line-2597"></span><span class="hs-identifier">getPState</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2598"></span><span>
</span><span id="line-2599"></span><span class="hs-identifier">getExts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-2600"></span><span class="hs-identifier">getExts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-2601"></span><span>
</span><span id="line-2602"></span><span class="hs-identifier">setExts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ExtsBitmap</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2603"></span><span class="hs-identifier">setExts</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-2604"></span><span>  </span><span class="hs-identifier">options</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2605"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2606"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2607"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2608"></span><span>
</span><span id="line-2609"></span><span class="hs-identifier">setSrcLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2610"></span><span class="hs-identifier">setSrcLoc</span><span> </span><span class="hs-identifier">new_loc</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2611"></span><span>  </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsLoc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf_loc</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2612"></span><span>  </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsLoc</span><span> </span><span class="hs-identifier">new_loc</span><span> </span><span class="hs-identifier">buf_loc</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2613"></span><span>
</span><span id="line-2614"></span><span class="hs-identifier">getRealSrcLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span>
</span><span id="line-2615"></span><span class="hs-identifier">getRealSrcLoc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">loc</span><span class="hs-glyph">=</span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span>
</span><span id="line-2616"></span><span>
</span><span id="line-2617"></span><span class="hs-identifier">getParsedLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">PsLoc</span><span>
</span><span id="line-2618"></span><span class="hs-identifier">getParsedLoc</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">loc</span><span class="hs-glyph">=</span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">loc</span><span>
</span><span id="line-2619"></span><span>
</span><span id="line-2620"></span><span class="hs-identifier">addSrcFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2621"></span><span class="hs-identifier">addSrcFile</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">srcfiles</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">srcfiles</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2622"></span><span>
</span><span id="line-2623"></span><span class="hs-identifier">setEofPos</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2624"></span><span class="hs-identifier">setEofPos</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">gap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eof_pos</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">span</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">Strict.And</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">gap</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2625"></span><span>
</span><span id="line-2626"></span><span class="hs-identifier">setLastToken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2627"></span><span class="hs-identifier">setLastToken</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-2628"></span><span>  </span><span class="hs-identifier">last_loc</span><span class="hs-glyph">=</span><span class="hs-identifier">loc</span><span class="hs-special">,</span><span>
</span><span id="line-2629"></span><span>  </span><span class="hs-identifier">last_len</span><span class="hs-glyph">=</span><span class="hs-identifier">len</span><span>
</span><span id="line-2630"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2631"></span><span>
</span><span id="line-2632"></span><span class="hs-identifier">setLastTk</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2633"></span><span class="hs-identifier">setLastTk</span><span> </span><span class="hs-identifier">tk</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">last_tk</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-identifier">tk</span><span>
</span><span id="line-2634"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">prev_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">l</span><span>
</span><span id="line-2635"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">prev_loc2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">prev_loc</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2636"></span><span>
</span><span id="line-2637"></span><span class="hs-identifier">setLastComment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2638"></span><span class="hs-identifier">setLastComment</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">prev_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">l</span><span>
</span><span id="line-2639"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">prev_loc2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">prev_loc</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2640"></span><span>
</span><span id="line-2641"></span><span class="hs-identifier">getLastTk</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2642"></span><span class="hs-identifier">getLastTk</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">last_tk</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">last_tk</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">last_tk</span><span>
</span><span id="line-2643"></span><span>
</span><span id="line-2644"></span><span class="hs-comment">-- see Note [PsSpan in Comments]</span><span>
</span><span id="line-2645"></span><span class="hs-identifier">getLastLocComment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">PsSpan</span><span>
</span><span id="line-2646"></span><span class="hs-identifier">getLastLocComment</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">prev_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">prev_loc</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">prev_loc</span><span>
</span><span id="line-2647"></span><span>
</span><span id="line-2648"></span><span class="hs-comment">-- see Note [PsSpan in Comments]</span><span>
</span><span id="line-2649"></span><span class="hs-identifier">getLastLocEof</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">PsSpan</span><span>
</span><span id="line-2650"></span><span class="hs-identifier">getLastLocEof</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">prev_loc2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">prev_loc2</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">prev_loc2</span><span>
</span><span id="line-2651"></span><span>
</span><span id="line-2652"></span><span class="hs-identifier">getLastLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">PsSpan</span><span>
</span><span id="line-2653"></span><span class="hs-identifier">getLastLoc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">last_loc</span><span>
</span><span id="line-2654"></span><span>
</span><span id="line-2655"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AI</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">PsLoc</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">StringBuffer</span><span>
</span><span id="line-2656"></span><span>
</span><span id="line-2657"></span><span class="hs-comment">{-
Note [Unicode in Alex]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Although newer versions of Alex support unicode, this grammar is processed with
the old style '--latin1' behaviour. This means that when implementing the
functions

    alexGetByte       :: AlexInput -&gt; Maybe (Word8,AlexInput)
    alexInputPrevChar :: AlexInput -&gt; Char

which Alex uses to take apart our 'AlexInput', we must

  * return a latin1 character in the 'Word8' that 'alexGetByte' expects
  * return a latin1 character in 'alexInputPrevChar'.

We handle this in 'adjustChar' by squishing entire classes of unicode
characters into single bytes.
-}</span><span>
</span><span id="line-2675"></span><span>
</span><span id="line-2676"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">adjustChar</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2677"></span><span class="hs-identifier">adjustChar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word8</span><span>
</span><span id="line-2678"></span><span class="hs-identifier">adjustChar</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">ord</span><span> </span><span class="hs-identifier">adj_c</span><span>
</span><span id="line-2679"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">non_graphic</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\x00'</span><span>
</span><span id="line-2680"></span><span>        </span><span class="hs-identifier">upper</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\x01'</span><span>
</span><span id="line-2681"></span><span>        </span><span class="hs-identifier">lower</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\x02'</span><span>
</span><span id="line-2682"></span><span>        </span><span class="hs-identifier">digit</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\x03'</span><span>
</span><span id="line-2683"></span><span>        </span><span class="hs-identifier">symbol</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\x04'</span><span>
</span><span id="line-2684"></span><span>        </span><span class="hs-identifier">space</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\x05'</span><span>
</span><span id="line-2685"></span><span>        </span><span class="hs-identifier">other_graphic</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\x06'</span><span>
</span><span id="line-2686"></span><span>        </span><span class="hs-identifier">uniidchar</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\x07'</span><span>
</span><span id="line-2687"></span><span>
</span><span id="line-2688"></span><span>        </span><span class="hs-identifier">adj_c</span><span>
</span><span id="line-2689"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\x07'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">non_graphic</span><span>
</span><span id="line-2690"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-char">'\x7f'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2691"></span><span>          </span><span class="hs-comment">-- Alex doesn't handle Unicode, so when Unicode</span><span>
</span><span id="line-2692"></span><span>          </span><span class="hs-comment">-- character is encountered we output these values</span><span>
</span><span id="line-2693"></span><span>          </span><span class="hs-comment">-- with the actual character value hidden in the state.</span><span>
</span><span id="line-2694"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2695"></span><span>                </span><span class="hs-comment">-- NB: The logic behind these definitions is also reflected</span><span>
</span><span id="line-2696"></span><span>                </span><span class="hs-comment">-- in &quot;GHC.Utils.Lexeme&quot;</span><span>
</span><span id="line-2697"></span><span>                </span><span class="hs-comment">-- Any changes here should likely be reflected there.</span><span>
</span><span id="line-2698"></span><span>
</span><span id="line-2699"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">generalCategory</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2700"></span><span>                  </span><span class="hs-identifier">UppercaseLetter</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">upper</span><span>
</span><span id="line-2701"></span><span>                  </span><span class="hs-identifier">LowercaseLetter</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lower</span><span>
</span><span id="line-2702"></span><span>                  </span><span class="hs-identifier">TitlecaseLetter</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">upper</span><span>
</span><span id="line-2703"></span><span>                  </span><span class="hs-identifier">ModifierLetter</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">uniidchar</span><span> </span><span class="hs-comment">-- see #10196</span><span>
</span><span id="line-2704"></span><span>                  </span><span class="hs-identifier">OtherLetter</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lower</span><span> </span><span class="hs-comment">-- see #1103</span><span>
</span><span id="line-2705"></span><span>                  </span><span class="hs-identifier">NonSpacingMark</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">uniidchar</span><span> </span><span class="hs-comment">-- see #7650</span><span>
</span><span id="line-2706"></span><span>                  </span><span class="hs-identifier">SpacingCombiningMark</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">other_graphic</span><span>
</span><span id="line-2707"></span><span>                  </span><span class="hs-identifier">EnclosingMark</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">other_graphic</span><span>
</span><span id="line-2708"></span><span>                  </span><span class="hs-identifier">DecimalNumber</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">digit</span><span>
</span><span id="line-2709"></span><span>                  </span><span class="hs-identifier">LetterNumber</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">digit</span><span>
</span><span id="line-2710"></span><span>                  </span><span class="hs-identifier">OtherNumber</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">digit</span><span> </span><span class="hs-comment">-- see #4373</span><span>
</span><span id="line-2711"></span><span>                  </span><span class="hs-identifier">ConnectorPunctuation</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-2712"></span><span>                  </span><span class="hs-identifier">DashPunctuation</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-2713"></span><span>                  </span><span class="hs-identifier">OpenPunctuation</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">other_graphic</span><span>
</span><span id="line-2714"></span><span>                  </span><span class="hs-identifier">ClosePunctuation</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">other_graphic</span><span>
</span><span id="line-2715"></span><span>                  </span><span class="hs-identifier">InitialQuote</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">other_graphic</span><span>
</span><span id="line-2716"></span><span>                  </span><span class="hs-identifier">FinalQuote</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">other_graphic</span><span>
</span><span id="line-2717"></span><span>                  </span><span class="hs-identifier">OtherPunctuation</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-2718"></span><span>                  </span><span class="hs-identifier">MathSymbol</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-2719"></span><span>                  </span><span class="hs-identifier">CurrencySymbol</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-2720"></span><span>                  </span><span class="hs-identifier">ModifierSymbol</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-2721"></span><span>                  </span><span class="hs-identifier">OtherSymbol</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-2722"></span><span>                  </span><span class="hs-identifier">Space</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">space</span><span>
</span><span id="line-2723"></span><span>                  </span><span class="hs-identifier">_other</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">non_graphic</span><span>
</span><span id="line-2724"></span><span>
</span><span id="line-2725"></span><span class="hs-comment">-- Getting the previous 'Char' isn't enough here - we need to convert it into</span><span>
</span><span id="line-2726"></span><span class="hs-comment">-- the same format that 'alexGetByte' would have produced.</span><span>
</span><span id="line-2727"></span><span class="hs-comment">--</span><span>
</span><span id="line-2728"></span><span class="hs-comment">-- See Note [Unicode in Alex] and #13986.</span><span>
</span><span id="line-2729"></span><span class="hs-identifier">alexInputPrevChar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Char</span><span>
</span><span id="line-2730"></span><span class="hs-identifier">alexInputPrevChar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">chr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">adjustChar</span><span> </span><span class="hs-identifier">pc</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2731"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">pc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">prevChar</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-char">'\n'</span><span>
</span><span id="line-2732"></span><span>
</span><span id="line-2733"></span><span class="hs-comment">-- backwards compatibility for Alex 2.x</span><span>
</span><span id="line-2734"></span><span class="hs-identifier">alexGetChar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span class="hs-special">,</span><span class="hs-identifier">AlexInput</span><span class="hs-special">)</span><span>
</span><span id="line-2735"></span><span class="hs-identifier">alexGetChar</span><span> </span><span class="hs-identifier">inp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetByte</span><span> </span><span class="hs-identifier">inp</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2736"></span><span>                    </span><span class="hs-identifier">Nothing</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-2737"></span><span>                    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-2738"></span><span>                       </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">chr</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-2739"></span><span>
</span><span id="line-2740"></span><span class="hs-comment">-- See Note [Unicode in Alex]</span><span>
</span><span id="line-2741"></span><span class="hs-identifier">alexGetByte</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Word8</span><span class="hs-special">,</span><span class="hs-identifier">AlexInput</span><span class="hs-special">)</span><span>
</span><span id="line-2742"></span><span class="hs-identifier">alexGetByte</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-2743"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">atEnd</span><span> </span><span class="hs-identifier">s</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-2744"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">byte</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">loc'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span>
</span><span id="line-2745"></span><span>                </span><span class="hs-comment">--trace (show (ord c)) $</span><span>
</span><span id="line-2746"></span><span>                </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">byte</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc'</span><span> </span><span class="hs-identifier">s'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2747"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">s'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nextChar</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2748"></span><span>        </span><span class="hs-identifier">loc'</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">advancePsLoc</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2749"></span><span>        </span><span class="hs-identifier">byte</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">adjustChar</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2750"></span><span>
</span><span id="line-2751"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">alexGetChar'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2752"></span><span class="hs-comment">-- This version does not squash unicode characters, it is used when</span><span>
</span><span id="line-2753"></span><span class="hs-comment">-- lexing strings.</span><span>
</span><span id="line-2754"></span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span class="hs-special">,</span><span class="hs-identifier">AlexInput</span><span class="hs-special">)</span><span>
</span><span id="line-2755"></span><span class="hs-identifier">alexGetChar'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-2756"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">atEnd</span><span> </span><span class="hs-identifier">s</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-2757"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">loc'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span>
</span><span id="line-2758"></span><span>                </span><span class="hs-comment">--trace (show (ord c)) $</span><span>
</span><span id="line-2759"></span><span>                </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc'</span><span> </span><span class="hs-identifier">s'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2760"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">s'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nextChar</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2761"></span><span>        </span><span class="hs-identifier">loc'</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">advancePsLoc</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-2762"></span><span>
</span><span id="line-2763"></span><span class="hs-identifier">getInput</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">AlexInput</span><span>
</span><span id="line-2764"></span><span class="hs-identifier">getInput</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">loc</span><span class="hs-glyph">=</span><span class="hs-identifier">l</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">buffer</span><span class="hs-glyph">=</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><span id="line-2765"></span><span>
</span><span id="line-2766"></span><span class="hs-identifier">setInput</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2767"></span><span class="hs-identifier">setInput</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">loc</span><span class="hs-glyph">=</span><span class="hs-identifier">l</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">buffer</span><span class="hs-glyph">=</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2768"></span><span>
</span><span id="line-2769"></span><span class="hs-identifier">nextIsEOF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2770"></span><span class="hs-identifier">nextIsEOF</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2771"></span><span>  </span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-2772"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">atEnd</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-2773"></span><span>
</span><span id="line-2774"></span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2775"></span><span class="hs-identifier">pushLexState</span><span> </span><span class="hs-identifier">ls</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lex_state</span><span class="hs-glyph">=</span><span class="hs-identifier">l</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span class="hs-identifier">lex_state</span><span class="hs-glyph">=</span><span class="hs-identifier">ls</span><span class="hs-glyph">:</span><span class="hs-identifier">l</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2776"></span><span>
</span><span id="line-2777"></span><span class="hs-identifier">popLexState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-2778"></span><span class="hs-identifier">popLexState</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lex_state</span><span class="hs-glyph">=</span><span class="hs-identifier">ls</span><span class="hs-glyph">:</span><span class="hs-identifier">l</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lex_state</span><span class="hs-glyph">=</span><span class="hs-identifier">l</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-2779"></span><span>
</span><span id="line-2780"></span><span class="hs-identifier">getLexState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-2781"></span><span class="hs-identifier">getLexState</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lex_state</span><span class="hs-glyph">=</span><span class="hs-identifier">ls</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-2782"></span><span>
</span><span id="line-2783"></span><span class="hs-identifier">popNextToken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2784"></span><span class="hs-identifier">popNextToken</span><span>
</span><span id="line-2785"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">alr_next_token</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2786"></span><span>              </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_next_token</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span>
</span><span id="line-2787"></span><span>
</span><span id="line-2788"></span><span class="hs-identifier">activeContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2789"></span><span class="hs-identifier">activeContext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2790"></span><span>  </span><span class="hs-identifier">ctxt</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getALRContext</span><span>
</span><span id="line-2791"></span><span>  </span><span class="hs-identifier">expc</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getAlrExpectingOCurly</span><span>
</span><span id="line-2792"></span><span>  </span><span class="hs-identifier">impt</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">implicitTokenPending</span><span>
</span><span id="line-2793"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ctxt</span><span class="hs-special">,</span><span class="hs-identifier">expc</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2794"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-identifier">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">impt</span><span>
</span><span id="line-2795"></span><span>    </span><span class="hs-identifier">_other</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2796"></span><span>
</span><span id="line-2797"></span><span class="hs-identifier">resetAlrLastLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2798"></span><span class="hs-identifier">resetAlrLastLoc</span><span> </span><span class="hs-identifier">file</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2799"></span><span>  </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_last_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">buf_span</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2800"></span><span>  </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">alr_last_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alrInitialLoc</span><span> </span><span class="hs-identifier">file</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf_span</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2801"></span><span>
</span><span id="line-2802"></span><span class="hs-identifier">setAlrLastLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2803"></span><span class="hs-identifier">setAlrLastLoc</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_last_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2804"></span><span>
</span><span id="line-2805"></span><span class="hs-identifier">getAlrLastLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">PsSpan</span><span>
</span><span id="line-2806"></span><span class="hs-identifier">getAlrLastLoc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_last_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">l</span><span>
</span><span id="line-2807"></span><span>
</span><span id="line-2808"></span><span class="hs-identifier">getALRContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">ALRContext</span><span class="hs-special">]</span><span>
</span><span id="line-2809"></span><span class="hs-identifier">getALRContext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_context</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cs</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">cs</span><span>
</span><span id="line-2810"></span><span>
</span><span id="line-2811"></span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">ALRContext</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2812"></span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">cs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_context</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cs</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2813"></span><span>
</span><span id="line-2814"></span><span class="hs-identifier">getJustClosedExplicitLetBlock</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2815"></span><span class="hs-identifier">getJustClosedExplicitLetBlock</span><span>
</span><span id="line-2816"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_justClosedExplicitLetBlock</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-2817"></span><span>
</span><span id="line-2818"></span><span class="hs-identifier">setJustClosedExplicitLetBlock</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2819"></span><span class="hs-identifier">setJustClosedExplicitLetBlock</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-2820"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_justClosedExplicitLetBlock</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2821"></span><span>
</span><span id="line-2822"></span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2823"></span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_next_token</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2824"></span><span>
</span><span id="line-2825"></span><span class="hs-identifier">implicitTokenPending</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2826"></span><span class="hs-identifier">implicitTokenPending</span><span>
</span><span id="line-2827"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">alr_pending_implicit_tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ts</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2828"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ts</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2829"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-2830"></span><span>              </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-2831"></span><span>
</span><span id="line-2832"></span><span class="hs-identifier">popPendingImplicitToken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2833"></span><span class="hs-identifier">popPendingImplicitToken</span><span>
</span><span id="line-2834"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">alr_pending_implicit_tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ts</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2835"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ts</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2836"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-2837"></span><span>              </span><span class="hs-special">(</span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ts'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_pending_implicit_tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ts'</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><span id="line-2838"></span><span>
</span><span id="line-2839"></span><span class="hs-identifier">setPendingImplicitTokens</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2840"></span><span class="hs-identifier">setPendingImplicitTokens</span><span> </span><span class="hs-identifier">ts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_pending_implicit_tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ts</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2841"></span><span>
</span><span id="line-2842"></span><span class="hs-identifier">getAlrExpectingOCurly</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">ALRLayout</span><span class="hs-special">)</span><span>
</span><span id="line-2843"></span><span class="hs-identifier">getAlrExpectingOCurly</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_expecting_ocurly</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-2844"></span><span>
</span><span id="line-2845"></span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2846"></span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">alr_expecting_ocurly</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2847"></span><span>
</span><span id="line-2848"></span><span class="hs-comment">-- | For reasons of efficiency, boolean parsing flags (eg, language extensions</span><span>
</span><span id="line-2849"></span><span class="hs-comment">-- or whether we are currently in a @RULE@ pragma) are represented by a bitmap</span><span>
</span><span id="line-2850"></span><span class="hs-comment">-- stored in a @Word64@.</span><span>
</span><span id="line-2851"></span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Word64</span><span>
</span><span id="line-2852"></span><span>
</span><span id="line-2853"></span><span class="hs-identifier">xbit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ExtBits</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-2854"></span><span class="hs-identifier">xbit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bit</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">fromEnum</span><span>
</span><span id="line-2855"></span><span>
</span><span id="line-2856"></span><span class="hs-identifier">xtest</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ExtBits</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2857"></span><span class="hs-identifier">xtest</span><span> </span><span class="hs-identifier">ext</span><span> </span><span class="hs-identifier">xmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">testBit</span><span> </span><span class="hs-identifier">xmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromEnum</span><span> </span><span class="hs-identifier">ext</span><span class="hs-special">)</span><span>
</span><span id="line-2858"></span><span>
</span><span id="line-2859"></span><span class="hs-identifier">xset</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ExtBits</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-2860"></span><span class="hs-identifier">xset</span><span> </span><span class="hs-identifier">ext</span><span> </span><span class="hs-identifier">xmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">setBit</span><span> </span><span class="hs-identifier">xmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromEnum</span><span> </span><span class="hs-identifier">ext</span><span class="hs-special">)</span><span>
</span><span id="line-2861"></span><span>
</span><span id="line-2862"></span><span class="hs-identifier">xunset</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ExtBits</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-2863"></span><span class="hs-identifier">xunset</span><span> </span><span class="hs-identifier">ext</span><span> </span><span class="hs-identifier">xmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">clearBit</span><span> </span><span class="hs-identifier">xmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromEnum</span><span> </span><span class="hs-identifier">ext</span><span class="hs-special">)</span><span>
</span><span id="line-2864"></span><span>
</span><span id="line-2865"></span><span class="hs-comment">-- | Various boolean flags, mostly language extensions, that impact lexing and</span><span>
</span><span id="line-2866"></span><span class="hs-comment">-- parsing. Note that a handful of these can change during lexing/parsing.</span><span>
</span><span id="line-2867"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">ExtBits</span><span>
</span><span id="line-2868"></span><span>  </span><span class="hs-comment">-- Flags that are constant once parsing starts</span><span>
</span><span id="line-2869"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">FfiBit</span><span>
</span><span id="line-2870"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">InterruptibleFfiBit</span><span>
</span><span id="line-2871"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">CApiFfiBit</span><span>
</span><span id="line-2872"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ArrowsBit</span><span>
</span><span id="line-2873"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ThBit</span><span>
</span><span id="line-2874"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span>
</span><span id="line-2875"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">IpBit</span><span>
</span><span id="line-2876"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">OverloadedLabelsBit</span><span> </span><span class="hs-comment">-- #x overloaded labels</span><span>
</span><span id="line-2877"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ExplicitForallBit</span><span> </span><span class="hs-comment">-- the 'forall' keyword</span><span>
</span><span id="line-2878"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">BangPatBit</span><span> </span><span class="hs-comment">-- Tells the parser to understand bang-patterns</span><span>
</span><span id="line-2879"></span><span>               </span><span class="hs-comment">-- (doesn't affect the lexer)</span><span>
</span><span id="line-2880"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">PatternSynonymsBit</span><span> </span><span class="hs-comment">-- pattern synonyms</span><span>
</span><span id="line-2881"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">HaddockBit</span><span class="hs-comment">-- Lex and parse Haddock comments</span><span>
</span><span id="line-2882"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">MagicHashBit</span><span> </span><span class="hs-comment">-- &quot;#&quot; in both functions and operators</span><span>
</span><span id="line-2883"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">RecursiveDoBit</span><span> </span><span class="hs-comment">-- mdo</span><span>
</span><span id="line-2884"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">QualifiedDoBit</span><span> </span><span class="hs-comment">-- .do and .mdo</span><span>
</span><span id="line-2885"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">UnicodeSyntaxBit</span><span> </span><span class="hs-comment">-- the forall symbol, arrow symbols, etc</span><span>
</span><span id="line-2886"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">UnboxedParensBit</span><span> </span><span class="hs-comment">-- (# and #)</span><span>
</span><span id="line-2887"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">DatatypeContextsBit</span><span>
</span><span id="line-2888"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">MonadComprehensionsBit</span><span>
</span><span id="line-2889"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">TransformComprehensionsBit</span><span>
</span><span id="line-2890"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">QqBit</span><span> </span><span class="hs-comment">-- enable quasiquoting</span><span>
</span><span id="line-2891"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">RawTokenStreamBit</span><span> </span><span class="hs-comment">-- producing a token stream with all comments included</span><span>
</span><span id="line-2892"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlternativeLayoutRuleBit</span><span>
</span><span id="line-2893"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ALRTransitionalBit</span><span>
</span><span id="line-2894"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">RelaxedLayoutBit</span><span>
</span><span id="line-2895"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">NondecreasingIndentationBit</span><span>
</span><span id="line-2896"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">SafeHaskellBit</span><span>
</span><span id="line-2897"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">TraditionalRecordSyntaxBit</span><span>
</span><span id="line-2898"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ExplicitNamespacesBit</span><span>
</span><span id="line-2899"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">LambdaCaseBit</span><span>
</span><span id="line-2900"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">BinaryLiteralsBit</span><span>
</span><span id="line-2901"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">NegativeLiteralsBit</span><span>
</span><span id="line-2902"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">HexFloatLiteralsBit</span><span>
</span><span id="line-2903"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">StaticPointersBit</span><span>
</span><span id="line-2904"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">NumericUnderscoresBit</span><span>
</span><span id="line-2905"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">StarIsTypeBit</span><span>
</span><span id="line-2906"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">BlockArgumentsBit</span><span>
</span><span id="line-2907"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">NPlusKPatternsBit</span><span>
</span><span id="line-2908"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">DoAndIfThenElseBit</span><span>
</span><span id="line-2909"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">MultiWayIfBit</span><span>
</span><span id="line-2910"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">GadtSyntaxBit</span><span>
</span><span id="line-2911"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ImportQualifiedPostBit</span><span>
</span><span id="line-2912"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">LinearTypesBit</span><span>
</span><span id="line-2913"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">NoLexicalNegationBit</span><span>   </span><span class="hs-comment">-- See Note [Why not LexicalNegationBit]</span><span>
</span><span id="line-2914"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">OverloadedRecordDotBit</span><span>
</span><span id="line-2915"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">OverloadedRecordUpdateBit</span><span>
</span><span id="line-2916"></span><span>
</span><span id="line-2917"></span><span>  </span><span class="hs-comment">-- Flags that are updated once parsing starts</span><span>
</span><span id="line-2918"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">InRulePragBit</span><span>
</span><span id="line-2919"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">InNestedCommentBit</span><span> </span><span class="hs-comment">-- See Note [Nested comment line pragmas]</span><span>
</span><span id="line-2920"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">UsePosPragsBit</span><span>
</span><span id="line-2921"></span><span>    </span><span class="hs-comment">-- ^ If this is enabled, '{-# LINE ... -#}' and '{-# COLUMN ... #-}'</span><span>
</span><span id="line-2922"></span><span>    </span><span class="hs-comment">-- update the internal position. Otherwise, those pragmas are lexed as</span><span>
</span><span id="line-2923"></span><span>    </span><span class="hs-comment">-- tokens of their own.</span><span>
</span><span id="line-2924"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Enum</span><span>
</span><span id="line-2925"></span><span>
</span><span id="line-2926"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">mkParserOpts</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2927"></span><span class="hs-identifier">mkParserOpts</span><span>
</span><span id="line-2928"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">EnumSet</span><span> </span><span class="hs-identifier">LangExt.Extension</span><span>  </span><span class="hs-comment">-- ^ permitted language extensions enabled</span><span>
</span><span id="line-2929"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DiagOpts</span><span>                   </span><span class="hs-comment">-- ^ diagnostic options</span><span>
</span><span id="line-2930"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">String</span><span class="hs-special">]</span><span>                   </span><span class="hs-comment">-- ^ Supported Languages and Extensions</span><span>
</span><span id="line-2931"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>                       </span><span class="hs-comment">-- ^ are safe imports on?</span><span>
</span><span id="line-2932"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>                       </span><span class="hs-comment">-- ^ keeping Haddock comment tokens</span><span>
</span><span id="line-2933"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>                       </span><span class="hs-comment">-- ^ keep regular comment tokens</span><span>
</span><span id="line-2934"></span><span>
</span><span id="line-2935"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-2936"></span><span>  </span><span class="hs-comment">-- ^ If this is enabled, '{-# LINE ... -#}' and '{-# COLUMN ... #-}' update</span><span>
</span><span id="line-2937"></span><span>  </span><span class="hs-comment">-- the internal position kept by the parser. Otherwise, those pragmas are</span><span>
</span><span id="line-2938"></span><span>  </span><span class="hs-comment">-- lexed as 'ITline_prag' and 'ITcolumn_prag' tokens.</span><span>
</span><span id="line-2939"></span><span>
</span><span id="line-2940"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ParserOpts</span><span>
</span><span id="line-2941"></span><span class="hs-comment">-- ^ Given exactly the information needed, set up the 'ParserOpts'</span><span>
</span><span id="line-2942"></span><span class="hs-identifier">mkParserOpts</span><span> </span><span class="hs-identifier">extensionFlags</span><span> </span><span class="hs-identifier">diag_opts</span><span> </span><span class="hs-identifier">supported</span><span>
</span><span id="line-2943"></span><span>  </span><span class="hs-identifier">safeImports</span><span> </span><span class="hs-identifier">isHaddock</span><span> </span><span class="hs-identifier">rawTokStream</span><span> </span><span class="hs-identifier">usePosPrags</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2944"></span><span>    </span><span class="hs-identifier">ParserOpts</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-2945"></span><span>      </span><span class="hs-identifier">pDiagOpts</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">diag_opts</span><span>
</span><span id="line-2946"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">safeHaskellBit</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">langExtBits</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">optBits</span><span>
</span><span id="line-2947"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pSupportedExts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">supported</span><span>
</span><span id="line-2948"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-2949"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2950"></span><span>    </span><span class="hs-identifier">safeHaskellBit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SafeHaskellBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">setBitIf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">safeImports</span><span>
</span><span id="line-2951"></span><span>    </span><span class="hs-identifier">langExtBits</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2952"></span><span>          </span><span class="hs-identifier">FfiBit</span><span>                      </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.ForeignFunctionInterface</span><span>
</span><span id="line-2953"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">InterruptibleFfiBit</span><span>         </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.InterruptibleFFI</span><span>
</span><span id="line-2954"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">CApiFfiBit</span><span>                  </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.CApiFFI</span><span>
</span><span id="line-2955"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">ArrowsBit</span><span>                   </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.Arrows</span><span>
</span><span id="line-2956"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">ThBit</span><span>                       </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.TemplateHaskell</span><span>
</span><span id="line-2957"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span>                 </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.TemplateHaskellQuotes</span><span>
</span><span id="line-2958"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">QqBit</span><span>                       </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.QuasiQuotes</span><span>
</span><span id="line-2959"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">IpBit</span><span>                       </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.ImplicitParams</span><span>
</span><span id="line-2960"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">OverloadedLabelsBit</span><span>         </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.OverloadedLabels</span><span>
</span><span id="line-2961"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">ExplicitForallBit</span><span>           </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.ExplicitForAll</span><span>
</span><span id="line-2962"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">BangPatBit</span><span>                  </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.BangPatterns</span><span>
</span><span id="line-2963"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">MagicHashBit</span><span>                </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.MagicHash</span><span>
</span><span id="line-2964"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">RecursiveDoBit</span><span>              </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.RecursiveDo</span><span>
</span><span id="line-2965"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">QualifiedDoBit</span><span>              </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.QualifiedDo</span><span>
</span><span id="line-2966"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">UnicodeSyntaxBit</span><span>            </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.UnicodeSyntax</span><span>
</span><span id="line-2967"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">UnboxedParensBit</span><span>            </span><span class="hs-special">`</span><span class="hs-identifier">orXoptsBit</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LangExt.UnboxedTuples</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LangExt.UnboxedSums</span><span class="hs-special">]</span><span>
</span><span id="line-2968"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">DatatypeContextsBit</span><span>         </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.DatatypeContexts</span><span>
</span><span id="line-2969"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">TransformComprehensionsBit</span><span>  </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.TransformListComp</span><span>
</span><span id="line-2970"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">MonadComprehensionsBit</span><span>      </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.MonadComprehensions</span><span>
</span><span id="line-2971"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">AlternativeLayoutRuleBit</span><span>    </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.AlternativeLayoutRule</span><span>
</span><span id="line-2972"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">ALRTransitionalBit</span><span>          </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.AlternativeLayoutRuleTransitional</span><span>
</span><span id="line-2973"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">RelaxedLayoutBit</span><span>            </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.RelaxedLayout</span><span>
</span><span id="line-2974"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">NondecreasingIndentationBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.NondecreasingIndentation</span><span>
</span><span id="line-2975"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">TraditionalRecordSyntaxBit</span><span>  </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.TraditionalRecordSyntax</span><span>
</span><span id="line-2976"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">ExplicitNamespacesBit</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.ExplicitNamespaces</span><span>
</span><span id="line-2977"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">LambdaCaseBit</span><span>               </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.LambdaCase</span><span>
</span><span id="line-2978"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">BinaryLiteralsBit</span><span>           </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.BinaryLiterals</span><span>
</span><span id="line-2979"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">NegativeLiteralsBit</span><span>         </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.NegativeLiterals</span><span>
</span><span id="line-2980"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">HexFloatLiteralsBit</span><span>         </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.HexFloatLiterals</span><span>
</span><span id="line-2981"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">PatternSynonymsBit</span><span>          </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.PatternSynonyms</span><span>
</span><span id="line-2982"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">StaticPointersBit</span><span>           </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.StaticPointers</span><span>
</span><span id="line-2983"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">NumericUnderscoresBit</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.NumericUnderscores</span><span>
</span><span id="line-2984"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">StarIsTypeBit</span><span>               </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.StarIsType</span><span>
</span><span id="line-2985"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">BlockArgumentsBit</span><span>           </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.BlockArguments</span><span>
</span><span id="line-2986"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">NPlusKPatternsBit</span><span>           </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.NPlusKPatterns</span><span>
</span><span id="line-2987"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">DoAndIfThenElseBit</span><span>          </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.DoAndIfThenElse</span><span>
</span><span id="line-2988"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">MultiWayIfBit</span><span>               </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.MultiWayIf</span><span>
</span><span id="line-2989"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">GadtSyntaxBit</span><span>               </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.GADTSyntax</span><span>
</span><span id="line-2990"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">ImportQualifiedPostBit</span><span>      </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.ImportQualifiedPost</span><span>
</span><span id="line-2991"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">LinearTypesBit</span><span>              </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.LinearTypes</span><span>
</span><span id="line-2992"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">NoLexicalNegationBit</span><span>        </span><span class="hs-special">`</span><span class="hs-identifier">xoptNotBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.LexicalNegation</span><span> </span><span class="hs-comment">-- See Note [Why not LexicalNegationBit]</span><span>
</span><span id="line-2993"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">OverloadedRecordDotBit</span><span>      </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.OverloadedRecordDot</span><span>
</span><span id="line-2994"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">OverloadedRecordUpdateBit</span><span>   </span><span class="hs-special">`</span><span class="hs-identifier">xoptBit</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">LangExt.OverloadedRecordUpdate</span><span>  </span><span class="hs-comment">-- Enable testing via 'getBit OverloadedRecordUpdateBit' in the parser (RecordDotSyntax parsing uses that information).</span><span>
</span><span id="line-2995"></span><span>    </span><span class="hs-identifier">optBits</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2996"></span><span>          </span><span class="hs-identifier">HaddockBit</span><span>        </span><span class="hs-special">`</span><span class="hs-identifier">setBitIf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">isHaddock</span><span>
</span><span id="line-2997"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">RawTokenStreamBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">setBitIf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rawTokStream</span><span>
</span><span id="line-2998"></span><span>      </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">UsePosPragsBit</span><span>    </span><span class="hs-special">`</span><span class="hs-identifier">setBitIf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">usePosPrags</span><span>
</span><span id="line-2999"></span><span>
</span><span id="line-3000"></span><span>    </span><span class="hs-identifier">xoptBit</span><span> </span><span class="hs-identifier">bit</span><span> </span><span class="hs-identifier">ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">setBitIf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">EnumSet.member</span><span> </span><span class="hs-identifier">ext</span><span> </span><span class="hs-identifier">extensionFlags</span><span>
</span><span id="line-3001"></span><span>    </span><span class="hs-identifier">xoptNotBit</span><span> </span><span class="hs-identifier">bit</span><span> </span><span class="hs-identifier">ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">setBitIf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EnumSet.member</span><span> </span><span class="hs-identifier">ext</span><span> </span><span class="hs-identifier">extensionFlags</span><span class="hs-special">)</span><span>
</span><span id="line-3002"></span><span>
</span><span id="line-3003"></span><span>    </span><span class="hs-identifier">orXoptsBit</span><span> </span><span class="hs-identifier">bit</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">setBitIf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">EnumSet.member</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">extensionFlags</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">exts</span><span>
</span><span id="line-3004"></span><span>
</span><span id="line-3005"></span><span>    </span><span class="hs-identifier">setBitIf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ExtBits</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-3006"></span><span>    </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">setBitIf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">cond</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">cond</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xbit</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-3007"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-3008"></span><span>
</span><span id="line-3009"></span><span class="hs-identifier">disableHaddock</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ParserOpts</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ParserOpts</span><span>
</span><span id="line-3010"></span><span class="hs-identifier">disableHaddock</span><span> </span><span class="hs-identifier">opts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">upd_bitmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xunset</span><span> </span><span class="hs-identifier">HaddockBit</span><span class="hs-special">)</span><span>
</span><span id="line-3011"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3012"></span><span>    </span><span class="hs-identifier">upd_bitmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">opts</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-identifier">opts</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3013"></span><span>
</span><span id="line-3014"></span><span>
</span><span id="line-3015"></span><span class="hs-comment">-- | Set parser options for parsing OPTIONS pragmas</span><span>
</span><span id="line-3016"></span><span class="hs-identifier">initPragState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ParserOpts</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PState</span><span>
</span><span id="line-3017"></span><span class="hs-identifier">initPragState</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">initParserState</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span>
</span><span id="line-3018"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lex_state</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">bol</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">option_prags</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">]</span><span>
</span><span id="line-3019"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3020"></span><span>
</span><span id="line-3021"></span><span class="hs-comment">-- | Creates a parse state from a 'ParserOpts' value</span><span>
</span><span id="line-3022"></span><span class="hs-identifier">initParserState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ParserOpts</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PState</span><span>
</span><span id="line-3023"></span><span class="hs-identifier">initParserState</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3024"></span><span>  </span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-3025"></span><span>      </span><span class="hs-identifier">buffer</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">,</span><span>
</span><span id="line-3026"></span><span>      </span><span class="hs-identifier">options</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">options</span><span class="hs-special">,</span><span>
</span><span id="line-3027"></span><span>      </span><span class="hs-identifier">errors</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">emptyMessages</span><span class="hs-special">,</span><span>
</span><span id="line-3028"></span><span>      </span><span class="hs-identifier">warnings</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">emptyMessages</span><span class="hs-special">,</span><span>
</span><span id="line-3029"></span><span>      </span><span class="hs-identifier">tab_first</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">,</span><span>
</span><span id="line-3030"></span><span>      </span><span class="hs-identifier">tab_count</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><span id="line-3031"></span><span>      </span><span class="hs-identifier">last_tk</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">,</span><span>
</span><span id="line-3032"></span><span>      </span><span class="hs-identifier">prev_loc</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">init_loc</span><span> </span><span class="hs-identifier">init_loc</span><span class="hs-special">,</span><span>
</span><span id="line-3033"></span><span>      </span><span class="hs-identifier">prev_loc2</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">init_loc</span><span> </span><span class="hs-identifier">init_loc</span><span class="hs-special">,</span><span>
</span><span id="line-3034"></span><span>      </span><span class="hs-identifier">last_loc</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">init_loc</span><span> </span><span class="hs-identifier">init_loc</span><span class="hs-special">,</span><span>
</span><span id="line-3035"></span><span>      </span><span class="hs-identifier">last_len</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><span id="line-3036"></span><span>      </span><span class="hs-identifier">loc</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">init_loc</span><span class="hs-special">,</span><span>
</span><span id="line-3037"></span><span>      </span><span class="hs-identifier">context</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3038"></span><span>      </span><span class="hs-identifier">lex_state</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">bol</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3039"></span><span>      </span><span class="hs-identifier">srcfiles</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3040"></span><span>      </span><span class="hs-identifier">alr_pending_implicit_tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3041"></span><span>      </span><span class="hs-identifier">alr_next_token</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-special">,</span><span>
</span><span id="line-3042"></span><span>      </span><span class="hs-identifier">alr_last_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alrInitialLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fsLit</span><span> </span><span class="hs-string">&quot;&lt;no file&gt;&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">BufSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">BufPos</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">BufPos</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3043"></span><span>      </span><span class="hs-identifier">alr_context</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3044"></span><span>      </span><span class="hs-identifier">alr_expecting_ocurly</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-special">,</span><span>
</span><span id="line-3045"></span><span>      </span><span class="hs-identifier">alr_justClosedExplicitLetBlock</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">,</span><span>
</span><span id="line-3046"></span><span>      </span><span class="hs-identifier">eof_pos</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">,</span><span>
</span><span id="line-3047"></span><span>      </span><span class="hs-identifier">header_comments</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">,</span><span>
</span><span id="line-3048"></span><span>      </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3049"></span><span>      </span><span class="hs-identifier">hdk_comments</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nilOL</span><span>
</span><span id="line-3050"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-3051"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">init_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsLoc</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">BufPos</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-3052"></span><span>
</span><span id="line-3053"></span><span class="hs-comment">-- | An mtl-style class for monads that support parsing-related operations.</span><span>
</span><span id="line-3054"></span><span class="hs-comment">-- For example, sometimes we make a second pass over the parsing results to validate,</span><span>
</span><span id="line-3055"></span><span class="hs-comment">-- disambiguate, or rearrange them, and we do so in the PV monad which cannot consume</span><span>
</span><span id="line-3056"></span><span class="hs-comment">-- input but can report parsing errors, check for extension bits, and accumulate</span><span>
</span><span id="line-3057"></span><span class="hs-comment">-- parsing annotations. Both P and PV are instances of MonadP.</span><span>
</span><span id="line-3058"></span><span class="hs-comment">--</span><span>
</span><span id="line-3059"></span><span class="hs-comment">-- MonadP grants us convenient overloading. The other option is to have separate operations</span><span>
</span><span id="line-3060"></span><span class="hs-comment">-- for each monad: addErrorP vs addErrorPV, getBitP vs getBitPV, and so on.</span><span>
</span><span id="line-3061"></span><span class="hs-comment">--</span><span>
</span><span id="line-3062"></span><span class="hs-keyword">class</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadP</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3063"></span><span>  </span><span class="hs-comment">-- | Add a non-fatal error. Use this when the parser can produce a result</span><span>
</span><span id="line-3064"></span><span>  </span><span class="hs-comment">--   despite the error.</span><span>
</span><span id="line-3065"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3066"></span><span>  </span><span class="hs-comment">--   For example, when GHC encounters a @forall@ in a type,</span><span>
</span><span id="line-3067"></span><span>  </span><span class="hs-comment">--   but @-XExplicitForAll@ is disabled, the parser constructs @ForAllTy@</span><span>
</span><span id="line-3068"></span><span>  </span><span class="hs-comment">--   as if @-XExplicitForAll@ was enabled, adding a non-fatal error to</span><span>
</span><span id="line-3069"></span><span>  </span><span class="hs-comment">--   the accumulator.</span><span>
</span><span id="line-3070"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3071"></span><span>  </span><span class="hs-comment">--   Control flow wise, non-fatal errors act like warnings: they are added</span><span>
</span><span id="line-3072"></span><span>  </span><span class="hs-comment">--   to the accumulator and parsing continues. This allows GHC to report</span><span>
</span><span id="line-3073"></span><span>  </span><span class="hs-comment">--   more than one parse error per file.</span><span>
</span><span id="line-3074"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3075"></span><span>  </span><span class="hs-identifier">addError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">MsgEnvelope</span><span> </span><span class="hs-identifier">PsMessage</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3076"></span><span>
</span><span id="line-3077"></span><span>  </span><span class="hs-comment">-- | Add a warning to the accumulator.</span><span>
</span><span id="line-3078"></span><span>  </span><span class="hs-comment">--   Use 'getPsMessages' to get the accumulated warnings.</span><span>
</span><span id="line-3079"></span><span>  </span><span class="hs-identifier">addWarning</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">MsgEnvelope</span><span> </span><span class="hs-identifier">PsMessage</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3080"></span><span>
</span><span id="line-3081"></span><span>  </span><span class="hs-comment">-- | Add a fatal error. This will be the last error reported by the parser, and</span><span>
</span><span id="line-3082"></span><span>  </span><span class="hs-comment">--   the parser will not produce any result, ending in a 'PFailed' state.</span><span>
</span><span id="line-3083"></span><span>  </span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">MsgEnvelope</span><span> </span><span class="hs-identifier">PsMessage</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-3084"></span><span>
</span><span id="line-3085"></span><span>  </span><span class="hs-comment">-- | Check if a given flag is currently set in the bitmap.</span><span>
</span><span id="line-3086"></span><span>  </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ExtBits</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-3087"></span><span>  </span><span class="hs-comment">-- | Go through the @comment_q@ in @PState@ and remove all comments</span><span>
</span><span id="line-3088"></span><span>  </span><span class="hs-comment">-- that belong within the given span</span><span>
</span><span id="line-3089"></span><span>  </span><span class="hs-identifier">allocateCommentsP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">EpAnnComments</span><span>
</span><span id="line-3090"></span><span>  </span><span class="hs-comment">-- | Go through the @comment_q@ in @PState@ and remove all comments</span><span>
</span><span id="line-3091"></span><span>  </span><span class="hs-comment">-- that come before or within the given span</span><span>
</span><span id="line-3092"></span><span>  </span><span class="hs-identifier">allocatePriorCommentsP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">EpAnnComments</span><span>
</span><span id="line-3093"></span><span>  </span><span class="hs-comment">-- | Go through the @comment_q@ in @PState@ and remove all comments</span><span>
</span><span id="line-3094"></span><span>  </span><span class="hs-comment">-- that come after the given span</span><span>
</span><span id="line-3095"></span><span>  </span><span class="hs-identifier">allocateFinalCommentsP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">EpAnnComments</span><span>
</span><span id="line-3096"></span><span>
</span><span id="line-3097"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">MonadP</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3098"></span><span>  </span><span class="hs-identifier">addError</span><span> </span><span class="hs-identifier">err</span><span>
</span><span id="line-3099"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">errors</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">err</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">addMessage</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">errors</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3100"></span><span>
</span><span id="line-3101"></span><span>  </span><span class="hs-comment">-- If the warning is meant to be suppressed, GHC will assign</span><span>
</span><span id="line-3102"></span><span>  </span><span class="hs-comment">-- a `SevIgnore` severity and the message will be discarded,</span><span>
</span><span id="line-3103"></span><span>  </span><span class="hs-comment">-- so we can simply add it no matter what.</span><span>
</span><span id="line-3104"></span><span>  </span><span class="hs-identifier">addWarning</span><span> </span><span class="hs-identifier">w</span><span>
</span><span id="line-3105"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">warnings</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">addMessage</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">warnings</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3106"></span><span>
</span><span id="line-3107"></span><span>  </span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-identifier">err</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3108"></span><span>    </span><span class="hs-identifier">addError</span><span> </span><span class="hs-identifier">err</span><span> </span><span class="hs-operator">&gt;&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">PFailed</span><span>
</span><span id="line-3109"></span><span>
</span><span id="line-3110"></span><span>  </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">ext</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">xtest</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">options</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-3111"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-3112"></span><span>  </span><span class="hs-identifier">allocateCommentsP</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3113"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">comment_q'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">allocateComments</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-3114"></span><span>      </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-3115"></span><span>         </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">comment_q'</span><span>
</span><span id="line-3116"></span><span>       </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaComments</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">)</span><span>
</span><span id="line-3117"></span><span>  </span><span class="hs-identifier">allocatePriorCommentsP</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3118"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">header_comments'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">comment_q'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">)</span><span>
</span><span id="line-3119"></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">allocatePriorComments</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">header_comments</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-3120"></span><span>      </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-3121"></span><span>         </span><span class="hs-identifier">header_comments</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">header_comments'</span><span class="hs-special">,</span><span>
</span><span id="line-3122"></span><span>         </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">comment_q'</span><span>
</span><span id="line-3123"></span><span>       </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaComments</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">)</span><span>
</span><span id="line-3124"></span><span>  </span><span class="hs-identifier">allocateFinalCommentsP</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3125"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">header_comments'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">comment_q'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">)</span><span>
</span><span id="line-3126"></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">allocateFinalComments</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">header_comments</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-3127"></span><span>      </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-3128"></span><span>         </span><span class="hs-identifier">header_comments</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">header_comments'</span><span class="hs-special">,</span><span>
</span><span id="line-3129"></span><span>         </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">comment_q'</span><span>
</span><span id="line-3130"></span><span>       </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaCommentsBalanced</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.fromMaybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">header_comments'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">)</span><span>
</span><span id="line-3131"></span><span>
</span><span id="line-3132"></span><span class="hs-identifier">getCommentsFor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadP</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">EpAnnComments</span><span>
</span><span id="line-3133"></span><span class="hs-identifier">getCommentsFor</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">allocateCommentsP</span><span> </span><span class="hs-identifier">l</span><span>
</span><span id="line-3134"></span><span class="hs-identifier">getCommentsFor</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">emptyComments</span><span>
</span><span id="line-3135"></span><span>
</span><span id="line-3136"></span><span class="hs-identifier">getPriorCommentsFor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadP</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">EpAnnComments</span><span>
</span><span id="line-3137"></span><span class="hs-identifier">getPriorCommentsFor</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">allocatePriorCommentsP</span><span> </span><span class="hs-identifier">l</span><span>
</span><span id="line-3138"></span><span class="hs-identifier">getPriorCommentsFor</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">emptyComments</span><span>
</span><span id="line-3139"></span><span>
</span><span id="line-3140"></span><span class="hs-identifier">getFinalCommentsFor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadP</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">EpAnnComments</span><span>
</span><span id="line-3141"></span><span class="hs-identifier">getFinalCommentsFor</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">allocateFinalCommentsP</span><span> </span><span class="hs-identifier">l</span><span>
</span><span id="line-3142"></span><span class="hs-identifier">getFinalCommentsFor</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">emptyComments</span><span>
</span><span id="line-3143"></span><span>
</span><span id="line-3144"></span><span class="hs-identifier">getEofPos</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.Pair</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3145"></span><span class="hs-identifier">getEofPos</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eof_pos</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pos</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pos</span><span>
</span><span id="line-3146"></span><span>
</span><span id="line-3147"></span><span class="hs-identifier">addPsMessage</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsMessage</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3148"></span><span class="hs-identifier">addPsMessage</span><span> </span><span class="hs-identifier">srcspan</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3149"></span><span>  </span><span class="hs-identifier">diag_opts</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pDiagOpts</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">options</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">getPState</span><span>
</span><span id="line-3150"></span><span>  </span><span class="hs-identifier">addWarning</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPlainMsgEnvelope</span><span> </span><span class="hs-identifier">diag_opts</span><span> </span><span class="hs-identifier">srcspan</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span>
</span><span id="line-3151"></span><span>
</span><span id="line-3152"></span><span class="hs-identifier">addTabWarning</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3153"></span><span class="hs-identifier">addTabWarning</span><span> </span><span class="hs-identifier">srcspan</span><span>
</span><span id="line-3154"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span class="hs-identifier">tab_first</span><span class="hs-glyph">=</span><span class="hs-identifier">tf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tab_count</span><span class="hs-glyph">=</span><span class="hs-identifier">tc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">options</span><span class="hs-glyph">=</span><span class="hs-identifier">o</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3155"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">tf'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tf</span><span> </span><span class="hs-operator">&lt;|&gt;</span><span> </span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-identifier">srcspan</span><span>
</span><span id="line-3156"></span><span>           </span><span class="hs-identifier">tc'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tc</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-3157"></span><span>           </span><span class="hs-identifier">s'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">warnopt</span><span> </span><span class="hs-identifier">Opt_WarnTabs</span><span> </span><span class="hs-identifier">o</span><span>
</span><span id="line-3158"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span class="hs-identifier">tab_first</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tf'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tab_count</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tc'</span><span class="hs-special">}</span><span>
</span><span id="line-3159"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-3160"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s'</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3161"></span><span>
</span><span id="line-3162"></span><span class="hs-comment">-- | Get a bag of the errors that have been accumulated so far.</span><span>
</span><span id="line-3163"></span><span class="hs-comment">--   Does not take -Werror into account.</span><span>
</span><span id="line-3164"></span><span class="hs-identifier">getPsErrorMessages</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PState</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Messages</span><span> </span><span class="hs-identifier">PsMessage</span><span>
</span><span id="line-3165"></span><span class="hs-identifier">getPsErrorMessages</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">errors</span><span> </span><span class="hs-identifier">p</span><span>
</span><span id="line-3166"></span><span>
</span><span id="line-3167"></span><span class="hs-comment">-- | Get the warnings and errors accumulated so far.</span><span>
</span><span id="line-3168"></span><span class="hs-comment">--   Does not take -Werror into account.</span><span>
</span><span id="line-3169"></span><span class="hs-identifier">getPsMessages</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PState</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Messages</span><span> </span><span class="hs-identifier">PsMessage</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Messages</span><span> </span><span class="hs-identifier">PsMessage</span><span class="hs-special">)</span><span>
</span><span id="line-3170"></span><span class="hs-identifier">getPsMessages</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3171"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">ws</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">warnings</span><span> </span><span class="hs-identifier">p</span><span>
</span><span id="line-3172"></span><span>      </span><span class="hs-identifier">diag_opts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pDiagOpts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">options</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><span id="line-3173"></span><span>      </span><span class="hs-comment">-- we add the tabulation warning on the fly because</span><span>
</span><span id="line-3174"></span><span>      </span><span class="hs-comment">-- we count the number of occurrences of tab characters</span><span>
</span><span id="line-3175"></span><span>      </span><span class="hs-identifier">ws'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">tab_first</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3176"></span><span>        </span><span class="hs-identifier">Strict.Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ws</span><span>
</span><span id="line-3177"></span><span>        </span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-identifier">tf</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3178"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPlainMsgEnvelope</span><span> </span><span class="hs-identifier">diag_opts</span><span>
</span><span id="line-3179"></span><span>                          </span><span class="hs-special">(</span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-identifier">tf</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">)</span><span>
</span><span id="line-3180"></span><span>                          </span><span class="hs-special">(</span><span class="hs-identifier">PsWarnTab</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tab_count</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3181"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">addMessage</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">ws</span><span>
</span><span id="line-3182"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ws'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">errors</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><span id="line-3183"></span><span>
</span><span id="line-3184"></span><span class="hs-identifier">getContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LayoutContext</span><span class="hs-special">]</span><span>
</span><span id="line-3185"></span><span class="hs-identifier">getContext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span class="hs-identifier">context</span><span class="hs-glyph">=</span><span class="hs-identifier">ctx</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">ctx</span><span>
</span><span id="line-3186"></span><span>
</span><span id="line-3187"></span><span class="hs-identifier">setContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LayoutContext</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3188"></span><span class="hs-identifier">setContext</span><span> </span><span class="hs-identifier">ctx</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span class="hs-identifier">context</span><span class="hs-glyph">=</span><span class="hs-identifier">ctx</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3189"></span><span>
</span><span id="line-3190"></span><span class="hs-identifier">popContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3191"></span><span class="hs-identifier">popContext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">buffer</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">o</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">context</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ctx</span><span class="hs-special">,</span><span>
</span><span id="line-3192"></span><span>                              </span><span class="hs-identifier">last_len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3193"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ctx</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3194"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">tl</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3195"></span><span>          </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">context</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tl</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3196"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3197"></span><span>          </span><span class="hs-identifier">unP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">srcParseErr</span><span> </span><span class="hs-identifier">o</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-identifier">last_loc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-3198"></span><span>
</span><span id="line-3199"></span><span class="hs-comment">-- Push a new layout context at the indentation of the last token read.</span><span>
</span><span id="line-3200"></span><span class="hs-identifier">pushCurrentContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">GenSemic</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3201"></span><span class="hs-identifier">pushCurrentContext</span><span> </span><span class="hs-identifier">gen_semic</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">last_loc</span><span class="hs-glyph">=</span><span class="hs-identifier">loc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">context</span><span class="hs-glyph">=</span><span class="hs-identifier">ctx</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3202"></span><span>    </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">{</span><span class="hs-identifier">context</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Layout</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">srcSpanStartCol</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">gen_semic</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ctx</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3203"></span><span>
</span><span id="line-3204"></span><span class="hs-comment">-- This is only used at the outer level of a module when the 'module' keyword is</span><span>
</span><span id="line-3205"></span><span class="hs-comment">-- missing.</span><span>
</span><span id="line-3206"></span><span class="hs-identifier">pushModuleContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3207"></span><span class="hs-identifier">pushModuleContext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pushCurrentContext</span><span> </span><span class="hs-identifier">generateSemic</span><span>
</span><span id="line-3208"></span><span>
</span><span id="line-3209"></span><span class="hs-identifier">getOffside</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ordering</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span>
</span><span id="line-3210"></span><span class="hs-identifier">getOffside</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span class="hs-identifier">last_loc</span><span class="hs-glyph">=</span><span class="hs-identifier">loc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">context</span><span class="hs-glyph">=</span><span class="hs-identifier">stk</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3211"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">offs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanStartCol</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-3212"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">ord</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">stk</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3213"></span><span>                            </span><span class="hs-identifier">Layout</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">gen_semic</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3214"></span><span>                              </span><span class="hs-comment">--trace (&quot;layout: &quot; ++ show n ++ &quot;, offs: &quot; ++ show offs) $</span><span>
</span><span id="line-3215"></span><span>                              </span><span class="hs-special">(</span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">offs</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gen_semic</span><span class="hs-special">)</span><span>
</span><span id="line-3216"></span><span>                            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3217"></span><span>                              </span><span class="hs-special">(</span><span class="hs-identifier">GT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dontGenerateSemic</span><span class="hs-special">)</span><span>
</span><span id="line-3218"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">ord</span><span>
</span><span id="line-3219"></span><span>
</span><span id="line-3220"></span><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><span id="line-3221"></span><span class="hs-comment">-- Construct a parse error</span><span>
</span><span id="line-3222"></span><span>
</span><span id="line-3223"></span><span class="hs-identifier">srcParseErr</span><span>
</span><span id="line-3224"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ParserOpts</span><span>
</span><span id="line-3225"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span>       </span><span class="hs-comment">-- current buffer (placed just after the last token)</span><span>
</span><span id="line-3226"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>                </span><span class="hs-comment">-- length of the previous token</span><span>
</span><span id="line-3227"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">SrcSpan</span><span>
</span><span id="line-3228"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">MsgEnvelope</span><span> </span><span class="hs-identifier">PsMessage</span><span>
</span><span id="line-3229"></span><span class="hs-identifier">srcParseErr</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsErrParse</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">details</span><span class="hs-special">)</span><span>
</span><span id="line-3230"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3231"></span><span>   </span><span class="hs-identifier">token</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">offsetBytes</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-3232"></span><span>   </span><span class="hs-identifier">pattern_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">decodePrevNChars</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-3233"></span><span>   </span><span class="hs-identifier">last100</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">decodePrevNChars</span><span> </span><span class="hs-number">100</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-3234"></span><span>   </span><span class="hs-identifier">doInLast100</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;do&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">isInfixOf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">last100</span><span>
</span><span id="line-3235"></span><span>   </span><span class="hs-identifier">mdoInLast100</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;mdo&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">isInfixOf</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">last100</span><span>
</span><span id="line-3236"></span><span>   </span><span class="hs-identifier">th_enabled</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ThQuotesBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">xtest</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-identifier">options</span><span>
</span><span id="line-3237"></span><span>   </span><span class="hs-identifier">ps_enabled</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PatternSynonymsBit</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">xtest</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-identifier">options</span><span>
</span><span id="line-3238"></span><span>   </span><span class="hs-identifier">details</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PsErrParseDetails</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-3239"></span><span>       </span><span class="hs-identifier">ped_th_enabled</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">th_enabled</span><span>
</span><span id="line-3240"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ped_do_in_last_100</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">doInLast100</span><span>
</span><span id="line-3241"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ped_mdo_in_last_100</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mdoInLast100</span><span>
</span><span id="line-3242"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ped_pat_syn_enabled</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ps_enabled</span><span>
</span><span id="line-3243"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ped_pattern_parsed</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pattern_</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-string">&quot;pattern &quot;</span><span>
</span><span id="line-3244"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-3245"></span><span>
</span><span id="line-3246"></span><span class="hs-comment">-- Report a parse failure, giving the span of the previous token as</span><span>
</span><span id="line-3247"></span><span class="hs-comment">-- the location of the error.  This is the entry point for errors</span><span>
</span><span id="line-3248"></span><span class="hs-comment">-- detected during parsing.</span><span>
</span><span id="line-3249"></span><span class="hs-identifier">srcParseFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-3250"></span><span class="hs-identifier">srcParseFail</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span class="hs-glyph">@</span><span class="hs-identifier">PState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">buffer</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">o</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">last_len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">,</span><span>
</span><span id="line-3251"></span><span>                            </span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">last_loc</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3252"></span><span>    </span><span class="hs-identifier">unP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">addFatalError</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">srcParseErr</span><span> </span><span class="hs-identifier">o</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-identifier">last_loc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-3253"></span><span>
</span><span id="line-3254"></span><span class="hs-comment">-- A lexical error is reported at a particular position in the source file,</span><span>
</span><span id="line-3255"></span><span class="hs-comment">-- not over a token range.</span><span>
</span><span id="line-3256"></span><span class="hs-identifier">lexError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">LexErr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-3257"></span><span class="hs-identifier">lexError</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3258"></span><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getRealSrcLoc</span><span>
</span><span id="line-3259"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-3260"></span><span>  </span><span class="hs-identifier">reportLexError</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-3261"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">PsErrLexer</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>
</span><span id="line-3262"></span><span>
</span><span id="line-3263"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3264"></span><span class="hs-comment">-- This is the top-level function: called from the parser each time a</span><span>
</span><span id="line-3265"></span><span class="hs-comment">-- new token is to be read from the input.</span><span>
</span><span id="line-3266"></span><span>
</span><span id="line-3267"></span><span class="hs-identifier">lexer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lexerDbg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Located</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-3268"></span><span>
</span><span id="line-3269"></span><span class="hs-identifier">lexer</span><span> </span><span class="hs-identifier">queueComments</span><span> </span><span class="hs-identifier">cont</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3270"></span><span>  </span><span class="hs-identifier">alr</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">AlternativeLayoutRuleBit</span><span>
</span><span id="line-3271"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lexTokenFun</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">alr</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">lexTokenAlr</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-3272"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lexTokenFun</span><span>
</span><span id="line-3273"></span><span>  </span><span class="hs-comment">--trace (&quot;token: &quot; ++ show tok) $ do</span><span>
</span><span id="line-3274"></span><span>
</span><span id="line-3275"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">queueComments</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">isComment</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span>
</span><span id="line-3276"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">queueComment</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&gt;&gt;</span><span> </span><span class="hs-identifier">lexer</span><span> </span><span class="hs-identifier">queueComments</span><span> </span><span class="hs-identifier">cont</span><span>
</span><span id="line-3277"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">cont</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span>
</span><span id="line-3278"></span><span>
</span><span id="line-3279"></span><span class="hs-comment">-- Use this instead of 'lexer' in GHC.Parser to dump the tokens for debugging.</span><span>
</span><span id="line-3280"></span><span class="hs-identifier">lexerDbg</span><span> </span><span class="hs-identifier">queueComments</span><span> </span><span class="hs-identifier">cont</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexer</span><span> </span><span class="hs-identifier">queueComments</span><span> </span><span class="hs-identifier">contDbg</span><span>
</span><span id="line-3281"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3282"></span><span>    </span><span class="hs-identifier">contDbg</span><span> </span><span class="hs-identifier">tok</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">trace</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;token: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cont</span><span> </span><span class="hs-identifier">tok</span><span class="hs-special">)</span><span>
</span><span id="line-3283"></span><span>
</span><span id="line-3284"></span><span class="hs-identifier">lexTokenAlr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-3285"></span><span class="hs-identifier">lexTokenAlr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">mPending</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popPendingImplicitToken</span><span>
</span><span id="line-3286"></span><span>                 </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">mPending</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3287"></span><span>                      </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3288"></span><span>                          </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">mNext</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">popNextToken</span><span>
</span><span id="line-3289"></span><span>                             </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">mNext</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3290"></span><span>                                  </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-3291"></span><span>                                  </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">next</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">next</span><span>
</span><span id="line-3292"></span><span>                             </span><span class="hs-identifier">alternativeLayoutRuleToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3293"></span><span>                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3294"></span><span>                          </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3295"></span><span>                 </span><span class="hs-identifier">setAlrLastLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getLoc</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><span id="line-3296"></span><span>                 </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3297"></span><span>                     </span><span class="hs-identifier">ITwhere</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ALRLayoutWhere</span><span class="hs-special">)</span><span>
</span><span id="line-3298"></span><span>                     </span><span class="hs-identifier">ITlet</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ALRLayoutLet</span><span class="hs-special">)</span><span>
</span><span id="line-3299"></span><span>                     </span><span class="hs-identifier">ITof</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ALRLayoutOf</span><span class="hs-special">)</span><span>
</span><span id="line-3300"></span><span>                     </span><span class="hs-identifier">ITlcase</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ALRLayoutOf</span><span class="hs-special">)</span><span>
</span><span id="line-3301"></span><span>                     </span><span class="hs-identifier">ITlcases</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ALRLayoutOf</span><span class="hs-special">)</span><span>
</span><span id="line-3302"></span><span>                     </span><span class="hs-identifier">ITdo</span><span>  </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ALRLayoutDo</span><span class="hs-special">)</span><span>
</span><span id="line-3303"></span><span>                     </span><span class="hs-identifier">ITmdo</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ALRLayoutDo</span><span class="hs-special">)</span><span>
</span><span id="line-3304"></span><span>                     </span><span class="hs-identifier">ITrec</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ALRLayoutDo</span><span class="hs-special">)</span><span>
</span><span id="line-3305"></span><span>                     </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3306"></span><span>                 </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3307"></span><span>
</span><span id="line-3308"></span><span class="hs-identifier">alternativeLayoutRuleToken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-3309"></span><span class="hs-identifier">alternativeLayoutRuleToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3310"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">context</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getALRContext</span><span>
</span><span id="line-3311"></span><span>         </span><span class="hs-identifier">lastLoc</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getAlrLastLoc</span><span>
</span><span id="line-3312"></span><span>         </span><span class="hs-identifier">mExpectingOCurly</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getAlrExpectingOCurly</span><span>
</span><span id="line-3313"></span><span>         </span><span class="hs-identifier">transitional</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getBit</span><span> </span><span class="hs-identifier">ALRTransitionalBit</span><span>
</span><span id="line-3314"></span><span>         </span><span class="hs-identifier">justClosedExplicitLetBlock</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getJustClosedExplicitLetBlock</span><span>
</span><span id="line-3315"></span><span>         </span><span class="hs-identifier">setJustClosedExplicitLetBlock</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-3316"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">getLoc</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3317"></span><span>             </span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanStartCol</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">thisLoc</span><span class="hs-special">)</span><span>
</span><span id="line-3318"></span><span>             </span><span class="hs-identifier">newLine</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanStartLine</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">thisLoc</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">srcSpanEndLine</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">lastLoc</span><span class="hs-special">)</span><span>
</span><span id="line-3319"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">context</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mExpectingOCurly</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3320"></span><span>             </span><span class="hs-comment">-- This case handles a GHC extension to the original H98</span><span>
</span><span id="line-3321"></span><span>             </span><span class="hs-comment">-- layout rule...</span><span>
</span><span id="line-3322"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITocurly</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">alrLayout</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3323"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-3324"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">isLet</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alrLayout</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3325"></span><span>                                </span><span class="hs-identifier">ALRLayoutLet</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3326"></span><span>                                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-3327"></span><span>                    </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ALRNoLayout</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">ITocurly</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">isLet</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">context</span><span class="hs-special">)</span><span>
</span><span id="line-3328"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3329"></span><span>             </span><span class="hs-comment">-- ...and makes this case unnecessary</span><span>
</span><span id="line-3330"></span><span>             </span><span class="hs-comment">{-
             -- I think our implicit open-curly handling is slightly
             -- different to John's, in how it interacts with newlines
             -- and &quot;in&quot;
             (ITocurly, _, Just _) -&gt;
                 do setAlrExpectingOCurly Nothing
                    setNextToken t
                    lexTokenAlr
             -}</span><span>
</span><span id="line-3339"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">expectingOCurly</span><span class="hs-special">)</span><span>
</span><span id="line-3340"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">col</span><span class="hs-special">)</span><span> </span><span class="hs-operator">||</span><span>
</span><span id="line-3341"></span><span>                </span><span class="hs-special">(</span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-operator">&amp;&amp;</span><span>
</span><span id="line-3342"></span><span>                 </span><span class="hs-identifier">isNonDecreasingIndentation</span><span> </span><span class="hs-identifier">expectingOCurly</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3343"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-3344"></span><span>                    </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">expectingOCurly</span><span> </span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">context</span><span class="hs-special">)</span><span>
</span><span id="line-3345"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3346"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvocurly</span><span class="hs-special">)</span><span>
</span><span id="line-3347"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3348"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-3349"></span><span>                    </span><span class="hs-identifier">setPendingImplicitTokens</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">lastLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">]</span><span>
</span><span id="line-3350"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3351"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">lastLoc</span><span> </span><span class="hs-identifier">ITvocurly</span><span class="hs-special">)</span><span>
</span><span id="line-3352"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">expectingOCurly</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3353"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setAlrExpectingOCurly</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-3354"></span><span>                    </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">expectingOCurly</span><span> </span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">context</span><span class="hs-special">)</span><span>
</span><span id="line-3355"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3356"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvocurly</span><span class="hs-special">)</span><span>
</span><span id="line-3357"></span><span>             </span><span class="hs-comment">-- We do the [] cases earlier than in the spec, as we</span><span>
</span><span id="line-3358"></span><span>             </span><span class="hs-comment">-- have an actual EOF token</span><span>
</span><span id="line-3359"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITeof</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3360"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3361"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3362"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3363"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITeof</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3364"></span><span>                 </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3365"></span><span>             </span><span class="hs-comment">-- the other ITeof case omitted; general case below covers it</span><span>
</span><span id="line-3366"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITin</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-3367"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">justClosedExplicitLetBlock</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3368"></span><span>                 </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3369"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITin</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">ALRLayoutLet</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-3370"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">newLine</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3371"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setPendingImplicitTokens</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t</span><span class="hs-special">]</span><span>
</span><span id="line-3372"></span><span>                    </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3373"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3374"></span><span>             </span><span class="hs-comment">-- This next case is to handle a transitional issue:</span><span>
</span><span id="line-3375"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITwhere</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-3376"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">newLine</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">transitional</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3377"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">addPsMessage</span><span>
</span><span id="line-3378"></span><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-identifier">thisLoc</span><span class="hs-special">)</span><span>
</span><span id="line-3379"></span><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">PsWarnTransitionalLayout</span><span> </span><span class="hs-identifier">TransLayout_Where</span><span class="hs-special">)</span><span>
</span><span id="line-3380"></span><span>                    </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3381"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3382"></span><span>                    </span><span class="hs-comment">-- Note that we use lastLoc, as we may need to close</span><span>
</span><span id="line-3383"></span><span>                    </span><span class="hs-comment">-- more layouts, or give a semicolon</span><span>
</span><span id="line-3384"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">lastLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3385"></span><span>             </span><span class="hs-comment">-- This next case is to handle a transitional issue:</span><span>
</span><span id="line-3386"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITvbar</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-3387"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">newLine</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">transitional</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3388"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">addPsMessage</span><span>
</span><span id="line-3389"></span><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">mkSrcSpanPs</span><span> </span><span class="hs-identifier">thisLoc</span><span class="hs-special">)</span><span>
</span><span id="line-3390"></span><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">PsWarnTransitionalLayout</span><span> </span><span class="hs-identifier">TransLayout_Pipe</span><span class="hs-special">)</span><span>
</span><span id="line-3391"></span><span>                    </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3392"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3393"></span><span>                    </span><span class="hs-comment">-- Note that we use lastLoc, as we may need to close</span><span>
</span><span id="line-3394"></span><span>                    </span><span class="hs-comment">-- more layouts, or give a semicolon</span><span>
</span><span id="line-3395"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">lastLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3396"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-3397"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">newLine</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3398"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3399"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">psSpanStart</span><span> </span><span class="hs-identifier">thisLoc</span><span>
</span><span id="line-3400"></span><span>                        </span><span class="hs-identifier">zeroWidthLoc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">loc</span><span>
</span><span id="line-3401"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">zeroWidthLoc</span><span> </span><span class="hs-identifier">ITsemi</span><span class="hs-special">)</span><span>
</span><span id="line-3402"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">newLine</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">thisCol</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3403"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3404"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3405"></span><span>                    </span><span class="hs-comment">-- Note that we use lastLoc, as we may need to close</span><span>
</span><span id="line-3406"></span><span>                    </span><span class="hs-comment">-- more layouts, or give a semicolon</span><span>
</span><span id="line-3407"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">lastLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3408"></span><span>             </span><span class="hs-comment">-- We need to handle close before open, as 'then' is both</span><span>
</span><span id="line-3409"></span><span>             </span><span class="hs-comment">-- an open and a close</span><span>
</span><span id="line-3410"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">u</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-3411"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">u</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3412"></span><span>                 </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">context</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3413"></span><span>                 </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3414"></span><span>                     </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3415"></span><span>                        </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3416"></span><span>                        </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3417"></span><span>                 </span><span class="hs-identifier">ALRNoLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">isLet</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3418"></span><span>                     </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">ls'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">u</span><span>
</span><span id="line-3419"></span><span>                                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">ALRNoLayout</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">u</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3420"></span><span>                                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3421"></span><span>                        </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls'</span><span>
</span><span id="line-3422"></span><span>                        </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">isLet</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">setJustClosedExplicitLetBlock</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3423"></span><span>                        </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3424"></span><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3425"></span><span>                     </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">ls</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">u</span><span>
</span><span id="line-3426"></span><span>                                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">ALRNoLayout</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">u</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">]</span><span>
</span><span id="line-3427"></span><span>                                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3428"></span><span>                        </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3429"></span><span>                        </span><span class="hs-comment">-- XXX This is an error in John's code, but</span><span>
</span><span id="line-3430"></span><span>                        </span><span class="hs-comment">-- it looks reachable to me at first glance</span><span>
</span><span id="line-3431"></span><span>                        </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3432"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">u</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-3433"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">u</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3434"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ALRNoLayout</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">u</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">context</span><span class="hs-special">)</span><span>
</span><span id="line-3435"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3436"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITin</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">ALRLayoutLet</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3437"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3438"></span><span>                    </span><span class="hs-identifier">setPendingImplicitTokens</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t</span><span class="hs-special">]</span><span>
</span><span id="line-3439"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3440"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITin</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3441"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3442"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3443"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3444"></span><span>             </span><span class="hs-comment">-- the other ITin case omitted; general case below covers it</span><span>
</span><span id="line-3445"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITcomma</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-3446"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">topNoLayoutContainsCommas</span><span> </span><span class="hs-identifier">ls</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3447"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3448"></span><span>                    </span><span class="hs-identifier">setNextToken</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3449"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3450"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">ITwhere</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">ALRLayoutDo</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3451"></span><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">setALRContext</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3452"></span><span>                    </span><span class="hs-identifier">setPendingImplicitTokens</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t</span><span class="hs-special">]</span><span>
</span><span id="line-3453"></span><span>                    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">thisLoc</span><span> </span><span class="hs-identifier">ITvccurly</span><span class="hs-special">)</span><span>
</span><span id="line-3454"></span><span>             </span><span class="hs-comment">-- the other ITwhere case omitted; general case below covers it</span><span>
</span><span id="line-3455"></span><span>             </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-3456"></span><span>
</span><span id="line-3457"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-3458"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">ITcase</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3459"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">ITif</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3460"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">ITthen</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3461"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">IToparen</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3462"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">ITobrack</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3463"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">ITocurly</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3464"></span><span class="hs-comment">-- GHC Extensions:</span><span>
</span><span id="line-3465"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">IToubxparen</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3466"></span><span class="hs-identifier">isALRopen</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-3467"></span><span>
</span><span id="line-3468"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-3469"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">ITof</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3470"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">ITthen</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3471"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">ITelse</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3472"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">ITcparen</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3473"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">ITcbrack</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3474"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">ITccurly</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3475"></span><span class="hs-comment">-- GHC Extensions:</span><span>
</span><span id="line-3476"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">ITcubxparen</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3477"></span><span class="hs-identifier">isALRclose</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-3478"></span><span>
</span><span id="line-3479"></span><span class="hs-identifier">isNonDecreasingIndentation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-3480"></span><span class="hs-identifier">isNonDecreasingIndentation</span><span> </span><span class="hs-identifier">ALRLayoutDo</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3481"></span><span class="hs-identifier">isNonDecreasingIndentation</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-3482"></span><span>
</span><span id="line-3483"></span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-3484"></span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">IToparen</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3485"></span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">ITobrack</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3486"></span><span class="hs-comment">-- John doesn't have {} as containing commas, but records contain them,</span><span>
</span><span id="line-3487"></span><span class="hs-comment">-- which caused a problem parsing Cabal's Distribution.Simple.InstallDirs</span><span>
</span><span id="line-3488"></span><span class="hs-comment">-- (defaultInstallDirs).</span><span>
</span><span id="line-3489"></span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">ITocurly</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3490"></span><span class="hs-comment">-- GHC Extensions:</span><span>
</span><span id="line-3491"></span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">IToubxparen</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3492"></span><span class="hs-identifier">containsCommas</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-3493"></span><span>
</span><span id="line-3494"></span><span class="hs-identifier">topNoLayoutContainsCommas</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">ALRContext</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-3495"></span><span class="hs-identifier">topNoLayoutContainsCommas</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-3496"></span><span class="hs-identifier">topNoLayoutContainsCommas</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ALRLayout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">topNoLayoutContainsCommas</span><span> </span><span class="hs-identifier">ls</span><span>
</span><span id="line-3497"></span><span class="hs-identifier">topNoLayoutContainsCommas</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ALRNoLayout</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-3498"></span><span>
</span><span id="line-3499"></span><span class="hs-identifier">lexToken</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PsLocated</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">)</span><span>
</span><span id="line-3500"></span><span class="hs-identifier">lexToken</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3501"></span><span>  </span><span class="hs-identifier">inp</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc1</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getInput</span><span>
</span><span id="line-3502"></span><span>  </span><span class="hs-identifier">sc</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLexState</span><span>
</span><span id="line-3503"></span><span>  </span><span class="hs-identifier">exts</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getExts</span><span>
</span><span id="line-3504"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexScanUser</span><span> </span><span class="hs-identifier">exts</span><span> </span><span class="hs-identifier">inp</span><span> </span><span class="hs-identifier">sc</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3505"></span><span>    </span><span class="hs-identifier">AlexEOF</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3506"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc1</span><span> </span><span class="hs-identifier">loc1</span><span>
</span><span id="line-3507"></span><span>        </span><span class="hs-identifier">lt</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getLastLocEof</span><span>
</span><span id="line-3508"></span><span>        </span><span class="hs-identifier">setEofPos</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">lt</span><span class="hs-special">)</span><span>
</span><span id="line-3509"></span><span>        </span><span class="hs-identifier">setLastToken</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-3510"></span><span>        </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">ITeof</span><span class="hs-special">)</span><span>
</span><span id="line-3511"></span><span>    </span><span class="hs-identifier">AlexError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">loc2</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3512"></span><span>        </span><span class="hs-identifier">reportLexError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">loc1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealLoc</span><span> </span><span class="hs-identifier">loc2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">buf</span><span>
</span><span id="line-3513"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mkPlainErrorMsgEnvelope</span><span> </span><span class="hs-identifier">srcLoc</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">PsErrLexer</span><span> </span><span class="hs-identifier">LexError</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>
</span><span id="line-3514"></span><span>    </span><span class="hs-identifier">AlexSkip</span><span> </span><span class="hs-identifier">inp2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3515"></span><span>        </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">inp2</span><span>
</span><span id="line-3516"></span><span>        </span><span class="hs-identifier">lexToken</span><span>
</span><span id="line-3517"></span><span>    </span><span class="hs-identifier">AlexToken</span><span> </span><span class="hs-identifier">inp2</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">buf2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3518"></span><span>        </span><span class="hs-identifier">setInput</span><span> </span><span class="hs-identifier">inp2</span><span>
</span><span id="line-3519"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkPsSpan</span><span> </span><span class="hs-identifier">loc1</span><span> </span><span class="hs-identifier">end</span><span>
</span><span id="line-3520"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">bytes</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">byteDiff</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-3521"></span><span>        </span><span class="hs-identifier">span</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">setLastToken</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">bytes</span><span>
</span><span id="line-3522"></span><span>        </span><span class="hs-identifier">lt</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">bytes</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-3523"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lt'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-identifier">lt</span><span>
</span><span id="line-3524"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isComment</span><span> </span><span class="hs-identifier">lt'</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">setLastComment</span><span> </span><span class="hs-identifier">lt</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">setLastTk</span><span> </span><span class="hs-identifier">lt</span><span>
</span><span id="line-3525"></span><span>        </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">lt</span><span>
</span><span id="line-3526"></span><span>
</span><span id="line-3527"></span><span class="hs-identifier">reportLexError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span>
</span><span id="line-3528"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span>
</span><span id="line-3529"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span>
</span><span id="line-3530"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LexErrKind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">MsgEnvelope</span><span> </span><span class="hs-identifier">PsMessage</span><span class="hs-special">)</span><span>
</span><span id="line-3531"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-3532"></span><span class="hs-identifier">reportLexError</span><span> </span><span class="hs-identifier">loc1</span><span> </span><span class="hs-identifier">loc2</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">f</span><span>
</span><span id="line-3533"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">atEnd</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">failLocMsgP</span><span> </span><span class="hs-identifier">loc1</span><span> </span><span class="hs-identifier">loc2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">LexErrKind_EOF</span><span class="hs-special">)</span><span>
</span><span id="line-3534"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3535"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fst</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nextChar</span><span> </span><span class="hs-identifier">buf</span><span class="hs-special">)</span><span>
</span><span id="line-3536"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-char">'\0'</span><span> </span><span class="hs-comment">-- decoding errors are mapped to '\0', see utf8DecodeChar#</span><span>
</span><span id="line-3537"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">failLocMsgP</span><span> </span><span class="hs-identifier">loc2</span><span> </span><span class="hs-identifier">loc2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">LexErrKind_UTF8</span><span class="hs-special">)</span><span>
</span><span id="line-3538"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">failLocMsgP</span><span> </span><span class="hs-identifier">loc1</span><span> </span><span class="hs-identifier">loc2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LexErrKind_Char</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3539"></span><span>
</span><span id="line-3540"></span><span class="hs-identifier">lexTokenStream</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ParserOpts</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StringBuffer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RealSrcLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ParseResult</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Located</span><span> </span><span class="hs-identifier">Token</span><span class="hs-special">]</span><span>
</span><span id="line-3541"></span><span class="hs-identifier">lexTokenStream</span><span> </span><span class="hs-identifier">opts</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unP</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">initState</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">options</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">opts'</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3542"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-3543"></span><span>    </span><span class="hs-identifier">new_exts</span><span>  </span><span class="hs-glyph">=</span><span>   </span><span class="hs-identifier">xunset</span><span> </span><span class="hs-identifier">UsePosPragsBit</span><span>  </span><span class="hs-comment">-- parse LINE/COLUMN pragmas as tokens</span><span>
</span><span id="line-3544"></span><span>                </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">xset</span><span> </span><span class="hs-identifier">RawTokenStreamBit</span><span> </span><span class="hs-comment">-- include comments</span><span>
</span><span id="line-3545"></span><span>                </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-identifier">opts</span><span>
</span><span id="line-3546"></span><span>    </span><span class="hs-identifier">opts'</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">opts</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pExtsBitmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">new_exts</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3547"></span><span>    </span><span class="hs-identifier">initState</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">initParserState</span><span> </span><span class="hs-identifier">opts'</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">loc</span><span>
</span><span id="line-3548"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3549"></span><span>      </span><span class="hs-identifier">ltok</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lexer</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-identifier">return</span><span>
</span><span id="line-3550"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ltok</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3551"></span><span>        </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ITeof</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3552"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">liftM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ltok</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">go</span><span>
</span><span id="line-3553"></span><span>
</span><span id="line-3554"></span><span class="hs-identifier">linePrags</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Map.singleton</span><span> </span><span class="hs-string">&quot;line&quot;</span><span> </span><span class="hs-identifier">linePrag</span><span>
</span><span id="line-3555"></span><span>
</span><span id="line-3556"></span><span class="hs-identifier">fileHeaderPrags</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Map.fromList</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;options&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lex_string_prag</span><span> </span><span class="hs-identifier">IToptions_prag</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3557"></span><span>                                 </span><span class="hs-special">(</span><span class="hs-string">&quot;options_ghc&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lex_string_prag</span><span> </span><span class="hs-identifier">IToptions_prag</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3558"></span><span>                                 </span><span class="hs-special">(</span><span class="hs-string">&quot;options_haddock&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lex_string_prag_comment</span><span> </span><span class="hs-identifier">ITdocOptions</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3559"></span><span>                                 </span><span class="hs-special">(</span><span class="hs-string">&quot;language&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">ITlanguage_prag</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3560"></span><span>                                 </span><span class="hs-special">(</span><span class="hs-string">&quot;include&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lex_string_prag</span><span> </span><span class="hs-identifier">ITinclude_prag</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3561"></span><span>
</span><span id="line-3562"></span><span class="hs-identifier">ignoredPrags</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Map.fromList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">ignored</span><span> </span><span class="hs-identifier">pragmas</span><span class="hs-special">)</span><span>
</span><span id="line-3563"></span><span>               </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">ignored</span><span> </span><span class="hs-identifier">opt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">opt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">nested_comment</span><span class="hs-special">)</span><span>
</span><span id="line-3564"></span><span>                     </span><span class="hs-identifier">impls</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;hugs&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;nhc98&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;jhc&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;yhc&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;catch&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;derive&quot;</span><span class="hs-special">]</span><span>
</span><span id="line-3565"></span><span>                     </span><span class="hs-identifier">options_pragmas</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;options_&quot;</span><span> </span><span class="hs-operator">++</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">impls</span><span>
</span><span id="line-3566"></span><span>                     </span><span class="hs-comment">-- CFILES is a hugs-only thing.</span><span>
</span><span id="line-3567"></span><span>                     </span><span class="hs-identifier">pragmas</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">options_pragmas</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;cfiles&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;contract&quot;</span><span class="hs-special">]</span><span>
</span><span id="line-3568"></span><span>
</span><span id="line-3569"></span><span class="hs-identifier">oneWordPrags</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Map.fromList</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3570"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;rules&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rulePrag</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3571"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;inline&quot;</span><span class="hs-special">,</span><span>
</span><span id="line-3572"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITinline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Inline</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">FunLike</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3573"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;inlinable&quot;</span><span class="hs-special">,</span><span>
</span><span id="line-3574"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITinline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Inlinable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">FunLike</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3575"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;inlineable&quot;</span><span class="hs-special">,</span><span>
</span><span id="line-3576"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITinline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Inlinable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">FunLike</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3577"></span><span>                                    </span><span class="hs-comment">-- Spelling variant</span><span>
</span><span id="line-3578"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;notinline&quot;</span><span class="hs-special">,</span><span>
</span><span id="line-3579"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITinline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NoInline</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">FunLike</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3580"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;opaque&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITopaque_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3581"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;specialize&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITspec_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3582"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;source&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITsource_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3583"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;warning&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITwarning_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3584"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;deprecated&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITdeprecated_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3585"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;scc&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITscc_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3586"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;unpack&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITunpack_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3587"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;nounpack&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITnounpack_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3588"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;ann&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITann_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3589"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;minimal&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITminimal_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3590"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;overlaps&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IToverlaps_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3591"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;overlappable&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IToverlappable_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3592"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;overlapping&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IToverlapping_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3593"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;incoherent&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITincoherent_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3594"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;ctype&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITctype</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3595"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;complete&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ITcomplete_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3596"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;column&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">columnPrag</span><span class="hs-special">)</span><span>
</span><span id="line-3597"></span><span>     </span><span class="hs-special">]</span><span>
</span><span id="line-3598"></span><span>
</span><span id="line-3599"></span><span class="hs-identifier">twoWordPrags</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Map.fromList</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3600"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;inline conlike&quot;</span><span class="hs-special">,</span><span>
</span><span id="line-3601"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITinline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Inline</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ConLike</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3602"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;notinline conlike&quot;</span><span class="hs-special">,</span><span>
</span><span id="line-3603"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITinline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NoInline</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ConLike</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3604"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;specialize inline&quot;</span><span class="hs-special">,</span><span>
</span><span id="line-3605"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITspec_inline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3606"></span><span>     </span><span class="hs-special">(</span><span class="hs-string">&quot;specialize notinline&quot;</span><span class="hs-special">,</span><span>
</span><span id="line-3607"></span><span>         </span><span class="hs-identifier">strtoken</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITspec_inline_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SourceText</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3608"></span><span>     </span><span class="hs-special">]</span><span>
</span><span id="line-3609"></span><span>
</span><span id="line-3610"></span><span class="hs-identifier">dispatch_pragmas</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Map</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-identifier">Action</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-3611"></span><span class="hs-identifier">dispatch_pragmas</span><span> </span><span class="hs-identifier">prags</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3612"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">clean_pragma</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">prags</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3613"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">found</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">found</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-3614"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lexError</span><span> </span><span class="hs-identifier">LexUnknownPragma</span><span>
</span><span id="line-3615"></span><span>
</span><span id="line-3616"></span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Map</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-identifier">Action</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">ExtsBitmap</span><span>
</span><span id="line-3617"></span><span class="hs-identifier">known_pragma</span><span> </span><span class="hs-identifier">prags</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">startbuf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">curbuf</span><span class="hs-special">)</span><span>
</span><span id="line-3618"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isKnown</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">nextCharIsNot</span><span> </span><span class="hs-identifier">curbuf</span><span> </span><span class="hs-identifier">pragmaNameChar</span><span>
</span><span id="line-3619"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">startbuf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">byteDiff</span><span> </span><span class="hs-identifier">startbuf</span><span> </span><span class="hs-identifier">curbuf</span><span class="hs-special">)</span><span>
</span><span id="line-3620"></span><span>          </span><span class="hs-identifier">isKnown</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isJust</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">clean_pragma</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">prags</span><span>
</span><span id="line-3621"></span><span>          </span><span class="hs-identifier">pragmaNameChar</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isAlphaNum</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-char">'_'</span><span>
</span><span id="line-3622"></span><span>
</span><span id="line-3623"></span><span class="hs-identifier">clean_pragma</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span>
</span><span id="line-3624"></span><span class="hs-identifier">clean_pragma</span><span> </span><span class="hs-identifier">prag</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">canon_ws</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">toLower</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unprefix</span><span> </span><span class="hs-identifier">prag</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3625"></span><span>                    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">unprefix</span><span> </span><span class="hs-identifier">prag'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">stripPrefix</span><span> </span><span class="hs-string">&quot;{-#&quot;</span><span> </span><span class="hs-identifier">prag'</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3626"></span><span>                                             </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">rest</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">rest</span><span>
</span><span id="line-3627"></span><span>                                             </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">prag'</span><span>
</span><span id="line-3628"></span><span>                          </span><span class="hs-identifier">canonical</span><span> </span><span class="hs-identifier">prag'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">prag'</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3629"></span><span>                                              </span><span class="hs-string">&quot;noinline&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;notinline&quot;</span><span>
</span><span id="line-3630"></span><span>                                              </span><span class="hs-string">&quot;specialise&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;specialize&quot;</span><span>
</span><span id="line-3631"></span><span>                                              </span><span class="hs-string">&quot;constructorlike&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;conlike&quot;</span><span>
</span><span id="line-3632"></span><span>                                              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">prag'</span><span>
</span><span id="line-3633"></span><span>                          </span><span class="hs-identifier">canon_ws</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unwords</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">canonical</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">words</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3634"></span><span>
</span><span id="line-3635"></span><span class="hs-identifier">warn_unknown_prag</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Map</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-identifier">Action</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Action</span><span>
</span><span id="line-3636"></span><span class="hs-identifier">warn_unknown_prag</span><span> </span><span class="hs-identifier">prags</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3637"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">uppercase</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">toUpper</span><span>
</span><span id="line-3638"></span><span>      </span><span class="hs-identifier">unknown_prag</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">uppercase</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">clean_pragma</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lexemeToString</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3639"></span><span>      </span><span class="hs-identifier">suggestions</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">uppercase</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Map.keys</span><span> </span><span class="hs-identifier">prags</span><span class="hs-special">)</span><span>
</span><span id="line-3640"></span><span>  </span><span class="hs-identifier">addPsMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">span</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-3641"></span><span>    </span><span class="hs-identifier">PsWarnUnrecognisedPragma</span><span> </span><span class="hs-identifier">unknown_prag</span><span> </span><span class="hs-identifier">suggestions</span><span>
</span><span id="line-3642"></span><span>  </span><span class="hs-identifier">nested_comment</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">buf</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">buf2</span><span>
</span><span id="line-3643"></span><span>
</span><span id="line-3644"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
        Helper functions for generating annotations in the parser
%*                                                                      *
%************************************************************************
-}</span><span>
</span><span id="line-3651"></span><span>
</span><span id="line-3652"></span><span>
</span><span id="line-3653"></span><span class="hs-comment">-- |Given a 'RealSrcSpan' that surrounds a 'HsPar' or 'HsParTy', generate</span><span>
</span><span id="line-3654"></span><span class="hs-comment">-- 'AddEpAnn' values for the opening and closing bordering on the start</span><span>
</span><span id="line-3655"></span><span class="hs-comment">-- and end of the span</span><span>
</span><span id="line-3656"></span><span class="hs-identifier">mkParensEpAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AddEpAnn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">AddEpAnn</span><span class="hs-special">)</span><span>
</span><span id="line-3657"></span><span class="hs-identifier">mkParensEpAnn</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AddEpAnn</span><span> </span><span class="hs-identifier">AnnOpenP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaSpan</span><span> </span><span class="hs-identifier">lo</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">AddEpAnn</span><span> </span><span class="hs-identifier">AnnCloseP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaSpan</span><span> </span><span class="hs-identifier">lc</span><span> </span><span class="hs-identifier">Strict.Nothing</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3658"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3659"></span><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanFile</span><span> </span><span class="hs-identifier">ss</span><span>
</span><span id="line-3660"></span><span>    </span><span class="hs-identifier">sl</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanStartLine</span><span> </span><span class="hs-identifier">ss</span><span>
</span><span id="line-3661"></span><span>    </span><span class="hs-identifier">sc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanStartCol</span><span> </span><span class="hs-identifier">ss</span><span>
</span><span id="line-3662"></span><span>    </span><span class="hs-identifier">el</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanEndLine</span><span> </span><span class="hs-identifier">ss</span><span>
</span><span id="line-3663"></span><span>    </span><span class="hs-identifier">ec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanEndCol</span><span> </span><span class="hs-identifier">ss</span><span>
</span><span id="line-3664"></span><span>    </span><span class="hs-identifier">lo</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkRealSrcSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">realSrcSpanStart</span><span> </span><span class="hs-identifier">ss</span><span class="hs-special">)</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">mkRealSrcLoc</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sc</span><span class="hs-operator">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3665"></span><span>    </span><span class="hs-identifier">lc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkRealSrcSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkRealSrcLoc</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">el</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ec</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">realSrcSpanEnd</span><span> </span><span class="hs-identifier">ss</span><span class="hs-special">)</span><span>
</span><span id="line-3666"></span><span>
</span><span id="line-3667"></span><span class="hs-identifier">queueComment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealLocated</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">P</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3668"></span><span class="hs-identifier">queueComment</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">P</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POk</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-3669"></span><span>  </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">commentToAnnotation</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-3670"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3671"></span><span>
</span><span id="line-3672"></span><span class="hs-identifier">allocateComments</span><span>
</span><span id="line-3673"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span>
</span><span id="line-3674"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span>
</span><span id="line-3675"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3676"></span><span class="hs-identifier">allocateComments</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3677"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3678"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">before</span><span class="hs-special">,</span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">break</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">isRealSubspanOf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">anchor</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ss</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">comment_q</span><span>
</span><span id="line-3679"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">middle</span><span class="hs-special">,</span><span class="hs-identifier">after</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">break</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isRealSubspanOf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">anchor</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ss</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">rest</span><span>
</span><span id="line-3680"></span><span>    </span><span class="hs-identifier">comment_q'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">before</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">after</span><span>
</span><span id="line-3681"></span><span>    </span><span class="hs-identifier">newAnns</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">middle</span><span>
</span><span id="line-3682"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-3683"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">comment_q'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">)</span><span>
</span><span id="line-3684"></span><span>
</span><span id="line-3685"></span><span class="hs-comment">-- Comments appearing without a line-break before the first</span><span>
</span><span id="line-3686"></span><span class="hs-comment">-- declaration are associated with the declaration</span><span>
</span><span id="line-3687"></span><span class="hs-identifier">splitPriorComments</span><span>
</span><span id="line-3688"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span>
</span><span id="line-3689"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span>
</span><span id="line-3690"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3691"></span><span class="hs-identifier">splitPriorComments</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-identifier">prior_comments</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3692"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3693"></span><span>    </span><span class="hs-comment">-- True if there is only one line between the earlier and later span</span><span>
</span><span id="line-3694"></span><span>    </span><span class="hs-identifier">cmp</span><span> </span><span class="hs-identifier">later</span><span> </span><span class="hs-identifier">earlier</span><span>
</span><span id="line-3695"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanStartLine</span><span> </span><span class="hs-identifier">later</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">srcSpanEndLine</span><span> </span><span class="hs-identifier">earlier</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-3696"></span><span>
</span><span id="line-3697"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">decl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-identifier">decl</span><span class="hs-special">)</span><span>
</span><span id="line-3698"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">decl</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">cs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">cmp</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">anchor</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span>
</span><span id="line-3699"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">decl</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">anchor</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">cs</span><span>
</span><span id="line-3700"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">cs</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">decl</span><span class="hs-special">)</span><span>
</span><span id="line-3701"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-3702"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-identifier">prior_comments</span><span>
</span><span id="line-3703"></span><span>
</span><span id="line-3704"></span><span class="hs-identifier">allocatePriorComments</span><span>
</span><span id="line-3705"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span>
</span><span id="line-3706"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span>
</span><span id="line-3707"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span>
</span><span id="line-3708"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3709"></span><span class="hs-identifier">allocatePriorComments</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-identifier">mheader_comments</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3710"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-3711"></span><span>    </span><span class="hs-identifier">cmp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">anchor</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-identifier">ss</span><span>
</span><span id="line-3712"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">newAnns</span><span class="hs-special">,</span><span class="hs-identifier">after</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">partition</span><span> </span><span class="hs-identifier">cmp</span><span> </span><span class="hs-identifier">comment_q</span><span>
</span><span id="line-3713"></span><span>    </span><span class="hs-identifier">comment_q'</span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">after</span><span>
</span><span id="line-3714"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">prior_comments</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">decl_comments</span><span class="hs-special">)</span><span>
</span><span id="line-3715"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">mheader_comments</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3716"></span><span>           </span><span class="hs-identifier">Strict.Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3717"></span><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">splitPriorComments</span><span> </span><span class="hs-identifier">ss</span><span> </span><span class="hs-identifier">newAnns</span><span>
</span><span id="line-3718"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-3719"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">mheader_comments</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3720"></span><span>      </span><span class="hs-identifier">Strict.Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-identifier">prior_comments</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">comment_q'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">decl_comments</span><span class="hs-special">)</span><span>
</span><span id="line-3721"></span><span>      </span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mheader_comments</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">comment_q'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">newAnns</span><span class="hs-special">)</span><span>
</span><span id="line-3722"></span><span>
</span><span id="line-3723"></span><span class="hs-identifier">allocateFinalComments</span><span>
</span><span id="line-3724"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span>
</span><span id="line-3725"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span>
</span><span id="line-3726"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span>
</span><span id="line-3727"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LEpaComment</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3728"></span><span class="hs-identifier">allocateFinalComments</span><span> </span><span class="hs-identifier">_ss</span><span> </span><span class="hs-identifier">comment_q</span><span> </span><span class="hs-identifier">mheader_comments</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3729"></span><span>  </span><span class="hs-comment">-- We ignore the RealSrcSpan as the parser currently provides a</span><span>
</span><span id="line-3730"></span><span>  </span><span class="hs-comment">-- point span at (1,1).</span><span>
</span><span id="line-3731"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">mheader_comments</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3732"></span><span>    </span><span class="hs-identifier">Strict.Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">comment_q</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3733"></span><span>    </span><span class="hs-identifier">Strict.Just</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mheader_comments</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">reverse</span><span> </span><span class="hs-identifier">comment_q</span><span class="hs-special">)</span><span>
</span><span id="line-3734"></span><span>
</span><span id="line-3735"></span><span class="hs-identifier">commentToAnnotation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealLocated</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">LEpaComment</span><span>
</span><span id="line-3736"></span><span class="hs-identifier">commentToAnnotation</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITdocComment</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">ll</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkLEpaComment</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">ll</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaDocComment</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-3737"></span><span class="hs-identifier">commentToAnnotation</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITdocOptions</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">ll</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkLEpaComment</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">ll</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaDocOptions</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-3738"></span><span class="hs-identifier">commentToAnnotation</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITlineComment</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">ll</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkLEpaComment</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">ll</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaLineComment</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-3739"></span><span class="hs-identifier">commentToAnnotation</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITblockComment</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">ll</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkLEpaComment</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">ll</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaBlockComment</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-3740"></span><span class="hs-identifier">commentToAnnotation</span><span> </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">panic</span><span> </span><span class="hs-string">&quot;commentToAnnotation&quot;</span><span>
</span><span id="line-3741"></span><span>
</span><span id="line-3742"></span><span class="hs-comment">-- see Note [PsSpan in Comments]</span><span>
</span><span id="line-3743"></span><span class="hs-identifier">mkLEpaComment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">RealSrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">PsSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">EpaCommentTok</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">LEpaComment</span><span>
</span><span id="line-3744"></span><span class="hs-identifier">mkLEpaComment</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">ll</span><span> </span><span class="hs-identifier">tok</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">realSpanAsAnchor</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EpaComment</span><span> </span><span class="hs-identifier">tok</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psRealSpan</span><span> </span><span class="hs-identifier">ll</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3745"></span><span>
</span><span id="line-3746"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-3747"></span><span>
</span><span id="line-3748"></span><span class="hs-identifier">isComment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Token</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-3749"></span><span class="hs-identifier">isComment</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITlineComment</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3750"></span><span class="hs-identifier">isComment</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITblockComment</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3751"></span><span class="hs-identifier">isComment</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITdocComment</span><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3752"></span><span class="hs-identifier">isComment</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITdocOptions</span><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-3753"></span><span class="hs-identifier">isComment</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-3754"></span><span>
</span><span id="line-3755"></span><span class="hs-identifier">bol</span><span class="hs-special">,</span><span class="hs-identifier">column_prag</span><span class="hs-special">,</span><span class="hs-identifier">layout</span><span class="hs-special">,</span><span class="hs-identifier">layout_do</span><span class="hs-special">,</span><span class="hs-identifier">layout_if</span><span class="hs-special">,</span><span class="hs-identifier">layout_left</span><span class="hs-special">,</span><span class="hs-identifier">line_prag1</span><span class="hs-special">,</span><span class="hs-identifier">line_prag1a</span><span class="hs-special">,</span><span class="hs-identifier">line_prag2</span><span class="hs-special">,</span><span class="hs-identifier">line_prag2a</span><span class="hs-special">,</span><span class="hs-identifier">option_prags</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-3756"></span><span class="hs-identifier">bol</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-3757"></span><span class="hs-identifier">column_prag</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><span id="line-3758"></span><span class="hs-identifier">layout</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><span id="line-3759"></span><span class="hs-identifier">layout_do</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><span id="line-3760"></span><span class="hs-identifier">layout_if</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">5</span><span>
</span><span id="line-3761"></span><span class="hs-identifier">layout_left</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">6</span><span>
</span><span id="line-3762"></span><span class="hs-identifier">line_prag1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">7</span><span>
</span><span id="line-3763"></span><span class="hs-identifier">line_prag1a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><span id="line-3764"></span><span class="hs-identifier">line_prag2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">9</span><span>
</span><span id="line-3765"></span><span class="hs-identifier">line_prag2a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span>
</span><span id="line-3766"></span><span class="hs-identifier">option_prags</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">11</span><span>
</span><span id="line-3767"></span><span class="hs-identifier">alex_action_1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">warnTab</span><span>
</span><span id="line-3768"></span><span class="hs-identifier">alex_action_2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nested_comment</span><span>
</span><span id="line-3769"></span><span class="hs-identifier">alex_action_3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lineCommentToken</span><span>
</span><span id="line-3770"></span><span class="hs-identifier">alex_action_4</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lineCommentToken</span><span>
</span><span id="line-3771"></span><span class="hs-identifier">alex_action_5</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lineCommentToken</span><span>
</span><span id="line-3772"></span><span class="hs-identifier">alex_action_6</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lineCommentToken</span><span>
</span><span id="line-3773"></span><span class="hs-identifier">alex_action_7</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lineCommentToken</span><span>
</span><span id="line-3774"></span><span class="hs-identifier">alex_action_8</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lineCommentToken</span><span>
</span><span id="line-3775"></span><span class="hs-identifier">alex_action_9</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">smart_quote_error</span><span>
</span><span id="line-3776"></span><span class="hs-identifier">alex_action_11</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">begin</span><span> </span><span class="hs-identifier">line_prag1</span><span>
</span><span id="line-3777"></span><span class="hs-identifier">alex_action_12</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">begin</span><span> </span><span class="hs-identifier">line_prag1</span><span>
</span><span id="line-3778"></span><span class="hs-identifier">alex_action_16</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">do_bol</span><span>
</span><span id="line-3779"></span><span class="hs-identifier">alex_action_17</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hopefully_open_brace</span><span>
</span><span id="line-3780"></span><span class="hs-identifier">alex_action_19</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">begin</span><span> </span><span class="hs-identifier">line_prag1</span><span>
</span><span id="line-3781"></span><span class="hs-identifier">alex_action_20</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">new_layout_context</span><span> </span><span class="hs-identifier">True</span><span> </span><span class="hs-identifier">dontGenerateSemic</span><span> </span><span class="hs-identifier">ITvbar</span><span>
</span><span id="line-3782"></span><span class="hs-identifier">alex_action_21</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pop</span><span>
</span><span id="line-3783"></span><span class="hs-identifier">alex_action_22</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">new_layout_context</span><span> </span><span class="hs-identifier">True</span><span>  </span><span class="hs-identifier">generateSemic</span><span> </span><span class="hs-identifier">ITvocurly</span><span>
</span><span id="line-3784"></span><span class="hs-identifier">alex_action_23</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">new_layout_context</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-identifier">generateSemic</span><span> </span><span class="hs-identifier">ITvocurly</span><span>
</span><span id="line-3785"></span><span class="hs-identifier">alex_action_24</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">do_layout_left</span><span>
</span><span id="line-3786"></span><span class="hs-identifier">alex_action_25</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">begin</span><span> </span><span class="hs-identifier">bol</span><span>
</span><span id="line-3787"></span><span class="hs-identifier">alex_action_26</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dispatch_pragmas</span><span> </span><span class="hs-identifier">linePrags</span><span>
</span><span id="line-3788"></span><span class="hs-identifier">alex_action_27</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">setLineAndFile</span><span> </span><span class="hs-identifier">line_prag1a</span><span>
</span><span id="line-3789"></span><span class="hs-identifier">alex_action_28</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">failLinePrag1</span><span>
</span><span id="line-3790"></span><span class="hs-identifier">alex_action_29</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">popLinePrag1</span><span>
</span><span id="line-3791"></span><span class="hs-identifier">alex_action_30</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">setLineAndFile</span><span> </span><span class="hs-identifier">line_prag2a</span><span>
</span><span id="line-3792"></span><span class="hs-identifier">alex_action_31</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pop</span><span>
</span><span id="line-3793"></span><span class="hs-identifier">alex_action_32</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">setColumn</span><span>
</span><span id="line-3794"></span><span class="hs-identifier">alex_action_33</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dispatch_pragmas</span><span> </span><span class="hs-identifier">twoWordPrags</span><span>
</span><span id="line-3795"></span><span class="hs-identifier">alex_action_34</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dispatch_pragmas</span><span> </span><span class="hs-identifier">oneWordPrags</span><span>
</span><span id="line-3796"></span><span class="hs-identifier">alex_action_35</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dispatch_pragmas</span><span> </span><span class="hs-identifier">ignoredPrags</span><span>
</span><span id="line-3797"></span><span class="hs-identifier">alex_action_36</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">endPrag</span><span>
</span><span id="line-3798"></span><span class="hs-identifier">alex_action_37</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dispatch_pragmas</span><span> </span><span class="hs-identifier">fileHeaderPrags</span><span>
</span><span id="line-3799"></span><span class="hs-identifier">alex_action_38</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nested_comment</span><span>
</span><span id="line-3800"></span><span class="hs-identifier">alex_action_39</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">warn_unknown_prag</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Map.unions</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">oneWordPrags</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fileHeaderPrags</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ignoredPrags</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">linePrags</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3801"></span><span class="hs-identifier">alex_action_40</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">warn_unknown_prag</span><span> </span><span class="hs-identifier">Map.empty</span><span>
</span><span id="line-3802"></span><span class="hs-identifier">alex_action_41</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">multiline_doc_comment</span><span>
</span><span id="line-3803"></span><span class="hs-identifier">alex_action_42</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nested_doc_comment</span><span>
</span><span id="line-3804"></span><span class="hs-identifier">alex_action_43</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITopenExpQuote</span><span> </span><span class="hs-identifier">NoE</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3805"></span><span class="hs-identifier">alex_action_44</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITopenTExpQuote</span><span> </span><span class="hs-identifier">NoE</span><span class="hs-special">)</span><span>
</span><span id="line-3806"></span><span class="hs-identifier">alex_action_45</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITcloseQuote</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3807"></span><span class="hs-identifier">alex_action_46</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">ITcloseTExpQuote</span><span>
</span><span id="line-3808"></span><span class="hs-identifier">alex_action_47</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITopenExpQuote</span><span> </span><span class="hs-identifier">HasE</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3809"></span><span class="hs-identifier">alex_action_48</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITopenTExpQuote</span><span> </span><span class="hs-identifier">HasE</span><span class="hs-special">)</span><span>
</span><span id="line-3810"></span><span class="hs-identifier">alex_action_49</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">ITopenPatQuote</span><span>
</span><span id="line-3811"></span><span class="hs-identifier">alex_action_50</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">layout_token</span><span> </span><span class="hs-identifier">ITopenDecQuote</span><span>
</span><span id="line-3812"></span><span class="hs-identifier">alex_action_51</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">ITopenTypQuote</span><span>
</span><span id="line-3813"></span><span class="hs-identifier">alex_action_52</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lex_quasiquote_tok</span><span>
</span><span id="line-3814"></span><span id="AlexAddr"></span><span class="hs-identifier">alex_action_53</span><span> </span><span class="hs-glyph">=</span><span id="AlexA%23"><span> </span></span><span class="hs-identifier">lex_qquasiquote_tok</span><span>
</span><span id="line-3815"></span><span class="hs-identifier">alex_action_54</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITopenExpQuote</span><span> </span><span class="hs-identifier">NoE</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3816"></span><span class="hs-identifier">alex_action_55</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITcloseQuote</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3817"></span><span class="hs-identifier">alex_action_56</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IToparenbar</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3818"></span><span class="hs-identifier">alex_action_57</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITcparenbar</span><span> </span><span class="hs-identifier">NormalSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3819"></span><span class="hs-identifier">alex_action_58</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IToparenbar</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3820"></span><span class="hs-identifier">alex_action_59</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ITcparenbar</span><span> </span><span class="hs-identifier">UnicodeSyntax</span><span class="hs-special">)</span><span>
</span><span id="line-3821"></span><span class="hs-identifier">alex_action_60</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">skip_one_varid</span><span> </span><span class="hs-identifier">ITdupipvarid</span><span>
</span><span id="line-3822"></span><span id="alexIndexInt16OffAddr"><span class="hs-identifier">alex_action_61</span><span> </span><span class="hs-glyph">=</span><span> </span></span><span class="hs-identifier">skip_one_varid_src</span><span id="local-6989586621681751166"><span> </span></span><span class="hs-identifier">ITlabelvarid</span><span>
</span><span id="line-3823"></span><span class="hs-identifier">alex_action_62</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lex_quoted_label</span><span>
</span><span id="line-3824"></span><span class="hs-identifier">alex_action_63</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">IToubxparen</span><span>
</span><span id="line-3825"></span><span class="hs-identifier">alex_action_64</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">ITcubxparen</span><span>
</span><span id="line-3826"></span><span class="hs-identifier">alex_action_65</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-identifier">IToparen</span><span>
</span><span id="line-3827"></span><span class="hs-identifier">alex_action_66</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-identifier">ITcparen</span><span>
</span><span id="line-3828"></span><span class="hs-identifier">alex_action_67</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-identifier">ITobrack</span><span>
</span><span id="line-3829"></span><span class="hs-identifier">alex_action_68</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-identifier">ITcbrack</span><span>
</span><span id="line-3830"></span><span class="hs-identifier">alex_action_69</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-identifier">ITcomma</span><span>
</span><span id="line-3831"></span><span class="hs-identifier">alex_action_70</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-identifier">ITsemi</span><span>
</span><span id="line-3832"></span><span class="hs-identifier">alex_action_71</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">special</span><span> </span><span class="hs-identifier">ITbackquote</span><span>
</span><span id="line-3833"></span><span class="hs-identifier">alex_action_72</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">open_brace</span><span>
</span><span id="line-3834"></span><span class="hs-identifier">alex_action_73</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">close_brace</span><span>
</span><span id="line-3835"></span><span class="hs-identifier">alex_action_74</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">qdo_token</span><span> </span><span class="hs-identifier">ITdo</span><span>
</span><span id="line-3836"></span><span class="hs-identifier">alex_action_75</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">qdo_token</span><span> </span><span class="hs-identifier">ITmdo</span><span>
</span><span id="line-3837"></span><span class="hs-identifier">alex_action_76</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">qvarid</span><span>
</span><span id="line-3838"></span><span class="hs-identifier">alex_action_77</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">qconid</span><span>
</span><span id="line-3839"></span><span class="hs-identifier">alex_action_78</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varid</span><span>
</span><span id="line-3840"></span><span class="hs-identifier">alex_action_79</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">conid</span><span>
</span><span id="line-3841"></span><span class="hs-identifier">alex_action_80</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">qvarid</span><span>
</span><span id="line-3842"></span><span class="hs-identifier">alex_action_81</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">qconid</span><span>
</span><span id="line-3843"></span><span id="alexIndexInt32OffAddr"><span class="hs-identifier">alex_action_82</span><span> </span><span class="hs-glyph">=</span><span> </span></span><span class="hs-identifier">varid</span><span id="local-6989586621681751169"></span><span>
</span><span id="line-3844"></span><span class="hs-identifier">alex_action_83</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">conid</span><span>
</span><span id="line-3845"></span><span class="hs-identifier">alex_action_84</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">qvarsym</span><span>
</span><span id="line-3846"></span><span class="hs-identifier">alex_action_85</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">idtoken</span><span> </span><span class="hs-identifier">qconsym</span><span>
</span><span id="line-3847"></span><span class="hs-identifier">alex_action_86</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">with_op_ws</span><span> </span><span class="hs-identifier">varsym</span><span>
</span><span id="line-3848"></span><span class="hs-identifier">alex_action_87</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">with_op_ws</span><span> </span><span class="hs-identifier">consym</span><span>
</span><span id="line-3849"></span><span class="hs-identifier">alex_action_88</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-identifier">positive</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">decimal</span><span>
</span><span id="line-3850"></span><span class="hs-identifier">alex_action_89</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-identifier">positive</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-identifier">binary</span><span>
</span><span id="line-3851"></span><span class="hs-identifier">alex_action_90</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-identifier">positive</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-identifier">octal</span><span>
</span><span id="line-3852"></span><span class="hs-identifier">alex_action_91</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-identifier">positive</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-identifier">hexadecimal</span><span>
</span><span id="line-3853"></span><span class="hs-identifier">alex_action_92</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier">decimal</span><span>
</span><span id="line-3854"></span><span class="hs-identifier">alex_action_93</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">binary</span><span>
</span><span id="line-3855"></span><span class="hs-identifier">alex_action_94</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">octal</span><span>
</span><span id="line-3856"></span><span class="hs-identifier">alex_action_95</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_num</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">hexadecimal</span><span>
</span><span id="line-3857"></span><span class="hs-identifier">alex_action_96</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">tok_float</span><span>
</span><span id="line-3858"></span><span class="hs-identifier">alex_action_97</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">tok_float</span><span>
</span><span id="line-3859"></span><span class="hs-identifier">alex_action_98</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">tok_hex_float</span><span>
</span><span id="line-3860"></span><span class="hs-identifier">alex_action_99</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">tok_hex_float</span><span>
</span><span id="line-3861"></span><span class="hs-identifier">alex_action_100</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-identifier">positive</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier">decimal</span><span>
</span><span id="line-3862"></span><span class="hs-identifier">alex_action_101</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-identifier">positive</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">binary</span><span>
</span><span id="line-3863"></span><span class="hs-identifier">alex_action_102</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-identifier">positive</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">octal</span><span>
</span><span id="line-3864"></span><span class="hs-identifier">alex_action_103</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-identifier">positive</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">hexadecimal</span><span>
</span><span id="line-3865"></span><span class="hs-identifier">alex_action_104</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-identifier">decimal</span><span>
</span><span id="line-3866"></span><span class="hs-identifier">alex_action_105</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-identifier">binary</span><span>
</span><span id="line-3867"></span><span class="hs-identifier">alex_action_106</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-identifier">octal</span><span>
</span><span id="line-3868"></span><span class="hs-identifier">alex_action_107</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primint</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-identifier">hexadecimal</span><span>
</span><span id="line-3869"></span><span class="hs-identifier">alex_action_108</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primword</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-identifier">decimal</span><span>
</span><span id="line-3870"></span><span class="hs-identifier">alex_action_109</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primword</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-identifier">binary</span><span>
</span><span id="line-3871"></span><span id="quickIndex"></span><span class="hs-identifier">alex_action_110</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primword</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-identifier">octal</span><span>
</span><span id="line-3872"></span><span class="hs-identifier">alex_action_111</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_primword</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-identifier">hexadecimal</span><span>
</span><span id="line-3873"></span><span class="hs-identifier">alex_action_112</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier">tok_primfloat</span><span>
</span><span id="line-3874"></span><span class="hs-identifier">alex_action_113</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-identifier">tok_primdouble</span><span>
</span><span id="line-3875"></span><span class="hs-identifier">alex_action_114</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier">tok_primfloat</span><span>
</span><span id="line-3876"></span><span class="hs-identifier">alex_action_115</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tok_frac</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-identifier">tok_primdouble</span><span>
</span><span id="line-3877"></span><span class="hs-identifier">alex_action_116</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lex_char_tok</span><span>
</span><span id="line-3878"></span><span class="hs-identifier">alex_action_117</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lex_string_tok</span><span class="hs-cpp">

#define ALEX_GHC 1
</span><span class="hs-cpp">#define ALEX_LATIN1 1
</span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3883"></span><span class="hs-comment">-- ALEX TEMPLATE</span><span>
</span><span id="line-3884"></span><span class="hs-comment">--</span><span>
</span><span id="line-3885"></span><span class="hs-comment">-- This code is in the PUBLIC DOMAIN; you may copy it freely and use</span><span>
</span><span id="line-3886"></span><span class="hs-comment">-- it for any purpose whatsoever.</span><span>
</span><span id="line-3887"></span><span>
</span><span id="line-3888"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3889"></span><span class="hs-comment">-- INTERNALS and main scanner engine</span><span class="hs-cpp">

#ifdef ALEX_GHC
</span><span class="hs-cpp">#  define ILIT(n) n#
</span><span class="hs-cpp">#  define IBOX(n) (I# (n))
</span><span class="hs-cpp">#  define FAST_INT Int#
</span><span class="hs-comment">-- Do not remove this comment. Required to fix CPP parsing when using GCC and a clang-compiled alex.</span><span class="hs-cpp">
#  if __GLASGOW_HASKELL__ &gt; 706
</span><span class="hs-cpp">#    define GTE(n,m) (tagToEnum# (n &gt;=# m))
</span><span class="hs-cpp">#    define EQ(n,m) (tagToEnum# (n ==# m))
</span><span class="hs-cpp">#  else
</span><span class="hs-cpp">#    define GTE(n,m) (n &gt;=# m)
</span><span class="hs-cpp">#    define EQ(n,m) (n ==# m)
</span><span class="hs-cpp">#  endif
</span><span class="hs-cpp">#  define PLUS(n,m) (n +# m)
</span><span class="hs-cpp">#  define MINUS(n,m) (n -# m)
</span><span class="hs-cpp">#  define TIMES(n,m) (n *# m)
</span><span class="hs-cpp">#  define NEGATE(n) (negateInt# (n))
</span><span class="hs-cpp">#  define IF_GHC(x) (x)
</span><span class="hs-cpp">#else
</span><span class="hs-cpp">#  define ILIT(n) (n)
</span><span class="hs-cpp">#  define IBOX(n) (n)
</span><span class="hs-cpp">#  define FAST_INT Int
</span><span class="hs-cpp">#  define GTE(n,m) (n &gt;= m)
</span><span class="hs-cpp">#  define EQ(n,m) (n == m)
</span><span class="hs-cpp">#  define PLUS(n,m) (n + m)
</span><span class="hs-cpp">#  define MINUS(n,m) (n - m)
</span><span class="hs-cpp">#  define TIMES(n,m) (n * m)
</span><span class="hs-cpp">#  define NEGATE(n) (negate (n))
</span><span class="hs-cpp">#  define IF_GHC(x)
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#ifdef ALEX_GHC
</span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">AlexAddr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexA#</span><span> </span><span class="hs-identifier">Addr#</span><span>
</span><span id="line-3923"></span><span class="hs-comment">-- Do not remove this comment. Required to fix CPP parsing when using GCC and a clang-compiled alex.</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 503
</span><span class="hs-identifier">uncheckedShiftL#</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">shiftL#</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-3928"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">alexIndexInt16OffAddr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3929"></span><span class="hs-identifier">alexIndexInt16OffAddr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAddr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int#</span><span>
</span><span id="line-3930"></span><span class="hs-identifier">alexIndexInt16OffAddr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexA#</span><span> </span><span class="hs-identifier">arr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifdef WORDS_BIGENDIAN
</span><span>  </span><span class="hs-identifier">narrow16Int#</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-3933"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3934"></span><span>        </span><span class="hs-identifier">i</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">word2Int#</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">high</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftL#</span><span class="hs-special">`</span><span> </span><span class="hs-number">8#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">or#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">low</span><span class="hs-special">)</span><span>
</span><span id="line-3935"></span><span>        </span><span class="hs-identifier">high</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ord#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexCharOffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">off'</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3936"></span><span>        </span><span class="hs-identifier">low</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ord#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexCharOffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">off'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3937"></span><span>        </span><span class="hs-identifier">off'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-number">2#</span><span class="hs-cpp">
#else
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 901
</span><span>  </span><span class="hs-identifier">int16ToInt#</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">indexInt16OffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#else
</span><span class="hs-identifier">alexIndexInt16OffAddr</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-operator">!</span><span> </span><span class="hs-identifier">off</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#ifdef ALEX_GHC
</span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">alexIndexInt32OffAddr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3950"></span><span class="hs-identifier">alexIndexInt32OffAddr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AlexAddr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int#</span><span>
</span><span id="line-3951"></span><span class="hs-identifier">alexIndexInt32OffAddr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexA#</span><span> </span><span class="hs-identifier">arr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifdef WORDS_BIGENDIAN
</span><span>  </span><span class="hs-identifier">narrow32Int#</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-3954"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3955"></span><span>   </span><span class="hs-identifier">i</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">word2Int#</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">b3</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftL#</span><span class="hs-special">`</span><span> </span><span class="hs-number">24#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">or#</span><span class="hs-special">`</span><span>
</span><span id="line-3956"></span><span>                     </span><span class="hs-special">(</span><span class="hs-identifier">b2</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftL#</span><span class="hs-special">`</span><span> </span><span class="hs-number">16#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">or#</span><span class="hs-special">`</span><span>
</span><span id="line-3957"></span><span>                     </span><span class="hs-special">(</span><span class="hs-identifier">b1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftL#</span><span class="hs-special">`</span><span> </span><span class="hs-number">8#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">or#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b0</span><span class="hs-special">)</span><span>
</span><span id="line-3958"></span><span>   </span><span class="hs-identifier">b3</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ord#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexCharOffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">off'</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">3#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3959"></span><span>   </span><span class="hs-identifier">b2</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ord#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexCharOffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">off'</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">2#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3960"></span><span>   </span><span class="hs-identifier">b1</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ord#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexCharOffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">off'</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3961"></span><span>   </span><span class="hs-identifier">b0</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ord#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexCharOffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">off'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3962"></span><span>   </span><span class="hs-identifier">off'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-number">4#</span><span class="hs-cpp">
#else
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 901
</span><span>  </span><span class="hs-identifier">int32ToInt#</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">indexInt32OffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#else
</span><span class="hs-identifier">alexIndexInt32OffAddr</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-operator">!</span><span> </span><span class="hs-identifier">off</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#ifdef ALEX_GHC
</span><span id="AlexLastAcc"></span><span id="AlexNone"></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 503
</span><span class="hs-identifier">quickIndex</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-operator">!</span><span> </span><span class="hs-identifier">i</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- GHC &gt;= 503, unsafeAt is available from Data.Array.Base.</span><span>
</span><span id="line-3979"></span><span id="AlexAcc"></span><span class="hs-identifier">quickIndex</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681749777"></span><span class="hs-identifier">unsafeAt</span><span id="AlexAccNone"></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#else
</span><span id="AlexAccSkip"></span><span class="hs-identifier">quickIndex</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-operator">!</span><span> </span><span class="hs-identifier">i</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-3985"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-3986"></span><span class="hs-comment">-- Main lexing routines</span><span>
</span><span id="line-3987"></span><span>
</span><span id="line-3988"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">AlexReturn</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-3989"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexEOF</span><span>
</span><span id="line-3990"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexError</span><span>  </span><span class="hs-glyph">!</span><span class="hs-identifier">AlexInput</span><span>
</span><span id="line-3991"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexSkip</span><span>   </span><span class="hs-glyph">!</span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span>
</span><span id="line-3992"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexToken</span><span>  </span><span class="hs-glyph">!</span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-3993"></span><span>
</span><span id="line-3994"></span><span class="hs-comment">-- alexScan :: AlexInput -&gt; StartCode -&gt; AlexReturn a</span><span>
</span><span id="line-3995"></span><span class="hs-identifier">alexScan</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">sc</span><span class="hs-special">)</span><span>
</span><span id="line-3996"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">alexScanUser</span><span> </span><span class="hs-identifier">undefined</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">sc</span><span class="hs-special">)</span><span>
</span><span id="line-3997"></span><span>
</span><span id="line-3998"></span><span id="alexPrevCharMatches"><span class="hs-identifier">alexScanUser</span><span> </span><span class="hs-identifier">user__</span></span><span> </span><span id="local-6989586621681751238"></span><span id="local-6989586621681751239"></span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">IBOX</span><span class="annot"><span class="annottext">p
</span><span class="hs-special">(</span></span><span class="hs-identifier">sc</span><span class="hs-special">)</span><span>
</span><span id="line-3999"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alex_scan_tkn</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">ILIT</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">sc</span><span> </span><span class="hs-identifier">AlexNone</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4000"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AlexNone</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input__'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-4001"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetByte</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4002"></span><span>      </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#ifdef ALEX_DEBUG
</span><span id="alexRightContext"></span><span id="local-6989586621681751247"></span><span>                                   </span><span id="local-6989586621681751248"></span><span class="hs-identifier">trace</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;End of input.&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span class="hs-cpp">
#endif
</span><span>                                   </span><span class="hs-identifier">AlexEOF</span><span>
</span><span id="line-4007"></span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#ifdef ALEX_DEBUG
</span><span>                                   </span><span class="hs-identifier">trace</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Error.&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span class="hs-cpp">
#endif
</span><span>                                   </span><span class="hs-identifier">AlexError</span><span> </span><span class="hs-identifier">input__'</span><span>
</span><span id="line-4012"></span><span>
</span><span id="line-4013"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AlexLastSkip</span><span> </span><span class="hs-identifier">input__''</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#ifdef ALEX_DEBUG
</span><span>    </span><span class="hs-identifier">trace</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Skipping.&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-identifier">AlexSkip</span><span> </span><span class="hs-identifier">input__''</span><span> </span><span class="hs-identifier">len</span><span>
</span><span id="line-4018"></span><span>
</span><span id="line-4019"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">AlexLastAcc</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">input__'''</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#ifdef ALEX_DEBUG
</span><span>    </span><span class="hs-identifier">trace</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Accept.&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-identifier">AlexToken</span><span> </span><span class="hs-identifier">input__'''</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alex_actions</span><span> </span><span class="hs-operator">!</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>
</span><span id="line-4024"></span><span>
</span><span id="line-4025"></span><span>
</span><span id="line-4026"></span><span class="hs-comment">-- Push the input through the DFA, remembering the most recent accepting</span><span>
</span><span id="line-4027"></span><span class="hs-comment">-- state it encountered.</span><span>
</span><span id="line-4028"></span><span>
</span><span id="line-4029"></span><span class="hs-identifier">alex_scan_tkn</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">orig_input</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">last_acc</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4030"></span><span>  </span><span class="hs-identifier">input__</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-comment">-- strict in the input</span><span>
</span><span id="line-4031"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-4032"></span><span>  </span><span class="hs-identifier">new_acc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">check_accs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alex_accept</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">quickIndex</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4033"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-4034"></span><span>  </span><span class="hs-identifier">new_acc</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span>
</span><span id="line-4035"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alexGetByte</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4036"></span><span>     </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">new_acc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input__</span><span class="hs-special">)</span><span>
</span><span id="line-4037"></span><span>     </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">new_input</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#ifdef ALEX_DEBUG
</span><span>      </span><span class="hs-identifier">trace</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;State: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;, char: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span class="hs-cpp">
#endif
</span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">ord_c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-4042"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-4043"></span><span>                </span><span class="hs-identifier">base</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">alexIndexInt32OffAddr</span><span> </span><span class="hs-identifier">alex_base</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-4044"></span><span>                </span><span class="hs-identifier">offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PLUS</span><span class="hs-special">(</span><span class="hs-identifier">base</span><span class="hs-special">,</span><span class="hs-identifier">ord_c</span><span class="hs-special">)</span><span>
</span><span id="line-4045"></span><span>                </span><span class="hs-identifier">check</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">alexIndexInt16OffAddr</span><span> </span><span class="hs-identifier">alex_check</span><span> </span><span class="hs-identifier">offset</span><span>
</span><span id="line-4046"></span><span>
</span><span id="line-4047"></span><span>                </span><span class="hs-identifier">new_s</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">GTE</span><span class="hs-special">(</span><span class="hs-identifier">offset</span><span class="hs-special">,</span><span class="hs-identifier">ILIT</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">EQ</span><span class="hs-special">(</span><span class="hs-identifier">check</span><span class="hs-special">,</span><span class="hs-identifier">ord_c</span><span class="hs-special">)</span><span>
</span><span id="line-4048"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">alexIndexInt16OffAddr</span><span> </span><span class="hs-identifier">alex_table</span><span> </span><span class="hs-identifier">offset</span><span>
</span><span id="line-4049"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">alexIndexInt16OffAddr</span><span> </span><span class="hs-identifier">alex_deflt</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-4050"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-4051"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">new_s</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4052"></span><span>            </span><span class="hs-identifier">ILIT</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">new_acc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">input__</span><span class="hs-special">)</span><span>
</span><span id="line-4053"></span><span>                </span><span class="hs-comment">-- on an error, we want to keep the input *before* the</span><span>
</span><span id="line-4054"></span><span>                </span><span class="hs-comment">-- character that failed, not after.</span><span>
</span><span id="line-4055"></span><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">alex_scan_tkn</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">orig_input</span><span class="hs-cpp">
#ifdef ALEX_LATIN1
</span><span>                   </span><span class="hs-identifier">PLUS</span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-special">,</span><span class="hs-identifier">ILIT</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4058"></span><span>                   </span><span class="hs-comment">-- issue 119: in the latin1 encoding, *each* byte is one character</span><span class="hs-cpp">
#else
</span><span>                   </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">0x80</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-number">0xC0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">PLUS</span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-special">,</span><span class="hs-identifier">ILIT</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span>
</span><span id="line-4061"></span><span>                   </span><span class="hs-comment">-- note that the length is increased ONLY if this is the 1st byte in a char encoding)</span><span class="hs-cpp">
#endif
</span><span>                   </span><span class="hs-identifier">new_input</span><span> </span><span class="hs-identifier">new_s</span><span> </span><span class="hs-identifier">new_acc</span><span>
</span><span id="line-4064"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-4065"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-4066"></span><span>        </span><span class="hs-identifier">check_accs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAccNone</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">last_acc</span><span>
</span><span id="line-4067"></span><span>        </span><span class="hs-identifier">check_accs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-identifier">a</span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexLastAcc</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-special">)</span><span>
</span><span id="line-4068"></span><span>        </span><span class="hs-identifier">check_accs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAccSkip</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexLastSkip</span><span>  </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-special">)</span><span class="hs-cpp">
#ifndef ALEX_NOPRED
</span><span>        </span><span class="hs-identifier">check_accs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">predx</span><span> </span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span>
</span><span id="line-4071"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">predx</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">orig_input</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input__</span><span>
</span><span id="line-4072"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexLastAcc</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-special">)</span><span>
</span><span id="line-4073"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-4074"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">check_accs</span><span> </span><span class="hs-identifier">rest</span><span>
</span><span id="line-4075"></span><span>        </span><span class="hs-identifier">check_accs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAccSkipPred</span><span> </span><span class="hs-identifier">predx</span><span> </span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span>
</span><span id="line-4076"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">predx</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">orig_input</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input__</span><span>
</span><span id="line-4077"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexLastSkip</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">len</span><span class="hs-special">)</span><span>
</span><span id="line-4078"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-4079"></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">check_accs</span><span> </span><span class="hs-identifier">rest</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-4082"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">AlexLastAcc</span><span>
</span><span id="line-4083"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexNone</span><span>
</span><span id="line-4084"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexLastAcc</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span>
</span><span id="line-4085"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexLastSkip</span><span>     </span><span class="hs-glyph">!</span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span>
</span><span id="line-4086"></span><span>
</span><span id="line-4087"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-identifier">user</span><span>
</span><span id="line-4088"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AlexAccNone</span><span>
</span><span id="line-4089"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-4090"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexAccSkip</span><span class="hs-cpp">
#ifndef ALEX_NOPRED
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">user</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-identifier">user</span><span class="hs-special">)</span><span>
</span><span id="line-4093"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">AlexAccSkipPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">user</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AlexAcc</span><span> </span><span class="hs-identifier">user</span><span class="hs-special">)</span><span>
</span><span id="line-4094"></span><span>
</span><span id="line-4095"></span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">AlexAccPred</span><span> </span><span class="hs-identifier">user</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">user</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">AlexInput</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-4096"></span><span>
</span><span id="line-4097"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-4098"></span><span class="hs-comment">-- Predicates on a rule</span><span>
</span><span id="line-4099"></span><span>
</span><span id="line-4100"></span><span class="hs-identifier">alexAndPred</span><span> </span><span class="hs-identifier">p1</span><span> </span><span class="hs-identifier">p2</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">in1</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">in2</span><span>
</span><span id="line-4101"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">p1</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">in1</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">in2</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">p2</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">in1</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">in2</span><span>
</span><span id="line-4102"></span><span>
</span><span id="line-4103"></span><span class="hs-comment">--alexPrevCharIsPred :: Char -&gt; AlexAccPred _</span><span>
</span><span id="line-4104"></span><span class="hs-identifier">alexPrevCharIs</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">alexInputPrevChar</span><span> </span><span class="hs-identifier">input__</span><span>
</span><span id="line-4105"></span><span>
</span><span id="line-4106"></span><span class="hs-identifier">alexPrevCharMatches</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">alexInputPrevChar</span><span> </span><span class="hs-identifier">input__</span><span class="hs-special">)</span><span>
</span><span id="line-4107"></span><span>
</span><span id="line-4108"></span><span class="hs-comment">--alexPrevCharIsOneOfPred :: Array Char Bool -&gt; AlexAccPred _</span><span>
</span><span id="line-4109"></span><span class="hs-identifier">alexPrevCharIsOneOf</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-operator">!</span><span> </span><span class="hs-identifier">alexInputPrevChar</span><span> </span><span class="hs-identifier">input__</span><span>
</span><span id="line-4110"></span><span>
</span><span id="line-4111"></span><span class="hs-comment">--alexRightContext :: Int -&gt; AlexAccPred _</span><span>
</span><span id="line-4112"></span><span class="hs-identifier">alexRightContext</span><span> </span><span class="hs-identifier">IBOX</span><span class="hs-special">(</span><span class="hs-identifier">sc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-4113"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">alex_scan_tkn</span><span> </span><span class="hs-identifier">user__</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">ILIT</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">input__</span><span> </span><span class="hs-identifier">sc</span><span> </span><span class="hs-identifier">AlexNone</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-4114"></span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">AlexNone</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-4115"></span><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-4116"></span><span>        </span><span class="hs-comment">-- TODO: there's no need to find the longest</span><span>
</span><span id="line-4117"></span><span>        </span><span class="hs-comment">-- match when checking the right context, just</span><span>
</span><span id="line-4118"></span><span>        </span><span class="hs-comment">-- the first match will do.</span><span class="hs-cpp">
#endif
</span></pre></body></html>