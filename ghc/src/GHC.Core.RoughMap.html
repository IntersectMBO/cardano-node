<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621681582461"><span id="local-6989586621681582462"><span id="local-6989586621681582463"><span id="local-6989586621681582464"><span id="local-6989586621681582465"><span id="local-6989586621681582466"><span id="local-6989586621681582467"></span></span></span></span></span></span></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- | 'RoughMap' is an approximate finite map data structure keyed on</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- @['RoughMatchTc']@. This is useful when keying maps on lists of 'Type's</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- (e.g. an instance head).</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Core.RoughMap</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * RoughMatchTc</span></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier">RoughMatchTc</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#isRoughWildcard"><span class="hs-identifier">isRoughWildcard</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#typeToRoughMatchTc"><span class="hs-identifier">typeToRoughMatchTc</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchLookupTc"><span class="hs-identifier">RoughMatchLookupTc</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#typeToRoughMatchLookupTc"><span class="hs-identifier">typeToRoughMatchLookupTc</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#roughMatchTcToLookup"><span class="hs-identifier">roughMatchTcToLookup</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#roughMatchTcs"><span class="hs-identifier">roughMatchTcs</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#roughMatchTcsLookup"><span class="hs-identifier">roughMatchTcsLookup</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#instanceCantMatch"><span class="hs-identifier">instanceCantMatch</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * RoughMap</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier">RoughMap</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#emptyRM"><span class="hs-identifier">emptyRM</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#lookupRM"><span class="hs-identifier">lookupRM</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier">lookupRM'</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier">insertRM</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#filterRM"><span class="hs-identifier">filterRM</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier">filterMatchingRM</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#elemsRM"><span class="hs-identifier">elemsRM</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#sizeRM"><span class="hs-identifier">sizeRM</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#foldRM"><span class="hs-identifier">foldRM</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#unionRM"><span class="hs-identifier">unionRM</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html"><span class="hs-identifier">GHC.Data.Bag</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html#cONSTRAINTTyConName"><span class="hs-identifier">cONSTRAINTTyConName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html#tYPETyConName"><span class="hs-identifier">tYPETyConName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#join/GHC.Base.html#join"><span class="hs-identifier">join</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Data.html#/Data.Data.html"><span class="hs-identifier">Data.Data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Data.html#Data/Data.Data.html#Data"><span class="hs-identifier">Data</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">{-
Note [RoughMap]
~~~~~~~~~~~~~~~
We often want to compute whether one type matches another. That is, given
`ty1` and `ty2`, we want to know whether `ty1` is a substitution instance of `ty2`.

We can bail out early by taking advantage of the following observation:

  If `ty2` is headed by a generative type constructor, say `tc`,
  but `ty1` is not headed by that same type constructor,
  then `ty1` does not match `ty2`.

The idea is that we can use a `RoughMap` as a pre-filter, to produce a
short-list of candidates to examine more closely.

This means we can avoid computing a full substitution if we represent types
as applications of known generative type constructors. So, after type synonym
expansion, we classify application heads into two categories ('RoughMatchTc')

  - `RM_KnownTc tc`: the head is the generative type constructor `tc`,
  - `RM_Wildcard`: anything else.

A (RoughMap val) is semantically a list of (key,[val]) pairs, where
   key :: [RoughMatchTc]
So, writing # for `OtherTc`, and Int for `KnownTc &quot;Int&quot;`, we might have
    [ ([#, Int, Maybe, #, Int], v1)
    , ([Int, #, List], v2 ]

This map is stored as a trie, so looking up a key is very fast.
See Note [Matching a RoughMap] and Note [Simple Matching Semantics] for details on
lookup.

We lookup a key of type [RoughMatchLookupTc], and return the list of all values whose
keys &quot;match&quot;:

Given the above map, here are the results of some lookups:
   Lookup key       Result
   -------------------------
   [Int, Int]       [v1,v2] -- Matches because the prefix of both entries matches
   [Int,Int,List]   [v2]
   [Bool]           []

Notice that a single key can map to /multiple/ values.  E.g. if we started
with (Maybe Int, val1) and (Maybe Bool, val2), we'd generate a RoughMap
that is semantically the list   [( Maybe, [val1,val2] )]

Note [RoughMap and beta reduction]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
There is one tricky case we have to account for when matching a rough map due
to Note [Eta reduction for data families] in `GHC.Core.Coercion.Axiom`:
Consider that the user has written a program containing a data family:

&gt; data family Fam a b
&gt; data instance Fam Int a = SomeType  -- known henceforth as FamIntInst

The LHS of this instance will be eta reduced, as described in Note [Eta
reduction for data families]. Consequently, we will end up with a `FamInst`
with `fi_tcs = [KnownTc Int]`. Naturally, we need RoughMap to return this
instance when queried for an instance with template, e.g., `[KnownTc Fam,
KnownTc Int, KnownTc Char]`.

This explains the third clause of the mightMatch specification in Note [Simple Matching Semantics].
As soon as the lookup key runs out, the remaining instances might match.

This only matters for the data-family case of a FamInstEnv (see Note [Over-saturated matches]
in GHC.Core.FamInstEnv; it's irrelevantfor ClsInstEnv and for type-family instances.
But we use RoughMaps for all cases, so we are conservative.

Note [Matching a RoughMap]
~~~~~~~~~~~~~~~~~~~~~~~~~~
The /lookup key/ into a rough map (RoughMatchLookupTc) is slightly
different to the /insertion key/ (RoughMatchTc).  Like the insertion
key each lookup argument is classified to a simpler key which
describes what could match that position. There are three
possibilities:

* RML_KnownTc Name: The argument is headed by a known type
  constructor.  Example: 'Bool' is classified as 'RML_KnownTc Bool'
  and '[Int]' is classified as `RML_KnownTc []`

* RML_NoKnownTc: The argument is definitely not headed by any known
  type constructor.  Example: For instance matching 'a[sk], a[tau]' and 'F a[sk], F a[tau]'
  are classified as 'RML_NoKnownTc', for family instance matching no examples.

* RML_WildCard: The argument could match anything, we don't know
  enough about it. For instance matching no examples, for type family matching,
  things to do with variables.

The interesting case for instance matching is the second case, because it does not appear in
an insertion key. The second case arises in two situations:

1. The head of the application is a type variable. The type variable definitely
   doesn't match with any of the KnownTC instances so we can discard them all. For example:
    Show a[sk] or Show (a[sk] b[sk]). One place constraints like this arise is when
    typechecking derived instances.

2. The head of the application is a known type family.
   For example: F a[sk]. The application of F is stuck, and because
   F is a type family it won't match any KnownTC instance so it's safe to discard
   all these instances.

Of course, these two cases can still match instances of the form `forall a . Show a =&gt;`,
and those instances are retained as they are classified as RM_WildCard instances.

Note [Matches vs Unifiers]
~~~~~~~~~~~~~~~~~~~~~~~~~~
The lookupRM' function returns a pair of potential /matches/ and potential /unifiers/.
The potential matches is likely to be much smaller than the bag of potential unifiers due
to the reasoning about rigid type variables described in Note [Matching a RoughMap].
On the other hand, the instances captured by the RML_NoKnownTC case can still potentially unify
with any instance (depending on the substitution of said rigid variable) so they can't be discounted
from the list of potential unifiers. This is achieved by the RML_NoKnownTC case continuing
the lookup for unifiers by replacing RML_NoKnownTC with RML_LookupOtherTC.

This distinction between matches and unifiers is also important for type families.
During normal type family lookup, we care about matches and when checking for consistency
we care about the unifiers. This is evident in the code as `lookup_fam_inst_env` is
parameterised over a lookup function which either performs matching checking or unification
checking.

In addition to this, we only care whether there are zero or non-zero potential
unifiers, even if we have many candidates, the search can stop before consulting
each candidate. We only need the full list of unifiers when displaying error messages.
Therefore the list is computed lazily so much work can be avoided constructing the
list in the first place.

Note [Simple Matching Semantics]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose `rm` is a RoughMap representing a set of (key,vals) pairs,
  where key::[RoughMapTc] and val::a.
Suppose I look up a key lk :: [RoughMapLookupTc] in `rm`
Then I get back (matches, unifiers) where
   matches  = [ vals | (key,vals) &lt;- rm, key `mightMatch` lk ]
   unifiers = [ vals | (key,vals) &lt;- rm, key `mightUnify` lk ]

Where mightMatch is defined like this:

  mightMatch :: [RoughMapTc] -&gt; [RoughMapLookupTc] -&gt; Bool
  mightMatch []  []    = True   -- A perfectly sized match might match
  mightMatch key []    = True   -- A shorter lookup key matches everything
  mightMatch []  (_:_) = True   -- If the lookup key is longer, then still might match
                                -- Note [RoughMap and beta reduction]
  mightMatch (k:ks) (lk:lks) =
    = case (k,lk) of
         -- Standard case, matching on a specific known TyCon.
         (RM_KnownTc n1, RML_KnownTc n2) -&gt; n1==n2 &amp;&amp; mightMatch ks lks
         -- For example, if the key for 'Show Bool' is [RM_KnownTc Show, RM_KnownTc Bool]
         ---and we match against (Show a[sk]) [RM_KnownTc Show, RML_NoKnownTc]
         -- then Show Bool can never match Show a[sk] so return False.
         (RM_KnownTc _, RML_NoKnownTc)   -&gt; False
         -- Wildcard cases don't inform us anything about the match.
         (RM_WildCard, _ )    -&gt; mightMatch ks lks
         (_, RML_WildCard)    -&gt; mightMatch ks lks

  -- Might unify is very similar to mightMatch apart from RML_NoKnownTc may
  -- unify with any instance.
  mightUnify :: [RoughMapTc] -&gt; [RoughMapLookupTc] -&gt; Bool
  mightUnify []  []    = True   -- A perfectly sized match might unify
  mightUnify key []    = True   -- A shorter lookup key matches everything
  mightUnify []  (_:_) = True
  mightUnify (k:ks) (lk:lks) =
    = case (k,lk) of
         (RM_KnownTc n1, RML_KnownTc n2) -&gt; n1==n2 &amp;&amp; mightUnify ks lks
         (RM_KnownTc _, RML_NoKnownTc)   -&gt; mightUnify (k:ks) (RML_WildCard:lks)
         (RM_WildCard, _ )    -&gt; mightUnify ks lks
         (_, RML_WildCard)    -&gt; mightUnify ks lks


The guarantee that RoughMap provides is that

if
   insert_ty `tcMatchTy` lookup_ty
then definitely
   typeToRoughMatchTc insert_ty `mightMatch` typeToRoughMatchLookupTc lookup_ty
but not vice versa

this statement encodes the intuition that the RoughMap is used as a quick pre-filter
to remove instances from the matching pool. The contrapositive states that if the
RoughMap reports that the instance doesn't match then `tcMatchTy` will report that the
types don't match as well.

-}</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                Rough matching
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">{- Note [Rough matching in class and family instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
  instance C (Maybe [Tree a]) Bool
and suppose we are looking up
     C Bool Bool

We can very quickly rule the instance out, because the first
argument is headed by Maybe, whereas in the constraint we are looking
up has first argument headed by Bool.  These &quot;headed by&quot; TyCons are
called the &quot;rough match TyCons&quot; of the constraint or instance.
They are used for a quick filter, to check when an instance cannot
possibly match.

The main motivation is to avoid sucking in whole instance
declarations that are utterly useless.  See GHC.Core.InstEnv
Note [ClsInst laziness and the rough-match fields].

INVARIANT: a rough-match TyCons `tc` is always a real, generative tycon,
like Maybe or Either, including a newtype or a data family, both of
which are generative. It replies True to `isGenerativeTyCon tc Nominal`.

But it is never
    - A type synonym
      E.g. Int and (S Bool) might match
           if (S Bool) is a synonym for Int

    - A type family (#19336)
      E.g.   (Just a) and (F a) might match if (F a) reduces to (Just a)
             albeit perhaps only after 'a' is instantiated.
-}</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- Key for insertion into a RoughMap</span><span>
</span><span id="line-272"></span><span class="hs-keyword">data</span><span> </span><span id="RoughMatchTc"><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-var">RoughMatchTc</span></a></span></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RM_KnownTc"><span class="annot"><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-var">RM_KnownTc</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>  </span><span class="hs-comment">-- INVARIANT: Name refers to a TyCon tc that responds</span><span>
</span><span id="line-274"></span><span>                     </span><span class="hs-comment">-- true to `isGenerativeTyCon tc Nominal`. See</span><span>
</span><span id="line-275"></span><span>                     </span><span class="hs-comment">-- Note [Rough matching in class and family instances]</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RM_WildCard"><span class="annot"><a href="GHC.Core.RoughMap.html#RM_WildCard"><span class="hs-identifier hs-var">RM_WildCard</span></a></span></span><span>      </span><span class="hs-comment">-- e.g. type variable at the head</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span id="local-6989586621681582500"><span id="local-6989586621681582504"><span id="local-6989586621681582507"><span id="local-6989586621681582509"><span id="local-6989586621681582511"><span id="local-6989586621681582517"><span id="local-6989586621681582522"><span id="local-6989586621681582525"><span id="local-6989586621681582528"><span id="local-6989586621681582531"><span id="local-6989586621681582534"><span id="local-6989586621681582537"><span id="local-6989586621681582542"><span id="local-6989586621681582547"><span class="annot"><span class="annottext">Typeable RoughMatchTc
Typeable RoughMatchTc =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; RoughMatchTc -&gt; c RoughMatchTc)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c RoughMatchTc)
-&gt; (RoughMatchTc -&gt; Constr)
-&gt; (RoughMatchTc -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c RoughMatchTc))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c RoughMatchTc))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; RoughMatchTc -&gt; RoughMatchTc)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchTc -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchTc -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchTc -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchTc -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc)
-&gt; Data RoughMatchTc
RoughMatchTc -&gt; Constr
RoughMatchTc -&gt; DataType
(forall b. Data b =&gt; b -&gt; b) -&gt; RoughMatchTc -&gt; RoughMatchTc
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchTc -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchTc -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchTc -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchTc -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c RoughMatchTc
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; RoughMatchTc -&gt; c RoughMatchTc
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c RoughMatchTc)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c RoughMatchTc)
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; RoughMatchTc -&gt; c RoughMatchTc
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; RoughMatchTc -&gt; c RoughMatchTc
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c RoughMatchTc
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c RoughMatchTc
$ctoConstr :: RoughMatchTc -&gt; Constr
toConstr :: RoughMatchTc -&gt; Constr
$cdataTypeOf :: RoughMatchTc -&gt; DataType
dataTypeOf :: RoughMatchTc -&gt; DataType
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c RoughMatchTc)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c RoughMatchTc)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c RoughMatchTc)
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c RoughMatchTc)
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; RoughMatchTc -&gt; RoughMatchTc
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; RoughMatchTc -&gt; RoughMatchTc
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchTc -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchTc -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchTc -&gt; r
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchTc -&gt; r
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchTc -&gt; [u]
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchTc -&gt; [u]
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchTc -&gt; u
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchTc -&gt; u
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; RoughMatchTc -&gt; m RoughMatchTc
</span><a href="../../base-4.18.2.1/src/Data.Data.html#Data/Data.Data.html#Data"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- Key for lookup into a RoughMap</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- See Note [Matching a RoughMap]</span><span>
</span><span id="line-281"></span><span class="hs-keyword">data</span><span> </span><span id="RoughMatchLookupTc"><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchLookupTc"><span class="hs-identifier hs-var">RoughMatchLookupTc</span></a></span></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RML_KnownTc"><span class="annot"><a href="GHC.Core.RoughMap.html#RML_KnownTc"><span class="hs-identifier hs-var">RML_KnownTc</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The position only matches the specified KnownTc</span></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RML_NoKnownTc"><span class="annot"><a href="GHC.Core.RoughMap.html#RML_NoKnownTc"><span class="hs-identifier hs-var">RML_NoKnownTc</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The position definitely doesn't match any KnownTc</span></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RML_WildCard"><span class="annot"><a href="GHC.Core.RoughMap.html#RML_WildCard"><span class="hs-identifier hs-var">RML_WildCard</span></a></span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ The position can match anything</span></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621681582558"><span id="local-6989586621681582561"><span id="local-6989586621681582564"><span id="local-6989586621681582566"><span id="local-6989586621681582568"><span id="local-6989586621681582574"><span id="local-6989586621681582579"><span id="local-6989586621681582582"><span id="local-6989586621681582585"><span id="local-6989586621681582588"><span id="local-6989586621681582591"><span id="local-6989586621681582594"><span id="local-6989586621681582599"><span id="local-6989586621681582604"><span class="annot"><span class="annottext">Typeable RoughMatchLookupTc
Typeable RoughMatchLookupTc =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g)
 -&gt; RoughMatchLookupTc
 -&gt; c RoughMatchLookupTc)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c RoughMatchLookupTc)
-&gt; (RoughMatchLookupTc -&gt; Constr)
-&gt; (RoughMatchLookupTc -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c RoughMatchLookupTc))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c RoughMatchLookupTc))
-&gt; ((forall b. Data b =&gt; b -&gt; b)
    -&gt; RoughMatchLookupTc -&gt; RoughMatchLookupTc)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchLookupTc -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchLookupTc -&gt; r)
-&gt; (forall u.
    (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchLookupTc -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchLookupTc -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc)
-&gt; Data RoughMatchLookupTc
RoughMatchLookupTc -&gt; Constr
RoughMatchLookupTc -&gt; DataType
(forall b. Data b =&gt; b -&gt; b)
-&gt; RoughMatchLookupTc -&gt; RoughMatchLookupTc
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchLookupTc -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchLookupTc -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchLookupTc -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchLookupTc -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c RoughMatchLookupTc
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g)
-&gt; RoughMatchLookupTc
-&gt; c RoughMatchLookupTc
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c RoughMatchLookupTc)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c RoughMatchLookupTc)
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g)
-&gt; RoughMatchLookupTc
-&gt; c RoughMatchLookupTc
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g)
-&gt; RoughMatchLookupTc
-&gt; c RoughMatchLookupTc
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c RoughMatchLookupTc
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c RoughMatchLookupTc
$ctoConstr :: RoughMatchLookupTc -&gt; Constr
toConstr :: RoughMatchLookupTc -&gt; Constr
$cdataTypeOf :: RoughMatchLookupTc -&gt; DataType
dataTypeOf :: RoughMatchLookupTc -&gt; DataType
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c RoughMatchLookupTc)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c RoughMatchLookupTc)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c RoughMatchLookupTc)
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c RoughMatchLookupTc)
$cgmapT :: (forall b. Data b =&gt; b -&gt; b)
-&gt; RoughMatchLookupTc -&gt; RoughMatchLookupTc
gmapT :: (forall b. Data b =&gt; b -&gt; b)
-&gt; RoughMatchLookupTc -&gt; RoughMatchLookupTc
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchLookupTc -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchLookupTc -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchLookupTc -&gt; r
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; RoughMatchLookupTc -&gt; r
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchLookupTc -&gt; [u]
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchLookupTc -&gt; [u]
$cgmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchLookupTc -&gt; u
gmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; RoughMatchLookupTc -&gt; u
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; RoughMatchLookupTc -&gt; m RoughMatchLookupTc
</span><a href="../../base-4.18.2.1/src/Data.Data.html#Data/Data.Data.html#Data"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchLookupTc"><span class="hs-identifier hs-type">RoughMatchLookupTc</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621681582618"><span class="annot"><span class="annottext">ppr :: RoughMatchLookupTc -&gt; SDoc
</span><a href="#local-6989586621681582618"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RML_KnownTc"><span class="hs-identifier hs-type">RML_KnownTc</span></a></span><span> </span><span id="local-6989586621681582620"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582620"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RML_KnownTc&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582620"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_NoKnownTc"><span class="hs-identifier hs-var">RML_NoKnownTc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RML_NoKnownTC&quot;</span></span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_WildCard"><span class="hs-identifier hs-var">RML_WildCard</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621681582629"><span class="annot"><span class="annottext">ppr :: RoughMatchTc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-type">RM_KnownTc</span></a></span><span> </span><span id="local-6989586621681582630"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582630"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;KnownTc&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582630"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#RM_WildCard"><span class="hs-identifier hs-var">RM_WildCard</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;OtherTc&quot;</span></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="GHC.Core.RoughMap.html#instanceCantMatch"><span class="hs-identifier hs-type">instanceCantMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- (instanceCantMatch tcs1 tcs2) returns True if tcs1 cannot</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- possibly be instantiated to actual, nor vice versa;</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- False is non-committal</span><span>
</span><span id="line-300"></span><span id="instanceCantMatch"><span class="annot"><span class="annottext">instanceCantMatch :: [RoughMatchTc] -&gt; [RoughMatchTc] -&gt; Bool
</span><a href="GHC.Core.RoughMap.html#instanceCantMatch"><span class="hs-identifier hs-var hs-var">instanceCantMatch</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681582631"><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="#local-6989586621681582631"><span class="hs-identifier hs-var">mt</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582632"><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582632"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681582633"><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="#local-6989586621681582633"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582634"><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582634"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMatchTc -&gt; RoughMatchTc -&gt; Bool
</span><a href="GHC.Core.RoughMap.html#itemCantMatch"><span class="hs-identifier hs-var">itemCantMatch</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="#local-6989586621681582631"><span class="hs-identifier hs-var">mt</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="#local-6989586621681582633"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc] -&gt; [RoughMatchTc] -&gt; Bool
</span><a href="GHC.Core.RoughMap.html#instanceCantMatch"><span class="hs-identifier hs-var">instanceCantMatch</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582632"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582634"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-301"></span><span class="annot"><a href="GHC.Core.RoughMap.html#instanceCantMatch"><span class="hs-identifier hs-var">instanceCantMatch</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- Safe</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><a href="GHC.Core.RoughMap.html#itemCantMatch"><span class="hs-identifier hs-type">itemCantMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-304"></span><span id="itemCantMatch"><span class="annot"><span class="annottext">itemCantMatch :: RoughMatchTc -&gt; RoughMatchTc -&gt; Bool
</span><a href="GHC.Core.RoughMap.html#itemCantMatch"><span class="hs-identifier hs-var hs-var">itemCantMatch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-type">RM_KnownTc</span></a></span><span> </span><span id="local-6989586621681582637"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582637"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-type">RM_KnownTc</span></a></span><span> </span><span id="local-6989586621681582638"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582638"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582637"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582638"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-305"></span><span class="annot"><a href="GHC.Core.RoughMap.html#itemCantMatch"><span class="hs-identifier hs-var">itemCantMatch</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMatchTc
</span><span class="hs-identifier">_</span></span><span>              </span><span class="annot"><span class="annottext">RoughMatchTc
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="GHC.Core.RoughMap.html#roughMatchTcToLookup"><span class="hs-identifier hs-type">roughMatchTcToLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchLookupTc"><span class="hs-identifier hs-type">RoughMatchLookupTc</span></a></span><span>
</span><span id="line-308"></span><span id="roughMatchTcToLookup"><span class="annot"><span class="annottext">roughMatchTcToLookup :: RoughMatchTc -&gt; RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#roughMatchTcToLookup"><span class="hs-identifier hs-var hs-var">roughMatchTcToLookup</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-type">RM_KnownTc</span></a></span><span> </span><span id="local-6989586621681582640"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582640"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_KnownTc"><span class="hs-identifier hs-var">RML_KnownTc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582640"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-309"></span><span class="annot"><a href="GHC.Core.RoughMap.html#roughMatchTcToLookup"><span class="hs-identifier hs-var">roughMatchTcToLookup</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#RM_WildCard"><span class="hs-identifier hs-var">RM_WildCard</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_WildCard"><span class="hs-identifier hs-var">RML_WildCard</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><a href="GHC.Core.RoughMap.html#isRoughWildcard"><span class="hs-identifier hs-type">isRoughWildcard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-312"></span><span id="isRoughWildcard"><span class="annot"><span class="annottext">isRoughWildcard :: RoughMatchTc -&gt; Bool
</span><a href="GHC.Core.RoughMap.html#isRoughWildcard"><span class="hs-identifier hs-var hs-var">isRoughWildcard</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#RM_WildCard"><span class="hs-identifier hs-var">RM_WildCard</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-313"></span><span class="annot"><a href="GHC.Core.RoughMap.html#isRoughWildcard"><span class="hs-identifier hs-var">isRoughWildcard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-type">RM_KnownTc</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><a href="GHC.Core.RoughMap.html#roughMatchTcs"><span class="hs-identifier hs-type">roughMatchTcs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span id="roughMatchTcs"><span class="annot"><span class="annottext">roughMatchTcs :: [Type] -&gt; [RoughMatchTc]
</span><a href="GHC.Core.RoughMap.html#roughMatchTcs"><span class="hs-identifier hs-var hs-var">roughMatchTcs</span></a></span></span><span> </span><span id="local-6989586621681582641"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681582641"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; RoughMatchTc) -&gt; [Type] -&gt; [RoughMatchTc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#typeToRoughMatchTc"><span class="hs-identifier hs-var">typeToRoughMatchTc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681582641"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><a href="GHC.Core.RoughMap.html#roughMatchTcsLookup"><span class="hs-identifier hs-type">roughMatchTcsLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchLookupTc"><span class="hs-identifier hs-type">RoughMatchLookupTc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span id="roughMatchTcsLookup"><span class="annot"><span class="annottext">roughMatchTcsLookup :: [Type] -&gt; [RoughMatchLookupTc]
</span><a href="GHC.Core.RoughMap.html#roughMatchTcsLookup"><span class="hs-identifier hs-var hs-var">roughMatchTcsLookup</span></a></span></span><span> </span><span id="local-6989586621681582642"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681582642"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; RoughMatchLookupTc) -&gt; [Type] -&gt; [RoughMatchLookupTc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#typeToRoughMatchLookupTc"><span class="hs-identifier hs-var">typeToRoughMatchLookupTc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681582642"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><a href="GHC.Core.RoughMap.html#typeToRoughMatchLookupTc"><span class="hs-identifier hs-type">typeToRoughMatchLookupTc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchLookupTc"><span class="hs-identifier hs-type">RoughMatchLookupTc</span></a></span><span>
</span><span id="line-322"></span><span id="typeToRoughMatchLookupTc"><span class="annot"><span class="annottext">typeToRoughMatchLookupTc :: Type -&gt; RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#typeToRoughMatchLookupTc"><span class="hs-identifier hs-var hs-var">typeToRoughMatchLookupTc</span></a></span></span><span> </span><span id="local-6989586621681582643"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582643"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-comment">-- Expand synonyms first, as explained in Note [Rough matching in class and family instances].</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-comment">-- Failing to do so led to #22985.</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681582644"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582644"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582643"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#typeToRoughMatchLookupTc"><span class="hs-identifier hs-var">typeToRoughMatchLookupTc</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582644"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621681582647"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582647"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582643"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#typeToRoughMatchLookupTc"><span class="hs-identifier hs-var">typeToRoughMatchLookupTc</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582647"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [Type])
</span><a href="GHC.Core.Type.html#splitAppTys"><span class="hs-identifier hs-var">splitAppTys</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582643"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-331"></span><span>        </span><span class="hs-comment">-- Case 1: Head of application is a type variable, does not match any KnownTc.</span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_NoKnownTc"><span class="hs-identifier hs-var">RML_NoKnownTc</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681582651"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582651"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>          </span><span class="hs-comment">-- Case 2: Head of application is a known type constructor, hence KnownTc.</span><span>
</span><span id="line-336"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582651"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_KnownTc"><span class="hs-identifier hs-var">RML_KnownTc</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; RoughMatchLookupTc) -&gt; Name -&gt; RoughMatchLookupTc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.RoughMap.html#roughMatchTyConName"><span class="hs-identifier hs-var">roughMatchTyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582651"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-337"></span><span>          </span><span class="hs-comment">-- Case 3: Head is a type family so it's stuck and therefore doesn't match</span><span>
</span><span id="line-338"></span><span>          </span><span class="hs-comment">-- any KnownTc</span><span>
</span><span id="line-339"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582651"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_NoKnownTc"><span class="hs-identifier hs-var">RML_NoKnownTc</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-comment">-- Fallthrough: Otherwise, anything might match this position</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="annottext">(Type, [Type])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_WildCard"><span class="hs-identifier hs-var">RML_WildCard</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="GHC.Core.RoughMap.html#typeToRoughMatchTc"><span class="hs-identifier hs-type">typeToRoughMatchTc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span>
</span><span id="line-345"></span><span id="typeToRoughMatchTc"><span class="annot"><span class="annottext">typeToRoughMatchTc :: Type -&gt; RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#typeToRoughMatchTc"><span class="hs-identifier hs-var hs-var">typeToRoughMatchTc</span></a></span></span><span> </span><span id="local-6989586621681582656"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582656"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681582657"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582657"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KindCoercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, KindCoercion)
</span><a href="GHC.Core.Type.html#splitCastTy_maybe"><span class="hs-identifier hs-var">splitCastTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582656"><span class="hs-identifier hs-var">ty</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#typeToRoughMatchTc"><span class="hs-identifier hs-var">typeToRoughMatchTc</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582657"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681582659"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582659"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681582656"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582659"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-var">RM_KnownTc</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; RoughMatchTc) -&gt; Name -&gt; RoughMatchTc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.RoughMap.html#roughMatchTyConName"><span class="hs-identifier hs-var">roughMatchTyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582659"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-comment">-- See Note [Rough matching in class and family instances]</span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#RM_WildCard"><span class="hs-identifier hs-var">RM_WildCard</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><a href="GHC.Core.RoughMap.html#roughMatchTyConName"><span class="hs-identifier hs-type">roughMatchTyConName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-353"></span><span id="roughMatchTyConName"><span class="annot"><span class="annottext">roughMatchTyConName :: TyCon -&gt; Name
</span><a href="GHC.Core.RoughMap.html#roughMatchTyConName"><span class="hs-identifier hs-var hs-var">roughMatchTyConName</span></a></span></span><span> </span><span id="local-6989586621681582661"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582661"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582662"><span class="hs-identifier hs-var">tc_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#cONSTRAINTTyConName"><span class="hs-identifier hs-var">cONSTRAINTTyConName</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#tYPETyConName"><span class="hs-identifier hs-var">tYPETyConName</span></a></span><span>  </span><span class="hs-comment">-- TYPE and CONSTRAINT are not apart, so they must use</span><span>
</span><span id="line-356"></span><span>                   </span><span class="hs-comment">-- the same rough-map key. We arbitrarily use TYPE.</span><span>
</span><span id="line-357"></span><span>                   </span><span class="hs-comment">-- See Note [Type and Constraint are not apart]</span><span>
</span><span id="line-358"></span><span>                   </span><span class="hs-comment">-- wrinkle (W1) in GHC.Builtin.Types.Prim</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Name -&gt; Name
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Role -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isGenerativeTyCon"><span class="hs-identifier hs-var">isGenerativeTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582661"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582661"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582662"><span class="hs-identifier hs-var">tc_name</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621681582662"><span class="annot"><span class="annottext">tc_name :: Name
</span><a href="#local-6989586621681582662"><span class="hs-identifier hs-var hs-var">tc_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681582661"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- | Trie of @[RoughMatchTc]@</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- *Examples*</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- insert [OtherTc] 1</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- insert [OtherTc] 2</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- lookup [OtherTc] == [1,2]</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-373"></span><span class="hs-keyword">data</span><span> </span><span id="RoughMap"><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-var">RoughMap</span></a></span></span><span> </span><span id="local-6989586621681582327"><span class="annot"><a href="#local-6989586621681582327"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RMEmpty"><span class="annot"><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span></span><span> </span><span class="hs-comment">-- An optimised (finite) form of emptyRM</span><span>
</span><span id="line-375"></span><span>            </span><span class="hs-comment">-- Invariant: Empty RoughMaps are always represented with RMEmpty</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RM"><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-var">RM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="rm_empty"><span class="annot"><span class="annottext">forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var hs-var">rm_empty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582327"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-378"></span><span>           </span><span class="hs-comment">-- Keyed by an empty [RoughMapTc]</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="rm_known"><span class="annot"><span class="annottext">forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var hs-var">rm_known</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#DNameEnv"><span class="hs-identifier hs-type">DNameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>           </span><span class="hs-comment">-- Keyed by (RM_KnownTc tc : rm_tcs)</span><span>
</span><span id="line-382"></span><span>           </span><span class="hs-comment">-- DNameEnv: see Note [InstEnv determinism] in GHC.Core.InstEnv</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="rm_wild"><span class="annot"><span class="annottext">forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var hs-var">rm_wild</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582327"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>           </span><span class="hs-comment">-- Keyed by (RM_WildCard : rm_tcs)</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681582673"><span id="local-6989586621681582682"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; RoughMap a -&gt; RoughMap b)
-&gt; (forall a b. a -&gt; RoughMap b -&gt; RoughMap a) -&gt; Functor RoughMap
forall a b. a -&gt; RoughMap b -&gt; RoughMap a
forall a b. (a -&gt; b) -&gt; RoughMap a -&gt; RoughMap b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; RoughMap a -&gt; RoughMap b
fmap :: forall a b. (a -&gt; b) -&gt; RoughMap a -&gt; RoughMap b
$c&lt;$ :: forall a b. a -&gt; RoughMap b -&gt; RoughMap a
&lt;$ :: forall a b. a -&gt; RoughMap b -&gt; RoughMap a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#Functor/GHC.Base.html#Functor"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681582342"><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582342"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582342"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621681582708"><span class="annot"><span class="annottext">ppr :: RoughMap a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span id="local-6989586621681582709"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582709"><span class="hs-identifier hs-var">empty</span></a></span></span><span> </span><span id="local-6989586621681582710"><span class="annot"><span class="annottext">DNameEnv (RoughMap a)
</span><a href="#local-6989586621681582710"><span class="hs-identifier hs-var">known</span></a></span></span><span> </span><span id="local-6989586621681582711"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582711"><span class="hs-identifier hs-var">unknown</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>      </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RM&quot;</span></span><span>
</span><span id="line-391"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582709"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-392"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Known:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DNameEnv (RoughMap a) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DNameEnv (RoughMap a)
</span><a href="#local-6989586621681582710"><span class="hs-identifier hs-var">known</span></a></span><span>
</span><span id="line-393"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582711"><span class="hs-identifier hs-var">unknown</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{}&quot;</span></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span id="local-6989586621681582348"><span class="annot"><a href="GHC.Core.RoughMap.html#emptyRM"><span class="hs-identifier hs-type">emptyRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582348"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-397"></span><span id="emptyRM"><span class="annot"><span class="annottext">emptyRM :: forall a. RoughMap a
</span><a href="GHC.Core.RoughMap.html#emptyRM"><span class="hs-identifier hs-var hs-var">emptyRM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
forall a. RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="annot"><span class="hs-comment">-- | Order of result is deterministic.</span></span><span>
</span><span id="line-400"></span><span id="local-6989586621681582350"><span class="annot"><a href="GHC.Core.RoughMap.html#lookupRM"><span class="hs-identifier hs-type">lookupRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchLookupTc"><span class="hs-identifier hs-type">RoughMatchLookupTc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582350"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681582350"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-401"></span><span id="lookupRM"><span class="annot"><span class="annottext">lookupRM :: forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; [a]
</span><a href="GHC.Core.RoughMap.html#lookupRM"><span class="hs-identifier hs-var hs-var">lookupRM</span></a></span></span><span> </span><span id="local-6989586621681582714"><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582714"><span class="hs-identifier hs-var">tcs</span></a></span></span><span> </span><span id="local-6989586621681582715"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582715"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; [a]
forall a. Bag a -&gt; [a]
</span><a href="GHC.Data.Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bag a, [a]) -&gt; Bag a
forall a b. (a, b) -&gt; a
</span><a href="../../base-4.18.2.1/src/Data.Tuple.html#fst/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Bag a, [a]) -&gt; Bag a) -&gt; (Bag a, [a]) -&gt; Bag a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
</span><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582714"><span class="hs-identifier hs-var">tcs</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582715"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">-- | N.B. Returns a 'Bag' for matches, which allows us to avoid rebuilding all of the lists</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- we find in 'rm_empty', which would otherwise be necessary due to '++' if we</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- returned a list. We use a list for unifiers because the tail is computed lazily and</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- we often only care about the first couple of potential unifiers. Constructing a</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- bag forces the tail which performs much too much work.</span><span>
</span><span id="line-409"></span><span class="hs-comment">--</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- See Note [Matching a RoughMap]</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- See Note [Matches vs Unifiers]</span><span>
</span><span id="line-412"></span><span id="local-6989586621681582355"><span class="annot"><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-type">lookupRM'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchLookupTc"><span class="hs-identifier hs-type">RoughMatchLookupTc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582355"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582355"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- Potential matches</span><span>
</span><span id="line-413"></span><span>                                                   </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681582355"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span> </span><span class="hs-comment">-- Potential unifiers</span><span>
</span><span id="line-414"></span><span id="lookupRM%27"><span class="annot"><span class="annottext">lookupRM' :: forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
</span><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var hs-var">lookupRM'</span></a></span></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span>   </span><span class="hs-comment">-- The RoughMap is empty</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag a
forall a. Bag a
</span><a href="GHC.Data.Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="annot"><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681582719"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582719"><span class="hs-identifier hs-var">rm</span></a></span></span><span>       </span><span class="hs-comment">-- See Note [Simple Matching Semantics] about why</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Bag a
forall a. [a] -&gt; Bag a
</span><a href="GHC.Data.Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582721"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582721"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- we return everything when the lookup key runs out</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621681582721"><span class="annot"><span class="annottext">m :: [a]
</span><a href="#local-6989586621681582721"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; [a]
forall a. RoughMap a -&gt; [a]
</span><a href="GHC.Core.RoughMap.html#elemsRM"><span class="hs-identifier hs-var">elemsRM</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582719"><span class="hs-identifier hs-var">rm</span></a></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="annot"><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RML_KnownTc"><span class="hs-identifier hs-type">RML_KnownTc</span></a></span><span> </span><span id="local-6989586621681582722"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582722"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582723"><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582723"><span class="hs-identifier hs-var">tcs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681582724"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582724"><span class="hs-identifier hs-var">rm</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681582725"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582725"><span class="hs-identifier hs-var">common_m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681582726"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582726"><span class="hs-identifier hs-var">common_u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
</span><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582723"><span class="hs-identifier hs-var">tcs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582724"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681582727"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582727"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681582728"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582728"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bag a, [a])
-&gt; (RoughMap a -&gt; (Bag a, [a]))
-&gt; Maybe (RoughMap a)
-&gt; (Bag a, [a])
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Maybe.html#maybe/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag a
forall a. Bag a
</span><a href="GHC.Data.Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
</span><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582723"><span class="hs-identifier hs-var">tcs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DNameEnv (RoughMap a) -&gt; Name -&gt; Maybe (RoughMap a)
forall a. DNameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupDNameEnv"><span class="hs-identifier hs-var">lookupDNameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; DNameEnv (RoughMap a)
forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582724"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582722"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582724"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; Bag a -&gt; Bag a
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-operator hs-var">`unionBags`</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582725"><span class="hs-identifier hs-var">common_m</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; Bag a -&gt; Bag a
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-operator hs-var">`unionBags`</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582727"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-426"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; [a]
forall a. Bag a -&gt; [a]
</span><a href="GHC.Data.Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582724"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582726"><span class="hs-identifier hs-var">common_u</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582728"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- A RML_NoKnownTC does **not** match any KnownTC but can unify</span><span>
</span><span id="line-429"></span><span class="annot"><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_NoKnownTc"><span class="hs-identifier hs-var">RML_NoKnownTc</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582732"><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582732"><span class="hs-identifier hs-var">tcs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681582733"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582733"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681582734"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582734"><span class="hs-identifier hs-var">u_m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681582735"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582735"><span class="hs-identifier hs-var">_u_u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
</span><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582732"><span class="hs-identifier hs-var">tcs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582733"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582733"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; Bag a -&gt; Bag a
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-operator hs-var">`unionBags`</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582734"><span class="hs-identifier hs-var">u_m</span></a></span><span> </span><span class="hs-comment">-- Definitely don't match</span><span>
</span><span id="line-432"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Bag a, [a]) -&gt; [a]
forall a b. (a, b) -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Tuple.html#snd/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((Bag a, [a]) -&gt; [a]) -&gt; (Bag a, [a]) -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
</span><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_WildCard"><span class="hs-identifier hs-var">RML_WildCard</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMatchLookupTc -&gt; [RoughMatchLookupTc] -&gt; [RoughMatchLookupTc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582732"><span class="hs-identifier hs-var">tcs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582733"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- But could unify..</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="annot"><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMatchLookupTc
</span><a href="GHC.Core.RoughMap.html#RML_WildCard"><span class="hs-identifier hs-var">RML_WildCard</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582737"><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582737"><span class="hs-identifier hs-var">tcs</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621681582738"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582738"><span class="hs-identifier hs-var">rm</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-435"></span><span class="hs-comment">--  pprTrace &quot;RM wild&quot; (ppr tcs $$ ppr (eltsDNameEnv (rm_known rm))) $</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681582739"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582739"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681582740"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582740"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; (Bag a, [a]) -&gt; (Bag a, [a]))
-&gt; (Bag a, [a]) -&gt; DNameEnv (RoughMap a) -&gt; (Bag a, [a])
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DNameEnv a -&gt; b
</span><a href="GHC.Types.Name.Env.html#foldDNameEnv"><span class="hs-identifier hs-var">foldDNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; (Bag a, [a]) -&gt; (Bag a, [a])
forall a. RoughMap a -&gt; (Bag a, [a]) -&gt; (Bag a, [a])
</span><a href="#local-6989586621681582742"><span class="hs-identifier hs-var">add_one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag a
forall a. Bag a
</span><a href="GHC.Data.Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; DNameEnv (RoughMap a)
forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582738"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681582743"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582743"><span class="hs-identifier hs-var">u_m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681582744"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582744"><span class="hs-identifier hs-var">u_u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
</span><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582737"><span class="hs-identifier hs-var">tcs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582738"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582738"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; Bag a -&gt; Bag a
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-operator hs-var">`unionBags`</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582743"><span class="hs-identifier hs-var">u_m</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; Bag a -&gt; Bag a
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-operator hs-var">`unionBags`</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582739"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-439"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; [a]
forall a. Bag a -&gt; [a]
</span><a href="GHC.Data.Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582738"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582744"><span class="hs-identifier hs-var">u_u</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582740"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>     </span><span id="local-6989586621681582370"><span class="annot"><a href="#local-6989586621681582742"><span class="hs-identifier hs-type">add_one</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582370"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681582370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681582370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-442"></span><span>     </span><span id="local-6989586621681582742"><span class="annot"><span class="annottext">add_one :: forall a. RoughMap a -&gt; (Bag a, [a]) -&gt; (Bag a, [a])
</span><a href="#local-6989586621681582742"><span class="hs-identifier hs-var hs-var">add_one</span></a></span></span><span> </span><span id="local-6989586621681582745"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582745"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621681582746"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582746"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681582747"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582747"><span class="hs-identifier hs-var">u2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582748"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; Bag a -&gt; Bag a
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-operator hs-var">`unionBags`</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582746"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582749"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582747"><span class="hs-identifier hs-var">u2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>                          </span><span class="hs-keyword">where</span><span>
</span><span id="line-444"></span><span>                            </span><span class="hs-special">(</span><span id="local-6989586621681582748"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582748"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681582749"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681582749"><span class="hs-identifier hs-var">u1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
forall a. [RoughMatchLookupTc] -&gt; RoughMap a -&gt; (Bag a, [a])
</span><a href="GHC.Core.RoughMap.html#lookupRM%27"><span class="hs-identifier hs-var">lookupRM'</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchLookupTc]
</span><a href="#local-6989586621681582737"><span class="hs-identifier hs-var">tcs</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582745"><span class="hs-identifier hs-var">rm</span></a></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span id="local-6989586621681582372"><span class="annot"><a href="GHC.Core.RoughMap.html#unionRM"><span class="hs-identifier hs-type">unionRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582372"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582372"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582372"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-447"></span><span id="unionRM"><span class="annot"><span class="annottext">unionRM :: forall a. RoughMap a -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#unionRM"><span class="hs-identifier hs-var hs-var">unionRM</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span id="local-6989586621681582750"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582750"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582750"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-448"></span><span class="annot"><a href="GHC.Core.RoughMap.html#unionRM"><span class="hs-identifier hs-var">unionRM</span></a></span><span> </span><span id="local-6989586621681582751"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582751"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582751"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-449"></span><span class="annot"><a href="GHC.Core.RoughMap.html#unionRM"><span class="hs-identifier hs-var">unionRM</span></a></span><span> </span><span id="local-6989586621681582752"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582752"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681582753"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582753"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rm_empty :: Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582752"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; Bag a -&gt; Bag a
forall a. Bag a -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#unionBags"><span class="hs-operator hs-var">`unionBags`</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582753"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-451"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rm_known :: DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; RoughMap a -&gt; RoughMap a)
-&gt; DNameEnv (RoughMap a)
-&gt; DNameEnv (RoughMap a)
-&gt; DNameEnv (RoughMap a)
forall elt.
(elt -&gt; elt -&gt; elt) -&gt; DNameEnv elt -&gt; DNameEnv elt -&gt; DNameEnv elt
</span><a href="GHC.Types.Name.Env.html#plusDNameEnv_C"><span class="hs-identifier hs-var">plusDNameEnv_C</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#unionRM"><span class="hs-identifier hs-var">unionRM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; DNameEnv (RoughMap a)
forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582752"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; DNameEnv (RoughMap a)
forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582753"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rm_wild :: RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582752"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#unionRM"><span class="hs-operator hs-var">`unionRM`</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582753"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-453"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span id="local-6989586621681582375"><span class="annot"><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-type">insertRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582375"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582375"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582375"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-457"></span><span id="insertRM"><span class="annot"><span class="annottext">insertRM :: forall a. [RoughMatchTc] -&gt; a -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-var hs-var">insertRM</span></a></span></span><span> </span><span id="local-6989586621681582755"><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582755"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621681582756"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681582756"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">[RoughMatchTc] -&gt; a -&gt; RoughMap a -&gt; RoughMap a
forall a. [RoughMatchTc] -&gt; a -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-var">insertRM</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582755"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681582756"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; RoughMap a) -&gt; RoughMap a -&gt; RoughMap a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rm_empty :: Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag a
forall a. Bag a
</span><a href="GHC.Data.Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a></span><span>
</span><span id="line-459"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rm_known :: DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DNameEnv (RoughMap a)
forall a. DNameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyDNameEnv"><span class="hs-identifier hs-var">emptyDNameEnv</span></a></span><span>
</span><span id="line-460"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rm_wild :: RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
forall a. RoughMap a
</span><a href="GHC.Core.RoughMap.html#emptyRM"><span class="hs-identifier hs-var">emptyRM</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-461"></span><span class="annot"><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-var">insertRM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681582758"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681582758"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681582759"><span class="annot"><span class="annottext">rm :: RoughMap a
</span><a href="#local-6989586621681582759"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-comment">-- See Note [Simple Matching Semantics]</span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582759"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681582758"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#consBag"><span class="hs-operator hs-type">`consBag`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582759"><span class="hs-identifier hs-type">rm</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="annot"><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-var">insertRM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-type">RM_KnownTc</span></a></span><span> </span><span id="local-6989586621681582761"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582761"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582762"><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582762"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681582763"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681582763"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681582764"><span class="annot"><span class="annottext">rm :: RoughMap a
</span><a href="#local-6989586621681582764"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582764"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#alterDNameEnv"><span class="hs-identifier hs-type">alterDNameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582766"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582764"><span class="hs-identifier hs-type">rm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681582761"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621681582766"><span class="annot"><span class="annottext">f :: Maybe (RoughMap a) -&gt; Maybe (RoughMap a)
</span><a href="#local-6989586621681582766"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (RoughMap a)
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; Maybe (RoughMap a)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; Maybe (RoughMap a))
-&gt; RoughMap a -&gt; Maybe (RoughMap a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RoughMatchTc] -&gt; a -&gt; RoughMap a -&gt; RoughMap a
forall a. [RoughMatchTc] -&gt; a -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-var">insertRM</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582762"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681582763"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
forall a. RoughMap a
</span><a href="GHC.Core.RoughMap.html#emptyRM"><span class="hs-identifier hs-var">emptyRM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><a href="#local-6989586621681582766"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681582767"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582767"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; Maybe (RoughMap a)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; Maybe (RoughMap a))
-&gt; RoughMap a -&gt; Maybe (RoughMap a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RoughMatchTc] -&gt; a -&gt; RoughMap a -&gt; RoughMap a
forall a. [RoughMatchTc] -&gt; a -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-var">insertRM</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582762"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681582763"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582767"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="annot"><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-var">insertRM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#RM_WildCard"><span class="hs-identifier hs-var">RM_WildCard</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582768"><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582768"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681582769"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681582769"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681582770"><span class="annot"><span class="annottext">rm :: RoughMap a
</span><a href="#local-6989586621681582770"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582770"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#insertRM"><span class="hs-identifier hs-type">insertRM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582768"><span class="hs-identifier hs-type">ks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582769"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582770"><span class="hs-identifier hs-type">rm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span id="local-6989586621681582380"><span class="annot"><a href="GHC.Core.RoughMap.html#filterRM"><span class="hs-identifier hs-type">filterRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681582380"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582380"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582380"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-475"></span><span id="filterRM"><span class="annot"><span class="annottext">filterRM :: forall a. (a -&gt; Bool) -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterRM"><span class="hs-identifier hs-var hs-var">filterRM</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
forall a. RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span>
</span><span id="line-476"></span><span class="annot"><a href="GHC.Core.RoughMap.html#filterRM"><span class="hs-identifier hs-var">filterRM</span></a></span><span> </span><span id="local-6989586621681582771"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582771"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span id="local-6989586621681582772"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582772"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>    </span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; RoughMap a) -&gt; RoughMap a -&gt; RoughMap a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-478"></span><span>      </span><span class="annot"><span class="annottext">rm_empty :: Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Bag a -&gt; Bag a
forall a. (a -&gt; Bool) -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#filterBag"><span class="hs-identifier hs-var">filterBag</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582771"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582772"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-479"></span><span>      </span><span class="annot"><span class="annottext">rm_known :: DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; RoughMap a)
-&gt; DNameEnv (RoughMap a) -&gt; DNameEnv (RoughMap a)
forall a b. (a -&gt; b) -&gt; DNameEnv a -&gt; DNameEnv b
</span><a href="GHC.Types.Name.Env.html#mapDNameEnv"><span class="hs-identifier hs-var">mapDNameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; RoughMap a -&gt; RoughMap a
forall a. (a -&gt; Bool) -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterRM"><span class="hs-identifier hs-var">filterRM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582771"><span class="hs-identifier hs-var">pred</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; DNameEnv (RoughMap a)
forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582772"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-480"></span><span>      </span><span class="annot"><span class="annottext">rm_wild :: RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; RoughMap a -&gt; RoughMap a
forall a. (a -&gt; Bool) -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterRM"><span class="hs-identifier hs-var">filterRM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582771"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582772"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">-- | Place a 'RoughMap' in normal form, turning all empty 'RM's into</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- 'RMEmpty's. Necessary after removing items.</span><span>
</span><span id="line-485"></span><span id="local-6989586621681582776"><span class="annot"><a href="GHC.Core.RoughMap.html#normalise"><span class="hs-identifier hs-type">normalise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582776"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582776"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-486"></span><span id="normalise"><span class="annot"><span class="annottext">normalise :: forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#normalise"><span class="hs-identifier hs-var hs-var">normalise</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
forall a. RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span>
</span><span id="line-487"></span><span class="annot"><a href="GHC.Core.RoughMap.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span id="local-6989586621681582777"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582777"><span class="hs-identifier hs-var">empty</span></a></span></span><span> </span><span id="local-6989586621681582778"><span class="annot"><span class="annottext">DNameEnv (RoughMap a)
</span><a href="#local-6989586621681582778"><span class="hs-identifier hs-var">known</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bag a -&gt; Bool
forall a. Bag a -&gt; Bool
</span><a href="GHC.Data.Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a></span><span> </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582777"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DNameEnv (RoughMap a) -&gt; Bool
forall a. DNameEnv a -&gt; Bool
</span><a href="GHC.Types.Name.Env.html#isEmptyDNameEnv"><span class="hs-identifier hs-var">isEmptyDNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">DNameEnv (RoughMap a)
</span><a href="#local-6989586621681582778"><span class="hs-identifier hs-var">known</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
forall a. RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span>
</span><span id="line-490"></span><span class="annot"><a href="GHC.Core.RoughMap.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span id="local-6989586621681582781"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582781"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582781"><span class="hs-identifier hs-var">rm</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">-- | Filter all elements that might match a particular key with the given</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- predicate.</span><span>
</span><span id="line-494"></span><span id="local-6989586621681582388"><span class="annot"><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-type">filterMatchingRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681582388"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMatchTc"><span class="hs-identifier hs-type">RoughMatchTc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582388"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582388"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-495"></span><span id="filterMatchingRM"><span class="annot"><span class="annottext">filterMatchingRM :: forall a. (a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-var hs-var">filterMatchingRM</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a
forall a. RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span>
</span><span id="line-496"></span><span class="annot"><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-var">filterMatchingRM</span></a></span><span> </span><span id="local-6989586621681582786"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582786"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681582787"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582787"><span class="hs-identifier hs-var">rm</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; RoughMap a -&gt; RoughMap a
forall a. (a -&gt; Bool) -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterRM"><span class="hs-identifier hs-var">filterRM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582786"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582787"><span class="hs-identifier hs-var">rm</span></a></span><span>
</span><span id="line-497"></span><span class="annot"><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-var">filterMatchingRM</span></a></span><span> </span><span id="local-6989586621681582788"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582788"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM_KnownTc"><span class="hs-identifier hs-type">RM_KnownTc</span></a></span><span> </span><span id="local-6989586621681582789"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582789"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582790"><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582790"><span class="hs-identifier hs-var">tcs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681582791"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582791"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; RoughMap a) -&gt; RoughMap a -&gt; RoughMap a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-499"></span><span>      </span><span class="annot"><span class="annottext">rm_empty :: Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Bag a -&gt; Bag a
forall a. (a -&gt; Bool) -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#filterBag"><span class="hs-identifier hs-var">filterBag</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582788"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582791"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-500"></span><span>      </span><span class="annot"><span class="annottext">rm_known :: DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe (RoughMap a) -&gt; Maybe (RoughMap a))
-&gt; DNameEnv (RoughMap a) -&gt; Name -&gt; DNameEnv (RoughMap a)
forall a. (Maybe a -&gt; Maybe a) -&gt; DNameEnv a -&gt; Name -&gt; DNameEnv a
</span><a href="GHC.Types.Name.Env.html#alterDNameEnv"><span class="hs-identifier hs-var">alterDNameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Maybe (RoughMap a)) -&gt; Maybe (RoughMap a)
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#join/GHC.Base.html#join"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Maybe (RoughMap a)) -&gt; Maybe (RoughMap a))
-&gt; (Maybe (RoughMap a) -&gt; Maybe (Maybe (RoughMap a)))
-&gt; Maybe (RoughMap a)
-&gt; Maybe (RoughMap a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; Maybe (RoughMap a))
-&gt; Maybe (RoughMap a) -&gt; Maybe (Maybe (RoughMap a))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; Maybe (RoughMap a)
forall a. RoughMap a -&gt; Maybe (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#dropEmpty"><span class="hs-identifier hs-var">dropEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; Maybe (RoughMap a))
-&gt; (RoughMap a -&gt; RoughMap a) -&gt; RoughMap a -&gt; Maybe (RoughMap a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
forall a. (a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-var">filterMatchingRM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582788"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582790"><span class="hs-identifier hs-var">tcs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; DNameEnv (RoughMap a)
forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582791"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681582789"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-501"></span><span>      </span><span class="annot"><span class="annottext">rm_wild :: RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
forall a. (a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-var">filterMatchingRM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582788"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582790"><span class="hs-identifier hs-var">tcs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582791"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-503"></span><span class="annot"><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-var">filterMatchingRM</span></a></span><span> </span><span id="local-6989586621681582794"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582794"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMatchTc
</span><a href="GHC.Core.RoughMap.html#RM_WildCard"><span class="hs-identifier hs-var">RM_WildCard</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681582795"><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582795"><span class="hs-identifier hs-var">tcs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681582796"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582796"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; RoughMap a) -&gt; RoughMap a -&gt; RoughMap a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-505"></span><span>      </span><span class="annot"><span class="annottext">rm_empty :: Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Bag a -&gt; Bag a
forall a. (a -&gt; Bool) -&gt; Bag a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#filterBag"><span class="hs-identifier hs-var">filterBag</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582794"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582796"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-506"></span><span>      </span><span class="annot"><span class="annottext">rm_known :: DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RoughMap a -&gt; RoughMap a)
-&gt; DNameEnv (RoughMap a) -&gt; DNameEnv (RoughMap a)
forall a b. (a -&gt; b) -&gt; DNameEnv a -&gt; DNameEnv b
</span><a href="GHC.Types.Name.Env.html#mapDNameEnv"><span class="hs-identifier hs-var">mapDNameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
forall a. (a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-var">filterMatchingRM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582794"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582795"><span class="hs-identifier hs-var">tcs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; DNameEnv (RoughMap a)
forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582796"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-507"></span><span>      </span><span class="annot"><span class="annottext">rm_wild :: RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
forall a. (a -&gt; Bool) -&gt; [RoughMatchTc] -&gt; RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#filterMatchingRM"><span class="hs-identifier hs-var">filterMatchingRM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681582794"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">[RoughMatchTc]
</span><a href="#local-6989586621681582795"><span class="hs-identifier hs-var">tcs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582796"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span id="local-6989586621681582395"><span class="annot"><a href="GHC.Core.RoughMap.html#dropEmpty"><span class="hs-identifier hs-type">dropEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-511"></span><span id="dropEmpty"><span class="annot"><span class="annottext">dropEmpty :: forall a. RoughMap a -&gt; Maybe (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#dropEmpty"><span class="hs-identifier hs-var hs-var">dropEmpty</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (RoughMap a)
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-512"></span><span class="annot"><a href="GHC.Core.RoughMap.html#dropEmpty"><span class="hs-identifier hs-var">dropEmpty</span></a></span><span> </span><span id="local-6989586621681582797"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582797"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoughMap a -&gt; Maybe (RoughMap a)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582797"><span class="hs-identifier hs-var">rm</span></a></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span id="local-6989586621681582360"><span class="annot"><a href="GHC.Core.RoughMap.html#elemsRM"><span class="hs-identifier hs-type">elemsRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681582360"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-515"></span><span id="elemsRM"><span class="annot"><span class="annottext">elemsRM :: forall a. RoughMap a -&gt; [a]
</span><a href="GHC.Core.RoughMap.html#elemsRM"><span class="hs-identifier hs-var hs-var">elemsRM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; RoughMap a -&gt; [a]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; RoughMap a -&gt; b
</span><a href="GHC.Core.RoughMap.html#foldRM"><span class="hs-identifier hs-var">foldRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span id="local-6989586621681582398"><span id="local-6989586621681582399"><span class="annot"><a href="GHC.Core.RoughMap.html#foldRM"><span class="hs-identifier hs-type">foldRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681582398"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582399"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582399"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582399"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582398"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582399"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-518"></span><span id="foldRM"><span class="annot"><span class="annottext">foldRM :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; RoughMap a -&gt; b
</span><a href="GHC.Core.RoughMap.html#foldRM"><span class="hs-identifier hs-var hs-var">foldRM</span></a></span></span><span> </span><span id="local-6989586621681582800"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621681582800"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; RoughMap a -&gt; b
</span><a href="#local-6989586621681582801"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-520"></span><span>    </span><span class="hs-comment">-- N.B. local worker ensures that the loop can be specialised to the fold</span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-comment">-- function.</span><span>
</span><span id="line-522"></span><span>    </span><span id="local-6989586621681582801"><span class="annot"><span class="annottext">go :: b -&gt; RoughMap a -&gt; b
</span><a href="#local-6989586621681582801"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681582802"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681582802"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681582802"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-523"></span><span>    </span><span class="annot"><a href="#local-6989586621681582801"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681582803"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681582803"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rm_wild :: forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681582804"><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582804"><span class="hs-identifier hs-var">unk</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rm_known :: forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681582805"><span class="annot"><span class="annottext">DNameEnv (RoughMap a)
</span><a href="#local-6989586621681582805"><span class="hs-identifier hs-var">known</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rm_empty :: forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681582806"><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582806"><span class="hs-identifier hs-var">empty</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-524"></span><span>      </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; b -&gt; Bag a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Bag a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span>
</span><span id="line-525"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621681582800"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-526"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RoughMap a -&gt; b -&gt; b) -&gt; b -&gt; DNameEnv (RoughMap a) -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DNameEnv a -&gt; b
</span><a href="GHC.Types.Name.Env.html#foldDNameEnv"><span class="hs-identifier hs-var">foldDNameEnv</span></a></span><span>
</span><span id="line-527"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; RoughMap a -&gt; b) -&gt; RoughMap a -&gt; b -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#flip/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; RoughMap a -&gt; b
</span><a href="#local-6989586621681582801"><span class="hs-identifier hs-var">go</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; RoughMap a -&gt; b
</span><a href="#local-6989586621681582801"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681582803"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582804"><span class="hs-identifier hs-var">unk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>           </span><span class="annot"><span class="annottext">DNameEnv (RoughMap a)
</span><a href="#local-6989586621681582805"><span class="hs-identifier hs-var">known</span></a></span><span>
</span><span id="line-530"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>        </span><span class="annot"><span class="annottext">Bag a
</span><a href="#local-6989586621681582806"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span id="local-6989586621681582408"><span id="local-6989586621681582409"><span class="annot"><a href="GHC.Core.RoughMap.html#nonDetStrictFoldRM"><span class="hs-identifier hs-type">nonDetStrictFoldRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681582408"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582409"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582408"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582408"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582409"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681582408"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-534"></span><span id="nonDetStrictFoldRM"><span class="annot"><span class="annottext">nonDetStrictFoldRM :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; RoughMap a -&gt; b
</span><a href="GHC.Core.RoughMap.html#nonDetStrictFoldRM"><span class="hs-identifier hs-var hs-var">nonDetStrictFoldRM</span></a></span></span><span> </span><span id="local-6989586621681582811"><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621681582811"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; RoughMap a -&gt; b
</span><a href="#local-6989586621681582812"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-comment">-- N.B. local worker ensures that the loop can be specialised to the fold</span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-comment">-- function.</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621681582812"><span class="annot"><span class="annottext">go :: b -&gt; RoughMap a -&gt; b
</span><a href="#local-6989586621681582812"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681582813"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681582813"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="GHC.Core.RoughMap.html#RMEmpty"><span class="hs-identifier hs-var">RMEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681582813"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="annot"><a href="#local-6989586621681582812"><span class="hs-identifier hs-var">go</span></a></span><span>  </span><span id="local-6989586621681582814"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681582814"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621681582815"><span class="annot"><span class="annottext">rm :: RoughMap a
</span><a href="#local-6989586621681582815"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.RoughMap.html#RM"><span class="hs-identifier hs-type">RM</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-540"></span><span>      </span><span class="annot"><span class="annottext">(b -&gt; a -&gt; b) -&gt; b -&gt; Bag a -&gt; b
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Bag a -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#foldl%27/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span>
</span><span id="line-541"></span><span>        </span><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621681582811"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-542"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RoughMap a -&gt; b -&gt; b) -&gt; b -&gt; DNameEnv (RoughMap a) -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DNameEnv a -&gt; b
</span><a href="GHC.Types.Name.Env.html#nonDetStrictFoldDNameEnv"><span class="hs-identifier hs-var">nonDetStrictFoldDNameEnv</span></a></span><span>
</span><span id="line-543"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; RoughMap a -&gt; b) -&gt; RoughMap a -&gt; b -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#flip/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; RoughMap a -&gt; b
</span><a href="#local-6989586621681582812"><span class="hs-identifier hs-var">go</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; RoughMap a -&gt; b
</span><a href="#local-6989586621681582812"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681582814"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; RoughMap a
forall a. RoughMap a -&gt; RoughMap a
</span><a href="GHC.Core.RoughMap.html#rm_wild"><span class="hs-identifier hs-var">rm_wild</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582815"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; DNameEnv (RoughMap a)
forall a. RoughMap a -&gt; DNameEnv (RoughMap a)
</span><a href="GHC.Core.RoughMap.html#rm_known"><span class="hs-identifier hs-var">rm_known</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582815"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoughMap a -&gt; Bag a
forall a. RoughMap a -&gt; Bag a
</span><a href="GHC.Core.RoughMap.html#rm_empty"><span class="hs-identifier hs-var">rm_empty</span></a></span><span> </span><span class="annot"><span class="annottext">RoughMap a
</span><a href="#local-6989586621681582815"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span id="local-6989586621681582414"><span class="annot"><a href="GHC.Core.RoughMap.html#sizeRM"><span class="hs-identifier hs-type">sizeRM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.RoughMap.html#RoughMap"><span class="hs-identifier hs-type">RoughMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681582414"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-550"></span><span id="sizeRM"><span class="annot"><span class="annottext">sizeRM :: forall a. RoughMap a -&gt; Int
</span><a href="GHC.Core.RoughMap.html#sizeRM"><span class="hs-identifier hs-var hs-var">sizeRM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; Int) -&gt; Int -&gt; RoughMap a -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; RoughMap a -&gt; b
</span><a href="GHC.Core.RoughMap.html#nonDetStrictFoldRM"><span class="hs-identifier hs-var">nonDetStrictFoldRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681582822"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681582822"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681582822"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-551"></span></pre></body></html>