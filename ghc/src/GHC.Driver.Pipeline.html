<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NondecreasingIndentation #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- GHC Driver</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- (c) The University of Glasgow 2005</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Driver.Pipeline</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Run a series of compilation steps in a pipeline, for a</span></span><span>
</span><span id="line-23"></span><span>   </span><span class="hs-comment">-- collection of source files.</span><span>
</span><span id="line-24"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.html#oneShot"><span class="hs-identifier">oneShot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileFile"><span class="hs-identifier">compileFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Interfaces for the compilation manager (interpreted/batch-mode)</span></span><span>
</span><span id="line-27"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.html#preprocess"><span class="hs-identifier">preprocess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileOne"><span class="hs-identifier">compileOne</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileOne%27"><span class="hs-identifier">compileOne'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileForeign"><span class="hs-identifier">compileForeign</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileEmptyStub"><span class="hs-identifier">compileEmptyStub</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Linking</span></span><span>
</span><span id="line-32"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.html#link"><span class="hs-identifier">link</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#linkingNeeded"><span class="hs-identifier">linkingNeeded</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Linker.ExtraObj.html#checkLinkInfo"><span class="hs-identifier">checkLinkInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>   </span><span class="annot"><span class="hs-comment">-- * PipeEnv</span></span><span>
</span><span id="line-35"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier">PipeEnv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier">mkPipeEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Execute.html#phaseOutputFilenameNew"><span class="hs-identifier">phaseOutputFilenameNew</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Running individual phases</span></span><span>
</span><span id="line-38"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.Phases.html#TPhase"><span class="hs-identifier">TPhase</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Execute.html#runPhase"><span class="hs-identifier">runPhase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.Execute.html#hscPostBackendPhase"><span class="hs-identifier">hscPostBackendPhase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Constructing Pipelines</span></span><span>
</span><span id="line-42"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#TPipelineClass"><span class="hs-identifier">TPipelineClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#MonadUse"><span class="hs-identifier">MonadUse</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.html#preprocessPipeline"><span class="hs-identifier">preprocessPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#fullPipeline"><span class="hs-identifier">fullPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#hscPipeline"><span class="hs-identifier">hscPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#hscBackendPipeline"><span class="hs-identifier">hscBackendPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#hscPostBackendPipeline"><span class="hs-identifier">hscPostBackendPipeline</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.html#hscGenBackendPipeline"><span class="hs-identifier">hscGenBackendPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#asPipeline"><span class="hs-identifier">asPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier">viaCPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#cmmCppPipeline"><span class="hs-identifier">cmmCppPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#cmmPipeline"><span class="hs-identifier">cmmPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#jsPipeline"><span class="hs-identifier">jsPipeline</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.html#llvmPipeline"><span class="hs-identifier">llvmPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#llvmLlcPipeline"><span class="hs-identifier">llvmLlcPipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#llvmManglePipeline"><span class="hs-identifier">llvmManglePipeline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#pipelineStart"><span class="hs-identifier">pipelineStart</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Default method of running a pipeline</span></span><span>
</span><span id="line-49"></span><span>   </span><span class="annot"><a href="GHC.Driver.Pipeline.Execute.html#runPipeline"><span class="hs-identifier">runPipeline</span></a></span><span>
</span><span id="line-50"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html"><span class="hs-identifier">GHC.Utils.Monad</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#MonadIO/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier">MonadIO</span></a></span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html#mapMaybeM"><span class="hs-identifier">mapMaybeM</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Main.html"><span class="hs-identifier">GHC.Driver.Main</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html"><span class="hs-identifier">GHC.Driver.Env</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#Hsc"><span class="hs-identifier">Hsc</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.html"><span class="hs-identifier">GHC.Driver.Errors</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Types.html"><span class="hs-identifier">GHC.Driver.Errors.Types</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html"><span class="hs-identifier">GHC.Driver.Pipeline.Monad</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Diagnostic.html"><span class="hs-identifier">GHC.Driver.Config.Diagnostic</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Config.StgToJS.html"><span class="hs-identifier">GHC.Driver.Config.StgToJS</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html"><span class="hs-identifier">GHC.Driver.Phases</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Execute.html"><span class="hs-identifier">GHC.Driver.Pipeline.Execute</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Phases.html"><span class="hs-identifier">GHC.Driver.Pipeline.Phases</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Backend.html"><span class="hs-identifier">GHC.Driver.Backend</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Ppr.html"><span class="hs-identifier">GHC.Driver.Ppr</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Hooks.html"><span class="hs-identifier">GHC.Driver.Hooks</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Ways.html"><span class="hs-identifier">GHC.Platform.Ways</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.SysTools.html"><span class="hs-identifier">GHC.SysTools</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.SysTools.Cpp.html"><span class="hs-identifier">GHC.SysTools.Cpp</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.TmpFs.html"><span class="hs-identifier">GHC.Utils.TmpFs</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.ExtraObj.html"><span class="hs-identifier">GHC.Linker.ExtraObj</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.Static.html"><span class="hs-identifier">GHC.Linker.Static</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.Static.Utils.html"><span class="hs-identifier">GHC.Linker.Static.Utils</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.Types.html"><span class="hs-identifier">GHC.Linker.Types</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Linker.Linker.html"><span class="hs-identifier">GHC.StgToJS.Linker.Linker</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToJS.Linker.Types.html"><span class="hs-identifier">GHC.StgToJS.Linker.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.StgToJS.Linker.Types.html#defaultJSLinkConfig"><span class="hs-identifier">defaultJSLinkConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Exception.html"><span class="hs-identifier">GHC.Utils.Exception</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Exception</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html"><span class="hs-identifier">GHC.Utils.Logger</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../ghc-boot-9.6.6/src/GHC.LanguageExtensions.html#/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC.LanguageExtensions</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LangExt</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier">mkFastString</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html"><span class="hs-identifier">GHC.Data.StringBuffer</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html#hPutStringBuffer"><span class="hs-identifier">hPutStringBuffer</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier">expectJust</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Iface.Make.html"><span class="hs-identifier">GHC.Iface.Make</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Iface.Make.html#mkFullIface"><span class="hs-identifier">mkFullIface</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Loader.html"><span class="hs-identifier">GHC.Runtime.Loader</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Runtime.Loader.html#initializePlugins"><span class="hs-identifier">initializePlugins</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#SuccessFlag"><span class="hs-identifier">SuccessFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ForeignSrcLang</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Error.html"><span class="hs-identifier">GHC.Types.Error</span></a></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#singleMessage"><span class="hs-identifier">singleMessage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#getMessages"><span class="hs-identifier">getMessages</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#UnknownDiagnostic"><span class="hs-identifier">UnknownDiagnostic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Target.html"><span class="hs-identifier">GHC.Types.Target</span></a></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html"><span class="hs-identifier">GHC.Types.SourceFile</span></a></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceError.html"><span class="hs-identifier">GHC.Types.SourceError</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.html"><span class="hs-identifier">GHC.Unit</span></a></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html"><span class="hs-identifier">GHC.Unit.Env</span></a></span><span>
</span><span id="line-114"></span><span class="hs-comment">--import GHC.Unit.Finder</span><span>
</span><span id="line-115"></span><span class="hs-comment">--import GHC.Unit.State</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModSummary.html"><span class="hs-identifier">GHC.Unit.Module.ModSummary</span></a></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html"><span class="hs-identifier">GHC.Unit.Module.ModIface</span></a></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Deps.html"><span class="hs-identifier">GHC.Unit.Module.Deps</span></a></span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html"><span class="hs-identifier">GHC.Unit.Home.ModInfo</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../directory-1.3.8.5/src/System.Directory.html#/System.Directory.html"><span class="hs-identifier">System.Directory</span></a></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../template-haskell-2.20.0.0/src/System.FilePath.html#/System.FilePath.html"><span class="hs-identifier">System.FilePath</span></a></span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.IO.html#/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../exceptions-0.10.7/src/Control.Monad.Catch.html#/Control.Monad.Catch.html"><span class="hs-identifier">Control.Monad.Catch</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../exceptions-0.10.7/src/Control.Monad.Catch.html#handle/Control.Monad.Catch.html#handle"><span class="hs-identifier">handle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Maybe.html#/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Either.html#/Data.Either.html"><span class="hs-identifier">Data.Either</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Either.html#partitionEithers/Data.Either.html#partitionEithers"><span class="hs-identifier">partitionEithers</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.6.7/src/Data.Set.html#/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../time-1.12.2/src/Data.Time.html#/Data.Time.html"><span class="hs-identifier">Data.Time</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../time-1.12.2/src/Data.Time.Clock.POSIX.html#getCurrentTime/Data.Time.Clock.POSIX.html#getCurrentTime"><span class="hs-identifier">getCurrentTime</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Iface.Recomp.html"><span class="hs-identifier">GHC.Iface.Recomp</span></a></span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSet.html"><span class="hs-identifier">GHC.Types.Unique.DSet</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- Simpler type synonym for actions in the pipeline monad</span><span>
</span><span id="line-135"></span><span class="hs-keyword">type</span><span> </span><span id="P"><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-var">P</span></a></span></span><span> </span><span id="local-6989586621682084740"><span class="annot"><a href="#local-6989586621682084740"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#TPipelineClass"><span class="hs-identifier hs-type">TPipelineClass</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Phases.html#TPhase"><span class="hs-identifier hs-type">TPhase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084740"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- Pre-process</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Just preprocess a file, put the result in a temp. file (used by the</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- compilation manager during the summary phase).</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- We return the augmented DynFlags, because they contain the result</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- of slurping in the OPTIONS pragmas</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#preprocess"><span class="hs-identifier hs-type">preprocess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-147"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ input filename</span></span><span>
</span><span id="line-148"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Target.html#InputFileBuffer"><span class="hs-identifier hs-type">InputFileBuffer</span></a></span><span>
</span><span id="line-149"></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ optional buffer to use instead of reading the input file</span></span><span>
</span><span id="line-150"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ starting phase</span></span><span>
</span><span id="line-151"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Either.html#Either/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Types.html#DriverMessages"><span class="hs-identifier hs-type">DriverMessages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span id="preprocess"><span class="annot"><span class="annottext">preprocess :: HscEnv
-&gt; FilePath
-&gt; Maybe InputFileBuffer
-&gt; Maybe Phase
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
</span><a href="GHC.Driver.Pipeline.html#preprocess"><span class="hs-identifier hs-var hs-var">preprocess</span></a></span></span><span> </span><span id="local-6989586621682084741"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084741"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682084742"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084742"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span id="local-6989586621682084743"><span class="annot"><span class="annottext">Maybe InputFileBuffer
</span><a href="#local-6989586621682084743"><span class="hs-identifier hs-var">mb_input_buf</span></a></span></span><span> </span><span id="local-6989586621682084744"><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682084744"><span class="hs-identifier hs-var">mb_phase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="annottext">(SourceError -&gt; IO (Either DriverMessages (DynFlags, FilePath)))
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall (m :: * -&gt; *) a.
MonadCatch m =&gt;
(SourceError -&gt; m a) -&gt; m a -&gt; m a
</span><a href="GHC.Types.SourceError.html#handleSourceError"><span class="hs-identifier hs-var">handleSourceError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682084746"><span class="annot"><span class="annottext">SourceError
</span><a href="#local-6989586621682084746"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either DriverMessages (DynFlags, FilePath)
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Either DriverMessages (DynFlags, FilePath)
 -&gt; IO (Either DriverMessages (DynFlags, FilePath)))
-&gt; Either DriverMessages (DynFlags, FilePath)
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DriverMessages -&gt; Either DriverMessages (DynFlags, FilePath)
forall a b. a -&gt; Either a b
</span><a href="../../base-4.18.2.1/src/Data.Either.html#Left/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(DriverMessages -&gt; Either DriverMessages (DynFlags, FilePath))
-&gt; DriverMessages -&gt; Either DriverMessages (DynFlags, FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Messages GhcMessage -&gt; DriverMessages
</span><a href="#local-6989586621682084747"><span class="hs-identifier hs-var">to_driver_messages</span></a></span><span> </span><span class="annot"><span class="annottext">(Messages GhcMessage -&gt; DriverMessages)
-&gt; Messages GhcMessage -&gt; DriverMessages
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SourceError -&gt; Messages GhcMessage
</span><a href="GHC.Types.SourceError.html#srcErrorMessages"><span class="hs-identifier hs-var">srcErrorMessages</span></a></span><span> </span><span class="annot"><span class="annottext">SourceError
</span><a href="#local-6989586621682084746"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO (Either DriverMessages (DynFlags, FilePath))
 -&gt; IO (Either DriverMessages (DynFlags, FilePath)))
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><span class="annottext">(GhcException -&gt; IO (Either DriverMessages (DynFlags, FilePath)))
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall (m :: * -&gt; *) e a.
(HasCallStack, MonadCatch m, Exception e) =&gt;
(e -&gt; m a) -&gt; m a -&gt; m a
</span><a href="../../exceptions-0.10.7/src/Control.Monad.Catch.html#handle/Control.Monad.Catch.html#handle"><span class="hs-identifier hs-var">MC.handle</span></a></span><span> </span><span class="annot"><span class="annottext">GhcException -&gt; IO (Either DriverMessages (DynFlags, FilePath))
</span><a href="#local-6989586621682084749"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either DriverMessages (DynFlags, FilePath))
 -&gt; IO (Either DriverMessages (DynFlags, FilePath)))
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="annottext">((DynFlags, FilePath)
 -&gt; Either DriverMessages (DynFlags, FilePath))
-&gt; IO (DynFlags, FilePath)
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(DynFlags, FilePath) -&gt; Either DriverMessages (DynFlags, FilePath)
forall a b. b -&gt; Either a b
</span><a href="../../base-4.18.2.1/src/Data.Either.html#Right/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (DynFlags, FilePath)
 -&gt; IO (Either DriverMessages (DynFlags, FilePath)))
-&gt; IO (DynFlags, FilePath)
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; IO ()
forall (m :: * -&gt; *).
(HasCallStack, Applicative m) =&gt;
Bool -&gt; SDoc -&gt; m ()
</span><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-var">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Phase -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Maybe.html#isJust/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682084744"><span class="hs-identifier hs-var">mb_phase</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="GHC.Driver.Phases.html#isHaskellSrcFilename"><span class="hs-identifier hs-var">isHaskellSrcFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084742"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084742"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621682084755"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084755"><span class="hs-identifier hs-var">input_fn_final</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="#local-6989586621682084756"><span class="hs-identifier hs-var">mkInputFn</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084757"><span class="annot"><span class="annottext">preprocess_pipeline :: HookedUse (DynFlags, FilePath)
</span><a href="#local-6989586621682084757"><span class="hs-identifier hs-var hs-var">preprocess_pipeline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; HookedUse (DynFlags, FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (DynFlags, FilePath)
</span><a href="GHC.Driver.Pipeline.html#preprocessPipeline"><span class="hs-identifier hs-var">preprocessPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682084758"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Pipeline.html#setDumpPrefix"><span class="hs-identifier hs-var">setDumpPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682084758"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084741"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084755"><span class="hs-identifier hs-var">input_fn_final</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="annottext">Hooks -&gt; HookedUse (DynFlags, FilePath) -&gt; IO (DynFlags, FilePath)
forall a. Hooks -&gt; HookedUse a -&gt; IO a
</span><a href="GHC.Driver.Pipeline.Execute.html#runPipeline"><span class="hs-identifier hs-var">runPipeline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Hooks
</span><a href="GHC.Driver.Env.Types.html#hsc_hooks"><span class="hs-identifier hs-var">hsc_hooks</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084741"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HookedUse (DynFlags, FilePath)
</span><a href="#local-6989586621682084757"><span class="hs-identifier hs-var">preprocess_pipeline</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621682084761"><span class="annot"><span class="annottext">srcspan :: SrcSpan
</span><a href="#local-6989586621682084761"><span class="hs-identifier hs-var hs-var">srcspan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcLoc -&gt; SrcSpan
</span><a href="GHC.Types.SrcLoc.html#srcLocSpan"><span class="hs-identifier hs-var">srcLocSpan</span></a></span><span> </span><span class="annot"><span class="annottext">(SrcLoc -&gt; SrcSpan) -&gt; SrcLoc -&gt; SrcSpan
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Int -&gt; Int -&gt; SrcLoc
</span><a href="GHC.Types.SrcLoc.html#mkSrcLoc"><span class="hs-identifier hs-var">mkSrcLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084742"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621682084749"><span class="annot"><span class="annottext">handler :: GhcException -&gt; IO (Either DriverMessages (DynFlags, FilePath))
</span><a href="#local-6989586621682084749"><span class="hs-identifier hs-var hs-var">handler</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Panic.html#ProgramError"><span class="hs-identifier hs-type">ProgramError</span></a></span><span> </span><span id="local-6989586621682084765"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084765"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">Either DriverMessages (DynFlags, FilePath)
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Either DriverMessages (DynFlags, FilePath)
 -&gt; IO (Either DriverMessages (DynFlags, FilePath)))
-&gt; Either DriverMessages (DynFlags, FilePath)
-&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DriverMessages -&gt; Either DriverMessages (DynFlags, FilePath)
forall a b. a -&gt; Either a b
</span><a href="../../base-4.18.2.1/src/Data.Either.html#Left/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(DriverMessages -&gt; Either DriverMessages (DynFlags, FilePath))
-&gt; DriverMessages -&gt; Either DriverMessages (DynFlags, FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DriverMessage -&gt; DriverMessages
forall e. MsgEnvelope e -&gt; Messages e
</span><a href="GHC.Types.Error.html#singleMessage"><span class="hs-identifier hs-var">singleMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(MsgEnvelope DriverMessage -&gt; DriverMessages)
-&gt; MsgEnvelope DriverMessage -&gt; DriverMessages
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">SrcSpan -&gt; DriverMessage -&gt; MsgEnvelope DriverMessage
forall e. Diagnostic e =&gt; SrcSpan -&gt; e -&gt; MsgEnvelope e
</span><a href="GHC.Utils.Error.html#mkPlainErrorMsgEnvelope"><span class="hs-identifier hs-var">mkPlainErrorMsgEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682084761"><span class="hs-identifier hs-var">srcspan</span></a></span><span> </span><span class="annot"><span class="annottext">(DriverMessage -&gt; MsgEnvelope DriverMessage)
-&gt; DriverMessage -&gt; MsgEnvelope DriverMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">UnknownDiagnostic -&gt; DriverMessage
</span><a href="GHC.Driver.Errors.Types.html#DriverUnknownMessage"><span class="hs-identifier hs-var">DriverUnknownMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(UnknownDiagnostic -&gt; DriverMessage)
-&gt; UnknownDiagnostic -&gt; DriverMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticMessage -&gt; UnknownDiagnostic
forall a.
(DiagnosticOpts a ~ NoDiagnosticOpts, Diagnostic a, Typeable a) =&gt;
a -&gt; UnknownDiagnostic
</span><a href="GHC.Types.Error.html#UnknownDiagnostic"><span class="hs-identifier hs-var">UnknownDiagnostic</span></a></span><span> </span><span class="annot"><span class="annottext">(DiagnosticMessage -&gt; UnknownDiagnostic)
-&gt; DiagnosticMessage -&gt; UnknownDiagnostic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[GhcHint] -&gt; SDoc -&gt; DiagnosticMessage
</span><a href="GHC.Types.Error.html#mkPlainError"><span class="hs-identifier hs-var">mkPlainError</span></a></span><span> </span><span class="annot"><span class="annottext">[GhcHint]
</span><a href="GHC.Types.Error.html#noHints"><span class="hs-identifier hs-var">noHints</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; DiagnosticMessage) -&gt; SDoc -&gt; DiagnosticMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084765"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><a href="#local-6989586621682084749"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span id="local-6989586621682084771"><span class="annot"><span class="annottext">GhcException
</span><a href="#local-6989586621682084771"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GhcException -&gt; IO (Either DriverMessages (DynFlags, FilePath))
forall a. GhcException -&gt; IO a
</span><a href="GHC.Utils.Panic.html#throwGhcExceptionIO"><span class="hs-identifier hs-var">throwGhcExceptionIO</span></a></span><span> </span><span class="annot"><span class="annottext">GhcException
</span><a href="#local-6989586621682084771"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="#local-6989586621682084747"><span class="hs-identifier hs-type">to_driver_messages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#Messages"><span class="hs-identifier hs-type">Messages</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Types.html#GhcMessage"><span class="hs-identifier hs-type">GhcMessage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#Messages"><span class="hs-identifier hs-type">Messages</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Types.html#DriverMessage"><span class="hs-identifier hs-type">DriverMessage</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621682084747"><span class="annot"><span class="annottext">to_driver_messages :: Messages GhcMessage -&gt; DriverMessages
</span><a href="#local-6989586621682084747"><span class="hs-identifier hs-var hs-var">to_driver_messages</span></a></span></span><span> </span><span id="local-6989586621682084773"><span class="annot"><span class="annottext">Messages GhcMessage
</span><a href="#local-6989586621682084773"><span class="hs-identifier hs-var">msgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(GhcMessage -&gt; Maybe DriverMessage)
-&gt; Messages GhcMessage -&gt; Maybe DriverMessages
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Messages a -&gt; f (Messages b)
</span><a href="../../base-4.18.2.1/src/Data.Traversable.html#traverse/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">GhcMessage -&gt; Maybe DriverMessage
</span><a href="#local-6989586621682084775"><span class="hs-identifier hs-var">to_driver_message</span></a></span><span> </span><span class="annot"><span class="annottext">Messages GhcMessage
</span><a href="#local-6989586621682084773"><span class="hs-identifier hs-var">msgs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">Maybe DriverMessages
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc -&gt; DriverMessages
forall a. HasCallStack =&gt; FilePath -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;non-driver message in preprocess&quot;</span></span><span>
</span><span id="line-172"></span><span>                             </span><span class="hs-comment">-- MP: Default config is fine here as it's just in a panic.</span><span>
</span><span id="line-173"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticOpts GhcMessage -&gt; Bag (MsgEnvelope GhcMessage) -&gt; [SDoc]
forall e.
Diagnostic e =&gt;
DiagnosticOpts e -&gt; Bag (MsgEnvelope e) -&gt; [SDoc]
</span><a href="GHC.Utils.Error.html#pprMsgEnvelopeBagWithLoc"><span class="hs-identifier hs-var">pprMsgEnvelopeBagWithLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Diagnostic a =&gt; DiagnosticOpts a
</span><a href="GHC.Types.Error.html#defaultDiagnosticOpts"><span class="hs-identifier hs-var">defaultDiagnosticOpts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Driver.Errors.Types.html#GhcMessage"><span class="hs-identifier hs-type">GhcMessage</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Messages GhcMessage -&gt; Bag (MsgEnvelope GhcMessage)
forall e. Messages e -&gt; Bag (MsgEnvelope e)
</span><a href="GHC.Types.Error.html#getMessages"><span class="hs-identifier hs-var">getMessages</span></a></span><span> </span><span class="annot"><span class="annottext">Messages GhcMessage
</span><a href="#local-6989586621682084773"><span class="hs-identifier hs-var">msgs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682084780"><span class="annot"><span class="annottext">DriverMessages
</span><a href="#local-6989586621682084780"><span class="hs-identifier hs-var">msgs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DriverMessages
</span><a href="#local-6989586621682084780"><span class="hs-identifier hs-var">msgs'</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621682084775"><span class="annot"><span class="annottext">to_driver_message :: GhcMessage -&gt; Maybe DriverMessage
</span><a href="#local-6989586621682084775"><span class="hs-identifier hs-var hs-var">to_driver_message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><a href="GHC.Driver.Errors.Types.html#GhcDriverMessage"><span class="hs-identifier hs-type">GhcDriverMessage</span></a></span><span> </span><span id="local-6989586621682084782"><span class="annot"><span class="annottext">DriverMessage
</span><a href="#local-6989586621682084782"><span class="hs-identifier hs-var">msg</span></a></span></span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DriverMessage -&gt; Maybe DriverMessage
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">DriverMessage
</span><a href="#local-6989586621682084782"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><a href="GHC.Driver.Errors.Types.html#GhcPsMessage"><span class="hs-identifier hs-type">GhcPsMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Errors.Types.html#PsHeaderMessage"><span class="hs-identifier hs-type">PsHeaderMessage</span></a></span><span> </span><span id="local-6989586621682084785"><span class="annot"><span class="annottext">PsHeaderMessage
</span><a href="#local-6989586621682084785"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DriverMessage -&gt; Maybe DriverMessage
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PsMessage -&gt; DriverMessage
</span><a href="GHC.Driver.Errors.Types.html#DriverPsHeaderMessage"><span class="hs-identifier hs-var">DriverPsHeaderMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PsHeaderMessage -&gt; PsMessage
</span><a href="GHC.Parser.Errors.Types.html#PsHeaderMessage"><span class="hs-identifier hs-var">PsHeaderMessage</span></a></span><span> </span><span class="annot"><span class="annottext">PsHeaderMessage
</span><a href="#local-6989586621682084785"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">GhcMessage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DriverMessage
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621682084758"><span class="annot"><span class="annottext">pipe_env :: PipeEnv
</span><a href="#local-6989586621682084758"><span class="hs-identifier hs-var hs-var">pipe_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StopPhase -&gt; FilePath -&gt; Maybe Phase -&gt; PipelineOutput -&gt; PipeEnv
</span><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier hs-var">mkPipeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#StopPreprocess"><span class="hs-identifier hs-var">StopPreprocess</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084742"><span class="hs-identifier hs-var">input_fn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682084744"><span class="hs-identifier hs-var">mb_phase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TempFileLifetime -&gt; PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#Temporary"><span class="hs-identifier hs-var">Temporary</span></a></span><span> </span><span class="annot"><span class="annottext">TempFileLifetime
</span><a href="GHC.Utils.TmpFs.html#TFL_GhcSession"><span class="hs-identifier hs-var">TFL_GhcSession</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621682084756"><span class="annot"><span class="annottext">mkInputFn :: IO FilePath
</span><a href="#local-6989586621682084756"><span class="hs-identifier hs-var hs-var">mkInputFn</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe InputFileBuffer
</span><a href="#local-6989586621682084743"><span class="hs-identifier hs-var">mb_input_buf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682084790"><span class="annot"><span class="annottext">InputFileBuffer
</span><a href="#local-6989586621682084790"><span class="hs-identifier hs-var">input_buf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-187"></span><span>          </span><span id="local-6989586621682084791"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084791"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; TmpFs -&gt; TempDir -&gt; TempFileLifetime -&gt; FilePath -&gt; IO FilePath
</span><a href="GHC.Utils.TmpFs.html#newTempName"><span class="hs-identifier hs-var">newTempName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084741"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; TmpFs
</span><a href="GHC.Driver.Env.Types.html#hsc_tmpfs"><span class="hs-identifier hs-var">hsc_tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084741"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; TempDir
</span><a href="GHC.Driver.Session.html#tmpDir"><span class="hs-identifier hs-var">tmpDir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084741"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                            </span><span class="annot"><span class="annottext">TempFileLifetime
</span><a href="GHC.Utils.TmpFs.html#TFL_CurrentModule"><span class="hs-identifier hs-var">TFL_CurrentModule</span></a></span><span>
</span><span id="line-191"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;buf_&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; FilePath
</span><a href="GHC.Driver.Pipeline.Monad.html#src_suffix"><span class="hs-identifier hs-var">src_suffix</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682084758"><span class="hs-identifier hs-var">pipe_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>          </span><span id="local-6989586621682084799"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682084799"><span class="hs-identifier hs-var">hdl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IOMode -&gt; IO Handle
</span><a href="../../base-4.18.2.1/src/GHC.IO.StdHandles.html#openBinaryFile/GHC.IO.StdHandles.html#openBinaryFile"><span class="hs-identifier hs-var">openBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084791"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.18.2.1/src/GHC.IO.IOMode.html#WriteMode/GHC.IO.IOMode.html#WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a></span><span>
</span><span id="line-193"></span><span>          </span><span class="hs-comment">-- Add a LINE pragma so reported source locations will</span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-comment">-- mention the real input file, not this temp file.</span><span>
</span><span id="line-195"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; IO ()
</span><a href="../../base-4.18.2.1/src/GHC.IO.Handle.Text.html#hPutStrLn/GHC.IO.Handle.Text.html#hPutStrLn"><span class="hs-identifier hs-var">hPutStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682084799"><span class="hs-identifier hs-var">hdl</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;{-# LINE 1 \&quot;&quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084742"><span class="hs-identifier hs-var">input_fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\&quot;#-}&quot;</span></span><span>
</span><span id="line-196"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; InputFileBuffer -&gt; IO ()
</span><a href="GHC.Data.StringBuffer.html#hPutStringBuffer"><span class="hs-identifier hs-var">hPutStringBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682084799"><span class="hs-identifier hs-var">hdl</span></a></span><span> </span><span class="annot"><span class="annottext">InputFileBuffer
</span><a href="#local-6989586621682084790"><span class="hs-identifier hs-var">input_buf</span></a></span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="../../base-4.18.2.1/src/GHC.IO.Handle.html#hClose/GHC.IO.Handle.html#hClose"><span class="hs-identifier hs-var">hClose</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682084799"><span class="hs-identifier hs-var">hdl</span></a></span><span>
</span><span id="line-198"></span><span>          </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084791"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">Maybe InputFileBuffer
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084742"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Compile</span><span>
</span><span id="line-204"></span><span class="hs-comment">--</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- Compile a single module, under the control of the compilation manager.</span><span>
</span><span id="line-206"></span><span class="hs-comment">--</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- This is the interface between the compilation manager and the</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- compiler proper (hsc), where we deal with tedious details like</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- reading the OPTIONS pragma from the source file, converting the</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- C or assembly that GHC produces into an object file, and compiling</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- FFI stub files.</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- NB.  No old interface can also mean that the source has changed.</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileOne"><span class="hs-identifier hs-type">compileOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-217"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModSummary.html#ModSummary"><span class="hs-identifier hs-type">ModSummary</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ summary for module being compiled</span></span><span>
</span><span id="line-218"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ module N ...</span></span><span>
</span><span id="line-219"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ ... of M</span></span><span>
</span><span id="line-220"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ old interface, if we have one</span></span><span>
</span><span id="line-221"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomeModLinkable"><span class="hs-identifier hs-type">HomeModLinkable</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ old linkable, if we have one</span></span><span>
</span><span id="line-222"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomeModInfo"><span class="hs-identifier hs-type">HomeModInfo</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ the complete HomeModInfo, if successful</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span id="compileOne"><span class="annot"><span class="annottext">compileOne :: HscEnv
-&gt; ModSummary
-&gt; Int
-&gt; Int
-&gt; Maybe ModIface
-&gt; HomeModLinkable
-&gt; IO HomeModInfo
</span><a href="GHC.Driver.Pipeline.html#compileOne"><span class="hs-identifier hs-var hs-var">compileOne</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Messager
-&gt; HscEnv
-&gt; ModSummary
-&gt; Int
-&gt; Int
-&gt; Maybe ModIface
-&gt; HomeModLinkable
-&gt; IO HomeModInfo
</span><a href="GHC.Driver.Pipeline.html#compileOne%27"><span class="hs-identifier hs-var">compileOne'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Messager -&gt; Maybe Messager
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Messager
</span><a href="GHC.Driver.Main.html#batchMsg"><span class="hs-identifier hs-var">batchMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileOne%27"><span class="hs-identifier hs-type">compileOne'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Main.html#Messager"><span class="hs-identifier hs-type">Messager</span></a></span><span>
</span><span id="line-227"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModSummary.html#ModSummary"><span class="hs-identifier hs-type">ModSummary</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ summary for module being compiled</span></span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ module N ...</span></span><span>
</span><span id="line-230"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ ... of M</span></span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ old interface, if we have one</span></span><span>
</span><span id="line-232"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomeModLinkable"><span class="hs-identifier hs-type">HomeModLinkable</span></a></span><span>
</span><span id="line-233"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomeModInfo"><span class="hs-identifier hs-type">HomeModInfo</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ the complete HomeModInfo, if successful</span></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span id="compileOne%27"><span class="annot"><span class="annottext">compileOne' :: Maybe Messager
-&gt; HscEnv
-&gt; ModSummary
-&gt; Int
-&gt; Int
-&gt; Maybe ModIface
-&gt; HomeModLinkable
-&gt; IO HomeModInfo
</span><a href="GHC.Driver.Pipeline.html#compileOne%27"><span class="hs-identifier hs-var hs-var">compileOne'</span></a></span></span><span> </span><span id="local-6989586621682084805"><span class="annot"><span class="annottext">Maybe Messager
</span><a href="#local-6989586621682084805"><span class="hs-identifier hs-var">mHscMessage</span></a></span></span><span>
</span><span id="line-236"></span><span>            </span><span id="local-6989586621682084806"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084806"><span class="hs-identifier hs-var">hsc_env0</span></a></span></span><span> </span><span id="local-6989586621682084807"><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084807"><span class="hs-identifier hs-var">summary</span></a></span></span><span> </span><span id="local-6989586621682084808"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682084808"><span class="hs-identifier hs-var">mod_index</span></a></span></span><span> </span><span id="local-6989586621682084809"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682084809"><span class="hs-identifier hs-var">nmods</span></a></span></span><span> </span><span id="local-6989586621682084810"><span class="annot"><span class="annottext">Maybe ModIface
</span><a href="#local-6989586621682084810"><span class="hs-identifier hs-var">mb_old_iface</span></a></span></span><span> </span><span id="local-6989586621682084811"><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682084811"><span class="hs-identifier hs-var">mb_old_linkable</span></a></span></span><span>
</span><span id="line-237"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>   </span><span class="annot"><span class="annottext">Logger -&gt; Int -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084813"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile: input file&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084815"><span class="hs-identifier hs-var">input_fnpp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.1/src/Control.Monad.html#unless/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_KeepHiFiles"><span class="hs-identifier hs-var">Opt_KeepHiFiles</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084819"><span class="hs-identifier hs-var">lcl_dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-242"></span><span>             </span><span class="annot"><span class="annottext">TmpFs -&gt; TempFileLifetime -&gt; [FilePath] -&gt; IO ()
</span><a href="GHC.Utils.TmpFs.html#addFilesToClean"><span class="hs-identifier hs-var">addFilesToClean</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682084821"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">TempFileLifetime
</span><a href="GHC.Utils.TmpFs.html#TFL_CurrentModule"><span class="hs-identifier hs-var">TFL_CurrentModule</span></a></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; IO ()) -&gt; [FilePath] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-243"></span><span>                 </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ModLocation -&gt; FilePath
</span><a href="GHC.Unit.Module.Location.html#ml_hi_file"><span class="hs-identifier hs-var">ml_hi_file</span></a></span><span> </span><span class="annot"><span class="annottext">(ModLocation -&gt; FilePath) -&gt; ModLocation -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary -&gt; ModLocation
</span><a href="GHC.Unit.Module.ModSummary.html#ms_location"><span class="hs-identifier hs-var">ms_location</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084807"><span class="hs-identifier hs-var">summary</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-244"></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.1/src/Control.Monad.html#unless/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_KeepOFiles"><span class="hs-identifier hs-var">Opt_KeepOFiles</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084819"><span class="hs-identifier hs-var">lcl_dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-245"></span><span>             </span><span class="annot"><span class="annottext">TmpFs -&gt; TempFileLifetime -&gt; [FilePath] -&gt; IO ()
</span><a href="GHC.Utils.TmpFs.html#addFilesToClean"><span class="hs-identifier hs-var">addFilesToClean</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682084821"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">TempFileLifetime
</span><a href="GHC.Utils.TmpFs.html#TFL_GhcSession"><span class="hs-identifier hs-var">TFL_GhcSession</span></a></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; IO ()) -&gt; [FilePath] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-246"></span><span>                 </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ModLocation -&gt; FilePath
</span><a href="GHC.Unit.Module.Location.html#ml_obj_file"><span class="hs-identifier hs-var">ml_obj_file</span></a></span><span> </span><span class="annot"><span class="annottext">(ModLocation -&gt; FilePath) -&gt; ModLocation -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary -&gt; ModLocation
</span><a href="GHC.Unit.Module.ModSummary.html#ms_location"><span class="hs-identifier hs-var">ms_location</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084807"><span class="hs-identifier hs-var">summary</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>   </span><span class="hs-comment">-- Initialise plugins here for any plugins enabled locally for a module.</span><span>
</span><span id="line-249"></span><span>   </span><span id="local-6989586621682084826"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084826"><span class="hs-identifier hs-var">plugin_hsc_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; IO HscEnv
</span><a href="GHC.Runtime.Loader.html#initializePlugins"><span class="hs-identifier hs-var">initializePlugins</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084827"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-250"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084828"><span class="annot"><span class="annottext">pipe_env :: PipeEnv
</span><a href="#local-6989586621682084828"><span class="hs-identifier hs-var hs-var">pipe_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StopPhase -&gt; FilePath -&gt; Maybe Phase -&gt; PipelineOutput -&gt; PipeEnv
</span><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier hs-var">mkPipeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#NoStop"><span class="hs-identifier hs-var">NoStop</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084830"><span class="hs-identifier hs-var">input_fn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Phase
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="#local-6989586621682084831"><span class="hs-identifier hs-var">pipelineOutput</span></a></span><span>
</span><span id="line-251"></span><span>   </span><span id="local-6989586621682084832"><span class="annot"><span class="annottext">HscRecompStatus
</span><a href="#local-6989586621682084832"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Messager
-&gt; HscEnv
-&gt; ModSummary
-&gt; Maybe ModIface
-&gt; HomeModLinkable
-&gt; (Int, Int)
-&gt; IO HscRecompStatus
</span><a href="GHC.Driver.Main.html#hscRecompStatus"><span class="hs-identifier hs-var">hscRecompStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Messager
</span><a href="#local-6989586621682084805"><span class="hs-identifier hs-var">mHscMessage</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084826"><span class="hs-identifier hs-var">plugin_hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084834"><span class="hs-identifier hs-var">upd_summary</span></a></span><span>
</span><span id="line-252"></span><span>                </span><span class="annot"><span class="annottext">Maybe ModIface
</span><a href="#local-6989586621682084810"><span class="hs-identifier hs-var">mb_old_iface</span></a></span><span> </span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682084811"><span class="hs-identifier hs-var">mb_old_linkable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682084808"><span class="hs-identifier hs-var">mod_index</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682084809"><span class="hs-identifier hs-var">nmods</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084835"><span class="annot"><span class="annottext">pipeline :: HookedUse (ModIface, HomeModLinkable)
</span><a href="#local-6989586621682084835"><span class="hs-identifier hs-var hs-var">pipeline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; (HscEnv, ModSummary, HscRecompStatus)
-&gt; HookedUse (ModIface, HomeModLinkable)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; (HscEnv, ModSummary, HscRecompStatus)
-&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#hscPipeline"><span class="hs-identifier hs-var">hscPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682084828"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Pipeline.html#setDumpPrefix"><span class="hs-identifier hs-var">setDumpPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682084828"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084826"><span class="hs-identifier hs-var">plugin_hsc_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084834"><span class="hs-identifier hs-var">upd_summary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HscRecompStatus
</span><a href="#local-6989586621682084832"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621682084836"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682084836"><span class="hs-identifier hs-var">iface</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682084837"><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682084837"><span class="hs-identifier hs-var">linkable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Hooks
-&gt; HookedUse (ModIface, HomeModLinkable)
-&gt; IO (ModIface, HomeModLinkable)
forall a. Hooks -&gt; HookedUse a -&gt; IO a
</span><a href="GHC.Driver.Pipeline.Execute.html#runPipeline"><span class="hs-identifier hs-var">runPipeline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Hooks
</span><a href="GHC.Driver.Env.Types.html#hsc_hooks"><span class="hs-identifier hs-var">hsc_hooks</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084826"><span class="hs-identifier hs-var">plugin_hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HookedUse (ModIface, HomeModLinkable)
</span><a href="#local-6989586621682084835"><span class="hs-identifier hs-var">pipeline</span></a></span><span>
</span><span id="line-255"></span><span>   </span><span class="hs-comment">-- See Note [ModDetails and --make mode]</span><span>
</span><span id="line-256"></span><span>   </span><span id="local-6989586621682084838"><span class="annot"><span class="annottext">ModDetails
</span><a href="#local-6989586621682084838"><span class="hs-identifier hs-var">details</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; ModIface -&gt; IO ModDetails
</span><a href="GHC.Driver.Main.html#initModDetails"><span class="hs-identifier hs-var">initModDetails</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084826"><span class="hs-identifier hs-var">plugin_hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682084836"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-257"></span><span>   </span><span id="local-6989586621682084840"><span class="annot"><span class="annottext">Maybe Linkable
</span><a href="#local-6989586621682084840"><span class="hs-identifier hs-var">linkable'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Linkable -&gt; IO Linkable) -&gt; Maybe Linkable -&gt; IO (Maybe Linkable)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><a href="../../base-4.18.2.1/src/Data.Traversable.html#traverse/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; ModIface -&gt; ModDetails -&gt; Linkable -&gt; IO Linkable
</span><a href="GHC.Driver.Main.html#initWholeCoreBindings"><span class="hs-identifier hs-var">initWholeCoreBindings</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084826"><span class="hs-identifier hs-var">plugin_hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682084836"><span class="hs-identifier hs-var">iface</span></a></span><span> </span><span class="annot"><span class="annottext">ModDetails
</span><a href="#local-6989586621682084838"><span class="hs-identifier hs-var">details</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HomeModLinkable -&gt; Maybe Linkable
</span><a href="GHC.Unit.Home.ModInfo.html#homeMod_bytecode"><span class="hs-identifier hs-var">homeMod_bytecode</span></a></span><span> </span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682084837"><span class="hs-identifier hs-var">linkable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>   </span><span class="annot"><span class="annottext">HomeModInfo -&gt; IO HomeModInfo
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(HomeModInfo -&gt; IO HomeModInfo) -&gt; HomeModInfo -&gt; IO HomeModInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24%21/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface -&gt; ModDetails -&gt; HomeModLinkable -&gt; HomeModInfo
</span><a href="GHC.Unit.Home.ModInfo.html#HomeModInfo"><span class="hs-identifier hs-var">HomeModInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682084836"><span class="hs-identifier hs-var">iface</span></a></span><span> </span><span class="annot"><span class="annottext">ModDetails
</span><a href="#local-6989586621682084838"><span class="hs-identifier hs-var">details</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682084837"><span class="hs-identifier hs-var">linkable</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#homeMod_bytecode"><span class="hs-identifier hs-var">homeMod_bytecode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682084840"><span class="hs-identifier hs-type">linkable'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682084819"><span class="annot"><span class="annottext">lcl_dflags :: DynFlags
</span><a href="#local-6989586621682084819"><span class="hs-identifier hs-var hs-var">lcl_dflags</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModSummary -&gt; DynFlags
</span><a href="GHC.Unit.Module.ModSummary.html#ms_hspp_opts"><span class="hs-identifier hs-var">ms_hspp_opts</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084807"><span class="hs-identifier hs-var">summary</span></a></span><span>
</span><span id="line-261"></span><span>       </span><span id="local-6989586621682084846"><span class="annot"><span class="annottext">location :: ModLocation
</span><a href="#local-6989586621682084846"><span class="hs-identifier hs-var hs-var">location</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModSummary -&gt; ModLocation
</span><a href="GHC.Unit.Module.ModSummary.html#ms_location"><span class="hs-identifier hs-var">ms_location</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084807"><span class="hs-identifier hs-var">summary</span></a></span><span>
</span><span id="line-262"></span><span>       </span><span id="local-6989586621682084830"><span class="annot"><span class="annottext">input_fn :: FilePath
</span><a href="#local-6989586621682084830"><span class="hs-identifier hs-var hs-var">input_fn</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath -&gt; FilePath
forall a. HasCallStack =&gt; FilePath -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile:hs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModLocation -&gt; Maybe FilePath
</span><a href="GHC.Unit.Module.Location.html#ml_hs_file"><span class="hs-identifier hs-var">ml_hs_file</span></a></span><span> </span><span class="annot"><span class="annottext">ModLocation
</span><a href="#local-6989586621682084846"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>       </span><span id="local-6989586621682084815"><span class="annot"><span class="annottext">input_fnpp :: FilePath
</span><a href="#local-6989586621682084815"><span class="hs-identifier hs-var hs-var">input_fnpp</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModSummary -&gt; FilePath
</span><a href="GHC.Unit.Module.ModSummary.html#ms_hspp_file"><span class="hs-identifier hs-var">ms_hspp_file</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084807"><span class="hs-identifier hs-var">summary</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>       </span><span id="local-6989586621682084831"><span class="annot"><span class="annottext">pipelineOutput :: PipelineOutput
</span><a href="#local-6989586621682084831"><span class="hs-identifier hs-var hs-var">pipelineOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; PipelineOutput
</span><a href="GHC.Driver.Backend.html#backendPipelineOutput"><span class="hs-identifier hs-var">backendPipelineOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621682084850"><span class="hs-identifier hs-var">bcknd</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span>       </span><span id="local-6989586621682084813"><span class="annot"><span class="annottext">logger :: Logger
</span><a href="#local-6989586621682084813"><span class="hs-identifier hs-var hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084806"><span class="hs-identifier hs-var">hsc_env0</span></a></span><span>
</span><span id="line-268"></span><span>       </span><span id="local-6989586621682084821"><span class="annot"><span class="annottext">tmpfs :: TmpFs
</span><a href="#local-6989586621682084821"><span class="hs-identifier hs-var hs-var">tmpfs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; TmpFs
</span><a href="GHC.Driver.Env.Types.html#hsc_tmpfs"><span class="hs-identifier hs-var">hsc_tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084806"><span class="hs-identifier hs-var">hsc_env0</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>       </span><span id="local-6989586621682084851"><span class="annot"><span class="annottext">basename :: FilePath
</span><a href="#local-6989586621682084851"><span class="hs-identifier hs-var hs-var">basename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.300.1/src/System.FilePath.Posix.html#dropExtension/System.FilePath.Posix.html#dropExtension"><span class="hs-identifier hs-var">dropExtension</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084830"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>       </span><span class="hs-comment">-- We add the directory in which the .hs files resides) to the import</span><span>
</span><span id="line-273"></span><span>       </span><span class="hs-comment">-- path.  This is needed when we try to compile the .hc file later, if it</span><span>
</span><span id="line-274"></span><span>       </span><span class="hs-comment">-- imports a _stub.h file that we created here.</span><span>
</span><span id="line-275"></span><span>       </span><span id="local-6989586621682084853"><span class="annot"><span class="annottext">current_dir :: FilePath
</span><a href="#local-6989586621682084853"><span class="hs-identifier hs-var hs-var">current_dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.300.1/src/System.FilePath.Posix.html#takeDirectory/System.FilePath.Posix.html#takeDirectory"><span class="hs-identifier hs-var">takeDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084851"><span class="hs-identifier hs-var">basename</span></a></span><span>
</span><span id="line-276"></span><span>       </span><span id="local-6989586621682084855"><span class="annot"><span class="annottext">old_paths :: IncludeSpecs
</span><a href="#local-6989586621682084855"><span class="hs-identifier hs-var hs-var">old_paths</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; IncludeSpecs
</span><a href="GHC.Driver.Session.html#includePaths"><span class="hs-identifier hs-var">includePaths</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084819"><span class="hs-identifier hs-var">lcl_dflags</span></a></span><span>
</span><span id="line-277"></span><span>       </span><span id="local-6989586621682084857"><span class="annot"><span class="annottext">loadAsByteCode :: Bool
</span><a href="#local-6989586621682084857"><span class="hs-identifier hs-var hs-var">loadAsByteCode</span></a></span></span><span>
</span><span id="line-278"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Target.html#Target"><span class="hs-identifier hs-type">Target</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">targetAllowObjCode :: Target -&gt; Bool
</span><a href="GHC.Types.Target.html#targetAllowObjCode"><span class="hs-identifier hs-var">targetAllowObjCode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682084860"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084860"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModSummary -&gt; [Target] -&gt; Maybe Target
</span><a href="GHC.Unit.Module.ModSummary.html#findTarget"><span class="hs-identifier hs-var">findTarget</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084807"><span class="hs-identifier hs-var">summary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; [Target]
</span><a href="GHC.Driver.Env.Types.html#hsc_targets"><span class="hs-identifier hs-var">hsc_targets</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084806"><span class="hs-identifier hs-var">hsc_env0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084860"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-280"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-281"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-282"></span><span>       </span><span class="hs-comment">-- Figure out which backend we're using</span><span>
</span><span id="line-283"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621682084850"><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621682084850"><span class="hs-identifier hs-var">bcknd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682084864"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084864"><span class="hs-identifier hs-var">dflags3</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>         </span><span class="hs-comment">-- #8042: When module was loaded with `*` prefix in ghci, but DynFlags</span><span>
</span><span id="line-285"></span><span>         </span><span class="hs-comment">-- suggest to generate object code (which may happen in case -fobject-code</span><span>
</span><span id="line-286"></span><span>         </span><span class="hs-comment">-- was set), force it to generate byte-code. This is NOT transitive and</span><span>
</span><span id="line-287"></span><span>         </span><span class="hs-comment">-- only applies to direct targets.</span><span>
</span><span id="line-288"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084857"><span class="hs-identifier hs-var">loadAsByteCode</span></a></span><span>
</span><span id="line-289"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="GHC.Driver.Backend.html#interpreterBackend"><span class="hs-identifier hs-var">interpreterBackend</span></a></span><span>
</span><span id="line-290"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; GeneralFlag -&gt; DynFlags
</span><a href="GHC.Driver.Session.html#gopt_set"><span class="hs-identifier hs-var">gopt_set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084819"><span class="hs-identifier hs-var">lcl_dflags</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Driver.Backend.html#interpreterBackend"><span class="hs-identifier hs-type">interpreterBackend</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_ForceRecomp"><span class="hs-identifier hs-var">Opt_ForceRecomp</span></a></span><span>
</span><span id="line-291"></span><span>           </span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-294"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084869"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084819"><span class="hs-identifier hs-var">lcl_dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>       </span><span class="hs-comment">-- See Note [Filepaths and Multiple Home Units]</span><span>
</span><span id="line-296"></span><span>       </span><span id="local-6989586621682084869"><span class="annot"><span class="annottext">dflags :: DynFlags
</span><a href="#local-6989586621682084869"><span class="hs-identifier hs-var hs-var">dflags</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084864"><span class="hs-identifier hs-var">dflags3</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#includePaths"><span class="hs-identifier hs-var">includePaths</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.SysTools.Cpp.html#offsetIncludePaths"><span class="hs-identifier hs-type">offsetIncludePaths</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084864"><span class="hs-identifier hs-type">dflags3</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#addImplicitQuoteInclude"><span class="hs-identifier hs-type">addImplicitQuoteInclude</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084855"><span class="hs-identifier hs-type">old_paths</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682084853"><span class="hs-identifier hs-type">current_dir</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-297"></span><span>       </span><span id="local-6989586621682084834"><span class="annot"><span class="annottext">upd_summary :: ModSummary
</span><a href="#local-6989586621682084834"><span class="hs-identifier hs-var hs-var">upd_summary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682084807"><span class="hs-identifier hs-var">summary</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModSummary.html#ms_hspp_opts"><span class="hs-identifier hs-var">ms_hspp_opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682084869"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-298"></span><span>       </span><span id="local-6989586621682084827"><span class="annot"><span class="annottext">hsc_env :: HscEnv
</span><a href="#local-6989586621682084827"><span class="hs-identifier hs-var hs-var">hsc_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; DynFlags -&gt; HscEnv -&gt; HscEnv
DynFlags -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Env.html#hscSetFlags"><span class="hs-identifier hs-var">hscSetFlags</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084869"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682084806"><span class="hs-identifier hs-var">hsc_env0</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- Link</span><span>
</span><span id="line-303"></span><span class="hs-comment">--</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- Note [Dynamic linking on macOS]</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- Since macOS Sierra (10.14), the dynamic system linker enforces</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- a limit on the Load Commands.  Specifically the Load Command Size</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- Limit is at 32K (32768).  The Load Commands contain the install</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- name, dependencies, runpaths, and a few other commands.  We however</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- only have control over the install name, dependencies and runpaths.</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- The install name is the name by which this library will be</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- referenced.  This is such that we do not need to bake in the full</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- absolute location of the library, and can move the library around.</span><span>
</span><span id="line-315"></span><span class="hs-comment">--</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- The dependency commands contain the install names from of referenced</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- libraries.  Thus if a libraries install name is @rpath/libHS...dylib,</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- that will end up as the dependency.</span><span>
</span><span id="line-319"></span><span class="hs-comment">--</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- Finally we have the runpaths, which informs the linker about the</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- directories to search for the referenced dependencies.</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- The system linker can do recursive linking, however using only the</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- direct dependencies conflicts with ghc's ability to inline across</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- packages, and as such would end up with unresolved symbols.</span><span>
</span><span id="line-326"></span><span class="hs-comment">--</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- Thus we will pass the full dependency closure to the linker, and then</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- ask the linker to remove any unused dynamic libraries (-dead_strip_dylibs).</span><span>
</span><span id="line-329"></span><span class="hs-comment">--</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- We still need to add the relevant runpaths, for the dynamic linker to</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- lookup the referenced libraries though.  The linker (ld64) does not</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- have any option to dead strip runpaths; which makes sense as runpaths</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- can be used for dependencies of dependencies as well.</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- The solution we then take in GHC is to not pass any runpaths to the</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- linker at link time, but inject them after the linking.  For this to</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- work we'll need to ask the linker to create enough space in the header</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- to add more runpaths after the linking (-headerpad 8000).</span><span>
</span><span id="line-339"></span><span class="hs-comment">--</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- After the library has been linked by $LD (usually ld64), we will use</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- otool to inspect the libraries left over after dead stripping, compute</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- the relevant runpaths, and inject them into the linked product using</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- the install_name_tool command.</span><span>
</span><span id="line-344"></span><span class="hs-comment">--</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- This strategy should produce the smallest possible set of load commands</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- while still retaining some form of relocatability via runpaths.</span><span>
</span><span id="line-347"></span><span class="hs-comment">--</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- The only way I can see to reduce the load command size further would be</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- by shortening the library names, or start putting libraries into the same</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- folders, such that one runpath would be sufficient for multiple/all</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- libraries.</span><span>
</span><span id="line-352"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#link"><span class="hs-identifier hs-type">link</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#GhcLink"><span class="hs-identifier hs-type">GhcLink</span></a></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ interactive or batch</span></span><span>
</span><span id="line-353"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ Logger</span></span><span>
</span><span id="line-354"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.TmpFs.html#TmpFs"><span class="hs-identifier hs-type">TmpFs</span></a></span><span>
</span><span id="line-355"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Hooks.html#Hooks"><span class="hs-identifier hs-type">Hooks</span></a></span><span>
</span><span id="line-356"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span>                </span><span class="annot"><span class="hs-comment">-- ^ dynamic flags</span></span><span>
</span><span id="line-357"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html#UnitEnv"><span class="hs-identifier hs-type">UnitEnv</span></a></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ unit environment</span></span><span>
</span><span id="line-358"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                    </span><span class="annot"><span class="hs-comment">-- ^ attempt linking in batch mode?</span></span><span>
</span><span id="line-359"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Iface.Recomp.html#RecompileRequired"><span class="hs-identifier hs-type">RecompileRequired</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomePackageTable"><span class="hs-identifier hs-type">HomePackageTable</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ what to link</span></span><span>
</span><span id="line-361"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#SuccessFlag"><span class="hs-identifier hs-type">SuccessFlag</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- For the moment, in the batch linker, we don't bother to tell doLink</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- which packages to link -- it just tries all that are available.</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- batch_attempt_linking should only be *looked at* in batch mode.  It</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- should only be True if the upsweep was successful and someone</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- exports main, i.e., we have good reason to believe that linking</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- will succeed.</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span id="link"><span class="annot"><span class="annottext">link :: GhcLink
-&gt; Logger
-&gt; TmpFs
-&gt; Hooks
-&gt; DynFlags
-&gt; UnitEnv
-&gt; Bool
-&gt; Maybe (RecompileRequired -&gt; IO ())
-&gt; HomePackageTable
-&gt; IO SuccessFlag
</span><a href="GHC.Driver.Pipeline.html#link"><span class="hs-identifier hs-var hs-var">link</span></a></span></span><span> </span><span id="local-6989586621682084873"><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682084873"><span class="hs-identifier hs-var">ghcLink</span></a></span></span><span> </span><span id="local-6989586621682084874"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084874"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682084875"><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682084875"><span class="hs-identifier hs-var">tmpfs</span></a></span></span><span> </span><span id="local-6989586621682084876"><span class="annot"><span class="annottext">Hooks
</span><a href="#local-6989586621682084876"><span class="hs-identifier hs-var">hooks</span></a></span></span><span> </span><span id="local-6989586621682084877"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084877"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621682084878"><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084878"><span class="hs-identifier hs-var">unit_env</span></a></span></span><span> </span><span id="local-6989586621682084879"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084879"><span class="hs-identifier hs-var">batch_attempt_linking</span></a></span></span><span> </span><span id="local-6989586621682084880"><span class="annot"><span class="annottext">Maybe (RecompileRequired -&gt; IO ())
</span><a href="#local-6989586621682084880"><span class="hs-identifier hs-var">mHscMessage</span></a></span></span><span> </span><span id="local-6989586621682084881"><span class="annot"><span class="annottext">HomePackageTable
</span><a href="#local-6989586621682084881"><span class="hs-identifier hs-var">hpt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Hooks
-&gt; Maybe
     (GhcLink -&gt; DynFlags -&gt; Bool -&gt; HomePackageTable -&gt; IO SuccessFlag)
</span><a href="GHC.Driver.Hooks.html#linkHook"><span class="hs-identifier hs-var">linkHook</span></a></span><span> </span><span class="annot"><span class="annottext">Hooks
</span><a href="#local-6989586621682084876"><span class="hs-identifier hs-var">hooks</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-372"></span><span>      </span><span class="annot"><span class="annottext">Maybe
  (GhcLink -&gt; DynFlags -&gt; Bool -&gt; HomePackageTable -&gt; IO SuccessFlag)
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682084873"><span class="hs-identifier hs-var">ghcLink</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#NoLink"><span class="hs-identifier hs-var">NoLink</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SuccessFlag -&gt; IO SuccessFlag
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">SuccessFlag
</span><a href="GHC.Types.Basic.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkBinary"><span class="hs-identifier hs-var">LinkBinary</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO SuccessFlag
</span><a href="#local-6989586621682084886"><span class="hs-identifier hs-var">normal_link</span></a></span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkStaticLib"><span class="hs-identifier hs-var">LinkStaticLib</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO SuccessFlag
</span><a href="#local-6989586621682084886"><span class="hs-identifier hs-var">normal_link</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkDynLib"><span class="hs-identifier hs-var">LinkDynLib</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO SuccessFlag
</span><a href="#local-6989586621682084886"><span class="hs-identifier hs-var">normal_link</span></a></span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkMergedObj"><span class="hs-identifier hs-var">LinkMergedObj</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO SuccessFlag
</span><a href="#local-6989586621682084886"><span class="hs-identifier hs-var">normal_link</span></a></span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkInMemory"><span class="hs-identifier hs-var">LinkInMemory</span></a></span><span>
</span><span id="line-379"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PlatformMisc -&gt; Bool
</span><a href="GHC.Platform.html#platformMisc_ghcWithInterpreter"><span class="hs-identifier hs-var">platformMisc_ghcWithInterpreter</span></a></span><span> </span><span class="annot"><span class="annottext">(PlatformMisc -&gt; Bool) -&gt; PlatformMisc -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; PlatformMisc
</span><a href="GHC.Driver.Session.html#platformMisc"><span class="hs-identifier hs-var">platformMisc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084877"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-380"></span><span>           </span><span class="hs-comment">-- Not Linking...(demand linker will do the job)</span><span>
</span><span id="line-381"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SuccessFlag -&gt; IO SuccessFlag
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">SuccessFlag
</span><a href="GHC.Types.Basic.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span>
</span><span id="line-382"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-383"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GhcLink -&gt; IO SuccessFlag
forall a. GhcLink -&gt; a
</span><a href="GHC.Driver.Pipeline.html#panicBadLink"><span class="hs-identifier hs-var">panicBadLink</span></a></span><span> </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkInMemory"><span class="hs-identifier hs-var">LinkInMemory</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682084894"><span class="annot"><span class="annottext">GhcLink -&gt; DynFlags -&gt; Bool -&gt; HomePackageTable -&gt; IO SuccessFlag
</span><a href="#local-6989586621682084894"><span class="hs-identifier hs-var">h</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GhcLink -&gt; DynFlags -&gt; Bool -&gt; HomePackageTable -&gt; IO SuccessFlag
</span><a href="#local-6989586621682084894"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682084873"><span class="hs-identifier hs-var">ghcLink</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084877"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084879"><span class="hs-identifier hs-var">batch_attempt_linking</span></a></span><span> </span><span class="annot"><span class="annottext">HomePackageTable
</span><a href="#local-6989586621682084881"><span class="hs-identifier hs-var">hpt</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>    </span><span id="local-6989586621682084886"><span class="annot"><span class="annottext">normal_link :: IO SuccessFlag
</span><a href="#local-6989586621682084886"><span class="hs-identifier hs-var hs-var">normal_link</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; TmpFs
-&gt; DynFlags
-&gt; UnitEnv
-&gt; Bool
-&gt; Maybe (RecompileRequired -&gt; IO ())
-&gt; HomePackageTable
-&gt; IO SuccessFlag
</span><a href="GHC.Driver.Pipeline.html#link%27"><span class="hs-identifier hs-var">link'</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084874"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682084875"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084877"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084878"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084879"><span class="hs-identifier hs-var">batch_attempt_linking</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (RecompileRequired -&gt; IO ())
</span><a href="#local-6989586621682084880"><span class="hs-identifier hs-var">mHscMessage</span></a></span><span> </span><span class="annot"><span class="annottext">HomePackageTable
</span><a href="#local-6989586621682084881"><span class="hs-identifier hs-var">hpt</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span id="local-6989586621682084321"><span class="annot"><a href="GHC.Driver.Pipeline.html#panicBadLink"><span class="hs-identifier hs-type">panicBadLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#GhcLink"><span class="hs-identifier hs-type">GhcLink</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084321"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-390"></span><span id="panicBadLink"><span class="annot"><span class="annottext">panicBadLink :: forall a. GhcLink -&gt; a
</span><a href="GHC.Driver.Pipeline.html#panicBadLink"><span class="hs-identifier hs-var hs-var">panicBadLink</span></a></span></span><span> </span><span id="local-6989586621682084900"><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682084900"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; a
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;link: GHC not built to link this way: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-391"></span><span>                            </span><span class="annot"><span class="annottext">GhcLink -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="../../base-4.18.2.1/src/GHC.Show.html#show/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682084900"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#link%27"><span class="hs-identifier hs-type">link'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-394"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.TmpFs.html#TmpFs"><span class="hs-identifier hs-type">TmpFs</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span>                </span><span class="annot"><span class="hs-comment">-- ^ dynamic flags</span></span><span>
</span><span id="line-396"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html#UnitEnv"><span class="hs-identifier hs-type">UnitEnv</span></a></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ unit environment</span></span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                    </span><span class="annot"><span class="hs-comment">-- ^ attempt linking in batch mode?</span></span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Iface.Recomp.html#RecompileRequired"><span class="hs-identifier hs-type">RecompileRequired</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomePackageTable"><span class="hs-identifier hs-type">HomePackageTable</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ what to link</span></span><span>
</span><span id="line-400"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#SuccessFlag"><span class="hs-identifier hs-type">SuccessFlag</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span id="link%27"><span class="annot"><span class="annottext">link' :: Logger
-&gt; TmpFs
-&gt; DynFlags
-&gt; UnitEnv
-&gt; Bool
-&gt; Maybe (RecompileRequired -&gt; IO ())
-&gt; HomePackageTable
-&gt; IO SuccessFlag
</span><a href="GHC.Driver.Pipeline.html#link%27"><span class="hs-identifier hs-var hs-var">link'</span></a></span></span><span> </span><span id="local-6989586621682084903"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682084904"><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682084904"><span class="hs-identifier hs-var">tmpfs</span></a></span></span><span> </span><span id="local-6989586621682084905"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621682084906"><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084906"><span class="hs-identifier hs-var">unit_env</span></a></span></span><span> </span><span id="local-6989586621682084907"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084907"><span class="hs-identifier hs-var">batch_attempt_linking</span></a></span></span><span> </span><span id="local-6989586621682084908"><span class="annot"><span class="annottext">Maybe (RecompileRequired -&gt; IO ())
</span><a href="#local-6989586621682084908"><span class="hs-identifier hs-var">mHscMessager</span></a></span></span><span> </span><span id="local-6989586621682084909"><span class="annot"><span class="annottext">HomePackageTable
</span><a href="#local-6989586621682084909"><span class="hs-identifier hs-var">hpt</span></a></span></span><span>
</span><span id="line-403"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084907"><span class="hs-identifier hs-var">batch_attempt_linking</span></a></span><span>
</span><span id="line-404"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-406"></span><span>            </span><span id="local-6989586621682084910"><span class="annot"><span class="annottext">staticLink :: Bool
</span><a href="#local-6989586621682084910"><span class="hs-identifier hs-var hs-var">staticLink</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; GhcLink
</span><a href="GHC.Driver.Session.html#ghcLink"><span class="hs-identifier hs-var">ghcLink</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-407"></span><span>                          </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkStaticLib"><span class="hs-identifier hs-var">LinkStaticLib</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-408"></span><span>                          </span><span class="annot"><span class="annottext">GhcLink
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span>            </span><span id="local-6989586621682084912"><span class="annot"><span class="annottext">home_mod_infos :: [HomeModInfo]
</span><a href="#local-6989586621682084912"><span class="hs-identifier hs-var hs-var">home_mod_infos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HomePackageTable -&gt; [HomeModInfo]
</span><a href="GHC.Unit.Home.ModInfo.html#eltsHpt"><span class="hs-identifier hs-var">eltsHpt</span></a></span><span> </span><span class="annot"><span class="annottext">HomePackageTable
</span><a href="#local-6989586621682084909"><span class="hs-identifier hs-var">hpt</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>            </span><span class="hs-comment">-- the packages we depend on</span><span>
</span><span id="line-413"></span><span>            </span><span id="local-6989586621682084914"><span class="annot"><span class="annottext">pkg_deps :: [UnitId]
</span><a href="#local-6989586621682084914"><span class="hs-identifier hs-var hs-var">pkg_deps</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set UnitId -&gt; [UnitId]
forall a. Set a -&gt; [a]
</span><a href="../../containers-0.6.7/src/Data.Set.Internal.html#toList/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">Set.toList</span></a></span><span>
</span><span id="line-414"></span><span>                          </span><span class="annot"><span class="annottext">(Set UnitId -&gt; [UnitId]) -&gt; Set UnitId -&gt; [UnitId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Set UnitId] -&gt; Set UnitId
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="../../containers-0.6.7/src/Data.Set.Internal.html#unions/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">Set.unions</span></a></span><span>
</span><span id="line-415"></span><span>                          </span><span class="annot"><span class="annottext">([Set UnitId] -&gt; Set UnitId) -&gt; [Set UnitId] -&gt; Set UnitId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(HomeModInfo -&gt; Set UnitId) -&gt; [HomeModInfo] -&gt; [Set UnitId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dependencies -&gt; Set UnitId
</span><a href="GHC.Unit.Module.Deps.html#dep_direct_pkgs"><span class="hs-identifier hs-var">dep_direct_pkgs</span></a></span><span> </span><span class="annot"><span class="annottext">(Dependencies -&gt; Set UnitId)
-&gt; (HomeModInfo -&gt; Dependencies) -&gt; HomeModInfo -&gt; Set UnitId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface -&gt; Dependencies
forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Dependencies
</span><a href="GHC.Unit.Module.ModIface.html#mi_deps"><span class="hs-identifier hs-var">mi_deps</span></a></span><span> </span><span class="annot"><span class="annottext">(ModIface -&gt; Dependencies)
-&gt; (HomeModInfo -&gt; ModIface) -&gt; HomeModInfo -&gt; Dependencies
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HomeModInfo -&gt; ModIface
</span><a href="GHC.Unit.Home.ModInfo.html#hm_iface"><span class="hs-identifier hs-var">hm_iface</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>                          </span><span class="annot"><span class="annottext">([HomeModInfo] -&gt; [Set UnitId]) -&gt; [HomeModInfo] -&gt; [Set UnitId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[HomeModInfo]
</span><a href="#local-6989586621682084912"><span class="hs-identifier hs-var">home_mod_infos</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span>            </span><span class="hs-comment">-- the linkables to link</span><span>
</span><span id="line-419"></span><span>            </span><span id="local-6989586621682084921"><span class="annot"><span class="annottext">linkables :: [Linkable]
</span><a href="#local-6989586621682084921"><span class="hs-identifier hs-var hs-var">linkables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HomeModInfo -&gt; Linkable) -&gt; [HomeModInfo] -&gt; [Linkable]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe Linkable -&gt; Linkable
forall a. HasCallStack =&gt; FilePath -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;link&quot;</span></span><span class="annot"><span class="annottext">(Maybe Linkable -&gt; Linkable)
-&gt; (HomeModInfo -&gt; Maybe Linkable) -&gt; HomeModInfo -&gt; Linkable
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HomeModInfo -&gt; Maybe Linkable
</span><a href="GHC.Unit.Home.ModInfo.html#homeModInfoObject"><span class="hs-identifier hs-var">homeModInfoObject</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HomeModInfo]
</span><a href="#local-6989586621682084912"><span class="hs-identifier hs-var">home_mod_infos</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><span class="annottext">Logger -&gt; Int -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;link: hmi ...&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HomeModInfo -&gt; SDoc) -&gt; [HomeModInfo] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(Module -&gt; SDoc) -&gt; (HomeModInfo -&gt; Module) -&gt; HomeModInfo -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface -&gt; Module
forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Module
</span><a href="GHC.Unit.Module.ModIface.html#mi_module"><span class="hs-identifier hs-var">mi_module</span></a></span><span> </span><span class="annot"><span class="annottext">(ModIface -&gt; Module)
-&gt; (HomeModInfo -&gt; ModIface) -&gt; HomeModInfo -&gt; Module
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HomeModInfo -&gt; ModIface
</span><a href="GHC.Unit.Home.ModInfo.html#hm_iface"><span class="hs-identifier hs-var">hm_iface</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HomeModInfo]
</span><a href="#local-6989586621682084912"><span class="hs-identifier hs-var">home_mod_infos</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>        </span><span class="annot"><span class="annottext">Logger -&gt; Int -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;link: linkables are ...&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Linkable -&gt; SDoc) -&gt; [Linkable] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Linkable -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Linkable]
</span><a href="#local-6989586621682084921"><span class="hs-identifier hs-var">linkables</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><span class="annottext">Logger -&gt; Int -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;link: pkg deps are ...&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnitId -&gt; SDoc) -&gt; [UnitId] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084914"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span>        </span><span class="hs-comment">-- check for the -no-link flag</span><span>
</span><span id="line-426"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GhcLink -&gt; Bool
</span><a href="GHC.Driver.Session.html#isNoLink"><span class="hs-identifier hs-var">isNoLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; GhcLink
</span><a href="GHC.Driver.Session.html#ghcLink"><span class="hs-identifier hs-var">ghcLink</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; Int -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;link(batch): linking omitted (-c flag given).&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>                  </span><span class="annot"><span class="annottext">SuccessFlag -&gt; IO SuccessFlag
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">SuccessFlag
</span><a href="GHC.Types.Basic.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span>
</span><span id="line-429"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084927"><span class="annot"><span class="annottext">getOfiles :: Linkable -&gt; [FilePath]
</span><a href="#local-6989586621682084927"><span class="hs-identifier hs-var hs-var">getOfiles</span></a></span></span><span> </span><span class="annot"><a href="GHC.Linker.Types.html#LM"><span class="hs-identifier hs-type">LM</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621682084929"><span class="annot"><span class="annottext">[Unlinked]
linkableUnlinked :: [Unlinked]
linkableUnlinked :: Linkable -&gt; [Unlinked]
</span><a href="#local-6989586621682084929"><span class="hs-identifier hs-var hs-var">linkableUnlinked</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Unlinked -&gt; FilePath) -&gt; [Unlinked] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Unlinked -&gt; FilePath
</span><a href="GHC.Linker.Types.html#nameOfObject"><span class="hs-identifier hs-var">nameOfObject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Unlinked -&gt; Bool) -&gt; [Unlinked] -&gt; [Unlinked]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">Unlinked -&gt; Bool
</span><a href="GHC.Linker.Types.html#isObject"><span class="hs-identifier hs-var">isObject</span></a></span><span> </span><span class="annot"><span class="annottext">[Unlinked]
</span><a href="#local-6989586621682084929"><span class="hs-identifier hs-var">linkableUnlinked</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>            </span><span id="local-6989586621682084933"><span class="annot"><span class="annottext">obj_files :: [FilePath]
</span><a href="#local-6989586621682084933"><span class="hs-identifier hs-var hs-var">obj_files</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Linkable -&gt; [FilePath]) -&gt; [Linkable] -&gt; [FilePath]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Linkable -&gt; [FilePath]
</span><a href="#local-6989586621682084927"><span class="hs-identifier hs-var">getOfiles</span></a></span><span> </span><span class="annot"><span class="annottext">[Linkable]
</span><a href="#local-6989586621682084921"><span class="hs-identifier hs-var">linkables</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span id="local-6989586621682084935"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682084935"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.Session.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-434"></span><span>            </span><span id="local-6989586621682084937"><span class="annot"><span class="annottext">arch_os :: ArchOS
</span><a href="#local-6989586621682084937"><span class="hs-identifier hs-var hs-var">arch_os</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ArchOS
</span><a href="GHC.Platform.html#platformArchOS"><span class="hs-identifier hs-var">platformArchOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682084935"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-435"></span><span>            </span><span id="local-6989586621682084939"><span class="annot"><span class="annottext">exe_file :: FilePath
</span><a href="#local-6989586621682084939"><span class="hs-identifier hs-var hs-var">exe_file</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArchOS -&gt; Bool -&gt; Maybe FilePath -&gt; FilePath
</span><a href="GHC.Linker.Static.Utils.html#exeFileName"><span class="hs-identifier hs-var">exeFileName</span></a></span><span> </span><span class="annot"><span class="annottext">ArchOS
</span><a href="#local-6989586621682084937"><span class="hs-identifier hs-var">arch_os</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084910"><span class="hs-identifier hs-var">staticLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Maybe FilePath
</span><a href="GHC.Driver.Session.html#outputFile_"><span class="hs-identifier hs-var">outputFile_</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>        </span><span id="local-6989586621682084942"><span class="annot"><span class="annottext">RecompileRequired
</span><a href="#local-6989586621682084942"><span class="hs-identifier hs-var">linking_needed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; DynFlags
-&gt; UnitEnv
-&gt; Bool
-&gt; [Linkable]
-&gt; [UnitId]
-&gt; IO RecompileRequired
</span><a href="GHC.Driver.Pipeline.html#linkingNeeded"><span class="hs-identifier hs-var">linkingNeeded</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084906"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084910"><span class="hs-identifier hs-var">staticLink</span></a></span><span> </span><span class="annot"><span class="annottext">[Linkable]
</span><a href="#local-6989586621682084921"><span class="hs-identifier hs-var">linkables</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084914"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><span class="annottext">Maybe (RecompileRequired -&gt; IO ())
-&gt; ((RecompileRequired -&gt; IO ()) -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#forM_/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (RecompileRequired -&gt; IO ())
</span><a href="#local-6989586621682084908"><span class="hs-identifier hs-var">mHscMessager</span></a></span><span> </span><span class="annot"><span class="annottext">(((RecompileRequired -&gt; IO ()) -&gt; IO ()) -&gt; IO ())
-&gt; ((RecompileRequired -&gt; IO ()) -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682084944"><span class="annot"><span class="annottext">RecompileRequired -&gt; IO ()
</span><a href="#local-6989586621682084944"><span class="hs-identifier hs-var">hscMessage</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RecompileRequired -&gt; IO ()
</span><a href="#local-6989586621682084944"><span class="hs-identifier hs-var">hscMessage</span></a></span><span> </span><span class="annot"><span class="annottext">RecompileRequired
</span><a href="#local-6989586621682084942"><span class="hs-identifier hs-var">linking_needed</span></a></span><span>
</span><span id="line-440"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_ForceRecomp"><span class="hs-identifier hs-var">Opt_ForceRecomp</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecompileRequired
</span><a href="#local-6989586621682084942"><span class="hs-identifier hs-var">linking_needed</span></a></span><span> </span><span class="annot"><span class="annottext">RecompileRequired -&gt; RecompileRequired -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RecompileRequired
</span><a href="GHC.Iface.Recomp.html#UpToDate"><span class="hs-identifier hs-var">UpToDate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; Int -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084939"><span class="hs-identifier hs-var">exe_file</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;is up to date, linking not required.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>                   </span><span class="annot"><span class="annottext">SuccessFlag -&gt; IO SuccessFlag
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">SuccessFlag
</span><a href="GHC.Types.Basic.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span>
</span><span id="line-443"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span>        </span><span class="hs-comment">-- Don't showPass in Batch mode; doLink will do that for us.</span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; GhcLink
</span><a href="GHC.Driver.Session.html#ghcLink"><span class="hs-identifier hs-var">ghcLink</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>          </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkBinary"><span class="hs-identifier hs-var">LinkBinary</span></a></span><span>
</span><span id="line-449"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; Bool
</span><a href="GHC.Driver.Backend.html#backendUseJSLinker"><span class="hs-identifier hs-var">backendUseJSLinker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.html#linkJSBinary"><span class="hs-identifier hs-var">linkJSBinary</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084906"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682084933"><span class="hs-identifier hs-var">obj_files</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084914"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span>
</span><span id="line-450"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; TmpFs -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Linker.Static.html#linkBinary"><span class="hs-identifier hs-var">linkBinary</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682084904"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084906"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682084933"><span class="hs-identifier hs-var">obj_files</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084914"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span>
</span><span id="line-451"></span><span>          </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkStaticLib"><span class="hs-identifier hs-var">LinkStaticLib</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Linker.Static.html#linkStaticLib"><span class="hs-identifier hs-var">linkStaticLib</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084906"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682084933"><span class="hs-identifier hs-var">obj_files</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084914"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span>
</span><span id="line-452"></span><span>          </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkDynLib"><span class="hs-identifier hs-var">LinkDynLib</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; TmpFs -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.Execute.html#linkDynLibCheck"><span class="hs-identifier hs-var">linkDynLibCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682084904"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084905"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084906"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682084933"><span class="hs-identifier hs-var">obj_files</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084914"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span>
</span><span id="line-453"></span><span>          </span><span id="local-6989586621682084952"><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682084952"><span class="hs-identifier hs-var">other</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GhcLink -&gt; IO ()
forall a. GhcLink -&gt; a
</span><a href="GHC.Driver.Pipeline.html#panicBadLink"><span class="hs-identifier hs-var">panicBadLink</span></a></span><span> </span><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682084952"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="annottext">Logger -&gt; Int -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;link: done&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span>        </span><span class="hs-comment">-- linkBinary only returns if it succeeds</span><span>
</span><span id="line-458"></span><span>        </span><span class="annot"><span class="annottext">SuccessFlag -&gt; IO SuccessFlag
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">SuccessFlag
</span><a href="GHC.Types.Basic.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-461"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; Int -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084903"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;link(batch): upsweep (partially) failed OR&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span>
</span><span id="line-462"></span><span>                                </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;   Main.main not exported; not linking.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>        </span><span class="annot"><span class="annottext">SuccessFlag -&gt; IO SuccessFlag
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">SuccessFlag
</span><a href="GHC.Types.Basic.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#linkJSBinary"><span class="hs-identifier hs-type">linkJSBinary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html#UnitEnv"><span class="hs-identifier hs-type">UnitEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Unit.Types.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span id="linkJSBinary"><span class="annot"><span class="annottext">linkJSBinary :: Logger -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.html#linkJSBinary"><span class="hs-identifier hs-var hs-var">linkJSBinary</span></a></span></span><span> </span><span id="local-6989586621682084953"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084953"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682084954"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084954"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621682084955"><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084955"><span class="hs-identifier hs-var">unit_env</span></a></span></span><span> </span><span id="local-6989586621682084956"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682084956"><span class="hs-identifier hs-var">obj_files</span></a></span></span><span> </span><span id="local-6989586621682084957"><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084957"><span class="hs-identifier hs-var">pkg_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-comment">-- we use the default configuration for now. In the future we may expose</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-comment">-- settings to the user via DynFlags.</span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084958"><span class="annot"><span class="annottext">lc_cfg :: JSLinkConfig
</span><a href="#local-6989586621682084958"><span class="hs-identifier hs-var hs-var">lc_cfg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JSLinkConfig
</span><a href="GHC.StgToJS.Linker.Types.html#defaultJSLinkConfig"><span class="hs-identifier hs-var">defaultJSLinkConfig</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084959"><span class="annot"><span class="annottext">cfg :: StgToJSConfig
</span><a href="#local-6989586621682084959"><span class="hs-identifier hs-var hs-var">cfg</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; StgToJSConfig
</span><a href="GHC.Driver.Config.StgToJS.html#initStgToJSConfig"><span class="hs-identifier hs-var">initStgToJSConfig</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084954"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084965"><span class="annot"><span class="annottext">extra_js :: [FilePath]
</span><a href="#local-6989586621682084965"><span class="hs-identifier hs-var hs-var">extra_js</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath]
forall a. Monoid a =&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#mempty/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><span class="annottext">JSLinkConfig
-&gt; StgToJSConfig
-&gt; [FilePath]
-&gt; Logger
-&gt; DynFlags
-&gt; UnitEnv
-&gt; [FilePath]
-&gt; [UnitId]
-&gt; IO ()
</span><a href="GHC.StgToJS.Linker.Linker.html#jsLinkBinary"><span class="hs-identifier hs-var">jsLinkBinary</span></a></span><span> </span><span class="annot"><span class="annottext">JSLinkConfig
</span><a href="#local-6989586621682084958"><span class="hs-identifier hs-var">lc_cfg</span></a></span><span> </span><span class="annot"><span class="annottext">StgToJSConfig
</span><a href="#local-6989586621682084959"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682084965"><span class="hs-identifier hs-var">extra_js</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084953"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084954"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084955"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682084956"><span class="hs-identifier hs-var">obj_files</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084957"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#linkingNeeded"><span class="hs-identifier hs-type">linkingNeeded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html#UnitEnv"><span class="hs-identifier hs-type">UnitEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Linker.Types.html#Linkable"><span class="hs-identifier hs-type">Linkable</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Unit.Types.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Iface.Recomp.html#RecompileRequired"><span class="hs-identifier hs-type">RecompileRequired</span></a></span><span>
</span><span id="line-476"></span><span id="linkingNeeded"><span class="annot"><span class="annottext">linkingNeeded :: Logger
-&gt; DynFlags
-&gt; UnitEnv
-&gt; Bool
-&gt; [Linkable]
-&gt; [UnitId]
-&gt; IO RecompileRequired
</span><a href="GHC.Driver.Pipeline.html#linkingNeeded"><span class="hs-identifier hs-var hs-var">linkingNeeded</span></a></span></span><span> </span><span id="local-6989586621682084967"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084967"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682084968"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084968"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621682084969"><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084969"><span class="hs-identifier hs-var">unit_env</span></a></span></span><span> </span><span id="local-6989586621682084970"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084970"><span class="hs-identifier hs-var">staticLink</span></a></span></span><span> </span><span id="local-6989586621682084971"><span class="annot"><span class="annottext">[Linkable]
</span><a href="#local-6989586621682084971"><span class="hs-identifier hs-var">linkables</span></a></span></span><span> </span><span id="local-6989586621682084972"><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084972"><span class="hs-identifier hs-var">pkg_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-477"></span><span>        </span><span class="hs-comment">-- if the modification time on the executable is later than the</span><span>
</span><span id="line-478"></span><span>        </span><span class="hs-comment">-- modification times on all of the objects and libraries, then omit</span><span>
</span><span id="line-479"></span><span>        </span><span class="hs-comment">-- linking (unless the -fforce-recomp flag was given).</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084973"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682084973"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitEnv -&gt; Platform
</span><a href="GHC.Unit.Env.html#ue_platform"><span class="hs-identifier hs-var">ue_platform</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084969"><span class="hs-identifier hs-var">unit_env</span></a></span><span>
</span><span id="line-481"></span><span>      </span><span id="local-6989586621682084975"><span class="annot"><span class="annottext">unit_state :: UnitState
</span><a href="#local-6989586621682084975"><span class="hs-identifier hs-var hs-var">unit_state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; UnitEnv -&gt; UnitState
UnitEnv -&gt; UnitState
</span><a href="GHC.Unit.Env.html#ue_units"><span class="hs-identifier hs-var">ue_units</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084969"><span class="hs-identifier hs-var">unit_env</span></a></span><span>
</span><span id="line-482"></span><span>      </span><span id="local-6989586621682084977"><span class="annot"><span class="annottext">arch_os :: ArchOS
</span><a href="#local-6989586621682084977"><span class="hs-identifier hs-var hs-var">arch_os</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ArchOS
</span><a href="GHC.Platform.html#platformArchOS"><span class="hs-identifier hs-var">platformArchOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682084973"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-483"></span><span>      </span><span id="local-6989586621682084978"><span class="annot"><span class="annottext">exe_file :: FilePath
</span><a href="#local-6989586621682084978"><span class="hs-identifier hs-var hs-var">exe_file</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArchOS -&gt; Bool -&gt; Maybe FilePath -&gt; FilePath
</span><a href="GHC.Linker.Static.Utils.html#exeFileName"><span class="hs-identifier hs-var">exeFileName</span></a></span><span> </span><span class="annot"><span class="annottext">ArchOS
</span><a href="#local-6989586621682084977"><span class="hs-identifier hs-var">arch_os</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682084970"><span class="hs-identifier hs-var">staticLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Maybe FilePath
</span><a href="GHC.Driver.Session.html#outputFile_"><span class="hs-identifier hs-var">outputFile_</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084968"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>  </span><span id="local-6989586621682084979"><span class="annot"><span class="annottext">Either IOException UTCTime
</span><a href="#local-6989586621682084979"><span class="hs-identifier hs-var">e_exe_time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; IO (Either IOException UTCTime)
forall a. IO a -&gt; IO (Either IOException a)
</span><a href="GHC.Utils.Exception.html#tryIO"><span class="hs-identifier hs-var">tryIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO UTCTime -&gt; IO (Either IOException UTCTime))
-&gt; IO UTCTime -&gt; IO (Either IOException UTCTime)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO UTCTime
</span><a href="GHC.Utils.Misc.html#getModificationUTCTime"><span class="hs-identifier hs-var">getModificationUTCTime</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084978"><span class="hs-identifier hs-var">exe_file</span></a></span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOException UTCTime
</span><a href="#local-6989586621682084979"><span class="hs-identifier hs-var">e_exe_time</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Either.html#Left/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RecompileRequired -&gt; IO RecompileRequired
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(RecompileRequired -&gt; IO RecompileRequired)
-&gt; RecompileRequired -&gt; IO RecompileRequired
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CompileReason -&gt; RecompileRequired
</span><a href="GHC.Iface.Recomp.html#NeedsRecompile"><span class="hs-identifier hs-var">NeedsRecompile</span></a></span><span> </span><span class="annot"><span class="annottext">CompileReason
</span><a href="GHC.Iface.Recomp.html#MustCompile"><span class="hs-identifier hs-var">MustCompile</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Either.html#Right/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682084984"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621682084984"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-488"></span><span>        </span><span class="hs-comment">-- first check object files and extra_ld_inputs</span><span>
</span><span id="line-489"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084985"><span class="annot"><span class="annottext">extra_ld_inputs :: [FilePath]
</span><a href="#local-6989586621682084985"><span class="hs-identifier hs-var hs-var">extra_ld_inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084986"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.CliOption.html#FileOption"><span class="hs-identifier hs-type">FileOption</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682084986"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084986"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; [Option]
</span><a href="GHC.Driver.Session.html#ldInputs"><span class="hs-identifier hs-var">ldInputs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084968"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-490"></span><span>        </span><span id="local-6989586621682084989"><span class="annot"><span class="annottext">[Either IOException UTCTime]
</span><a href="#local-6989586621682084989"><span class="hs-identifier hs-var">e_extra_times</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO (Either IOException UTCTime))
-&gt; [FilePath] -&gt; IO [Either IOException UTCTime]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.2.1/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO UTCTime -&gt; IO (Either IOException UTCTime)
forall a. IO a -&gt; IO (Either IOException a)
</span><a href="GHC.Utils.Exception.html#tryIO"><span class="hs-identifier hs-var">tryIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO UTCTime -&gt; IO (Either IOException UTCTime))
-&gt; (FilePath -&gt; IO UTCTime)
-&gt; FilePath
-&gt; IO (Either IOException UTCTime)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO UTCTime
</span><a href="GHC.Utils.Misc.html#getModificationUTCTime"><span class="hs-identifier hs-var">getModificationUTCTime</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682084985"><span class="hs-identifier hs-var">extra_ld_inputs</span></a></span><span>
</span><span id="line-491"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682084991"><span class="annot"><span class="annottext">[IOException]
</span><a href="#local-6989586621682084991"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682084992"><span class="annot"><span class="annottext">[UTCTime]
</span><a href="#local-6989586621682084992"><span class="hs-identifier hs-var">extra_times</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either IOException UTCTime] -&gt; ([IOException], [UTCTime])
forall a b. [Either a b] -&gt; ([a], [b])
</span><a href="../../base-4.18.2.1/src/Data.Either.html#partitionEithers/Data.Either.html#partitionEithers"><span class="hs-identifier hs-var">partitionEithers</span></a></span><span> </span><span class="annot"><span class="annottext">[Either IOException UTCTime]
</span><a href="#local-6989586621682084989"><span class="hs-identifier hs-var">e_extra_times</span></a></span><span>
</span><span id="line-492"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682084993"><span class="annot"><span class="annottext">obj_times :: [UTCTime]
</span><a href="#local-6989586621682084993"><span class="hs-identifier hs-var hs-var">obj_times</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">(Linkable -&gt; UTCTime) -&gt; [Linkable] -&gt; [UTCTime]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Linkable -&gt; UTCTime
</span><a href="GHC.Linker.Types.html#linkableTime"><span class="hs-identifier hs-var">linkableTime</span></a></span><span> </span><span class="annot"><span class="annottext">[Linkable]
</span><a href="#local-6989586621682084971"><span class="hs-identifier hs-var">linkables</span></a></span><span> </span><span class="annot"><span class="annottext">[UTCTime] -&gt; [UTCTime] -&gt; [UTCTime]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[UTCTime]
</span><a href="#local-6989586621682084992"><span class="hs-identifier hs-var">extra_times</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[IOException] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[IOException]
</span><a href="#local-6989586621682084991"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; Bool) -&gt; [UTCTime] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#any/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621682084984"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UTCTime]
</span><a href="#local-6989586621682084993"><span class="hs-identifier hs-var">obj_times</span></a></span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">RecompileRequired -&gt; IO RecompileRequired
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(RecompileRequired -&gt; IO RecompileRequired)
-&gt; RecompileRequired -&gt; IO RecompileRequired
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RecompReason -&gt; RecompileRequired
</span><a href="GHC.Iface.Recomp.html#needsRecompileBecause"><span class="hs-identifier hs-var">needsRecompileBecause</span></a></span><span> </span><span class="annot"><span class="annottext">RecompReason
</span><a href="GHC.Iface.Recomp.html#ObjectsChanged"><span class="hs-identifier hs-var">ObjectsChanged</span></a></span><span>
</span><span id="line-495"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span>        </span><span class="hs-comment">-- next, check libraries. XXX this only checks Haskell libraries,</span><span>
</span><span id="line-498"></span><span>        </span><span class="hs-comment">-- not extra_libraries or -l things from the command line.</span><span>
</span><span id="line-499"></span><span>        </span><span class="hs-comment">-- pkg_deps is just the direct dependencies so take the transitive closure here</span><span>
</span><span id="line-500"></span><span>        </span><span class="hs-comment">-- to decide if we need to relink or not.</span><span>
</span><span id="line-501"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085000"><span class="annot"><span class="annottext">pkg_hslibs :: UniqDSet UnitId -&gt; UnitId -&gt; UniqDSet UnitId
</span><a href="#local-6989586621682085000"><span class="hs-identifier hs-var hs-var">pkg_hslibs</span></a></span></span><span> </span><span id="local-6989586621682085001"><span class="annot"><span class="annottext">UniqDSet UnitId
</span><a href="#local-6989586621682085001"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621682085002"><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621682085002"><span class="hs-identifier hs-var">uid</span></a></span></span><span>
</span><span id="line-502"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621682085002"><span class="hs-identifier hs-var">uid</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId -&gt; UniqDSet UnitId -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; UniqDSet a -&gt; Bool
</span><a href="GHC.Types.Unique.DSet.html#elementOfUniqDSet"><span class="hs-operator hs-var">`elementOfUniqDSet`</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet UnitId
</span><a href="#local-6989586621682085001"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqDSet UnitId
</span><a href="#local-6989586621682085001"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-503"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682085004"><span class="annot"><span class="annottext">UnitInfo
</span><a href="#local-6989586621682085004"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnitState -&gt; UnitId -&gt; Maybe UnitInfo
</span><a href="GHC.Unit.State.html#lookupUnitId"><span class="hs-identifier hs-var">lookupUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">UnitState
</span><a href="#local-6989586621682084975"><span class="hs-identifier hs-var">unit_state</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621682085002"><span class="hs-identifier hs-var">uid</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-504"></span><span>                  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#foldl%27/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">UniqDSet UnitId -&gt; UnitId -&gt; UniqDSet UnitId
</span><a href="#local-6989586621682085000"><span class="hs-identifier hs-var">pkg_hslibs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqDSet UnitId -&gt; UnitId -&gt; UniqDSet UnitId
forall a. Uniquable a =&gt; UniqDSet a -&gt; a -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#addOneToUniqDSet"><span class="hs-identifier hs-var">addOneToUniqDSet</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet UnitId
</span><a href="#local-6989586621682085001"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621682085002"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitInfo -&gt; [UnitId]
forall srcpkgid srcpkgname uid modulename mod.
GenericUnitInfo srcpkgid srcpkgname uid modulename mod -&gt; [uid]
</span><a href="../../ghc-boot-9.6.6/src/GHC.Unit.Database.html#unitDepends/GHC.Unit.Database.html#unitDepends"><span class="hs-identifier hs-var">unitDepends</span></a></span><span> </span><span class="annot"><span class="annottext">UnitInfo
</span><a href="#local-6989586621682085004"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqDSet UnitId
</span><a href="#local-6989586621682085001"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>            </span><span id="local-6989586621682085009"><span class="annot"><span class="annottext">all_pkg_deps :: UniqDSet UnitId
</span><a href="#local-6989586621682085009"><span class="hs-identifier hs-var hs-var">all_pkg_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#foldl%27/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">UniqDSet UnitId -&gt; UnitId -&gt; UniqDSet UnitId
</span><a href="#local-6989586621682085000"><span class="hs-identifier hs-var">pkg_hslibs</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet UnitId
forall a. UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#emptyUniqDSet"><span class="hs-identifier hs-var">emptyUniqDSet</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084972"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085011"><span class="annot"><span class="annottext">pkg_hslibs :: [([FilePath], FilePath)]
</span><a href="#local-6989586621682085011"><span class="hs-identifier hs-var hs-var">pkg_hslibs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ways -&gt; [UnitInfo] -&gt; [FilePath]
</span><a href="GHC.Unit.Info.html#collectLibraryDirs"><span class="hs-identifier hs-var">collectLibraryDirs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Ways
</span><a href="GHC.Driver.Session.html#ways"><span class="hs-identifier hs-var">ways</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084968"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnitInfo
</span><a href="#local-6989586621682085014"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085015"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682085014"><span class="annot"><span class="annottext">UnitInfo
</span><a href="#local-6989586621682085014"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(UnitId -&gt; Maybe UnitInfo) -&gt; [UnitId] -&gt; [Maybe UnitInfo]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitState -&gt; UnitId -&gt; Maybe UnitInfo
</span><a href="GHC.Unit.State.html#lookupUnitId"><span class="hs-identifier hs-var">lookupUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">UnitState
</span><a href="#local-6989586621682084975"><span class="hs-identifier hs-var">unit_state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqDSet UnitId -&gt; [UnitId]
forall a. UniqDSet a -&gt; [a]
</span><a href="GHC.Types.Unique.DSet.html#uniqDSetToList"><span class="hs-identifier hs-var">uniqDSetToList</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet UnitId
</span><a href="#local-6989586621682085009"><span class="hs-identifier hs-var">all_pkg_deps</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-511"></span><span>                            </span><span id="local-6989586621682085015"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085015"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GhcNameVersion -&gt; Ways -&gt; UnitInfo -&gt; [FilePath]
</span><a href="GHC.Unit.Info.html#unitHsLibs"><span class="hs-identifier hs-var">unitHsLibs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; GhcNameVersion
</span><a href="GHC.Driver.Session.html#ghcNameVersion"><span class="hs-identifier hs-var">ghcNameVersion</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084968"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Ways
</span><a href="GHC.Driver.Session.html#ways"><span class="hs-identifier hs-var">ways</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084968"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UnitInfo
</span><a href="#local-6989586621682085014"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>        </span><span id="local-6989586621682085019"><span class="annot"><span class="annottext">[Maybe FilePath]
</span><a href="#local-6989586621682085019"><span class="hs-identifier hs-var">pkg_libfiles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([FilePath], FilePath) -&gt; IO (Maybe FilePath))
-&gt; [([FilePath], FilePath)] -&gt; IO [Maybe FilePath]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.2.1/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([FilePath] -&gt; FilePath -&gt; IO (Maybe FilePath))
-&gt; ([FilePath], FilePath) -&gt; IO (Maybe FilePath)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../base-4.18.2.1/src/Data.Tuple.html#uncurry/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Ways -&gt; [FilePath] -&gt; FilePath -&gt; IO (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#findHSLib"><span class="hs-identifier hs-var">findHSLib</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682084973"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Ways
</span><a href="GHC.Driver.Session.html#ways"><span class="hs-identifier hs-var">ways</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084968"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([FilePath], FilePath)]
</span><a href="#local-6989586621682085011"><span class="hs-identifier hs-var">pkg_hslibs</span></a></span><span>
</span><span id="line-514"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Maybe FilePath -&gt; Bool) -&gt; [Maybe FilePath] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#any/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Maybe.html#isNothing/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe FilePath]
</span><a href="#local-6989586621682085019"><span class="hs-identifier hs-var">pkg_libfiles</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">RecompileRequired -&gt; IO RecompileRequired
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(RecompileRequired -&gt; IO RecompileRequired)
-&gt; RecompileRequired -&gt; IO RecompileRequired
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RecompReason -&gt; RecompileRequired
</span><a href="GHC.Iface.Recomp.html#needsRecompileBecause"><span class="hs-identifier hs-var">needsRecompileBecause</span></a></span><span> </span><span class="annot"><span class="annottext">RecompReason
</span><a href="GHC.Iface.Recomp.html#LibraryChanged"><span class="hs-identifier hs-var">LibraryChanged</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-515"></span><span>        </span><span id="local-6989586621682085024"><span class="annot"><span class="annottext">[Either IOException UTCTime]
</span><a href="#local-6989586621682085024"><span class="hs-identifier hs-var">e_lib_times</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO (Either IOException UTCTime))
-&gt; [FilePath] -&gt; IO [Either IOException UTCTime]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.2.1/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO UTCTime -&gt; IO (Either IOException UTCTime)
forall a. IO a -&gt; IO (Either IOException a)
</span><a href="GHC.Utils.Exception.html#tryIO"><span class="hs-identifier hs-var">tryIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO UTCTime -&gt; IO (Either IOException UTCTime))
-&gt; (FilePath -&gt; IO UTCTime)
-&gt; FilePath
-&gt; IO (Either IOException UTCTime)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO UTCTime
</span><a href="GHC.Utils.Misc.html#getModificationUTCTime"><span class="hs-identifier hs-var">getModificationUTCTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe FilePath] -&gt; [FilePath]
forall a. [Maybe a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/Data.Maybe.html#catMaybes/Data.Maybe.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe FilePath]
</span><a href="#local-6989586621682085019"><span class="hs-identifier hs-var">pkg_libfiles</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682085026"><span class="annot"><span class="annottext">[IOException]
</span><a href="#local-6989586621682085026"><span class="hs-identifier hs-var">lib_errs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682085027"><span class="annot"><span class="annottext">[UTCTime]
</span><a href="#local-6989586621682085027"><span class="hs-identifier hs-var">lib_times</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either IOException UTCTime] -&gt; ([IOException], [UTCTime])
forall a b. [Either a b] -&gt; ([a], [b])
</span><a href="../../base-4.18.2.1/src/Data.Either.html#partitionEithers/Data.Either.html#partitionEithers"><span class="hs-identifier hs-var">partitionEithers</span></a></span><span> </span><span class="annot"><span class="annottext">[Either IOException UTCTime]
</span><a href="#local-6989586621682085024"><span class="hs-identifier hs-var">e_lib_times</span></a></span><span>
</span><span id="line-518"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[IOException] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#null/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[IOException]
</span><a href="#local-6989586621682085026"><span class="hs-identifier hs-var">lib_errs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; Bool) -&gt; [UTCTime] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#any/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621682084984"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UTCTime]
</span><a href="#local-6989586621682085027"><span class="hs-identifier hs-var">lib_times</span></a></span><span>
</span><span id="line-519"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">RecompileRequired -&gt; IO RecompileRequired
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(RecompileRequired -&gt; IO RecompileRequired)
-&gt; RecompileRequired -&gt; IO RecompileRequired
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RecompReason -&gt; RecompileRequired
</span><a href="GHC.Iface.Recomp.html#needsRecompileBecause"><span class="hs-identifier hs-var">needsRecompileBecause</span></a></span><span> </span><span class="annot"><span class="annottext">RecompReason
</span><a href="GHC.Iface.Recomp.html#LibraryChanged"><span class="hs-identifier hs-var">LibraryChanged</span></a></span><span>
</span><span id="line-520"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-521"></span><span>            </span><span id="local-6989586621682085028"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085028"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; DynFlags -&gt; UnitEnv -&gt; [UnitId] -&gt; FilePath -&gt; IO Bool
</span><a href="GHC.Linker.ExtraObj.html#checkLinkInfo"><span class="hs-identifier hs-var">checkLinkInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682084967"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682084968"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682084969"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621682084972"><span class="hs-identifier hs-var">pkg_deps</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682084978"><span class="hs-identifier hs-var">exe_file</span></a></span><span>
</span><span id="line-522"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085028"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-523"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">RecompileRequired -&gt; IO RecompileRequired
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(RecompileRequired -&gt; IO RecompileRequired)
-&gt; RecompileRequired -&gt; IO RecompileRequired
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RecompReason -&gt; RecompileRequired
</span><a href="GHC.Iface.Recomp.html#needsRecompileBecause"><span class="hs-identifier hs-var">needsRecompileBecause</span></a></span><span> </span><span class="annot"><span class="annottext">RecompReason
</span><a href="GHC.Iface.Recomp.html#FlagsChanged"><span class="hs-identifier hs-var">FlagsChanged</span></a></span><span>
</span><span id="line-524"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">RecompileRequired -&gt; IO RecompileRequired
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">RecompileRequired
</span><a href="GHC.Iface.Recomp.html#UpToDate"><span class="hs-identifier hs-var">UpToDate</span></a></span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#findHSLib"><span class="hs-identifier hs-type">findHSLib</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Ways.html#Ways"><span class="hs-identifier hs-type">Ways</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span id="findHSLib"><span class="annot"><span class="annottext">findHSLib :: Platform -&gt; Ways -&gt; [FilePath] -&gt; FilePath -&gt; IO (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#findHSLib"><span class="hs-identifier hs-var hs-var">findHSLib</span></a></span></span><span> </span><span id="local-6989586621682085030"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682085030"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682085031"><span class="annot"><span class="annottext">Ways
</span><a href="#local-6989586621682085031"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span id="local-6989586621682085032"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085032"><span class="hs-identifier hs-var">dirs</span></a></span></span><span> </span><span id="local-6989586621682085033"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085033"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085034"><span class="annot"><span class="annottext">batch_lib_file :: FilePath
</span><a href="#local-6989586621682085034"><span class="hs-identifier hs-var hs-var">batch_lib_file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Ways
</span><a href="#local-6989586621682085031"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">Ways -&gt; Way -&gt; Bool
</span><a href="GHC.Platform.Ways.html#hasNotWay"><span class="hs-operator hs-var">`hasNotWay`</span></a></span><span> </span><span class="annot"><span class="annottext">Way
</span><a href="GHC.Platform.Ways.html#WayDyn"><span class="hs-identifier hs-var">WayDyn</span></a></span><span>
</span><span id="line-530"></span><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;lib&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085033"><span class="hs-identifier hs-var">lib</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.300.1/src/System.FilePath.Posix.html#%3C.%3E/System.FilePath.Posix.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;a&quot;</span></span><span>
</span><span id="line-531"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; FilePath -&gt; FilePath
</span><a href="GHC.Platform.html#platformSOName"><span class="hs-identifier hs-var">platformSOName</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682085030"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085033"><span class="hs-identifier hs-var">lib</span></a></span><span>
</span><span id="line-532"></span><span>  </span><span id="local-6989586621682085039"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085039"><span class="hs-identifier hs-var">found</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool) -&gt; [FilePath] -&gt; IO [FilePath]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><a href="../../base-4.18.2.1/src/Control.Monad.html#filterM/Control.Monad.html#filterM"><span class="hs-identifier hs-var">filterM</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="../../directory-1.3.8.5/src/System.Directory.html#doesFileExist/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.300.1/src/System.FilePath.Posix.html#%3C%2F%3E/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085034"><span class="hs-identifier hs-var">batch_lib_file</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085032"><span class="hs-identifier hs-var">dirs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085039"><span class="hs-identifier hs-var">found</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; IO (Maybe FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682085043"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085043"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[FilePath]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; IO (Maybe FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085043"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- Compile files in one-shot mode.</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#oneShot"><span class="hs-identifier hs-type">oneShot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#StopPhase"><span class="hs-identifier hs-type">StopPhase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span id="oneShot"><span class="annot"><span class="annottext">oneShot :: HscEnv -&gt; StopPhase -&gt; [(FilePath, Maybe Phase)] -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.html#oneShot"><span class="hs-identifier hs-var hs-var">oneShot</span></a></span></span><span> </span><span id="local-6989586621682085044"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085044"><span class="hs-identifier hs-var">orig_hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085045"><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085045"><span class="hs-identifier hs-var">stop_phase</span></a></span></span><span> </span><span id="local-6989586621682085046"><span class="annot"><span class="annottext">[(FilePath, Maybe Phase)]
</span><a href="#local-6989586621682085046"><span class="hs-identifier hs-var">srcs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-comment">-- In oneshot mode, initialise plugins specified on command line</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-comment">-- we also initialise in ghc/Main but this might be used as an entry point by API clients who</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-comment">-- should initialise their own plugins but may not.</span><span>
</span><span id="line-545"></span><span>  </span><span id="local-6989586621682085047"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085047"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; IO HscEnv
</span><a href="GHC.Runtime.Loader.html#initializePlugins"><span class="hs-identifier hs-var">initializePlugins</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085044"><span class="hs-identifier hs-var">orig_hsc_env</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span id="local-6989586621682085048"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085048"><span class="hs-identifier hs-var">o_files</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((FilePath, Maybe Phase) -&gt; IO (Maybe FilePath))
-&gt; [(FilePath, Maybe Phase)] -&gt; IO [FilePath]
forall (m :: * -&gt; *) a b.
Applicative m =&gt;
(a -&gt; m (Maybe b)) -&gt; [a] -&gt; m [b]
</span><a href="GHC.Utils.Monad.html#mapMaybeM"><span class="hs-identifier hs-var">mapMaybeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv
-&gt; StopPhase -&gt; (FilePath, Maybe Phase) -&gt; IO (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#compileFile"><span class="hs-identifier hs-var">compileFile</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085047"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085045"><span class="hs-identifier hs-var">stop_phase</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FilePath, Maybe Phase)]
</span><a href="#local-6989586621682085046"><span class="hs-identifier hs-var">srcs</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085045"><span class="hs-identifier hs-var">stop_phase</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#StopPreprocess"><span class="hs-identifier hs-var">StopPreprocess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#StopC"><span class="hs-identifier hs-var">StopC</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#StopAs"><span class="hs-identifier hs-var">StopAs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#NoStop"><span class="hs-identifier hs-var">NoStop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; [FilePath] -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.html#doLink"><span class="hs-identifier hs-var">doLink</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085047"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085048"><span class="hs-identifier hs-var">o_files</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileFile"><span class="hs-identifier hs-type">compileFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#StopPhase"><span class="hs-identifier hs-type">StopPhase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span id="compileFile"><span class="annot"><span class="annottext">compileFile :: HscEnv
-&gt; StopPhase -&gt; (FilePath, Maybe Phase) -&gt; IO (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#compileFile"><span class="hs-identifier hs-var hs-var">compileFile</span></a></span></span><span> </span><span id="local-6989586621682085052"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085052"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085053"><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085053"><span class="hs-identifier hs-var">stop_phase</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682085054"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085054"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085055"><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682085055"><span class="hs-identifier hs-var">mb_phase</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-555"></span><span>   </span><span id="local-6989586621682085056"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085056"><span class="hs-identifier hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="../../directory-1.3.8.5/src/System.Directory.html#doesFileExist/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085054"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-556"></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085056"><span class="hs-identifier hs-var">exists</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-557"></span><span>        </span><span class="annot"><span class="annottext">GhcException -&gt; IO ()
forall a. GhcException -&gt; IO a
</span><a href="GHC.Utils.Panic.html#throwGhcExceptionIO"><span class="hs-identifier hs-var">throwGhcExceptionIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; GhcException
</span><a href="GHC.Utils.Panic.html#CmdLineError"><span class="hs-identifier hs-var">CmdLineError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;does not exist: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085054"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span>   </span><span class="hs-keyword">let</span><span>
</span><span id="line-560"></span><span>        </span><span id="local-6989586621682085059"><span class="annot"><span class="annottext">dflags :: DynFlags
</span><a href="#local-6989586621682085059"><span class="hs-identifier hs-var hs-var">dflags</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085052"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-561"></span><span>        </span><span id="local-6989586621682085060"><span class="annot"><span class="annottext">mb_o_file :: Maybe FilePath
</span><a href="#local-6989586621682085060"><span class="hs-identifier hs-var hs-var">mb_o_file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Maybe FilePath
</span><a href="GHC.Driver.Session.html#outputFile"><span class="hs-identifier hs-var">outputFile</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085059"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-562"></span><span>        </span><span id="local-6989586621682085062"><span class="annot"><span class="annottext">ghc_link :: GhcLink
</span><a href="#local-6989586621682085062"><span class="hs-identifier hs-var hs-var">ghc_link</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; GhcLink
</span><a href="GHC.Driver.Session.html#ghcLink"><span class="hs-identifier hs-var">ghcLink</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085059"><span class="hs-identifier hs-var">dflags</span></a></span><span>      </span><span class="hs-comment">-- Set by -c or -no-link</span><span>
</span><span id="line-563"></span><span>        </span><span id="local-6989586621682085063"><span class="annot"><span class="annottext">notStopPreprocess :: Bool
</span><a href="#local-6989586621682085063"><span class="hs-identifier hs-var hs-var">notStopPreprocess</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#StopPreprocess"><span class="hs-identifier hs-var">StopPreprocess</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085053"><span class="hs-identifier hs-var">stop_phase</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-564"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085053"><span class="hs-identifier hs-var">stop_phase</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-comment">-- When linking, the -o argument refers to the linker's output.</span><span>
</span><span id="line-566"></span><span>        </span><span class="hs-comment">-- otherwise, we use it as the name for the pipeline's output.</span><span>
</span><span id="line-567"></span><span>        </span><span id="local-6989586621682085064"><span class="annot"><span class="annottext">output :: PipelineOutput
</span><a href="#local-6989586621682085064"><span class="hs-identifier hs-var hs-var">output</span></a></span></span><span>
</span><span id="line-568"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Backend -&gt; Bool
</span><a href="GHC.Driver.Backend.html#backendGeneratesCode"><span class="hs-identifier hs-var">backendGeneratesCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085059"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085063"><span class="hs-identifier hs-var">notStopPreprocess</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#NoOutputFile"><span class="hs-identifier hs-var">NoOutputFile</span></a></span><span>
</span><span id="line-569"></span><span>                </span><span class="hs-comment">-- avoid -E -fno-code undesirable interactions. see #20439</span><span>
</span><span id="line-570"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#NoStop"><span class="hs-identifier hs-var">NoStop</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085053"><span class="hs-identifier hs-var">stop_phase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GhcLink -&gt; Bool
</span><a href="GHC.Driver.Session.html#isNoLink"><span class="hs-identifier hs-var">isNoLink</span></a></span><span> </span><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682085062"><span class="hs-identifier hs-var">ghc_link</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#Persistent"><span class="hs-identifier hs-var">Persistent</span></a></span><span>
</span><span id="line-571"></span><span>                </span><span class="hs-comment">-- -o foo applies to linker</span><span>
</span><span id="line-572"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Maybe.html#isJust/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621682085060"><span class="hs-identifier hs-var">mb_o_file</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#SpecificFile"><span class="hs-identifier hs-var">SpecificFile</span></a></span><span>
</span><span id="line-573"></span><span>                </span><span class="hs-comment">-- -o foo applies to the file we are compiling now</span><span>
</span><span id="line-574"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#Persistent"><span class="hs-identifier hs-var">Persistent</span></a></span><span>
</span><span id="line-575"></span><span>        </span><span id="local-6989586621682085069"><span class="annot"><span class="annottext">pipe_env :: PipeEnv
</span><a href="#local-6989586621682085069"><span class="hs-identifier hs-var hs-var">pipe_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StopPhase -&gt; FilePath -&gt; Maybe Phase -&gt; PipelineOutput -&gt; PipeEnv
</span><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier hs-var">mkPipeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085053"><span class="hs-identifier hs-var">stop_phase</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085054"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682085055"><span class="hs-identifier hs-var">mb_phase</span></a></span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="#local-6989586621682085064"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-576"></span><span>        </span><span id="local-6989586621682085070"><span class="annot"><span class="annottext">pipeline :: HookedUse (Maybe FilePath)
</span><a href="#local-6989586621682085070"><span class="hs-identifier hs-var hs-var">pipeline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; FilePath -&gt; Maybe Phase -&gt; HookedUse (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; Maybe Phase -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#pipelineStart"><span class="hs-identifier hs-var">pipelineStart</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085069"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Pipeline.html#setDumpPrefix"><span class="hs-identifier hs-var">setDumpPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085069"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085052"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085054"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682085055"><span class="hs-identifier hs-var">mb_phase</span></a></span><span>
</span><span id="line-577"></span><span>   </span><span class="annot"><span class="annottext">Hooks -&gt; HookedUse (Maybe FilePath) -&gt; IO (Maybe FilePath)
forall a. Hooks -&gt; HookedUse a -&gt; IO a
</span><a href="GHC.Driver.Pipeline.Execute.html#runPipeline"><span class="hs-identifier hs-var">runPipeline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Hooks
</span><a href="GHC.Driver.Env.Types.html#hsc_hooks"><span class="hs-identifier hs-var">hsc_hooks</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085052"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HookedUse (Maybe FilePath)
</span><a href="#local-6989586621682085070"><span class="hs-identifier hs-var">pipeline</span></a></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#doLink"><span class="hs-identifier hs-type">doLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span id="doLink"><span class="annot"><span class="annottext">doLink :: HscEnv -&gt; [FilePath] -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.html#doLink"><span class="hs-identifier hs-var hs-var">doLink</span></a></span></span><span> </span><span id="local-6989586621682085071"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085071"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085072"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085072"><span class="hs-identifier hs-var">o_files</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-583"></span><span>    </span><span id="local-6989586621682085073"><span class="annot"><span class="annottext">dflags :: DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var hs-var">dflags</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span>   </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085071"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-584"></span><span>    </span><span id="local-6989586621682085074"><span class="annot"><span class="annottext">logger :: Logger
</span><a href="#local-6989586621682085074"><span class="hs-identifier hs-var hs-var">logger</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span>   </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085071"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-585"></span><span>    </span><span id="local-6989586621682085075"><span class="annot"><span class="annottext">unit_env :: UnitEnv
</span><a href="#local-6989586621682085075"><span class="hs-identifier hs-var hs-var">unit_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; UnitEnv
</span><a href="GHC.Driver.Env.Types.html#hsc_unit_env"><span class="hs-identifier hs-var">hsc_unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085071"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-586"></span><span>    </span><span id="local-6989586621682085077"><span class="annot"><span class="annottext">tmpfs :: TmpFs
</span><a href="#local-6989586621682085077"><span class="hs-identifier hs-var hs-var">tmpfs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; TmpFs
</span><a href="GHC.Driver.Env.Types.html#hsc_tmpfs"><span class="hs-identifier hs-var">hsc_tmpfs</span></a></span><span>    </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085071"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; GhcLink
</span><a href="GHC.Driver.Session.html#ghcLink"><span class="hs-identifier hs-var">ghcLink</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#NoLink"><span class="hs-identifier hs-var">NoLink</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkBinary"><span class="hs-identifier hs-var">LinkBinary</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; Bool
</span><a href="GHC.Driver.Backend.html#backendUseJSLinker"><span class="hs-identifier hs-var">backendUseJSLinker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.html#linkJSBinary"><span class="hs-identifier hs-var">linkJSBinary</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682085074"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682085075"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085072"><span class="hs-identifier hs-var">o_files</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; TmpFs -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Linker.Static.html#linkBinary"><span class="hs-identifier hs-var">linkBinary</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682085074"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682085077"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682085075"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085072"><span class="hs-identifier hs-var">o_files</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkStaticLib"><span class="hs-identifier hs-var">LinkStaticLib</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Linker.Static.html#linkStaticLib"><span class="hs-identifier hs-var">linkStaticLib</span></a></span><span>      </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682085074"><span class="hs-identifier hs-var">logger</span></a></span><span>       </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682085075"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085072"><span class="hs-identifier hs-var">o_files</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkDynLib"><span class="hs-identifier hs-var">LinkDynLib</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; TmpFs -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.Execute.html#linkDynLibCheck"><span class="hs-identifier hs-var">linkDynLibCheck</span></a></span><span>    </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682085074"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682085077"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621682085075"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085072"><span class="hs-identifier hs-var">o_files</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><span class="annottext">GhcLink
</span><a href="GHC.Driver.Session.html#LinkMergedObj"><span class="hs-identifier hs-var">LinkMergedObj</span></a></span><span>
</span><span id="line-597"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682085078"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085078"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Maybe FilePath
</span><a href="GHC.Driver.Session.html#outputFile"><span class="hs-identifier hs-var">outputFile</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-598"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085079"><span class="annot"><span class="annottext">objs :: [FilePath]
</span><a href="#local-6989586621682085079"><span class="hs-identifier hs-var hs-var">objs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085080"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.CliOption.html#FileOption"><span class="hs-identifier hs-type">FileOption</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682085080"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085080"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; [Option]
</span><a href="GHC.Driver.Session.html#ldInputs"><span class="hs-identifier hs-var">ldInputs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085073"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-599"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; [FilePath] -&gt; FilePath -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.Execute.html#joinObjectFiles"><span class="hs-identifier hs-var">joinObjectFiles</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085071"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085072"><span class="hs-identifier hs-var">o_files</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085079"><span class="hs-identifier hs-var">objs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085078"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Output path must be specified for LinkMergedObj&quot;</span></span><span>
</span><span id="line-601"></span><span>    </span><span id="local-6989586621682085082"><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682085082"><span class="hs-identifier hs-var">other</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GhcLink -&gt; IO ()
forall a. GhcLink -&gt; a
</span><a href="GHC.Driver.Pipeline.html#panicBadLink"><span class="hs-identifier hs-var">panicBadLink</span></a></span><span> </span><span class="annot"><span class="annottext">GhcLink
</span><a href="#local-6989586621682085082"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- stub .h and .c files (for foreign export support), and cc files.</span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-comment">-- The _stub.c file is derived from the haskell source file, possibly taking</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- into account the -stubdir option.</span><span>
</span><span id="line-608"></span><span class="hs-comment">--</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- The object file created by compiling the _stub.c file is put into a</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- temporary file, which will be later combined with the main .o file</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- (see the MergeForeign phase).</span><span>
</span><span id="line-612"></span><span class="hs-comment">--</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- Moreover, we also let the user emit arbitrary C/C++/ObjC/ObjC++ files</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- from TH, that are then compiled and linked to the module. This is</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- useful to implement facilities such as inline-c.</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileForeign"><span class="hs-identifier hs-type">compileForeign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignSrcLang</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-618"></span><span id="compileForeign"><span class="annot"><span class="annottext">compileForeign :: HscEnv -&gt; ForeignSrcLang -&gt; FilePath -&gt; IO FilePath
</span><a href="GHC.Driver.Pipeline.html#compileForeign"><span class="hs-identifier hs-var hs-var">compileForeign</span></a></span></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ForeignSrcLang
</span><span class="hs-identifier hs-var">RawObject</span></span><span> </span><span id="local-6989586621682085084"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085084"><span class="hs-identifier hs-var">object_file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085084"><span class="hs-identifier hs-var">object_file</span></a></span><span>
</span><span id="line-619"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileForeign"><span class="hs-identifier hs-var">compileForeign</span></a></span><span> </span><span id="local-6989586621682085085"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085085"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085086"><span class="annot"><span class="annottext">ForeignSrcLang
</span><a href="#local-6989586621682085086"><span class="hs-identifier hs-var">lang</span></a></span></span><span> </span><span id="local-6989586621682085087"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085087"><span class="hs-identifier hs-var">stub_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-620"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085088"><span class="annot"><span class="annottext">pipeline :: PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; HookedUse (Maybe FilePath)
</span><a href="#local-6989586621682085088"><span class="hs-identifier hs-var hs-var">pipeline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForeignSrcLang
</span><a href="#local-6989586621682085086"><span class="hs-identifier hs-var">lang</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-621"></span><span>              </span><span class="annot"><span class="annottext">ForeignSrcLang
</span><span class="hs-identifier hs-var">LangC</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; HookedUse (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-var">viaCPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cc"><span class="hs-identifier hs-var">Cc</span></a></span><span>
</span><span id="line-622"></span><span>              </span><span class="annot"><span class="annottext">ForeignSrcLang
</span><span class="hs-identifier hs-var">LangCxx</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; HookedUse (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-var">viaCPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Ccxx"><span class="hs-identifier hs-var">Ccxx</span></a></span><span>
</span><span id="line-623"></span><span>              </span><span class="annot"><span class="annottext">ForeignSrcLang
</span><span class="hs-identifier hs-var">LangObjc</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; HookedUse (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-var">viaCPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cobjc"><span class="hs-identifier hs-var">Cobjc</span></a></span><span>
</span><span id="line-624"></span><span>              </span><span class="annot"><span class="annottext">ForeignSrcLang
</span><span class="hs-identifier hs-var">LangObjcxx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; HookedUse (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-var">viaCPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cobjcxx"><span class="hs-identifier hs-var">Cobjcxx</span></a></span><span>
</span><span id="line-625"></span><span>              </span><span class="annot"><span class="annottext">ForeignSrcLang
</span><span class="hs-identifier hs-var">LangAsm</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682085098"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085098"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span id="local-6989586621682085099"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085099"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085100"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085100"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621682085101"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085101"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; HookedUse (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#asPipeline"><span class="hs-identifier hs-var">asPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085098"><span class="hs-identifier hs-var">pe</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085099"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085100"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085101"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-626"></span><span>              </span><span class="annot"><span class="annottext">ForeignSrcLang
</span><span class="hs-identifier hs-var">LangJs</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682085103"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085103"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span id="local-6989586621682085104"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085104"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085105"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085105"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621682085106"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085106"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe FilePath)
-&gt; HookedUse FilePath -&gt; HookedUse (Maybe FilePath)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; HookedUse FilePath
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m FilePath
</span><a href="GHC.Driver.Pipeline.html#foreignJsPipeline"><span class="hs-identifier hs-var">foreignJsPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085103"><span class="hs-identifier hs-var">pe</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085104"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085105"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085106"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 811
</span><span>              </span><span class="hs-identifier">RawObject</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">panic</span><span> </span><span class="hs-string">&quot;compileForeign: should be unreachable&quot;</span><span class="hs-cpp">
#endif
</span><span>            </span><span id="local-6989586621682085109"><span class="annot"><span class="annottext">pipe_env :: PipeEnv
</span><a href="#local-6989586621682085109"><span class="hs-identifier hs-var hs-var">pipe_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StopPhase -&gt; FilePath -&gt; Maybe Phase -&gt; PipelineOutput -&gt; PipeEnv
</span><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier hs-var">mkPipeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#NoStop"><span class="hs-identifier hs-var">NoStop</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085087"><span class="hs-identifier hs-var">stub_c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Phase
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TempFileLifetime -&gt; PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#Temporary"><span class="hs-identifier hs-var">Temporary</span></a></span><span> </span><span class="annot"><span class="annottext">TempFileLifetime
</span><a href="GHC.Utils.TmpFs.html#TFL_GhcSession"><span class="hs-identifier hs-var">TFL_GhcSession</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>        </span><span id="local-6989586621682085110"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621682085110"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Hooks -&gt; HookedUse (Maybe FilePath) -&gt; IO (Maybe FilePath)
forall a. Hooks -&gt; HookedUse a -&gt; IO a
</span><a href="GHC.Driver.Pipeline.Execute.html#runPipeline"><span class="hs-identifier hs-var">runPipeline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Hooks
</span><a href="GHC.Driver.Env.Types.html#hsc_hooks"><span class="hs-identifier hs-var">hsc_hooks</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085085"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; HookedUse (Maybe FilePath)
</span><a href="#local-6989586621682085088"><span class="hs-identifier hs-var">pipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085109"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085085"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085087"><span class="hs-identifier hs-var">stub_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621682085110"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-633"></span><span>          </span><span class="hs-comment">-- This should never happen as viaCPipeline should only return `Nothing` when the stop phase is `StopC`.</span><span>
</span><span id="line-634"></span><span>          </span><span class="hs-comment">-- and the same should never happen for asPipeline</span><span>
</span><span id="line-635"></span><span>          </span><span class="hs-comment">-- Future refactoring to not check StopC for this case</span><span>
</span><span id="line-636"></span><span>          </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc -&gt; IO FilePath
forall a. HasCallStack =&gt; FilePath -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compileForeign&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085087"><span class="hs-identifier hs-var">stub_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>          </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682085111"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085111"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085111"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#compileEmptyStub"><span class="hs-identifier hs-type">compileEmptyStub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span id="compileEmptyStub"><span class="annot"><span class="annottext">compileEmptyStub :: DynFlags
-&gt; HscEnv -&gt; FilePath -&gt; ModLocation -&gt; ModuleName -&gt; IO ()
</span><a href="GHC.Driver.Pipeline.html#compileEmptyStub"><span class="hs-identifier hs-var hs-var">compileEmptyStub</span></a></span></span><span> </span><span id="local-6989586621682085112"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085112"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621682085113"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085113"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085114"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085114"><span class="hs-identifier hs-var">basename</span></a></span></span><span> </span><span id="local-6989586621682085115"><span class="annot"><span class="annottext">ModLocation
</span><a href="#local-6989586621682085115"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621682085116"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682085116"><span class="hs-identifier hs-var">mod_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-comment">-- To maintain the invariant that every Haskell file</span><span>
</span><span id="line-642"></span><span>  </span><span class="hs-comment">-- compiles to object code, we make an empty (but</span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-comment">-- valid) stub object file for signatures.  However,</span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-comment">-- we make sure this object file has a unique symbol,</span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-comment">-- so that ranlib on OS X doesn't complain, see</span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-comment">-- https://gitlab.haskell.org/ghc/ghc/issues/12673</span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-comment">-- and https://github.com/haskell/cabal/issues/2257</span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085117"><span class="annot"><span class="annottext">logger :: Logger
</span><a href="#local-6989586621682085117"><span class="hs-identifier hs-var hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085113"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085118"><span class="annot"><span class="annottext">tmpfs :: TmpFs
</span><a href="#local-6989586621682085118"><span class="hs-identifier hs-var hs-var">tmpfs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; TmpFs
</span><a href="GHC.Driver.Env.Types.html#hsc_tmpfs"><span class="hs-identifier hs-var">hsc_tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085113"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085119"><span class="annot"><span class="annottext">home_unit :: HomeUnit
</span><a href="#local-6989586621682085119"><span class="hs-identifier hs-var hs-var">home_unit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; HomeUnit
</span><a href="GHC.Driver.Env.html#hsc_home_unit"><span class="hs-identifier hs-var">hsc_home_unit</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085113"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; DefunctionalizedCodeOutput
</span><a href="GHC.Driver.Backend.html#backendCodeOutput"><span class="hs-identifier hs-var">backendCodeOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085112"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-653"></span><span>    </span><span class="annot"><span class="annottext">DefunctionalizedCodeOutput
</span><a href="GHC.Driver.Backend.html#JSCodeOutput"><span class="hs-identifier hs-var">JSCodeOutput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-654"></span><span>      </span><span id="local-6989586621682085123"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085123"><span class="hs-identifier hs-var">empty_stub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; TmpFs -&gt; TempDir -&gt; TempFileLifetime -&gt; FilePath -&gt; IO FilePath
</span><a href="GHC.Utils.TmpFs.html#newTempName"><span class="hs-identifier hs-var">newTempName</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682085117"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682085118"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; TempDir
</span><a href="GHC.Driver.Session.html#tmpDir"><span class="hs-identifier hs-var">tmpDir</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085112"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TempFileLifetime
</span><a href="GHC.Utils.TmpFs.html#TFL_CurrentModule"><span class="hs-identifier hs-var">TFL_CurrentModule</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;js&quot;</span></span><span>
</span><span id="line-655"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085124"><span class="annot"><span class="annottext">src :: SDoc
</span><a href="#local-6989586621682085124"><span class="hs-identifier hs-var hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HomeUnit -&gt; ModuleName -&gt; Module
</span><a href="GHC.Unit.Home.html#mkHomeModule"><span class="hs-identifier hs-var">mkHomeModule</span></a></span><span> </span><span class="annot"><span class="annottext">HomeUnit
</span><a href="#local-6989586621682085119"><span class="hs-identifier hs-var">home_unit</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682085116"><span class="hs-identifier hs-var">mod_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;= 0;&quot;</span></span><span>
</span><span id="line-656"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><a href="../../base-4.18.2.1/src/System.IO.html#writeFile/System.IO.html#writeFile"><span class="hs-identifier hs-var">writeFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085123"><span class="hs-identifier hs-var">empty_stub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; SDoc -&gt; FilePath
</span><a href="GHC.Driver.Ppr.html#showSDoc"><span class="hs-identifier hs-var">showSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085112"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprCode"><span class="hs-identifier hs-var">pprCode</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682085124"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085129"><span class="annot"><span class="annottext">pipe_env :: PipeEnv
</span><a href="#local-6989586621682085129"><span class="hs-identifier hs-var hs-var">pipe_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StopPhase -&gt; FilePath -&gt; Maybe Phase -&gt; PipelineOutput -&gt; PipeEnv
</span><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier hs-var">mkPipeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#NoStop"><span class="hs-identifier hs-var">NoStop</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085123"><span class="hs-identifier hs-var">empty_stub</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Phase
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#Persistent"><span class="hs-identifier hs-var">Persistent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#src_basename"><span class="hs-identifier hs-var">src_basename</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682085114"><span class="hs-identifier hs-type">basename</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-658"></span><span>          </span><span id="local-6989586621682085131"><span class="annot"><span class="annottext">pipeline :: HookedUse (Maybe FilePath)
</span><a href="#local-6989586621682085131"><span class="hs-identifier hs-var hs-var">pipeline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe FilePath)
-&gt; HookedUse FilePath -&gt; HookedUse (Maybe FilePath)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; HookedUse FilePath
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m FilePath
</span><a href="GHC.Driver.Pipeline.html#foreignJsPipeline"><span class="hs-identifier hs-var">foreignJsPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085129"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085113"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModLocation -&gt; Maybe ModLocation
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ModLocation
</span><a href="#local-6989586621682085115"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085123"><span class="hs-identifier hs-var">empty_stub</span></a></span><span>
</span><span id="line-659"></span><span>      </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Hooks -&gt; HookedUse (Maybe FilePath) -&gt; IO (Maybe FilePath)
forall a. Hooks -&gt; HookedUse a -&gt; IO a
</span><a href="GHC.Driver.Pipeline.Execute.html#runPipeline"><span class="hs-identifier hs-var">runPipeline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Hooks
</span><a href="GHC.Driver.Env.Types.html#hsc_hooks"><span class="hs-identifier hs-var">hsc_hooks</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085113"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HookedUse (Maybe FilePath)
</span><a href="#local-6989586621682085131"><span class="hs-identifier hs-var">pipeline</span></a></span><span>
</span><span id="line-660"></span><span>      </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><span class="annottext">DefunctionalizedCodeOutput
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-663"></span><span>      </span><span id="local-6989586621682085132"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085132"><span class="hs-identifier hs-var">empty_stub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; TmpFs -&gt; TempDir -&gt; TempFileLifetime -&gt; FilePath -&gt; IO FilePath
</span><a href="GHC.Utils.TmpFs.html#newTempName"><span class="hs-identifier hs-var">newTempName</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682085117"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621682085118"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; TempDir
</span><a href="GHC.Driver.Session.html#tmpDir"><span class="hs-identifier hs-var">tmpDir</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085112"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TempFileLifetime
</span><a href="GHC.Utils.TmpFs.html#TFL_CurrentModule"><span class="hs-identifier hs-var">TFL_CurrentModule</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;c&quot;</span></span><span>
</span><span id="line-664"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085133"><span class="annot"><span class="annottext">src :: SDoc
</span><a href="#local-6989586621682085133"><span class="hs-identifier hs-var hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;int&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HomeUnit -&gt; ModuleName -&gt; Module
</span><a href="GHC.Unit.Home.html#mkHomeModule"><span class="hs-identifier hs-var">mkHomeModule</span></a></span><span> </span><span class="annot"><span class="annottext">HomeUnit
</span><a href="#local-6989586621682085119"><span class="hs-identifier hs-var">home_unit</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682085116"><span class="hs-identifier hs-var">mod_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SDoc
forall doc. IsLine doc =&gt; FilePath -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;= 0;&quot;</span></span><span>
</span><span id="line-665"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><a href="../../base-4.18.2.1/src/System.IO.html#writeFile/System.IO.html#writeFile"><span class="hs-identifier hs-var">writeFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085132"><span class="hs-identifier hs-var">empty_stub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; SDoc -&gt; FilePath
</span><a href="GHC.Driver.Ppr.html#showSDoc"><span class="hs-identifier hs-var">showSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085112"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprCode"><span class="hs-identifier hs-var">pprCode</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682085133"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085134"><span class="annot"><span class="annottext">pipe_env :: PipeEnv
</span><a href="#local-6989586621682085134"><span class="hs-identifier hs-var hs-var">pipe_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StopPhase -&gt; FilePath -&gt; Maybe Phase -&gt; PipelineOutput -&gt; PipeEnv
</span><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier hs-var">mkPipeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#NoStop"><span class="hs-identifier hs-var">NoStop</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085132"><span class="hs-identifier hs-var">empty_stub</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Phase
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#Persistent"><span class="hs-identifier hs-var">Persistent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#src_basename"><span class="hs-identifier hs-var">src_basename</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682085114"><span class="hs-identifier hs-type">basename</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-667"></span><span>          </span><span id="local-6989586621682085135"><span class="annot"><span class="annottext">pipeline :: HookedUse (Maybe FilePath)
</span><a href="#local-6989586621682085135"><span class="hs-identifier hs-var hs-var">pipeline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; HookedUse (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-var">viaCPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#HCc"><span class="hs-identifier hs-var">HCc</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085134"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085113"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModLocation -&gt; Maybe ModLocation
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ModLocation
</span><a href="#local-6989586621682085115"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085132"><span class="hs-identifier hs-var">empty_stub</span></a></span><span>
</span><span id="line-668"></span><span>      </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Hooks -&gt; HookedUse (Maybe FilePath) -&gt; IO (Maybe FilePath)
forall a. Hooks -&gt; HookedUse a -&gt; IO a
</span><a href="GHC.Driver.Pipeline.Execute.html#runPipeline"><span class="hs-identifier hs-var">runPipeline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Hooks
</span><a href="GHC.Driver.Env.Types.html#hsc_hooks"><span class="hs-identifier hs-var">hsc_hooks</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085113"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HookedUse (Maybe FilePath)
</span><a href="#local-6989586621682085135"><span class="hs-identifier hs-var">pipeline</span></a></span><span>
</span><span id="line-669"></span><span>      </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span class="hs-comment">{- Environment Initialisation -}</span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier hs-type">mkPipeEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#StopPhase"><span class="hs-identifier hs-type">StopPhase</span></a></span><span> </span><span class="hs-comment">-- End phase</span><span>
</span><span id="line-676"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-comment">-- input fn</span><span>
</span><span id="line-677"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span>
</span><span id="line-678"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipelineOutput"><span class="hs-identifier hs-type">PipelineOutput</span></a></span><span> </span><span class="hs-comment">-- Output</span><span>
</span><span id="line-679"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span>
</span><span id="line-680"></span><span id="mkPipeEnv"><span class="annot"><span class="annottext">mkPipeEnv :: StopPhase -&gt; FilePath -&gt; Maybe Phase -&gt; PipelineOutput -&gt; PipeEnv
</span><a href="GHC.Driver.Pipeline.html#mkPipeEnv"><span class="hs-identifier hs-var hs-var">mkPipeEnv</span></a></span></span><span> </span><span id="local-6989586621682085137"><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085137"><span class="hs-identifier hs-var">stop_phase</span></a></span></span><span>  </span><span id="local-6989586621682085138"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085138"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span id="local-6989586621682085139"><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682085139"><span class="hs-identifier hs-var">start_phase</span></a></span></span><span> </span><span id="local-6989586621682085140"><span class="annot"><span class="annottext">PipelineOutput
</span><a href="#local-6989586621682085140"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-681"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682085141"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085141"><span class="hs-identifier hs-var">basename</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085142"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085142"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="../../filepath-1.4.300.1/src/System.FilePath.Posix.html#splitExtension/System.FilePath.Posix.html#splitExtension"><span class="hs-identifier hs-var">splitExtension</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085138"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-682"></span><span>      </span><span id="local-6989586621682085144"><span class="annot"><span class="annottext">suffix' :: FilePath
</span><a href="#local-6989586621682085144"><span class="hs-identifier hs-var hs-var">suffix'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath -&gt; FilePath
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.List.html#drop/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085142"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="hs-comment">-- strip off the .</span><span>
</span><span id="line-683"></span><span>      </span><span id="local-6989586621682085146"><span class="annot"><span class="annottext">env :: PipeEnv
</span><a href="#local-6989586621682085146"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">StopPhase
stop_phase :: StopPhase
stop_phase :: StopPhase
</span><a href="#local-6989586621682085137"><span class="hs-identifier hs-var hs-var">stop_phase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-684"></span><span>                     </span><span class="annot"><span class="annottext">src_filename :: FilePath
</span><a href="GHC.Driver.Pipeline.Monad.html#src_filename"><span class="hs-identifier hs-var">src_filename</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085138"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-685"></span><span>                     </span><span class="annot"><span class="annottext">src_basename :: FilePath
</span><a href="GHC.Driver.Pipeline.Monad.html#src_basename"><span class="hs-identifier hs-var">src_basename</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085141"><span class="hs-identifier hs-var">basename</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-686"></span><span>                     </span><span class="annot"><span class="annottext">src_suffix :: FilePath
</span><a href="GHC.Driver.Pipeline.Monad.html#src_suffix"><span class="hs-identifier hs-var">src_suffix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085144"><span class="hs-identifier hs-var">suffix'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-687"></span><span>                     </span><span class="annot"><span class="annottext">start_phase :: Phase
</span><a href="GHC.Driver.Pipeline.Monad.html#start_phase"><span class="hs-identifier hs-var">start_phase</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Maybe Phase -&gt; Phase
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../base-4.18.2.1/src/Data.Maybe.html#fromMaybe/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Phase
</span><a href="GHC.Driver.Phases.html#startPhase"><span class="hs-identifier hs-var">startPhase</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085144"><span class="hs-identifier hs-var">suffix'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682085139"><span class="hs-identifier hs-var">start_phase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-688"></span><span>                     </span><span class="annot"><span class="annottext">output_spec :: PipelineOutput
</span><a href="GHC.Driver.Pipeline.Monad.html#output_spec"><span class="hs-identifier hs-var">output_spec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipelineOutput
</span><a href="#local-6989586621682085140"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085146"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#setDumpPrefix"><span class="hs-identifier hs-type">setDumpPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-692"></span><span id="setDumpPrefix"><span class="annot"><span class="annottext">setDumpPrefix :: PipeEnv -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Pipeline.html#setDumpPrefix"><span class="hs-identifier hs-var hs-var">setDumpPrefix</span></a></span></span><span> </span><span id="local-6989586621682085154"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085154"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085155"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085155"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-693"></span><span>  </span><span class="annot"><span class="annottext">(DynFlags -&gt; DynFlags) -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Env.html#hscUpdateFlags"><span class="hs-identifier hs-var">hscUpdateFlags</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682085157"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085157"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085157"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#dumpPrefix"><span class="hs-identifier hs-var">dumpPrefix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#src_basename"><span class="hs-identifier hs-var">src_basename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682085154"><span class="hs-identifier hs-type">pipe_env</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-type">++</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085155"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="hs-comment">{- The Pipelines -}</span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span id="local-6989586621682084412"><span id="local-6989586621682084413"><span class="annot"><a href="GHC.Driver.Pipeline.html#phaseIfFlag"><span class="hs-identifier hs-type">phaseIfFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#Monad/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084412"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-698"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-699"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084413"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-701"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084412"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084413"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-702"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084412"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084413"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-703"></span><span id="phaseIfFlag"><span class="annot"><span class="annottext">phaseIfFlag :: forall (m :: * -&gt; *) a.
Monad m =&gt;
HscEnv -&gt; (DynFlags -&gt; Bool) -&gt; a -&gt; m a -&gt; m a
</span><a href="GHC.Driver.Pipeline.html#phaseIfFlag"><span class="hs-identifier hs-var hs-var">phaseIfFlag</span></a></span></span><span> </span><span id="local-6989586621682085162"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085162"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085163"><span class="annot"><span class="annottext">DynFlags -&gt; Bool
</span><a href="#local-6989586621682085163"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span id="local-6989586621682085164"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682085164"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621682085165"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621682085165"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-704"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Bool
</span><a href="#local-6989586621682085163"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085162"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621682085165"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682085164"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span class="annot"><span class="hs-comment">-- | Check if the start is *before* the current phase, otherwise skip with a default</span></span><span>
</span><span id="line-709"></span><span id="local-6989586621682084416"><span id="local-6989586621682084417"><span class="annot"><a href="GHC.Driver.Pipeline.html#phaseIfAfter"><span class="hs-identifier hs-type">phaseIfAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084416"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084417"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084416"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084417"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084416"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084417"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-710"></span><span id="phaseIfAfter"><span class="annot"><span class="annottext">phaseIfAfter :: forall (m :: * -&gt; *) a.
P m =&gt;
Platform -&gt; Phase -&gt; Phase -&gt; a -&gt; m a -&gt; m a
</span><a href="GHC.Driver.Pipeline.html#phaseIfAfter"><span class="hs-identifier hs-var hs-var">phaseIfAfter</span></a></span></span><span> </span><span id="local-6989586621682085170"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682085170"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682085171"><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085171"><span class="hs-identifier hs-var">start_phase</span></a></span></span><span> </span><span id="local-6989586621682085172"><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085172"><span class="hs-identifier hs-var">cur_phase</span></a></span></span><span> </span><span id="local-6989586621682085173"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682085173"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621682085174"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621682085174"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085171"><span class="hs-identifier hs-var">start_phase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase -&gt; Phase -&gt; Bool
</span><a href="GHC.Driver.Phases.html#eqPhase"><span class="hs-operator hs-var">`eqPhase`</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085172"><span class="hs-identifier hs-var">cur_phase</span></a></span><span>
</span><span id="line-712"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Phase -&gt; Phase -&gt; Bool
</span><a href="GHC.Driver.Phases.html#happensBefore"><span class="hs-identifier hs-var">happensBefore</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682085170"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085171"><span class="hs-identifier hs-var">start_phase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085172"><span class="hs-identifier hs-var">cur_phase</span></a></span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621682085174"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-715"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682085173"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="annot"><span class="hs-comment">-- | The preprocessor pipeline</span></span><span>
</span><span id="line-718"></span><span id="local-6989586621682084266"><span class="annot"><a href="GHC.Driver.Pipeline.html#preprocessPipeline"><span class="hs-identifier hs-type">preprocessPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084266"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084266"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-719"></span><span id="preprocessPipeline"><span class="annot"><span class="annottext">preprocessPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (DynFlags, FilePath)
</span><a href="GHC.Driver.Pipeline.html#preprocessPipeline"><span class="hs-identifier hs-var hs-var">preprocessPipeline</span></a></span></span><span> </span><span id="local-6989586621682085212"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085212"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085213"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085213"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085214"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085214"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-720"></span><span>  </span><span id="local-6989586621682085215"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085215"><span class="hs-identifier hs-var">unlit_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-721"></span><span>    </span><span class="annot"><span class="annottext">Phase -&gt; FilePath -&gt; m FilePath -&gt; m FilePath
forall (p :: * -&gt; *) a. P p =&gt; Phase -&gt; a -&gt; p a -&gt; p a
</span><a href="#local-6989586621682085216"><span class="hs-identifier hs-var">runAfter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscSource -&gt; Phase
</span><a href="GHC.Driver.Phases.html#Unlit"><span class="hs-identifier hs-var">Unlit</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsSrcFile"><span class="hs-identifier hs-var">HsSrcFile</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085214"><span class="hs-identifier hs-var">input_fn</span></a></span><span> </span><span class="annot"><span class="annottext">(m FilePath -&gt; m FilePath) -&gt; m FilePath -&gt; m FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-722"></span><span>      </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_Unlit"><span class="hs-identifier hs-var">T_Unlit</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085212"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085213"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085214"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span>
</span><span id="line-725"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682085221"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085221"><span class="hs-identifier hs-var">dflags1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085222"><span class="annot"><span class="annottext">Messages PsMessage
</span><a href="#local-6989586621682085222"><span class="hs-identifier hs-var">p_warns1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085223"><span class="annot"><span class="annottext">[Warn]
</span><a href="#local-6989586621682085223"><span class="hs-identifier hs-var">warns1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase (DynFlags, Messages PsMessage, [Warn])
-&gt; m (DynFlags, Messages PsMessage, [Warn])
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; FilePath -&gt; TPhase (DynFlags, Messages PsMessage, [Warn])
</span><a href="GHC.Driver.Pipeline.Phases.html#T_FileArgs"><span class="hs-identifier hs-var">T_FileArgs</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085213"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085215"><span class="hs-identifier hs-var">unlit_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085225"><span class="annot"><span class="annottext">hsc_env1 :: HscEnv
</span><a href="#local-6989586621682085225"><span class="hs-identifier hs-var hs-var">hsc_env1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; DynFlags -&gt; HscEnv -&gt; HscEnv
DynFlags -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Env.html#hscSetFlags"><span class="hs-identifier hs-var">hscSetFlags</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085221"><span class="hs-identifier hs-var">dflags1</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085213"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682085226"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085226"><span class="hs-identifier hs-var">cpp_fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085227"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085227"><span class="hs-identifier hs-var">hsc_env2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HscEnv
-&gt; Phase
-&gt; (DynFlags -&gt; Bool)
-&gt; (FilePath, HscEnv)
-&gt; m (FilePath, HscEnv)
-&gt; m (FilePath, HscEnv)
forall (p :: * -&gt; *) a.
P p =&gt;
HscEnv -&gt; Phase -&gt; (DynFlags -&gt; Bool) -&gt; a -&gt; p a -&gt; p a
</span><a href="#local-6989586621682085228"><span class="hs-identifier hs-var">runAfterFlag</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085225"><span class="hs-identifier hs-var">hsc_env1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscSource -&gt; Phase
</span><a href="GHC.Driver.Phases.html#Cpp"><span class="hs-identifier hs-var">Cpp</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsSrcFile"><span class="hs-identifier hs-var">HsSrcFile</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Extension -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#xopt"><span class="hs-identifier hs-var">xopt</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.Cpp</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085215"><span class="hs-identifier hs-var">unlit_fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085225"><span class="hs-identifier hs-var">hsc_env1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (FilePath, HscEnv) -&gt; m (FilePath, HscEnv))
-&gt; m (FilePath, HscEnv) -&gt; m (FilePath, HscEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-730"></span><span>          </span><span id="local-6989586621682085232"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085232"><span class="hs-identifier hs-var">cpp_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_Cpp"><span class="hs-identifier hs-var">T_Cpp</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085212"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085225"><span class="hs-identifier hs-var">hsc_env1</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085215"><span class="hs-identifier hs-var">unlit_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682085234"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085234"><span class="hs-identifier hs-var">dflags2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Messages PsMessage
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Warn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase (DynFlags, Messages PsMessage, [Warn])
-&gt; m (DynFlags, Messages PsMessage, [Warn])
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; FilePath -&gt; TPhase (DynFlags, Messages PsMessage, [Warn])
</span><a href="GHC.Driver.Pipeline.Phases.html#T_FileArgs"><span class="hs-identifier hs-var">T_FileArgs</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085225"><span class="hs-identifier hs-var">hsc_env1</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085232"><span class="hs-identifier hs-var">cpp_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085235"><span class="annot"><span class="annottext">hsc_env2 :: HscEnv
</span><a href="#local-6989586621682085235"><span class="hs-identifier hs-var hs-var">hsc_env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; DynFlags -&gt; HscEnv -&gt; HscEnv
DynFlags -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Env.html#hscSetFlags"><span class="hs-identifier hs-var">hscSetFlags</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085234"><span class="hs-identifier hs-var">dflags2</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085225"><span class="hs-identifier hs-var">hsc_env1</span></a></span><span>
</span><span id="line-733"></span><span>          </span><span class="annot"><span class="annottext">(FilePath, HscEnv) -&gt; m (FilePath, HscEnv)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085232"><span class="hs-identifier hs-var">cpp_fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085235"><span class="hs-identifier hs-var">hsc_env2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span>  </span><span id="local-6989586621682085236"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085236"><span class="hs-identifier hs-var">pp_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HscEnv
-&gt; Phase
-&gt; (DynFlags -&gt; Bool)
-&gt; FilePath
-&gt; m FilePath
-&gt; m FilePath
forall (p :: * -&gt; *) a.
P p =&gt;
HscEnv -&gt; Phase -&gt; (DynFlags -&gt; Bool) -&gt; a -&gt; p a -&gt; p a
</span><a href="#local-6989586621682085228"><span class="hs-identifier hs-var">runAfterFlag</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085227"><span class="hs-identifier hs-var">hsc_env2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscSource -&gt; Phase
</span><a href="GHC.Driver.Phases.html#HsPp"><span class="hs-identifier hs-var">HsPp</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsSrcFile"><span class="hs-identifier hs-var">HsSrcFile</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_Pp"><span class="hs-identifier hs-var">Opt_Pp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085226"><span class="hs-identifier hs-var">cpp_fn</span></a></span><span> </span><span class="annot"><span class="annottext">(m FilePath -&gt; m FilePath) -&gt; m FilePath -&gt; m FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-737"></span><span>            </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_HsPp"><span class="hs-identifier hs-var">T_HsPp</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085212"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085227"><span class="hs-identifier hs-var">hsc_env2</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085214"><span class="hs-identifier hs-var">input_fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085226"><span class="hs-identifier hs-var">cpp_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682085240"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085240"><span class="hs-identifier hs-var">dflags3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085241"><span class="annot"><span class="annottext">Messages PsMessage
</span><a href="#local-6989586621682085241"><span class="hs-identifier hs-var">p_warns3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085242"><span class="annot"><span class="annottext">[Warn]
</span><a href="#local-6989586621682085242"><span class="hs-identifier hs-var">warns3</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085236"><span class="hs-identifier hs-var">pp_fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085215"><span class="hs-identifier hs-var">unlit_fn</span></a></span><span>
</span><span id="line-741"></span><span>          </span><span class="hs-comment">-- Didn't run any preprocessors so don't need to reparse, would be nicer</span><span>
</span><span id="line-742"></span><span>          </span><span class="hs-comment">-- if `T_FileArgs` recognised this.</span><span>
</span><span id="line-743"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(DynFlags, Messages PsMessage, [Warn])
-&gt; m (DynFlags, Messages PsMessage, [Warn])
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085221"><span class="hs-identifier hs-var">dflags1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Messages PsMessage
</span><a href="#local-6989586621682085222"><span class="hs-identifier hs-var">p_warns1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Warn]
</span><a href="#local-6989586621682085223"><span class="hs-identifier hs-var">warns1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-745"></span><span>            </span><span class="hs-comment">-- Reparse with original hsc_env so that we don't get duplicated options</span><span>
</span><span id="line-746"></span><span>            </span><span class="annot"><span class="annottext">TPhase (DynFlags, Messages PsMessage, [Warn])
-&gt; m (DynFlags, Messages PsMessage, [Warn])
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; FilePath -&gt; TPhase (DynFlags, Messages PsMessage, [Warn])
</span><a href="GHC.Driver.Pipeline.Phases.html#T_FileArgs"><span class="hs-identifier hs-var">T_FileArgs</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085213"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085236"><span class="hs-identifier hs-var">pp_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085243"><span class="annot"><span class="annottext">print_config :: DiagnosticOpts GhcMessage
</span><a href="#local-6989586621682085243"><span class="hs-identifier hs-var hs-var">print_config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; DiagnosticOpts GhcMessage
</span><a href="GHC.Driver.Config.Diagnostic.html#initPrintConfig"><span class="hs-identifier hs-var">initPrintConfig</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085240"><span class="hs-identifier hs-var">dflags3</span></a></span><span>
</span><span id="line-749"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logger
-&gt; GhcMessageOpts -&gt; DiagOpts -&gt; Messages GhcMessage -&gt; IO ()
</span><a href="GHC.Driver.Errors.html#printOrThrowDiagnostics"><span class="hs-identifier hs-var">printOrThrowDiagnostics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085213"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DiagnosticOpts GhcMessage
GhcMessageOpts
</span><a href="#local-6989586621682085243"><span class="hs-identifier hs-var">print_config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; DiagOpts
</span><a href="GHC.Driver.Config.Diagnostic.html#initDiagOpts"><span class="hs-identifier hs-var">initDiagOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085240"><span class="hs-identifier hs-var">dflags3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PsMessage -&gt; GhcMessage
</span><a href="GHC.Driver.Errors.Types.html#GhcPsMessage"><span class="hs-identifier hs-var">GhcPsMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(PsMessage -&gt; GhcMessage)
-&gt; Messages PsMessage -&gt; Messages GhcMessage
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Messages PsMessage
</span><a href="#local-6989586621682085241"><span class="hs-identifier hs-var">p_warns3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-750"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logger -&gt; GhcMessageOpts -&gt; DiagOpts -&gt; [Warn] -&gt; IO ()
</span><a href="GHC.Driver.Errors.html#handleFlagWarnings"><span class="hs-identifier hs-var">handleFlagWarnings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085213"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DiagnosticOpts GhcMessage
GhcMessageOpts
</span><a href="#local-6989586621682085243"><span class="hs-identifier hs-var">print_config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; DiagOpts
</span><a href="GHC.Driver.Config.Diagnostic.html#initDiagOpts"><span class="hs-identifier hs-var">initDiagOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085240"><span class="hs-identifier hs-var">dflags3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Warn]
</span><a href="#local-6989586621682085242"><span class="hs-identifier hs-var">warns3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>  </span><span class="annot"><span class="annottext">(DynFlags, FilePath) -&gt; m (DynFlags, FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085240"><span class="hs-identifier hs-var">dflags3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085236"><span class="hs-identifier hs-var">pp_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span>
</span><span id="line-754"></span><span>  </span><span class="hs-comment">-- This won't change through the compilation pipeline</span><span>
</span><span id="line-755"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682085248"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682085248"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.Session.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085213"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>        </span><span id="local-6989586621682084422"><span id="local-6989586621682084423"><span class="annot"><a href="#local-6989586621682085216"><span class="hs-identifier hs-type">runAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084422"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span>
</span><span id="line-757"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084422"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084422"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084423"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-758"></span><span>        </span><span id="local-6989586621682085216"><span class="annot"><span class="annottext">runAfter :: forall (p :: * -&gt; *) a. P p =&gt; Phase -&gt; a -&gt; p a -&gt; p a
</span><a href="#local-6989586621682085216"><span class="hs-identifier hs-var hs-var">runAfter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Phase -&gt; Phase -&gt; a -&gt; p a -&gt; p a
forall (m :: * -&gt; *) a.
P m =&gt;
Platform -&gt; Phase -&gt; Phase -&gt; a -&gt; m a -&gt; m a
</span><a href="GHC.Driver.Pipeline.html#phaseIfAfter"><span class="hs-identifier hs-var">phaseIfAfter</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682085248"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; Phase
</span><a href="GHC.Driver.Pipeline.Monad.html#start_phase"><span class="hs-identifier hs-var">start_phase</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085212"><span class="hs-identifier hs-var">pipe_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-759"></span><span>        </span><span id="local-6989586621682084429"><span id="local-6989586621682084430"><span class="annot"><a href="#local-6989586621682085228"><span class="hs-identifier hs-type">runAfterFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084429"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-760"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-761"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span>
</span><span id="line-762"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084430"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-764"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084429"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084430"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-765"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084429"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084430"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-766"></span><span>        </span><span id="local-6989586621682085228"><span class="annot"><span class="annottext">runAfterFlag :: forall (p :: * -&gt; *) a.
P p =&gt;
HscEnv -&gt; Phase -&gt; (DynFlags -&gt; Bool) -&gt; a -&gt; p a -&gt; p a
</span><a href="#local-6989586621682085228"><span class="hs-identifier hs-var hs-var">runAfterFlag</span></a></span></span><span> </span><span id="local-6989586621682085255"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085255"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085256"><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085256"><span class="hs-identifier hs-var">phase</span></a></span></span><span> </span><span id="local-6989586621682085257"><span class="annot"><span class="annottext">DynFlags -&gt; Bool
</span><a href="#local-6989586621682085257"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span id="local-6989586621682085258"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682085258"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621682085259"><span class="annot"><span class="annottext">p a
</span><a href="#local-6989586621682085259"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-767"></span><span>          </span><span class="annot"><span class="annottext">Phase -&gt; a -&gt; p a -&gt; p a
forall (p :: * -&gt; *) a. P p =&gt; Phase -&gt; a -&gt; p a -&gt; p a
</span><a href="#local-6989586621682085216"><span class="hs-identifier hs-var">runAfter</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085256"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682085258"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-768"></span><span>           </span><span class="annot"><span class="annottext">(p a -&gt; p a) -&gt; p a -&gt; p a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; (DynFlags -&gt; Bool) -&gt; a -&gt; p a -&gt; p a
forall (m :: * -&gt; *) a.
Monad m =&gt;
HscEnv -&gt; (DynFlags -&gt; Bool) -&gt; a -&gt; m a -&gt; m a
</span><a href="GHC.Driver.Pipeline.html#phaseIfFlag"><span class="hs-identifier hs-var">phaseIfFlag</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085255"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Bool
</span><a href="#local-6989586621682085257"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682085258"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">p a
</span><a href="#local-6989586621682085259"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span class="annot"><span class="hs-comment">-- | The complete compilation pipeline, from start to finish</span></span><span>
</span><span id="line-771"></span><span id="local-6989586621682084440"><span class="annot"><a href="GHC.Driver.Pipeline.html#fullPipeline"><span class="hs-identifier hs-type">fullPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084440"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html#HscSource"><span class="hs-identifier hs-type">HscSource</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084440"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomeModLinkable"><span class="hs-identifier hs-type">HomeModLinkable</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-772"></span><span id="fullPipeline"><span class="annot"><span class="annottext">fullPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; FilePath -&gt; HscSource -&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#fullPipeline"><span class="hs-identifier hs-var hs-var">fullPipeline</span></a></span></span><span> </span><span id="local-6989586621682085269"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085269"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085270"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085270"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085271"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085271"><span class="hs-identifier hs-var">pp_fn</span></a></span></span><span> </span><span id="local-6989586621682085272"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085272"><span class="hs-identifier hs-var">src_flavour</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682085273"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085273"><span class="hs-identifier hs-var">dflags</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085274"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085274"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (DynFlags, FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (DynFlags, FilePath)
</span><a href="GHC.Driver.Pipeline.html#preprocessPipeline"><span class="hs-identifier hs-var">preprocessPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085269"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085270"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085271"><span class="hs-identifier hs-var">pp_fn</span></a></span><span>
</span><span id="line-774"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085275"><span class="annot"><span class="annottext">hsc_env' :: HscEnv
</span><a href="#local-6989586621682085275"><span class="hs-identifier hs-var hs-var">hsc_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; DynFlags -&gt; HscEnv -&gt; HscEnv
DynFlags -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Env.html#hscSetFlags"><span class="hs-identifier hs-var">hscSetFlags</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085273"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085270"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-775"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682085276"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085276"><span class="hs-identifier hs-var">hsc_env_with_plugins</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085277"><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085277"><span class="hs-identifier hs-var">mod_sum</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085278"><span class="annot"><span class="annottext">HscRecompStatus
</span><a href="#local-6989586621682085278"><span class="hs-identifier hs-var">hsc_recomp_status</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-776"></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase (HscEnv, ModSummary, HscRecompStatus)
-&gt; m (HscEnv, ModSummary, HscRecompStatus)
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv
-&gt; FilePath
-&gt; HscSource
-&gt; TPhase (HscEnv, ModSummary, HscRecompStatus)
</span><a href="GHC.Driver.Pipeline.Phases.html#T_HscRecomp"><span class="hs-identifier hs-var">T_HscRecomp</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085269"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085275"><span class="hs-identifier hs-var">hsc_env'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085274"><span class="hs-identifier hs-var">input_fn</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085272"><span class="hs-identifier hs-var">src_flavour</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-777"></span><span>  </span><span class="annot"><span class="annottext">PipeEnv
-&gt; (HscEnv, ModSummary, HscRecompStatus)
-&gt; m (ModIface, HomeModLinkable)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; (HscEnv, ModSummary, HscRecompStatus)
-&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#hscPipeline"><span class="hs-identifier hs-var">hscPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085269"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085276"><span class="hs-identifier hs-var">hsc_env_with_plugins</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085277"><span class="hs-identifier hs-var">mod_sum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HscRecompStatus
</span><a href="#local-6989586621682085278"><span class="hs-identifier hs-var">hsc_recomp_status</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>
</span><span id="line-779"></span><span class="annot"><span class="hs-comment">-- | Everything after preprocess</span></span><span>
</span><span id="line-780"></span><span id="local-6989586621682084310"><span class="annot"><a href="GHC.Driver.Pipeline.html#hscPipeline"><span class="hs-identifier hs-type">hscPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084310"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModSummary.html#ModSummary"><span class="hs-identifier hs-type">ModSummary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Status.html#HscRecompStatus"><span class="hs-identifier hs-type">HscRecompStatus</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084310"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomeModLinkable"><span class="hs-identifier hs-type">HomeModLinkable</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-781"></span><span id="hscPipeline"><span class="annot"><span class="annottext">hscPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; (HscEnv, ModSummary, HscRecompStatus)
-&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#hscPipeline"><span class="hs-identifier hs-var hs-var">hscPipeline</span></a></span></span><span> </span><span id="local-6989586621682085289"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085289"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682085290"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085290"><span class="hs-identifier hs-var">hsc_env_with_plugins</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085291"><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085291"><span class="hs-identifier hs-var">mod_sum</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085292"><span class="annot"><span class="annottext">HscRecompStatus
</span><a href="#local-6989586621682085292"><span class="hs-identifier hs-var">hsc_recomp_status</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-782"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HscRecompStatus
</span><a href="#local-6989586621682085292"><span class="hs-identifier hs-var">hsc_recomp_status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-783"></span><span>    </span><span class="annot"><a href="GHC.Unit.Module.Status.html#HscUpToDate"><span class="hs-identifier hs-type">HscUpToDate</span></a></span><span> </span><span id="local-6989586621682085294"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682085294"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span id="local-6989586621682085295"><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682085295"><span class="hs-identifier hs-var">mb_linkable</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ModIface, HomeModLinkable) -&gt; m (ModIface, HomeModLinkable)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682085294"><span class="hs-identifier hs-var">iface</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682085295"><span class="hs-identifier hs-var">mb_linkable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>    </span><span class="annot"><a href="GHC.Unit.Module.Status.html#HscRecompNeeded"><span class="hs-identifier hs-type">HscRecompNeeded</span></a></span><span> </span><span id="local-6989586621682085297"><span class="annot"><span class="annottext">Maybe Fingerprint
</span><a href="#local-6989586621682085297"><span class="hs-identifier hs-var">mb_old_hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-785"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682085298"><span class="annot"><span class="annottext">FrontendResult
</span><a href="#local-6989586621682085298"><span class="hs-identifier hs-var">tc_result</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085299"><span class="annot"><span class="annottext">Messages GhcMessage
</span><a href="#local-6989586621682085299"><span class="hs-identifier hs-var">warnings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase (FrontendResult, Messages GhcMessage)
-&gt; m (FrontendResult, Messages GhcMessage)
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv
-&gt; ModSummary -&gt; TPhase (FrontendResult, Messages GhcMessage)
</span><a href="GHC.Driver.Pipeline.Phases.html#T_Hsc"><span class="hs-identifier hs-var">T_Hsc</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085290"><span class="hs-identifier hs-var">hsc_env_with_plugins</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085291"><span class="hs-identifier hs-var">mod_sum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-786"></span><span>      </span><span id="local-6989586621682085301"><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085301"><span class="hs-identifier hs-var">hscBackendAction</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase HscBackendAction -&gt; m HscBackendAction
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv
-&gt; ModSummary
-&gt; FrontendResult
-&gt; Messages GhcMessage
-&gt; Maybe Fingerprint
-&gt; TPhase HscBackendAction
</span><a href="GHC.Driver.Pipeline.Phases.html#T_HscPostTc"><span class="hs-identifier hs-var">T_HscPostTc</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085290"><span class="hs-identifier hs-var">hsc_env_with_plugins</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085291"><span class="hs-identifier hs-var">mod_sum</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendResult
</span><a href="#local-6989586621682085298"><span class="hs-identifier hs-var">tc_result</span></a></span><span> </span><span class="annot"><span class="annottext">Messages GhcMessage
</span><a href="#local-6989586621682085299"><span class="hs-identifier hs-var">warnings</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Fingerprint
</span><a href="#local-6989586621682085297"><span class="hs-identifier hs-var">mb_old_hash</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>      </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv
-&gt; ModSummary
-&gt; HscBackendAction
-&gt; m (ModIface, HomeModLinkable)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv
-&gt; ModSummary
-&gt; HscBackendAction
-&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#hscBackendPipeline"><span class="hs-identifier hs-var">hscBackendPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085289"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085290"><span class="hs-identifier hs-var">hsc_env_with_plugins</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085291"><span class="hs-identifier hs-var">mod_sum</span></a></span><span> </span><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085301"><span class="hs-identifier hs-var">hscBackendAction</span></a></span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span id="local-6989586621682084446"><span class="annot"><a href="GHC.Driver.Pipeline.html#hscBackendPipeline"><span class="hs-identifier hs-type">hscBackendPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084446"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModSummary.html#ModSummary"><span class="hs-identifier hs-type">ModSummary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Status.html#HscBackendAction"><span class="hs-identifier hs-type">HscBackendAction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084446"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomeModLinkable"><span class="hs-identifier hs-type">HomeModLinkable</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-790"></span><span id="hscBackendPipeline"><span class="annot"><span class="annottext">hscBackendPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv
-&gt; ModSummary
-&gt; HscBackendAction
-&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#hscBackendPipeline"><span class="hs-identifier hs-var hs-var">hscBackendPipeline</span></a></span></span><span> </span><span id="local-6989586621682085321"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085321"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085322"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085322"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085323"><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085323"><span class="hs-identifier hs-var">mod_sum</span></a></span></span><span> </span><span id="local-6989586621682085324"><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085324"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; Bool
</span><a href="GHC.Driver.Backend.html#backendGeneratesCode"><span class="hs-identifier hs-var">backendGeneratesCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085322"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-792"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-793"></span><span>      </span><span id="local-6989586621682085325"><span class="annot"><span class="annottext">(ModIface, HomeModLinkable)
</span><a href="#local-6989586621682085325"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv
-&gt; ModSummary
-&gt; HscBackendAction
-&gt; m (ModIface, HomeModLinkable)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv
-&gt; ModSummary
-&gt; HscBackendAction
-&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#hscGenBackendPipeline"><span class="hs-identifier hs-var">hscGenBackendPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085321"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085322"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085323"><span class="hs-identifier hs-var">mod_sum</span></a></span><span> </span><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085324"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-794"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_BuildDynamicToo"><span class="hs-identifier hs-var">Opt_BuildDynamicToo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085322"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-795"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085327"><span class="annot"><span class="annottext">dflags' :: DynFlags
</span><a href="#local-6989586621682085327"><span class="hs-identifier hs-var hs-var">dflags'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; DynFlags
</span><a href="GHC.Driver.Session.html#setDynamicNow"><span class="hs-identifier hs-var">setDynamicNow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085322"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- set &quot;dynamicNow&quot;</span><span>
</span><span id="line-796"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">() -&gt; m (ModIface, HomeModLinkable) -&gt; m ()
forall a b. a -&gt; m b -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%3C%24/GHC.Base.html#%3C%24"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv
-&gt; ModSummary
-&gt; HscBackendAction
-&gt; m (ModIface, HomeModLinkable)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv
-&gt; ModSummary
-&gt; HscBackendAction
-&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#hscGenBackendPipeline"><span class="hs-identifier hs-var">hscGenBackendPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085321"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; DynFlags -&gt; HscEnv -&gt; HscEnv
DynFlags -&gt; HscEnv -&gt; HscEnv
</span><a href="GHC.Driver.Env.html#hscSetFlags"><span class="hs-identifier hs-var">hscSetFlags</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682085327"><span class="hs-identifier hs-var">dflags'</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085322"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085323"><span class="hs-identifier hs-var">mod_sum</span></a></span><span> </span><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085324"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-797"></span><span>      </span><span class="annot"><span class="annottext">(ModIface, HomeModLinkable) -&gt; m (ModIface, HomeModLinkable)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(ModIface, HomeModLinkable)
</span><a href="#local-6989586621682085325"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-798"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-799"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085324"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-800"></span><span>      </span><span class="annot"><a href="GHC.Unit.Module.Status.html#HscUpdate"><span class="hs-identifier hs-type">HscUpdate</span></a></span><span> </span><span id="local-6989586621682085331"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682085331"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">(ModIface, HomeModLinkable) -&gt; m (ModIface, HomeModLinkable)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682085331"><span class="hs-identifier hs-var">iface</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="GHC.Unit.Home.ModInfo.html#emptyHomeModInfoLinkable"><span class="hs-identifier hs-var">emptyHomeModInfoLinkable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>      </span><span class="annot"><a href="GHC.Unit.Module.Status.html#HscRecomp"><span class="hs-identifier hs-type">HscRecomp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ModIface -&gt; HomeModLinkable -&gt; (ModIface, HomeModLinkable))
-&gt; m ModIface -&gt; m (HomeModLinkable -&gt; (ModIface, HomeModLinkable))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO ModIface -&gt; m ModIface
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv
-&gt; PartialModIface
-&gt; Maybe StgCgInfos
-&gt; Maybe CmmCgInfos
-&gt; IO ModIface
</span><a href="GHC.Iface.Make.html#mkFullIface"><span class="hs-identifier hs-var">mkFullIface</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085322"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscBackendAction -&gt; PartialModIface
</span><a href="GHC.Unit.Module.Status.html#hscs_partial_iface"><span class="hs-identifier hs-var">hscs_partial_iface</span></a></span><span> </span><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085324"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StgCgInfos
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CmmCgInfos
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (HomeModLinkable -&gt; (ModIface, HomeModLinkable))
-&gt; m HomeModLinkable -&gt; m (ModIface, HomeModLinkable)
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%3C%2A%3E/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HomeModLinkable -&gt; m HomeModLinkable
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="GHC.Unit.Home.ModInfo.html#emptyHomeModInfoLinkable"><span class="hs-identifier hs-var">emptyHomeModInfoLinkable</span></a></span><span>
</span><span id="line-802"></span><span>    </span><span class="hs-comment">-- TODO: Why is there not a linkable?</span><span>
</span><span id="line-803"></span><span>    </span><span class="hs-comment">-- Interpreter -&gt; (,) &lt;$&gt; use (T_IO (mkFullIface hsc_env (hscs_partial_iface result) Nothing)) &lt;*&gt; pure Nothing</span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span id="local-6989586621682085335"><span class="annot"><a href="GHC.Driver.Pipeline.html#hscGenBackendPipeline"><span class="hs-identifier hs-type">hscGenBackendPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682085335"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-806"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span>
</span><span id="line-807"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span>
</span><span id="line-808"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModSummary.html#ModSummary"><span class="hs-identifier hs-type">ModSummary</span></a></span><span>
</span><span id="line-809"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Status.html#HscBackendAction"><span class="hs-identifier hs-type">HscBackendAction</span></a></span><span>
</span><span id="line-810"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682085335"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#HomeModLinkable"><span class="hs-identifier hs-type">HomeModLinkable</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-811"></span><span id="hscGenBackendPipeline"><span class="annot"><span class="annottext">hscGenBackendPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv
-&gt; ModSummary
-&gt; HscBackendAction
-&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#hscGenBackendPipeline"><span class="hs-identifier hs-var hs-var">hscGenBackendPipeline</span></a></span></span><span> </span><span id="local-6989586621682085356"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085356"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085357"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085357"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085358"><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085358"><span class="hs-identifier hs-var">mod_sum</span></a></span></span><span> </span><span id="local-6989586621682085359"><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085359"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-812"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085360"><span class="annot"><span class="annottext">mod_name :: ModuleName
</span><a href="#local-6989586621682085360"><span class="hs-identifier hs-var hs-var">mod_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module -&gt; ModuleName
forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModSummary -&gt; Module
</span><a href="GHC.Unit.Module.ModSummary.html#ms_mod"><span class="hs-identifier hs-var">ms_mod</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085358"><span class="hs-identifier hs-var">mod_sum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-813"></span><span>      </span><span id="local-6989586621682085363"><span class="annot"><span class="annottext">src_flavour :: HscSource
</span><a href="#local-6989586621682085363"><span class="hs-identifier hs-var hs-var">src_flavour</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModSummary -&gt; HscSource
</span><a href="GHC.Unit.Module.ModSummary.html#ms_hsc_src"><span class="hs-identifier hs-var">ms_hsc_src</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085358"><span class="hs-identifier hs-var">mod_sum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-814"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085365"><span class="annot"><span class="annottext">location :: ModLocation
</span><a href="#local-6989586621682085365"><span class="hs-identifier hs-var hs-var">location</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModSummary -&gt; ModLocation
</span><a href="GHC.Unit.Module.ModSummary.html#ms_location"><span class="hs-identifier hs-var">ms_location</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085358"><span class="hs-identifier hs-var">mod_sum</span></a></span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682085366"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085366"><span class="hs-identifier hs-var">fos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085367"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682085367"><span class="hs-identifier hs-var">miface</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085368"><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682085368"><span class="hs-identifier hs-var">mlinkable</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085369"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085369"><span class="hs-identifier hs-var">o_file</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase ([FilePath], ModIface, HomeModLinkable, FilePath)
-&gt; m ([FilePath], ModIface, HomeModLinkable, FilePath)
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv
-&gt; ModuleName
-&gt; HscSource
-&gt; ModLocation
-&gt; HscBackendAction
-&gt; TPhase ([FilePath], ModIface, HomeModLinkable, FilePath)
</span><a href="GHC.Driver.Pipeline.Phases.html#T_HscBackend"><span class="hs-identifier hs-var">T_HscBackend</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085356"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085357"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621682085360"><span class="hs-identifier hs-var">mod_name</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085363"><span class="hs-identifier hs-var">src_flavour</span></a></span><span> </span><span class="annot"><span class="annottext">ModLocation
</span><a href="#local-6989586621682085365"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">HscBackendAction
</span><a href="#local-6989586621682085359"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span>  </span><span id="local-6989586621682085371"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621682085371"><span class="hs-identifier hs-var">final_fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv
-&gt; HscSource
-&gt; Backend
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv
-&gt; HscSource
-&gt; Backend
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#hscPostBackendPipeline"><span class="hs-identifier hs-var">hscPostBackendPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085356"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085357"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModSummary -&gt; HscSource
</span><a href="GHC.Unit.Module.ModSummary.html#ms_hsc_src"><span class="hs-identifier hs-var">ms_hsc_src</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085358"><span class="hs-identifier hs-var">mod_sum</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085357"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModLocation -&gt; Maybe ModLocation
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ModLocation
</span><a href="#local-6989586621682085365"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085369"><span class="hs-identifier hs-var">o_file</span></a></span><span>
</span><span id="line-817"></span><span>  </span><span id="local-6989586621682085372"><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682085372"><span class="hs-identifier hs-var">final_linkable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-818"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621682085371"><span class="hs-identifier hs-var">final_fp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-819"></span><span>      </span><span class="hs-comment">-- No object file produced, bytecode or NoBackend</span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HomeModLinkable -&gt; m HomeModLinkable
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682085368"><span class="hs-identifier hs-var">mlinkable</span></a></span><span>
</span><span id="line-821"></span><span>      </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682085373"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085373"><span class="hs-identifier hs-var">o_fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-822"></span><span>        </span><span id="local-6989586621682085374"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621682085374"><span class="hs-identifier hs-var">unlinked_time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; m UTCTime
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO UTCTime -&gt; IO UTCTime
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><a href="../../time-1.12.2/src/Data.Time.Clock.POSIX.html#getCurrentTime/Data.Time.Clock.POSIX.html#getCurrentTime"><span class="hs-identifier hs-var">getCurrentTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>        </span><span id="local-6989586621682085375"><span class="annot"><span class="annottext">Unlinked
</span><a href="#local-6989586621682085375"><span class="hs-identifier hs-var">final_unlinked</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Unlinked
</span><a href="GHC.Linker.Types.html#DotO"><span class="hs-identifier hs-var">DotO</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Unlinked) -&gt; m FilePath -&gt; m Unlinked
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; [FilePath] -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_MergeForeign"><span class="hs-identifier hs-var">T_MergeForeign</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085356"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085357"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085373"><span class="hs-identifier hs-var">o_fp</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085366"><span class="hs-identifier hs-var">fos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-824"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682085378"><span class="annot"><span class="annottext">linkable :: Linkable
</span><a href="#local-6989586621682085378"><span class="hs-identifier hs-var hs-var">linkable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Module -&gt; [Unlinked] -&gt; Linkable
</span><a href="GHC.Linker.Types.html#LM"><span class="hs-identifier hs-var">LM</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621682085374"><span class="hs-identifier hs-var">unlinked_time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModSummary -&gt; Module
</span><a href="GHC.Unit.Module.ModSummary.html#ms_mod"><span class="hs-identifier hs-var">ms_mod</span></a></span><span> </span><span class="annot"><span class="annottext">ModSummary
</span><a href="#local-6989586621682085358"><span class="hs-identifier hs-var">mod_sum</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Unlinked
</span><a href="#local-6989586621682085375"><span class="hs-identifier hs-var">final_unlinked</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-825"></span><span>        </span><span class="hs-comment">-- Add the object linkable to the potential bytecode linkable which was generated in HscBackend.</span><span>
</span><span id="line-826"></span><span>        </span><span class="annot"><span class="annottext">HomeModLinkable -&gt; m HomeModLinkable
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682085368"><span class="hs-identifier hs-var">mlinkable</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Unit.Home.ModInfo.html#homeMod_object"><span class="hs-identifier hs-var">homeMod_object</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682085378"><span class="hs-identifier hs-type">linkable</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>  </span><span class="annot"><span class="annottext">(ModIface, HomeModLinkable) -&gt; m (ModIface, HomeModLinkable)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621682085367"><span class="hs-identifier hs-var">miface</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HomeModLinkable
</span><a href="#local-6989586621682085372"><span class="hs-identifier hs-var">final_linkable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span id="local-6989586621682084400"><span class="annot"><a href="GHC.Driver.Pipeline.html#asPipeline"><span class="hs-identifier hs-type">asPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084400"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084400"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Linker.Types.html#ObjFile"><span class="hs-identifier hs-type">ObjFile</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-830"></span><span id="asPipeline"><span class="annot"><span class="annottext">asPipeline :: forall (m :: * -&gt; *).
P m =&gt;
Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#asPipeline"><span class="hs-identifier hs-var hs-var">asPipeline</span></a></span></span><span> </span><span id="local-6989586621682085388"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085388"><span class="hs-identifier hs-var">use_cpp</span></a></span></span><span> </span><span id="local-6989586621682085389"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085389"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085390"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085390"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085391"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085391"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621682085392"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085392"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-831"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; StopPhase
</span><a href="GHC.Driver.Pipeline.Monad.html#stop_phase"><span class="hs-identifier hs-var">stop_phase</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085389"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#StopAs"><span class="hs-identifier hs-var">StopAs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-833"></span><span>    </span><span class="annot"><span class="annottext">StopPhase
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe FilePath) -&gt; m FilePath -&gt; m (Maybe FilePath)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_As"><span class="hs-identifier hs-var">T_As</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085388"><span class="hs-identifier hs-var">use_cpp</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085389"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085390"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085391"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085392"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>
</span><span id="line-835"></span><span id="local-6989586621682084399"><span class="annot"><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-type">viaCPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084399"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084399"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-836"></span><span id="viaCPipeline"><span class="annot"><span class="annottext">viaCPipeline :: forall (m :: * -&gt; *).
P m =&gt;
Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-var hs-var">viaCPipeline</span></a></span></span><span> </span><span id="local-6989586621682085401"><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085401"><span class="hs-identifier hs-var">c_phase</span></a></span></span><span> </span><span id="local-6989586621682085402"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085402"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085403"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085403"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085404"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085404"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621682085405"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085405"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-837"></span><span>  </span><span id="local-6989586621682085406"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085406"><span class="hs-identifier hs-var">out_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_Cc"><span class="hs-identifier hs-var">T_Cc</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085401"><span class="hs-identifier hs-var">c_phase</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085402"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085403"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085404"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085405"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; StopPhase
</span><a href="GHC.Driver.Pipeline.Monad.html#stop_phase"><span class="hs-identifier hs-var">stop_phase</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085402"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-839"></span><span>    </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#StopC"><span class="hs-identifier hs-var">StopC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-840"></span><span>    </span><span class="annot"><span class="annottext">StopPhase
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe FilePath -&gt; m (Maybe FilePath))
-&gt; Maybe FilePath -&gt; m (Maybe FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085406"><span class="hs-identifier hs-var">out_fn</span></a></span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span id="local-6989586621682084461"><span class="annot"><a href="GHC.Driver.Pipeline.html#llvmPipeline"><span class="hs-identifier hs-type">llvmPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084461"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084461"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-843"></span><span id="llvmPipeline"><span class="annot"><span class="annottext">llvmPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmPipeline"><span class="hs-identifier hs-var hs-var">llvmPipeline</span></a></span></span><span> </span><span id="local-6989586621682085414"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085414"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085415"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085415"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085416"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085416"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621682085417"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085417"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-844"></span><span>  </span><span id="local-6989586621682085418"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085418"><span class="hs-identifier hs-var">opt_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_LlvmOpt"><span class="hs-identifier hs-var">T_LlvmOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085414"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085415"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085417"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>  </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmLlcPipeline"><span class="hs-identifier hs-var">llvmLlcPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085414"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085415"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085416"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085418"><span class="hs-identifier hs-var">opt_fn</span></a></span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span id="local-6989586621682085420"><span class="annot"><a href="GHC.Driver.Pipeline.html#llvmLlcPipeline"><span class="hs-identifier hs-type">llvmLlcPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682085420"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682085420"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-848"></span><span id="llvmLlcPipeline"><span class="annot"><span class="annottext">llvmLlcPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmLlcPipeline"><span class="hs-identifier hs-var hs-var">llvmLlcPipeline</span></a></span></span><span> </span><span id="local-6989586621682085427"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085427"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085428"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085428"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085429"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085429"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621682085430"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085430"><span class="hs-identifier hs-var">opt_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-849"></span><span>  </span><span id="local-6989586621682085431"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085431"><span class="hs-identifier hs-var">llc_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_LlvmLlc"><span class="hs-identifier hs-var">T_LlvmLlc</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085427"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085428"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085430"><span class="hs-identifier hs-var">opt_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>  </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmManglePipeline"><span class="hs-identifier hs-var">llvmManglePipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085427"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085428"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085429"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085431"><span class="hs-identifier hs-var">llc_fn</span></a></span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span id="local-6989586621682085433"><span class="annot"><a href="GHC.Driver.Pipeline.html#llvmManglePipeline"><span class="hs-identifier hs-type">llvmManglePipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682085433"><span class="hs-identifier hs-type">m</span></a></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682085433"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-853"></span><span id="llvmManglePipeline"><span class="annot"><span class="annottext">llvmManglePipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmManglePipeline"><span class="hs-identifier hs-var hs-var">llvmManglePipeline</span></a></span></span><span> </span><span id="local-6989586621682085441"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085441"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085442"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085442"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085443"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085443"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621682085444"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085444"><span class="hs-identifier hs-var">llc_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-854"></span><span>  </span><span id="local-6989586621682085445"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085445"><span class="hs-identifier hs-var">mangled_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-855"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_NoLlvmMangler"><span class="hs-identifier hs-var">Opt_NoLlvmMangler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085442"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m FilePath
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085444"><span class="hs-identifier hs-var">llc_fn</span></a></span><span>
</span><span id="line-857"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_LlvmMangle"><span class="hs-identifier hs-var">T_LlvmMangle</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085441"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085442"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085444"><span class="hs-identifier hs-var">llc_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#asPipeline"><span class="hs-identifier hs-var">asPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085441"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085442"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085443"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085445"><span class="hs-identifier hs-var">mangled_fn</span></a></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span id="local-6989586621682084465"><span class="annot"><a href="GHC.Driver.Pipeline.html#cmmCppPipeline"><span class="hs-identifier hs-type">cmmCppPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084465"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084465"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-861"></span><span id="cmmCppPipeline"><span class="annot"><span class="annottext">cmmCppPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#cmmCppPipeline"><span class="hs-identifier hs-var hs-var">cmmCppPipeline</span></a></span></span><span> </span><span id="local-6989586621682085454"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085454"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085455"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085455"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085456"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085456"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-862"></span><span>  </span><span id="local-6989586621682085457"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085457"><span class="hs-identifier hs-var">output_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_CmmCpp"><span class="hs-identifier hs-var">T_CmmCpp</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085454"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085455"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085456"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>  </span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#cmmPipeline"><span class="hs-identifier hs-var">cmmPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085454"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085455"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085457"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span id="local-6989586621682085459"><span class="annot"><a href="GHC.Driver.Pipeline.html#cmmPipeline"><span class="hs-identifier hs-type">cmmPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682085459"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682085459"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-866"></span><span id="cmmPipeline"><span class="annot"><span class="annottext">cmmPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#cmmPipeline"><span class="hs-identifier hs-var hs-var">cmmPipeline</span></a></span></span><span> </span><span id="local-6989586621682085471"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085471"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085472"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085472"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085473"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085473"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-867"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682085474"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085474"><span class="hs-identifier hs-var">fos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085475"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085475"><span class="hs-identifier hs-var">output_fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TPhase ([FilePath], FilePath) -&gt; m ([FilePath], FilePath)
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; TPhase ([FilePath], FilePath)
</span><a href="GHC.Driver.Pipeline.Phases.html#T_Cmm"><span class="hs-identifier hs-var">T_Cmm</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085471"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085472"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085473"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-868"></span><span>  </span><span id="local-6989586621682085477"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621682085477"><span class="hs-identifier hs-var">mo_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv
-&gt; HscSource
-&gt; Backend
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv
-&gt; HscSource
-&gt; Backend
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#hscPostBackendPipeline"><span class="hs-identifier hs-var">hscPostBackendPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085471"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085472"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsSrcFile"><span class="hs-identifier hs-var">HsSrcFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085472"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085475"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-869"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621682085477"><span class="hs-identifier hs-var">mo_fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-870"></span><span>    </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-871"></span><span>    </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682085478"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085478"><span class="hs-identifier hs-var">mo_fn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe FilePath) -&gt; m FilePath -&gt; m (Maybe FilePath)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; [FilePath] -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_MergeForeign"><span class="hs-identifier hs-var">T_MergeForeign</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085471"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085472"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085478"><span class="hs-identifier hs-var">mo_fn</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621682085474"><span class="hs-identifier hs-var">fos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span id="local-6989586621682085479"><span class="annot"><a href="GHC.Driver.Pipeline.html#jsPipeline"><span class="hs-identifier hs-type">jsPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682085479"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682085479"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span></span><span>
</span><span id="line-874"></span><span id="jsPipeline"><span class="annot"><span class="annottext">jsPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m FilePath
</span><a href="GHC.Driver.Pipeline.html#jsPipeline"><span class="hs-identifier hs-var hs-var">jsPipeline</span></a></span></span><span> </span><span id="local-6989586621682085483"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085483"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085484"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085484"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085485"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085485"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621682085486"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085486"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-875"></span><span>  </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_Js"><span class="hs-identifier hs-var">T_Js</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085483"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085484"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085485"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085486"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span id="local-6989586621682084404"><span class="annot"><a href="GHC.Driver.Pipeline.html#foreignJsPipeline"><span class="hs-identifier hs-type">foreignJsPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084404"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084404"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span></span><span>
</span><span id="line-878"></span><span id="foreignJsPipeline"><span class="annot"><span class="annottext">foreignJsPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m FilePath
</span><a href="GHC.Driver.Pipeline.html#foreignJsPipeline"><span class="hs-identifier hs-var hs-var">foreignJsPipeline</span></a></span></span><span> </span><span id="local-6989586621682085491"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085491"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085492"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085492"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085493"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085493"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621682085494"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085494"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-879"></span><span>  </span><span class="annot"><span class="annottext">TPhase FilePath -&gt; m FilePath
forall a. TPhase a -&gt; m a
forall (f :: * -&gt; *) (m :: * -&gt; *) a. MonadUse f m =&gt; f a -&gt; m a
</span><a href="GHC.Driver.Pipeline.Monad.html#use"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; TPhase FilePath
</span><a href="GHC.Driver.Pipeline.Phases.html#T_ForeignJs"><span class="hs-identifier hs-var">T_ForeignJs</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085491"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085492"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085493"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085494"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span id="local-6989586621682084458"><span class="annot"><a href="GHC.Driver.Pipeline.html#hscPostBackendPipeline"><span class="hs-identifier hs-type">hscPostBackendPipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084458"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html#HscSource"><span class="hs-identifier hs-type">HscSource</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084458"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-882"></span><span id="hscPostBackendPipeline"><span class="annot"><span class="annottext">hscPostBackendPipeline :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv
-&gt; HscSource
-&gt; Backend
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#hscPostBackendPipeline"><span class="hs-identifier hs-var hs-var">hscPostBackendPipeline</span></a></span></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsBootFile"><span class="hs-identifier hs-var">HsBootFile</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-883"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#hscPostBackendPipeline"><span class="hs-identifier hs-var">hscPostBackendPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsigFile"><span class="hs-identifier hs-var">HsigFile</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-884"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#hscPostBackendPipeline"><span class="hs-identifier hs-var">hscPostBackendPipeline</span></a></span><span> </span><span id="local-6989586621682085503"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085503"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085504"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085504"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682085505"><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621682085505"><span class="hs-identifier hs-var">bcknd</span></a></span></span><span> </span><span id="local-6989586621682085506"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085506"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621682085507"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085507"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-885"></span><span>  </span><span class="annot"><span class="annottext">DefunctionalizedPostHscPipeline
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
TPipelineClass TPhase m =&gt;
DefunctionalizedPostHscPipeline
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#applyPostHscPipeline"><span class="hs-identifier hs-var">applyPostHscPipeline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Backend -&gt; DefunctionalizedPostHscPipeline
</span><a href="GHC.Driver.Backend.html#backendPostHscPipeline"><span class="hs-identifier hs-var">backendPostHscPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621682085505"><span class="hs-identifier hs-var">bcknd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085503"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085504"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085506"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085507"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span id="local-6989586621682084472"><span class="annot"><a href="GHC.Driver.Pipeline.html#applyPostHscPipeline"><span class="hs-identifier hs-type">applyPostHscPipeline</span></a></span><span>
</span><span id="line-888"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#TPipelineClass"><span class="hs-identifier hs-type">TPipelineClass</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Phases.html#TPhase"><span class="hs-identifier hs-type">TPhase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084472"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-889"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Backend.html#DefunctionalizedPostHscPipeline"><span class="hs-identifier hs-type">DefunctionalizedPostHscPipeline</span></a></span><span>
</span><span id="line-890"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Location.html#ModLocation"><span class="hs-identifier hs-type">ModLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084472"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-891"></span><span id="applyPostHscPipeline"><span class="annot"><span class="annottext">applyPostHscPipeline :: forall (m :: * -&gt; *).
TPipelineClass TPhase m =&gt;
DefunctionalizedPostHscPipeline
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#applyPostHscPipeline"><span class="hs-identifier hs-var hs-var">applyPostHscPipeline</span></a></span></span><span> </span><span class="annot"><span class="annottext">DefunctionalizedPostHscPipeline
</span><a href="GHC.Driver.Backend.html#NcgPostHscPipeline"><span class="hs-identifier hs-var">NcgPostHscPipeline</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-892"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621682085520"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085520"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span id="local-6989586621682085521"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085521"><span class="hs-identifier hs-var">he</span></a></span></span><span> </span><span id="local-6989586621682085522"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085522"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621682085523"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085523"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#asPipeline"><span class="hs-identifier hs-var">asPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085520"><span class="hs-identifier hs-var">pe</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085521"><span class="hs-identifier hs-var">he</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085522"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085523"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-893"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#applyPostHscPipeline"><span class="hs-identifier hs-var">applyPostHscPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">DefunctionalizedPostHscPipeline
</span><a href="GHC.Driver.Backend.html#ViaCPostHscPipeline"><span class="hs-identifier hs-var">ViaCPostHscPipeline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-var">viaCPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#HCc"><span class="hs-identifier hs-var">HCc</span></a></span><span>
</span><span id="line-894"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#applyPostHscPipeline"><span class="hs-identifier hs-var">applyPostHscPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">DefunctionalizedPostHscPipeline
</span><a href="GHC.Driver.Backend.html#LlvmPostHscPipeline"><span class="hs-identifier hs-var">LlvmPostHscPipeline</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-895"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621682085526"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085526"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span id="local-6989586621682085527"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085527"><span class="hs-identifier hs-var">he</span></a></span></span><span> </span><span id="local-6989586621682085528"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085528"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621682085529"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085529"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmPipeline"><span class="hs-identifier hs-var">llvmPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085526"><span class="hs-identifier hs-var">pe</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085527"><span class="hs-identifier hs-var">he</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085528"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085529"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-896"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#applyPostHscPipeline"><span class="hs-identifier hs-var">applyPostHscPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">DefunctionalizedPostHscPipeline
</span><a href="GHC.Driver.Backend.html#JSPostHscPipeline"><span class="hs-identifier hs-var">JSPostHscPipeline</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-897"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621682085531"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085531"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span id="local-6989586621682085532"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085532"><span class="hs-identifier hs-var">he</span></a></span></span><span> </span><span id="local-6989586621682085533"><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085533"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621682085534"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085534"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe FilePath) -&gt; m FilePath -&gt; m (Maybe FilePath)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m FilePath
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m FilePath
</span><a href="GHC.Driver.Pipeline.html#jsPipeline"><span class="hs-identifier hs-var">jsPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085531"><span class="hs-identifier hs-var">pe</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085532"><span class="hs-identifier hs-var">he</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><a href="#local-6989586621682085533"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085534"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-898"></span><span class="annot"><a href="GHC.Driver.Pipeline.html#applyPostHscPipeline"><span class="hs-identifier hs-var">applyPostHscPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">DefunctionalizedPostHscPipeline
</span><a href="GHC.Driver.Backend.html#NoPostHscPipeline"><span class="hs-identifier hs-var">NoPostHscPipeline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PipeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span class="hs-comment">-- Pipeline from a given suffix</span><span>
</span><span id="line-901"></span><span id="local-6989586621682084397"><span class="annot"><a href="GHC.Driver.Pipeline.html#pipelineStart"><span class="hs-identifier hs-type">pipelineStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084397"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.Monad.html#PipeEnv"><span class="hs-identifier hs-type">PipeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084397"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-902"></span><span id="pipelineStart"><span class="annot"><span class="annottext">pipelineStart :: forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; Maybe Phase -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#pipelineStart"><span class="hs-identifier hs-var hs-var">pipelineStart</span></a></span></span><span> </span><span id="local-6989586621682085538"><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span></span><span> </span><span id="local-6989586621682085539"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621682085540"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span></span><span> </span><span id="local-6989586621682085541"><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682085541"><span class="hs-identifier hs-var">mb_phase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-903"></span><span>  </span><span class="annot"><span class="annottext">Phase -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; Phase -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Phase -&gt; Maybe Phase -&gt; Phase
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../base-4.18.2.1/src/Data.Maybe.html#fromMaybe/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Phase
</span><a href="GHC.Driver.Phases.html#startPhase"><span class="hs-identifier hs-var">startPhase</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Phase) -&gt; FilePath -&gt; Phase
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; FilePath
</span><a href="GHC.Driver.Pipeline.Monad.html#src_suffix"><span class="hs-identifier hs-var">src_suffix</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Maybe Phase
</span><a href="#local-6989586621682085541"><span class="hs-identifier hs-var">mb_phase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-905"></span><span>   </span><span id="local-6989586621682085543"><span class="annot"><span class="annottext">stop_after :: StopPhase
</span><a href="#local-6989586621682085543"><span class="hs-identifier hs-var hs-var">stop_after</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; StopPhase
</span><a href="GHC.Driver.Pipeline.Monad.html#stop_phase"><span class="hs-identifier hs-var">stop_phase</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span>
</span><span id="line-906"></span><span>   </span><span id="local-6989586621682084477"><span class="annot"><a href="#local-6989586621682085544"><span class="hs-identifier hs-type">frontend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084477"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html#HscSource"><span class="hs-identifier hs-type">HscSource</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084477"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-907"></span><span>   </span><span id="local-6989586621682085544"><span class="annot"><span class="annottext">frontend :: forall (m :: * -&gt; *). P m =&gt; HscSource -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085544"><span class="hs-identifier hs-var hs-var">frontend</span></a></span></span><span> </span><span id="local-6989586621682085564"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085564"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StopPhase
</span><a href="#local-6989586621682085543"><span class="hs-identifier hs-var">stop_after</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-908"></span><span>                    </span><span class="annot"><span class="annottext">StopPhase
</span><a href="GHC.Driver.Phases.html#StopPreprocess"><span class="hs-identifier hs-var">StopPreprocess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-909"></span><span>                      </span><span class="hs-comment">-- The actual output from preprocessing</span><span>
</span><span id="line-910"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682085565"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085565"><span class="hs-identifier hs-var">out_fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (DynFlags, FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (DynFlags, FilePath)
</span><a href="GHC.Driver.Pipeline.html#preprocessPipeline"><span class="hs-identifier hs-var">preprocessPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-911"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085566"><span class="annot"><span class="annottext">logger :: Logger
</span><a href="#local-6989586621682085566"><span class="hs-identifier hs-var hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; Logger
</span><a href="GHC.Driver.Env.Types.html#hsc_logger"><span class="hs-identifier hs-var">hsc_logger</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-912"></span><span>                      </span><span class="hs-comment">-- Sometimes, a compilation phase doesn't actually generate any output</span><span>
</span><span id="line-913"></span><span>                      </span><span class="hs-comment">-- (eg. the CPP phase when -fcpp is not turned on).  If we end on this</span><span>
</span><span id="line-914"></span><span>                      </span><span class="hs-comment">-- stage, but we wanted to keep the output, then we have to explicitly</span><span>
</span><span id="line-915"></span><span>                      </span><span class="hs-comment">-- copy the file, remembering to prepend a {-# LINE #-} pragma so that</span><span>
</span><span id="line-916"></span><span>                      </span><span class="hs-comment">-- further compilation stages can tell what the original filename was.</span><span>
</span><span id="line-917"></span><span>                      </span><span class="hs-comment">-- File name we expected the output to have</span><span>
</span><span id="line-918"></span><span>                      </span><span id="local-6989586621682085567"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085567"><span class="hs-identifier hs-var">final_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; m FilePath
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO FilePath -&gt; m FilePath) -&gt; IO FilePath -&gt; m FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Phase -&gt; PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; IO FilePath
</span><a href="GHC.Driver.Pipeline.Execute.html#phaseOutputFilenameNew"><span class="hs-identifier hs-var">phaseOutputFilenameNew</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscSource -&gt; Phase
</span><a href="GHC.Driver.Phases.html#Hsc"><span class="hs-identifier hs-var">Hsc</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsSrcFile"><span class="hs-identifier hs-var">HsSrcFile</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-919"></span><span>                      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085567"><span class="hs-identifier hs-var">final_fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085565"><span class="hs-identifier hs-var">out_fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-920"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682085570"><span class="annot"><span class="annottext">msg :: FilePath
</span><a href="#local-6989586621682085570"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Copying `&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085565"><span class="hs-identifier hs-var">out_fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;' to `&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085567"><span class="hs-identifier hs-var">final_fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;'&quot;</span></span><span>
</span><span id="line-921"></span><span>                            </span><span id="local-6989586621682085571"><span class="annot"><span class="annottext">line_prag :: FilePath
</span><a href="#local-6989586621682085571"><span class="hs-identifier hs-var hs-var">line_prag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;{-# LINE 1 \&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; FilePath
</span><a href="GHC.Driver.Pipeline.Monad.html#src_filename"><span class="hs-identifier hs-var">src_filename</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\&quot; #-}\n&quot;</span></span><span>
</span><span id="line-922"></span><span>                        </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logger -&gt; FilePath -&gt; IO ()
</span><a href="GHC.Utils.Error.html#showPass"><span class="hs-identifier hs-var">showPass</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682085566"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085570"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>                        </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.18.2.1/src/Control.Monad.IO.Class.html#liftIO/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath -&gt; IO ()
</span><a href="GHC.SysTools.html#copyWithHeader"><span class="hs-identifier hs-var">copyWithHeader</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085571"><span class="hs-identifier hs-var">line_prag</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085565"><span class="hs-identifier hs-var">out_fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085567"><span class="hs-identifier hs-var">final_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>                      </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-925"></span><span>                    </span><span class="annot"><span class="annottext">StopPhase
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ModIface, HomeModLinkable) -&gt; Maybe FilePath
forall {a}. (a, HomeModLinkable) -&gt; Maybe FilePath
</span><a href="#local-6989586621682085574"><span class="hs-identifier hs-var">objFromLinkable</span></a></span><span> </span><span class="annot"><span class="annottext">((ModIface, HomeModLinkable) -&gt; Maybe FilePath)
-&gt; m (ModIface, HomeModLinkable) -&gt; m (Maybe FilePath)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; FilePath -&gt; HscSource -&gt; m (ModIface, HomeModLinkable)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; FilePath -&gt; HscSource -&gt; m (ModIface, HomeModLinkable)
</span><a href="GHC.Driver.Pipeline.html#fullPipeline"><span class="hs-identifier hs-var">fullPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085564"><span class="hs-identifier hs-var">sf</span></a></span><span>
</span><span id="line-926"></span><span>   </span><span id="local-6989586621682085575"><span class="annot"><a href="#local-6989586621682085576"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682085575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682085575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-927"></span><span>   </span><span id="local-6989586621682085576"><span class="annot"><span class="annottext">c :: forall (m :: * -&gt; *). P m =&gt; Phase -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085576"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682085579"><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085579"><span class="hs-identifier hs-var">phase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Phase
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#viaCPipeline"><span class="hs-identifier hs-var">viaCPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="#local-6989586621682085579"><span class="hs-identifier hs-var">phase</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-928"></span><span>   </span><span id="local-6989586621682084481"><span class="annot"><a href="#local-6989586621682085580"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084481"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084481"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-929"></span><span>   </span><span id="local-6989586621682085580"><span class="annot"><span class="annottext">as :: forall (m :: * -&gt; *). P m =&gt; Bool -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085580"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span id="local-6989586621682085583"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085583"><span class="hs-identifier hs-var">use_cpp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
Bool
-&gt; PipeEnv
-&gt; HscEnv
-&gt; Maybe ModLocation
-&gt; FilePath
-&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#asPipeline"><span class="hs-identifier hs-var">asPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085583"><span class="hs-identifier hs-var">use_cpp</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-930"></span><span>
</span><span id="line-931"></span><span>   </span><span id="local-6989586621682085574"><span class="annot"><span class="annottext">objFromLinkable :: (a, HomeModLinkable) -&gt; Maybe FilePath
</span><a href="#local-6989586621682085574"><span class="hs-identifier hs-var hs-var">objFromLinkable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HomeModLinkable -&gt; Maybe Linkable
</span><a href="GHC.Unit.Home.ModInfo.html#homeMod_object"><span class="hs-identifier hs-var">homeMod_object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Linker.Types.html#LM"><span class="hs-identifier hs-type">LM</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Module
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Linker.Types.html#DotO"><span class="hs-identifier hs-type">DotO</span></a></span><span> </span><span id="local-6989586621682085584"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085584"><span class="hs-identifier hs-var">lnk</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085584"><span class="hs-identifier hs-var">lnk</span></a></span><span>
</span><span id="line-932"></span><span>   </span><span class="annot"><a href="#local-6989586621682085574"><span class="hs-identifier hs-var">objFromLinkable</span></a></span><span> </span><span class="annot"><span class="annottext">(a, HomeModLinkable)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span>   </span><span id="local-6989586621682084476"><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-type">fromPhase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Pipeline.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682084476"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Phases.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682084476"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-935"></span><span>   </span><span id="local-6989586621682085542"><span class="annot"><span class="annottext">fromPhase :: forall (m :: * -&gt; *). P m =&gt; Phase -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085542"><span class="hs-identifier hs-var hs-var">fromPhase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Phases.html#Unlit"><span class="hs-identifier hs-type">Unlit</span></a></span><span> </span><span id="local-6989586621682085608"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085608"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscSource -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; HscSource -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085544"><span class="hs-identifier hs-var">frontend</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085608"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-936"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Phases.html#Cpp"><span class="hs-identifier hs-type">Cpp</span></a></span><span> </span><span id="local-6989586621682085609"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085609"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscSource -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; HscSource -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085544"><span class="hs-identifier hs-var">frontend</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085609"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-937"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Phases.html#HsPp"><span class="hs-identifier hs-type">HsPp</span></a></span><span> </span><span id="local-6989586621682085610"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085610"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscSource -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; HscSource -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085544"><span class="hs-identifier hs-var">frontend</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085610"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-938"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Phases.html#Hsc"><span class="hs-identifier hs-type">Hsc</span></a></span><span> </span><span id="local-6989586621682085611"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085611"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscSource -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; HscSource -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085544"><span class="hs-identifier hs-var">frontend</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621682085611"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-939"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#HCc"><span class="hs-identifier hs-var">HCc</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; Phase -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085576"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#HCc"><span class="hs-identifier hs-var">HCc</span></a></span><span>
</span><span id="line-940"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cc"><span class="hs-identifier hs-var">Cc</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; Phase -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085576"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cc"><span class="hs-identifier hs-var">Cc</span></a></span><span>
</span><span id="line-941"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Ccxx"><span class="hs-identifier hs-var">Ccxx</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; Phase -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085576"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Ccxx"><span class="hs-identifier hs-var">Ccxx</span></a></span><span>
</span><span id="line-942"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cobjc"><span class="hs-identifier hs-var">Cobjc</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; Phase -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085576"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cobjc"><span class="hs-identifier hs-var">Cobjc</span></a></span><span>
</span><span id="line-943"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cobjcxx"><span class="hs-identifier hs-var">Cobjcxx</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phase -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; Phase -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085576"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cobjcxx"><span class="hs-identifier hs-var">Cobjcxx</span></a></span><span>
</span><span id="line-944"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.Phases.html#As"><span class="hs-identifier hs-type">As</span></a></span><span> </span><span id="local-6989586621682085613"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085613"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *). P m =&gt; Bool -&gt; m (Maybe FilePath)
</span><a href="#local-6989586621682085580"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682085613"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-945"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#LlvmOpt"><span class="hs-identifier hs-var">LlvmOpt</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmPipeline"><span class="hs-identifier hs-var">llvmPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-946"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#LlvmLlc"><span class="hs-identifier hs-var">LlvmLlc</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmLlcPipeline"><span class="hs-identifier hs-var">llvmLlcPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-947"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#LlvmMangle"><span class="hs-identifier hs-var">LlvmMangle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv
-&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#llvmManglePipeline"><span class="hs-identifier hs-var">llvmManglePipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-948"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#StopLn"><span class="hs-identifier hs-var">StopLn</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; m (Maybe FilePath)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-949"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#CmmCpp"><span class="hs-identifier hs-var">CmmCpp</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#cmmCppPipeline"><span class="hs-identifier hs-var">cmmCppPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-950"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Cmm"><span class="hs-identifier hs-var">Cmm</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; FilePath -&gt; m (Maybe FilePath)
</span><a href="GHC.Driver.Pipeline.html#cmmPipeline"><span class="hs-identifier hs-var">cmmPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-951"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#Js"><span class="hs-identifier hs-var">Js</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe FilePath) -&gt; m FilePath -&gt; m (Maybe FilePath)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m FilePath
forall (m :: * -&gt; *).
P m =&gt;
PipeEnv -&gt; HscEnv -&gt; Maybe ModLocation -&gt; FilePath -&gt; m FilePath
</span><a href="GHC.Driver.Pipeline.html#foreignJsPipeline"><span class="hs-identifier hs-var">foreignJsPipeline</span></a></span><span> </span><span class="annot"><span class="annottext">PipeEnv
</span><a href="#local-6989586621682085538"><span class="hs-identifier hs-var">pipe_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621682085539"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModLocation
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621682085540"><span class="hs-identifier hs-var">input_fn</span></a></span><span>
</span><span id="line-952"></span><span>   </span><span class="annot"><a href="#local-6989586621682085542"><span class="hs-identifier hs-var">fromPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Phase
</span><a href="GHC.Driver.Phases.html#MergeForeign"><span class="hs-identifier hs-var">MergeForeign</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m (Maybe FilePath)
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;fromPhase: MergeForeign&quot;</span></span><span>
</span><span id="line-953"></span><span>
</span><span id="line-954"></span><span class="hs-comment">{-
Note [The Pipeline Monad]
~~~~~~~~~~~~~~~~~~~~~~~~~
The pipeline is represented as a free monad by the `TPipelineClass` type synonym,
which stipulates the general monadic interface for the pipeline and `MonadUse`, instantiated
to `TPhase`, which indicates the actions available in the pipeline.

The `TPhase` actions correspond to different compiled phases, they are executed by
the 'runPhase' function which interprets each action into IO.

The idea in the future is that we can now implement different instiations of
`TPipelineClass` to give different behaviours that the default `HookedPhase` implementation:

* Additional logging of different phases
* Automatic parallelism (in the style of shake)
* Easy consumption by external tools such as ghcide
* Easier to create your own pipeline and extend existing pipelines.

The structure of the code as a free monad also means that the return type of each
phase is a lot more flexible.

-}</span><span>
</span><span id="line-976"></span></pre></body></html>