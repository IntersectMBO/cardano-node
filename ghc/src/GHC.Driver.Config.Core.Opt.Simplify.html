<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Driver.Config.Core.Opt.Simplify</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplifyExprOpts"><span class="hs-identifier">initSimplifyExprOpts</span></a></span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplifyOpts"><span class="hs-identifier">initSimplifyOpts</span></a></span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplMode"><span class="hs-identifier">initSimplMode</span></a></span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initGentleSimplMode"><span class="hs-identifier">initGentleSimplMode</span></a></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html"><span class="hs-identifier">GHC.Core.Rules</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleBase"><span class="hs-identifier">RuleBase</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Pipeline.Types.html"><span class="hs-identifier">GHC.Core.Opt.Pipeline.Types</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Pipeline.Types.html#CoreToDo"><span class="hs-identifier">CoreToDo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.html"><span class="hs-identifier">GHC.Core.Opt.Simplify</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.html#SimplifyExprOpts"><span class="hs-identifier">SimplifyExprOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.html#SimplifyOpts"><span class="hs-identifier">SimplifyOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html"><span class="hs-identifier">GHC.Core.Opt.Simplify.Env</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#FloatEnable"><span class="hs-identifier">FloatEnable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#SimplMode"><span class="hs-identifier">SimplMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Monad.html"><span class="hs-identifier">GHC.Core.Opt.Simplify.Monad</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Monad.html#TopEnvConfig"><span class="hs-identifier">TopEnvConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Config.html"><span class="hs-identifier">GHC.Driver.Config</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Driver.Config.html#initOptCoercionOpts"><span class="hs-identifier">initOptCoercionOpts</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Lint.html"><span class="hs-identifier">GHC.Driver.Config.Core.Lint</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Lint.html#initLintPassResultConfig"><span class="hs-identifier">initLintPassResultConfig</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Rules.html"><span class="hs-identifier">GHC.Driver.Config.Core.Rules</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Rules.html#initRuleOpts"><span class="hs-identifier">initRuleOpts</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Arity.html"><span class="hs-identifier">GHC.Driver.Config.Core.Opt.Arity</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Arity.html#initArityOpts"><span class="hs-identifier">initArityOpts</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier">DynFlags</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#GeneralFlag"><span class="hs-identifier">GeneralFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier">gopt</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Context.html"><span class="hs-identifier">GHC.Runtime.Context</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Runtime.Context.html#InteractiveContext"><span class="hs-identifier">InteractiveContext</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#CompilerPhase"><span class="hs-identifier">CompilerPhase</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier">Var</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplifyExprOpts"><span class="hs-identifier hs-type">initSimplifyExprOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Runtime.Context.html#InteractiveContext"><span class="hs-identifier hs-type">InteractiveContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.html#SimplifyExprOpts"><span class="hs-identifier hs-type">SimplifyExprOpts</span></a></span><span>
</span><span id="line-28"></span><span id="initSimplifyExprOpts"><span class="annot"><span class="annottext">initSimplifyExprOpts :: DynFlags -&gt; InteractiveContext -&gt; SimplifyExprOpts
</span><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplifyExprOpts"><span class="hs-identifier hs-var hs-var">initSimplifyExprOpts</span></a></span></span><span> </span><span id="local-6989586621681963780"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963780"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681963781"><span class="annot"><span class="annottext">InteractiveContext
</span><a href="#local-6989586621681963781"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.html#SimplifyExprOpts"><span class="hs-identifier hs-type">SimplifyExprOpts</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">se_fam_inst :: [FamInst]
</span><a href="GHC.Core.Opt.Simplify.html#se_fam_inst"><span class="hs-identifier hs-var">se_fam_inst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InstEnv, [FamInst]) -&gt; [FamInst]
forall a b. (a, b) -&gt; b
</span><a href="../../base-4.18.3.0/src/Data.Tuple.html#snd/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((InstEnv, [FamInst]) -&gt; [FamInst])
-&gt; (InstEnv, [FamInst]) -&gt; [FamInst]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InteractiveContext -&gt; (InstEnv, [FamInst])
</span><a href="GHC.Runtime.Context.html#ic_instances"><span class="hs-identifier hs-var">ic_instances</span></a></span><span> </span><span class="annot"><span class="annottext">InteractiveContext
</span><a href="#local-6989586621681963781"><span class="hs-identifier hs-var">ic</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">se_mode :: SimplMode
</span><a href="GHC.Core.Opt.Simplify.html#se_mode"><span class="hs-identifier hs-var">se_mode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; CompilerPhase -&gt; String -&gt; SimplMode
</span><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplMode"><span class="hs-identifier hs-var">initSimplMode</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963780"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerPhase
</span><a href="GHC.Types.Basic.html#InitialPhase"><span class="hs-identifier hs-var">InitialPhase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHCi&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#sm_inline"><span class="hs-identifier hs-var">sm_inline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-32"></span><span>      </span><span class="hs-comment">-- Do not do any inlining, in case we expose some</span><span>
</span><span id="line-33"></span><span>      </span><span class="hs-comment">-- unboxed tuple stuff that confuses the bytecode</span><span>
</span><span id="line-34"></span><span>      </span><span class="hs-comment">-- interpreter</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">se_top_env_cfg :: TopEnvConfig
</span><a href="GHC.Core.Opt.Simplify.html#se_top_env_cfg"><span class="hs-identifier hs-var">se_top_env_cfg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Monad.html#TopEnvConfig"><span class="hs-identifier hs-type">TopEnvConfig</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">te_history_size :: Int
</span><a href="GHC.Core.Opt.Simplify.Monad.html#te_history_size"><span class="hs-identifier hs-var">te_history_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Int
</span><a href="GHC.Driver.Session.html#historySize"><span class="hs-identifier hs-var">historySize</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963780"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">te_tick_factor :: Int
</span><a href="GHC.Core.Opt.Simplify.Monad.html#te_tick_factor"><span class="hs-identifier hs-var">te_tick_factor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Int
</span><a href="GHC.Driver.Session.html#simplTickFactor"><span class="hs-identifier hs-var">simplTickFactor</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963780"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplifyOpts"><span class="hs-identifier hs-type">initSimplifyOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#SimplMode"><span class="hs-identifier hs-type">SimplMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.html#RuleBase"><span class="hs-identifier hs-type">RuleBase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.html#SimplifyOpts"><span class="hs-identifier hs-type">SimplifyOpts</span></a></span><span>
</span><span id="line-43"></span><span id="initSimplifyOpts"><span class="annot"><span class="annottext">initSimplifyOpts :: DynFlags -&gt; [Var] -&gt; Int -&gt; SimplMode -&gt; RuleBase -&gt; SimplifyOpts
</span><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplifyOpts"><span class="hs-identifier hs-var hs-var">initSimplifyOpts</span></a></span></span><span> </span><span id="local-6989586621681963795"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963795"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681963796"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681963796"><span class="hs-identifier hs-var">extra_vars</span></a></span></span><span> </span><span id="local-6989586621681963797"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681963797"><span class="hs-identifier hs-var">iterations</span></a></span></span><span> </span><span id="local-6989586621681963798"><span class="annot"><span class="annottext">SimplMode
</span><a href="#local-6989586621681963798"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621681963799"><span class="annot"><span class="annottext">RuleBase
</span><a href="#local-6989586621681963799"><span class="hs-identifier hs-var">hpt_rule_base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-comment">-- This is a particularly ugly construction, but we will get rid of it in !8341.</span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621681963800"><span class="annot"><span class="annottext">opts :: SimplifyOpts
</span><a href="#local-6989586621681963800"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.html#SimplifyOpts"><span class="hs-identifier hs-type">SimplifyOpts</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">so_dump_core_sizes :: Bool
</span><a href="GHC.Core.Opt.Simplify.html#so_dump_core_sizes"><span class="hs-identifier hs-var">so_dump_core_sizes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_SuppressCoreSizes"><span class="hs-identifier hs-var">Opt_SuppressCoreSizes</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963795"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">so_iterations :: Int
</span><a href="GHC.Core.Opt.Simplify.html#so_iterations"><span class="hs-identifier hs-var">so_iterations</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681963797"><span class="hs-identifier hs-var">iterations</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">so_mode :: SimplMode
</span><a href="GHC.Core.Opt.Simplify.html#so_mode"><span class="hs-identifier hs-var">so_mode</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplMode
</span><a href="#local-6989586621681963798"><span class="hs-identifier hs-var">mode</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">so_pass_result_cfg :: Maybe LintPassResultConfig
</span><a href="GHC.Core.Opt.Simplify.html#so_pass_result_cfg"><span class="hs-identifier hs-var">so_pass_result_cfg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_DoCoreLinting"><span class="hs-identifier hs-var">Opt_DoCoreLinting</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963795"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-50"></span><span>                           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig -&gt; Maybe LintPassResultConfig
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(LintPassResultConfig -&gt; Maybe LintPassResultConfig)
-&gt; LintPassResultConfig -&gt; Maybe LintPassResultConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.3.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; [Var] -&gt; CoreToDo -&gt; LintPassResultConfig
</span><a href="GHC.Driver.Config.Core.Lint.html#initLintPassResultConfig"><span class="hs-identifier hs-var">initLintPassResultConfig</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963795"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681963796"><span class="hs-identifier hs-var">extra_vars</span></a></span><span>
</span><span id="line-51"></span><span>                                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimplifyOpts -&gt; CoreToDo
</span><a href="GHC.Core.Opt.Pipeline.Types.html#CoreDoSimplify"><span class="hs-identifier hs-var">CoreDoSimplify</span></a></span><span> </span><span class="annot"><span class="annottext">SimplifyOpts
</span><a href="#local-6989586621681963800"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>                           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe LintPassResultConfig
forall a. Maybe a
</span><a href="../../base-4.18.3.0/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">so_hpt_rules :: RuleBase
</span><a href="GHC.Core.Opt.Simplify.html#so_hpt_rules"><span class="hs-identifier hs-var">so_hpt_rules</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleBase
</span><a href="#local-6989586621681963799"><span class="hs-identifier hs-var">hpt_rule_base</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">so_top_env_cfg :: TopEnvConfig
</span><a href="GHC.Core.Opt.Simplify.html#so_top_env_cfg"><span class="hs-identifier hs-var">so_top_env_cfg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Monad.html#TopEnvConfig"><span class="hs-identifier hs-type">TopEnvConfig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">te_history_size :: Int
</span><a href="GHC.Core.Opt.Simplify.Monad.html#te_history_size"><span class="hs-identifier hs-var">te_history_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Int
</span><a href="GHC.Driver.Session.html#historySize"><span class="hs-identifier hs-var">historySize</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963795"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-55"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">te_tick_factor :: Int
</span><a href="GHC.Core.Opt.Simplify.Monad.html#te_tick_factor"><span class="hs-identifier hs-var">te_tick_factor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Int
</span><a href="GHC.Driver.Session.html#simplTickFactor"><span class="hs-identifier hs-var">simplTickFactor</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963795"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SimplifyOpts
</span><a href="#local-6989586621681963800"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplMode"><span class="hs-identifier hs-type">initSimplMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#CompilerPhase"><span class="hs-identifier hs-type">CompilerPhase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.3.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#SimplMode"><span class="hs-identifier hs-type">SimplMode</span></a></span><span>
</span><span id="line-60"></span><span id="initSimplMode"><span class="annot"><span class="annottext">initSimplMode :: DynFlags -&gt; CompilerPhase -&gt; String -&gt; SimplMode
</span><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplMode"><span class="hs-identifier hs-var hs-var">initSimplMode</span></a></span></span><span> </span><span id="local-6989586621681963812"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681963813"><span class="annot"><span class="annottext">CompilerPhase
</span><a href="#local-6989586621681963813"><span class="hs-identifier hs-var">phase</span></a></span></span><span> </span><span id="local-6989586621681963814"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681963814"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#SimplMode"><span class="hs-identifier hs-type">SimplMode</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sm_names :: [String]
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_names"><span class="hs-identifier hs-var">sm_names</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681963814"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_phase :: CompilerPhase
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_phase"><span class="hs-identifier hs-var">sm_phase</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompilerPhase
</span><a href="#local-6989586621681963813"><span class="hs-identifier hs-var">phase</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_rules :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_rules"><span class="hs-identifier hs-var">sm_rules</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_EnableRewriteRules"><span class="hs-identifier hs-var">Opt_EnableRewriteRules</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_eta_expand :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_eta_expand"><span class="hs-identifier hs-var">sm_eta_expand</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_DoLambdaEtaExpansion"><span class="hs-identifier hs-var">Opt_DoLambdaEtaExpansion</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_cast_swizzle :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_cast_swizzle"><span class="hs-identifier hs-var">sm_cast_swizzle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_inline :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_inline"><span class="hs-identifier hs-var">sm_inline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_uf_opts :: UnfoldingOpts
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_uf_opts"><span class="hs-identifier hs-var">sm_uf_opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; UnfoldingOpts
</span><a href="GHC.Driver.Session.html#unfoldingOpts"><span class="hs-identifier hs-var">unfoldingOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_case_case :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_case_case"><span class="hs-identifier hs-var">sm_case_case</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_pre_inline :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_pre_inline"><span class="hs-identifier hs-var">sm_pre_inline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_SimplPreInlining"><span class="hs-identifier hs-var">Opt_SimplPreInlining</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_float_enable :: FloatEnable
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_float_enable"><span class="hs-identifier hs-var">sm_float_enable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; FloatEnable
</span><a href="GHC.Driver.Config.Core.Opt.Simplify.html#floatEnable"><span class="hs-identifier hs-var">floatEnable</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_do_eta_reduction :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_do_eta_reduction"><span class="hs-identifier hs-var">sm_do_eta_reduction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_DoEtaReduction"><span class="hs-identifier hs-var">Opt_DoEtaReduction</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_arity_opts :: ArityOpts
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_arity_opts"><span class="hs-identifier hs-var">sm_arity_opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; ArityOpts
</span><a href="GHC.Driver.Config.Core.Opt.Arity.html#initArityOpts"><span class="hs-identifier hs-var">initArityOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_rule_opts :: RuleOpts
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_rule_opts"><span class="hs-identifier hs-var">sm_rule_opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; RuleOpts
</span><a href="GHC.Driver.Config.Core.Rules.html#initRuleOpts"><span class="hs-identifier hs-var">initRuleOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_case_folding :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_case_folding"><span class="hs-identifier hs-var">sm_case_folding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_CaseFolding"><span class="hs-identifier hs-var">Opt_CaseFolding</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_case_merge :: Bool
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_case_merge"><span class="hs-identifier hs-var">sm_case_merge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_CaseMerge"><span class="hs-identifier hs-var">Opt_CaseMerge</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sm_co_opt_opts :: OptCoercionOpts
</span><a href="GHC.Core.Opt.Simplify.Env.html#sm_co_opt_opts"><span class="hs-identifier hs-var">sm_co_opt_opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; OptCoercionOpts
</span><a href="GHC.Driver.Config.html#initOptCoercionOpts"><span class="hs-identifier hs-var">initOptCoercionOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963812"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initGentleSimplMode"><span class="hs-identifier hs-type">initGentleSimplMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#SimplMode"><span class="hs-identifier hs-type">SimplMode</span></a></span><span>
</span><span id="line-80"></span><span id="initGentleSimplMode"><span class="annot"><span class="annottext">initGentleSimplMode :: DynFlags -&gt; SimplMode
</span><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initGentleSimplMode"><span class="hs-identifier hs-var hs-var">initGentleSimplMode</span></a></span></span><span> </span><span id="local-6989586621681963839"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963839"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; CompilerPhase -&gt; String -&gt; SimplMode
</span><a href="GHC.Driver.Config.Core.Opt.Simplify.html#initSimplMode"><span class="hs-identifier hs-var">initSimplMode</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963839"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerPhase
</span><a href="GHC.Types.Basic.html#InitialPhase"><span class="hs-identifier hs-var">InitialPhase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Gentle&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Don't do case-of-case transformations.</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-comment">-- This makes full laziness work better</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">-- See Note [Case-of-case and full laziness]</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#sm_case_case"><span class="hs-identifier hs-var">sm_case_case</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><a href="GHC.Driver.Config.Core.Opt.Simplify.html#floatEnable"><span class="hs-identifier hs-type">floatEnable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Simplify.Env.html#FloatEnable"><span class="hs-identifier hs-type">FloatEnable</span></a></span><span>
</span><span id="line-88"></span><span id="floatEnable"><span class="annot"><span class="annottext">floatEnable :: DynFlags -&gt; FloatEnable
</span><a href="GHC.Driver.Config.Core.Opt.Simplify.html#floatEnable"><span class="hs-identifier hs-var hs-var">floatEnable</span></a></span></span><span> </span><span id="local-6989586621681963840"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963840"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_LocalFloatOut"><span class="hs-identifier hs-var">Opt_LocalFloatOut</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963840"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_LocalFloatOutTopLevel"><span class="hs-identifier hs-var">Opt_LocalFloatOutTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681963840"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatEnable
</span><a href="GHC.Core.Opt.Simplify.Env.html#FloatEnabled"><span class="hs-identifier hs-var">FloatEnabled</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatEnable
</span><a href="GHC.Core.Opt.Simplify.Env.html#FloatNestedOnly"><span class="hs-identifier hs-var">FloatNestedOnly</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatEnable
</span><a href="GHC.Core.Opt.Simplify.Env.html#FloatDisabled"><span class="hs-identifier hs-var">FloatDisabled</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">{- Note [Case-of-case and full laziness]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Case-of-case can hide opportunities for let-floating (full laziness).
For example
   rec { f = \y. case (expensive x) of (a,b) -&gt; blah }
We might hope to float the (expensive x) out of the \y-loop.
But if we inline `expensive` we might get
   \y. case (case x of I# x' -&gt; body) of (a,b) -&gt; blah
Now if we do case-of-case we get
   \y. case x if I# x2 -&gt;
       case body of (a,b) -&gt; blah

Sadly, at this point `body` mentions `x2`, so we can't float it out of the
\y-loop.

Solution: don't do case-of-case in the &quot;gentle&quot; simplification phase that
precedes the first float-out transformation.  Implementation:

  * `sm_case_case` field in SimplMode

  * Consult `sm_case_case` (via `seCaseCase`) before doing case-of-case
    in GHC.Core.Opt.Simplify.Iteration.rebuildCall.

Wrinkles

* This applies equally to the case-of-runRW# transformation:
    case (runRW# (\s. body)) of (a,b) -&gt; blah
    ---&gt;
    runRW# (\s. case body of (a,b) -&gt; blah)
  Again, don't do this when `sm_case_case` is off.  See #25055 for
  a motivating example.
-}</span><span>
</span><span id="line-127"></span></pre></body></html>