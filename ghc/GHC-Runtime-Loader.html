<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.Runtime.Loader</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ghc-9.6.7: The GHC API</span><ul class="links" id="page-menu"><li><a href="src/GHC.Runtime.Loader.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.Runtime.Loader</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Loading plugins</a></li><li><a href="#g:2">Force loading information</a></li><li><a href="#g:3">Finding names</a></li><li><a href="#g:4">Loading values</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Dynamically lookup up values from modules and loading them.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:initializePlugins">initializePlugins</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a></li><li class="src short"><a href="#v:initializeSessionPlugins">initializeSessionPlugins</a> :: <a href="GHC-Driver-Monad.html#t:GhcMonad" title="GHC.Driver.Monad">GhcMonad</a> m =&gt; m ()</li><li class="src short"><a href="#v:loadFrontendPlugin">loadFrontendPlugin</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Driver-Plugins.html#t:FrontendPlugin" title="GHC.Driver.Plugins">FrontendPlugin</a>, [<a href="GHC-Linker-Types.html#t:Linkable" title="GHC.Linker.Types">Linkable</a>], <a href="GHC-Linker-Types.html#t:PkgsLoaded" title="GHC.Linker.Types">PkgsLoaded</a>)</li><li class="src short"><a href="#v:forceLoadModuleInterfaces">forceLoadModuleInterfaces</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Utils-Outputable.html#t:SDoc" title="GHC.Utils.Outputable">SDoc</a> -&gt; [<a href="GHC-Unit-Types.html#t:Module" title="GHC.Unit.Types">Module</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> ()</li><li class="src short"><a href="#v:forceLoadNameModuleInterface">forceLoadNameModuleInterface</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Utils-Outputable.html#t:SDoc" title="GHC.Utils.Outputable">SDoc</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> ()</li><li class="src short"><a href="#v:forceLoadTyCon">forceLoadTyCon</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a></li><li class="src short"><a href="#v:lookupRdrNameInModuleForPlugins">lookupRdrNameInModuleForPlugins</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a> -&gt; <a href="GHC-Types-Name-Reader.html#t:RdrName" title="GHC.Types.Name.Reader">RdrName</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> (<a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a>, <a href="GHC-Unit-Module-ModIface.html#t:ModIface" title="GHC.Unit.Module.ModIface">ModIface</a>))</li><li class="src short"><a href="#v:getValueSafely">getValueSafely</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Prelude-Basic.html#t:Either" title="GHC.Prelude.Basic">Either</a> <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> (a, [<a href="GHC-Linker-Types.html#t:Linkable" title="GHC.Linker.Types">Linkable</a>], <a href="GHC-Linker-Types.html#t:PkgsLoaded" title="GHC.Linker.Types">PkgsLoaded</a>))</li><li class="src short"><a href="#v:getHValueSafely">getHValueSafely</a> :: <a href="GHC-Runtime-Interpreter-Types.html#t:Interp" title="GHC.Runtime.Interpreter.Types">Interp</a> -&gt; <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Prelude-Basic.html#t:Either" title="GHC.Prelude.Basic">Either</a> <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> (<a href="GHC.html#t:HValue" title="GHC">HValue</a>, [<a href="GHC-Linker-Types.html#t:Linkable" title="GHC.Linker.Types">Linkable</a>], <a href="GHC-Linker-Types.html#t:PkgsLoaded" title="GHC.Linker.Types">PkgsLoaded</a>))</li><li class="src short"><a href="#v:lessUnsafeCoerce">lessUnsafeCoerce</a> :: <a href="GHC-Utils-Logger.html#t:Logger" title="GHC.Utils.Logger">Logger</a> -&gt; <a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a> -&gt; a -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> b</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:initializePlugins" class="def">initializePlugins</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> <a href="src/GHC.Runtime.Loader.html#initializePlugins" class="link">Source</a> <a href="#v:initializePlugins" class="selflink">#</a></p><div class="doc"><p>Loads the plugins specified in the pluginModNames field of the dynamic
 flags. Should be called after command line arguments are parsed, but before
 actual compilation starts. Idempotent operation. Should be re-called if
 pluginModNames or pluginModNameOpts changes.</p></div></div><div class="top"><p class="src"><a id="v:initializeSessionPlugins" class="def">initializeSessionPlugins</a> :: <a href="GHC-Driver-Monad.html#t:GhcMonad" title="GHC.Driver.Monad">GhcMonad</a> m =&gt; m () <a href="src/GHC.Runtime.Loader.html#initializeSessionPlugins" class="link">Source</a> <a href="#v:initializeSessionPlugins" class="selflink">#</a></p><div class="doc"><p>Initialise plugins specified by the current DynFlags and update the session.</p></div></div><a href="#g:1" id="g:1"><h1>Loading plugins</h1></a><div class="top"><p class="src"><a id="v:loadFrontendPlugin" class="def">loadFrontendPlugin</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Driver-Plugins.html#t:FrontendPlugin" title="GHC.Driver.Plugins">FrontendPlugin</a>, [<a href="GHC-Linker-Types.html#t:Linkable" title="GHC.Linker.Types">Linkable</a>], <a href="GHC-Linker-Types.html#t:PkgsLoaded" title="GHC.Linker.Types">PkgsLoaded</a>) <a href="src/GHC.Runtime.Loader.html#loadFrontendPlugin" class="link">Source</a> <a href="#v:loadFrontendPlugin" class="selflink">#</a></p></div><a href="#g:2" id="g:2"><h1>Force loading information</h1></a><div class="top"><p class="src"><a id="v:forceLoadModuleInterfaces" class="def">forceLoadModuleInterfaces</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Utils-Outputable.html#t:SDoc" title="GHC.Utils.Outputable">SDoc</a> -&gt; [<a href="GHC-Unit-Types.html#t:Module" title="GHC.Unit.Types">Module</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> () <a href="src/GHC.Runtime.Loader.html#forceLoadModuleInterfaces" class="link">Source</a> <a href="#v:forceLoadModuleInterfaces" class="selflink">#</a></p><div class="doc"><p>Force the interfaces for the given modules to be loaded. The <code><a href="GHC-Utils-Outputable.html#t:SDoc" title="GHC.Utils.Outputable">SDoc</a></code> parameter is used
 for debugging (<code>-ddump-if-trace</code>) only: it is shown as the reason why the module is being loaded.</p></div></div><div class="top"><p class="src"><a id="v:forceLoadNameModuleInterface" class="def">forceLoadNameModuleInterface</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Utils-Outputable.html#t:SDoc" title="GHC.Utils.Outputable">SDoc</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> () <a href="src/GHC.Runtime.Loader.html#forceLoadNameModuleInterface" class="link">Source</a> <a href="#v:forceLoadNameModuleInterface" class="selflink">#</a></p><div class="doc"><p>Force the interface for the module containing the name to be loaded. The <code><a href="GHC-Utils-Outputable.html#t:SDoc" title="GHC.Utils.Outputable">SDoc</a></code> parameter is used
 for debugging (<code>-ddump-if-trace</code>) only: it is shown as the reason why the module is being loaded.</p></div></div><div class="top"><p class="src"><a id="v:forceLoadTyCon" class="def">forceLoadTyCon</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> <a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a> <a href="src/GHC.Runtime.Loader.html#forceLoadTyCon" class="link">Source</a> <a href="#v:forceLoadTyCon" class="selflink">#</a></p><div class="doc"><p>Load the <code><a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a></code> associated with the given name, come hell or high water. Fails if:</p><ul><li>The interface could not be loaded</li><li>The name is not that of a <code><a href="GHC-Core-TyCon.html#t:TyCon" title="GHC.Core.TyCon">TyCon</a></code></li><li>The name did not exist in the loaded module</li></ul></div></div><a href="#g:3" id="g:3"><h1>Finding names</h1></a><div class="top"><p class="src"><a id="v:lookupRdrNameInModuleForPlugins" class="def">lookupRdrNameInModuleForPlugins</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a> -&gt; <a href="GHC-Types-Name-Reader.html#t:RdrName" title="GHC.Types.Name.Reader">RdrName</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> (<a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a>, <a href="GHC-Unit-Module-ModIface.html#t:ModIface" title="GHC.Unit.Module.ModIface">ModIface</a>)) <a href="src/GHC.Runtime.Loader.html#lookupRdrNameInModuleForPlugins" class="link">Source</a> <a href="#v:lookupRdrNameInModuleForPlugins" class="selflink">#</a></p><div class="doc"><p>Finds the <code><a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a></code> corresponding to the given <code><a href="GHC-Types-Name-Reader.html#t:RdrName" title="GHC.Types.Name.Reader">RdrName</a></code> in the
 context of the <code><a href="Language-Haskell-Syntax-Module-Name.html#t:ModuleName" title="Language.Haskell.Syntax.Module.Name">ModuleName</a></code>. Returns <code>Nothing</code> if no such <code><a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a></code>
 could be found. Any other condition results in an exception:</p><ul><li>If the module could not be found</li><li>If we could not determine the imports of the module</li></ul><p>Can only be used for looking up names while loading plugins (and is
 *not* suitable for use within plugins).  The interface file is
 loaded very partially: just enough that it can be used, without its
 rules and instances affecting (and being linked from!) the module
 being compiled.  This was introduced by 57d6798.</p><p>Need the module as well to record information in the interface file</p></div></div><a href="#g:4" id="g:4"><h1>Loading values</h1></a><div class="top"><p class="src"><a id="v:getValueSafely" class="def">getValueSafely</a> :: <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Prelude-Basic.html#t:Either" title="GHC.Prelude.Basic">Either</a> <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> (a, [<a href="GHC-Linker-Types.html#t:Linkable" title="GHC.Linker.Types">Linkable</a>], <a href="GHC-Linker-Types.html#t:PkgsLoaded" title="GHC.Linker.Types">PkgsLoaded</a>)) <a href="src/GHC.Runtime.Loader.html#getValueSafely" class="link">Source</a> <a href="#v:getValueSafely" class="selflink">#</a></p><div class="doc"><p>Loads the value corresponding to a <code><a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a></code> if that value has the given <code><a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a></code>. This only provides limited safety
 in that it is up to the user to ensure that that type corresponds to the type you try to use the return value at!</p><p>If the value found was not of the correct type, returns <code>Left <a href="actual_type">actual_type</a></code>. Any other condition results in an exception:</p><ul><li>If we could not load the names module</li><li>If the thing being loaded is not a value</li><li>If the Name does not exist in the module</li><li>If the link failed</li></ul></div></div><div class="top"><p class="src"><a id="v:getHValueSafely" class="def">getHValueSafely</a> :: <a href="GHC-Runtime-Interpreter-Types.html#t:Interp" title="GHC.Runtime.Interpreter.Types">Interp</a> -&gt; <a href="GHC-Driver-Env-Types.html#t:HscEnv" title="GHC.Driver.Env.Types">HscEnv</a> -&gt; <a href="GHC-Types-Name.html#t:Name" title="GHC.Types.Name">Name</a> -&gt; <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Prelude-Basic.html#t:Either" title="GHC.Prelude.Basic">Either</a> <a href="GHC-Core-Type.html#t:Type" title="GHC.Core.Type">Type</a> (<a href="GHC.html#t:HValue" title="GHC">HValue</a>, [<a href="GHC-Linker-Types.html#t:Linkable" title="GHC.Linker.Types">Linkable</a>], <a href="GHC-Linker-Types.html#t:PkgsLoaded" title="GHC.Linker.Types">PkgsLoaded</a>)) <a href="src/GHC.Runtime.Loader.html#getHValueSafely" class="link">Source</a> <a href="#v:getHValueSafely" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:lessUnsafeCoerce" class="def">lessUnsafeCoerce</a> :: <a href="GHC-Utils-Logger.html#t:Logger" title="GHC.Utils.Logger">Logger</a> -&gt; <a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a> -&gt; a -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> b <a href="src/GHC.Runtime.Loader.html#lessUnsafeCoerce" class="link">Source</a> <a href="#v:lessUnsafeCoerce" class="selflink">#</a></p><div class="doc"><p>Coerce a value as usual, but:</p><p>1) Evaluate it immediately to get a segfault early if the coercion was wrong</p><p>2) Wrap it in some debug messages at verbosity 3 or higher so we can see what happened
    if it <em>does</em> segfault</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>