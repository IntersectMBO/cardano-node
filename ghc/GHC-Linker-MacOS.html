<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.Linker.MacOS</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ghc-9.6.6: The GHC API</span><ul class="links" id="page-menu"><li><a href="src/GHC.Linker.MacOS.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.Linker.MacOS</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:runInjectRPaths">runInjectRPaths</a> :: <a href="GHC-Utils-Logger.html#t:Logger" title="GHC.Utils.Logger">Logger</a> -&gt; <a href="GHC-Settings.html#t:ToolSettings" title="GHC.Settings">ToolSettings</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:FilePath" title="GHC.Prelude.Basic">FilePath</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:FilePath" title="GHC.Prelude.Basic">FilePath</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> ()</li><li class="src short"><a href="#v:getUnitFrameworkOpts">getUnitFrameworkOpts</a> :: <a href="GHC-Unit-Env.html#t:UnitEnv" title="GHC.Unit.Env">UnitEnv</a> -&gt; [<a href="GHC-Unit-Types.html#t:UnitId" title="GHC.Unit.Types">UnitId</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> [<a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a>]</li><li class="src short"><a href="#v:getFrameworkOpts">getFrameworkOpts</a> :: <a href="GHC-Linker-Config.html#t:FrameworkOpts" title="GHC.Linker.Config">FrameworkOpts</a> -&gt; <a href="GHC-Platform.html#t:Platform" title="GHC.Platform">Platform</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a>]</li><li class="src short"><a href="#v:loadFramework">loadFramework</a> :: <a href="GHC-Runtime-Interpreter-Types.html#t:Interp" title="GHC.Runtime.Interpreter.Types">Interp</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:FilePath" title="GHC.Prelude.Basic">FilePath</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:FilePath" title="GHC.Prelude.Basic">FilePath</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> <a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a>)</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:runInjectRPaths" class="def">runInjectRPaths</a> :: <a href="GHC-Utils-Logger.html#t:Logger" title="GHC.Utils.Logger">Logger</a> -&gt; <a href="GHC-Settings.html#t:ToolSettings" title="GHC.Settings">ToolSettings</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:FilePath" title="GHC.Prelude.Basic">FilePath</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:FilePath" title="GHC.Prelude.Basic">FilePath</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> () <a href="src/GHC.Linker.MacOS.html#runInjectRPaths" class="link">Source</a> <a href="#v:runInjectRPaths" class="selflink">#</a></p><div class="doc"><p>On macOS we rely on the linkers <code>-dead_strip_dylibs</code> flag to remove unused
 libraries from the dynamic library.  We do this to reduce the number of load
 commands that end up in the dylib, and has been limited to 32K (32768) since
 macOS Sierra (10.14).</p><p><code>-dead_strip_dylibs</code> does not dead strip <code>-rpath</code> entries, as such passing
 <code>-l</code> and <code>-rpath</code> to the linker will result in the unnecessary libraries not
 being included in the load commands, however the <code>-rpath</code> entries are all
 forced to be included.  This can lead to 100s of <code>-rpath</code> entries being
 included when only a handful of libraries end up being truly linked.</p><p>Thus after building the library, we run a fixup phase where we inject the
 <code>-rpath</code> for each found library (in the given library search paths) into the
 dynamic library through <code>-add_rpath</code>.</p><p>See Note [Dynamic linking on macOS]</p></div></div><div class="top"><p class="src"><a id="v:getUnitFrameworkOpts" class="def">getUnitFrameworkOpts</a> :: <a href="GHC-Unit-Env.html#t:UnitEnv" title="GHC.Unit.Env">UnitEnv</a> -&gt; [<a href="GHC-Unit-Types.html#t:UnitId" title="GHC.Unit.Types">UnitId</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> [<a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a>] <a href="src/GHC.Linker.MacOS.html#getUnitFrameworkOpts" class="link">Source</a> <a href="#v:getUnitFrameworkOpts" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getFrameworkOpts" class="def">getFrameworkOpts</a> :: <a href="GHC-Linker-Config.html#t:FrameworkOpts" title="GHC.Linker.Config">FrameworkOpts</a> -&gt; <a href="GHC-Platform.html#t:Platform" title="GHC.Platform">Platform</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a>] <a href="src/GHC.Linker.MacOS.html#getFrameworkOpts" class="link">Source</a> <a href="#v:getFrameworkOpts" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:loadFramework" class="def">loadFramework</a> :: <a href="GHC-Runtime-Interpreter-Types.html#t:Interp" title="GHC.Runtime.Interpreter.Types">Interp</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:FilePath" title="GHC.Prelude.Basic">FilePath</a>] -&gt; <a href="GHC-Prelude-Basic.html#t:FilePath" title="GHC.Prelude.Basic">FilePath</a> -&gt; <a href="GHC-Prelude-Basic.html#t:IO" title="GHC.Prelude.Basic">IO</a> (<a href="GHC-Prelude-Basic.html#t:Maybe" title="GHC.Prelude.Basic">Maybe</a> <a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a>) <a href="src/GHC.Linker.MacOS.html#loadFramework" class="link">Source</a> <a href="#v:loadFramework" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>