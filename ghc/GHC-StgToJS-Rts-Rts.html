<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.StgToJS.Rts.Rts</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ghc-9.6.7: The GHC API</span><ul class="links" id="page-menu"><li><a href="src/GHC.StgToJS.Rts.Rts.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) The University of Glasgow 2001</td></tr><tr><th>License</th><td>BSD-style (see the file LICENSE)</td></tr><tr><th>Maintainer</th><td>Jeffrey Young  &lt;jeffrey.young@iohk.io&gt;
                Luite Stegeman &lt;luite.stegeman@iohk.io&gt;
                Sylvain Henry  &lt;sylvain.henry@iohk.io&gt;
                Josh Meredith  &lt;josh.meredith@iohk.io&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.StgToJS.Rts.Rts</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Top level driver of the JavaScript Backend RTS. This file is an
 implementation of the JS RTS for the JS backend written as an EDSL in
 Haskell. It assumes the existence of pre-generated JS functions, included as
 js-sources in base. These functions are similarly assumed for non-inline
 Primops, See <code><a href="GHC-StgToJS.html#v:Prim" title="GHC.StgToJS">Prim</a></code>. Most of the elements in this module are
 constants in Haskell Land which define pieces of the JS RTS.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:garbageCollector">garbageCollector</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:resetRegister">resetRegister</a> :: <a href="GHC-StgToJS-Regs.html#t:StgReg" title="GHC.StgToJS.Regs">StgReg</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:resetResultVar">resetResultVar</a> :: <a href="GHC-StgToJS-Regs.html#t:StgRet" title="GHC.StgToJS.Regs">StgRet</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:closureConstructors">closureConstructors</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:stackManip">stackManip</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:bitsIdx">bitsIdx</a> :: <a href="GHC-Prelude-Basic.html#t:Integer" title="GHC.Prelude.Basic">Integer</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a>]</li><li class="src short"><a href="#v:bhLneStats">bhLneStats</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a> -&gt; <a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:declRegs">declRegs</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:regGettersSetters">regGettersSetters</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:loadRegs">loadRegs</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:assignRegs">assignRegs</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:assignRegs-39-">assignRegs'</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> <a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a></li><li class="src short"><a href="#v:declRets">declRets</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:closureTypes">closureTypes</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:rtsDecls">rtsDecls</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:rtsText">rtsText</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a></li><li class="src short"><a href="#v:rtsDeclsText">rtsDeclsText</a> :: <a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a></li><li class="src short"><a href="#v:rts">rts</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li><li class="src short"><a href="#v:rts-39-">rts'</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:garbageCollector" class="def">garbageCollector</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#garbageCollector" class="link">Source</a> <a href="#v:garbageCollector" class="selflink">#</a></p><div class="doc"><p>The garbageCollector resets registers and result variables.</p></div></div><div class="top"><p class="src"><a id="v:resetRegister" class="def">resetRegister</a> :: <a href="GHC-StgToJS-Regs.html#t:StgReg" title="GHC.StgToJS.Regs">StgReg</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#resetRegister" class="link">Source</a> <a href="#v:resetRegister" class="selflink">#</a></p><div class="doc"><p>Reset the register <code>r</code> in JS Land. Note that this &quot;resets&quot; by setting the
 register to a dummy variable called &quot;null&quot;, <em>not</em> by setting to JS's nil
 value.</p></div></div><div class="top"><p class="src"><a id="v:resetResultVar" class="def">resetResultVar</a> :: <a href="GHC-StgToJS-Regs.html#t:StgRet" title="GHC.StgToJS.Regs">StgRet</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#resetResultVar" class="link">Source</a> <a href="#v:resetResultVar" class="selflink">#</a></p><div class="doc"><p>Reset the return variable <code>r</code> in JS Land. Note that this &quot;resets&quot; by
 setting the register to a dummy variable called &quot;null&quot;, <em>not</em> by setting to
 JS's nil value.</p></div></div><div class="top"><p class="src"><a id="v:closureConstructors" class="def">closureConstructors</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#closureConstructors" class="link">Source</a> <a href="#v:closureConstructors" class="selflink">#</a></p><div class="doc"><p>Define closures based on size, these functions are syntactic sugar, e.g., a
 Haskell function which generates some useful JS. Each Closure constructor
 follows the naming convention h$cN, where N is a natural number. For example,
 h$c (with the nat omitted) is a JS Land Constructor for a closure in JS land
 which has a single entry function <code>f</code>, and no fields; identical to h$c0. h$c1
 is a JS Land Constructor for a closure with an entry function <code>f</code>, and a
 <em>single</em> field <code>x1</code>, 'Just foo' is an example of this kind of closure. h$c2
 is a JS Land Constructor for a closure with an entry function and two data
 fields: <code>x1</code> and <code>x2</code>. And so on. Note that this has JIT performance
 implications; you should use h$c1, h$c2, h$c3, ... h$c24 instead of making
 objects manually so layouts and fields can be changed more easily and so the
 JIT can optimize better.</p></div></div><div class="top"><p class="src"><a id="v:stackManip" class="def">stackManip</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#stackManip" class="link">Source</a> <a href="#v:stackManip" class="selflink">#</a></p><div class="doc"><p>JS Payload to perform stack manipulation in the RTS</p></div></div><div class="top"><p class="src"><a id="v:bitsIdx" class="def">bitsIdx</a> :: <a href="GHC-Prelude-Basic.html#t:Integer" title="GHC.Prelude.Basic">Integer</a> -&gt; [<a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a>] <a href="src/GHC.StgToJS.Rts.Rts.html#bitsIdx" class="link">Source</a> <a href="#v:bitsIdx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bhLneStats" class="def">bhLneStats</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a> -&gt; <a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#bhLneStats" class="link">Source</a> <a href="#v:bhLneStats" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:declRegs" class="def">declRegs</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#declRegs" class="link">Source</a> <a href="#v:declRegs" class="selflink">#</a></p><div class="doc"><p>JS payload to declare the registers</p></div></div><div class="top"><p class="src"><a id="v:regGettersSetters" class="def">regGettersSetters</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#regGettersSetters" class="link">Source</a> <a href="#v:regGettersSetters" class="selflink">#</a></p><div class="doc"><p>JS payload to define getters and setters on the registers.</p></div></div><div class="top"><p class="src"><a id="v:loadRegs" class="def">loadRegs</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#loadRegs" class="link">Source</a> <a href="#v:loadRegs" class="selflink">#</a></p><div class="doc"><p>JS payload that defines the functions to load each register</p></div></div><div class="top"><p class="src"><a id="v:assignRegs" class="def">assignRegs</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; [<a href="GHC-JS-Syntax.html#t:JExpr" title="GHC.JS.Syntax">JExpr</a>] -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#assignRegs" class="link">Source</a> <a href="#v:assignRegs" class="selflink">#</a></p><div class="doc"><p>Assign registers R1 ... Rn in descending order, that is assign Rn first.
 This function uses the <code><a href="GHC-StgToJS-Rts-Rts.html#v:assignRegs-39-" title="GHC.StgToJS.Rts.Rts">assignRegs'</a></code> array to construct functions which set
 the registers.</p></div></div><div class="top"><p class="src"><a id="v:assignRegs-39-" class="def">assignRegs'</a> :: <a href="../array-0.5.8.0/Data-Array.html#t:Array" title="Data.Array">Array</a> <a href="GHC-Prelude-Basic.html#t:Int" title="GHC.Prelude.Basic">Int</a> <a href="GHC-JS-Syntax.html#t:Ident" title="GHC.JS.Syntax">Ident</a> <a href="src/GHC.StgToJS.Rts.Rts.html#assignRegs%27" class="link">Source</a> <a href="#v:assignRegs-39-" class="selflink">#</a></p><div class="doc"><p>JS payload which defines an array of function symbols that set N registers
 from M parameters. For example, h$l2 compiles to:
 <code>
    function h$l4(x1, x2, x3, x4) {
      h$r4 = x1;
      h$r3 = x2;
      h$r2 = x3;
      h$r1 = x4;
    };
 </code></p></div></div><div class="top"><p class="src"><a id="v:declRets" class="def">declRets</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#declRets" class="link">Source</a> <a href="#v:declRets" class="selflink">#</a></p><div class="doc"><p>JS payload to declare return variables.</p></div></div><div class="top"><p class="src"><a id="v:closureTypes" class="def">closureTypes</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#closureTypes" class="link">Source</a> <a href="#v:closureTypes" class="selflink">#</a></p><div class="doc"><p>JS payload defining the types closures.</p></div></div><div class="top"><p class="src"><a id="v:rtsDecls" class="def">rtsDecls</a> :: <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#rtsDecls" class="link">Source</a> <a href="#v:rtsDecls" class="selflink">#</a></p><div class="doc"><p>JS payload declaring the RTS functions.</p></div></div><div class="top"><p class="src"><a id="v:rtsText" class="def">rtsText</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a> <a href="src/GHC.StgToJS.Rts.Rts.html#rtsText" class="link">Source</a> <a href="#v:rtsText" class="selflink">#</a></p><div class="doc"><p>print the embedded RTS to a String</p></div></div><div class="top"><p class="src"><a id="v:rtsDeclsText" class="def">rtsDeclsText</a> :: <a href="GHC-Prelude-Basic.html#t:String" title="GHC.Prelude.Basic">String</a> <a href="src/GHC.StgToJS.Rts.Rts.html#rtsDeclsText" class="link">Source</a> <a href="#v:rtsDeclsText" class="selflink">#</a></p><div class="doc"><p>print the RTS declarations to a String.</p></div></div><div class="top"><p class="src"><a id="v:rts" class="def">rts</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#rts" class="link">Source</a> <a href="#v:rts" class="selflink">#</a></p><div class="doc"><p>Wrapper over the RTS to guarentee saturation, see <code><a href="GHC-JS.html#v:Transform" title="GHC.JS">Transform</a></code></p></div></div><div class="top"><p class="src"><a id="v:rts-39-" class="def">rts'</a> :: <a href="GHC-StgToJS-Types.html#t:StgToJSConfig" title="GHC.StgToJS.Types">StgToJSConfig</a> -&gt; <a href="GHC-JS-Syntax.html#t:JStat" title="GHC.JS.Syntax">JStat</a> <a href="src/GHC.StgToJS.Rts.Rts.html#rts%27" class="link">Source</a> <a href="#v:rts-39-" class="selflink">#</a></p><div class="doc"><p>JS Payload which defines the embedded RTS.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>