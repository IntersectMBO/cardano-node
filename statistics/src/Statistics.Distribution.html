<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns, ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module    : Statistics.Distribution</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright : (c) 2009 Bryan O'Sullivan</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  : bos@serpentine.com</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability : portable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Type classes for probability distributions</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Statistics.Distribution</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Type classes</span></span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier">Distribution</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#DiscreteDistr"><span class="hs-identifier">DiscreteDistr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier">ContDistr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Distribution statistics</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#MaybeMean"><span class="hs-identifier">MaybeMean</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#Mean"><span class="hs-identifier">Mean</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#MaybeVariance"><span class="hs-identifier">MaybeVariance</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#Variance"><span class="hs-identifier">Variance</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#MaybeEntropy"><span class="hs-identifier">MaybeEntropy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#Entropy"><span class="hs-identifier">Entropy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#FromSample"><span class="hs-identifier">FromSample</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Random number generation</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#ContGen"><span class="hs-identifier">ContGen</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#DiscreteGen"><span class="hs-identifier">DiscreteGen</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#genContinuous"><span class="hs-identifier">genContinuous</span></a></span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Helper functions</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#findRoot"><span class="hs-identifier">findRoot</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#sumProbabilities"><span class="hs-identifier">sumProbabilities</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#sum"><span class="hs-identifier">sum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Statistics.Function.html"><span class="hs-identifier">Statistics.Function</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.Function.html#square"><span class="hs-identifier">square</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Statistics.Sample.Internal.html"><span class="hs-identifier">Statistics.Sample.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.Sample.Internal.html#sum"><span class="hs-identifier">sum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.Stateful</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StatefulGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">uniformDouble01M</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Unboxed</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">U</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Generic</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | Type class common to all distributions. Only c.d.f. could be</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- defined for both discrete and continuous distributions.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">class</span><span> </span><span id="Distribution"><span class="annot"><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-var">Distribution</span></a></span></span><span> </span><span id="local-6989586621679202372"><span class="annot"><a href="#local-6989586621679202372"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-comment">-- | Cumulative distribution function.  The probability that a</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-comment">-- random variable /X/ is less or equal than /x/,</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-comment">-- i.e. P(/X/&#8804;/x/). Cumulative should be defined for</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-comment">-- infinities as well:</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-comment">-- &gt; cumulative d +&#8734; = 1</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-comment">-- &gt; cumulative d -&#8734; = 0</span><span>
</span><span id="line-55"></span><span>    </span><span id="cumulative"><span class="annot"><a href="Statistics.Distribution.html#cumulative"><span class="hs-identifier hs-type">cumulative</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202372"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span id="local-6989586621679202443"><span class="annot"><a href="Statistics.Distribution.html#cumulative"><span class="hs-identifier hs-var hs-var">cumulative</span></a></span><span> </span><span id="local-6989586621679202448"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202448"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679202449"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202449"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. Distribution d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#complCumulative"><span class="hs-identifier hs-var">complCumulative</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202448"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202449"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-comment">-- | One's complement of cumulative distribution:</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- &gt; complCumulative d x = 1 - cumulative d x</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- It's useful when one is interested in P(/X/&gt;/x/) and</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-comment">-- expression on the right side begin to lose precision. This</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-comment">-- function have default implementation but implementors are</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- encouraged to provide more precise implementation.</span><span>
</span><span id="line-65"></span><span>    </span><span id="complCumulative"><span class="annot"><a href="Statistics.Distribution.html#complCumulative"><span class="hs-identifier hs-type">complCumulative</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202372"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span id="local-6989586621679202451"><span class="annot"><a href="Statistics.Distribution.html#complCumulative"><span class="hs-identifier hs-var hs-var">complCumulative</span></a></span><span> </span><span id="local-6989586621679202455"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202455"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679202456"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202456"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. Distribution d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#cumulative"><span class="hs-identifier hs-var">cumulative</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202455"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202456"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Statistics.Distribution.html#cumulative"><span class="hs-pragma hs-type">cumulative</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#complCumulative"><span class="hs-pragma hs-type">complCumulative</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="annot"><span class="hs-comment">-- | Discrete probability distribution.</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679202375"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="DiscreteDistr"><span class="annot"><a href="Statistics.Distribution.html#DiscreteDistr"><span class="hs-identifier hs-var">DiscreteDistr</span></a></span></span><span> </span><span id="local-6989586621679202375"><span class="annot"><a href="#local-6989586621679202375"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- | Probability of n-th outcome.</span><span>
</span><span id="line-73"></span><span>    </span><span id="probability"><span class="annot"><a href="Statistics.Distribution.html#probability"><span class="hs-identifier hs-type">probability</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202375"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621679202460"><span class="annot"><a href="Statistics.Distribution.html#probability"><span class="hs-identifier hs-var hs-var">probability</span></a></span><span> </span><span id="local-6989586621679202464"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202464"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Float.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Int -&gt; Double) -&gt; Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Int -&gt; Double
forall d. DiscreteDistr d =&gt; d -&gt; Int -&gt; Double
</span><a href="Statistics.Distribution.html#logProbability"><span class="hs-identifier hs-var">logProbability</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202464"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- | Logarithm of probability of n-th outcome</span><span>
</span><span id="line-76"></span><span>    </span><span id="logProbability"><span class="annot"><a href="Statistics.Distribution.html#logProbability"><span class="hs-identifier hs-type">logProbability</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202375"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679202468"><span class="annot"><a href="Statistics.Distribution.html#logProbability"><span class="hs-identifier hs-var hs-var">logProbability</span></a></span><span> </span><span id="local-6989586621679202471"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202471"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Float.html#log"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Int -&gt; Double) -&gt; Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Int -&gt; Double
forall d. DiscreteDistr d =&gt; d -&gt; Int -&gt; Double
</span><a href="Statistics.Distribution.html#probability"><span class="hs-identifier hs-var">probability</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202471"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Statistics.Distribution.html#probability"><span class="hs-pragma hs-type">probability</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#logProbability"><span class="hs-pragma hs-type">logProbability</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | Continuous probability distribution.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">--   Minimal complete definition is 'quantile' and either 'density' or</span><span>
</span><span id="line-83"></span><span class="hs-comment">--   'logDensity'.</span><span>
</span><span id="line-84"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202381"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ContDistr"><span class="annot"><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier hs-var">ContDistr</span></a></span></span><span> </span><span id="local-6989586621679202381"><span class="annot"><a href="#local-6989586621679202381"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">-- | Probability density function. Probability that random</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">-- variable /X/ lies in the infinitesimal interval</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- [/x/,/x+/&#948;/x/) equal to /density(x)/&#8901;&#948;/x/</span><span>
</span><span id="line-88"></span><span>    </span><span id="density"><span class="annot"><a href="Statistics.Distribution.html#density"><span class="hs-identifier hs-type">density</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202381"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679202478"><span class="annot"><a href="Statistics.Distribution.html#density"><span class="hs-identifier hs-var hs-var">density</span></a></span><span> </span><span id="local-6989586621679202481"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202481"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Float.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Double -&gt; Double) -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. ContDistr d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#logDensity"><span class="hs-identifier hs-var">logDensity</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202481"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- | Natural logarithm of density.</span><span>
</span><span id="line-91"></span><span>    </span><span id="logDensity"><span class="annot"><a href="Statistics.Distribution.html#logDensity"><span class="hs-identifier hs-type">logDensity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202381"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621679202482"><span class="annot"><a href="Statistics.Distribution.html#logDensity"><span class="hs-identifier hs-var hs-var">logDensity</span></a></span><span> </span><span id="local-6989586621679202485"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202485"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Float.html#log"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Double -&gt; Double) -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. ContDistr d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#density"><span class="hs-identifier hs-var">density</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202485"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- | Inverse of the cumulative distribution function. The value</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-comment">-- /x/ for which P(/X/&#8804;/x/) = /p/. If probability is outside</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- of [0,1] range function should call 'error'</span><span>
</span><span id="line-96"></span><span>    </span><span id="quantile"><span class="annot"><a href="Statistics.Distribution.html#quantile"><span class="hs-identifier hs-type">quantile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202381"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679202486"><span class="annot"><a href="Statistics.Distribution.html#quantile"><span class="hs-identifier hs-var hs-var">quantile</span></a></span><span> </span><span id="local-6989586621679202490"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202490"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679202491"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202491"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. ContDistr d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#complQuantile"><span class="hs-identifier hs-var">complQuantile</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202490"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202491"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- | 1-complement of @quantile@:</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- &gt; complQuantile x &#8801; quantile (1 - x)</span><span>
</span><span id="line-101"></span><span>    </span><span id="complQuantile"><span class="annot"><a href="Statistics.Distribution.html#complQuantile"><span class="hs-identifier hs-type">complQuantile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202381"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679202493"><span class="annot"><a href="Statistics.Distribution.html#complQuantile"><span class="hs-identifier hs-var hs-var">complQuantile</span></a></span><span> </span><span id="local-6989586621679202497"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202497"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679202498"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202498"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. ContDistr d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#quantile"><span class="hs-identifier hs-var">quantile</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202497"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202498"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Statistics.Distribution.html#density"><span class="hs-pragma hs-type">density</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#logDensity"><span class="hs-pragma hs-type">logDensity</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Statistics.Distribution.html#quantile"><span class="hs-pragma hs-type">quantile</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#complQuantile"><span class="hs-pragma hs-type">complQuantile</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Type class for distributions with mean. 'maybeMean' should return</span><span>
</span><span id="line-106"></span><span class="hs-comment">--   'Nothing' if it's undefined for current value of data</span><span>
</span><span id="line-107"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202383"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MaybeMean"><span class="annot"><a href="Statistics.Distribution.html#MaybeMean"><span class="hs-identifier hs-var">MaybeMean</span></a></span></span><span> </span><span id="local-6989586621679202383"><span class="annot"><a href="#local-6989586621679202383"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span id="maybeMean"><span class="annot"><a href="Statistics.Distribution.html#maybeMean"><span class="hs-identifier hs-type">maybeMean</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202383"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | Type class for distributions with mean. If a distribution has</span><span>
</span><span id="line-111"></span><span class="hs-comment">--   finite mean for all valid values of parameters it should be</span><span>
</span><span id="line-112"></span><span class="hs-comment">--   instance of this type class.</span><span>
</span><span id="line-113"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#MaybeMean"><span class="hs-identifier hs-type">MaybeMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202385"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Mean"><span class="annot"><a href="Statistics.Distribution.html#Mean"><span class="hs-identifier hs-var">Mean</span></a></span></span><span> </span><span id="local-6989586621679202385"><span class="annot"><a href="#local-6989586621679202385"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span id="mean"><span class="annot"><a href="Statistics.Distribution.html#mean"><span class="hs-identifier hs-type">mean</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202385"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | Type class for distributions with variance. If variance is</span><span>
</span><span id="line-119"></span><span class="hs-comment">--   undefined for some parameter values both 'maybeVariance' and</span><span>
</span><span id="line-120"></span><span class="hs-comment">--   'maybeStdDev' should return Nothing.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">--   Minimal complete definition is 'maybeVariance' or 'maybeStdDev'</span><span>
</span><span id="line-123"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#MaybeMean"><span class="hs-identifier hs-type">MaybeMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202387"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MaybeVariance"><span class="annot"><a href="Statistics.Distribution.html#MaybeVariance"><span class="hs-identifier hs-var">MaybeVariance</span></a></span></span><span> </span><span id="local-6989586621679202387"><span class="annot"><a href="#local-6989586621679202387"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span id="maybeVariance"><span class="annot"><a href="Statistics.Distribution.html#maybeVariance"><span class="hs-identifier hs-type">maybeVariance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202387"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679202507"><span class="annot"><a href="Statistics.Distribution.html#maybeVariance"><span class="hs-identifier hs-var hs-var">maybeVariance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Maybe Double -&gt; Maybe Double
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Statistics.Function.html#square"><span class="hs-identifier hs-var">square</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Maybe Double)
-&gt; (d -&gt; Maybe Double) -&gt; d -&gt; Maybe Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Maybe Double
forall d. MaybeVariance d =&gt; d -&gt; Maybe Double
</span><a href="Statistics.Distribution.html#maybeStdDev"><span class="hs-identifier hs-var">maybeStdDev</span></a></span></span><span>
</span><span id="line-126"></span><span>    </span><span id="maybeStdDev"><span class="annot"><a href="Statistics.Distribution.html#maybeStdDev"><span class="hs-identifier hs-type">maybeStdDev</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202387"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679202511"><span class="annot"><a href="Statistics.Distribution.html#maybeStdDev"><span class="hs-identifier hs-var hs-var">maybeStdDev</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Maybe Double -&gt; Maybe Double
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Float.html#sqrt"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Maybe Double)
-&gt; (d -&gt; Maybe Double) -&gt; d -&gt; Maybe Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Maybe Double
forall d. MaybeVariance d =&gt; d -&gt; Maybe Double
</span><a href="Statistics.Distribution.html#maybeVariance"><span class="hs-identifier hs-var">maybeVariance</span></a></span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Statistics.Distribution.html#maybeVariance"><span class="hs-pragma hs-type">maybeVariance</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#maybeStdDev"><span class="hs-pragma hs-type">maybeStdDev</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | Type class for distributions with variance. If distribution have</span><span>
</span><span id="line-131"></span><span class="hs-comment">--   finite variance for all valid parameter values it should be</span><span>
</span><span id="line-132"></span><span class="hs-comment">--   instance of this type class.</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span class="hs-comment">--   Minimal complete definition is 'variance' or 'stdDev'</span><span>
</span><span id="line-135"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.Distribution.html#Mean"><span class="hs-identifier hs-type">Mean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202392"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#MaybeVariance"><span class="hs-identifier hs-type">MaybeVariance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202392"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Variance"><span class="annot"><a href="Statistics.Distribution.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span></span><span> </span><span id="local-6989586621679202392"><span class="annot"><a href="#local-6989586621679202392"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>    </span><span id="variance"><span class="annot"><a href="Statistics.Distribution.html#variance"><span class="hs-identifier hs-type">variance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202392"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679202521"><span class="annot"><a href="Statistics.Distribution.html#variance"><span class="hs-identifier hs-var hs-var">variance</span></a></span><span> </span><span id="local-6989586621679202523"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202523"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Statistics.Function.html#square"><span class="hs-identifier hs-var">square</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d -&gt; Double
forall d. Variance d =&gt; d -&gt; Double
</span><a href="Statistics.Distribution.html#stdDev"><span class="hs-identifier hs-var">stdDev</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202523"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span>    </span><span id="stdDev"><span class="annot"><a href="Statistics.Distribution.html#stdDev"><span class="hs-identifier hs-type">stdDev</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202392"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679202524"><span class="annot"><a href="Statistics.Distribution.html#stdDev"><span class="hs-identifier hs-var hs-var">stdDev</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Float.html#sqrt"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (d -&gt; Double) -&gt; d -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Double
forall d. Variance d =&gt; d -&gt; Double
</span><a href="Statistics.Distribution.html#variance"><span class="hs-identifier hs-var">variance</span></a></span></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Statistics.Distribution.html#variance"><span class="hs-pragma hs-type">variance</span></a></span><span> </span><span class="hs-pragma">|</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#stdDev"><span class="hs-pragma hs-type">stdDev</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | Type class for distributions with entropy, meaning Shannon entropy</span><span>
</span><span id="line-144"></span><span class="hs-comment">--   in the case of a discrete distribution, or differential entropy in the</span><span>
</span><span id="line-145"></span><span class="hs-comment">--   case of a continuous one.  'maybeEntropy' should return 'Nothing' if</span><span>
</span><span id="line-146"></span><span class="hs-comment">--   entropy is undefined for the chosen parameter values.</span><span>
</span><span id="line-147"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202394"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MaybeEntropy"><span class="annot"><a href="Statistics.Distribution.html#MaybeEntropy"><span class="hs-identifier hs-var">MaybeEntropy</span></a></span></span><span> </span><span id="local-6989586621679202394"><span class="annot"><a href="#local-6989586621679202394"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-comment">-- | Returns the entropy of a distribution, in nats, if such is defined.</span><span>
</span><span id="line-149"></span><span>  </span><span id="maybeEntropy"><span class="annot"><a href="Statistics.Distribution.html#maybeEntropy"><span class="hs-identifier hs-type">maybeEntropy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202394"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Type class for distributions with entropy, meaning Shannon</span><span>
</span><span id="line-152"></span><span class="hs-comment">--   entropy in the case of a discrete distribution, or differential</span><span>
</span><span id="line-153"></span><span class="hs-comment">--   entropy in the case of a continuous one.  If the distribution has</span><span>
</span><span id="line-154"></span><span class="hs-comment">--   well-defined entropy for all valid parameter values then it</span><span>
</span><span id="line-155"></span><span class="hs-comment">--   should be an instance of this type class.</span><span>
</span><span id="line-156"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.Distribution.html#MaybeEntropy"><span class="hs-identifier hs-type">MaybeEntropy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202396"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Entropy"><span class="annot"><a href="Statistics.Distribution.html#Entropy"><span class="hs-identifier hs-var">Entropy</span></a></span></span><span> </span><span id="local-6989586621679202396"><span class="annot"><a href="#local-6989586621679202396"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-comment">-- | Returns the entropy of a distribution, in nats.</span><span>
</span><span id="line-158"></span><span>  </span><span id="entropy"><span class="annot"><a href="Statistics.Distribution.html#entropy"><span class="hs-identifier hs-type">entropy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679202396"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Generate discrete random variates which have given</span><span>
</span><span id="line-161"></span><span class="hs-comment">--   distribution.</span><span>
</span><span id="line-162"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202398"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ContGen"><span class="annot"><a href="Statistics.Distribution.html#ContGen"><span class="hs-identifier hs-var">ContGen</span></a></span></span><span> </span><span id="local-6989586621679202398"><span class="annot"><a href="#local-6989586621679202398"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>  </span><span id="genContVar"><span class="annot"><a href="Statistics.Distribution.html#genContVar"><span class="hs-identifier hs-type">genContVar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679202533"><span id="local-6989586621679202534"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679202533"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202534"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202398"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202533"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202534"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span></span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Generate discrete random variates which have given</span><span>
</span><span id="line-166"></span><span class="hs-comment">--   distribution. 'ContGen' is superclass because it's always possible</span><span>
</span><span id="line-167"></span><span class="hs-comment">--   to generate real-valued variates from integer values</span><span>
</span><span id="line-168"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.Distribution.html#DiscreteDistr"><span class="hs-identifier hs-type">DiscreteDistr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202400"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#ContGen"><span class="hs-identifier hs-type">ContGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202400"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="DiscreteGen"><span class="annot"><a href="Statistics.Distribution.html#DiscreteGen"><span class="hs-identifier hs-var">DiscreteGen</span></a></span></span><span> </span><span id="local-6989586621679202400"><span class="annot"><a href="#local-6989586621679202400"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>  </span><span id="genDiscreteVar"><span class="annot"><a href="Statistics.Distribution.html#genDiscreteVar"><span class="hs-identifier hs-type">genDiscreteVar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679202538"><span id="local-6989586621679202539"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679202538"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202539"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202400"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202538"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202539"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Estimate distribution from sample. First parameter in sample is</span><span>
</span><span id="line-172"></span><span class="hs-comment">--   distribution type and second is element type.</span><span>
</span><span id="line-173"></span><span class="hs-keyword">class</span><span> </span><span id="FromSample"><span class="annot"><a href="Statistics.Distribution.html#FromSample"><span class="hs-identifier hs-var">FromSample</span></a></span></span><span> </span><span id="local-6989586621679202540"><span class="annot"><a href="#local-6989586621679202540"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621679202541"><span class="annot"><a href="#local-6989586621679202541"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- | Estimate distribution from sample. Returns 'Nothing' if there is</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">--   not enough data, or if no usable fit results from the method</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-comment">--   used, e.g., the estimated distribution parameters would be</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">--   invalid or inaccurate.</span><span>
</span><span id="line-178"></span><span>  </span><span id="fromSample"><span class="annot"><a href="Statistics.Distribution.html#fromSample"><span class="hs-identifier hs-type">fromSample</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679202543"><span class="annot"><span class="hs-identifier hs-type">G.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679202543"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202541"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202543"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202541"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202540"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Generate variates from continuous distribution using inverse</span><span>
</span><span id="line-182"></span><span class="hs-comment">--   transform rule.</span><span>
</span><span id="line-183"></span><span id="local-6989586621679202402"><span id="local-6989586621679202403"><span id="local-6989586621679202404"><span class="annot"><a href="Statistics.Distribution.html#genContinuous"><span class="hs-identifier hs-type">genContinuous</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier hs-type">ContDistr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202402"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679202403"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202404"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202402"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202403"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202404"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span></span></span></span><span>
</span><span id="line-184"></span><span id="genContinuous"><span class="annot"><span class="annottext">genContinuous :: forall d g (m :: * -&gt; *).
(ContDistr d, StatefulGen g m) =&gt;
d -&gt; g -&gt; m Double
</span><a href="Statistics.Distribution.html#genContinuous"><span class="hs-identifier hs-var hs-var">genContinuous</span></a></span></span><span> </span><span id="local-6989586621679202552"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202552"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679202553"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679202553"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679202554"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202554"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">g -&gt; m Double
forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDouble01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679202553"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; m Double
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; m Double) -&gt; Double -&gt; m Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. ContDistr d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#quantile"><span class="hs-identifier hs-var">quantile</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202552"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202554"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">data</span><span> </span><span id="P"><span class="annot"><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="P"><span class="annot"><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a></span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Approximate the value of /X/ for which P(/x/&gt;/X/)=/p/.</span><span>
</span><span id="line-191"></span><span class="hs-comment">--</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- This method uses a combination of Newton-Raphson iteration and</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- bisection with the given guess as a starting point.  The upper and</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- lower bounds specify the interval in which the probability</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- distribution reaches the value /p/.</span><span>
</span><span id="line-196"></span><span id="local-6989586621679202418"><span class="annot"><a href="Statistics.Distribution.html#findRoot"><span class="hs-identifier hs-type">findRoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier hs-type">ContDistr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202418"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-197"></span><span>            </span><span class="annot"><a href="#local-6989586621679202418"><span class="hs-identifier hs-type">d</span></a></span><span>                   </span><span class="annot"><span class="hs-comment">-- ^ Distribution</span></span><span>
</span><span id="line-198"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Probability /p/</span></span><span>
</span><span id="line-199"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Initial guess</span></span><span>
</span><span id="line-200"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Lower bound on interval</span></span><span>
</span><span id="line-201"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Upper bound on interval</span></span><span>
</span><span id="line-202"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span></span><span>
</span><span id="line-203"></span><span id="findRoot"><span class="annot"><span class="annottext">findRoot :: forall d.
ContDistr d =&gt;
d -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#findRoot"><span class="hs-identifier hs-var hs-var">findRoot</span></a></span></span><span> </span><span id="local-6989586621679202559"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202559"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679202560"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202560"><span class="hs-identifier hs-var">prob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679202561"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679202561"><span class="annot"><span class="annottext">loop :: Int -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679202561"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679202570"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202570"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">::</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679202571"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202571"><span class="hs-identifier hs-var">dx</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679202572"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679202573"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202573"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679202574"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202574"><span class="hs-identifier hs-var">hi</span></a></span></span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#abs"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202571"><span class="hs-identifier hs-var">dx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202577"><span class="hs-identifier hs-var">accuracy</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202570"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202579"><span class="hs-identifier hs-var">maxIters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679202561"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202570"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202581"><span class="hs-identifier hs-var">dx''</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202582"><span class="hs-identifier hs-var">x''</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202583"><span class="hs-identifier hs-var">lo'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202584"><span class="hs-identifier hs-var">hi'</span></a></span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>        </span><span id="local-6989586621679202587"><span class="annot"><span class="annottext">err :: Double
</span><a href="#local-6989586621679202587"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. Distribution d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#cumulative"><span class="hs-identifier hs-var">cumulative</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202559"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202560"><span class="hs-identifier hs-var">prob</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679202583"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202583"><span class="hs-identifier hs-var">lo'</span></a></span></span><span> </span><span id="local-6989586621679202584"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202584"><span class="hs-identifier hs-var">hi'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202587"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; P
</span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202574"><span class="hs-identifier hs-var">hi</span></a></span><span>
</span><span id="line-211"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; P
</span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202573"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621679202593"><span class="annot"><span class="annottext">pdf :: Double
</span><a href="#local-6989586621679202593"><span class="hs-identifier hs-var hs-var">pdf</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">d -&gt; Double -&gt; Double
forall d. ContDistr d =&gt; d -&gt; Double -&gt; Double
</span><a href="Statistics.Distribution.html#density"><span class="hs-identifier hs-var">density</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202559"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679202600"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202600"><span class="hs-identifier hs-var">dx'</span></a></span></span><span> </span><span id="local-6989586621679202601"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202601"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202593"><span class="hs-identifier hs-var">pdf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; P
</span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202587"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202593"><span class="hs-identifier hs-var">pdf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202571"><span class="hs-identifier hs-var">dx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; P
</span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202571"><span class="hs-identifier hs-var">dx</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679202581"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202581"><span class="hs-identifier hs-var">dx''</span></a></span></span><span> </span><span id="local-6989586621679202582"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202582"><span class="hs-identifier hs-var">x''</span></a></span></span><span>
</span><span id="line-216"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202601"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202583"><span class="hs-identifier hs-var">lo'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202601"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202584"><span class="hs-identifier hs-var">hi'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202593"><span class="hs-identifier hs-var">pdf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202613"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679202613"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202583"><span class="hs-identifier hs-var">lo'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202584"><span class="hs-identifier hs-var">hi'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-217"></span><span>                                                 </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; P
</span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202613"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202572"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202613"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-218"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; P
</span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202600"><span class="hs-identifier hs-var">dx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679202601"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679202577"><span class="annot"><span class="annottext">accuracy :: Double
</span><a href="#local-6989586621679202577"><span class="hs-identifier hs-var hs-var">accuracy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-15</span></span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679202579"><span class="annot"><span class="annottext">maxIters :: Int
</span><a href="#local-6989586621679202579"><span class="hs-identifier hs-var hs-var">maxIters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">150</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><span class="hs-comment">-- | Sum probabilities in inclusive interval.</span></span><span>
</span><span id="line-223"></span><span id="local-6989586621679202424"><span class="annot"><a href="Statistics.Distribution.html#sumProbabilities"><span class="hs-identifier hs-type">sumProbabilities</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Statistics.Distribution.html#DiscreteDistr"><span class="hs-identifier hs-type">DiscreteDistr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202424"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202424"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span></span><span>
</span><span id="line-224"></span><span id="sumProbabilities"><span class="annot"><span class="annottext">sumProbabilities :: forall d. DiscreteDistr d =&gt; d -&gt; Int -&gt; Int -&gt; Double
</span><a href="Statistics.Distribution.html#sumProbabilities"><span class="hs-identifier hs-var hs-var">sumProbabilities</span></a></span></span><span> </span><span id="local-6989586621679202630"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202630"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679202631"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202631"><span class="hs-identifier hs-var">low</span></a></span></span><span> </span><span id="local-6989586621679202632"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202632"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-comment">-- Return value is forced to be less than 1 to guard against roundoff errors.</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- ATTENTION! this check should be removed for testing or it could mask bugs.</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; (Vector Int -&gt; Double) -&gt; Vector Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Double
forall (v :: * -&gt; *). Vector v Double =&gt; v Double -&gt; Double
</span><a href="Statistics.Sample.Internal.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Double -&gt; Double)
-&gt; (Vector Int -&gt; Vector Double) -&gt; Vector Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Vector Int -&gt; Vector Double
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">U.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d -&gt; Int -&gt; Double
forall d. DiscreteDistr d =&gt; d -&gt; Int -&gt; Double
</span><a href="Statistics.Distribution.html#probability"><span class="hs-identifier hs-var">probability</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679202630"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; Double) -&gt; Vector Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Vector Int
forall a. (Unbox a, Enum a) =&gt; a -&gt; a -&gt; Vector a
</span><span class="hs-identifier hs-var">U.enumFromTo</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202631"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679202632"><span class="hs-identifier hs-var">hi</span></a></span><span>
</span><span id="line-228"></span></pre></body></html>