<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-partial-fields -Wno-name-shadowing #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Benchmarking.Topology</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Topology"><span class="hs-identifier">Types.Topology</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Node"><span class="hs-identifier">Types.Node</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier">Types.Location</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#AWSRegion"><span class="hs-identifier">Types.AWSRegion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#CoreNodesParams"><span class="hs-identifier">CoreNodesParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkTopology"><span class="hs-identifier">mkTopology</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes"><span class="hs-identifier">mkCoreNodes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkExplorer"><span class="hs-identifier">mkExplorer</span></a></span><span>
</span><span id="line-13"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html"><span class="hs-identifier">Data.Function</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html#%26"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#tails"><span class="hs-identifier">tails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#sortOn"><span class="hs-identifier">sortOn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#uncons"><span class="hs-identifier">uncons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#isJust"><span class="hs-identifier">isJust</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html"><span class="hs-identifier">Cardano.Benchmarking.Topology.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Types</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="annot"><span class="hs-comment">-- | Four types of topologies for the core nodes.</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">data</span><span> </span><span id="CoreNodesParams"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#CoreNodesParams"><span class="hs-identifier hs-var">CoreNodesParams</span></a></span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-comment">-- FIXME: Currently not used ???</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Line"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Line"><span class="hs-identifier hs-var">Line</span></a></span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="tpSize"><span class="annot"><span class="annottext">CoreNodesParams -&gt; Int
</span><a href="Cardano.Benchmarking.Topology.html#tpSize"><span class="hs-identifier hs-var hs-var">tpSize</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Number of nodes to use.</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tpLocation"><span class="annot"><span class="annottext">CoreNodesParams -&gt; Location
</span><a href="Cardano.Benchmarking.Topology.html#tpLocation"><span class="hs-identifier hs-var hs-var">tpLocation</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Unique location to use.</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tpIdPools"><span class="annot"><span class="annottext">CoreNodesParams -&gt; Int -&gt; Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#tpIdPools"><span class="hs-identifier hs-var hs-var">tpIdPools</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Node i pool number.</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UniCircle"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#UniCircle"><span class="hs-identifier hs-var">UniCircle</span></a></span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="tpSize"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#tpSize"><span class="hs-identifier hs-var">tpSize</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Number of nodes to use.</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tpLocation"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#tpLocation"><span class="hs-identifier hs-var">tpLocation</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Unique location to use.</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tpIdPools"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#tpIdPools"><span class="hs-identifier hs-var">tpIdPools</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Node i pool number.</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Torus"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Torus"><span class="hs-identifier hs-var">Torus</span></a></span></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="tpSize"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#tpSize"><span class="hs-identifier hs-var">tpSize</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Number of nodes to use.</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tpLocations"><span class="annot"><span class="annottext">CoreNodesParams -&gt; [Location]
</span><a href="Cardano.Benchmarking.Topology.html#tpLocations"><span class="hs-identifier hs-var hs-var">tpLocations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Locations to use.</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tpIdPools"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#tpIdPools"><span class="hs-identifier hs-var">tpIdPools</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Node i pool number.</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TorusDense"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#TorusDense"><span class="hs-identifier hs-var">TorusDense</span></a></span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="tpSize"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#tpSize"><span class="hs-identifier hs-var">tpSize</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Number of nodes to use.</span></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tpLocations"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#tpLocations"><span class="hs-identifier hs-var">tpLocations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Locations to use.</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tpIdPools"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#tpIdPools"><span class="hs-identifier hs-var">tpIdPools</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Node i pool number.</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="annot"><span class="hs-comment">-- | Create a Topology, optional explorer node that connects to all core nodes.</span></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkTopology"><span class="hs-identifier hs-type">mkTopology</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#CoreNodesParams"><span class="hs-identifier hs-type">CoreNodesParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Topology"><span class="hs-identifier hs-type">Types.Topology</span></a></span><span>
</span><span id="line-53"></span><span id="mkTopology"><span class="annot"><span class="annottext">mkTopology :: CoreNodesParams -&gt; Maybe Location -&gt; Topology
</span><a href="Cardano.Benchmarking.Topology.html#mkTopology"><span class="hs-identifier hs-var hs-var">mkTopology</span></a></span></span><span> </span><span id="local-6989586621679104259"><span class="annot"><span class="annottext">CoreNodesParams
</span><a href="#local-6989586621679104259"><span class="hs-identifier hs-var">coreNodesParams</span></a></span></span><span> </span><span id="local-6989586621679104260"><span class="annot"><span class="annottext">Maybe Location
</span><a href="#local-6989586621679104260"><span class="hs-identifier hs-var">maybeExplorerLocation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679104261"><span class="annot"><span class="annottext">coreNodes :: [Node]
</span><a href="#local-6989586621679104261"><span class="hs-identifier hs-var hs-var">coreNodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreNodesParams -&gt; [Node]
</span><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes"><span class="hs-identifier hs-var">mkCoreNodes</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodesParams
</span><a href="#local-6989586621679104259"><span class="hs-identifier hs-var">coreNodesParams</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Topology"><span class="hs-identifier hs-type">Types.Topology</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><span class="annottext">coreNodes :: [Node]
</span><a href="Cardano.Benchmarking.Topology.Types.html#coreNodes"><span class="hs-identifier hs-var">Types.coreNodes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679104261"><span class="hs-identifier hs-var">coreNodes</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">relayNodes :: [Node]
</span><a href="Cardano.Benchmarking.Topology.Types.html#relayNodes"><span class="hs-identifier hs-var">Types.relayNodes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Location
</span><a href="#local-6989586621679104260"><span class="hs-identifier hs-var">maybeExplorerLocation</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-58"></span><span>        </span><span class="annot"><span class="annottext">Maybe Location
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679104265"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104265"><span class="hs-identifier hs-var">explorerLocation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Location -&gt; [Node] -&gt; Node
</span><a href="Cardano.Benchmarking.Topology.html#mkExplorer"><span class="hs-identifier hs-var">mkExplorer</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104265"><span class="hs-identifier hs-var">explorerLocation</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679104261"><span class="hs-identifier hs-var">coreNodes</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes"><span class="hs-identifier hs-type">mkCoreNodes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#CoreNodesParams"><span class="hs-identifier hs-type">CoreNodesParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Node"><span class="hs-identifier hs-type">Types.Node</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span id="mkCoreNodes"><span class="annot"><span class="annottext">mkCoreNodes :: CoreNodesParams -&gt; [Node]
</span><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes"><span class="hs-identifier hs-var hs-var">mkCoreNodes</span></a></span></span><span> </span><span id="local-6989586621679104266"><span class="annot"><span class="annottext">CoreNodesParams
</span><a href="#local-6989586621679104266"><span class="hs-identifier hs-var">coreNodesParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Node) -&gt; [Spec] -&gt; [Node]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Spec -&gt; Node
</span><a href="Cardano.Benchmarking.Topology.html#mkNode"><span class="hs-identifier hs-var">mkNode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreNodesParams -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes%27"><span class="hs-identifier hs-var">mkCoreNodes'</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodesParams
</span><a href="#local-6989586621679104266"><span class="hs-identifier hs-var">coreNodesParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkExplorer"><span class="hs-identifier hs-type">mkExplorer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Node"><span class="hs-identifier hs-type">Types.Node</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Node"><span class="hs-identifier hs-type">Types.Node</span></a></span><span>
</span><span id="line-66"></span><span id="mkExplorer"><span class="annot"><span class="annottext">mkExplorer :: Location -&gt; [Node] -&gt; Node
</span><a href="Cardano.Benchmarking.Topology.html#mkExplorer"><span class="hs-identifier hs-var hs-var">mkExplorer</span></a></span></span><span> </span><span id="local-6989586621679104269"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104269"><span class="hs-identifier hs-var">explorerLocation</span></a></span></span><span> </span><span id="local-6989586621679104270"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679104270"><span class="hs-identifier hs-var">coreNodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Node"><span class="hs-identifier hs-type">Types.Node</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-68"></span><span>      </span><span class="annot"><span class="annottext">name :: String
</span><a href="Cardano.Benchmarking.Topology.Types.html#name"><span class="hs-identifier hs-var">name</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;explorer&quot;</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nodeId :: Int
</span><a href="Cardano.Benchmarking.Topology.Types.html#nodeId"><span class="hs-identifier hs-var">nodeId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Node] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679104270"><span class="hs-identifier hs-var">coreNodes</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">region :: Location
</span><a href="Cardano.Benchmarking.Topology.Types.html#region"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104269"><span class="hs-identifier hs-var">explorerLocation</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- Explorer producers sorted by numeric id, not region or something else.</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">producers :: [String]
</span><a href="Cardano.Benchmarking.Topology.Types.html#producers"><span class="hs-identifier hs-var">producers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Node -&gt; String) -&gt; [Node] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Node -&gt; String
</span><a href="Cardano.Benchmarking.Topology.Types.html#name"><span class="hs-identifier hs-var">Types.name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Node -&gt; Int) -&gt; [Node] -&gt; [Node]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#sortOn"><span class="hs-identifier hs-var">sortOn</span></a></span><span> </span><span class="annot"><span class="annottext">Node -&gt; Int
</span><a href="Cardano.Benchmarking.Topology.Types.html#nodeId"><span class="hs-identifier hs-var">Types.nodeId</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679104270"><span class="hs-identifier hs-var">coreNodes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">org :: String
</span><a href="Cardano.Benchmarking.Topology.Types.html#org"><span class="hs-identifier hs-var">org</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;IOHK&quot;</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pools :: Maybe Int
</span><a href="Cardano.Benchmarking.Topology.Types.html#pools"><span class="hs-identifier hs-var">pools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stakePool :: Maybe Bool
</span><a href="Cardano.Benchmarking.Topology.Types.html#stakePool"><span class="hs-identifier hs-var">stakePool</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><span class="hs-comment">-- | Intermediate structure to work with Nodes producers by ID instead of name.</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="Spec"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-var">Spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Spec"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-var">Spec</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="specId"><span class="annot"><span class="annottext">Spec -&gt; Int
</span><a href="Cardano.Benchmarking.Topology.html#specId"><span class="hs-identifier hs-var hs-var">specId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="loc"><span class="annot"><span class="annottext">Spec -&gt; Location
</span><a href="Cardano.Benchmarking.Topology.html#loc"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mpools"><span class="annot"><span class="annottext">Spec -&gt; Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#mpools"><span class="hs-identifier hs-var hs-var">mpools</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="links"><span class="annot"><span class="annottext">Spec -&gt; [Int]
</span><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var hs-var">links</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679104286"><span id="local-6989586621679104296"><span id="local-6989586621679104300"><span class="annot"><span class="annottext">Int -&gt; Spec -&gt; ShowS
[Spec] -&gt; ShowS
Spec -&gt; String
(Int -&gt; Spec -&gt; ShowS)
-&gt; (Spec -&gt; String) -&gt; ([Spec] -&gt; ShowS) -&gt; Show Spec
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Spec -&gt; ShowS
showsPrec :: Int -&gt; Spec -&gt; ShowS
$cshow :: Spec -&gt; String
show :: Spec -&gt; String
$cshowList :: [Spec] -&gt; ShowS
showList :: [Spec] -&gt; ShowS
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#idName"><span class="hs-identifier hs-type">idName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-90"></span><span id="idName"><span class="annot"><span class="annottext">idName :: Int -&gt; String
</span><a href="Cardano.Benchmarking.Topology.html#idName"><span class="hs-identifier hs-var hs-var">idName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;node-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (Int -&gt; String) -&gt; Int -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><span class="hs-comment">-- | Create a node from Spec adding the default values.</span></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkNode"><span class="hs-identifier hs-type">mkNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Node"><span class="hs-identifier hs-type">Types.Node</span></a></span><span>
</span><span id="line-94"></span><span id="mkNode"><span class="annot"><span class="annottext">mkNode :: Spec -&gt; Node
</span><a href="Cardano.Benchmarking.Topology.html#mkNode"><span class="hs-identifier hs-var hs-var">mkNode</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">{</span><span id="local-6989586621679104306"><span id="local-6989586621679104307"><span id="local-6989586621679104308"><span id="local-6989586621679104309"><span class="annot"><span class="annottext">Int
[Int]
Maybe Int
Location
specId :: Spec -&gt; Int
loc :: Spec -&gt; Location
mpools :: Spec -&gt; Maybe Int
links :: Spec -&gt; [Int]
specId :: Int
loc :: Location
mpools :: Maybe Int
links :: [Int]
</span><a href="Cardano.Benchmarking.Topology.html#specId"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Node"><span class="hs-identifier hs-type">Types.Node</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">Int
String
[String]
Maybe Bool
Maybe Int
Location
name :: String
nodeId :: Int
region :: Location
producers :: [String]
org :: String
pools :: Maybe Int
stakePool :: Maybe Bool
name :: String
org :: String
nodeId :: Int
pools :: Maybe Int
stakePool :: Maybe Bool
region :: Location
producers :: [String]
</span><a href="Cardano.Benchmarking.Topology.Types.html#name"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679104310"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679104310"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="Cardano.Benchmarking.Topology.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104312"><span class="hs-identifier hs-var">nodeId</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679104311"><span class="annot"><span class="annottext">org :: String
</span><a href="#local-6989586621679104311"><span class="hs-identifier hs-var hs-var">org</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;IOHK&quot;</span></span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679104312"><span class="annot"><span class="annottext">nodeId :: Int
</span><a href="#local-6989586621679104312"><span class="hs-identifier hs-var hs-var">nodeId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104306"><span class="hs-identifier hs-var">specId</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679104313"><span class="annot"><span class="annottext">pools :: Maybe Int
</span><a href="#local-6989586621679104313"><span class="hs-identifier hs-var hs-var">pools</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679104308"><span class="hs-identifier hs-var">mpools</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679104314"><span class="annot"><span class="annottext">stakePool :: Maybe Bool
</span><a href="#local-6989586621679104314"><span class="hs-identifier hs-var hs-var">stakePool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe Bool) -&gt; Bool -&gt; Maybe Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679104308"><span class="hs-identifier hs-var">mpools</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679104315"><span class="annot"><span class="annottext">region :: Location
</span><a href="#local-6989586621679104315"><span class="hs-identifier hs-var hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104307"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679104316"><span class="annot"><span class="annottext">producers :: [String]
</span><a href="#local-6989586621679104316"><span class="hs-identifier hs-var hs-var">producers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="Cardano.Benchmarking.Topology.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; [Int] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679104309"><span class="hs-identifier hs-var">links</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes%27"><span class="hs-identifier hs-type">mkCoreNodes'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#CoreNodesParams"><span class="hs-identifier hs-type">CoreNodesParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span id="mkCoreNodes%27"><span class="annot"><span class="annottext">mkCoreNodes' :: CoreNodesParams -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes%27"><span class="hs-identifier hs-var hs-var">mkCoreNodes'</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span class="hs-special">{</span><span id="local-6989586621679104319"><span id="local-6989586621679104320"><span id="local-6989586621679104321"><span class="annot"><span class="annottext">Int
Location
Int -&gt; Maybe Int
tpSize :: CoreNodesParams -&gt; Int
tpLocation :: CoreNodesParams -&gt; Location
tpIdPools :: CoreNodesParams -&gt; Int -&gt; Maybe Int
tpSize :: Int
tpLocation :: Location
tpIdPools :: Int -&gt; Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#tpSize"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Spec] -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#breakLoop"><span class="hs-identifier hs-var">breakLoop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104319"><span class="hs-identifier hs-var">tpSize</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104323"><span class="hs-identifier hs-var">phase1</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">-- Nodes' ids starting from zero.</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679104329"><span class="annot"><span class="annottext">specIds :: [Int]
</span><a href="#local-6989586621679104329"><span class="hs-identifier hs-var hs-var">specIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104319"><span class="hs-identifier hs-var">tpSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- Assign each node the location, an empty links list and pool count.</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679104331"><span class="annot"><span class="annottext">phase0 :: [Spec]
</span><a href="#local-6989586621679104331"><span class="hs-identifier hs-var hs-var">phase0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Spec
</span><a href="#local-6989586621679104332"><span class="hs-identifier hs-var">mkInitial</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Spec) -&gt; [Int] -&gt; [Spec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679104329"><span class="hs-identifier hs-var">specIds</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><a href="#local-6989586621679104332"><span class="hs-identifier hs-type">mkInitial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-111"></span><span>      </span><span id="local-6989586621679104332"><span class="annot"><span class="annottext">mkInitial :: Int -&gt; Spec
</span><a href="#local-6989586621679104332"><span class="hs-identifier hs-var hs-var">mkInitial</span></a></span></span><span> </span><span id="local-6989586621679104333"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104333"><span class="hs-identifier hs-var">specId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-113"></span><span>            </span><span class="annot"><span class="annottext">links :: [Int]
</span><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mpools :: Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#mpools"><span class="hs-identifier hs-var">mpools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
</span><a href="#local-6989586621679104321"><span class="hs-identifier hs-var">tpIdPools</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104333"><span class="hs-identifier hs-var">specId</span></a></span><span>
</span><span id="line-115"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">loc :: Location
</span><a href="Cardano.Benchmarking.Topology.html#loc"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104320"><span class="hs-identifier hs-var">tpLocation</span></a></span><span>
</span><span id="line-116"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
specId :: Int
specId :: Int
</span><a href="Cardano.Benchmarking.Topology.html#specId"><span class="hs-glyph hs-var hs-var">..</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- Connect into a ring with bidirectional = true</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679104323"><span class="annot"><span class="annottext">phase1 :: [Spec]
</span><a href="#local-6989586621679104323"><span class="hs-identifier hs-var hs-var">phase1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; [Spec] -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#intraConnectRing"><span class="hs-identifier hs-var">intraConnectRing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104331"><span class="hs-identifier hs-var">phase0</span></a></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes%27"><span class="hs-identifier hs-var">mkCoreNodes'</span></a></span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#UniCircle"><span class="hs-identifier hs-type">UniCircle</span></a></span><span class="hs-special">{</span><span id="local-6989586621679104335"><span id="local-6989586621679104336"><span id="local-6989586621679104337"><span class="annot"><span class="annottext">Int
Location
Int -&gt; Maybe Int
tpSize :: CoreNodesParams -&gt; Int
tpLocation :: CoreNodesParams -&gt; Location
tpIdPools :: CoreNodesParams -&gt; Int -&gt; Maybe Int
tpSize :: Int
tpLocation :: Location
tpIdPools :: Int -&gt; Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#tpSize"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104338"><span class="hs-identifier hs-var">phase1</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-comment">-- Nodes' ids starting from zero.</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679104343"><span class="annot"><span class="annottext">specIds :: [Int]
</span><a href="#local-6989586621679104343"><span class="hs-identifier hs-var hs-var">specIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104335"><span class="hs-identifier hs-var">tpSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">-- Assign each node the location, an empty links list and pool count.</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679104345"><span class="annot"><span class="annottext">phase0 :: [Spec]
</span><a href="#local-6989586621679104345"><span class="hs-identifier hs-var hs-var">phase0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Spec
</span><a href="#local-6989586621679104346"><span class="hs-identifier hs-var">mkInitial</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Spec) -&gt; [Int] -&gt; [Spec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679104343"><span class="hs-identifier hs-var">specIds</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><a href="#local-6989586621679104346"><span class="hs-identifier hs-type">mkInitial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-127"></span><span>      </span><span id="local-6989586621679104346"><span class="annot"><span class="annottext">mkInitial :: Int -&gt; Spec
</span><a href="#local-6989586621679104346"><span class="hs-identifier hs-var hs-var">mkInitial</span></a></span></span><span> </span><span id="local-6989586621679104347"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104347"><span class="hs-identifier hs-var">specId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-129"></span><span>          </span><span class="annot"><span class="annottext">links :: [Int]
</span><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mpools :: Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#mpools"><span class="hs-identifier hs-var">mpools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
</span><a href="#local-6989586621679104337"><span class="hs-identifier hs-var">tpIdPools</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104347"><span class="hs-identifier hs-var">specId</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">loc :: Location
</span><a href="Cardano.Benchmarking.Topology.html#loc"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104336"><span class="hs-identifier hs-var">tpLocation</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
specId :: Int
specId :: Int
</span><a href="Cardano.Benchmarking.Topology.html#specId"><span class="hs-glyph hs-var hs-var">..</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">-- Connect into a ring with bidirectional = false</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679104338"><span class="annot"><span class="annottext">phase1 :: [Spec]
</span><a href="#local-6989586621679104338"><span class="hs-identifier hs-var hs-var">phase1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; [Spec] -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#intraConnectRing"><span class="hs-identifier hs-var">intraConnectRing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104345"><span class="hs-identifier hs-var">phase0</span></a></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes%27"><span class="hs-identifier hs-var">mkCoreNodes'</span></a></span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Torus"><span class="hs-identifier hs-type">Torus</span></a></span><span class="hs-special">{</span><span id="local-6989586621679104348"><span id="local-6989586621679104349"><span id="local-6989586621679104350"><span class="annot"><span class="annottext">Int
[Location]
Int -&gt; Maybe Int
tpSize :: CoreNodesParams -&gt; Int
tpIdPools :: CoreNodesParams -&gt; Int -&gt; Maybe Int
tpLocations :: CoreNodesParams -&gt; [Location]
tpSize :: Int
tpLocations :: [Location]
tpIdPools :: Int -&gt; Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#tpSize"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Location] -&gt; (Int -&gt; Maybe Int) -&gt; Bool -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#mkCoreNodesTorus"><span class="hs-identifier hs-var">mkCoreNodesTorus</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104348"><span class="hs-identifier hs-var">tpSize</span></a></span><span> </span><span class="annot"><span class="annottext">[Location]
</span><a href="#local-6989586621679104349"><span class="hs-identifier hs-var">tpLocations</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
</span><a href="#local-6989586621679104350"><span class="hs-identifier hs-var">tpIdPools</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- The dense Torus, with each node having 4 intra-region connections, needs</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- a minimun of nodes.</span><span>
</span><span id="line-139"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkCoreNodes%27"><span class="hs-identifier hs-var">mkCoreNodes'</span></a></span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#TorusDense"><span class="hs-identifier hs-type">TorusDense</span></a></span><span class="hs-special">{</span><span id="local-6989586621679104352"><span id="local-6989586621679104353"><span id="local-6989586621679104354"><span class="annot"><span class="annottext">Int
[Location]
Int -&gt; Maybe Int
tpSize :: CoreNodesParams -&gt; Int
tpIdPools :: CoreNodesParams -&gt; Int -&gt; Maybe Int
tpLocations :: CoreNodesParams -&gt; [Location]
tpSize :: Int
tpLocations :: [Location]
tpIdPools :: Int -&gt; Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#tpSize"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Location] -&gt; (Int -&gt; Maybe Int) -&gt; Bool -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#mkCoreNodesTorus"><span class="hs-identifier hs-var">mkCoreNodesTorus</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104352"><span class="hs-identifier hs-var">tpSize</span></a></span><span> </span><span class="annot"><span class="annottext">[Location]
</span><a href="#local-6989586621679104353"><span class="hs-identifier hs-var">tpLocations</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
</span><a href="#local-6989586621679104354"><span class="hs-identifier hs-var">tpIdPools</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#mkCoreNodesTorus"><span class="hs-identifier hs-type">mkCoreNodesTorus</span></a></span><span> </span><span class="hs-glyph">::</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span id="mkCoreNodesTorus"><span class="annot"><span class="annottext">mkCoreNodesTorus :: Int -&gt; [Location] -&gt; (Int -&gt; Maybe Int) -&gt; Bool -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#mkCoreNodesTorus"><span class="hs-identifier hs-var hs-var">mkCoreNodesTorus</span></a></span></span><span> </span><span id="local-6989586621679104355"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104355"><span class="hs-identifier hs-var">tpSize'</span></a></span></span><span> </span><span id="local-6989586621679104356"><span class="annot"><span class="annottext">[Location]
</span><a href="#local-6989586621679104356"><span class="hs-identifier hs-var">tpLocations'</span></a></span></span><span> </span><span id="local-6989586621679104357"><span class="annot"><span class="annottext">Int -&gt; Maybe Int
</span><a href="#local-6989586621679104357"><span class="hs-identifier hs-var">tpIdPools'</span></a></span></span><span> </span><span id="local-6989586621679104358"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679104358"><span class="hs-identifier hs-var">dense</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Spec]] -&gt; [Spec]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104360"><span class="hs-identifier hs-var">phase3</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-comment">-- Nodes' ids starting from zero.</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-comment">-- For the usual torus/dense topology it returns:</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-comment">-- [ 0, 1, 2,.., 51 ]</span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679104365"><span class="annot"><span class="annottext">specIds :: [Int]
</span><a href="#local-6989586621679104365"><span class="hs-identifier hs-var hs-var">specIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104355"><span class="hs-identifier hs-var">tpSize'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">-- A list of repeating locations (in the same order).</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-comment">-- For the usual torus/dense topology it returns:</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-comment">-- [ &quot;eu&quot;, &quot;us&quot;, &quot;ap&quot;, &quot;eu&quot;, &quot;us&quot;, &quot;ap&quot; .. &quot;eu&quot; ]</span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621679104368"><span class="annot"><span class="annottext">specLocs :: [Location]
</span><a href="#local-6989586621679104368"><span class="hs-identifier hs-var hs-var">specLocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Location] -&gt; [Location]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104355"><span class="hs-identifier hs-var">tpSize'</span></a></span><span> </span><span class="annot"><span class="annottext">([Location] -&gt; [Location]) -&gt; [Location] -&gt; [Location]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Location] -&gt; [Location]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#cycle"><span class="hs-identifier hs-var">cycle</span></a></span><span> </span><span class="annot"><span class="annottext">[Location]
</span><a href="#local-6989586621679104356"><span class="hs-identifier hs-var">tpLocations'</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">-- Orderly (zip) assign the locations, an empty links list and pool count.</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- For the usual torus/dense topology it returns:</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">-- [</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">--      ( 0,&quot;eu&quot;), ( 1,&quot;us&quot;), ( 2,&quot;ap&quot;),</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">--      ..</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">--      (45,&quot;eu&quot;), (46,&quot;us&quot;), (47,&quot;ap&quot;),</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-comment">--      (48,&quot;eu&quot;), (49,&quot;us&quot;), (50,&quot;ap&quot;), (51,&quot;eu&quot;)</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">--  ]</span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679104371"><span class="annot"><span class="annottext">phase0 :: [Spec]
</span><a href="#local-6989586621679104371"><span class="hs-identifier hs-var hs-var">phase0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Location -&gt; Spec) -&gt; [Int] -&gt; [Location] -&gt; [Spec]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Location -&gt; Spec
</span><a href="#local-6989586621679104373"><span class="hs-identifier hs-var">mkInitial</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679104365"><span class="hs-identifier hs-var">specIds</span></a></span><span> </span><span class="annot"><span class="annottext">[Location]
</span><a href="#local-6989586621679104368"><span class="hs-identifier hs-var">specLocs</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><a href="#local-6989586621679104373"><span class="hs-identifier hs-type">mkInitial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.Types.html#Location"><span class="hs-identifier hs-type">Types.Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span id="local-6989586621679104373"><span class="annot"><span class="annottext">mkInitial :: Int -&gt; Location -&gt; Spec
</span><a href="#local-6989586621679104373"><span class="hs-identifier hs-var hs-var">mkInitial</span></a></span></span><span> </span><span id="local-6989586621679104374"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104374"><span class="hs-identifier hs-var">specId</span></a></span></span><span> </span><span id="local-6989586621679104375"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104375"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-164"></span><span>          </span><span class="annot"><span class="annottext">links :: [Int]
</span><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mpools :: Maybe Int
</span><a href="Cardano.Benchmarking.Topology.html#mpools"><span class="hs-identifier hs-var">mpools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
</span><a href="#local-6989586621679104357"><span class="hs-identifier hs-var">tpIdPools'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104374"><span class="hs-identifier hs-var">specId</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
Location
specId :: Int
loc :: Location
specId :: Int
loc :: Location
</span><a href="Cardano.Benchmarking.Topology.html#specId"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-comment">-- Split into per-location lists (list of lists).</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-comment">-- For the usual torus/dense topology it returns:</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-comment">-- [</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-comment">--    [ (0,&quot;eu&quot;), (3,&quot;eu&quot;), .. (48,&quot;eu&quot;), (51,&quot;eu&quot;) ]</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-comment">--    [ (1,&quot;us&quot;), (4,&quot;us&quot;), .. (49,&quot;us&quot;) ]</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-comment">--    [ (2,&quot;ap&quot;), (5,&quot;ap&quot;), .. (50,&quot;ap&quot;) ]</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- ]</span><span>
</span><span id="line-175"></span><span>  </span><span id="local-6989586621679104379"><span class="annot"><span class="annottext">phase1 :: [[Spec]]
</span><a href="#local-6989586621679104379"><span class="hs-identifier hs-var hs-var">phase1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-special">[</span><span>
</span><span id="line-177"></span><span>          </span><span class="annot"><span class="annottext">(Spec -&gt; Bool) -&gt; [Spec] -&gt; [Spec]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Location -&gt; Location -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104380"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Location -&gt; Bool) -&gt; (Spec -&gt; Location) -&gt; Spec -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Spec -&gt; Location
</span><a href="Cardano.Benchmarking.Topology.html#loc"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104371"><span class="hs-identifier hs-var">phase0</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679104380"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679104380"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Location]
</span><a href="#local-6989586621679104356"><span class="hs-identifier hs-var">tpLocations'</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">[[Spec]] -&gt; ([[Spec]] -&gt; [[Spec]]) -&gt; [[Spec]]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Function.html#%26"><span class="hs-operator hs-var">&amp;</span></a></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">([Spec] -&gt; Bool) -&gt; [[Spec]] -&gt; [[Spec]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([Spec] -&gt; Bool) -&gt; [Spec] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- Establish intra-location connections for every location list.</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- For the usual torus topology: it first adds a connection to the</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- inmmediate next same-region node and one to the inmmediate previous</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">-- same-region node.</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- [</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">--     Spec {specId =  0, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 3,51]}</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">--   , Spec {specId =  3, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 6, 0]}</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-comment">--   , Spec {specId =  6, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 9, 3]}</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-comment">--   ...</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-comment">--   , Spec {specId = 45, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [48,42]}</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">--   , Spec {specId = 48, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [51,45]}</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-comment">--   , Spec {specId = 51, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 0,48]}</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-comment">-- ]</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-comment">-- For the dense version of the Torus it add two more intra links:</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-comment">-- [</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">--     Spec {specId = 0,  loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 3,51,18,36]}</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-comment">--   , Spec {specId = 3,  loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 6, 0,21,39]}</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-comment">--   , Spec {specId = 6,  loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 9, 3,24,42]}</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">--   ...</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">--   , Spec {specId = 45, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [48,42, 9,27]}</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-comment">--   , Spec {specId = 48, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [51,45,12,30]}</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-comment">--   , Spec {specId = 51, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 0,48,15,33]}</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-comment">-- ]</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679104384"><span class="annot"><span class="annottext">phase2 :: [[Spec]]
</span><a href="#local-6989586621679104384"><span class="hs-identifier hs-var hs-var">phase2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; [Spec] -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#intraConnectRing"><span class="hs-identifier hs-var">intraConnectRing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679104358"><span class="hs-identifier hs-var">dense</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">([Spec] -&gt; [Spec]) -&gt; [[Spec]] -&gt; [[Spec]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104379"><span class="hs-identifier hs-var">phase1</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">-- Establish inter-location connections.</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679104360"><span class="annot"><span class="annottext">phase3 :: [[Spec]]
</span><a href="#local-6989586621679104360"><span class="hs-identifier hs-var hs-var">phase3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[[Spec]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104384"><span class="hs-identifier hs-var">phase2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[[Spec]] -&gt; [[Spec]]
</span><a href="#local-6989586621679104389"><span class="hs-identifier hs-var">interConnect</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104384"><span class="hs-identifier hs-var">phase2</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104384"><span class="hs-identifier hs-var">phase2</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="#local-6989586621679104389"><span class="hs-identifier hs-type">interConnect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679104389"><span class="annot"><span class="annottext">interConnect :: [[Spec]] -&gt; [[Spec]]
</span><a href="#local-6989586621679104389"><span class="hs-identifier hs-var hs-var">interConnect</span></a></span></span><span> </span><span id="local-6989586621679104390"><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104390"><span class="hs-identifier hs-var">xss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104391"><span class="hs-identifier hs-var">nlocs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104390"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104390"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [[Spec]] -&gt; [[Spec]]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104391"><span class="hs-identifier hs-var">nlocs</span></a></span><span> </span><span class="annot"><span class="annottext">([[Spec]] -&gt; [[Spec]]) -&gt; [[Spec]] -&gt; [[Spec]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([[Spec]] -&gt; [Spec]) -&gt; [[[Spec]]] -&gt; [[Spec]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]] -&gt; [Spec]
</span><a href="#local-6989586621679104392"><span class="hs-identifier hs-var">linker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Spec]] -&gt; [[[Spec]]]
forall a. [a] -&gt; [[a]]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#tails"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">([[Spec]] -&gt; [[[Spec]]]) -&gt; [[Spec]] -&gt; [[[Spec]]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]] -&gt; [[Spec]]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#cycle"><span class="hs-identifier hs-var">cycle</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104390"><span class="hs-identifier hs-var">xss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>      </span><span id="local-6989586621679104391"><span class="annot"><span class="annottext">nlocs :: Int
</span><a href="#local-6989586621679104391"><span class="hs-identifier hs-var hs-var">nlocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Spec]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104390"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span id="local-6989586621679104392"><span class="annot"><span class="annottext">linker :: [[Spec]] -&gt; [Spec]
</span><a href="#local-6989586621679104392"><span class="hs-identifier hs-var hs-var">linker</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679104399"><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104399"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679104400"><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104400"><span class="hs-identifier hs-var">xss'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Spec
</span><a href="#local-6989586621679104401"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679104402"><span class="hs-identifier hs-type">ids</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679104401"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-220"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679104401"><span class="annot"><span class="annottext">Spec
</span><a href="#local-6989586621679104401"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679104403"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104403"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Spec] -&gt; [Int] -&gt; [(Spec, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104399"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679104402"><span class="annot"><span class="annottext">ids :: [Int]
</span><a href="#local-6989586621679104402"><span class="hs-identifier hs-var hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Spec] -&gt; Int
</span><a href="#local-6989586621679104405"><span class="hs-identifier hs-var">idOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104403"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">([Spec] -&gt; Int) -&gt; [[Spec]] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104406"><span class="hs-identifier hs-var">rings</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>          </span><span id="local-6989586621679104406"><span class="annot"><span class="annottext">rings :: [[Spec]]
</span><a href="#local-6989586621679104406"><span class="hs-identifier hs-var hs-var">rings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [[Spec]] -&gt; [[Spec]]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104391"><span class="hs-identifier hs-var">nlocs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Spec]] -&gt; [[Spec]]) -&gt; [[Spec]] -&gt; [[Spec]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec] -&gt; [Spec]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#cycle"><span class="hs-identifier hs-var">cycle</span></a></span><span> </span><span class="annot"><span class="annottext">([Spec] -&gt; [Spec]) -&gt; [[Spec]] -&gt; [[Spec]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[[Spec]]
</span><a href="#local-6989586621679104400"><span class="hs-identifier hs-var">xss'</span></a></span><span>
</span><span id="line-225"></span><span>          </span><span id="local-6989586621679104405"><span class="annot"><span class="annottext">idOf :: Int -&gt; [Spec] -&gt; Int
</span><a href="#local-6989586621679104405"><span class="hs-identifier hs-var hs-var">idOf</span></a></span></span><span> </span><span id="local-6989586621679104414"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104414"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679104415"><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104415"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec -&gt; Int
</span><a href="Cardano.Benchmarking.Topology.html#specId"><span class="hs-identifier hs-var">specId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104415"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec] -&gt; Int -&gt; Spec
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104414"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><a href="#local-6989586621679104392"><span class="hs-identifier hs-var">linker</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Spec]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invariant failure: empty list of specs&quot;</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#breakLoop"><span class="hs-identifier hs-type">breakLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span id="breakLoop"><span class="annot"><span class="annottext">breakLoop :: Int -&gt; [Spec] -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#breakLoop"><span class="hs-identifier hs-var hs-var">breakLoop</span></a></span></span><span> </span><span id="local-6989586621679104418"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104418"><span class="hs-identifier hs-var">tpSize</span></a></span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; [Spec] -&gt; [Spec]
forall a. (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Cardano.Benchmarking.Topology.html#updateHead"><span class="hs-identifier hs-var">updateHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; Spec -&gt; Spec
</span><a href="Cardano.Benchmarking.Topology.html#filterLinks"><span class="hs-identifier hs-var">filterLinks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104418"><span class="hs-identifier hs-var">tpSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">([Spec] -&gt; [Spec]) -&gt; ([Spec] -&gt; [Spec]) -&gt; [Spec] -&gt; [Spec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; [Spec] -&gt; [Spec]
forall a. (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Cardano.Benchmarking.Topology.html#updateLast"><span class="hs-identifier hs-var">updateLast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; Spec -&gt; Spec
</span><a href="Cardano.Benchmarking.Topology.html#filterLinks"><span class="hs-identifier hs-var">filterLinks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#filterLinks"><span class="hs-identifier hs-type">filterLinks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-234"></span><span id="filterLinks"><span class="annot"><span class="annottext">filterLinks :: (Int -&gt; Bool) -&gt; Spec -&gt; Spec
</span><a href="Cardano.Benchmarking.Topology.html#filterLinks"><span class="hs-identifier hs-var hs-var">filterLinks</span></a></span></span><span> </span><span id="local-6989586621679104423"><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679104423"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679104424"><span class="annot"><span class="annottext">s :: Spec
</span><a href="#local-6989586621679104424"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">{</span><span id="local-6989586621679104425"><span id="local-6989586621679104426"><span id="local-6989586621679104427"><span id="local-6989586621679104428"><span class="annot"><span class="annottext">Int
[Int]
Maybe Int
Location
specId :: Spec -&gt; Int
loc :: Spec -&gt; Location
mpools :: Spec -&gt; Maybe Int
links :: Spec -&gt; [Int]
specId :: Int
loc :: Location
mpools :: Maybe Int
links :: [Int]
</span><a href="Cardano.Benchmarking.Topology.html#specId"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec
</span><a href="#local-6989586621679104424"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier hs-type">filter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679104423"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679104428"><span class="hs-identifier hs-type">links</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">{-- Examples:

intraConnectRing False False $
&gt; map
  (\id' -&gt; Spec id' (Types.AWS Types.EU_CENTRAL_1) Nothing [])
  [0,3..51]
[
  Spec {specId =  0, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 3]}
, Spec {specId =  3, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 6]}
, Spec {specId =  6, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 9]}
...
, Spec {specId = 45, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [48]}
, Spec {specId = 48, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [51]}
, Spec {specId = 51, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 0]}
]

intraConnectRing False True $
&gt; map
  (\id' -&gt; Spec id' (Types.AWS Types.EU_CENTRAL_1) Nothing [])
  [0,3..51]
[
  Spec {specId =  0, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 3,51]}
, Spec {specId =  3, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 6, 0]}
, Spec {specId =  6, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 9, 3]}
...
, Spec {specId = 45, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [48,42]}
, Spec {specId = 48, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [51,45]}
, Spec {specId = 51, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 0,48]}
]

intraConnectRing True False $
&gt; map
  (\id' -&gt; Spec id' (Types.AWS Types.EU_CENTRAL_1) Nothing [])
  [0,3..51]
[
  Spec {specId =  0, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 3]}
, Spec {specId =  3, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 6]}
, Spec {specId =  6, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 9]}
...
, Spec {specId = 45, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [48]}
, Spec {specId = 48, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [51]}
, Spec {specId = 51, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 0]}
]

intraConnectRing True True $
&gt; map
  (\id' -&gt; Spec id' (Types.AWS Types.EU_CENTRAL_1) Nothing [])
  [0,3..51]
[
  Spec {specId = 0,  loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 3,51,18,36]}
, Spec {specId = 3,  loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 6, 0,21,39]}
, Spec {specId = 6,  loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 9, 3,24,42]}
...
, Spec {specId = 45, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [48,42, 9,27]}
, Spec {specId = 48, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [51,45,12,30]}
, Spec {specId = 51, loc = AWS EU_CENTRAL_1, mpools = Nothing, links = [ 0,48,15,33]}
]

--}</span><span>
</span><span id="line-295"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#intraConnectRing"><span class="hs-identifier hs-type">intraConnectRing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span id="intraConnectRing"><span class="annot"><span class="annottext">intraConnectRing :: Bool -&gt; Bool -&gt; [Spec] -&gt; [Spec]
</span><a href="Cardano.Benchmarking.Topology.html#intraConnectRing"><span class="hs-identifier hs-var hs-var">intraConnectRing</span></a></span></span><span> </span><span id="local-6989586621679104429"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679104429"><span class="hs-identifier hs-var">withChords</span></a></span></span><span> </span><span id="local-6989586621679104430"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679104430"><span class="hs-identifier hs-var">bidirectional</span></a></span></span><span> </span><span id="local-6989586621679104431"><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104431"><span class="hs-identifier hs-var">specs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104432"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104431"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Spec] -&gt; [Spec]
</span><a href="#local-6989586621679104433"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104431"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Spec] -&gt; [Spec]
</span><a href="#local-6989586621679104433"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>                             </span><span class="hs-comment">-- next</span><span>
</span><span id="line-302"></span><span>       </span><span class="annot"><span class="annottext">([Spec] -&gt; [Spec]) -&gt; [Spec] -&gt; [Spec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679104430"><span class="hs-identifier hs-var">bidirectional</span></a></span><span>
</span><span id="line-303"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104431"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-304"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Spec] -&gt; [Spec]
</span><a href="#local-6989586621679104433"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104432"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>                </span><span class="hs-comment">-- prev</span><span>
</span><span id="line-305"></span><span>              </span><span class="annot"><span class="annottext">([Spec] -&gt; [Spec]) -&gt; [Spec] -&gt; [Spec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679104429"><span class="hs-identifier hs-var">withChords</span></a></span><span>
</span><span id="line-306"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104431"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-307"></span><span>                </span><span class="hs-comment">-- Add two more intra-region connections.</span><span>
</span><span id="line-308"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Spec] -&gt; [Spec]
</span><a href="#local-6989586621679104433"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104432"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- chord 1</span><span>
</span><span id="line-309"></span><span>                     </span><span class="annot"><span class="annottext">([Spec] -&gt; [Spec]) -&gt; [Spec] -&gt; [Spec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104432"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-310"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104431"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-311"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Spec] -&gt; [Spec]
</span><a href="#local-6989586621679104433"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104432"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- chord 2</span><span>
</span><span id="line-312"></span><span>                            </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104431"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-313"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>   </span><span id="local-6989586621679104432"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679104432"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Spec] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104431"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-315"></span><span>   </span><span class="annot"><a href="#local-6989586621679104433"><span class="hs-identifier hs-type">connect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span>   </span><span id="local-6989586621679104433"><span class="annot"><span class="annottext">connect :: Int -&gt; [Spec] -&gt; [Spec]
</span><a href="#local-6989586621679104433"><span class="hs-identifier hs-var hs-var">connect</span></a></span></span><span> </span><span id="local-6989586621679104438"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104438"><span class="hs-identifier hs-var">offt</span></a></span></span><span> </span><span id="local-6989586621679104439"><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104439"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Spec] -&gt; [Spec]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Spec] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104439"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Spec] -&gt; [Spec]) -&gt; [Spec] -&gt; [Spec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([Spec] -&gt; Spec) -&gt; [[Spec]] -&gt; [Spec]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec] -&gt; Spec
</span><a href="#local-6989586621679104440"><span class="hs-identifier hs-var">linker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Spec] -&gt; [[Spec]]
forall a. [a] -&gt; [[a]]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#tails"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104441"><span class="hs-identifier hs-var">ring</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>     </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679104440"><span class="annot"><span class="annottext">linker :: [Spec] -&gt; Spec
</span><a href="#local-6989586621679104440"><span class="hs-identifier hs-var hs-var">linker</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679104446"><span class="annot"><span class="annottext">Spec
</span><a href="#local-6989586621679104446"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679104447"><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104447"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-318"></span><span>             </span><span class="annot"><span class="annottext">Spec
</span><a href="#local-6989586621679104446"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679104448"><span class="hs-identifier hs-type">idOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679104438"><span class="hs-identifier hs-type">offt</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-type">-</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679104447"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-319"></span><span>                       </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#links"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679104446"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-320"></span><span>           </span><span class="annot"><a href="#local-6989586621679104440"><span class="hs-identifier hs-var">linker</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Spec
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invariant failure: empty list of specs&quot;</span></span><span>
</span><span id="line-321"></span><span>           </span><span id="local-6989586621679104441"><span class="annot"><span class="annottext">ring :: [Spec]
</span><a href="#local-6989586621679104441"><span class="hs-identifier hs-var hs-var">ring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Spec] -&gt; [Spec]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#cycle"><span class="hs-identifier hs-var">cycle</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104439"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-322"></span><span>           </span><span id="local-6989586621679104448"><span class="annot"><span class="annottext">idOf :: Int -&gt; [Spec] -&gt; Int
</span><a href="#local-6989586621679104448"><span class="hs-identifier hs-var hs-var">idOf</span></a></span></span><span> </span><span id="local-6989586621679104453"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104453"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679104454"><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104454"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec -&gt; Int
</span><a href="Cardano.Benchmarking.Topology.html#specId"><span class="hs-identifier hs-var">specId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Spec]
</span><a href="#local-6989586621679104454"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Spec] -&gt; Int -&gt; Spec
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679104453"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">--- * Aux</span><span>
</span><span id="line-325"></span><span class="hs-comment">---</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- | Update the first element of a list, if it exists.</span><span>
</span><span id="line-327"></span><span class="hs-comment">--   O(1).</span><span>
</span><span id="line-328"></span><span id="local-6989586621679104193"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#updateHead"><span class="hs-identifier hs-type">updateHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679104193"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679104193"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679104193"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679104193"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-329"></span><span id="updateHead"><span class="annot"><span class="annottext">updateHead :: forall a. (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Cardano.Benchmarking.Topology.html#updateHead"><span class="hs-identifier hs-var hs-var">updateHead</span></a></span></span><span> </span><span id="local-6989586621679104455"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679104455"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679104456"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679104456"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe (a, [a])
forall a. [a] -&gt; Maybe (a, [a])
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679104456"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><span class="annottext">Maybe (a, [a])
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679104457"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104457"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679104458"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679104458"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679104455"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104457"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679104458"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | Update the last element of a list, if it exists.</span><span>
</span><span id="line-334"></span><span class="hs-comment">--   O(n).</span><span>
</span><span id="line-335"></span><span id="local-6989586621679104459"><span class="annot"><a href="Cardano.Benchmarking.Topology.html#updateLast"><span class="hs-identifier hs-type">updateLast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679104459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679104459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679104459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679104459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-336"></span><span id="updateLast"><span class="annot"><span class="annottext">updateLast :: forall a. (a -&gt; a) -&gt; [a] -&gt; [a]
</span><a href="Cardano.Benchmarking.Topology.html#updateLast"><span class="hs-identifier hs-var hs-var">updateLast</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span class="annot"><a href="Cardano.Benchmarking.Topology.html#updateLast"><span class="hs-identifier hs-var">updateLast</span></a></span><span> </span><span id="local-6989586621679104460"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679104460"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679104461"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104461"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679104462"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679104462"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679104463"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104461"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679104462"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-comment">-- Using a helper function to minimize the pattern matching.</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679104463"><span class="annot"><span class="annottext">loop :: a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679104463"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679104464"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104464"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679104460"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104464"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>  </span><span class="annot"><a href="#local-6989586621679104463"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679104465"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104465"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679104466"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104466"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679104467"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679104467"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104465"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679104463"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679104466"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679104467"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-342"></span></pre></body></html>