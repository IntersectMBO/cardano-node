<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- | See 'Telescope'</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Intended for qualified import</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- &gt; import           Data.SOP.Telescope (Telescope(..))</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- &gt; import qualified Data.SOP.Telescope as Telescope</span><span>
</span><span id="line-24"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.SOP.Telescope</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Telescope</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#sequence"><span class="hs-identifier">sequence</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Utilities</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#fromTZ"><span class="hs-identifier">fromTZ</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier">fromTip</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier">tip</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#toAtMost"><span class="hs-identifier">toAtMost</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Bifunctor analogues of SOP functions</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier">bihap</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#bihczipWith"><span class="hs-identifier">bihczipWith</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#bihmap"><span class="hs-identifier">bihmap</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#bihzipWith"><span class="hs-identifier">bihzipWith</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Extension, retraction, alignment</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier">Extend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier">Retract</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#align"><span class="hs-identifier">align</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#extend"><span class="hs-identifier">extend</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#retract"><span class="hs-identifier">retract</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Simplified API</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#alignExtend"><span class="hs-identifier">alignExtend</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#alignExtendNS"><span class="hs-identifier">alignExtendNS</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#extendIf"><span class="hs-identifier">extendIf</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#retractIf"><span class="hs-identifier">retractIf</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Additional API</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier">ScanNext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier">SimpleTelescope</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#scanl"><span class="hs-identifier">scanl</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Coerce.html"><span class="hs-identifier">Data.Coerce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Prim.html#coerce"><span class="hs-identifier">coerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Product.html"><span class="hs-identifier">Data.Functor.Product</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Kind.html"><span class="hs-identifier">Data.Kind</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.SOP.BasicFunctors</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.SOP.Constraint</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.SOP.Counting.html"><span class="hs-identifier">Data.SOP.Counting</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.SOP.InPairs.html"><span class="hs-identifier">Data.SOP.InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier">Requiring</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html"><span class="hs-identifier">Data.SOP.InPairs</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InPairs</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.SOP.Strict</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.SOP.Tails.html"><span class="hs-identifier">Data.SOP.Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier">Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html"><span class="hs-identifier">Data.SOP.Tails</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tails</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.html"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">allNoThunks</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#scanl"><span class="hs-identifier">scanl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Traversable.html#sequence"><span class="hs-identifier">sequence</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zipWith"><span class="hs-identifier">zipWith</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Telescope
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Telescope</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- A telescope is an extension of an 'NS', where every time we &quot;go right&quot; in the</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- sum we have an additional value.</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- The 'Telescope' API mostly follows @sop-core@ conventions, supporting</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- functor ('hmap', 'hcmap'), applicative ('hap', 'hpure'), foldable</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- ('hcollapse') and traversable ('hsequence''). However, since 'Telescope'</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- is a bi-functor, it cannot reuse the @sop-core@ classes. The naming scheme</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- of the functions is adopted from @sop-core@ though; for example:</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt; bi h (c) zipWith</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt; |  |  |    |</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt; |  |  |    \ zipWith: the name from base</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- &gt; |  |  |</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- &gt; |  |  \ constrained: version of the function with a constraint parameter</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &gt; |  |</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt; |  \ higher order: 'Telescope' (like 'NS'/'NP') is a /higher order/ functor</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt; |</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt; \ bifunctor: 'Telescope' (unlike 'NS'/'NP') is a higher order /bifunctor/</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- In addition to the standard SOP operators, the new operators that make</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- a 'Telescope' a telescope are 'extend', 'retract' and 'align'; see their</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- documentation for details.</span><span>
</span><span id="line-99"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679102991"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102991"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102991"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679102991"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">data</span><span> </span><span id="Telescope"><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-var">Telescope</span></a></span></span><span> </span><span id="local-6989586621679102992"><span class="annot"><a href="#local-6989586621679102992"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102993"><span class="annot"><a href="#local-6989586621679102993"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102994"><span class="annot"><a href="#local-6989586621679102994"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679101943"><span id="local-6989586621679101945"><span id="local-6989586621679102995"><span id="local-6989586621679102996"><span id="TZ"><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101943"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102995"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>                        </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101945"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101943"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102995"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679102996"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679101956"><span id="local-6989586621679101957"><span id="local-6989586621679102998"><span id="local-6989586621679102999"><span id="TS"><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101956"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101956"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101957"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102999"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101956"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101957"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102998"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679102999"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  SOP class instances for 'Telescope'
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Prod"><span class="annot"><span class="hs-identifier hs-var">Prod</span></span></span><span>    </span><span id="local-6989586621679103001"><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103001"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="SListIN"><span class="annot"><span class="hs-identifier hs-var">SListIN</span></span></span><span> </span><span id="local-6989586621679103002"><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103002"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="AllN"><span class="annot"><span class="hs-identifier hs-var">AllN</span></span></span><span>    </span><span id="local-6989586621679103003"><span id="local-6989586621679103004"><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103003"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679103004"><span class="hs-identifier hs-type">c</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621679103004"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679101925"><span class="annot"><span class="hs-identifier hs-type">HAp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101925"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621679103015"><span class="annot"><span class="annottext">hap :: forall (f :: k -&gt; *) (g :: k -&gt; *) (xs :: [k]).
Prod (Telescope g) (f -.-&gt; g) xs
-&gt; Telescope g f xs -&gt; Telescope g g xs
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope g f xs -&gt; NP (f -.-&gt; g) xs -&gt; Telescope g g xs)
-&gt; NP (f -.-&gt; g) xs -&gt; Telescope g f xs -&gt; Telescope g g xs
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NP (f -.-&gt; g) xs -&gt; Telescope g g xs
forall (f :: k -&gt; *) (xs :: [k]) (f' :: k -&gt; *).
Telescope g f xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f' xs
</span><a href="#local-6989586621679103017"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-comment">-- We could define this in terms of 'bihap' but we lack 'SListI'</span><span>
</span><span id="line-116"></span><span>      </span><span id="local-6989586621679101932"><span id="local-6989586621679101933"><span id="local-6989586621679101934"><span class="annot"><a href="#local-6989586621679103017"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101925"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101932"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101933"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679101932"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679101934"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679101933"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101925"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101934"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101933"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span><span>
</span><span id="line-117"></span><span>      </span><span id="local-6989586621679103017"><span class="annot"><span class="annottext">go :: forall (f :: k -&gt; *) (xs :: [k]) (f' :: k -&gt; *).
Telescope g f xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f' xs
</span><a href="#local-6989586621679103017"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103019"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103019"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679103024"><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><a href="#local-6989586621679103024"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs1
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f' x -&gt; Telescope g f' (x : xs)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f f' x -&gt; f x -&gt; f' x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><a href="#local-6989586621679103024"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621679103019"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><a href="#local-6989586621679103017"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103028"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103028"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103029"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103029"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679103034"><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs1
</span><a href="#local-6989586621679103034"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f' xs -&gt; Telescope g f' (x : xs)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103028"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f' xs
forall (f :: k -&gt; *) (xs :: [k]) (f' :: k -&gt; *).
Telescope g f xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f' xs
</span><a href="#local-6989586621679103017"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103029"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
NP (f -.-&gt; f') xs1
</span><a href="#local-6989586621679103034"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679101977"><span class="annot"><span class="hs-identifier hs-type">HTraverse_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101977"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679103044"><span class="annot"><span class="annottext">hctraverse_ :: forall (c :: k -&gt; Constraint) (xs :: [k]) (g :: * -&gt; *)
       (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(AllN (Telescope g) c xs, Applicative g) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; Telescope g f xs
-&gt; g ()
</span><a href="#local-6989586621679103044"><span class="hs-identifier hs-var hs-var hs-var hs-var">hctraverse_</span></a></span></span><span> </span><span id="local-6989586621679103046"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103046"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; g ())
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; Telescope g f xs
-&gt; g ()
forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-var">bihctraverse_</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103046"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">g x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; g ()
forall a. a -&gt; g a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679103057"><span class="annot"><span class="annottext">htraverse_ :: forall (xs :: [k]) (g :: * -&gt; *) (f :: k -&gt; *).
(SListIN (Telescope g) xs, Applicative g) =&gt;
(forall (a :: k). f a -&gt; g ()) -&gt; Telescope g f xs -&gt; g ()
</span><a href="#local-6989586621679103057"><span class="hs-identifier hs-var hs-var hs-var hs-var">htraverse_</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). g x -&gt; g ())
-&gt; (forall (a :: k). f a -&gt; g ()) -&gt; Telescope g f xs -&gt; g ()
forall {k} (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m ())
-&gt; (forall (x :: k). f x -&gt; m ()) -&gt; Telescope g f xs -&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihtraverse_"><span class="hs-identifier hs-var">bihtraverse_</span></a></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">g x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; g ()
forall a. a -&gt; g a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679102032"><span class="annot"><span class="hs-identifier hs-type">HSequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102032"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679103074"><span class="annot"><span class="annottext">hsequence' :: forall (xs :: [k]) (f :: * -&gt; *) (g :: k -&gt; *).
(SListIN (Telescope g) xs, Applicative f) =&gt;
Telescope g (f :.: g) xs -&gt; f (Telescope g g xs)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hsequence'</span></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope (f :.: g) (f :.: g) xs -&gt; f (Telescope g g xs)
forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
(SListI xs, Applicative m) =&gt;
Telescope (m :.: g) (m :.: f) xs -&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#bihsequence%27"><span class="hs-identifier hs-var">bihsequence'</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope (f :.: g) (f :.: g) xs -&gt; f (Telescope g g xs))
-&gt; (Telescope g (f :.: g) xs -&gt; Telescope (f :.: g) (f :.: g) xs)
-&gt; Telescope g (f :.: g) xs
-&gt; f (Telescope g g xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). g x -&gt; (:.:) f g x)
-&gt; (forall (x :: k). (:.:) f g x -&gt; (:.:) f g x)
-&gt; Telescope g (f :.: g) xs
-&gt; Telescope (f :.: g) (f :.: g) xs
forall {k} (xs :: [k]) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
SListI xs =&gt;
(forall (x :: k). g x -&gt; g' x)
-&gt; (forall (x :: k). f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihmap"><span class="hs-identifier hs-var">bihmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (g x) -&gt; (:.:) f g x
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(f (g x) -&gt; (:.:) f g x) -&gt; (g x -&gt; f (g x)) -&gt; g x -&gt; (:.:) f g x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; f (g x)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(:.:) f g x -&gt; (:.:) f g x
forall (x :: k). (:.:) f g x -&gt; (:.:) f g x
forall a. a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679103085"><span class="annot"><span class="annottext">hctraverse' :: forall (c :: k -&gt; Constraint) (xs :: [k]) (g :: * -&gt; *)
       (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *) (f' :: k -&gt; *).
(AllN (Telescope g) c xs, Applicative g) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; Telescope g f xs
-&gt; g (Telescope g f' xs)
</span><a href="#local-6989586621679103085"><span class="hs-identifier hs-var hs-var hs-var hs-var">hctraverse'</span></a></span></span><span> </span><span id="local-6989586621679103087"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103087"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; g (g x))
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; Telescope g f xs
-&gt; g (Telescope g f' xs)
forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *) (xs :: [k]).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-var">bihctraverse'</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103087"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; g (g x)
forall (x :: k). c x =&gt; g x -&gt; g (g x)
forall a. a -&gt; g a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679103098"><span class="annot"><span class="annottext">htraverse' :: forall (xs :: [k]) (g :: * -&gt; *) (f :: k -&gt; *) (f' :: k -&gt; *).
(SListIN (Telescope g) xs, Applicative g) =&gt;
(forall (a :: k). f a -&gt; g (f' a))
-&gt; Telescope g f xs -&gt; g (Telescope g f' xs)
</span><a href="#local-6989586621679103098"><span class="hs-identifier hs-var hs-var hs-var hs-var">htraverse'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). g x -&gt; g (g x))
-&gt; (forall (a :: k). f a -&gt; g (f' a))
-&gt; Telescope g f xs
-&gt; g (Telescope g f' xs)
forall {k} (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m (g' x))
-&gt; (forall (x :: k). f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-var">bihtraverse'</span></a></span><span>    </span><span class="annot"><span class="annottext">g x -&gt; g (g x)
forall (x :: k). g x -&gt; g (g x)
forall a. a -&gt; g a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Specialization of 'hsequence'' with weaker constraints</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- ('Functor' rather than 'Applicative')</span><span>
</span><span id="line-131"></span><span class="annot"><a href="Data.SOP.Telescope.html#sequence"><span class="hs-identifier hs-type">sequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102094"><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679102095"><span class="annot"><a href="#local-6989586621679102095"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102096"><span class="annot"><a href="#local-6989586621679102096"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102097"><span class="annot"><a href="#local-6989586621679102097"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-132"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102095"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679102096"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102097"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102095"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102097"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span id="sequence"><span class="annot"><span class="annottext">sequence :: forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Functor m =&gt;
Telescope g (m :.: f) xs -&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#sequence"><span class="hs-identifier hs-var hs-var">sequence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g (m :.: f) xs -&gt; m (Telescope g f xs)
forall (xs' :: [k]).
Telescope g (m :.: f) xs' -&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103103"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679102103"><span class="annot"><a href="#local-6989586621679103103"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102095"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679102096"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102103"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102094"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102095"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102096"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102103"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679103103"><span class="annot"><span class="annottext">go :: forall (xs' :: [k]).
Telescope g (m :.: f) xs' -&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103103"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Comp</span></span><span> </span><span id="local-6989586621679103106"><span class="annot"><span class="annottext">m (f x)
</span><a href="#local-6989586621679103106"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Telescope g f xs'
f x -&gt; Telescope g f (x : xs)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; Telescope g f xs') -&gt; m (f x) -&gt; m (Telescope g f xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (f x)
</span><a href="#local-6989586621679103106"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="#local-6989586621679103103"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103110"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103110"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103111"><span class="annot"><span class="annottext">Telescope g (m :.: f) xs
</span><a href="#local-6989586621679103111"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103110"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f xs -&gt; Telescope g f xs')
-&gt; m (Telescope g f xs) -&gt; m (Telescope g f xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g (m :.: f) xs -&gt; m (Telescope g f xs)
forall (xs' :: [k]).
Telescope g (m :.: f) xs' -&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103103"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g (m :.: f) xs
</span><a href="#local-6989586621679103111"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679102146"><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102136"><span class="annot"><a href="#local-6989586621679102136"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679102137"><span class="annot"><a href="#local-6989586621679102137"><span class="hs-identifier hs-type">y</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LiftedCoercible</span></span><span> </span><span class="annot"><a href="#local-6989586621679102146"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102146"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102136"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102137"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTrans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102146"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102146"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679103131"><span class="annot"><span class="annottext">htrans :: forall (c :: k2 -&gt; k2 -&gt; Constraint) (xs :: [k2]) (ys :: [k2])
       (proxy :: (k2 -&gt; k2 -&gt; Constraint) -&gt; *) (f :: k2 -&gt; *)
       (g :: k2 -&gt; *).
AllZipN (Prod (Telescope g)) c xs ys =&gt;
proxy c
-&gt; (forall (x :: k2) (y :: k2). c x y =&gt; f x -&gt; g y)
-&gt; Telescope g f xs
-&gt; Telescope g g ys
</span><a href="#local-6989586621679103131"><span class="hs-identifier hs-var hs-var hs-var hs-var">htrans</span></a></span></span><span> </span><span id="local-6989586621679103133"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103133"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679103134"><span class="annot"><span class="annottext">forall (x :: k2) (y :: k2). c x y =&gt; f x -&gt; g y
</span><a href="#local-6989586621679103134"><span class="hs-identifier hs-var">transf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103141"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103141"><span class="hs-identifier hs-var">fx</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g (Head ys) -&gt; Telescope g g (Head ys : Tail ys)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(g (Head ys) -&gt; Telescope g g (Head ys : Tail ys))
-&gt; g (Head ys) -&gt; Telescope g g (Head ys : Tail ys)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g (Head ys)
forall (x :: k2) (y :: k2). c x y =&gt; f x -&gt; g y
</span><a href="#local-6989586621679103134"><span class="hs-identifier hs-var">transf</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103141"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103151"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103151"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103152"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103152"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g (Head ys)
-&gt; Telescope g g (Tail ys) -&gt; Telescope g g (Head ys : Tail ys)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g x -&gt; g (Head ys)
forall a b. Coercible a b =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Prim.html#coerce"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103151"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Telescope g g (Tail ys) -&gt; Telescope g g (Head ys : Tail ys))
-&gt; Telescope g g (Tail ys) -&gt; Telescope g g (Head ys : Tail ys)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (x :: k2) (y :: k2). c x y =&gt; f x -&gt; g y)
-&gt; Telescope g f xs
-&gt; Telescope g g (Tail ys)
forall k1 l1 k2 l2 (h1 :: (k1 -&gt; *) -&gt; l1 -&gt; *)
       (h2 :: (k2 -&gt; *) -&gt; l2 -&gt; *) (c :: k1 -&gt; k2 -&gt; Constraint)
       (xs :: l1) (ys :: l2) (proxy :: (k1 -&gt; k2 -&gt; Constraint) -&gt; *)
       (f :: k1 -&gt; *) (g :: k2 -&gt; *).
(HTrans h1 h2, AllZipN (Prod h1) c xs ys) =&gt;
proxy c
-&gt; (forall (x :: k1) (y :: k2). c x y =&gt; f x -&gt; g y)
-&gt; h1 f xs
-&gt; h2 g ys
forall (c :: k2 -&gt; k2 -&gt; Constraint) (xs :: [k2]) (ys :: [k2])
       (proxy :: (k2 -&gt; k2 -&gt; Constraint) -&gt; *) (f :: k2 -&gt; *)
       (g :: k2 -&gt; *).
AllZipN (Prod (Telescope g)) c xs ys =&gt;
proxy c
-&gt; (forall (x :: k2) (y :: k2). c x y =&gt; f x -&gt; g y)
-&gt; Telescope g f xs
-&gt; Telescope g g ys
</span><span class="hs-identifier hs-var">htrans</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103133"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g y
forall (x :: k2) (y :: k2). c x y =&gt; f x -&gt; g y
</span><a href="#local-6989586621679103134"><span class="hs-identifier hs-var">transf</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103152"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679103159"><span class="annot"><span class="annottext">hcoerce :: forall (f :: k2 -&gt; *) (g :: k2 -&gt; *) (xs :: [k2]) (ys :: [k2]).
AllZipN (Prod (Telescope g)) (LiftedCoercible f g) xs ys =&gt;
Telescope g f xs -&gt; Telescope g g ys
</span><a href="#local-6989586621679103159"><span class="hs-identifier hs-var hs-var hs-var hs-var">hcoerce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103168"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103168"><span class="hs-identifier hs-var">fx</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g (Head ys) -&gt; Telescope g g (Head ys : Tail ys)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(g (Head ys) -&gt; Telescope g g (Head ys : Tail ys))
-&gt; g (Head ys) -&gt; Telescope g g (Head ys : Tail ys)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g (Head ys)
forall a b. Coercible a b =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Prim.html#coerce"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103168"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103178"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103178"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103179"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103179"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g (Head ys)
-&gt; Telescope g g (Tail ys) -&gt; Telescope g g (Head ys : Tail ys)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g x -&gt; g (Head ys)
forall a b. Coercible a b =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Prim.html#coerce"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103178"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Telescope g g (Tail ys) -&gt; Telescope g g (Head ys : Tail ys))
-&gt; Telescope g g (Tail ys) -&gt; Telescope g g (Head ys : Tail ys)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; Telescope g g (Tail ys)
forall k1 l1 k2 l2 (h1 :: (k1 -&gt; *) -&gt; l1 -&gt; *)
       (h2 :: (k2 -&gt; *) -&gt; l2 -&gt; *) (f :: k1 -&gt; *) (g :: k2 -&gt; *)
       (xs :: l1) (ys :: l2).
(HTrans h1 h2, AllZipN (Prod h1) (LiftedCoercible f g) xs ys) =&gt;
h1 f xs -&gt; h2 g ys
forall (f :: k2 -&gt; *) (g :: k2 -&gt; *) (xs :: [k2]) (ys :: [k2]).
AllZipN (Prod (Telescope g)) (LiftedCoercible f g) xs ys =&gt;
Telescope g f xs -&gt; Telescope g g ys
</span><span class="hs-identifier hs-var">hcoerce</span></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103179"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Same"><span class="annot"><span class="hs-identifier hs-var">Same</span></span></span><span> </span><span id="local-6989586621679103180"><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103180"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103180"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Bifunctor analogues of class methods
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><span class="hs-comment">-- | Bifunctor analogue of 'hap'</span></span><span>
</span><span id="line-155"></span><span id="local-6989586621679102181"><span id="local-6989586621679102182"><span id="local-6989586621679102183"><span id="local-6989586621679102184"><span id="local-6989586621679102185"><span class="annot"><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-type">bihap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102181"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102182"><span class="hs-identifier hs-type">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102183"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102184"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102185"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102183"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102181"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102184"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102183"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102182"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102185"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102183"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span><span>
</span><span id="line-158"></span><span id="bihap"><span class="annot"><span class="annottext">bihap :: forall {k} (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var hs-var">bihap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679103181"><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
</span><a href="#local-6989586621679103181"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621679103182"><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
</span><a href="#local-6989586621679103182"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679103183"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103183"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
forall {k} (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]) (g' :: k -&gt; *)
       (f' :: k -&gt; *).
Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
</span><a href="#local-6989586621679103184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103183"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
</span><a href="#local-6989586621679103181"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
</span><a href="#local-6989586621679103182"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679102193"><span id="local-6989586621679102194"><span id="local-6989586621679102195"><span id="local-6989586621679102196"><span id="local-6989586621679102197"><span class="annot"><a href="#local-6989586621679103184"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102193"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102194"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102195"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-161"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102193"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102196"><span class="hs-identifier hs-type">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102195"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-162"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102194"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102197"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102195"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-163"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102196"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102197"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102195"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679103184"><span class="annot"><span class="annottext">go :: forall {k} (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]) (g' :: k -&gt; *)
       (f' :: k -&gt; *).
Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
</span><a href="#local-6989586621679103184"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103186"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103186"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621679103191"><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><a href="#local-6989586621679103191"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs1
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f' x -&gt; Telescope g' f' (x : xs)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f f' x -&gt; f x -&gt; f' x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><a href="#local-6989586621679103191"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621679103186"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="#local-6989586621679103184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103193"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103193"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103194"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103194"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679103201"><span class="annot"><span class="annottext">(-.-&gt;) g g' x
</span><a href="#local-6989586621679103201"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679103202"><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs1
</span><a href="#local-6989586621679103202"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f f' x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679103207"><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs1
</span><a href="#local-6989586621679103207"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g' x -&gt; Telescope g' f' xs -&gt; Telescope g' f' (x : xs)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) g g' x -&gt; g x -&gt; g' x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) g g' x
</span><a href="#local-6989586621679103201"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621679103193"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
forall {k} (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]) (g' :: k -&gt; *)
       (f' :: k -&gt; *).
Telescope g f xs
-&gt; NP (g -.-&gt; g') xs -&gt; NP (f -.-&gt; f') xs -&gt; Telescope g' f' xs
</span><a href="#local-6989586621679103184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103194"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
NP (g -.-&gt; g') xs1
</span><a href="#local-6989586621679103202"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; f') xs
NP (f -.-&gt; f') xs1
</span><a href="#local-6989586621679103207"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><span class="hs-comment">-- | Bifunctor analogue of 'hctraverse''</span></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-type">bihctraverse'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102072"><span class="annot"><a href="#local-6989586621679102072"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679102069"><span class="annot"><a href="#local-6989586621679102069"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679102071"><span class="annot"><a href="#local-6989586621679102071"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679102073"><span class="annot"><a href="#local-6989586621679102073"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102074"><span class="annot"><a href="#local-6989586621679102074"><span class="hs-identifier hs-type">g'</span></a></span></span><span> </span><span id="local-6989586621679102076"><span class="annot"><a href="#local-6989586621679102076"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102077"><span class="annot"><a href="#local-6989586621679102077"><span class="hs-identifier hs-type">f'</span></a></span></span><span> </span><span id="local-6989586621679102070"><span class="annot"><a href="#local-6989586621679102070"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621679102069"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102070"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102071"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102072"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102069"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-170"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102067"><span class="annot"><a href="#local-6989586621679102067"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102069"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102067"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102073"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102067"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102071"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102074"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102067"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102075"><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102069"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102076"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102071"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102077"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102075"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102073"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102076"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102070"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102071"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102074"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102077"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102070"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span id="bihctraverse%27"><span class="annot"><span class="annottext">bihctraverse' :: forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *) (xs :: [k]).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-var hs-var">bihctraverse'</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679103213"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; g x -&gt; m (g' x)
</span><a href="#local-6989586621679103213"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679103214"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; f x -&gt; m (f' x)
</span><a href="#local-6989586621679103214"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; m (Telescope g' f' xs)
forall (xs' :: [k]).
All c xs' =&gt;
Telescope g f xs' -&gt; m (Telescope g' f' xs')
</span><a href="#local-6989586621679103215"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679102223"><span class="annot"><a href="#local-6989586621679103215"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621679102069"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102223"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102073"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102076"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102223"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102071"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102074"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102077"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102223"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679103215"><span class="annot"><span class="annottext">go :: forall (xs' :: [k]).
All c xs' =&gt;
Telescope g f xs' -&gt; m (Telescope g' f' xs')
</span><a href="#local-6989586621679103215"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103224"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103224"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f' x -&gt; Telescope g' f' xs'
f' x -&gt; Telescope g' f' (x : xs)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(f' x -&gt; Telescope g' f' xs')
-&gt; m (f' x) -&gt; m (Telescope g' f' xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; m (f' x)
forall (x :: k). c x =&gt; f x -&gt; m (f' x)
</span><a href="#local-6989586621679103214"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103224"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="#local-6989586621679103215"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103233"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103233"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103234"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103234"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g' x -&gt; Telescope g' f' xs -&gt; Telescope g' f' xs'
g' x -&gt; Telescope g' f' xs -&gt; Telescope g' f' (x : xs)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">(g' x -&gt; Telescope g' f' xs -&gt; Telescope g' f' xs')
-&gt; m (g' x) -&gt; m (Telescope g' f' xs -&gt; Telescope g' f' xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">g x -&gt; m (g' x)
forall (x :: k). c x =&gt; g x -&gt; m (g' x)
</span><a href="#local-6989586621679103213"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103233"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">m (Telescope g' f' xs -&gt; Telescope g' f' xs')
-&gt; m (Telescope g' f' xs) -&gt; m (Telescope g' f' xs')
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; m (Telescope g' f' xs)
forall (xs' :: [k]).
All c xs' =&gt;
Telescope g f xs' -&gt; m (Telescope g' f' xs')
</span><a href="#local-6989586621679103215"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103234"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><span class="hs-comment">-- | Bifunctor analogue of 'htraverse''</span></span><span>
</span><span id="line-180"></span><span id="local-6989586621679102085"><span id="local-6989586621679102086"><span id="local-6989586621679102087"><span id="local-6989586621679102088"><span id="local-6989586621679102089"><span id="local-6989586621679102091"><span class="annot"><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-type">bihtraverse'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621679102085"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102086"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102083"><span class="annot"><a href="#local-6989586621679102083"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102087"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102083"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102086"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102088"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102083"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102090"><span class="annot"><a href="#local-6989586621679102090"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102089"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102090"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102086"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102091"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102090"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102087"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102089"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102085"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102086"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102088"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102091"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102085"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-184"></span><span id="bihtraverse%27"><span class="annot"><span class="annottext">bihtraverse' :: forall {k} (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m (g' x))
-&gt; (forall (x :: k). f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-var hs-var">bihtraverse'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Top
-&gt; (forall (x :: k). Top x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). Top x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *) (xs :: [k]).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-var">bihctraverse'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
forall (t :: k -&gt; Constraint). Proxy t
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Top</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><span class="hs-comment">-- | Bifunctor analogue of 'hsequence''</span></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Data.SOP.Telescope.html#bihsequence%27"><span class="hs-identifier hs-type">bihsequence'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102038"><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679102039"><span class="annot"><a href="#local-6989586621679102039"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102040"><span class="annot"><a href="#local-6989586621679102040"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102037"><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679102039"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679102040"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102038"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102039"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102040"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102037"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span id="bihsequence%27"><span class="annot"><span class="annottext">bihsequence' :: forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
(SListI xs, Applicative m) =&gt;
Telescope (m :.: g) (m :.: f) xs -&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#bihsequence%27"><span class="hs-identifier hs-var hs-var">bihsequence'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). (:.:) m g x -&gt; m (g x))
-&gt; (forall (x :: k). (:.:) m f x -&gt; m (f x))
-&gt; Telescope (m :.: g) (m :.: f) xs
-&gt; m (Telescope g f xs)
forall {k} (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m (g' x))
-&gt; (forall (x :: k). f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-var">bihtraverse'</span></a></span><span> </span><span class="annot"><span class="annottext">(:.:) m g x -&gt; m (g x)
forall (x :: k). (:.:) m g x -&gt; m (g x)
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">(:.:) m f x -&gt; m (f x)
forall (x :: k). (:.:) m f x -&gt; m (f x)
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><span class="hs-comment">-- | Bifunctor analogue of 'hctraverse_'</span></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-type">bihctraverse_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679101989"><span class="annot"><a href="#local-6989586621679101989"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679101986"><span class="annot"><a href="#local-6989586621679101986"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679101987"><span class="annot"><a href="#local-6989586621679101987"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span id="local-6989586621679101988"><span class="annot"><a href="#local-6989586621679101988"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679101990"><span class="annot"><a href="#local-6989586621679101990"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679101992"><span class="annot"><a href="#local-6989586621679101992"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621679101986"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101987"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101988"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101989"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101986"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-194"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679101984"><span class="annot"><a href="#local-6989586621679101984"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679101986"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101984"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101990"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101984"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101988"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679101991"><span class="annot"><a href="#local-6989586621679101991"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679101986"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101991"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101992"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101991"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101988"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101990"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101992"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101987"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101988"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span id="bihctraverse_"><span class="annot"><span class="annottext">bihctraverse_ :: forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-var hs-var">bihctraverse_</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679103250"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; g x -&gt; m ()
</span><a href="#local-6989586621679103250"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679103251"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; f x -&gt; m ()
</span><a href="#local-6989586621679103251"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; m ()
forall (xs' :: [k]). All c xs' =&gt; Telescope g f xs' -&gt; m ()
</span><a href="#local-6989586621679103252"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679102266"><span class="annot"><a href="#local-6989586621679103252"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621679101986"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102266"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101990"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679101992"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102266"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679101988"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679103252"><span class="annot"><span class="annottext">go :: forall (xs' :: [k]). All c xs' =&gt; Telescope g f xs' -&gt; m ()
</span><a href="#local-6989586621679103252"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103259"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103259"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; m ()
forall (x :: k). c x =&gt; f x -&gt; m ()
</span><a href="#local-6989586621679103251"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103259"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="#local-6989586621679103252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103267"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103267"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103268"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103268"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g x -&gt; m ()
forall (x :: k). c x =&gt; g x -&gt; m ()
</span><a href="#local-6989586621679103250"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103267"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m () -&gt; m ()
forall a b. m a -&gt; m b -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs -&gt; m ()
forall (xs' :: [k]). All c xs' =&gt; Telescope g f xs' -&gt; m ()
</span><a href="#local-6989586621679103252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103268"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span id="local-6989586621679102002"><span id="local-6989586621679102004"><span id="local-6989586621679102005"><span id="local-6989586621679102006"><span class="annot"><a href="Data.SOP.Telescope.html#bihtraverse_"><span class="hs-identifier hs-type">bihtraverse_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621679102002"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102004"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102000"><span class="annot"><a href="#local-6989586621679102000"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102005"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102000"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102004"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102007"><span class="annot"><a href="#local-6989586621679102007"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102006"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102007"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102004"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102005"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102006"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102002"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102004"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-207"></span><span id="bihtraverse_"><span class="annot"><span class="annottext">bihtraverse_ :: forall {k} (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m ())
-&gt; (forall (x :: k). f x -&gt; m ()) -&gt; Telescope g f xs -&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihtraverse_"><span class="hs-identifier hs-var hs-var">bihtraverse_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Top
-&gt; (forall (x :: k). Top x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). Top x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-var">bihctraverse_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
forall (t :: k -&gt; Constraint). Proxy t
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Top</span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Bifunctor analogues of derived functions
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- | Bifunctor analogue of 'hmap'</span></span><span>
</span><span id="line-214"></span><span id="local-6989586621679102047"><span id="local-6989586621679102048"><span id="local-6989586621679102049"><span id="local-6989586621679102050"><span id="local-6989586621679102051"><span class="annot"><a href="Data.SOP.Telescope.html#bihmap"><span class="hs-identifier hs-type">bihmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621679102047"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-215"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102044"><span class="annot"><a href="#local-6989586621679102044"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102048"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102044"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102049"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102044"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102045"><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102050"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102051"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102045"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102048"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102050"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102047"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102049"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102051"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102047"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span><span>
</span><span id="line-218"></span><span id="bihmap"><span class="annot"><span class="annottext">bihmap :: forall {k} (xs :: [k]) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
SListI xs =&gt;
(forall (x :: k). g x -&gt; g' x)
-&gt; (forall (x :: k). f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihmap"><span class="hs-identifier hs-var hs-var">bihmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Top
-&gt; (forall (x :: k). Top x =&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). Top x =&gt; f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
forall {k} (c :: k -&gt; Constraint) (xs :: [k])
       (proxy :: (k -&gt; Constraint) -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
All c xs =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). c x =&gt; f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihcmap"><span class="hs-identifier hs-var">bihcmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
forall (t :: k -&gt; Constraint). Proxy t
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Top</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><span class="hs-comment">-- | Bifunctor analogue of 'hcmap'</span></span><span>
</span><span id="line-221"></span><span id="local-6989586621679102292"><span id="local-6989586621679102293"><span id="local-6989586621679102294"><span id="local-6989586621679102295"><span id="local-6989586621679102296"><span id="local-6989586621679102297"><span id="local-6989586621679102298"><span class="annot"><a href="Data.SOP.Telescope.html#bihcmap"><span class="hs-identifier hs-type">bihcmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621679102292"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102293"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102294"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102292"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102289"><span class="annot"><a href="#local-6989586621679102289"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102292"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102289"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102295"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102289"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102296"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102289"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102290"><span class="annot"><a href="#local-6989586621679102290"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102292"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102290"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102297"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102290"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102298"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102290"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102295"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102297"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102293"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102296"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102298"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102293"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-226"></span><span id="bihcmap"><span class="annot"><span class="annottext">bihcmap :: forall {k} (c :: k -&gt; Constraint) (xs :: [k])
       (proxy :: (k -&gt; Constraint) -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
All c xs =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). c x =&gt; f x -&gt; f' x)
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihcmap"><span class="hs-identifier hs-var hs-var">bihcmap</span></a></span></span><span> </span><span id="local-6989586621679103285"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103285"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679103286"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; g x -&gt; g' x
</span><a href="#local-6989586621679103286"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679103287"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; f x -&gt; f' x
</span><a href="#local-6989586621679103287"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
forall {k} (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var">bihap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; (-.-&gt;) g g' a) -&gt; NP (g -.-&gt; g') xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(HPure h, AllN h c xs) =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; h f xs
forall (c :: k -&gt; Constraint) (xs :: [k])
       (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
AllN NP c xs =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; NP f xs
</span><span class="hs-identifier hs-var">hcpure</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103285"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g a -&gt; g' a) -&gt; (-.-&gt;) g g' a
forall {k} (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">g a -&gt; g' a
forall (x :: k). c x =&gt; g x -&gt; g' x
</span><a href="#local-6989586621679103286"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; (-.-&gt;) f f' a) -&gt; NP (f -.-&gt; f') xs
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(HPure h, AllN h c xs) =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; h f xs
forall (c :: k -&gt; Constraint) (xs :: [k])
       (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
AllN NP c xs =&gt;
proxy c -&gt; (forall (a :: k). c a =&gt; f a) -&gt; NP f xs
</span><span class="hs-identifier hs-var">hcpure</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103285"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
forall {k} (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f' a
forall (x :: k). c x =&gt; f x -&gt; f' x
</span><a href="#local-6989586621679103287"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><span class="hs-comment">-- | Bifunctor equivalent of 'hzipWith'</span></span><span>
</span><span id="line-229"></span><span id="local-6989586621679102322"><span id="local-6989586621679102323"><span id="local-6989586621679102325"><span id="local-6989586621679102326"><span id="local-6989586621679102328"><span id="local-6989586621679102329"><span class="annot"><a href="Data.SOP.Telescope.html#bihzipWith"><span class="hs-identifier hs-type">bihzipWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621679102322"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-230"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102324"><span class="annot"><a href="#local-6989586621679102324"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102323"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102324"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102325"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102324"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102326"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102324"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102327"><span class="annot"><a href="#local-6989586621679102327"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102323"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102327"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102327"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102329"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102327"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="annot"><a href="#local-6989586621679102323"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102322"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102325"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102322"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102326"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102329"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102322"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-233"></span><span id="bihzipWith"><span class="annot"><span class="annottext">bihzipWith :: forall {k} (xs :: [k]) (h :: k -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
SListI xs =&gt;
(forall (x :: k). h x -&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). h x -&gt; f x -&gt; f' x)
-&gt; NP h xs
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihzipWith"><span class="hs-identifier hs-var hs-var">bihzipWith</span></a></span></span><span> </span><span id="local-6989586621679103301"><span class="annot"><span class="annottext">forall (x :: k). h x -&gt; g x -&gt; g' x
</span><a href="#local-6989586621679103301"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679103302"><span class="annot"><span class="annottext">forall (x :: k). h x -&gt; f x -&gt; f' x
</span><a href="#local-6989586621679103302"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679103303"><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621679103303"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
forall {k} (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var">bihap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (a :: k). h a -&gt; (-.-&gt;) g g' a)
-&gt; NP h xs -&gt; NP (g -.-&gt; g') xs
forall {k} {l} (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g a -&gt; g' a) -&gt; (-.-&gt;) g g' a
forall {k} (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((g a -&gt; g' a) -&gt; (-.-&gt;) g g' a)
-&gt; (h a -&gt; g a -&gt; g' a) -&gt; h a -&gt; (-.-&gt;) g g' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a -&gt; g a -&gt; g' a
forall (x :: k). h x -&gt; g x -&gt; g' x
</span><a href="#local-6989586621679103301"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621679103303"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (a :: k). h a -&gt; (-.-&gt;) f f' a)
-&gt; NP h xs -&gt; NP (f -.-&gt; f') xs
forall {k} {l} (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
forall {k} (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((f a -&gt; f' a) -&gt; (-.-&gt;) f f' a)
-&gt; (h a -&gt; f a -&gt; f' a) -&gt; h a -&gt; (-.-&gt;) f f' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a -&gt; f a -&gt; f' a
forall (x :: k). h x -&gt; f x -&gt; f' x
</span><a href="#local-6989586621679103302"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621679103303"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><span class="hs-comment">-- | Bifunctor equivalent of 'hczipWith'</span></span><span>
</span><span id="line-236"></span><span id="local-6989586621679102348"><span id="local-6989586621679102349"><span id="local-6989586621679102350"><span id="local-6989586621679102352"><span id="local-6989586621679102353"><span id="local-6989586621679102354"><span id="local-6989586621679102356"><span id="local-6989586621679102357"><span class="annot"><a href="Data.SOP.Telescope.html#bihczipWith"><span class="hs-identifier hs-type">bihczipWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621679102348"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102349"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102350"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102348"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-238"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102351"><span class="annot"><a href="#local-6989586621679102351"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102348"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102351"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102352"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102351"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102353"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102351"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102354"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102351"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102355"><span class="annot"><a href="#local-6989586621679102355"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679102348"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102355"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102352"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102355"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102356"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102355"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102357"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102355"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="annot"><a href="#local-6989586621679102352"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102349"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102353"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102356"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102349"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102354"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102357"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102349"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-241"></span><span id="bihczipWith"><span class="annot"><span class="annottext">bihczipWith :: forall {k} (c :: k -&gt; Constraint) (xs :: [k])
       (proxy :: (k -&gt; Constraint) -&gt; *) (h :: k -&gt; *) (g :: k -&gt; *)
       (g' :: k -&gt; *) (f :: k -&gt; *) (f' :: k -&gt; *).
All c xs =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; h x -&gt; g x -&gt; g' x)
-&gt; (forall (x :: k). c x =&gt; h x -&gt; f x -&gt; f' x)
-&gt; NP h xs
-&gt; Telescope g f xs
-&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihczipWith"><span class="hs-identifier hs-var hs-var">bihczipWith</span></a></span></span><span> </span><span id="local-6989586621679103310"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103310"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679103311"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; h x -&gt; g x -&gt; g' x
</span><a href="#local-6989586621679103311"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679103312"><span class="annot"><span class="annottext">forall (x :: k). c x =&gt; h x -&gt; f x -&gt; f' x
</span><a href="#local-6989586621679103312"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679103313"><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621679103313"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
forall {k} (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var">bihap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; h a -&gt; (-.-&gt;) g g' a)
-&gt; NP h xs
-&gt; NP (g -.-&gt; g') xs
forall {k} {l} (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103310"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(g a -&gt; g' a) -&gt; (-.-&gt;) g g' a
forall {k} (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((g a -&gt; g' a) -&gt; (-.-&gt;) g g' a)
-&gt; (h a -&gt; g a -&gt; g' a) -&gt; h a -&gt; (-.-&gt;) g g' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a -&gt; g a -&gt; g' a
forall (x :: k). c x =&gt; h x -&gt; g x -&gt; g' x
</span><a href="#local-6989586621679103311"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621679103313"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; h a -&gt; (-.-&gt;) f f' a)
-&gt; NP h xs
-&gt; NP (f -.-&gt; f') xs
forall {k} {l} (h :: (k -&gt; *) -&gt; l -&gt; *) (c :: k -&gt; Constraint)
       (xs :: l) (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(AllN (Prod h) c xs, HAp h) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hcmap</span></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103310"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
forall {k} (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((f a -&gt; f' a) -&gt; (-.-&gt;) f f' a)
-&gt; (h a -&gt; f a -&gt; f' a) -&gt; h a -&gt; (-.-&gt;) f f' a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a -&gt; f a -&gt; f' a
forall (x :: k). c x =&gt; h x -&gt; f x -&gt; f' x
</span><a href="#local-6989586621679103312"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP h xs
</span><a href="#local-6989586621679103313"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Simple telescope

  This is an internal type that is useful primarily useful as a sanity check
  of our bifunctor generalizations.
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><span class="hs-comment">-- | 'Telescope' with both functors set to the same @f@</span></span><span>
</span><span id="line-251"></span><span class="hs-keyword">newtype</span><span> </span><span id="SimpleTelescope"><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span></span><span> </span><span id="local-6989586621679102379"><span class="annot"><a href="#local-6989586621679102379"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102380"><span class="annot"><a href="#local-6989586621679102380"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SimpleTelescope"><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-252"></span><span>      </span><span id="getSimpleTelescope"><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var hs-var">getSimpleTelescope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102379"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102379"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102380"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Prod"><span class="annot"><span class="hs-identifier hs-var">Prod</span></span></span><span>       </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span>
</span><span id="line-256"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="SListIN"><span class="annot"><span class="hs-identifier hs-var">SListIN</span></span></span><span>    </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span>
</span><span id="line-257"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="AllN"><span class="annot"><span class="hs-identifier hs-var">AllN</span></span></span><span>       </span><span id="local-6989586621679103320"><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103320"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="annot"><a href="#local-6989586621679103320"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-258"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="CollapseTo"><span class="annot"><span class="hs-identifier hs-var">CollapseTo</span></span></span><span> </span><span id="local-6989586621679103321"><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103321"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679103321"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HAp</span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679103330"><span class="annot"><span class="annottext">hap :: forall (f :: k -&gt; *) (g :: k -&gt; *) (xs :: [k]).
Prod SimpleTelescope (f -.-&gt; g) xs
-&gt; SimpleTelescope f xs -&gt; SimpleTelescope g xs
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hap</span></span></span><span> </span><span id="local-6989586621679103331"><span class="annot"><span class="annottext">Prod SimpleTelescope (f -.-&gt; g) xs
</span><a href="#local-6989586621679103331"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g g xs -&gt; SimpleTelescope g xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g g xs -&gt; SimpleTelescope g xs)
-&gt; (SimpleTelescope f xs -&gt; Telescope g g xs)
-&gt; SimpleTelescope f xs
-&gt; SimpleTelescope g xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; g) xs
-&gt; NP (f -.-&gt; g) xs -&gt; Telescope f f xs -&gt; Telescope g g xs
forall {k} (g :: k -&gt; *) (g' :: k -&gt; *) (xs :: [k]) (f :: k -&gt; *)
       (f' :: k -&gt; *).
NP (g -.-&gt; g') xs
-&gt; NP (f -.-&gt; f') xs -&gt; Telescope g f xs -&gt; Telescope g' f' xs
</span><a href="Data.SOP.Telescope.html#bihap"><span class="hs-identifier hs-var">bihap</span></a></span><span> </span><span class="annot"><span class="annottext">Prod SimpleTelescope (f -.-&gt; g) xs
NP (f -.-&gt; g) xs
</span><a href="#local-6989586621679103331"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Prod SimpleTelescope (f -.-&gt; g) xs
NP (f -.-&gt; g) xs
</span><a href="#local-6989586621679103331"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; Telescope g g xs)
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; Telescope g g xs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTraverse_</span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679103340"><span class="annot"><span class="annottext">hctraverse_ :: forall (c :: k -&gt; Constraint) (xs :: [k]) (g :: * -&gt; *)
       (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *).
(AllN SimpleTelescope c xs, Applicative g) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; SimpleTelescope f xs
-&gt; g ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hctraverse_</span></span></span><span> </span><span id="local-6989586621679103341"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103341"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679103342"><span class="annot"><span class="annottext">forall (a :: k). c a =&gt; f a -&gt; g ()
</span><a href="#local-6989586621679103342"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g ())
-&gt; Telescope f f xs
-&gt; g ()
forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m ())
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m ())
-&gt; Telescope g f xs
-&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihctraverse_"><span class="hs-identifier hs-var">bihctraverse_</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103341"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g ()
forall (a :: k). c a =&gt; f a -&gt; g ()
</span><a href="#local-6989586621679103342"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g ()
forall (a :: k). c a =&gt; f a -&gt; g ()
</span><a href="#local-6989586621679103342"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; g ())
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; g ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679103352"><span class="annot"><span class="annottext">htraverse_ :: forall (xs :: [k]) (g :: * -&gt; *) (f :: k -&gt; *).
(SListIN SimpleTelescope xs, Applicative g) =&gt;
(forall (a :: k). f a -&gt; g ()) -&gt; SimpleTelescope f xs -&gt; g ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">htraverse_</span></span></span><span>    </span><span id="local-6989586621679103353"><span class="annot"><span class="annottext">forall (a :: k). f a -&gt; g ()
</span><a href="#local-6989586621679103353"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (a :: k). f a -&gt; g ())
-&gt; (forall (a :: k). f a -&gt; g ()) -&gt; Telescope f f xs -&gt; g ()
forall {k} (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m ())
-&gt; (forall (x :: k). f x -&gt; m ()) -&gt; Telescope g f xs -&gt; m ()
</span><a href="Data.SOP.Telescope.html#bihtraverse_"><span class="hs-identifier hs-var">bihtraverse_</span></a></span><span>    </span><span class="annot"><span class="annottext">f x -&gt; g ()
forall (a :: k). f a -&gt; g ()
</span><a href="#local-6989586621679103353"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g ()
forall (a :: k). f a -&gt; g ()
</span><a href="#local-6989586621679103353"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; g ())
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; g ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HSequence</span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679103367"><span class="annot"><span class="annottext">hsequence' :: forall (xs :: [k]) (f :: * -&gt; *) (g :: k -&gt; *).
(SListIN SimpleTelescope xs, Applicative f) =&gt;
SimpleTelescope (f :.: g) xs -&gt; f (SimpleTelescope g xs)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hsequence'</span></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope g g xs -&gt; SimpleTelescope g xs)
-&gt; f (Telescope g g xs) -&gt; f (SimpleTelescope g xs)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g g xs -&gt; SimpleTelescope g xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Telescope g g xs) -&gt; f (SimpleTelescope g xs))
-&gt; (SimpleTelescope (f :.: g) xs -&gt; f (Telescope g g xs))
-&gt; SimpleTelescope (f :.: g) xs
-&gt; f (SimpleTelescope g xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (f :.: g) (f :.: g) xs -&gt; f (Telescope g g xs)
forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
(SListI xs, Applicative m) =&gt;
Telescope (m :.: g) (m :.: f) xs -&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#bihsequence%27"><span class="hs-identifier hs-var">bihsequence'</span></a></span><span>        </span><span class="annot"><span class="annottext">(Telescope (f :.: g) (f :.: g) xs -&gt; f (Telescope g g xs))
-&gt; (SimpleTelescope (f :.: g) xs
    -&gt; Telescope (f :.: g) (f :.: g) xs)
-&gt; SimpleTelescope (f :.: g) xs
-&gt; f (Telescope g g xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope (f :.: g) xs -&gt; Telescope (f :.: g) (f :.: g) xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679103375"><span class="annot"><span class="annottext">hctraverse' :: forall (c :: k -&gt; Constraint) (xs :: [k]) (g :: * -&gt; *)
       (proxy :: (k -&gt; Constraint) -&gt; *) (f :: k -&gt; *) (f' :: k -&gt; *).
(AllN SimpleTelescope c xs, Applicative g) =&gt;
proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; SimpleTelescope f xs
-&gt; g (SimpleTelescope f' xs)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hctraverse'</span></span></span><span> </span><span id="local-6989586621679103376"><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103376"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679103377"><span class="annot"><span class="annottext">forall (a :: k). c a =&gt; f a -&gt; g (f' a)
</span><a href="#local-6989586621679103377"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope f' f' xs -&gt; SimpleTelescope f' xs)
-&gt; g (Telescope f' f' xs) -&gt; g (SimpleTelescope f' xs)
forall a b. (a -&gt; b) -&gt; g a -&gt; g b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope f' f' xs -&gt; SimpleTelescope f' xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(g (Telescope f' f' xs) -&gt; g (SimpleTelescope f' xs))
-&gt; (SimpleTelescope f xs -&gt; g (Telescope f' f' xs))
-&gt; SimpleTelescope f xs
-&gt; g (SimpleTelescope f' xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; (forall (a :: k). c a =&gt; f a -&gt; g (f' a))
-&gt; Telescope f f xs
-&gt; g (Telescope f' f' xs)
forall {k} (proxy :: (k -&gt; Constraint) -&gt; *) (c :: k -&gt; Constraint)
       (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *) (f :: k -&gt; *)
       (f' :: k -&gt; *) (xs :: [k]).
(All c xs, Applicative m) =&gt;
proxy c
-&gt; (forall (x :: k). c x =&gt; g x -&gt; m (g' x))
-&gt; (forall (x :: k). c x =&gt; f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihctraverse%27"><span class="hs-identifier hs-var">bihctraverse'</span></a></span><span> </span><span class="annot"><span class="annottext">proxy c
</span><a href="#local-6989586621679103376"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g (f' x)
forall (a :: k). c a =&gt; f a -&gt; g (f' a)
</span><a href="#local-6989586621679103377"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g (f' x)
forall (a :: k). c a =&gt; f a -&gt; g (f' a)
</span><a href="#local-6989586621679103377"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; g (Telescope f' f' xs))
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; g (Telescope f' f' xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621679103389"><span class="annot"><span class="annottext">htraverse' :: forall (xs :: [k]) (g :: * -&gt; *) (f :: k -&gt; *) (f' :: k -&gt; *).
(SListIN SimpleTelescope xs, Applicative g) =&gt;
(forall (a :: k). f a -&gt; g (f' a))
-&gt; SimpleTelescope f xs -&gt; g (SimpleTelescope f' xs)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">htraverse'</span></span></span><span>    </span><span id="local-6989586621679103390"><span class="annot"><span class="annottext">forall (a :: k). f a -&gt; g (f' a)
</span><a href="#local-6989586621679103390"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Telescope f' f' xs -&gt; SimpleTelescope f' xs)
-&gt; g (Telescope f' f' xs) -&gt; g (SimpleTelescope f' xs)
forall a b. (a -&gt; b) -&gt; g a -&gt; g b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope f' f' xs -&gt; SimpleTelescope f' xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
Telescope f f xs -&gt; SimpleTelescope f xs
</span><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-var">SimpleTelescope</span></a></span><span> </span><span class="annot"><span class="annottext">(g (Telescope f' f' xs) -&gt; g (SimpleTelescope f' xs))
-&gt; (SimpleTelescope f xs -&gt; g (Telescope f' f' xs))
-&gt; SimpleTelescope f xs
-&gt; g (SimpleTelescope f' xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (a :: k). f a -&gt; g (f' a))
-&gt; (forall (a :: k). f a -&gt; g (f' a))
-&gt; Telescope f f xs
-&gt; g (Telescope f' f' xs)
forall {k} (xs :: [k]) (m :: * -&gt; *) (g :: k -&gt; *) (g' :: k -&gt; *)
       (f :: k -&gt; *) (f' :: k -&gt; *).
(SListI xs, Applicative m) =&gt;
(forall (x :: k). g x -&gt; m (g' x))
-&gt; (forall (x :: k). f x -&gt; m (f' x))
-&gt; Telescope g f xs
-&gt; m (Telescope g' f' xs)
</span><a href="Data.SOP.Telescope.html#bihtraverse%27"><span class="hs-identifier hs-var">bihtraverse'</span></a></span><span>    </span><span class="annot"><span class="annottext">f x -&gt; g (f' x)
forall (a :: k). f a -&gt; g (f' a)
</span><a href="#local-6989586621679103390"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; g (f' x)
forall (a :: k). f a -&gt; g (f' a)
</span><a href="#local-6989586621679103390"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope f f xs -&gt; g (Telescope f' f' xs))
-&gt; (SimpleTelescope f xs -&gt; Telescope f f xs)
-&gt; SimpleTelescope f xs
-&gt; g (Telescope f' f' xs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleTelescope f xs -&gt; Telescope f f xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
SimpleTelescope f xs -&gt; Telescope f f xs
</span><a href="Data.SOP.Telescope.html#getSimpleTelescope"><span class="hs-identifier hs-var">getSimpleTelescope</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HCollapse</span></span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621679103395"><span class="annot"><span class="annottext">hcollapse :: forall (xs :: [k]) a.
SListIN SimpleTelescope xs =&gt;
SimpleTelescope (K a) xs -&gt; CollapseTo SimpleTelescope a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hcollapse</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#SimpleTelescope"><span class="hs-identifier hs-type">SimpleTelescope</span></a></span><span> </span><span id="local-6989586621679103396"><span class="annot"><span class="annottext">Telescope (K a) (K a) xs
</span><a href="#local-6989586621679103396"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K a) xs -&gt; [a]
forall {k} a (xs :: [k]). Telescope (K a) (K a) xs -&gt; [a]
</span><a href="#local-6989586621679103397"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K a) xs
</span><a href="#local-6989586621679103396"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>      </span><span id="local-6989586621679102439"><span id="local-6989586621679102440"><span class="annot"><a href="#local-6989586621679103397"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="#local-6989586621679102439"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="#local-6989586621679102439"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102440"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679102439"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-276"></span><span>      </span><span id="local-6989586621679103397"><span class="annot"><span class="annottext">go :: forall {k} a (xs :: [k]). Telescope (K a) (K a) xs -&gt; [a]
</span><a href="#local-6989586621679103397"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621679103400"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679103400"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679103400"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><a href="#local-6989586621679103397"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621679103402"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679103402"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679103403"><span class="annot"><span class="annottext">Telescope (K a) (K a) xs
</span><a href="#local-6989586621679103403"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679103402"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K a) xs -&gt; [a]
forall {k} a (xs :: [k]). Telescope (K a) (K a) xs -&gt; [a]
</span><a href="#local-6989586621679103397"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K a) xs
</span><a href="#local-6989586621679103403"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Utilities
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span id="local-6989586621679102449"><span id="local-6989586621679102450"><span id="local-6989586621679102451"><span class="annot"><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-type">tip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102449"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102450"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102451"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="annot"><a href="#local-6989586621679102450"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102451"><span class="hs-identifier hs-type">xs</span></a></span></span></span></span><span>
</span><span id="line-284"></span><span id="tip"><span class="annot"><span class="annottext">tip :: forall {k} (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Telescope g f xs -&gt; NS f xs
</span><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var hs-var">tip</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span>   </span><span id="local-6989586621679103405"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103405"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; NS f (x : xs)
forall {k} (f :: k -&gt; *) (x :: k) (xs1 :: [k]).
f x -&gt; NS f (x : xs1)
</span><span class="hs-identifier hs-var">Z</span></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103405"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-285"></span><span class="annot"><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679103408"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103408"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS f xs -&gt; NS f (x : xs)
forall {k} (f :: k -&gt; *) (xs1 :: [k]) (x :: k).
NS f xs1 -&gt; NS f (x : xs1)
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NS f xs
forall {k} (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Telescope g f xs -&gt; NS f xs
</span><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103408"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span id="local-6989586621679102468"><span id="local-6989586621679102469"><span class="annot"><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-type">fromTip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="annot"><a href="#local-6989586621679102468"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102469"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102468"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102469"><span class="hs-identifier hs-type">xs</span></a></span></span></span><span>
</span><span id="line-288"></span><span id="fromTip"><span class="annot"><span class="annottext">fromTip :: forall {k} (f :: k -&gt; *) (xs :: [k]).
NS f xs -&gt; Telescope (K ()) f xs
</span><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-var hs-var">fromTip</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span id="local-6989586621679103411"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103411"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x -&gt; Telescope (K ()) f (x : xs1)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103411"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-var">fromTip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span id="local-6989586621679103413"><span class="annot"><span class="annottext">NS f xs1
</span><a href="#local-6989586621679103413"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">K () x -&gt; Telescope (K ()) f xs1 -&gt; Telescope (K ()) f (x : xs1)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; K () x
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NS f xs1 -&gt; Telescope (K ()) f xs1
forall {k} (f :: k -&gt; *) (xs :: [k]).
NS f xs -&gt; Telescope (K ()) f xs
</span><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-var">fromTip</span></a></span><span> </span><span class="annot"><span class="annottext">NS f xs1
</span><a href="#local-6989586621679103413"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span id="local-6989586621679102480"><span id="local-6989586621679102481"><span class="annot"><a href="Data.SOP.Telescope.html#toAtMost"><span class="hs-identifier hs-type">toAtMost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="#local-6989586621679102480"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102480"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102481"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Counting.html#AtMost"><span class="hs-identifier hs-type">AtMost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102481"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102480"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-292"></span><span id="toAtMost"><span class="annot"><span class="annottext">toAtMost :: forall a (xs :: [*]).
Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
</span><a href="Data.SOP.Telescope.html#toAtMost"><span class="hs-identifier hs-var hs-var">toAtMost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
forall a (xs :: [*]).
Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
</span><a href="#local-6989586621679103414"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679103415"><span id="local-6989586621679103416"><span class="annot"><a href="#local-6989586621679103414"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="#local-6989586621679103415"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103415"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679103416"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Counting.html#AtMost"><span class="hs-identifier hs-type">AtMost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103416"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103415"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679103414"><span class="annot"><span class="annottext">go :: forall a (xs :: [*]).
Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
</span><a href="#local-6989586621679103414"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621679103418"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679103418"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AtMost xs a -&gt; (a -&gt; AtMost xs a) -&gt; Maybe a -&gt; AtMost xs a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">AtMost xs a
forall (xs :: [*]) a. AtMost xs a
</span><a href="Data.SOP.Counting.html#AtMostNil"><span class="hs-identifier hs-var">AtMostNil</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; AtMost xs a
a -&gt; AtMost (x : xs) a
forall a x (xs :: [*]). a -&gt; AtMost (x : xs) a
</span><a href="Data.SOP.Counting.html#atMostOne"><span class="hs-identifier hs-var">atMostOne</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679103418"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="#local-6989586621679103414"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span id="local-6989586621679103423"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679103423"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679103424"><span class="annot"><span class="annottext">Telescope (K a) (K (Maybe a)) xs
</span><a href="#local-6989586621679103424"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; AtMost xs a -&gt; AtMost (x : xs) a
forall a (xs1 :: [*]) x. a -&gt; AtMost xs1 a -&gt; AtMost (x : xs1) a
</span><a href="Data.SOP.Counting.html#AtMostCons"><span class="hs-identifier hs-var">AtMostCons</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679103423"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
forall a (xs :: [*]).
Telescope (K a) (K (Maybe a)) xs -&gt; AtMost xs a
</span><a href="#local-6989586621679103414"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope (K a) (K (Maybe a)) xs
</span><a href="#local-6989586621679103424"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span id="local-6989586621679102501"><span id="local-6989586621679102502"><span id="local-6989586621679102503"><span class="annot"><a href="Data.SOP.Telescope.html#fromTZ"><span class="hs-identifier hs-type">fromTZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102501"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102502"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679102503"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102502"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102503"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-299"></span><span id="fromTZ"><span class="annot"><span class="annottext">fromTZ :: forall {k} (g :: k -&gt; *) (f :: k -&gt; *) (x :: k).
Telescope g f '[x] -&gt; f x
</span><a href="Data.SOP.Telescope.html#fromTZ"><span class="hs-identifier hs-var hs-var">fromTZ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103429"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103429"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621679103429"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Extension and retraction
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-keyword">newtype</span><span> </span><span id="Extend"><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-var">Extend</span></a></span></span><span> </span><span id="local-6989586621679102511"><span class="annot"><a href="#local-6989586621679102511"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679102512"><span class="annot"><a href="#local-6989586621679102512"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102513"><span class="annot"><a href="#local-6989586621679102513"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102514"><span class="annot"><a href="#local-6989586621679102514"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679102515"><span class="annot"><a href="#local-6989586621679102515"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Extend"><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-var">Extend</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="extendWith"><span class="annot"><span class="annottext">forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (x :: k)
       (y :: k).
Extend m g f x y -&gt; f x -&gt; m (g x, f y)
</span><a href="Data.SOP.Telescope.html#extendWith"><span class="hs-identifier hs-var hs-var">extendWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679102513"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102514"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102511"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102512"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102514"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679102513"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102515"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Extend the telescope</span><span>
</span><span id="line-308"></span><span class="hs-comment">--</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- We will not attempt to extend the telescope past its final segment.</span><span>
</span><span id="line-310"></span><span class="annot"><a href="Data.SOP.Telescope.html#extend"><span class="hs-identifier hs-type">extend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102524"><span class="annot"><a href="#local-6989586621679102524"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679102525"><span class="annot"><a href="#local-6989586621679102525"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679102526"><span class="annot"><a href="#local-6989586621679102526"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102527"><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102529"><span class="annot"><a href="#local-6989586621679102529"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102524"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-311"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102525"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102526"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102529"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ How to extend</span></span><span>
</span><span id="line-312"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679102525"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102529"><span class="hs-identifier hs-type">xs</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Where to extend /from/</span></span><span>
</span><span id="line-313"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102526"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102529"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102526"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102529"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span id="extend"><span class="annot"><span class="annottext">extend :: forall {k} (m :: * -&gt; *) (h :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]).
Monad m =&gt;
InPairs (Requiring h (Extend m g f)) xs
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#extend"><span class="hs-identifier hs-var hs-var">extend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) xs
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall (xs' :: [k]).
InPairs (Requiring h (Extend m g f)) xs'
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103436"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679102538"><span class="annot"><a href="#local-6989586621679103436"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102525"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102526"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102538"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-317"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679102525"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102538"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-318"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102526"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102538"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102526"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102527"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102538"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679103436"><span class="annot"><span class="annottext">go :: forall (xs' :: [k]).
InPairs (Requiring h (Extend m g f)) xs'
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103436"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) xs'
</span><a href="Data.SOP.InPairs.html#PNil"><span class="hs-identifier hs-var">PNil</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103444"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103444"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-320"></span><span>        </span><span class="annot"><span class="annottext">Telescope g f xs' -&gt; m (Telescope g f xs')
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Telescope g f '[x]
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103444"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><a href="#local-6989586621679103436"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span id="local-6989586621679103447"><span class="annot"><span class="annottext">Requiring h (Extend m g f) x y
</span><a href="#local-6989586621679103447"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679103448"><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
</span><a href="#local-6989586621679103448"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679103455"><span class="annot"><span class="annottext">(-.-&gt;) f (Maybe :.: h) x
</span><a href="#local-6989586621679103455"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679103456"><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs1
</span><a href="#local-6989586621679103456"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103464"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103464"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-322"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(:.:) Maybe h x -&gt; Maybe (h x)
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="annot"><span class="annottext">((:.:) Maybe h x -&gt; Maybe (h x)) -&gt; (:.:) Maybe h x -&gt; Maybe (h x)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (Maybe :.: h) x -&gt; f x -&gt; (:.:) Maybe h x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (Maybe :.: h) x
</span><a href="#local-6989586621679103455"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621679103464"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>          </span><span class="annot"><span class="annottext">Maybe (h x)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><span class="annottext">Telescope g f xs' -&gt; m (Telescope g f xs')
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Telescope g f (x : y : zs)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103464"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>          </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679103465"><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621679103465"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679103466"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103466"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679103467"><span class="annot"><span class="annottext">f y
</span><a href="#local-6989586621679103467"><span class="hs-identifier hs-var">fy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extend m g f x y -&gt; f x -&gt; m (g x, f y)
forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (x :: k)
       (y :: k).
Extend m g f x y -&gt; f x -&gt; m (g x, f y)
</span><a href="Data.SOP.Telescope.html#extendWith"><span class="hs-identifier hs-var">extendWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Requiring h (Extend m g f) x y -&gt; h x -&gt; Extend m g f x y
forall {k1} {k2} (h :: k1 -&gt; *) (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
Requiring h f x y -&gt; h x -&gt; f x y
</span><a href="Data.SOP.InPairs.html#provide"><span class="hs-identifier hs-var">provide</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring h (Extend m g f) x y
</span><a href="#local-6989586621679103447"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">h x
h x
</span><a href="#local-6989586621679103465"><span class="hs-identifier hs-var">hx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621679103464"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-327"></span><span>            </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f (y : zs) -&gt; Telescope g f (x : y : zs)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103466"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f (y : zs) -&gt; Telescope g f xs')
-&gt; m (Telescope g f (y : zs)) -&gt; m (Telescope g f xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
-&gt; NP (f -.-&gt; (Maybe :.: h)) (y : zs)
-&gt; Telescope g f (y : zs)
-&gt; m (Telescope g f (y : zs))
forall (xs' :: [k]).
InPairs (Requiring h (Extend m g f)) xs'
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103436"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
</span><a href="#local-6989586621679103448"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs1
NP (f -.-&gt; (Maybe :.: h)) (y : zs)
</span><a href="#local-6989586621679103456"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f y -&gt; Telescope g f (y : zs)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f y
</span><a href="#local-6989586621679103467"><span class="hs-identifier hs-var">fy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="#local-6989586621679103436"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring h (Extend m g f) x y
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679103470"><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
</span><a href="#local-6989586621679103470"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f (Maybe :.: h) x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679103475"><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs1
</span><a href="#local-6989586621679103475"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103483"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103483"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103484"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103484"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f (y : zs) -&gt; Telescope g f (x : y : zs)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103483"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f (y : zs) -&gt; Telescope g f xs')
-&gt; m (Telescope g f (y : zs)) -&gt; m (Telescope g f xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
-&gt; NP (f -.-&gt; (Maybe :.: h)) (y : zs)
-&gt; Telescope g f (y : zs)
-&gt; m (Telescope g f (y : zs))
forall (xs' :: [k]).
InPairs (Requiring h (Extend m g f)) xs'
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103436"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring h (Extend m g f)) (y : zs)
</span><a href="#local-6989586621679103470"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; (Maybe :.: h)) xs1
NP (f -.-&gt; (Maybe :.: h)) (y : zs)
</span><a href="#local-6989586621679103475"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
Telescope g f (y : zs)
</span><a href="#local-6989586621679103484"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-keyword">newtype</span><span> </span><span id="Retract"><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-var">Retract</span></a></span></span><span> </span><span id="local-6989586621679102565"><span class="annot"><a href="#local-6989586621679102565"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679102566"><span class="annot"><a href="#local-6989586621679102566"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102567"><span class="annot"><a href="#local-6989586621679102567"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102568"><span class="annot"><a href="#local-6989586621679102568"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679102569"><span class="annot"><a href="#local-6989586621679102569"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Retract"><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-var">Retract</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="retractWith"><span class="annot"><span class="annottext">forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (x :: k)
       (y :: k).
Retract m g f x y -&gt; g x -&gt; f y -&gt; m (f x)
</span><a href="Data.SOP.Telescope.html#retractWith"><span class="hs-identifier hs-var hs-var">retractWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679102566"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102568"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102567"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102569"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102565"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102567"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102568"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><span class="hs-comment">-- | Retract a telescope</span></span><span>
</span><span id="line-334"></span><span class="annot"><a href="Data.SOP.Telescope.html#retract"><span class="hs-identifier hs-type">retract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102578"><span class="annot"><a href="#local-6989586621679102578"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679102579"><span class="annot"><a href="#local-6989586621679102579"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679102580"><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102581"><span class="annot"><a href="#local-6989586621679102581"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102582"><span class="annot"><a href="#local-6989586621679102582"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102578"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102579"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102581"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102582"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ How to retract</span></span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679102579"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102582"><span class="hs-identifier hs-type">xs</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Where to retract /to/</span></span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102581"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102582"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102581"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102582"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span id="retract"><span class="annot"><span class="annottext">retract :: forall {k} (m :: * -&gt; *) (h :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]).
Monad m =&gt;
Tails (Requiring h (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#retract"><span class="hs-identifier hs-var hs-var">retract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679103490"><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
</span><a href="#local-6989586621679103490"><span class="hs-identifier hs-var">tails</span></a></span></span><span> </span><span id="local-6989586621679103491"><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621679103491"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>       </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall {k} (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">npToSListI</span></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621679103491"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
 -&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall (xs' :: [k]).
SListI xs' =&gt;
Tails (Requiring h (Retract m g f)) xs'
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103495"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs
</span><a href="#local-6989586621679103490"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs
</span><a href="#local-6989586621679103491"><span class="hs-identifier hs-var">np</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679102594"><span class="annot"><a href="#local-6989586621679103495"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621679102594"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-343"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102579"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102581"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102594"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-344"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><a href="#local-6989586621679102579"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102594"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-345"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102581"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102594"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102580"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102581"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102594"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679103495"><span class="annot"><span class="annottext">go :: forall (xs' :: [k]).
SListI xs' =&gt;
Tails (Requiring h (Retract m g f)) xs'
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103495"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs'
</span><span class="hs-identifier">_</span></span><span>            </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs'
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103500"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103500"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs' -&gt; m (Telescope g f xs')
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f xs' -&gt; m (Telescope g f xs'))
-&gt; Telescope g f xs' -&gt; m (Telescope g f xs')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; Telescope g f (x : xs)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103500"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="#local-6989586621679103495"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#TCons"><span class="hs-identifier hs-type">TCons</span></a></span><span> </span><span id="local-6989586621679103505"><span class="annot"><span class="annottext">NP (Requiring h (Retract m g f) x) xs1
</span><a href="#local-6989586621679103505"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679103506"><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs1
</span><a href="#local-6989586621679103506"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679103513"><span class="annot"><span class="annottext">(-.-&gt;) g (Maybe :.: h) x
</span><a href="#local-6989586621679103513"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679103514"><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs1
</span><a href="#local-6989586621679103514"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103536"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103536"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103537"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103537"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(:.:) Maybe h x -&gt; Maybe (h x)
forall {l} {k} (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
(:.:) f g p -&gt; f (g p)
</span><span class="hs-identifier hs-var">unComp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) g (Maybe :.: h) x -&gt; g x -&gt; (:.:) Maybe h x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) g (Maybe :.: h) x
</span><a href="#local-6989586621679103513"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621679103536"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-349"></span><span>          </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679103538"><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621679103538"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><span class="annottext">(NS (K (f x)) xs -&gt; Telescope g f xs')
-&gt; m (NS (K (f x)) xs) -&gt; m (Telescope g f xs')
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f x -&gt; Telescope g f xs'
f x -&gt; Telescope g f (x : xs1)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; Telescope g f xs')
-&gt; (NS (K (f x)) xs -&gt; f x) -&gt; NS (K (f x)) xs -&gt; Telescope g f xs'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K (f x)) xs -&gt; f x
NS (K (f x)) xs -&gt; CollapseTo NS (f x)
forall (xs :: [k]) a.
SListIN NS xs =&gt;
NS (K a) xs -&gt; CollapseTo NS a
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (NS (K (f x)) xs) -&gt; m (Telescope g f xs'))
-&gt; m (NS (K (f x)) xs) -&gt; m (Telescope g f xs')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs)
forall (xs :: [k]) (f :: * -&gt; *) (g :: k -&gt; *).
(SListIN NS xs, Applicative f) =&gt;
NS (f :.: g) xs -&gt; f (NS g xs)
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: * -&gt; *)
       (g :: k -&gt; *).
(HSequence h, SListIN h xs, Applicative f) =&gt;
h (f :.: g) xs -&gt; f (h g xs)
</span><span class="hs-identifier hs-var">hsequence'</span></span><span> </span><span class="annot"><span class="annottext">(NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs))
-&gt; NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-351"></span><span>              </span><span class="annot"><span class="annottext">(forall (a :: k).
 Requiring h (Retract m g f) x a -&gt; f a -&gt; (:.:) m (K (f x)) a)
-&gt; Prod NS (Requiring h (Retract m g f) x) xs
-&gt; NS f xs
-&gt; NS (m :.: K (f x)) xs
forall {k} {l} (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *) (f'' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h, HAp (Prod h)) =&gt;
(forall (a :: k). f a -&gt; f' a -&gt; f'' a)
-&gt; Prod h f xs -&gt; h f' xs -&gt; h f'' xs
</span><span class="hs-identifier hs-var">hzipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h x
-&gt; g x
-&gt; Requiring h (Retract m g f) x a
-&gt; f a
-&gt; (:.:) m (K (f x)) a
forall {k} (m :: * -&gt; *) (h :: k -&gt; *) (x :: k) (g :: k -&gt; *)
       (f :: k -&gt; *) (z :: k).
Functor m =&gt;
h x
-&gt; g x
-&gt; Requiring h (Retract m g f) x z
-&gt; f z
-&gt; (:.:) m (K (f x)) z
</span><a href="Data.SOP.Telescope.html#retractAux"><span class="hs-identifier hs-var">retractAux</span></a></span><span> </span><span class="annot"><span class="annottext">h x
h x
</span><a href="#local-6989586621679103538"><span class="hs-identifier hs-var">hx</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621679103536"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prod NS (Requiring h (Retract m g f) x) xs
NP (Requiring h (Retract m g f) x) xs1
</span><a href="#local-6989586621679103505"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NS f xs
forall {k} (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Telescope g f xs -&gt; NS f xs
</span><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103537"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>          </span><span class="annot"><span class="annottext">Maybe (h x)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-353"></span><span>            </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f xs1 -&gt; Telescope g f (x : xs1)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103536"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f xs1 -&gt; Telescope g f xs')
-&gt; m (Telescope g f xs1) -&gt; m (Telescope g f xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs1
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs1
-&gt; Telescope g f xs1
-&gt; m (Telescope g f xs1)
forall (xs' :: [k]).
SListI xs' =&gt;
Tails (Requiring h (Retract m g f)) xs'
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f xs')
</span><a href="#local-6989586621679103495"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring h (Retract m g f)) xs1
</span><a href="#local-6989586621679103506"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; (Maybe :.: h)) xs1
NP (g -.-&gt; (Maybe :.: h)) xs1
</span><a href="#local-6989586621679103514"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs1
Telescope g f xs
</span><a href="#local-6989586621679103537"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="annot"><span class="hs-comment">-- | Internal auxiliary to 'retract' and 'alignWith'</span></span><span>
</span><span id="line-356"></span><span id="local-6989586621679102617"><span id="local-6989586621679102618"><span id="local-6989586621679102619"><span id="local-6989586621679102620"><span id="local-6989586621679102621"><span id="local-6989586621679102622"><span class="annot"><a href="Data.SOP.Telescope.html#retractAux"><span class="hs-identifier hs-type">retractAux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102617"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-357"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102618"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102619"><span class="hs-identifier hs-type">x</span></a></span><span>  </span><span class="hs-comment">-- Proof that we need to retract</span><span>
</span><span id="line-358"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102620"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102619"><span class="hs-identifier hs-type">x</span></a></span><span>  </span><span class="hs-comment">-- Era we are retracting to</span><span>
</span><span id="line-359"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102618"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102620"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102621"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102619"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102622"><span class="hs-identifier hs-type">z</span></a></span><span>
</span><span id="line-360"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102621"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102622"><span class="hs-identifier hs-type">z</span></a></span><span>  </span><span class="hs-comment">-- Current tip (what we are retracting from)</span><span>
</span><span id="line-361"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102621"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102619"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102622"><span class="hs-identifier hs-type">z</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-362"></span><span id="retractAux"><span class="annot"><span class="annottext">retractAux :: forall {k} (m :: * -&gt; *) (h :: k -&gt; *) (x :: k) (g :: k -&gt; *)
       (f :: k -&gt; *) (z :: k).
Functor m =&gt;
h x
-&gt; g x
-&gt; Requiring h (Retract m g f) x z
-&gt; f z
-&gt; (:.:) m (K (f x)) z
</span><a href="Data.SOP.Telescope.html#retractAux"><span class="hs-identifier hs-var hs-var">retractAux</span></a></span></span><span> </span><span id="local-6989586621679103543"><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621679103543"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span id="local-6989586621679103544"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103544"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103545"><span class="annot"><span class="annottext">Requiring h (Retract m g f) x z
</span><a href="#local-6989586621679103545"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679103546"><span class="annot"><span class="annottext">f z
</span><a href="#local-6989586621679103546"><span class="hs-identifier hs-var">fz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (K (f x) z) -&gt; (:.:) m (K (f x)) z
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(m (K (f x) z) -&gt; (:.:) m (K (f x)) z)
-&gt; m (K (f x) z) -&gt; (:.:) m (K (f x)) z
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; K (f x) z
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="annot"><span class="annottext">(f x -&gt; K (f x) z) -&gt; m (f x) -&gt; m (K (f x) z)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Retract m g f x z -&gt; g x -&gt; f z -&gt; m (f x)
forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (x :: k)
       (y :: k).
Retract m g f x y -&gt; g x -&gt; f y -&gt; m (f x)
</span><a href="Data.SOP.Telescope.html#retractWith"><span class="hs-identifier hs-var">retractWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Requiring h (Retract m g f) x z -&gt; h x -&gt; Retract m g f x z
forall {k1} {k2} (h :: k1 -&gt; *) (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
Requiring h f x y -&gt; h x -&gt; f x y
</span><a href="Data.SOP.InPairs.html#provide"><span class="hs-identifier hs-var">provide</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring h (Retract m g f) x z
</span><a href="#local-6989586621679103545"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">h x
</span><a href="#local-6989586621679103543"><span class="hs-identifier hs-var">hx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103544"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">f z
</span><a href="#local-6989586621679103546"><span class="hs-identifier hs-var">fz</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | Align a telescope with another, then apply a function to the tips</span><span>
</span><span id="line-365"></span><span class="hs-comment">--</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- Aligning is a combination of extension and retraction, extending or</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- retracting the telescope as required to match up with the other telescope.</span><span>
</span><span id="line-368"></span><span class="annot"><a href="Data.SOP.Telescope.html#align"><span class="hs-identifier hs-type">align</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679102631"><span class="annot"><a href="#local-6989586621679102631"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679102632"><span class="annot"><a href="#local-6989586621679102632"><span class="hs-identifier hs-type">g'</span></a></span></span><span> </span><span id="local-6989586621679102633"><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102636"><span class="annot"><a href="#local-6989586621679102636"><span class="hs-identifier hs-type">f'</span></a></span></span><span> </span><span id="local-6989586621679102634"><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679102637"><span class="annot"><a href="#local-6989586621679102637"><span class="hs-identifier hs-type">f''</span></a></span></span><span> </span><span id="local-6989586621679102635"><span class="annot"><a href="#local-6989586621679102635"><span class="hs-identifier hs-type">xs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102631"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102632"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679102631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102635"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ How to extend</span></span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102636"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102635"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ How to retract</span></span><span>
</span><span id="line-371"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102636"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102637"><span class="hs-identifier hs-type">f''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102635"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Function to apply at the tip</span></span><span>
</span><span id="line-372"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102632"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102636"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102635"><span class="hs-identifier hs-type">xs</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Telescope we are aligning with</span></span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102635"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102637"><span class="hs-identifier hs-type">f''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102635"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span id="align"><span class="annot"><span class="annottext">align :: forall {k} (m :: * -&gt; *) (g' :: k -&gt; *) (g :: k -&gt; *)
       (f' :: k -&gt; *) (f :: k -&gt; *) (f'' :: k -&gt; *) (xs :: [k]).
Monad m =&gt;
InPairs (Requiring g' (Extend m g f)) xs
-&gt; Tails (Requiring f' (Retract m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#align"><span class="hs-identifier hs-var hs-var">align</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679103550"><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
</span><a href="#local-6989586621679103550"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679103551"><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
</span><a href="#local-6989586621679103551"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679103552"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103552"><span class="hs-identifier hs-var">atTip</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; (SListI xs =&gt;
    Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall {k} (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">npToSListI</span></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103552"><span class="hs-identifier hs-var">atTip</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt;
  Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
 -&gt; Telescope g' f' xs
 -&gt; Telescope g f xs
 -&gt; m (Telescope g f'' xs))
-&gt; (SListI xs =&gt;
    Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
-&gt; Tails (Requiring f' (Retract m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall (xs' :: [k]).
SListI xs' =&gt;
InPairs (Requiring g' (Extend m g f)) xs'
-&gt; Tails (Requiring f' (Retract m g f)) xs'
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs'
-&gt; Telescope g' f' xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f'' xs')
</span><a href="#local-6989586621679103555"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
</span><a href="#local-6989586621679103550"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs
</span><a href="#local-6989586621679103551"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103552"><span class="hs-identifier hs-var">atTip</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>    </span><span id="local-6989586621679102646"><span class="annot"><a href="#local-6989586621679103555"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SListI</span></span><span> </span><span class="annot"><a href="#local-6989586621679102646"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-378"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102632"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679102631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102646"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-379"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102636"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102646"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-380"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102636"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102637"><span class="hs-identifier hs-type">f''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102646"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-381"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102632"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102636"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102646"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102634"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102646"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102633"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102637"><span class="hs-identifier hs-type">f''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102646"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679103555"><span class="annot"><span class="annottext">go :: forall (xs' :: [k]).
SListI xs' =&gt;
InPairs (Requiring g' (Extend m g f)) xs'
-&gt; Tails (Requiring f' (Retract m g f)) xs'
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs'
-&gt; Telescope g' f' xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f'' xs')
</span><a href="#local-6989586621679103555"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs'
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679103559"><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><a href="#local-6989586621679103559"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs1
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103564"><span class="annot"><span class="annottext">f' x
</span><a href="#local-6989586621679103564"><span class="hs-identifier hs-var">f'x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103570"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103570"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><span class="annottext">Telescope g f'' xs' -&gt; m (Telescope g f'' xs')
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f'' xs' -&gt; m (Telescope g f'' xs'))
-&gt; Telescope g f'' xs' -&gt; m (Telescope g f'' xs')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f'' x -&gt; Telescope g f'' (x : xs1)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><a href="#local-6989586621679103559"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x -&gt; f' x -&gt; (-.-&gt;) f f'' x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-operator hs-var">`apFn`</span></span><span> </span><span class="annot"><span class="annottext">f' x
f' x
</span><a href="#local-6989586621679103564"><span class="hs-identifier hs-var">f'x</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f f'' x -&gt; f x -&gt; f'' x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-operator hs-var">`apFn`</span></span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621679103570"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><a href="#local-6989586621679103555"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring g' (Extend m g f) x y
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679103574"><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
</span><a href="#local-6989586621679103574"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#TCons"><span class="hs-identifier hs-type">TCons</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Requiring f' (Retract m g f) x) xs1
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679103579"><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs1
</span><a href="#local-6989586621679103579"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679103584"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs1
</span><a href="#local-6989586621679103584"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g' x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679103589"><span class="annot"><span class="annottext">Telescope g' f' xs
</span><a href="#local-6989586621679103589"><span class="hs-identifier hs-var">f'x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103598"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103598"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103599"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103599"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f'' (y : zs) -&gt; Telescope g f'' (x : y : zs)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103598"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f'' (y : zs) -&gt; Telescope g f'' xs')
-&gt; m (Telescope g f'' (y : zs)) -&gt; m (Telescope g f'' xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
-&gt; Tails (Requiring f' (Retract m g f)) (y : zs)
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) (y : zs)
-&gt; Telescope g' f' (y : zs)
-&gt; Telescope g f (y : zs)
-&gt; m (Telescope g f'' (y : zs))
forall (xs' :: [k]).
SListI xs' =&gt;
InPairs (Requiring g' (Extend m g f)) xs'
-&gt; Tails (Requiring f' (Retract m g f)) xs'
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs'
-&gt; Telescope g' f' xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f'' xs')
</span><a href="#local-6989586621679103555"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
</span><a href="#local-6989586621679103574"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs1
Tails (Requiring f' (Retract m g f)) (y : zs)
</span><a href="#local-6989586621679103579"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs1
NP (f' -.-&gt; (f -.-&gt; f'')) (y : zs)
</span><a href="#local-6989586621679103584"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g' f' xs
Telescope g' f' (y : zs)
</span><a href="#local-6989586621679103589"><span class="hs-identifier hs-var">f'x</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
Telescope g f (y : zs)
</span><a href="#local-6989586621679103599"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><a href="#local-6989586621679103555"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#TCons"><span class="hs-identifier hs-type">TCons</span></a></span><span> </span><span id="local-6989586621679103603"><span class="annot"><span class="annottext">NP (Requiring f' (Retract m g f) x) xs1
</span><a href="#local-6989586621679103603"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs1
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679103608"><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><a href="#local-6989586621679103608"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs1
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103613"><span class="annot"><span class="annottext">f' x
</span><a href="#local-6989586621679103613"><span class="hs-identifier hs-var">f'x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103630"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103630"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103631"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103631"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-387"></span><span>        </span><span class="annot"><span class="annottext">(NS (K (f x)) xs -&gt; Telescope g f'' xs')
-&gt; m (NS (K (f x)) xs) -&gt; m (Telescope g f'' xs')
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f'' x -&gt; Telescope g f'' xs'
f'' x -&gt; Telescope g f'' (x : xs1)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">(f'' x -&gt; Telescope g f'' xs')
-&gt; (NS (K (f x)) xs -&gt; f'' x)
-&gt; NS (K (f x)) xs
-&gt; Telescope g f'' xs'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679103632"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103632"><span class="hs-identifier hs-var">fx'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><a href="#local-6989586621679103608"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x -&gt; f' x -&gt; (-.-&gt;) f f'' x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-operator hs-var">`apFn`</span></span><span> </span><span class="annot"><span class="annottext">f' x
f' x
</span><a href="#local-6989586621679103613"><span class="hs-identifier hs-var">f'x</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f f'' x -&gt; f x -&gt; f'' x
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-operator hs-var">`apFn`</span></span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103632"><span class="hs-identifier hs-var">fx'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f x -&gt; f'' x)
-&gt; (NS (K (f x)) xs -&gt; f x) -&gt; NS (K (f x)) xs -&gt; f'' x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NS (K (f x)) xs -&gt; f x
NS (K (f x)) xs -&gt; CollapseTo NS (f x)
forall (xs :: [k]) a.
SListIN NS xs =&gt;
NS (K a) xs -&gt; CollapseTo NS a
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) a.
(HCollapse h, SListIN h xs) =&gt;
h (K a) xs -&gt; CollapseTo h a
</span><span class="hs-identifier hs-var">hcollapse</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (NS (K (f x)) xs) -&gt; m (Telescope g f'' xs'))
-&gt; m (NS (K (f x)) xs) -&gt; m (Telescope g f'' xs')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs)
forall (xs :: [k]) (f :: * -&gt; *) (g :: k -&gt; *).
(SListIN NS xs, Applicative f) =&gt;
NS (f :.: g) xs -&gt; f (NS g xs)
forall k l (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: * -&gt; *)
       (g :: k -&gt; *).
(HSequence h, SListIN h xs, Applicative f) =&gt;
h (f :.: g) xs -&gt; f (h g xs)
</span><span class="hs-identifier hs-var">hsequence'</span></span><span> </span><span class="annot"><span class="annottext">(NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs))
-&gt; NS (m :.: K (f x)) xs -&gt; m (NS (K (f x)) xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-388"></span><span>          </span><span class="annot"><span class="annottext">(forall (a :: k).
 Requiring f' (Retract m g f) x a -&gt; f a -&gt; (:.:) m (K (f x)) a)
-&gt; Prod NS (Requiring f' (Retract m g f) x) xs
-&gt; NS f xs
-&gt; NS (m :.: K (f x)) xs
forall {k} {l} (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *) (f'' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h, HAp (Prod h)) =&gt;
(forall (a :: k). f a -&gt; f' a -&gt; f'' a)
-&gt; Prod h f xs -&gt; h f' xs -&gt; h f'' xs
</span><span class="hs-identifier hs-var">hzipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f' x
-&gt; g x
-&gt; Requiring f' (Retract m g f) x a
-&gt; f a
-&gt; (:.:) m (K (f x)) a
forall {k} (m :: * -&gt; *) (h :: k -&gt; *) (x :: k) (g :: k -&gt; *)
       (f :: k -&gt; *) (z :: k).
Functor m =&gt;
h x
-&gt; g x
-&gt; Requiring h (Retract m g f) x z
-&gt; f z
-&gt; (:.:) m (K (f x)) z
</span><a href="Data.SOP.Telescope.html#retractAux"><span class="hs-identifier hs-var">retractAux</span></a></span><span> </span><span class="annot"><span class="annottext">f' x
f' x
</span><a href="#local-6989586621679103613"><span class="hs-identifier hs-var">f'x</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621679103630"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prod NS (Requiring f' (Retract m g f) x) xs
NP (Requiring f' (Retract m g f) x) xs1
</span><a href="#local-6989586621679103603"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope g f xs -&gt; NS f xs
forall {k} (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Telescope g f xs -&gt; NS f xs
</span><a href="Data.SOP.Telescope.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103631"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><a href="#local-6989586621679103555"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span id="local-6989586621679103637"><span class="annot"><span class="annottext">Requiring g' (Extend m g f) x y
</span><a href="#local-6989586621679103637"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679103638"><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
</span><a href="#local-6989586621679103638"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Tails.html#TCons"><span class="hs-identifier hs-type">TCons</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Requiring f' (Retract m g f) x) xs1
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679103643"><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs1
</span><a href="#local-6989586621679103643"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(-.-&gt;) f' (f -.-&gt; f'') x
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679103648"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs1
</span><a href="#local-6989586621679103648"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103655"><span class="annot"><span class="annottext">g' x
</span><a href="#local-6989586621679103655"><span class="hs-identifier hs-var">g'x</span></a></span></span><span> </span><span id="local-6989586621679103656"><span class="annot"><span class="annottext">Telescope g' f' xs
</span><a href="#local-6989586621679103656"><span class="hs-identifier hs-var">t'x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103664"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103664"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-390"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679103665"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103665"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679103666"><span class="annot"><span class="annottext">f y
</span><a href="#local-6989586621679103666"><span class="hs-identifier hs-var">fy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extend m g f x y -&gt; f x -&gt; m (g x, f y)
forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (x :: k)
       (y :: k).
Extend m g f x y -&gt; f x -&gt; m (g x, f y)
</span><a href="Data.SOP.Telescope.html#extendWith"><span class="hs-identifier hs-var">extendWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Requiring g' (Extend m g f) x y -&gt; g' x -&gt; Extend m g f x y
forall {k1} {k2} (h :: k1 -&gt; *) (f :: k1 -&gt; k2 -&gt; *) (x :: k1)
       (y :: k2).
Requiring h f x y -&gt; h x -&gt; f x y
</span><a href="Data.SOP.InPairs.html#provide"><span class="hs-identifier hs-var">provide</span></a></span><span> </span><span class="annot"><span class="annottext">Requiring g' (Extend m g f) x y
</span><a href="#local-6989586621679103637"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">g' x
g' x
</span><a href="#local-6989586621679103655"><span class="hs-identifier hs-var">g'x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f x
f x
</span><a href="#local-6989586621679103664"><span class="hs-identifier hs-var">fx</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><span class="annottext">g x -&gt; Telescope g f'' (y : zs) -&gt; Telescope g f'' (x : y : zs)
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103665"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope g f'' (y : zs) -&gt; Telescope g f'' xs')
-&gt; m (Telescope g f'' (y : zs)) -&gt; m (Telescope g f'' xs')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
-&gt; Tails (Requiring f' (Retract m g f)) (y : zs)
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) (y : zs)
-&gt; Telescope g' f' (y : zs)
-&gt; Telescope g f (y : zs)
-&gt; m (Telescope g f'' (y : zs))
forall (xs' :: [k]).
SListI xs' =&gt;
InPairs (Requiring g' (Extend m g f)) xs'
-&gt; Tails (Requiring f' (Retract m g f)) xs'
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs'
-&gt; Telescope g' f' xs'
-&gt; Telescope g f xs'
-&gt; m (Telescope g f'' xs')
</span><a href="#local-6989586621679103555"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) (y : zs)
</span><a href="#local-6989586621679103638"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Tails (Requiring f' (Retract m g f)) xs1
Tails (Requiring f' (Retract m g f)) (y : zs)
</span><a href="#local-6989586621679103643"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs1
NP (f' -.-&gt; (f -.-&gt; f'')) (y : zs)
</span><a href="#local-6989586621679103648"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope g' f' xs
Telescope g' f' (y : zs)
</span><a href="#local-6989586621679103656"><span class="hs-identifier hs-var">t'x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f y -&gt; Telescope g f (y : zs)
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="annot"><span class="annottext">f y
</span><a href="#local-6989586621679103666"><span class="hs-identifier hs-var">fy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Derived API
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- | Version of 'extend' where the evidence is a simple 'Bool'</span></span><span>
</span><span id="line-398"></span><span id="local-6989586621679102686"><span id="local-6989586621679102687"><span id="local-6989586621679102688"><span id="local-6989586621679102689"><span class="annot"><a href="Data.SOP.Telescope.html#extendIf"><span class="hs-identifier hs-type">extendIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102686"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-399"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102686"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102687"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102688"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102689"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ How to extend</span></span><span>
</span><span id="line-400"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102688"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102689"><span class="hs-identifier hs-type">xs</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Where to extend /from/</span></span><span>
</span><span id="line-401"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102687"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102688"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102689"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102686"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102687"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102688"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102689"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-402"></span><span id="extendIf"><span class="annot"><span class="annottext">extendIf :: forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Monad m =&gt;
InPairs (Extend m g f) xs
-&gt; NP (f -.-&gt; K Bool) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#extendIf"><span class="hs-identifier hs-var hs-var">extendIf</span></a></span></span><span> </span><span id="local-6989586621679103668"><span class="annot"><span class="annottext">InPairs (Extend m g f) xs
</span><a href="#local-6989586621679103668"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679103669"><span class="annot"><span class="annottext">NP (f -.-&gt; K Bool) xs
</span><a href="#local-6989586621679103669"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; K Bool) xs
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall {k} (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">npToSListI</span></span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; K Bool) xs
</span><a href="#local-6989586621679103669"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
 -&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">InPairs (Requiring (K ()) (Extend m g f)) xs
-&gt; NP (f -.-&gt; (Maybe :.: K ())) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall {k} (m :: * -&gt; *) (h :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]).
Monad m =&gt;
InPairs (Requiring h (Extend m g f)) xs
-&gt; NP (f -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#extend"><span class="hs-identifier hs-var">extend</span></a></span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (x :: k) (y :: k).
 Extend m g f x y -&gt; Requiring (K ()) (Extend m g f) x y)
-&gt; InPairs (Extend m g f) xs
-&gt; InPairs (Requiring (K ()) (Extend m g f)) xs
forall {k} (xs :: [k]) (f :: k -&gt; k -&gt; *) (g :: k -&gt; k -&gt; *).
SListI xs =&gt;
(forall (x :: k) (y :: k). f x y -&gt; g x y)
-&gt; InPairs f xs -&gt; InPairs g xs
</span><a href="Data.SOP.InPairs.html#hmap"><span class="hs-identifier hs-var">InPairs.hmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(K () x -&gt; Extend m g f x y) -&gt; Requiring (K ()) (Extend m g f) x y
forall {k} {k1} (h :: k -&gt; *) (f :: k -&gt; k1 -&gt; *) (x :: k)
       (y :: k1).
(h x -&gt; f x y) -&gt; Requiring h f x y
</span><a href="Data.SOP.InPairs.html#Require"><span class="hs-identifier hs-var">Require</span></a></span><span> </span><span class="annot"><span class="annottext">((K () x -&gt; Extend m g f x y)
 -&gt; Requiring (K ()) (Extend m g f) x y)
-&gt; (Extend m g f x y -&gt; K () x -&gt; Extend m g f x y)
-&gt; Extend m g f x y
-&gt; Requiring (K ()) (Extend m g f) x y
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Extend m g f x y -&gt; K () x -&gt; Extend m g f x y
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InPairs (Extend m g f) xs
</span><a href="#local-6989586621679103668"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (a :: k).
 (-.-&gt;) f (K Bool) a -&gt; (-.-&gt;) f (Maybe :.: K ()) a)
-&gt; NP (f -.-&gt; K Bool) xs -&gt; NP (f -.-&gt; (Maybe :.: K ())) xs
forall {k} {l} (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679103678"><span class="annot"><span class="annottext">(-.-&gt;) f (K Bool) a
</span><a href="#local-6989586621679103678"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(f a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) f (Maybe :.: K ()) a
forall {k} (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((f a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) f (Maybe :.: K ()) a)
-&gt; (f a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) f (Maybe :.: K ()) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">K Bool a -&gt; (:.:) Maybe (K ()) a
forall {k} (x :: k). K Bool x -&gt; (:.:) Maybe (K ()) x
</span><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">(K Bool a -&gt; (:.:) Maybe (K ()) a)
-&gt; (f a -&gt; K Bool a) -&gt; f a -&gt; (:.:) Maybe (K ()) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (K Bool) a -&gt; f a -&gt; K Bool a
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) f (K Bool) a
</span><a href="#local-6989586621679103678"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP (f -.-&gt; K Bool) xs
</span><a href="#local-6989586621679103669"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><span class="hs-comment">-- | Version of 'retract' where the evidence is a simple 'Bool'</span></span><span>
</span><span id="line-408"></span><span id="local-6989586621679102715"><span id="local-6989586621679102716"><span id="local-6989586621679102717"><span id="local-6989586621679102718"><span class="annot"><a href="Data.SOP.Telescope.html#retractIf"><span class="hs-identifier hs-type">retractIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102715"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-409"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Tails.html#Tails"><span class="hs-identifier hs-type">Tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Retract"><span class="hs-identifier hs-type">Retract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102715"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102716"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102717"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102718"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ How to retract</span></span><span>
</span><span id="line-410"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102716"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102718"><span class="hs-identifier hs-type">xs</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Where to retract /to/</span></span><span>
</span><span id="line-411"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102716"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102717"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102718"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102715"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102716"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102717"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102718"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-412"></span><span id="retractIf"><span class="annot"><span class="annottext">retractIf :: forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k]).
Monad m =&gt;
Tails (Retract m g f) xs
-&gt; NP (g -.-&gt; K Bool) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#retractIf"><span class="hs-identifier hs-var hs-var">retractIf</span></a></span></span><span> </span><span id="local-6989586621679103681"><span class="annot"><span class="annottext">Tails (Retract m g f) xs
</span><a href="#local-6989586621679103681"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679103682"><span class="annot"><span class="annottext">NP (g -.-&gt; K Bool) xs
</span><a href="#local-6989586621679103682"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; K Bool) xs
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall {k} (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">npToSListI</span></span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; K Bool) xs
</span><a href="#local-6989586621679103682"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
 -&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><span class="annottext">Tails (Requiring (K ()) (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: K ())) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
forall {k} (m :: * -&gt; *) (h :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]).
Monad m =&gt;
Tails (Requiring h (Retract m g f)) xs
-&gt; NP (g -.-&gt; (Maybe :.: h)) xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f xs)
</span><a href="Data.SOP.Telescope.html#retract"><span class="hs-identifier hs-var">retract</span></a></span><span>
</span><span id="line-414"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (x :: k) (y :: k).
 Retract m g f x y -&gt; Requiring (K ()) (Retract m g f) x y)
-&gt; Tails (Retract m g f) xs
-&gt; Tails (Requiring (K ()) (Retract m g f)) xs
forall {k} (xs :: [k]) (f :: k -&gt; k -&gt; *) (g :: k -&gt; k -&gt; *).
SListI xs =&gt;
(forall (x :: k) (y :: k). f x y -&gt; g x y)
-&gt; Tails f xs -&gt; Tails g xs
</span><a href="Data.SOP.Tails.html#hmap"><span class="hs-identifier hs-var">Tails.hmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(K () x -&gt; Retract m g f x y)
-&gt; Requiring (K ()) (Retract m g f) x y
forall {k} {k1} (h :: k -&gt; *) (f :: k -&gt; k1 -&gt; *) (x :: k)
       (y :: k1).
(h x -&gt; f x y) -&gt; Requiring h f x y
</span><a href="Data.SOP.InPairs.html#Require"><span class="hs-identifier hs-var">Require</span></a></span><span> </span><span class="annot"><span class="annottext">((K () x -&gt; Retract m g f x y)
 -&gt; Requiring (K ()) (Retract m g f) x y)
-&gt; (Retract m g f x y -&gt; K () x -&gt; Retract m g f x y)
-&gt; Retract m g f x y
-&gt; Requiring (K ()) (Retract m g f) x y
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Retract m g f x y -&gt; K () x -&gt; Retract m g f x y
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tails (Retract m g f) xs
</span><a href="#local-6989586621679103681"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (a :: k).
 (-.-&gt;) g (K Bool) a -&gt; (-.-&gt;) g (Maybe :.: K ()) a)
-&gt; NP (g -.-&gt; K Bool) xs -&gt; NP (g -.-&gt; (Maybe :.: K ())) xs
forall {k} {l} (h :: (k -&gt; *) -&gt; l -&gt; *) (xs :: l) (f :: k -&gt; *)
       (f' :: k -&gt; *).
(SListIN (Prod h) xs, HAp h) =&gt;
(forall (a :: k). f a -&gt; f' a) -&gt; h f xs -&gt; h f' xs
</span><span class="hs-identifier hs-var">hmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679103689"><span class="annot"><span class="annottext">(-.-&gt;) g (K Bool) a
</span><a href="#local-6989586621679103689"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(g a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) g (Maybe :.: K ()) a
forall {k} (f :: k -&gt; *) (a :: k) (f' :: k -&gt; *).
(f a -&gt; f' a) -&gt; (-.-&gt;) f f' a
</span><span class="hs-identifier hs-var">fn</span></span><span> </span><span class="annot"><span class="annottext">((g a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) g (Maybe :.: K ()) a)
-&gt; (g a -&gt; (:.:) Maybe (K ()) a) -&gt; (-.-&gt;) g (Maybe :.: K ()) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">K Bool a -&gt; (:.:) Maybe (K ()) a
forall {k} (x :: k). K Bool x -&gt; (:.:) Maybe (K ()) x
</span><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">(K Bool a -&gt; (:.:) Maybe (K ()) a)
-&gt; (g a -&gt; K Bool a) -&gt; g a -&gt; (:.:) Maybe (K ()) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) g (K Bool) a -&gt; g a -&gt; K Bool a
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
(-.-&gt;) f g a -&gt; f a -&gt; g a
</span><span class="hs-identifier hs-var">apFn</span></span><span> </span><span class="annot"><span class="annottext">(-.-&gt;) g (K Bool) a
</span><a href="#local-6989586621679103689"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP (g -.-&gt; K Bool) xs
</span><a href="#local-6989586621679103682"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">-- | Version of 'align' that never retracts, only extends</span><span>
</span><span id="line-418"></span><span class="hs-comment">--</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- PRE: The telescope we are aligning with cannot be behind us.</span><span>
</span><span id="line-420"></span><span id="local-6989586621679102734"><span id="local-6989586621679102736"><span id="local-6989586621679102737"><span id="local-6989586621679102738"><span id="local-6989586621679102739"><span id="local-6989586621679102740"><span id="local-6989586621679102741"><span class="annot"><a href="Data.SOP.Telescope.html#alignExtend"><span class="hs-identifier hs-type">alignExtend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102734"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#Requiring"><span class="hs-identifier hs-type">Requiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102736"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102734"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102737"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102738"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102739"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ How to extend</span></span><span>
</span><span id="line-422"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102740"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102738"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102741"><span class="hs-identifier hs-type">f''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102739"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Function to apply at the tip</span></span><span>
</span><span id="line-423"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102736"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102740"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102739"><span class="hs-identifier hs-type">xs</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Telescope we are aligning with</span></span><span>
</span><span id="line-424"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102737"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102738"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102739"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102734"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102737"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102741"><span class="hs-identifier hs-type">f''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102739"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-425"></span><span id="alignExtend"><span class="annot"><span class="annottext">alignExtend :: forall {k} (m :: * -&gt; *) (g' :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]) (f' :: k -&gt; *) (f'' :: k -&gt; *).
(Monad m, HasCallStack) =&gt;
InPairs (Requiring g' (Extend m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#alignExtend"><span class="hs-identifier hs-var hs-var">alignExtend</span></a></span></span><span> </span><span id="local-6989586621679103692"><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
</span><a href="#local-6989586621679103692"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679103693"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103693"><span class="hs-identifier hs-var">atTip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; (SListI xs =&gt;
    Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall {k} (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">npToSListI</span></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103693"><span class="hs-identifier hs-var">atTip</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt;
  Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
 -&gt; Telescope g' f' xs
 -&gt; Telescope g f xs
 -&gt; m (Telescope g f'' xs))
-&gt; (SListI xs =&gt;
    Telescope g' f' xs -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
-&gt; Tails (Requiring f' (Retract m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall {k} (m :: * -&gt; *) (g' :: k -&gt; *) (g :: k -&gt; *)
       (f' :: k -&gt; *) (f :: k -&gt; *) (f'' :: k -&gt; *) (xs :: [k]).
Monad m =&gt;
InPairs (Requiring g' (Extend m g f)) xs
-&gt; Tails (Requiring f' (Retract m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#align"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (Requiring g' (Extend m g f)) xs
</span><a href="#local-6989586621679103692"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (x :: k) (y :: k). Requiring f' (Retract m g f) x y)
-&gt; Tails (Requiring f' (Retract m g f)) xs
forall {k} (xs :: [k]) (f :: k -&gt; k -&gt; *).
SListI xs =&gt;
(forall (x :: k) (y :: k). f x y) -&gt; Tails f xs
</span><a href="Data.SOP.Tails.html#hpure"><span class="hs-identifier hs-var">Tails.hpure</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (x :: k) (y :: k). Requiring f' (Retract m g f) x y)
 -&gt; Tails (Requiring f' (Retract m g f)) xs)
-&gt; (forall (x :: k) (y :: k). Requiring f' (Retract m g f) x y)
-&gt; Tails (Requiring f' (Retract m g f)) xs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(f' x -&gt; Retract m g f x y) -&gt; Requiring f' (Retract m g f) x y
forall {k} {k1} (h :: k -&gt; *) (f :: k -&gt; k1 -&gt; *) (x :: k)
       (y :: k1).
(h x -&gt; f x y) -&gt; Requiring h f x y
</span><a href="Data.SOP.InPairs.html#Require"><span class="hs-identifier hs-var">Require</span></a></span><span> </span><span class="annot"><span class="annottext">((f' x -&gt; Retract m g f x y) -&gt; Requiring f' (Retract m g f) x y)
-&gt; (f' x -&gt; Retract m g f x y) -&gt; Requiring f' (Retract m g f) x y
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">f' x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Retract m g f x y
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679103701"><span class="hs-identifier hs-var">precondition</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103693"><span class="hs-identifier hs-var">atTip</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="#local-6989586621679103701"><span class="hs-identifier hs-type">precondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679103701"><span class="annot"><span class="annottext">precondition :: [Char]
</span><a href="#local-6989586621679103701"><span class="hs-identifier hs-var hs-var">precondition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;alignExtend: precondition violated&quot;</span></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="annot"><span class="hs-comment">-- | Version of 'alignExtend' that extends with an NS instead</span></span><span>
</span><span id="line-432"></span><span id="local-6989586621679102760"><span id="local-6989586621679102761"><span id="local-6989586621679102762"><span id="local-6989586621679102763"><span id="local-6989586621679102764"><span id="local-6989586621679102765"><span class="annot"><a href="Data.SOP.Telescope.html#alignExtendNS"><span class="hs-identifier hs-type">alignExtendNS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102760"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Extend"><span class="hs-identifier hs-type">Extend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102761"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102762"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102763"><span class="hs-identifier hs-type">xs</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ How to extend</span></span><span>
</span><span id="line-434"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102764"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102762"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">-.-&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679102765"><span class="hs-identifier hs-type">f''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102763"><span class="hs-identifier hs-type">xs</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Function to apply at the tip</span></span><span>
</span><span id="line-435"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="annot"><a href="#local-6989586621679102764"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102763"><span class="hs-identifier hs-type">xs</span></a></span><span>                    </span><span class="annot"><span class="hs-comment">-- ^ NS we are aligning with</span></span><span>
</span><span id="line-436"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102761"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102762"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102763"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102761"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102765"><span class="hs-identifier hs-type">f''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102763"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-437"></span><span id="alignExtendNS"><span class="annot"><span class="annottext">alignExtendNS :: forall {k} (m :: * -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *) (xs :: [k])
       (f' :: k -&gt; *) (f'' :: k -&gt; *).
(Monad m, HasCallStack) =&gt;
InPairs (Extend m g f) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; NS f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#alignExtendNS"><span class="hs-identifier hs-var hs-var">alignExtendNS</span></a></span></span><span> </span><span id="local-6989586621679103704"><span class="annot"><span class="annottext">InPairs (Extend m g f) xs
</span><a href="#local-6989586621679103704"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679103705"><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103705"><span class="hs-identifier hs-var">atTip</span></a></span></span><span> </span><span id="local-6989586621679103706"><span class="annot"><span class="annottext">NS f' xs
</span><a href="#local-6989586621679103706"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall {k} (a :: k -&gt; *) (xs :: [k]) r.
NP a xs -&gt; (SListI xs =&gt; r) -&gt; r
</span><span class="hs-identifier hs-var">npToSListI</span></span><span> </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103705"><span class="hs-identifier hs-var">atTip</span></a></span><span> </span><span class="annot"><span class="annottext">((SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
 -&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; (SListI xs =&gt; Telescope g f xs -&gt; m (Telescope g f'' xs))
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-438"></span><span>   </span><span class="annot"><span class="annottext">InPairs (Requiring (K ()) (Extend m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope (K ()) f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
forall {k} (m :: * -&gt; *) (g' :: k -&gt; *) (g :: k -&gt; *) (f :: k -&gt; *)
       (xs :: [k]) (f' :: k -&gt; *) (f'' :: k -&gt; *).
(Monad m, HasCallStack) =&gt;
InPairs (Requiring g' (Extend m g f)) xs
-&gt; NP (f' -.-&gt; (f -.-&gt; f'')) xs
-&gt; Telescope g' f' xs
-&gt; Telescope g f xs
-&gt; m (Telescope g f'' xs)
</span><a href="Data.SOP.Telescope.html#alignExtend"><span class="hs-identifier hs-var">alignExtend</span></a></span><span>
</span><span id="line-439"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (x :: k) (y :: k).
 Extend m g f x y -&gt; Requiring (K ()) (Extend m g f) x y)
-&gt; InPairs (Extend m g f) xs
-&gt; InPairs (Requiring (K ()) (Extend m g f)) xs
forall {k} (xs :: [k]) (f :: k -&gt; k -&gt; *) (g :: k -&gt; k -&gt; *).
SListI xs =&gt;
(forall (x :: k) (y :: k). f x y -&gt; g x y)
-&gt; InPairs f xs -&gt; InPairs g xs
</span><a href="Data.SOP.InPairs.html#hmap"><span class="hs-identifier hs-var">InPairs.hmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(K () x -&gt; Extend m g f x y) -&gt; Requiring (K ()) (Extend m g f) x y
forall {k} {k1} (h :: k -&gt; *) (f :: k -&gt; k1 -&gt; *) (x :: k)
       (y :: k1).
(h x -&gt; f x y) -&gt; Requiring h f x y
</span><a href="Data.SOP.InPairs.html#Require"><span class="hs-identifier hs-var">Require</span></a></span><span> </span><span class="annot"><span class="annottext">((K () x -&gt; Extend m g f x y)
 -&gt; Requiring (K ()) (Extend m g f) x y)
-&gt; (Extend m g f x y -&gt; K () x -&gt; Extend m g f x y)
-&gt; Extend m g f x y
-&gt; Requiring (K ()) (Extend m g f) x y
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Extend m g f x y -&gt; K () x -&gt; Extend m g f x y
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InPairs (Extend m g f) xs
</span><a href="#local-6989586621679103704"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>     </span><span class="annot"><span class="annottext">NP (f' -.-&gt; (f -.-&gt; f'')) xs
</span><a href="#local-6989586621679103705"><span class="hs-identifier hs-var">atTip</span></a></span><span>
</span><span id="line-441"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NS f' xs -&gt; Telescope (K ()) f' xs
forall {k} (f :: k -&gt; *) (xs :: [k]).
NS f xs -&gt; Telescope (K ()) f xs
</span><a href="Data.SOP.Telescope.html#fromTip"><span class="hs-identifier hs-var">fromTip</span></a></span><span> </span><span class="annot"><span class="annottext">NS f' xs
</span><a href="#local-6989586621679103706"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="annot"><span class="hs-comment">-- | Internal auxiliary to 'extendIf' and 'retractIf'</span></span><span>
</span><span id="line-444"></span><span id="local-6989586621679102713"><span class="annot"><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-type">fromBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102713"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102713"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-445"></span><span id="fromBool"><span class="annot"><span class="annottext">fromBool :: forall {k} (x :: k). K Bool x -&gt; (:.:) Maybe (K ()) x
</span><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-var hs-var">fromBool</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (K () x) -&gt; (:.:) Maybe (K ()) x
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (K () x) -&gt; (:.:) Maybe (K ()) x)
-&gt; Maybe (K () x) -&gt; (:.:) Maybe (K ()) x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">K () x -&gt; Maybe (K () x)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(K () x -&gt; Maybe (K () x)) -&gt; K () x -&gt; Maybe (K () x)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; K () x
forall k a (b :: k). a -&gt; K a b
</span><span class="hs-identifier hs-var">K</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span class="annot"><a href="Data.SOP.Telescope.html#fromBool"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (K () x) -&gt; (:.:) Maybe (K ()) x
forall l k (f :: l -&gt; *) (g :: k -&gt; l) (p :: k).
f (g p) -&gt; (:.:) f g p
</span><span class="hs-identifier hs-var">Comp</span></span><span> </span><span class="annot"><span class="annottext">Maybe (K () x)
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Additional API
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-keyword">newtype</span><span> </span><span id="ScanNext"><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier hs-var">ScanNext</span></a></span></span><span> </span><span id="local-6989586621679102778"><span class="annot"><a href="#local-6989586621679102778"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679102779"><span class="annot"><a href="#local-6989586621679102779"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679102780"><span class="annot"><a href="#local-6989586621679102780"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679102781"><span class="annot"><a href="#local-6989586621679102781"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ScanNext"><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier hs-var">ScanNext</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getNext"><span class="annot"><span class="annottext">forall {k} (h :: k -&gt; *) (g :: k -&gt; *) (x :: k) (y :: k).
ScanNext h g x y -&gt; h x -&gt; g x -&gt; h y
</span><a href="Data.SOP.Telescope.html#getNext"><span class="hs-identifier hs-var hs-var">getNext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679102778"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102780"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102779"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102780"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102778"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102781"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- | Telescope analogue of 'scanl' on lists</span><span>
</span><span id="line-455"></span><span class="hs-comment">--</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- This function is modelled on</span><span>
</span><span id="line-457"></span><span class="hs-comment">--</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- &gt; scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]</span><span>
</span><span id="line-459"></span><span class="hs-comment">--</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- but there are a few differences:</span><span>
</span><span id="line-461"></span><span class="hs-comment">--</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- * Since every seed has a different type, we must be given a function</span><span>
</span><span id="line-463"></span><span class="hs-comment">--   for each transition.</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- * Unlike 'scanl', we preserve the length of the telescope</span><span>
</span><span id="line-465"></span><span class="hs-comment">--   ('scanl' prepends the initial seed)</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- * Instead of generating a telescope containing only the seeds, we</span><span>
</span><span id="line-467"></span><span class="hs-comment">--   instead pair the seeds with the elements.</span><span>
</span><span id="line-468"></span><span id="local-6989586621679102789"><span id="local-6989586621679102790"><span id="local-6989586621679102791"><span id="local-6989586621679102792"><span id="local-6989586621679102793"><span class="annot"><a href="Data.SOP.Telescope.html#scanl"><span class="hs-identifier hs-type">scanl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier hs-type">ScanNext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102789"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102790"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102791"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679102792"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679102789"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102791"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-470"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102790"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102793"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102791"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679102792"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Product.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102789"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102790"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Product.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102789"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102793"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679102791"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679102792"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-472"></span><span id="scanl"><span class="annot"><span class="annottext">scanl :: forall {a} (h :: a -&gt; *) (g :: a -&gt; *) (x :: a) (xs :: [a])
       (f :: a -&gt; *).
InPairs (ScanNext h g) (x : xs)
-&gt; h x
-&gt; Telescope g f (x : xs)
-&gt; Telescope (Product h g) (Product h f) (x : xs)
</span><a href="Data.SOP.Telescope.html#scanl"><span class="hs-identifier hs-var hs-var">scanl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InPairs (ScanNext h g) (x : xs)
-&gt; h x
-&gt; Telescope g f (x : xs)
-&gt; Telescope (Product h g) (Product h f) (x : xs)
forall {a} (h :: a -&gt; *) (g :: a -&gt; *) (x :: a) (xs :: [a])
       (f :: a -&gt; *).
InPairs (ScanNext h g) (x : xs)
-&gt; h x
-&gt; Telescope g f (x : xs)
-&gt; Telescope (Product h g) (Product h f) (x : xs)
</span><a href="#local-6989586621679103714"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-474"></span><span>    </span><span id="local-6989586621679103715"><span id="local-6989586621679103716"><span id="local-6989586621679103717"><span id="local-6989586621679103718"><span id="local-6989586621679103719"><span class="annot"><a href="#local-6989586621679103714"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SOP.InPairs.html#InPairs"><span class="hs-identifier hs-type">InPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#ScanNext"><span class="hs-identifier hs-type">ScanNext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103715"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103716"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679103717"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679103718"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679103715"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103717"><span class="hs-identifier hs-type">x'</span></a></span><span>
</span><span id="line-476"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103716"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103719"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679103717"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679103718"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Product.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103715"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103716"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Product.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103715"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679103719"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679103717"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679103718"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621679103714"><span class="annot"><span class="annottext">go :: forall {a} (h :: a -&gt; *) (g :: a -&gt; *) (x :: a) (xs :: [a])
       (f :: a -&gt; *).
InPairs (ScanNext h g) (x : xs)
-&gt; h x
-&gt; Telescope g f (x : xs)
-&gt; Telescope (Product h g) (Product h f) (x : xs)
</span><a href="#local-6989586621679103714"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">InPairs (ScanNext h g) (x' : xs')
</span><span class="hs-identifier">_</span></span><span>            </span><span id="local-6989586621679103720"><span class="annot"><span class="annottext">h x'
</span><a href="#local-6989586621679103720"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103724"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103724"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product h f x' -&gt; Telescope (Product h g) (Product h f) (x' : xs')
forall {k} (f :: k -&gt; *) (x :: k) (g :: k -&gt; *) (xs :: [k]).
f x -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-var">TZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h x' -&gt; f x' -&gt; Product h f x'
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Product.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">h x'
</span><a href="#local-6989586621679103720"><span class="hs-identifier hs-var">hx</span></a></span><span> </span><span class="annot"><span class="annottext">f x'
f x
</span><a href="#local-6989586621679103724"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><a href="#local-6989586621679103714"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.InPairs.html#PCons"><span class="hs-identifier hs-type">PCons</span></a></span><span> </span><span id="local-6989586621679103730"><span class="annot"><span class="annottext">ScanNext h g x y
</span><a href="#local-6989586621679103730"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679103731"><span class="annot"><span class="annottext">InPairs (ScanNext h g) (y : zs)
</span><a href="#local-6989586621679103731"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679103732"><span class="annot"><span class="annottext">h x'
</span><a href="#local-6989586621679103732"><span class="hs-identifier hs-var">hx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103739"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103739"><span class="hs-identifier hs-var">gx</span></a></span></span><span> </span><span id="local-6989586621679103740"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103740"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product h g x'
-&gt; Telescope (Product h g) (Product h f) xs'
-&gt; Telescope (Product h g) (Product h f) (x' : xs')
forall {k} (g :: k -&gt; *) (x :: k) (f :: k -&gt; *) (xs :: [k]).
g x -&gt; Telescope g f xs -&gt; Telescope g f (x : xs)
</span><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-var">TS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h x' -&gt; g x' -&gt; Product h g x'
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.Product.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">h x'
</span><a href="#local-6989586621679103732"><span class="hs-identifier hs-var">hx</span></a></span><span> </span><span class="annot"><span class="annottext">g x'
g x
</span><a href="#local-6989586621679103739"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Telescope (Product h g) (Product h f) xs'
 -&gt; Telescope (Product h g) (Product h f) (x' : xs'))
-&gt; Telescope (Product h g) (Product h f) xs'
-&gt; Telescope (Product h g) (Product h f) (x' : xs')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (ScanNext h g) (y : zs)
-&gt; h y
-&gt; Telescope g f (y : zs)
-&gt; Telescope (Product h g) (Product h f) (y : zs)
forall {a} (h :: a -&gt; *) (g :: a -&gt; *) (x :: a) (xs :: [a])
       (f :: a -&gt; *).
InPairs (ScanNext h g) (x : xs)
-&gt; h x
-&gt; Telescope g f (x : xs)
-&gt; Telescope (Product h g) (Product h f) (x : xs)
</span><a href="#local-6989586621679103714"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InPairs (ScanNext h g) (y : zs)
</span><a href="#local-6989586621679103731"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScanNext h g x y -&gt; h x -&gt; g x -&gt; h y
forall {k} (h :: k -&gt; *) (g :: k -&gt; *) (x :: k) (y :: k).
ScanNext h g x y -&gt; h x -&gt; g x -&gt; h y
</span><a href="Data.SOP.Telescope.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span> </span><span class="annot"><span class="annottext">ScanNext h g x y
</span><a href="#local-6989586621679103730"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">h x'
h x
</span><a href="#local-6989586621679103732"><span class="hs-identifier hs-var">hx</span></a></span><span> </span><span class="annot"><span class="annottext">g x
g x
</span><a href="#local-6989586621679103739"><span class="hs-identifier hs-var">gx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
Telescope g f (y : zs)
</span><a href="#local-6989586621679103740"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Standard type class instances
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span id="local-6989586621679102820"><span id="local-6989586621679102821"><span id="local-6989586621679102822"><span id="local-6989586621679103744"><span id="local-6989586621679103746"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102820"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102821"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-486"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102822"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102821"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-487"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102820"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102822"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102821"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span id="local-6989586621679102825"><span id="local-6989586621679102826"><span id="local-6989586621679102827"><span id="local-6989586621679103756"><span id="local-6989586621679103758"><span id="local-6989586621679103760"><span id="local-6989586621679103763"><span id="local-6989586621679103766"><span id="local-6989586621679103769"><span id="local-6989586621679103772"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679102825"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102826"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-490"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102825"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102826"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-491"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679102827"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102826"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-492"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102827"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102826"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-493"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102825"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102827"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102826"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span id="local-6989586621679102831"><span id="local-6989586621679102832"><span id="local-6989586621679102833"><span id="local-6989586621679103778"><span id="local-6989586621679103780"><span id="local-6989586621679103783"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102831"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102832"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-496"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102833"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102832"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-497"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102831"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102833"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102832"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679102843"><span id="local-6989586621679102844"><span id="local-6989586621679102845"><span id="local-6989586621679103789"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="annot"><a href="#local-6989586621679102843"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102844"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-500"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="annot"><a href="#local-6989586621679102845"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679102844"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-501"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SOP.Telescope.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102843"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102845"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679102844"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621679103797"><span class="annot"><span class="annottext">showTypeOf :: Proxy (Telescope g f xs) -&gt; [Char]
</span><a href="#local-6989586621679103797"><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy (Telescope g f xs)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Telescope&quot;</span></span><span>
</span><span id="line-503"></span><span>  </span><span id="local-6989586621679103799"><span class="annot"><span class="annottext">wNoThunks :: Context -&gt; Telescope g f xs -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679103799"><span class="hs-identifier hs-var hs-var hs-var hs-var">wNoThunks</span></a></span></span><span> </span><span id="local-6989586621679103801"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679103801"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-504"></span><span>      </span><span class="annot"><a href="Data.SOP.Telescope.html#TZ"><span class="hs-identifier hs-type">TZ</span></a></span><span> </span><span id="local-6989586621679103807"><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103807"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Context -&gt; f x -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">noThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;TZ&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679103801"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f x
</span><a href="#local-6989586621679103807"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-505"></span><span>      </span><span class="annot"><a href="Data.SOP.Telescope.html#TS"><span class="hs-identifier hs-type">TS</span></a></span><span> </span><span id="local-6989586621679103818"><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103818"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679103819"><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103819"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[IO (Maybe ThunkInfo)] -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">allNoThunks</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-506"></span><span>                   </span><span class="annot"><span class="annottext">Context -&gt; g x -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">noThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;g&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;TS&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679103801"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g x
</span><a href="#local-6989586621679103818"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-507"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Telescope g f xs -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var">noThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;t&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;TS&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Context -&gt; Context
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679103801"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope g f xs
</span><a href="#local-6989586621679103819"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-508"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-509"></span></pre></body></html>