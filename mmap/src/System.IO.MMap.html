<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679039953"><span id="local-6989586621679039954"></span></span><span class="hs-pragma">{-# LANGUAGE ForeignFunctionInterface, CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  System.IO.MMap</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (c) Gracjan Polak 2009</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- This library provides a wrapper to mmap(2) or MapViewOfFile,</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- allowing files or devices to be lazily loaded into memory as strict</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- or lazy ByteStrings, ForeignPtrs or plain Ptrs, using the virtual</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- memory subsystem to do on-demand loading.  Modifications are also</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- supported.</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.IO.MMap</span><span>
</span><span id="line-18"></span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>     </span><span class="annot"><span class="hs-comment">-- $mmap_intro</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>     </span><span class="annot"><span class="hs-comment">-- * Mapping mode</span></span><span>
</span><span id="line-22"></span><span>     </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier">Mode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>     </span><span class="annot"><span class="hs-comment">-- * Memory mapped files strict interface</span></span><span>
</span><span id="line-25"></span><span>     </span><span class="annot"><a href="System.IO.MMap.html#mmapFilePtr"><span class="hs-identifier">mmapFilePtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>     </span><span class="annot"><a href="System.IO.MMap.html#mmapWithFilePtr"><span class="hs-identifier">mmapWithFilePtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>     </span><span class="annot"><a href="System.IO.MMap.html#mmapFileForeignPtr"><span class="hs-identifier">mmapFileForeignPtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>     </span><span class="annot"><a href="System.IO.MMap.html#mmapFileByteString"><span class="hs-identifier">mmapFileByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>     </span><span class="annot"><a href="System.IO.MMap.html#munmapFilePtr"><span class="hs-identifier">munmapFilePtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>     </span><span class="annot"><span class="hs-comment">-- * Memory mapped files lazy interface</span></span><span>
</span><span id="line-33"></span><span>     </span><span class="annot"><a href="System.IO.MMap.html#mmapFileForeignPtrLazy"><span class="hs-identifier">mmapFileForeignPtrLazy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>     </span><span class="annot"><a href="System.IO.MMap.html#mmapFileByteStringLazy"><span class="hs-identifier">mmapFileByteStringLazy</span></a></span><span>
</span><span id="line-35"></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.Ptr.html"><span class="hs-identifier">Foreign.Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier">Ptr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#FunPtr"><span class="hs-identifier">FunPtr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#nullPtr"><span class="hs-identifier">nullPtr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#plusPtr"><span class="hs-identifier">plusPtr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#castPtr"><span class="hs-identifier">castPtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html"><span class="hs-identifier">Foreign.C.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CInt"><span class="hs-identifier">CInt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CLLong"><span class="hs-identifier">CLLong</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CSize"><span class="hs-identifier">CSize</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.String.html"><span class="hs-identifier">Foreign.C.String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Foreign.html#CString"><span class="hs-identifier">CString</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.String.html#withCString"><span class="hs-identifier">withCString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.ForeignPtr.html"><span class="hs-identifier">Foreign.ForeignPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#ForeignPtr"><span class="hs-identifier">ForeignPtr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#withForeignPtr"><span class="hs-identifier">withForeignPtr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#finalizeForeignPtr"><span class="hs-identifier">finalizeForeignPtr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.ForeignPtr.Imp.html#newForeignPtr"><span class="hs-identifier">newForeignPtr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.ForeignPtr.Imp.html#newForeignPtrEnv"><span class="hs-identifier">newForeignPtrEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html"><span class="hs-identifier">Foreign.C.Error</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.Unsafe.html"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier">unsafePerformIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Internal.html"><span class="hs-identifier">Data.ByteString.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Internal.Type.html#fromForeignPtr"><span class="hs-identifier">fromForeignPtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Int.html"><span class="hs-identifier">Data.Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#bracketOnError"><span class="hs-identifier">bracketOnError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#bracket"><span class="hs-identifier">bracket</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#finally"><span class="hs-identifier">finally</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Lazy.html#fromChunks"><span class="hs-identifier">fromChunks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier">length</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">--import Debug.Trace</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- TODO:</span><span>
</span><span id="line-56"></span><span class="hs-comment">--    - support native characters (Unicode) in FilePath</span><span>
</span><span id="line-57"></span><span class="hs-comment">--    - support externally given HANDLEs and FDs</span><span>
</span><span id="line-58"></span><span class="hs-comment">--    - support data commit</span><span>
</span><span id="line-59"></span><span class="hs-comment">--    - support memory region resize</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- $mmap_intro</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- This module is an interface to @mmap(2)@ system call under POSIX</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- (Unix, Linux, Mac OS X) and @CreateFileMapping@, @MapViewOfFile@ under</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- Windows.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- We can consider mmap as lazy IO pushed into the virtual memory</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- subsystem.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- It is only safe to mmap a file if you know you are the sole</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- user. Otherwise referential transparency may be or may be not</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- compromised. Sadly semantics differ much between operating systems.</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- In case of IO errors all function use 'throwErrno' or 'throwErrnoPath'.</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- In case of 'ForeignPtr' or 'BS.ByteString' functions the storage</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- manager is used to free the mapped memory. When the garbage</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- collector notices there are no further references to the mapped</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- memory, a call to @munmap@ is made. It is not necessary to do this</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- yourself. In tight memory situations it may be profitable to use</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- 'System.Mem.performGC' or 'finalizeForeignPtr' to force an unmap</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- action. You can also use 'mmapWithFilePtr' that uses scope based</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- resource allocation.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- To free resources returned as Ptr use 'munmapFilePtr'.</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- For modes 'ReadOnly', 'ReadWrite' and 'WriteCopy' file must exist</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- before mapping it into memory. It also needs to have correct</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- permissions for reading and/or writing (depending on mode). In</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- 'ReadWriteEx' the file will be created with default permissions if</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- it does not exist.</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- If mode is 'ReadWrite', 'ReadWriteEx' or 'WriteCopy' the returned</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- memory region may be written to with 'Foreign.Storable.poke' and</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- friends. In 'WriteCopy' mode changes will not be written to disk.</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- It is an error to modify mapped memory in 'ReadOnly' mode. If is</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- undefined if and how changes from external changes affect your</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- mmapped regions, they may reflect in your memory or may not and</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- this note applies equally to all modes.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- Range specified may be 'Nothing', in this case whole file will be</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- mapped. Otherwise range should be 'Just (offset,size)' where</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- offsets is the beginning byte of file region to map and size tells</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- mapping length. There are no alignment requirements. Returned Ptr or</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- ForeignPtr will be aligned to page size boundary and you'll be</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- given offset to your data. Both @offset@ and @size@ must be</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- nonnegative.  Sum @offset + size@ should not be greater than file</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- length, except in 'ReadWriteEx' mode when file will be extended to</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- cover whole range. We do allow @size@ to be 0 and we do mmap files</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- of 0 length. If your offset is 0 you are guaranteed to receive page</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- aligned pointer back. You are required to give explicit range in</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- case of 'ReadWriteEx' even if the file exists.</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- File extension in 'ReadWriteEx' mode seems to use sparse files</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- whenever supported by oprating system and therefore returns</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- immediatelly as postpones real block allocation for later.</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- For more details about mmap and its consequences see:</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- * &lt;http://opengroup.org/onlinepubs/009695399/functions/mmap.html&gt;</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- * &lt;http://www.gnu.org/software/libc/manual/html_node/Memory_002dmapped-I_002fO.html&gt;</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- * &lt;http://msdn2.microsoft.com/en-us/library/aa366781(VS.85).aspx&gt;</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Questions and Answers</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- * Q: What happens if somebody writes to my mmapped file? A:</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- Undefined. System is free to not synchronize write system call and</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- mmap so nothing is sure. So this might be reflected in your memory</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- or not.  This applies even in 'WriteCopy' mode.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- * Q: What happens if I map 'ReadWrite' and change memory? A: After</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- some time in will be written to disk. It is unspecified when this</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- happens.</span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- * Q: What if somebody removes my file? A: Undefined. File with</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- mmapped region is treated by system as open file. Removing such</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- file works the same way as removing open file and different systems</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- have different ideas what to do in such case.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- * Q: Why can't I open my file for writting after mmaping it? A:</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- File needs to be unmapped first. Either make sure you don't</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- reference memory mapped regions and force garbage collection (this</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- is hard to do) or better yet use mmaping with explicit memory</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- management.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- * Q: Can I map region after end of file? A: You need to use</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- 'ReadWriteEx' mode.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><span class="hs-comment">-- | Mode of mapping. Four cases are supported.</span></span><span>
</span><span id="line-154"></span><span class="hs-keyword">data</span><span> </span><span id="Mode"><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-var">Mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReadOnly"><span class="annot"><a href="System.IO.MMap.html#ReadOnly"><span class="hs-identifier hs-var">ReadOnly</span></a></span></span><span>     </span><span class="hs-comment">-- ^ file is mapped read-only, file must</span><span>
</span><span id="line-155"></span><span>                         </span><span class="hs-comment">-- exist</span><span>
</span><span id="line-156"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="ReadWrite"><span class="annot"><a href="System.IO.MMap.html#ReadWrite"><span class="hs-identifier hs-var">ReadWrite</span></a></span></span><span>    </span><span class="hs-comment">-- ^ file is mapped read-write, file must</span><span>
</span><span id="line-157"></span><span>                         </span><span class="hs-comment">-- exist</span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="WriteCopy"><span class="annot"><a href="System.IO.MMap.html#WriteCopy"><span class="hs-identifier hs-var">WriteCopy</span></a></span></span><span>    </span><span class="hs-comment">-- ^ file is mapped read-write, but changes</span><span>
</span><span id="line-159"></span><span>                         </span><span class="hs-comment">-- aren't propagated to disk, file must exist</span><span>
</span><span id="line-160"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="ReadWriteEx"><span class="annot"><a href="System.IO.MMap.html#ReadWriteEx"><span class="hs-identifier hs-var">ReadWriteEx</span></a></span></span><span>  </span><span class="hs-comment">-- ^ file is mapped read-write, if file does</span><span>
</span><span id="line-161"></span><span>                         </span><span class="hs-comment">-- not exist it will be created with default</span><span>
</span><span id="line-162"></span><span>                         </span><span class="hs-comment">-- permissions, region parameter specifies</span><span>
</span><span id="line-163"></span><span>                         </span><span class="hs-comment">-- size, if file size is lower it will be</span><span>
</span><span id="line-164"></span><span>                         </span><span class="hs-comment">-- extended with zeros</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040029"><span id="local-6989586621679040031"><span class="annot"><span class="annottext">Mode -&gt; Mode -&gt; Bool
(Mode -&gt; Mode -&gt; Bool) -&gt; (Mode -&gt; Mode -&gt; Bool) -&gt; Eq Mode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Mode -&gt; Mode -&gt; Bool
== :: Mode -&gt; Mode -&gt; Bool
$c/= :: Mode -&gt; Mode -&gt; Bool
/= :: Mode -&gt; Mode -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span id="local-6989586621679040038"><span id="local-6989586621679040040"><span id="local-6989586621679040042"><span id="local-6989586621679040046"><span id="local-6989586621679040049"><span id="local-6989586621679040052"><span id="local-6989586621679040055"><span class="annot"><span class="annottext">Eq Mode
Eq Mode =&gt;
(Mode -&gt; Mode -&gt; Ordering)
-&gt; (Mode -&gt; Mode -&gt; Bool)
-&gt; (Mode -&gt; Mode -&gt; Bool)
-&gt; (Mode -&gt; Mode -&gt; Bool)
-&gt; (Mode -&gt; Mode -&gt; Bool)
-&gt; (Mode -&gt; Mode -&gt; Mode)
-&gt; (Mode -&gt; Mode -&gt; Mode)
-&gt; Ord Mode
Mode -&gt; Mode -&gt; Bool
Mode -&gt; Mode -&gt; Ordering
Mode -&gt; Mode -&gt; Mode
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Mode -&gt; Mode -&gt; Ordering
compare :: Mode -&gt; Mode -&gt; Ordering
$c&lt; :: Mode -&gt; Mode -&gt; Bool
&lt; :: Mode -&gt; Mode -&gt; Bool
$c&lt;= :: Mode -&gt; Mode -&gt; Bool
&lt;= :: Mode -&gt; Mode -&gt; Bool
$c&gt; :: Mode -&gt; Mode -&gt; Bool
&gt; :: Mode -&gt; Mode -&gt; Bool
$c&gt;= :: Mode -&gt; Mode -&gt; Bool
&gt;= :: Mode -&gt; Mode -&gt; Bool
$cmax :: Mode -&gt; Mode -&gt; Mode
max :: Mode -&gt; Mode -&gt; Mode
$cmin :: Mode -&gt; Mode -&gt; Mode
min :: Mode -&gt; Mode -&gt; Mode
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679040059"><span id="local-6989586621679040066"><span id="local-6989586621679040072"><span id="local-6989586621679040082"><span id="local-6989586621679040084"><span id="local-6989586621679040088"><span id="local-6989586621679040092"><span id="local-6989586621679040095"><span class="annot"><span class="annottext">Int -&gt; Mode
Mode -&gt; Int
Mode -&gt; [Mode]
Mode -&gt; Mode
Mode -&gt; Mode -&gt; [Mode]
Mode -&gt; Mode -&gt; Mode -&gt; [Mode]
(Mode -&gt; Mode)
-&gt; (Mode -&gt; Mode)
-&gt; (Int -&gt; Mode)
-&gt; (Mode -&gt; Int)
-&gt; (Mode -&gt; [Mode])
-&gt; (Mode -&gt; Mode -&gt; [Mode])
-&gt; (Mode -&gt; Mode -&gt; [Mode])
-&gt; (Mode -&gt; Mode -&gt; Mode -&gt; [Mode])
-&gt; Enum Mode
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: Mode -&gt; Mode
succ :: Mode -&gt; Mode
$cpred :: Mode -&gt; Mode
pred :: Mode -&gt; Mode
$ctoEnum :: Int -&gt; Mode
toEnum :: Int -&gt; Mode
$cfromEnum :: Mode -&gt; Int
fromEnum :: Mode -&gt; Int
$cenumFrom :: Mode -&gt; [Mode]
enumFrom :: Mode -&gt; [Mode]
$cenumFromThen :: Mode -&gt; Mode -&gt; [Mode]
enumFromThen :: Mode -&gt; Mode -&gt; [Mode]
$cenumFromTo :: Mode -&gt; Mode -&gt; [Mode]
enumFromTo :: Mode -&gt; Mode -&gt; [Mode]
$cenumFromThenTo :: Mode -&gt; Mode -&gt; Mode -&gt; [Mode]
enumFromThenTo :: Mode -&gt; Mode -&gt; Mode -&gt; [Mode]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#Enum"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679040099"><span id="local-6989586621679040101"><span id="local-6989586621679040105"><span class="annot"><span class="annottext">Int -&gt; Mode -&gt; ShowS
[Mode] -&gt; ShowS
Mode -&gt; String
(Int -&gt; Mode -&gt; ShowS)
-&gt; (Mode -&gt; String) -&gt; ([Mode] -&gt; ShowS) -&gt; Show Mode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Mode -&gt; ShowS
showsPrec :: Int -&gt; Mode -&gt; ShowS
$cshow :: Mode -&gt; String
show :: Mode -&gt; String
$cshowList :: [Mode] -&gt; ShowS
showList :: [Mode] -&gt; ShowS
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679040109"><span id="local-6989586621679040113"><span id="local-6989586621679040116"><span id="local-6989586621679040123"><span class="annot"><span class="annottext">ReadPrec [Mode]
ReadPrec Mode
Int -&gt; ReadS Mode
ReadS [Mode]
(Int -&gt; ReadS Mode)
-&gt; ReadS [Mode] -&gt; ReadPrec Mode -&gt; ReadPrec [Mode] -&gt; Read Mode
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS Mode
readsPrec :: Int -&gt; ReadS Mode
$creadList :: ReadS [Mode]
readList :: ReadS [Mode]
$creadPrec :: ReadPrec Mode
readPrec :: ReadPrec Mode
$creadListPrec :: ReadPrec [Mode]
readListPrec :: ReadPrec [Mode]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span id="local-6989586621679039872"><span class="annot"><a href="System.IO.MMap.html#sanitizeFileRegion"><span class="hs-identifier hs-type">sanitizeFileRegion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#Bounded"><span class="hs-identifier hs-type">Bounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#ForeignPtr"><span class="hs-identifier hs-type">ForeignPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-168"></span><span id="sanitizeFileRegion"><span class="annot"><span class="annottext">sanitizeFileRegion :: forall a.
(Integral a, Bounded a) =&gt;
String
-&gt; ForeignPtr () -&gt; Mode -&gt; Maybe (Int64, a) -&gt; IO (Int64, a)
</span><a href="System.IO.MMap.html#sanitizeFileRegion"><span class="hs-identifier hs-var hs-var">sanitizeFileRegion</span></a></span></span><span> </span><span id="local-6989586621679040187"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040187"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040188"><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040188"><span class="hs-identifier hs-var">handle'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="System.IO.MMap.html#ReadWriteEx"><span class="hs-identifier hs-var">ReadWriteEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679040189"><span class="annot"><span class="annottext">region :: (Int64, a)
</span><a href="#local-6989586621679040189"><span class="hs-identifier hs-var">region</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679040190"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040190"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040191"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040191"><span class="hs-identifier hs-var">length</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr () -&gt; (Ptr () -&gt; IO (Int64, a)) -&gt; IO (Int64, a)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#withForeignPtr"><span class="hs-identifier hs-var">withForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040188"><span class="hs-identifier hs-var">handle'</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr () -&gt; IO (Int64, a)) -&gt; IO (Int64, a))
-&gt; (Ptr () -&gt; IO (Int64, a)) -&gt; IO (Int64, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040192"><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040192"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>        </span><span id="local-6989586621679040193"><span class="annot"><span class="annottext">CLLong
</span><a href="#local-6989586621679040193"><span class="hs-identifier hs-var">longsize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr () -&gt; IO CLLong
</span><a href="System.IO.MMap.html#c_system_io_file_size"><span class="hs-identifier hs-var">c_system_io_file_size</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040192"><span class="hs-identifier hs-var">handle</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040206"><span class="annot"><span class="annottext">needsize :: CLLong
</span><a href="#local-6989586621679040206"><span class="hs-identifier hs-var hs-var">needsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; CLLong
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040190"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040191"><span class="hs-identifier hs-var">length</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLLong
</span><a href="#local-6989586621679040193"><span class="hs-identifier hs-var">longsize</span></a></span><span> </span><span class="annot"><span class="annottext">CLLong -&gt; CLLong -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">CLLong
</span><a href="#local-6989586621679040206"><span class="hs-identifier hs-var">needsize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO CInt -&gt; IO CInt
forall a. (Eq a, Num a) =&gt; String -&gt; String -&gt; IO a -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#throwErrnoPathIfMinus1"><span class="hs-identifier hs-var">throwErrnoPathIfMinus1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extend file size&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040187"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">(IO CInt -&gt; IO CInt) -&gt; IO CInt -&gt; IO CInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-174"></span><span>                   </span><span class="annot"><span class="annottext">Ptr () -&gt; CLLong -&gt; IO CInt
</span><a href="System.IO.MMap.html#c_system_io_extend_file_size"><span class="hs-identifier hs-var">c_system_io_extend_file_size</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040192"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">CLLong
</span><a href="#local-6989586621679040206"><span class="hs-identifier hs-var">needsize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO CInt -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">(Int64, a) -&gt; IO (Int64, a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64, a)
</span><a href="#local-6989586621679040189"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-176"></span><span class="annot"><a href="System.IO.MMap.html#sanitizeFileRegion"><span class="hs-identifier hs-var">sanitizeFileRegion</span></a></span><span> </span><span id="local-6989586621679040211"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040211"><span class="hs-identifier hs-var">_filepath</span></a></span></span><span> </span><span id="local-6989586621679040212"><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040212"><span class="hs-identifier hs-var">_handle</span></a></span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="System.IO.MMap.html#ReadWriteEx"><span class="hs-identifier hs-var">ReadWriteEx</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, a)
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Int64, a)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sanitizeRegion given ReadWriteEx with no region, please check earlier for this&quot;</span></span><span>
</span><span id="line-178"></span><span class="annot"><a href="System.IO.MMap.html#sanitizeFileRegion"><span class="hs-identifier hs-var">sanitizeFileRegion</span></a></span><span> </span><span id="local-6989586621679040214"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040214"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040215"><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040215"><span class="hs-identifier hs-var">handle'</span></a></span></span><span> </span><span id="local-6989586621679040216"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040216"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679040217"><span class="annot"><span class="annottext">Maybe (Int64, a)
</span><a href="#local-6989586621679040217"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr () -&gt; (Ptr () -&gt; IO (Int64, a)) -&gt; IO (Int64, a)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#withForeignPtr"><span class="hs-identifier hs-var">withForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040215"><span class="hs-identifier hs-var">handle'</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr () -&gt; IO (Int64, a)) -&gt; IO (Int64, a))
-&gt; (Ptr () -&gt; IO (Int64, a)) -&gt; IO (Int64, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040218"><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040218"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679040219"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040219"><span class="hs-identifier hs-var">longsize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr () -&gt; IO CLLong
</span><a href="System.IO.MMap.html#c_system_io_file_size"><span class="hs-identifier hs-var">c_system_io_file_size</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040218"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">IO CLLong -&gt; (CLLong -&gt; IO Int64) -&gt; IO Int64
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040220"><span class="annot"><span class="annottext">CLLong
</span><a href="#local-6989586621679040220"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO Int64
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLLong -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CLLong
</span><a href="#local-6989586621679040220"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679040221"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040221"><span class="hs-identifier hs-var">sizetype</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, a)
</span><a href="#local-6989586621679040217"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679040222"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040222"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040223"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040223"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, a)
</span><a href="#local-6989586621679040217"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040224"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040224"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040225"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040225"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040225"><span class="hs-identifier hs-var">size</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-184"></span><span>                 </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall a. IOError -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Errno -&gt; Maybe Handle -&gt; Maybe String -&gt; IOError
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#errnoToIOError"><span class="hs-identifier hs-var">errnoToIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mmap negative size reguested&quot;</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#eINVAL"><span class="hs-identifier hs-var">eINVAL</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Handle
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040214"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040224"><span class="hs-identifier hs-var">offset</span></a></span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-186"></span><span>                 </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall a. IOError -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Errno -&gt; Maybe Handle -&gt; Maybe String -&gt; IOError
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#errnoToIOError"><span class="hs-identifier hs-var">errnoToIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mmap negative offset reguested&quot;</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#eINVAL"><span class="hs-identifier hs-var">eINVAL</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Handle
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040214"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040216"><span class="hs-identifier hs-var">mode</span></a></span><span class="annot"><span class="annottext">Mode -&gt; Mode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span class="annot"><span class="annottext">Mode
</span><a href="System.IO.MMap.html#ReadWriteEx"><span class="hs-identifier hs-var">ReadWriteEx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040219"><span class="hs-identifier hs-var">longsize</span></a></span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040224"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040219"><span class="hs-identifier hs-var">longsize</span></a></span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040224"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040225"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-188"></span><span>                 </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall a. IOError -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Errno -&gt; Maybe Handle -&gt; Maybe String -&gt; IOError
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#errnoToIOError"><span class="hs-identifier hs-var">errnoToIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mmap offset and size beyond end of file&quot;</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#eINVAL"><span class="hs-identifier hs-var">eINVAL</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Handle
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040214"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>            </span><span class="annot"><span class="annottext">(Int64, a) -&gt; IO (Int64, a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040224"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040225"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Int64, a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040219"><span class="hs-identifier hs-var">longsize</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Bounded a =&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#maxBound"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#asTypeOf"><span class="hs-operator hs-var">`asTypeOf`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040221"><span class="hs-identifier hs-var">sizetype</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-192"></span><span>                 </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall a. IOError -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Errno -&gt; Maybe Handle -&gt; Maybe String -&gt; IOError
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#errnoToIOError"><span class="hs-identifier hs-var">errnoToIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mmap requested size is greater then maxBound&quot;</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#eINVAL"><span class="hs-identifier hs-var">eINVAL</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Handle
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040214"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>            </span><span class="annot"><span class="annottext">(Int64, a) -&gt; IO (Int64, a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int64 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040219"><span class="hs-identifier hs-var">longsize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">(Int64, a) -&gt; IO (Int64, a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040222"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040223"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621679039903"><span class="annot"><a href="System.IO.MMap.html#checkModeRegion"><span class="hs-identifier hs-type">checkModeRegion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039903"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-197"></span><span id="checkModeRegion"><span class="annot"><span class="annottext">checkModeRegion :: forall a. String -&gt; Mode -&gt; Maybe a -&gt; IO ()
</span><a href="System.IO.MMap.html#checkModeRegion"><span class="hs-identifier hs-var hs-var">checkModeRegion</span></a></span></span><span> </span><span id="local-6989586621679040238"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040238"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="System.IO.MMap.html#ReadWriteEx"><span class="hs-identifier hs-var">ReadWriteEx</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall a. IOError -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Errno -&gt; Maybe Handle -&gt; Maybe String -&gt; IOError
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#errnoToIOError"><span class="hs-identifier hs-var">errnoToIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mmap ReadWriteEx must have explicit region&quot;</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#eINVAL"><span class="hs-identifier hs-var">eINVAL</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Handle
forall a. Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040238"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span class="annot"><a href="System.IO.MMap.html#checkModeRegion"><span class="hs-identifier hs-var">checkModeRegion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | The 'mmapFilePtr' function maps a file or device into memory,</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- returning a tuple @(ptr,rawsize,offset,size)@ where:</span><span>
</span><span id="line-203"></span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- * @ptr@ is pointer to mmapped region</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- * @rawsize@ is length (in bytes) of mapped data, rawsize might be</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- greater than size because of alignment</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- * @offset@ tell where your data lives: @plusPtr ptr offset@</span><span>
</span><span id="line-210"></span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- * @size@ your data length (in bytes)</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- If 'mmapFilePtr' fails for some reason, a 'throwErrno' is used.</span><span>
</span><span id="line-214"></span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- Use @munmapFilePtr ptr rawsize@ to unmap memory.</span><span>
</span><span id="line-216"></span><span class="hs-comment">--</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- Memory mapped files will behave as if they were read lazily</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- pages from the file will be loaded into memory on demand.</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621679039905"><span class="annot"><a href="System.IO.MMap.html#mmapFilePtr"><span class="hs-identifier hs-type">mmapFilePtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ name of file to mmap</span></span><span>
</span><span id="line-222"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>                         </span><span class="annot"><span class="hs-comment">-- ^ access mode</span></span><span>
</span><span id="line-223"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>            </span><span class="annot"><span class="hs-comment">-- ^ range to map, maps whole file if Nothing</span></span><span>
</span><span id="line-224"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039905"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ (ptr,rawsize,offset,size)</span></span><span>
</span><span id="line-225"></span><span id="mmapFilePtr"><span class="annot"><span class="annottext">mmapFilePtr :: forall a.
String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (Ptr a, Int, Int, Int)
</span><a href="System.IO.MMap.html#mmapFilePtr"><span class="hs-identifier hs-var hs-var">mmapFilePtr</span></a></span></span><span> </span><span id="local-6989586621679040241"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040241"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040242"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040242"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679040243"><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040243"><span class="hs-identifier hs-var">offsetsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO ()
forall a. String -&gt; Mode -&gt; Maybe a -&gt; IO ()
</span><a href="System.IO.MMap.html#checkModeRegion"><span class="hs-identifier hs-var">checkModeRegion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040241"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040242"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040243"><span class="hs-identifier hs-var">offsetsize</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">IO (ForeignPtr ())
-&gt; (ForeignPtr () -&gt; IO ())
-&gt; (ForeignPtr () -&gt; IO (Ptr a, Int, Int, Int))
-&gt; IO (Ptr a, Int, Int, Int)
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#bracket"><span class="hs-identifier hs-var">E.bracket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; IO (ForeignPtr ())
</span><a href="System.IO.MMap.html#mmapFileOpen"><span class="hs-identifier hs-var">mmapFileOpen</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040241"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040242"><span class="hs-identifier hs-var">mode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr () -&gt; IO ()
forall a. ForeignPtr a -&gt; IO ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#finalizeForeignPtr"><span class="hs-identifier hs-var">finalizeForeignPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignPtr () -&gt; IO (Ptr a, Int, Int, Int)
forall {c} {b}. Num c =&gt; ForeignPtr () -&gt; IO (Ptr b, Int, c, Int)
</span><a href="#local-6989586621679040245"><span class="hs-identifier hs-var">mmap</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>        </span><span id="local-6989586621679040245"><span class="annot"><span class="annottext">mmap :: ForeignPtr () -&gt; IO (Ptr b, Int, c, Int)
</span><a href="#local-6989586621679040245"><span class="hs-identifier hs-var hs-var">mmap</span></a></span></span><span> </span><span id="local-6989586621679040266"><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040266"><span class="hs-identifier hs-var">handle'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679040267"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040267"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040268"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040268"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ForeignPtr () -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (Int64, Int)
forall a.
(Integral a, Bounded a) =&gt;
String
-&gt; ForeignPtr () -&gt; Mode -&gt; Maybe (Int64, a) -&gt; IO (Int64, a)
</span><a href="System.IO.MMap.html#sanitizeFileRegion"><span class="hs-identifier hs-var">sanitizeFileRegion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040241"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040266"><span class="hs-identifier hs-var">handle'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040242"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040243"><span class="hs-identifier hs-var">offsetsize</span></a></span><span>
</span><span id="line-232"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040272"><span class="annot"><span class="annottext">align :: Int64
</span><a href="#local-6989586621679040272"><span class="hs-identifier hs-var hs-var">align</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040267"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="System.IO.MMap.html#c_system_io_granularity"><span class="hs-identifier hs-var">c_system_io_granularity</span></a></span><span>
</span><span id="line-233"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040276"><span class="annot"><span class="annottext">offsetraw :: Int64
</span><a href="#local-6989586621679040276"><span class="hs-identifier hs-var hs-var">offsetraw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040267"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040272"><span class="hs-identifier hs-var">align</span></a></span><span>
</span><span id="line-234"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040280"><span class="annot"><span class="annottext">sizeraw :: Int
</span><a href="#local-6989586621679040280"><span class="hs-identifier hs-var hs-var">sizeraw</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040268"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040272"><span class="hs-identifier hs-var">align</span></a></span><span>
</span><span id="line-235"></span><span>            </span><span id="local-6989586621679040281"><span class="annot"><span class="annottext">Ptr Any
</span><a href="#local-6989586621679040281"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr () -&gt; (Ptr () -&gt; IO (Ptr Any)) -&gt; IO (Ptr Any)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#withForeignPtr"><span class="hs-identifier hs-var">withForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040266"><span class="hs-identifier hs-var">handle'</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr () -&gt; IO (Ptr Any)) -&gt; IO (Ptr Any))
-&gt; (Ptr () -&gt; IO (Ptr Any)) -&gt; IO (Ptr Any)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040282"><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040282"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>                   </span><span class="annot"><span class="annottext">Ptr () -&gt; CInt -&gt; CLLong -&gt; CSize -&gt; IO (Ptr Any)
forall a. Ptr () -&gt; CInt -&gt; CLLong -&gt; CSize -&gt; IO (Ptr a)
</span><a href="System.IO.MMap.html#c_system_io_mmap_mmap"><span class="hs-identifier hs-var">c_system_io_mmap_mmap</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040282"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; CInt) -&gt; Int -&gt; CInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040242"><span class="hs-identifier hs-var">mode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>                                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; CLLong
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040276"><span class="hs-identifier hs-var">offsetraw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040280"><span class="hs-identifier hs-var">sizeraw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Any
</span><a href="#local-6989586621679040281"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Any -&gt; Ptr Any -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Any
forall a. Ptr a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#nullPtr"><span class="hs-identifier hs-var">nullPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-239"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
forall a. String -&gt; String -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#throwErrnoPath"><span class="hs-identifier hs-var">throwErrnoPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mmap of '&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040241"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;' failed&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040241"><span class="hs-identifier hs-var">filepath</span></a></span><span>
</span><span id="line-240"></span><span>            </span><span class="annot"><span class="annottext">(Ptr b, Int, c, Int) -&gt; IO (Ptr b, Int, c, Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Any -&gt; Ptr b
forall a b. Ptr a -&gt; Ptr b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Any
</span><a href="#local-6989586621679040281"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040280"><span class="hs-identifier hs-var">sizeraw</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int64 -&gt; c
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040272"><span class="hs-identifier hs-var">align</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040268"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | Memory map region of file using autounmap semantics. See</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- 'mmapFilePtr' for description of parameters.  The @action@ will be</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- executed with tuple @(ptr,size)@ as single argument. This is the</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- pointer to mapped data already adjusted and size of requested</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- region. Return value is that of action.</span><span>
</span><span id="line-247"></span><span id="local-6989586621679039920"><span class="annot"><a href="System.IO.MMap.html#mmapWithFilePtr"><span class="hs-identifier hs-type">mmapWithFilePtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>                        </span><span class="annot"><span class="hs-comment">-- ^ name of file to mmap</span></span><span>
</span><span id="line-248"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>                            </span><span class="annot"><span class="hs-comment">-- ^ access mode</span></span><span>
</span><span id="line-249"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>               </span><span class="annot"><span class="hs-comment">-- ^ range to map, maps whole file if Nothing</span></span><span>
</span><span id="line-250"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039920"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>          </span><span class="annot"><span class="hs-comment">-- ^ action to run</span></span><span>
</span><span id="line-251"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039920"><span class="hs-identifier hs-type">a</span></a></span></span><span>                            </span><span class="annot"><span class="hs-comment">-- ^ result of action</span></span><span>
</span><span id="line-252"></span><span id="mmapWithFilePtr"><span class="annot"><span class="annottext">mmapWithFilePtr :: forall a.
String
-&gt; Mode -&gt; Maybe (Int64, Int) -&gt; ((Ptr (), Int) -&gt; IO a) -&gt; IO a
</span><a href="System.IO.MMap.html#mmapWithFilePtr"><span class="hs-identifier hs-var hs-var">mmapWithFilePtr</span></a></span></span><span> </span><span id="local-6989586621679040289"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040289"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040290"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040290"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679040291"><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040291"><span class="hs-identifier hs-var">offsetsize</span></a></span></span><span> </span><span id="local-6989586621679040292"><span class="annot"><span class="annottext">(Ptr (), Int) -&gt; IO a
</span><a href="#local-6989586621679040292"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO ()
forall a. String -&gt; Mode -&gt; Maybe a -&gt; IO ()
</span><a href="System.IO.MMap.html#checkModeRegion"><span class="hs-identifier hs-var">checkModeRegion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040289"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040290"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040291"><span class="hs-identifier hs-var">offsetsize</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679040293"><span class="annot"><span class="annottext">Ptr Any
</span><a href="#local-6989586621679040293"><span class="hs-identifier hs-var">ptr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040294"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040294"><span class="hs-identifier hs-var">rawsize</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040295"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040295"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040296"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040296"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (Ptr Any, Int, Int, Int)
forall a.
String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (Ptr a, Int, Int, Int)
</span><a href="System.IO.MMap.html#mmapFilePtr"><span class="hs-identifier hs-var">mmapFilePtr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040289"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040290"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040291"><span class="hs-identifier hs-var">offsetsize</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679040297"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040297"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ptr (), Int) -&gt; IO a
</span><a href="#local-6989586621679040292"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Any
</span><a href="#local-6989586621679040293"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Any -&gt; Int -&gt; Ptr ()
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#plusPtr"><span class="hs-operator hs-var">`plusPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040295"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040296"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO () -&gt; IO a
forall a b. IO a -&gt; IO b -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#finally"><span class="hs-operator hs-var">`E.finally`</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Any -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Int -&gt; IO ()
</span><a href="System.IO.MMap.html#munmapFilePtr"><span class="hs-identifier hs-var">munmapFilePtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Any
</span><a href="#local-6989586621679040293"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040294"><span class="hs-identifier hs-var">rawsize</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040297"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><span class="hs-comment">-- | Maps region of file and returns it as 'ForeignPtr'. See 'mmapFilePtr' for details.</span></span><span>
</span><span id="line-259"></span><span id="local-6989586621679039927"><span class="annot"><a href="System.IO.MMap.html#mmapFileForeignPtr"><span class="hs-identifier hs-type">mmapFileForeignPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ name of file to map</span></span><span>
</span><span id="line-260"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>                         </span><span class="annot"><span class="hs-comment">-- ^ access mode</span></span><span>
</span><span id="line-261"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>            </span><span class="annot"><span class="hs-comment">-- ^ range to map, maps whole file if Nothing</span></span><span>
</span><span id="line-262"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#ForeignPtr"><span class="hs-identifier hs-type">ForeignPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span></span><span>    </span><span class="hs-comment">-- ^ foreign pointer to beginning of raw region,</span><span>
</span><span id="line-263"></span><span>                                                   </span><span class="hs-comment">-- offset to your data and size of your data</span><span>
</span><span id="line-264"></span><span id="mmapFileForeignPtr"><span class="annot"><span class="annottext">mmapFileForeignPtr :: forall a.
String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (ForeignPtr a, Int, Int)
</span><a href="System.IO.MMap.html#mmapFileForeignPtr"><span class="hs-identifier hs-var hs-var">mmapFileForeignPtr</span></a></span></span><span> </span><span id="local-6989586621679040302"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040302"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040303"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040303"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679040304"><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040304"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO ()
forall a. String -&gt; Mode -&gt; Maybe a -&gt; IO ()
</span><a href="System.IO.MMap.html#checkModeRegion"><span class="hs-identifier hs-var">checkModeRegion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040302"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040303"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040304"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679040305"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679040305"><span class="hs-identifier hs-var">rawptr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040306"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040306"><span class="hs-identifier hs-var">rawsize</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040307"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040307"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040308"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040308"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (Ptr a, Int, Int, Int)
forall a.
String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (Ptr a, Int, Int, Int)
</span><a href="System.IO.MMap.html#mmapFilePtr"><span class="hs-identifier hs-var">mmapFilePtr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040302"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040303"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040304"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040309"><span class="annot"><span class="annottext">rawsizeptr :: Ptr a
</span><a href="#local-6989586621679040309"><span class="hs-identifier hs-var hs-var">rawsizeptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Ptr a
forall a. Int -&gt; Ptr a
</span><a href="System.IO.MMap.html#castIntToPtr"><span class="hs-identifier hs-var">castIntToPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040306"><span class="hs-identifier hs-var">rawsize</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679040311"><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679040311"><span class="hs-identifier hs-var">foreignptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FinalizerEnvPtr () a -&gt; Ptr () -&gt; Ptr a -&gt; IO (ForeignPtr a)
forall env a.
FinalizerEnvPtr env a -&gt; Ptr env -&gt; Ptr a -&gt; IO (ForeignPtr a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.ForeignPtr.Imp.html#newForeignPtrEnv"><span class="hs-identifier hs-var">newForeignPtrEnv</span></a></span><span> </span><span class="annot"><span class="annottext">FinalizerEnvPtr () a
forall a. FunPtr (Ptr () -&gt; Ptr a -&gt; IO ())
</span><a href="System.IO.MMap.html#c_system_io_mmap_munmap_funptr"><span class="hs-identifier hs-var">c_system_io_mmap_munmap_funptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
forall a. Ptr a
</span><a href="#local-6989586621679040309"><span class="hs-identifier hs-var">rawsizeptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679040305"><span class="hs-identifier hs-var">rawptr</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><span class="annottext">(ForeignPtr a, Int, Int) -&gt; IO (ForeignPtr a, Int, Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679040311"><span class="hs-identifier hs-var">foreignptr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040307"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040308"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | Maps region of file and returns it as 'BS.ByteString'.  File is</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- mapped in in 'ReadOnly' mode. See 'mmapFilePtr' for details.</span><span>
</span><span id="line-273"></span><span class="annot"><a href="System.IO.MMap.html#mmapFileByteString"><span class="hs-identifier hs-type">mmapFileByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ name of file to map</span></span><span>
</span><span id="line-274"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>            </span><span class="annot"><span class="hs-comment">-- ^ range to map, maps whole file if Nothing</span></span><span>
</span><span id="line-275"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ bytestring with file contents</span></span><span>
</span><span id="line-276"></span><span id="mmapFileByteString"><span class="annot"><span class="annottext">mmapFileByteString :: String -&gt; Maybe (Int64, Int) -&gt; IO ByteString
</span><a href="System.IO.MMap.html#mmapFileByteString"><span class="hs-identifier hs-var hs-var">mmapFileByteString</span></a></span></span><span> </span><span id="local-6989586621679040313"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040313"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040314"><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040314"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679040315"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679040315"><span class="hs-identifier hs-var">foreignptr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040316"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040316"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040317"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040317"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (ForeignPtr Word8, Int, Int)
forall a.
String -&gt; Mode -&gt; Maybe (Int64, Int) -&gt; IO (ForeignPtr a, Int, Int)
</span><a href="System.IO.MMap.html#mmapFileForeignPtr"><span class="hs-identifier hs-var">mmapFileForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040313"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="System.IO.MMap.html#ReadOnly"><span class="hs-identifier hs-var">ReadOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int)
</span><a href="#local-6989586621679040314"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040318"><span class="annot"><span class="annottext">bytestring :: ByteString
</span><a href="#local-6989586621679040318"><span class="hs-identifier hs-var hs-var">bytestring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; Int -&gt; ByteString
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Internal.Type.html#fromForeignPtr"><span class="hs-identifier hs-var">BS.fromForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679040315"><span class="hs-identifier hs-var">foreignptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040316"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040317"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679040318"><span class="hs-identifier hs-var">bytestring</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | The 'mmapFileForeignPtrLazy' function maps a file or device into</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- memory, returning a list of tuples with the same meaning as in</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- function 'mmapFileForeignPtr'.</span><span>
</span><span id="line-284"></span><span class="hs-comment">--</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- Chunks are really mapped into memory at the first inspection of a</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- chunk. They are kept in memory while they are referenced, garbage</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- collector takes care of the later.</span><span>
</span><span id="line-288"></span><span class="hs-comment">--</span><span>
</span><span id="line-289"></span><span id="local-6989586621679039936"><span class="annot"><a href="System.IO.MMap.html#mmapFileForeignPtrLazy"><span class="hs-identifier hs-type">mmapFileForeignPtrLazy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>                    </span><span class="annot"><span class="hs-comment">-- ^ name of file to mmap</span></span><span>
</span><span id="line-290"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>                        </span><span class="annot"><span class="hs-comment">-- ^ access mode</span></span><span>
</span><span id="line-291"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="hs-comment">-- ^ range to map, maps whole file if Nothing</span></span><span>
</span><span id="line-292"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#ForeignPtr"><span class="hs-identifier hs-type">ForeignPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ (ptr,offset,size)</span></span><span>
</span><span id="line-293"></span><span id="mmapFileForeignPtrLazy"><span class="annot"><span class="annottext">mmapFileForeignPtrLazy :: forall a.
String
-&gt; Mode -&gt; Maybe (Int64, Int64) -&gt; IO [(ForeignPtr a, Int, Int)]
</span><a href="System.IO.MMap.html#mmapFileForeignPtrLazy"><span class="hs-identifier hs-var hs-var">mmapFileForeignPtrLazy</span></a></span></span><span> </span><span id="local-6989586621679040320"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040320"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040321"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040321"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679040322"><span class="annot"><span class="annottext">Maybe (Int64, Int64)
</span><a href="#local-6989586621679040322"><span class="hs-identifier hs-var">offsetsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; Maybe (Int64, Int64) -&gt; IO ()
forall a. String -&gt; Mode -&gt; Maybe a -&gt; IO ()
</span><a href="System.IO.MMap.html#checkModeRegion"><span class="hs-identifier hs-var">checkModeRegion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040320"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040321"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int64)
</span><a href="#local-6989586621679040322"><span class="hs-identifier hs-var">offsetsize</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">IO (ForeignPtr ())
-&gt; (ForeignPtr () -&gt; IO ())
-&gt; (ForeignPtr () -&gt; IO [(ForeignPtr a, Int, Int)])
-&gt; IO [(ForeignPtr a, Int, Int)]
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#bracketOnError"><span class="hs-identifier hs-var">E.bracketOnError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; IO (ForeignPtr ())
</span><a href="System.IO.MMap.html#mmapFileOpen"><span class="hs-identifier hs-var">mmapFileOpen</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040320"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040321"><span class="hs-identifier hs-var">mode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr () -&gt; IO ()
forall a. ForeignPtr a -&gt; IO ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#finalizeForeignPtr"><span class="hs-identifier hs-var">finalizeForeignPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignPtr () -&gt; IO [(ForeignPtr a, Int, Int)]
forall {a}. ForeignPtr () -&gt; IO [(ForeignPtr a, Int, Int)]
</span><a href="#local-6989586621679040323"><span class="hs-identifier hs-var">mmap</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>        </span><span id="local-6989586621679040323"><span class="annot"><span class="annottext">mmap :: ForeignPtr () -&gt; IO [(ForeignPtr a, Int, Int)]
</span><a href="#local-6989586621679040323"><span class="hs-identifier hs-var hs-var">mmap</span></a></span></span><span> </span><span id="local-6989586621679040329"><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040329"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679040330"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040330"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040331"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040331"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ForeignPtr ()
-&gt; Mode
-&gt; Maybe (Int64, Int64)
-&gt; IO (Int64, Int64)
forall a.
(Integral a, Bounded a) =&gt;
String
-&gt; ForeignPtr () -&gt; Mode -&gt; Maybe (Int64, a) -&gt; IO (Int64, a)
</span><a href="System.IO.MMap.html#sanitizeFileRegion"><span class="hs-identifier hs-var">sanitizeFileRegion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040320"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040329"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040321"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int64)
</span><a href="#local-6989586621679040322"><span class="hs-identifier hs-var">offsetsize</span></a></span><span>
</span><span id="line-300"></span><span>            </span><span class="annot"><span class="annottext">[(ForeignPtr a, Int, Int)] -&gt; IO [(ForeignPtr a, Int, Int)]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([(ForeignPtr a, Int, Int)] -&gt; IO [(ForeignPtr a, Int, Int)])
-&gt; [(ForeignPtr a, Int, Int)] -&gt; IO [(ForeignPtr a, Int, Int)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Int64, Int) -&gt; (ForeignPtr a, Int, Int))
-&gt; [(Int64, Int)] -&gt; [(ForeignPtr a, Int, Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; Mode
-&gt; ForeignPtr ()
-&gt; (Int64, Int)
-&gt; (ForeignPtr a, Int, Int)
forall a.
String
-&gt; Mode
-&gt; ForeignPtr ()
-&gt; (Int64, Int)
-&gt; (ForeignPtr a, Int, Int)
</span><a href="System.IO.MMap.html#mmapFileForeignPtrLazyChunk"><span class="hs-identifier hs-var">mmapFileForeignPtrLazyChunk</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040320"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040321"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040329"><span class="hs-identifier hs-var">handle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; [(Int64, Int)]
</span><a href="System.IO.MMap.html#chunks"><span class="hs-identifier hs-var">chunks</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040330"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040331"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="System.IO.MMap.html#mmapFileForeignPtrLazyChunk"><span class="hs-pragma hs-type">mmapFileForeignPtrLazyChunk</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-304"></span><span id="local-6989586621679039941"><span class="annot"><a href="System.IO.MMap.html#mmapFileForeignPtrLazyChunk"><span class="hs-identifier hs-type">mmapFileForeignPtrLazyChunk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-305"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>
</span><span id="line-306"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#ForeignPtr"><span class="hs-identifier hs-type">ForeignPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#ForeignPtr"><span class="hs-identifier hs-type">ForeignPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-309"></span><span id="mmapFileForeignPtrLazyChunk"><span class="annot"><span class="annottext">mmapFileForeignPtrLazyChunk :: forall a.
String
-&gt; Mode
-&gt; ForeignPtr ()
-&gt; (Int64, Int)
-&gt; (ForeignPtr a, Int, Int)
</span><a href="System.IO.MMap.html#mmapFileForeignPtrLazyChunk"><span class="hs-identifier hs-var hs-var">mmapFileForeignPtrLazyChunk</span></a></span></span><span> </span><span id="local-6989586621679040352"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040352"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040353"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040353"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679040354"><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040354"><span class="hs-identifier hs-var">handle'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040355"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040355"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040356"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040356"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (ForeignPtr a, Int, Int) -&gt; (ForeignPtr a, Int, Int)
forall a. IO a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (ForeignPtr a, Int, Int) -&gt; (ForeignPtr a, Int, Int))
-&gt; IO (ForeignPtr a, Int, Int) -&gt; (ForeignPtr a, Int, Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr ()
-&gt; (Ptr () -&gt; IO (ForeignPtr a, Int, Int))
-&gt; IO (ForeignPtr a, Int, Int)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#withForeignPtr"><span class="hs-identifier hs-var">withForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040354"><span class="hs-identifier hs-var">handle'</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr () -&gt; IO (ForeignPtr a, Int, Int))
 -&gt; IO (ForeignPtr a, Int, Int))
-&gt; (Ptr () -&gt; IO (ForeignPtr a, Int, Int))
-&gt; IO (ForeignPtr a, Int, Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040357"><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040357"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040361"><span class="annot"><span class="annottext">align :: Int64
</span><a href="#local-6989586621679040361"><span class="hs-identifier hs-var hs-var">align</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040355"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="System.IO.MMap.html#c_system_io_granularity"><span class="hs-identifier hs-var">c_system_io_granularity</span></a></span><span>
</span><span id="line-312"></span><span>            </span><span id="local-6989586621679040363"><span class="annot"><span class="annottext">offsetraw :: Int64
</span><a href="#local-6989586621679040363"><span class="hs-identifier hs-var hs-var">offsetraw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040355"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040361"><span class="hs-identifier hs-var">align</span></a></span><span>
</span><span id="line-313"></span><span>            </span><span id="local-6989586621679040367"><span class="annot"><span class="annottext">sizeraw :: Int
</span><a href="#local-6989586621679040367"><span class="hs-identifier hs-var hs-var">sizeraw</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040356"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040361"><span class="hs-identifier hs-var">align</span></a></span><span>
</span><span id="line-314"></span><span>        </span><span id="local-6989586621679040368"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679040368"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr () -&gt; CInt -&gt; CLLong -&gt; CSize -&gt; IO (Ptr a)
forall a. Ptr () -&gt; CInt -&gt; CLLong -&gt; CSize -&gt; IO (Ptr a)
</span><a href="System.IO.MMap.html#c_system_io_mmap_mmap"><span class="hs-identifier hs-var">c_system_io_mmap_mmap</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040357"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; CInt) -&gt; Int -&gt; CInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040353"><span class="hs-identifier hs-var">mode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; CLLong
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040363"><span class="hs-identifier hs-var">offsetraw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040367"><span class="hs-identifier hs-var">sizeraw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679040368"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a -&gt; Ptr a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
forall a. Ptr a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#nullPtr"><span class="hs-identifier hs-var">nullPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
forall a. String -&gt; String -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#throwErrnoPath"><span class="hs-identifier hs-var">throwErrnoPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lazy mmap of '&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040352"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-318"></span><span>                            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;' chunk(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040355"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040356"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) failed&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040352"><span class="hs-identifier hs-var">filepath</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040370"><span class="annot"><span class="annottext">rawsizeptr :: Ptr a
</span><a href="#local-6989586621679040370"><span class="hs-identifier hs-var hs-var">rawsizeptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Ptr a
forall a. Int -&gt; Ptr a
</span><a href="System.IO.MMap.html#castIntToPtr"><span class="hs-identifier hs-var">castIntToPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040367"><span class="hs-identifier hs-var">sizeraw</span></a></span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621679040371"><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679040371"><span class="hs-identifier hs-var">foreignptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FinalizerEnvPtr () a -&gt; Ptr () -&gt; Ptr a -&gt; IO (ForeignPtr a)
forall env a.
FinalizerEnvPtr env a -&gt; Ptr env -&gt; Ptr a -&gt; IO (ForeignPtr a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.ForeignPtr.Imp.html#newForeignPtrEnv"><span class="hs-identifier hs-var">newForeignPtrEnv</span></a></span><span> </span><span class="annot"><span class="annottext">FinalizerEnvPtr () a
forall a. FunPtr (Ptr () -&gt; Ptr a -&gt; IO ())
</span><a href="System.IO.MMap.html#c_system_io_mmap_munmap_funptr"><span class="hs-identifier hs-var">c_system_io_mmap_munmap_funptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
forall a. Ptr a
</span><a href="#local-6989586621679040370"><span class="hs-identifier hs-var">rawsizeptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679040368"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-321"></span><span>        </span><span class="annot"><span class="annottext">(ForeignPtr a, Int, Int) -&gt; IO (ForeignPtr a, Int, Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679040371"><span class="hs-identifier hs-var">foreignptr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040355"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040356"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="annot"><a href="System.IO.MMap.html#chunks"><span class="hs-identifier hs-type">chunks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-324"></span><span id="chunks"><span class="annot"><span class="annottext">chunks :: Int64 -&gt; Int64 -&gt; [(Int64, Int)]
</span><a href="System.IO.MMap.html#chunks"><span class="hs-identifier hs-var hs-var">chunks</span></a></span></span><span> </span><span id="local-6989586621679040372"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040372"><span class="hs-identifier hs-var">_offset</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span class="annot"><a href="System.IO.MMap.html#chunks"><span class="hs-identifier hs-var">chunks</span></a></span><span> </span><span id="local-6989586621679040373"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040373"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span id="local-6989586621679040374"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040374"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040374"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="System.IO.MMap.html#chunkSize"><span class="hs-identifier hs-var">chunkSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040373"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040374"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040384"><span class="annot"><span class="annottext">offset2 :: Int64
</span><a href="#local-6989586621679040384"><span class="hs-identifier hs-var hs-var">offset2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040373"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040385"><span class="hs-identifier hs-var">chunkSizeLong</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040385"><span class="hs-identifier hs-var">chunkSizeLong</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040385"><span class="hs-identifier hs-var">chunkSizeLong</span></a></span><span>
</span><span id="line-327"></span><span>                                     </span><span id="local-6989586621679040389"><span class="annot"><span class="annottext">size2 :: Int64
</span><a href="#local-6989586621679040389"><span class="hs-identifier hs-var hs-var">size2</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040384"><span class="hs-identifier hs-var">offset2</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040373"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-328"></span><span>                                     </span><span id="local-6989586621679040385"><span class="annot"><span class="annottext">chunkSizeLong :: Int64
</span><a href="#local-6989586621679040385"><span class="hs-identifier hs-var hs-var">chunkSizeLong</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="System.IO.MMap.html#chunkSize"><span class="hs-identifier hs-var">chunkSize</span></a></span><span>
</span><span id="line-329"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040373"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040389"><span class="hs-identifier hs-var">size2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int64, Int) -&gt; [(Int64, Int)] -&gt; [(Int64, Int)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; [(Int64, Int)]
</span><a href="System.IO.MMap.html#chunks"><span class="hs-identifier hs-var">chunks</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040384"><span class="hs-identifier hs-var">offset2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040374"><span class="hs-identifier hs-var">size</span></a></span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679040389"><span class="hs-identifier hs-var">size2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">-- | Maps region of file and returns it as 'BSL.ByteString'. File is</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- mapped in in 'ReadOnly' mode. See 'mmapFileForeignPtrLazy' for</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- details.</span><span>
</span><span id="line-334"></span><span class="annot"><a href="System.IO.MMap.html#mmapFileByteStringLazy"><span class="hs-identifier hs-type">mmapFileByteStringLazy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ name of file to map</span></span><span>
</span><span id="line-335"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>          </span><span class="annot"><span class="hs-comment">-- ^ range to map, maps whole file if Nothing</span></span><span>
</span><span id="line-336"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BSL.ByteString</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ bytestring with file content</span></span><span>
</span><span id="line-337"></span><span id="mmapFileByteStringLazy"><span class="annot"><span class="annottext">mmapFileByteStringLazy :: String -&gt; Maybe (Int64, Int64) -&gt; IO ByteString
</span><a href="System.IO.MMap.html#mmapFileByteStringLazy"><span class="hs-identifier hs-var hs-var">mmapFileByteStringLazy</span></a></span></span><span> </span><span id="local-6989586621679040392"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040392"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span id="local-6989586621679040393"><span class="annot"><span class="annottext">Maybe (Int64, Int64)
</span><a href="#local-6989586621679040393"><span class="hs-identifier hs-var">offsetsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679040394"><span class="annot"><span class="annottext">[(ForeignPtr Word8, Int, Int)]
</span><a href="#local-6989586621679040394"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Mode
-&gt; Maybe (Int64, Int64)
-&gt; IO [(ForeignPtr Word8, Int, Int)]
forall a.
String
-&gt; Mode -&gt; Maybe (Int64, Int64) -&gt; IO [(ForeignPtr a, Int, Int)]
</span><a href="System.IO.MMap.html#mmapFileForeignPtrLazy"><span class="hs-identifier hs-var">mmapFileForeignPtrLazy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040392"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="System.IO.MMap.html#ReadOnly"><span class="hs-identifier hs-var">ReadOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int64, Int64)
</span><a href="#local-6989586621679040393"><span class="hs-identifier hs-var">offsetsize</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Lazy.html#fromChunks"><span class="hs-identifier hs-var">BSL.fromChunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ForeignPtr Word8, Int, Int) -&gt; ByteString)
-&gt; [(ForeignPtr Word8, Int, Int)] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(ForeignPtr Word8, Int, Int) -&gt; ByteString
</span><a href="#local-6989586621679040395"><span class="hs-identifier hs-var">turn</span></a></span><span> </span><span class="annot"><span class="annottext">[(ForeignPtr Word8, Int, Int)]
</span><a href="#local-6989586621679040394"><span class="hs-identifier hs-var">list</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-341"></span><span>        </span><span id="local-6989586621679040395"><span class="annot"><span class="annottext">turn :: (ForeignPtr Word8, Int, Int) -&gt; ByteString
</span><a href="#local-6989586621679040395"><span class="hs-identifier hs-var hs-var">turn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040396"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679040396"><span class="hs-identifier hs-var">foreignptr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040397"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040397"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040398"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040398"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; Int -&gt; ByteString
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Internal.Type.html#fromForeignPtr"><span class="hs-identifier hs-var">BS.fromForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679040396"><span class="hs-identifier hs-var">foreignptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040397"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040398"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- | Unmaps memory region. As parameters use values marked as ptr and</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- rawsize in description of 'mmapFilePtr'.</span><span>
</span><span id="line-345"></span><span id="local-6989586621679039926"><span class="annot"><a href="System.IO.MMap.html#munmapFilePtr"><span class="hs-identifier hs-type">munmapFilePtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039926"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ pointer</span></span><span>
</span><span id="line-346"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ rawsize</span></span><span>
</span><span id="line-347"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-348"></span><span id="munmapFilePtr"><span class="annot"><span class="annottext">munmapFilePtr :: forall a. Ptr a -&gt; Int -&gt; IO ()
</span><a href="System.IO.MMap.html#munmapFilePtr"><span class="hs-identifier hs-var hs-var">munmapFilePtr</span></a></span></span><span> </span><span id="local-6989586621679040399"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679040399"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span id="local-6989586621679040400"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040400"><span class="hs-identifier hs-var">rawsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr () -&gt; Ptr a -&gt; IO ()
forall a. Ptr () -&gt; Ptr a -&gt; IO ()
</span><a href="System.IO.MMap.html#c_system_io_mmap_munmap"><span class="hs-identifier hs-var">c_system_io_mmap_munmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Ptr ()
forall a. Int -&gt; Ptr a
</span><a href="System.IO.MMap.html#castIntToPtr"><span class="hs-identifier hs-var">castIntToPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040400"><span class="hs-identifier hs-var">rawsize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679040399"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><a href="System.IO.MMap.html#chunkSize"><span class="hs-identifier hs-type">chunkSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-351"></span><span id="chunkSize"><span class="annot"><span class="annottext">chunkSize :: Int
</span><a href="System.IO.MMap.html#chunkSize"><span class="hs-identifier hs-var hs-var">chunkSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">128</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1024</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="System.IO.MMap.html#c_system_io_granularity"><span class="hs-identifier hs-var">c_system_io_granularity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="System.IO.MMap.html#c_system_io_granularity"><span class="hs-identifier hs-var">c_system_io_granularity</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><a href="System.IO.MMap.html#mmapFileOpen"><span class="hs-identifier hs-type">mmapFileOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.MMap.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ForeignPtr.html#ForeignPtr"><span class="hs-identifier hs-type">ForeignPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span id="mmapFileOpen"><span class="annot"><span class="annottext">mmapFileOpen :: String -&gt; Mode -&gt; IO (ForeignPtr ())
</span><a href="System.IO.MMap.html#mmapFileOpen"><span class="hs-identifier hs-var hs-var">mmapFileOpen</span></a></span></span><span> </span><span id="local-6989586621679040402"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040402"><span class="hs-identifier hs-var">filepath'</span></a></span></span><span> </span><span id="local-6989586621679040403"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040403"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621679040404"><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040404"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; (CString -&gt; IO (Ptr ())) -&gt; IO (Ptr ())
forall a. String -&gt; (CString -&gt; IO a) -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.String.html#withCString"><span class="hs-identifier hs-var">withCString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040402"><span class="hs-identifier hs-var">filepath'</span></a></span><span> </span><span class="annot"><span class="annottext">((CString -&gt; IO (Ptr ())) -&gt; IO (Ptr ()))
-&gt; (CString -&gt; IO (Ptr ())) -&gt; IO (Ptr ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040405"><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679040405"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">CString -&gt; CInt -&gt; IO (Ptr ())
</span><a href="System.IO.MMap.html#c_system_io_mmap_file_open"><span class="hs-identifier hs-var">c_system_io_mmap_file_open</span></a></span><span> </span><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679040405"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; CInt) -&gt; Int -&gt; CInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679040403"><span class="hs-identifier hs-var">mode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040404"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr () -&gt; Ptr () -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
forall a. Ptr a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#nullPtr"><span class="hs-identifier hs-var">nullPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
forall a. String -&gt; String -&gt; IO a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Error.html#throwErrnoPath"><span class="hs-identifier hs-var">throwErrnoPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;opening of '&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040402"><span class="hs-identifier hs-var">filepath'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;' failed&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679040402"><span class="hs-identifier hs-var">filepath'</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621679040407"><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040407"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FinalizerPtr () -&gt; Ptr () -&gt; IO (ForeignPtr ())
forall a. FinalizerPtr a -&gt; Ptr a -&gt; IO (ForeignPtr a)
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.ForeignPtr.Imp.html#newForeignPtr"><span class="hs-identifier hs-var">newForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">FinalizerPtr ()
</span><a href="System.IO.MMap.html#c_system_io_mmap_file_close"><span class="hs-identifier hs-var">c_system_io_mmap_file_close</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr ()
</span><a href="#local-6989586621679040404"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr () -&gt; IO (ForeignPtr ())
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr ()
</span><a href="#local-6989586621679040407"><span class="hs-identifier hs-var">handle</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">--castPtrToInt :: Ptr a -&gt; Int</span><span>
</span><span id="line-363"></span><span class="hs-comment">--castPtrToInt ptr = ptr `minusPtr` nullPtr</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span id="local-6989586621679039930"><span class="annot"><a href="System.IO.MMap.html#castIntToPtr"><span class="hs-identifier hs-type">castIntToPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039930"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-366"></span><span id="castIntToPtr"><span class="annot"><span class="annottext">castIntToPtr :: forall a. Int -&gt; Ptr a
</span><a href="System.IO.MMap.html#castIntToPtr"><span class="hs-identifier hs-var hs-var">castIntToPtr</span></a></span></span><span> </span><span id="local-6989586621679040409"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040409"><span class="hs-identifier hs-var">int</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Any
forall a. Ptr a
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#nullPtr"><span class="hs-identifier hs-var">nullPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Any -&gt; Int -&gt; Ptr a
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#plusPtr"><span class="hs-operator hs-var">`plusPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679040409"><span class="hs-identifier hs-var">int</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="annot"><span class="hs-comment">-- | Should open file given as CString in mode given as CInt</span></span><span>
</span><span id="line-370"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HsMmap.h system_io_mmap_file_open&quot;</span></span><span>
</span><span id="line-371"></span><span>    </span><span id="c_system_io_mmap_file_open"><span class="annot"><a href="System.IO.MMap.html#c_system_io_mmap_file_open"><span class="hs-identifier hs-var">c_system_io_mmap_file_open</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ file path, system encoding</span></span><span>
</span><span id="line-372"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CInt"><span class="hs-identifier hs-type">CInt</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ mode as 0, 1, 2, fromEnum</span></span><span>
</span><span id="line-373"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ file handle returned, nullPtr on error (and errno set)</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- | Used in finalizers, to close handle</span><span>
</span><span id="line-375"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HsMmap.h &amp;system_io_mmap_file_close&quot;</span></span><span>
</span><span id="line-376"></span><span>    </span><span id="c_system_io_mmap_file_close"><span class="annot"><a href="System.IO.MMap.html#c_system_io_mmap_file_close"><span class="hs-identifier hs-var">c_system_io_mmap_file_close</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#FunPtr"><span class="hs-identifier hs-type">FunPtr</span></a></span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="annot"><span class="hs-comment">-- | Mmemory maps file from handle, using mode, starting offset and size</span></span><span>
</span><span id="line-379"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HsMmap.h system_io_mmap_mmap&quot;</span></span><span>
</span><span id="line-380"></span><span>    </span><span id="c_system_io_mmap_mmap"><span class="annot"><a href="System.IO.MMap.html#c_system_io_mmap_mmap"><span class="hs-identifier hs-var">c_system_io_mmap_mmap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039914"><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ handle from c_system_io_mmap_file_open</span></span><span>
</span><span id="line-381"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CInt"><span class="hs-identifier hs-type">CInt</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ mode</span></span><span>
</span><span id="line-382"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CLLong"><span class="hs-identifier hs-type">CLLong</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ starting offset, must be nonegative</span></span><span>
</span><span id="line-383"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CSize"><span class="hs-identifier hs-type">CSize</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ length, must be greater than zero</span></span><span>
</span><span id="line-384"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039914"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-comment">-- ^ starting pointer to byte data, nullPtr on error (plus errno set)</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- | Used in finalizers</span><span>
</span><span id="line-386"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HsMmap.h &amp;system_io_mmap_munmap&quot;</span></span><span>
</span><span id="line-387"></span><span>    </span><span id="c_system_io_mmap_munmap_funptr"><span class="annot"><a href="System.IO.MMap.html#c_system_io_mmap_munmap_funptr"><span class="hs-identifier hs-var">c_system_io_mmap_munmap_funptr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039934"><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#FunPtr"><span class="hs-identifier hs-type">FunPtr</span></a></span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039934"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Unmap region of memory. Size must be the same as returned by</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- mmap. If size is zero, does nothing (treats pointer as invalid)</span><span>
</span><span id="line-390"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HsMmap.h system_io_mmap_munmap&quot;</span></span><span>
</span><span id="line-391"></span><span>    </span><span id="c_system_io_mmap_munmap"><span class="annot"><a href="System.IO.MMap.html#c_system_io_mmap_munmap"><span class="hs-identifier hs-var">c_system_io_mmap_munmap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039947"><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039947"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-392"></span><span class="annot"><span class="hs-comment">-- | Get file size in system specific manner</span></span><span>
</span><span id="line-393"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HsMmap.h system_io_mmap_file_size&quot;</span></span><span>
</span><span id="line-394"></span><span>    </span><span id="c_system_io_file_size"><span class="annot"><a href="System.IO.MMap.html#c_system_io_file_size"><span class="hs-identifier hs-var">c_system_io_file_size</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CLLong"><span class="hs-identifier hs-type">CLLong</span></a></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | Set file size in system specific manner. It is guaranteed to be called</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- only with new size being at least current size.</span><span>
</span><span id="line-397"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HsMmap.h system_io_mmap_extend_file_size&quot;</span></span><span>
</span><span id="line-398"></span><span>    </span><span id="c_system_io_extend_file_size"><span class="annot"><a href="System.IO.MMap.html#c_system_io_extend_file_size"><span class="hs-identifier hs-var">c_system_io_extend_file_size</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CLLong"><span class="hs-identifier hs-type">CLLong</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CInt"><span class="hs-identifier hs-type">CInt</span></a></span><span>
</span><span id="line-399"></span><span class="annot"><span class="hs-comment">-- | Memory mapping granularity.</span></span><span>
</span><span id="line-400"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HsMmap.h system_io_mmap_granularity&quot;</span></span><span>
</span><span id="line-401"></span><span>    </span><span id="c_system_io_granularity"><span class="annot"><a href="System.IO.MMap.html#c_system_io_granularity"><span class="hs-identifier hs-var">c_system_io_granularity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/q976m622jbq42nf9zkhq5axjca5xj9w0-ghc-9.6.6-doc/share/doc/ghc-9.6.6/html/libraries/base-4.18.2.1/src/Foreign.C.Types.html#CInt"><span class="hs-identifier hs-type">CInt</span></a></span><span>
</span><span id="line-402"></span></pre></body></html>